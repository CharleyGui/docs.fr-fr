---
title: Migration .NET Core à partir de project.json
description: Apprenez à migrer un ancien projet .NET Core à l’aide de project.json
ms.date: 07/19/2017
ms.custom: seodec18
ms.openlocfilehash: 2912262d1191114d2314fed89e31c91c114f1935
ms.sourcegitcommit: 559259da2738a7b33a46c0130e51d336091c2097
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/22/2019
ms.locfileid: "72773902"
---
# <a name="migrating-net-core-projects-from-projectjson"></a><span data-ttu-id="ae388-103">Migration de projets .NET Core à partir de project.json</span><span class="sxs-lookup"><span data-stu-id="ae388-103">Migrating .NET Core projects from project.json</span></span>

<span data-ttu-id="ae388-104">Ce document traite des trois scénarios de migration suivants pour les projets .NET Core :</span><span class="sxs-lookup"><span data-stu-id="ae388-104">This document covers the following three migration scenarios for .NET Core projects:</span></span>

1. [<span data-ttu-id="ae388-105">Migration à partir du schéma valide le plus récent de *project.json* vers *csproj*</span><span class="sxs-lookup"><span data-stu-id="ae388-105">Migration from a valid latest schema of *project.json* to *csproj*</span></span>](#migration-from-projectjson-to-csproj)
2. [<span data-ttu-id="ae388-106">Migration à partir de DNX vers csproj</span><span class="sxs-lookup"><span data-stu-id="ae388-106">Migration from DNX to csproj</span></span>](#migration-from-dnx-to-csproj)
3. [<span data-ttu-id="ae388-107">Migration de projets csproj .NET Core RC3 et antérieurs vers le format final</span><span class="sxs-lookup"><span data-stu-id="ae388-107">Migration from RC3 and previous .NET Core csproj projects to the final format</span></span>](#migration-from-earlier-net-core-csproj-formats-to-rtm-csproj)

<span data-ttu-id="ae388-108">Ce document s’applique uniquement aux projets .NET Core plus anciens qui utilisent Project. JSON.</span><span class="sxs-lookup"><span data-stu-id="ae388-108">This document is only applicable to older .NET Core projects that use project.json.</span></span> <span data-ttu-id="ae388-109">Elle ne s’applique pas à la migration de .NET Framework à .NET Core.</span><span class="sxs-lookup"><span data-stu-id="ae388-109">It does not apply to migrating from .NET Framework to .NET Core.</span></span>

## <a name="migration-from-projectjson-to-csproj"></a><span data-ttu-id="ae388-110">Migration de project.json vers csproj</span><span class="sxs-lookup"><span data-stu-id="ae388-110">Migration from project.json to csproj</span></span>

<span data-ttu-id="ae388-111">La migration à partir de *project.json* vers *.csproj* peut être effectuée à l’aide de l’une des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="ae388-111">Migration from *project.json* to *.csproj* can be done using one of the following methods:</span></span>

- [<span data-ttu-id="ae388-112">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="ae388-112">Visual Studio</span></span>](#visual-studio)
- [<span data-ttu-id="ae388-113">Outil de ligne de commande dotnet migrate</span><span class="sxs-lookup"><span data-stu-id="ae388-113">dotnet migrate command-line tool</span></span>](#dotnet-migrate)

<span data-ttu-id="ae388-114">Les deux méthodes utilisant le même moteur sous-jacent pour migrer les projets, les résultats obtenus sont donc identiques dans les deux cas.</span><span class="sxs-lookup"><span data-stu-id="ae388-114">Both methods use the same underlying engine to migrate the projects, so the results will be the same for both.</span></span> <span data-ttu-id="ae388-115">Dans la plupart des cas, l’utilisation de l’une de ces deux méthodes pour migrer *Project. JSON* vers *csproj* est la seule chose nécessaire et aucune autre modification manuelle du fichier projet n’est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="ae388-115">In most cases, using one of these two ways to migrate the *project.json* to *csproj* is the only thing that is needed, and no further manual editing of the project file is necessary.</span></span> <span data-ttu-id="ae388-116">Le fichier *.csproj* obtenu porte le même nom que le répertoire le contenant.</span><span class="sxs-lookup"><span data-stu-id="ae388-116">The resulting *.csproj* file will be named the same as the containing directory name.</span></span>

### <a name="visual-studio"></a><span data-ttu-id="ae388-117">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="ae388-117">Visual Studio</span></span>

<span data-ttu-id="ae388-118">Quand vous ouvrez un fichier *. xproj* ou un fichier solution qui fait référence à des fichiers *. Xproj* dans Visual Studio 2017 ou visual studio 2019 version 16,2 et antérieure, la boîte de dialogue de **mise à niveau unidirectionnelle** s’affiche.</span><span class="sxs-lookup"><span data-stu-id="ae388-118">When you open an *.xproj* file or a solution file that references *.xproj* files in Visual Studio 2017 or Visual Studio 2019 version 16.2 and earlier, the **One-way upgrade** dialog appears.</span></span> <span data-ttu-id="ae388-119">La boîte de dialogue affiche les projets à migrer.</span><span class="sxs-lookup"><span data-stu-id="ae388-119">The dialog displays the projects to be migrated.</span></span> <span data-ttu-id="ae388-120">Si vous ouvrez un fichier solution, tous les projets spécifiés dans le fichier solution sont répertoriés.</span><span class="sxs-lookup"><span data-stu-id="ae388-120">If you open a solution file, all the projects specified in the solution file are listed.</span></span> <span data-ttu-id="ae388-121">Passez en revue la liste des projets à migrer, puis sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="ae388-121">Review the list of projects to be migrated and select **OK**.</span></span>

![Boîte de dialogue Mise à niveau définitive indiquant la liste des projets à migrer](media/one-way-upgrade.jpg)

<span data-ttu-id="ae388-123">Visual Studio migre automatiquement les projets sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="ae388-123">Visual Studio migrates the selected projects automatically.</span></span> <span data-ttu-id="ae388-124">Lors de la migration d’une solution, si vous ne choisissez pas tous les projets, la même boîte de dialogue s’affiche pour vous demander de mettre à niveau les projets restants à partir de cette solution.</span><span class="sxs-lookup"><span data-stu-id="ae388-124">When migrating a solution, if you don't choose all projects, the same dialog appears asking you to upgrade the remaining projects from that solution.</span></span> <span data-ttu-id="ae388-125">Une fois le projet migré, vous pouvez voir et modifier son contenu en double-cliquant sur le projet dans la fenêtre **Explorateur de solutions** et en sélectionnant **Modifier \<nom_projet>.csproj**.</span><span class="sxs-lookup"><span data-stu-id="ae388-125">After the project is migrated, you can see and modify its contents by right-clicking the project in the **Solution Explorer** window and selecting **Edit \<project name>.csproj**.</span></span>

<span data-ttu-id="ae388-126">Les fichiers qui ont été migrés (*Project. JSON*, *global. JSON*, *. xproj*et le fichier solution) sont déplacés vers un dossier de *sauvegarde* .</span><span class="sxs-lookup"><span data-stu-id="ae388-126">Files that were migrated (*project.json*, *global.json*, *.xproj*, and solution file) are moved to a *Backup* folder.</span></span> <span data-ttu-id="ae388-127">Le fichier solution migrée est mis à niveau vers Visual Studio 2017 ou Visual Studio 2019 et vous ne pouvez pas ouvrir ce fichier solution dans Visual Studio 2015 ou versions antérieures.</span><span class="sxs-lookup"><span data-stu-id="ae388-127">The migrated solution file is upgraded to Visual Studio 2017 or Visual Studio 2019 and you won't be able to open that solution file in Visual Studio 2015 or earlier versions.</span></span> <span data-ttu-id="ae388-128">Un fichier nommé *UpgradeLog. htm* qui contient un rapport de migration est également enregistré et ouvert automatiquement.</span><span class="sxs-lookup"><span data-stu-id="ae388-128">A file named *UpgradeLog.htm* that contains a migration report is also saved and opened automatically.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="ae388-129">Dans Visual Studio 2019 version 16,3 et versions ultérieures, vous ne pouvez pas charger ou migrer un fichier *. xproj* .</span><span class="sxs-lookup"><span data-stu-id="ae388-129">In Visual Studio 2019 version 16.3 and later, you cannot load or migrate an *.xproj* file.</span></span> <span data-ttu-id="ae388-130">En outre, Visual Studio 2015 ne permet pas de migrer un fichier *. xproj* .</span><span class="sxs-lookup"><span data-stu-id="ae388-130">Additionally, Visual Studio 2015 doesn't provide the ability to migrate an *.xproj* file.</span></span> <span data-ttu-id="ae388-131">Si vous utilisez l’une de ces versions de Visual Studio, installez une version appropriée de Visual Studio ou utilisez l’outil de migration en ligne de commande décrit ci-après.</span><span class="sxs-lookup"><span data-stu-id="ae388-131">If you're using one of these Visual Studio versions, either install a suitable version of Visual Studio, or use the command line migration tool that's described next.</span></span>

### <a name="dotnet-migrate"></a><span data-ttu-id="ae388-132">dotnet migrate</span><span class="sxs-lookup"><span data-stu-id="ae388-132">dotnet migrate</span></span>

<span data-ttu-id="ae388-133">Dans le scénario de ligne de commande, vous pouvez utiliser la commande [`dotnet migrate`](../tools/dotnet-migrate.md).</span><span class="sxs-lookup"><span data-stu-id="ae388-133">In the command-line scenario, you can use the [`dotnet migrate`](../tools/dotnet-migrate.md) command.</span></span> <span data-ttu-id="ae388-134">Il migre un projet, une solution ou un ensemble de dossiers dans cet ordre, en fonction de ceux qui ont été trouvés.</span><span class="sxs-lookup"><span data-stu-id="ae388-134">It migrates a project, a solution, or a set of folders in that order, depending on which ones were found.</span></span> <span data-ttu-id="ae388-135">Quand vous migrez un projet, le projet et toutes ses dépendances sont migrés.</span><span class="sxs-lookup"><span data-stu-id="ae388-135">When you migrate a project, the project and all its dependencies are migrated.</span></span>

<span data-ttu-id="ae388-136">Les fichiers qui ont été migrés (*Project. JSON*, *global. JSON*et *. xproj*) sont déplacés vers un dossier de *sauvegarde* .</span><span class="sxs-lookup"><span data-stu-id="ae388-136">Files that were migrated (*project.json*, *global.json*, and *.xproj*) are moved to a *backup* folder.</span></span>

> [!NOTE]
> <span data-ttu-id="ae388-137">Si vous utilisez Visual Studio Code, la commande `dotnet migrate` ne modifie pas les fichiers spécifiques à la Visual Studio Code, tels que *Tasks. JSON*.</span><span class="sxs-lookup"><span data-stu-id="ae388-137">If you are using Visual Studio Code, the `dotnet migrate` command does not modify Visual Studio Code-specific files such as *tasks.json*.</span></span> <span data-ttu-id="ae388-138">Ces fichiers doivent être modifiés manuellement.</span><span class="sxs-lookup"><span data-stu-id="ae388-138">These files need to be changed manually.</span></span>
> <span data-ttu-id="ae388-139">Cela est également vrai si vous utilisez un éditeur ou un environnement de développement intégré (IDE) autre que Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="ae388-139">This is also true if you are using an editor or Integrated Development Environment (IDE) other than Visual Studio.</span></span>

<span data-ttu-id="ae388-140">Consultez [un mappage entre les propriétés Project. JSON et csproj](../tools/project-json-to-csproj.md) pour une comparaison des formats *Project. JSON* et *. csproj* .</span><span class="sxs-lookup"><span data-stu-id="ae388-140">See [A mapping between project.json and csproj properties](../tools/project-json-to-csproj.md) for a comparison of *project.json* and *.csproj* formats.</span></span>

<span data-ttu-id="ae388-141">Si vous obtenez une erreur :</span><span class="sxs-lookup"><span data-stu-id="ae388-141">If you get an error:</span></span>

> <span data-ttu-id="ae388-142">Aucun fichier exécutable correspondant à la commande dotnet-Migrate n’a été trouvé</span><span class="sxs-lookup"><span data-stu-id="ae388-142">No executable found matching command dotnet-migrate</span></span>

<span data-ttu-id="ae388-143">Exécutez `dotnet --version` pour afficher la version que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="ae388-143">Run `dotnet --version` to see which version you are using.</span></span> <span data-ttu-id="ae388-144">[`dotnet migrate`](../tools/dotnet-migrate.md) a été introduite dans kit SDK .net Core 1.0.0 et supprimée dans la version 3.0.100.</span><span class="sxs-lookup"><span data-stu-id="ae388-144">[`dotnet migrate`](../tools/dotnet-migrate.md) was introduced in .NET Core SDK 1.0.0 and removed in version 3.0.100.</span></span>
<span data-ttu-id="ae388-145">Vous obtiendrez cette erreur si vous avez un fichier *global. JSON* dans le répertoire actif ou parent, et que la version de `sdk` qu’il spécifie est en dehors de cette plage.</span><span class="sxs-lookup"><span data-stu-id="ae388-145">You'll get this error if you have a *global.json* file in the current or parent directory, and the `sdk` version it specifies is outside this range.</span></span>

## <a name="migration-from-dnx-to-csproj"></a><span data-ttu-id="ae388-146">Migration à partir de DNX vers csproj</span><span class="sxs-lookup"><span data-stu-id="ae388-146">Migration from DNX to csproj</span></span>

<span data-ttu-id="ae388-147">Si vous utilisez encore DNX pour le développement .NET Core, votre processus de migration doit être effectué en deux étapes :</span><span class="sxs-lookup"><span data-stu-id="ae388-147">If you are still using DNX for .NET Core development, your migration process should be done in two stages:</span></span>

1. <span data-ttu-id="ae388-148">Utilisez les [conseils de migration DNX existants](from-dnx.md) pour la migration à partir de DNX vers la CLI prenant en charge project-json.</span><span class="sxs-lookup"><span data-stu-id="ae388-148">Use the [existing DNX migration guidance](from-dnx.md) to migrate from DNX to project-json enabled CLI.</span></span>
2. <span data-ttu-id="ae388-149">Suivez les étapes de la section précédente pour la migration de *project.json* vers *.csproj*.</span><span class="sxs-lookup"><span data-stu-id="ae388-149">Follow the steps from the previous section to migrate from *project.json* to *.csproj*.</span></span>  

> [!NOTE]
> <span data-ttu-id="ae388-150">DNX a été officiellement déprécié lors de la version Preview 1 de la CLI .NET Core.</span><span class="sxs-lookup"><span data-stu-id="ae388-150">DNX has become officially deprecated during the Preview 1 release of the .NET Core CLI.</span></span>

## <a name="migration-from-earlier-net-core-csproj-formats-to-rtm-csproj"></a><span data-ttu-id="ae388-151">Migration de formats csproj .NET Core antérieurs vers le format csproj final</span><span class="sxs-lookup"><span data-stu-id="ae388-151">Migration from earlier .NET Core csproj formats to RTM csproj</span></span>

<span data-ttu-id="ae388-152">Le format csproj .NET Core est modifié et évolue avec chaque nouvelle version préliminaire des outils.</span><span class="sxs-lookup"><span data-stu-id="ae388-152">The .NET Core csproj format has been changing and evolving with each new pre-release version of the tooling.</span></span> <span data-ttu-id="ae388-153">Comme il n’existe aucun outil pour migrer votre fichier projet des versions antérieures de csproj vers la dernière version, vous devez modifier manuellement le fichier projet.</span><span class="sxs-lookup"><span data-stu-id="ae388-153">There is no tool that will migrate your project file from earlier versions of csproj to the latest, so you need to manually edit the project file.</span></span> <span data-ttu-id="ae388-154">Les étapes réelles dépendent de la version du fichier projet que vous migrez.</span><span class="sxs-lookup"><span data-stu-id="ae388-154">The actual steps depend on the version of the project file you are migrating.</span></span> <span data-ttu-id="ae388-155">Voici quelques conseils à prendre en compte en fonction des modifications apportées entre les versions :</span><span class="sxs-lookup"><span data-stu-id="ae388-155">The following is some guidance to consider based on the changes that happened between versions:</span></span>

- <span data-ttu-id="ae388-156">Supprimez la propriété de version des outils de l’élément `<Project>`, si elle existe.</span><span class="sxs-lookup"><span data-stu-id="ae388-156">Remove the tools version property from the `<Project>` element, if it exists.</span></span>
- <span data-ttu-id="ae388-157">Supprimez l’espace de noms XML (`xmlns`) de l’élément `<Project>`.</span><span class="sxs-lookup"><span data-stu-id="ae388-157">Remove the XML namespace (`xmlns`) from the `<Project>` element.</span></span>
- <span data-ttu-id="ae388-158">S’il n’existe pas, ajoutez l’attribut `Sdk` à l’élément `<Project>` et affectez-lui la valeur `Microsoft.NET.Sdk` ou `Microsoft.NET.Sdk.Web`.</span><span class="sxs-lookup"><span data-stu-id="ae388-158">If it doesn't exist, add the `Sdk` attribute to the `<Project>` element and set it to `Microsoft.NET.Sdk` or `Microsoft.NET.Sdk.Web`.</span></span> <span data-ttu-id="ae388-159">Cet attribut spécifie que le projet utilise le SDK à utiliser.</span><span class="sxs-lookup"><span data-stu-id="ae388-159">This attribute specifies that the project uses the SDK to be used.</span></span> <span data-ttu-id="ae388-160">`Microsoft.NET.Sdk.Web` est utilisé pour les applications web.</span><span class="sxs-lookup"><span data-stu-id="ae388-160">`Microsoft.NET.Sdk.Web` is used for web apps.</span></span>
- <span data-ttu-id="ae388-161">Supprimez les instructions `<Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" />` et `<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />` en haut et en bas du projet.</span><span class="sxs-lookup"><span data-stu-id="ae388-161">Remove the `<Import Project="$(MSBuildExtensionsPath)\$(MSBuildToolsVersion)\Microsoft.Common.props" />` and `<Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />` statements from the top and bottom of the project.</span></span> <span data-ttu-id="ae388-162">Ces instructions d’importation étant indiquées implicitement par le SDK, il est inutile qu’elles figurent dans le projet.</span><span class="sxs-lookup"><span data-stu-id="ae388-162">These import statements are implied by the SDK, so there is no need for them to be in the project.</span></span>
- <span data-ttu-id="ae388-163">Si des éléments `<PackageReference>` `Microsoft.NETCore.App` ou `NETStandard.Library` figurent dans votre projet, vous devez les supprimer.</span><span class="sxs-lookup"><span data-stu-id="ae388-163">If you have `Microsoft.NETCore.App` or `NETStandard.Library` `<PackageReference>` items in your project, you should remove them.</span></span> <span data-ttu-id="ae388-164">Ces références de package sont [indiquées implicitement par le SDK](https://aka.ms/sdkimplicitrefs).</span><span class="sxs-lookup"><span data-stu-id="ae388-164">These package references are [implied by the SDK](https://aka.ms/sdkimplicitrefs).</span></span>
- <span data-ttu-id="ae388-165">Supprimez l’élément `<PackageReference>` `Microsoft.NET.Sdk`, s’il existe.</span><span class="sxs-lookup"><span data-stu-id="ae388-165">Remove the `Microsoft.NET.Sdk` `<PackageReference>` element, if it exists.</span></span> <span data-ttu-id="ae388-166">La référence SDK est fournie par l’attribut `Sdk` sur l’élément `<Project>`.</span><span class="sxs-lookup"><span data-stu-id="ae388-166">The SDK reference comes through the `Sdk` attribute on the `<Project>` element.</span></span>
- <span data-ttu-id="ae388-167">Supprimez les modèles [Glob](https://en.wikipedia.org/wiki/Glob_(programming)) qui sont [indiqués implicitement par le SDK](../tools/csproj.md#default-compilation-includes-in-net-core-projects).</span><span class="sxs-lookup"><span data-stu-id="ae388-167">Remove the [globs](https://en.wikipedia.org/wiki/Glob_(programming)) that are [implied by the SDK](../tools/csproj.md#default-compilation-includes-in-net-core-projects).</span></span> <span data-ttu-id="ae388-168">En laissant ces modèles Glob dans votre projet, une erreur se produit lors de la génération, car les éléments de compilation sont dupliqués.</span><span class="sxs-lookup"><span data-stu-id="ae388-168">Leaving these globs in your project will cause an error on build because compile items will be duplicated.</span></span>

<span data-ttu-id="ae388-169">Une fois ces étapes effectuées, votre projet doit être entièrement compatible avec le format csproj .NET Core final.</span><span class="sxs-lookup"><span data-stu-id="ae388-169">After these steps your project should be fully compatible with the RTM .NET Core csproj format.</span></span>

<span data-ttu-id="ae388-170">Pour obtenir des exemples antérieurs et postérieurs à la migration de l’ancien format csproj vers le nouveau, consultez l’article [Updating Visual Studio 2017 RC – .NET Core Tooling improvements](https://devblogs.microsoft.com/dotnet/updating-visual-studio-2017-rc-net-core-tooling-improvements/) sur le blog .NET.</span><span class="sxs-lookup"><span data-stu-id="ae388-170">For examples of before and after the migration from old csproj format to the new one, see the [Updating Visual Studio 2017 RC – .NET Core Tooling improvements](https://devblogs.microsoft.com/dotnet/updating-visual-studio-2017-rc-net-core-tooling-improvements/) article on the .NET blog.</span></span>

## <a name="see-also"></a><span data-ttu-id="ae388-171">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ae388-171">See also</span></span>

- [<span data-ttu-id="ae388-172">Porter, migrer et mettre à niveau des projets Visual Studio</span><span class="sxs-lookup"><span data-stu-id="ae388-172">Port, Migrate, and Upgrade Visual Studio Projects</span></span>](/visualstudio/porting/port-migrate-and-upgrade-visual-studio-projects)

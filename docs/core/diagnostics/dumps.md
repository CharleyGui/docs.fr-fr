---
title: Dumps-.NET
description: Introduction aux dumps dans .NET.
ms.date: 10/12/2020
ms.openlocfilehash: 7a4c7bf54b3e9ea43e685eafbd00b4a373326520
ms.sourcegitcommit: c0b803bffaf101e12f071faf94ca21b46d04ff30
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/24/2020
ms.locfileid: "97764940"
---
# <a name="dumps"></a><span data-ttu-id="cf89b-103">Vidages</span><span class="sxs-lookup"><span data-stu-id="cf89b-103">Dumps</span></span>

<span data-ttu-id="cf89b-104">Un dump est un fichier qui contient un instantané du processus au moment de sa création et peut être utile pour examiner l’état de votre application.</span><span class="sxs-lookup"><span data-stu-id="cf89b-104">A dump is a file that contains a snapshot of the process at the time it was created and can be useful for examining the state of your application.</span></span> <span data-ttu-id="cf89b-105">Les dumps peuvent être utilisés pour déboguer votre application .NET lorsqu’il est difficile de joindre un débogueur à celui-ci, comme les environnements de production ou CI.</span><span class="sxs-lookup"><span data-stu-id="cf89b-105">Dumps can be used to debug your .NET application when it is difficult to attach a debugger to it such as production or CI environments.</span></span> <span data-ttu-id="cf89b-106">L’utilisation de dumps vous permet de capturer l’état du processus problématique et de l’examiner sans avoir à arrêter l’application.</span><span class="sxs-lookup"><span data-stu-id="cf89b-106">Using dumps allows you to capture the state of the problematic process and examine it without having to stop the application.</span></span>

## <a name="collect-dumps"></a><span data-ttu-id="cf89b-107">Collecter les vidages</span><span class="sxs-lookup"><span data-stu-id="cf89b-107">Collect dumps</span></span>

<span data-ttu-id="cf89b-108">Les vidages peuvent être collectés de différentes manières, en fonction de la plateforme sur laquelle vous exécutez votre application.</span><span class="sxs-lookup"><span data-stu-id="cf89b-108">Dumps can be collected in a variety of ways depending on which platform you are running your app on.</span></span>

> [!NOTE]
> <span data-ttu-id="cf89b-109">La collecte d’un vidage à l’intérieur d’un conteneur nécessite une fonctionnalité PTRACE, qui peut être ajoutée via `--cap-add=SYS_PTRACE` ou `--privileged` .</span><span class="sxs-lookup"><span data-stu-id="cf89b-109">Collecting a dump inside a container requires PTRACE capability, which can be added via `--cap-add=SYS_PTRACE` or `--privileged`.</span></span>

> [!NOTE]
> <span data-ttu-id="cf89b-110">Les dumps peuvent contenir des informations sensibles, car elles peuvent contenir la mémoire complète du processus en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="cf89b-110">Dumps may contain sensitive information because they can contain the full memory of the running process.</span></span> <span data-ttu-id="cf89b-111">Gérez-les avec des restrictions de sécurité et des recommandations à l’esprit.</span><span class="sxs-lookup"><span data-stu-id="cf89b-111">Handle them with any security restrictions and guidances in mind.</span></span>

### <a name="collecting-dumps-on-crash"></a><span data-ttu-id="cf89b-112">Collecte des vidages sur incident</span><span class="sxs-lookup"><span data-stu-id="cf89b-112">Collecting dumps on crash</span></span>

<span data-ttu-id="cf89b-113">Vous pouvez utiliser des variables d’environnement pour configurer votre application afin de collecter un vidage en cas d’incident.</span><span class="sxs-lookup"><span data-stu-id="cf89b-113">You can use environment variables to configure your application to collect a dump upon a crash.</span></span> <span data-ttu-id="cf89b-114">Cela est utile lorsque vous souhaitez comprendre pourquoi un incident s’est produit.</span><span class="sxs-lookup"><span data-stu-id="cf89b-114">This is helpful when you want to get an understanding of why a crash happened.</span></span> <span data-ttu-id="cf89b-115">Par exemple, la capture d’un vidage lorsqu’une exception est levée vous aide à identifier un problème en examinant l’état de l’application lorsqu’elle s’est bloquée.</span><span class="sxs-lookup"><span data-stu-id="cf89b-115">For example, capturing a dump when an exception is thrown helps you identify an issue by examining the state of the app when it crashed.</span></span>

<span data-ttu-id="cf89b-116">Le tableau suivant répertorie les variables d’environnement que vous pouvez configurer pour collecter des vidages sur un incident.</span><span class="sxs-lookup"><span data-stu-id="cf89b-116">The following table shows the environment variables you can configure for collecting dumps on a crash.</span></span>

|<span data-ttu-id="cf89b-117">Variable d’environnement</span><span class="sxs-lookup"><span data-stu-id="cf89b-117">Environment variable</span></span>|<span data-ttu-id="cf89b-118">Description</span><span class="sxs-lookup"><span data-stu-id="cf89b-118">Description</span></span>|<span data-ttu-id="cf89b-119">Valeur par défaut</span><span class="sxs-lookup"><span data-stu-id="cf89b-119">Default value</span></span>|
|-------|---------|---|
|`COMPlus_DbgEnableMiniDump`|<span data-ttu-id="cf89b-120">Si la valeur est 1, active la génération de l’image mémoire principale.</span><span class="sxs-lookup"><span data-stu-id="cf89b-120">If set to 1, enable core dump generation.</span></span>|<span data-ttu-id="cf89b-121">0</span><span class="sxs-lookup"><span data-stu-id="cf89b-121">0</span></span>|
|`COMPlus_DbgMiniDumpType`|<span data-ttu-id="cf89b-122">Type de vidage à collecter.</span><span class="sxs-lookup"><span data-stu-id="cf89b-122">Type of dump to be collected.</span></span> <span data-ttu-id="cf89b-123">Pour plus d’informations, consultez le tableau ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="cf89b-123">For more information, see the table below</span></span>|<span data-ttu-id="cf89b-124">2 ( `MiniDumpWithPrivateReadWriteMemory` )</span><span class="sxs-lookup"><span data-stu-id="cf89b-124">2 (`MiniDumpWithPrivateReadWriteMemory`)</span></span>|
|`COMPlus_DbgMiniDumpName`|<span data-ttu-id="cf89b-125">Chemin d’accès à un fichier dans lequel écrire le vidage.</span><span class="sxs-lookup"><span data-stu-id="cf89b-125">Path to a file to write the dump to.</span></span>|`/tmp/coredump.<pid>`|
|`COMPlus_CreateDumpDiagnostics`|<span data-ttu-id="cf89b-126">Si la valeur est 1, active la journalisation des diagnostics du processus de vidage.</span><span class="sxs-lookup"><span data-stu-id="cf89b-126">If set to 1, enable diagnostic logging of dump process.</span></span>|<span data-ttu-id="cf89b-127">0</span><span class="sxs-lookup"><span data-stu-id="cf89b-127">0</span></span>|

<span data-ttu-id="cf89b-128">Le tableau ci-dessous présente toutes les options que vous `COMPlus_DbgMiniDumpType` pouvez utiliser pour qui peuvent être spécifiées en tant que valeur.</span><span class="sxs-lookup"><span data-stu-id="cf89b-128">The table below shows all the options you may use for `COMPlus_DbgMiniDumpType` which can be specified as a value.</span></span> <span data-ttu-id="cf89b-129">Par exemple, `COMPlus_DbgMiniDumpType` la valeur 1 signifie que `MiniDumpNormal` le type dump est collecté en cas d’incident.</span><span class="sxs-lookup"><span data-stu-id="cf89b-129">For example, setting `COMPlus_DbgMiniDumpType` to 1 means `MiniDumpNormal` type dump will be collected on a crash.</span></span>

|<span data-ttu-id="cf89b-130">Valeur</span><span class="sxs-lookup"><span data-stu-id="cf89b-130">Value</span></span>|<span data-ttu-id="cf89b-131">Nom</span><span class="sxs-lookup"><span data-stu-id="cf89b-131">Name</span></span>|<span data-ttu-id="cf89b-132">Description</span><span class="sxs-lookup"><span data-stu-id="cf89b-132">Description</span></span>|
|-----|----|-----------|
|<span data-ttu-id="cf89b-133">1</span><span class="sxs-lookup"><span data-stu-id="cf89b-133">1</span></span>|`MiniDumpNormal`|<span data-ttu-id="cf89b-134">Incluez uniquement les informations nécessaires pour capturer les traces de la pile pour tous les threads existants dans un processus.</span><span class="sxs-lookup"><span data-stu-id="cf89b-134">Include just the information necessary to capture stack traces for all existing threads in a process.</span></span> <span data-ttu-id="cf89b-135">Mémoire et informations de tas GC limitées.</span><span class="sxs-lookup"><span data-stu-id="cf89b-135">Limited GC heap memory and information.</span></span>|
|<span data-ttu-id="cf89b-136">2</span><span class="sxs-lookup"><span data-stu-id="cf89b-136">2</span></span>|`MiniDumpWithPrivateReadWriteMemory`|<span data-ttu-id="cf89b-137">Comprend les tas GC et les informations nécessaires à la capture des traces de la pile pour tous les threads existants dans un processus.</span><span class="sxs-lookup"><span data-stu-id="cf89b-137">Includes the GC heaps and information necessary to capture stack traces for all existing threads in a process.</span></span>|
|<span data-ttu-id="cf89b-138">3</span><span class="sxs-lookup"><span data-stu-id="cf89b-138">3</span></span>|`MiniDumpFilterTriage`|<span data-ttu-id="cf89b-139">Incluez uniquement les informations nécessaires pour capturer les traces de la pile pour tous les threads existants dans un processus.</span><span class="sxs-lookup"><span data-stu-id="cf89b-139">Include just the information necessary to capture stack traces for all existing threads in a process.</span></span> <span data-ttu-id="cf89b-140">Mémoire et informations de tas GC limitées.</span><span class="sxs-lookup"><span data-stu-id="cf89b-140">Limited GC heap memory and information.</span></span>|
|<span data-ttu-id="cf89b-141">4</span><span class="sxs-lookup"><span data-stu-id="cf89b-141">4</span></span>|`MiniDumpWithFullMemory`|<span data-ttu-id="cf89b-142">Incluez toute la mémoire accessible dans le processus.</span><span class="sxs-lookup"><span data-stu-id="cf89b-142">Include all accessible memory in the process.</span></span> <span data-ttu-id="cf89b-143">Les données de mémoire brutes sont incluses à la fin, afin que les structures initiales puissent être mappées directement sans les informations de mémoire brutes.</span><span class="sxs-lookup"><span data-stu-id="cf89b-143">The raw memory data is included at the end, so that the initial structures can be mapped directly without the raw memory information.</span></span> <span data-ttu-id="cf89b-144">Cette option peut aboutir à un fichier très volumineux.</span><span class="sxs-lookup"><span data-stu-id="cf89b-144">This option can result in a very large file.</span></span>|

### <a name="collecting-dumps-at-specific-point-in-time"></a><span data-ttu-id="cf89b-145">Collecte des vidages à un moment précis dans le temps</span><span class="sxs-lookup"><span data-stu-id="cf89b-145">Collecting dumps at specific point in time</span></span>

<span data-ttu-id="cf89b-146">Vous souhaiterez peut-être collecter un vidage lorsque l’application ne s’est pas encore bloquée.</span><span class="sxs-lookup"><span data-stu-id="cf89b-146">You may want to collect a dump when the app hasn't crashed yet.</span></span> <span data-ttu-id="cf89b-147">Par exemple, si vous souhaitez examiner l’état d’une application qui semble se trouver dans un blocage, la configuration des variables d’environnement pour collecter des vidages en cas d’incident n’est pas utile, car l’application est toujours en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="cf89b-147">For example, if you want to examine the state of an application that seems to be in a deadlock, configuring the environment variables to collect dumps on crash will not be helpful because the app is still running.</span></span>

<span data-ttu-id="cf89b-148">Pour collecter un dump à votre propre demande, vous pouvez utiliser `dotnet-dump` , qui est un outil CLI pour la collecte et l’analyse des vidages.</span><span class="sxs-lookup"><span data-stu-id="cf89b-148">To collect dump at your own request, you can use `dotnet-dump`, which is a CLI tool for collecting and analyzing dumps.</span></span> <span data-ttu-id="cf89b-149">Pour plus d’informations sur la façon de les utiliser pour collecter des vidages avec `dotnet-dump` , consultez [dump collection and Analysis Utility](dotnet-dump.md).</span><span class="sxs-lookup"><span data-stu-id="cf89b-149">For more information on how to use it to collect dumps with `dotnet-dump`, see [Dump collection and analysis utility](dotnet-dump.md).</span></span>

## <a name="analyze-dumps"></a><span data-ttu-id="cf89b-150">Analyser les vidages</span><span class="sxs-lookup"><span data-stu-id="cf89b-150">Analyze dumps</span></span>

<span data-ttu-id="cf89b-151">Vous pouvez anlayze des dumps à l’aide de l' [`dotnet-dump`](dotnet-dump.md) outil CLI ou de [Visual Studio](https://docs.microsoft.com/visualstudio/debugger/using-dump-files).</span><span class="sxs-lookup"><span data-stu-id="cf89b-151">You can anlayze dumps using the [`dotnet-dump`](dotnet-dump.md) CLI tool or with [Visual Studio](https://docs.microsoft.com/visualstudio/debugger/using-dump-files).</span></span>

> [!NOTE]
> <span data-ttu-id="cf89b-152">Visual Studio version 16,8 et versions ultérieures vous permet d' [ouvrir des vidages Linux](https://devblogs.microsoft.com/visualstudio/linux-managed-memory-dump-debugging/) générés sur .net Core 3.1.7 ou version ultérieure.</span><span class="sxs-lookup"><span data-stu-id="cf89b-152">Visual Studio version 16.8 and later allows you to [open Linux dumps](https://devblogs.microsoft.com/visualstudio/linux-managed-memory-dump-debugging/) generated on .NET Core 3.1.7 or later.</span></span>  

> [!NOTE]
> <span data-ttu-id="cf89b-153">Si le débogage natif est nécessaire, l' [extension de débogueur SOS](sos-debugging-extension.md) peut être utilisée avec [LLDB sur Linux et MacOS](debug-linux-dumps.md#analyze-dumps-on-linux).</span><span class="sxs-lookup"><span data-stu-id="cf89b-153">If native debugging is necessary, the [SOS debugger extension](sos-debugging-extension.md) can be used with [LLDB on Linux and macOS](debug-linux-dumps.md#analyze-dumps-on-linux).</span></span> <span data-ttu-id="cf89b-154">SOS est également pris en charge avec [WinDbg/CDB](/windows-hardware/drivers/debugger/debugger-download-tools) sur Windows, bien que Visual Studio soit recommandé.</span><span class="sxs-lookup"><span data-stu-id="cf89b-154">SOS is also supported with [Windbg/cdb](/windows-hardware/drivers/debugger/debugger-download-tools) on Windows, although Visual Studio is recommended.</span></span>

## <a name="see-also"></a><span data-ttu-id="cf89b-155">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="cf89b-155">See also</span></span>

<span data-ttu-id="cf89b-156">En savoir plus sur la façon dont vous pouvez tirer parti des vidages pour faciliter le diagnostic des problèmes dans votre application .NET.</span><span class="sxs-lookup"><span data-stu-id="cf89b-156">Learn more about how you can leverage dumps to help diagnosing problems in your .NET application.</span></span>

* <span data-ttu-id="cf89b-157">Le didacticiel sur le [débogage des vidages Linux](debug-linux-dumps.md) vous guide tout au long du débogage d’un vidage qui a été collecté dans Linux.</span><span class="sxs-lookup"><span data-stu-id="cf89b-157">[Debug Linux dumps](debug-linux-dumps.md) tutorial walks you through how to debug a dump that was collected in Linux.</span></span>

* <span data-ttu-id="cf89b-158">Le didacticiel sur le [blocage du débogage](debug-deadlock.md) vous guide tout au long du débogage d’un interblocage dans votre application .net à l’aide de dumps.</span><span class="sxs-lookup"><span data-stu-id="cf89b-158">[Debug deadlock](debug-deadlock.md) tutorial walks you through how to debug a deadlock in your .NET application using dumps.</span></span>

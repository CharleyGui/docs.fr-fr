---
title: Utilisation de la notaire Catalina macOS
description: Gestion des problèmes de notaire et de certificat avec macOS quand vous installez le Runtime .NET Core, le kit de développement logiciel (SDK) et les applications créées avec .NET Core.
author: adegeo
ms.author: adegeo
ms.date: 02/14/2020
ms.openlocfilehash: 616f163856cca48ccc6d1a14e0c6e68d56379c0c
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/15/2020
ms.locfileid: "90538300"
---
# <a name="macos-catalina-notarization-and-the-impact-on-net-core-downloads-and-projects"></a><span data-ttu-id="fb660-103">la notaire Catalina macOS et l’impact sur les téléchargements et les projets .NET Core</span><span class="sxs-lookup"><span data-stu-id="fb660-103">macOS Catalina Notarization and the impact on .NET Core downloads and projects</span></span>

<span data-ttu-id="fb660-104">À partir de macOS Catalina (version 10,15), tous les logiciels générés après le 1er juin 2019 et distribués avec l’ID de développeur doivent être certifiés.</span><span class="sxs-lookup"><span data-stu-id="fb660-104">Beginning with macOS Catalina (version 10.15), all software built after June 1, 2019, and distributed with Developer ID, must be notarized.</span></span> <span data-ttu-id="fb660-105">Cette exigence s’applique au Runtime .NET Core, kit SDK .NET Core et aux logiciels créés avec .NET Core.</span><span class="sxs-lookup"><span data-stu-id="fb660-105">This requirement applies to the .NET Core runtime, .NET Core SDK, and software created with .NET Core.</span></span> <span data-ttu-id="fb660-106">Cet article décrit les scénarios courants que vous pouvez rencontrer avec la notaire .NET Core et macOS.</span><span class="sxs-lookup"><span data-stu-id="fb660-106">This article describes the common scenarios you may face with .NET Core and macOS notarization.</span></span>

## <a name="installing-net-core"></a><span data-ttu-id="fb660-107">Installation de .NET Core</span><span class="sxs-lookup"><span data-stu-id="fb660-107">Installing .NET Core</span></span>

<span data-ttu-id="fb660-108">Les programmes d’installation de .NET Core (Runtime et SDK) versions 3,1, 3,0 et 2,1 ont été certifiés depuis le 18 février 2020.</span><span class="sxs-lookup"><span data-stu-id="fb660-108">The installers for .NET Core (both runtime and SDK) versions 3.1, 3.0, and 2.1, have been notarized since February 18, 2020.</span></span> <span data-ttu-id="fb660-109">Les versions antérieures publiées ne sont pas certifiées.</span><span class="sxs-lookup"><span data-stu-id="fb660-109">Prior released versions aren't notarized.</span></span> <span data-ttu-id="fb660-110">Vous pouvez installer manuellement une version non certifiée de .NET Core en téléchargeant d’abord le programme d’installation, puis en utilisant la `sudo installer` commande.</span><span class="sxs-lookup"><span data-stu-id="fb660-110">You can manually install a non-notarized version of .NET Core by first downloading the installer, and then using the `sudo installer` command.</span></span> <span data-ttu-id="fb660-111">Pour plus d’informations, consultez [Télécharger et installer manuellement pour MacOS](./macos.md#download-and-manually-install).</span><span class="sxs-lookup"><span data-stu-id="fb660-111">For more information, see [Download and manually install for macOS](./macos.md#download-and-manually-install).</span></span>

<span data-ttu-id="fb660-112">À partir des versions suivantes, les programmes d’installation de .NET Core sont certifiés :</span><span class="sxs-lookup"><span data-stu-id="fb660-112">Beginning with the following versions, the .NET Core installers are notarized:</span></span>

- <span data-ttu-id="fb660-113">Runtime .NET Core</span><span class="sxs-lookup"><span data-stu-id="fb660-113">.NET Core Runtime</span></span>
  - <span data-ttu-id="fb660-114">2.1.16</span><span class="sxs-lookup"><span data-stu-id="fb660-114">2.1.16</span></span>
  - <span data-ttu-id="fb660-115">3.0.3</span><span class="sxs-lookup"><span data-stu-id="fb660-115">3.0.3</span></span>
  - <span data-ttu-id="fb660-116">3.1.2</span><span class="sxs-lookup"><span data-stu-id="fb660-116">3.1.2</span></span>

- <span data-ttu-id="fb660-117">SDK .NET Core</span><span class="sxs-lookup"><span data-stu-id="fb660-117">.NET Core SDK</span></span>
  - <span data-ttu-id="fb660-118">2.1.512</span><span class="sxs-lookup"><span data-stu-id="fb660-118">2.1.512</span></span>
  - <span data-ttu-id="fb660-119">3.0.103</span><span class="sxs-lookup"><span data-stu-id="fb660-119">3.0.103</span></span>
  - <span data-ttu-id="fb660-120">3.1.102</span><span class="sxs-lookup"><span data-stu-id="fb660-120">3.1.102</span></span>

## <a name="apphost-is-disabled-by-default"></a><span data-ttu-id="fb660-121">appHost est désactivé par défaut</span><span class="sxs-lookup"><span data-stu-id="fb660-121">appHost is disabled by default</span></span>

<span data-ttu-id="fb660-122">Par défaut, les versions non certifiées des kit SDK .NET Core 3,0 et ultérieures produisent un exécutable Mach-O natif (connu sous le nom de **apphost**) lorsque votre projet compile, publie ou est exécuté.</span><span class="sxs-lookup"><span data-stu-id="fb660-122">By default, non-notarized versions of the .NET Core SDK 3.0 and above produce a native Mach-O executable (known as the **appHost**) when your project compiles, publishes, or is run.</span></span> <span data-ttu-id="fb660-123">Cet exécutable est un moyen pratique d’exécuter votre application.</span><span class="sxs-lookup"><span data-stu-id="fb660-123">This executable is a convenient way to run your app.</span></span> <span data-ttu-id="fb660-124">Dans le cas contraire, votre application doit être démarrée en exécutant `dotnet <filename.dll>` .</span><span class="sxs-lookup"><span data-stu-id="fb660-124">Otherwise, your app must be started by running `dotnet <filename.dll>`.</span></span> <span data-ttu-id="fb660-125">Lorsque appHost est activé, la `dotnet run` commande est appelée dans le contexte de apphost.</span><span class="sxs-lookup"><span data-stu-id="fb660-125">When the appHost is enabled, the `dotnet run` command is invoked in the context of the appHost.</span></span> <span data-ttu-id="fb660-126">Pour plus d’informations, consultez [Context of the apphost](#context-of-the-apphost).</span><span class="sxs-lookup"><span data-stu-id="fb660-126">For more information, see [Context of the appHost](#context-of-the-apphost).</span></span>

<span data-ttu-id="fb660-127">À compter de la version certifiée des kit SDK .NET Core 3,0 et versions ultérieures, l’exécutable appHost n’est pas généré par défaut.</span><span class="sxs-lookup"><span data-stu-id="fb660-127">Starting with the notarized versions of the .NET Core SDK 3.0 and above, the appHost executable isn't generated by default.</span></span> <span data-ttu-id="fb660-128">Vous pouvez activer la génération de appHost avec le [`UseAppHost`](../project-sdk/msbuild-props.md#useapphost) paramètre booléen dans le fichier projet.</span><span class="sxs-lookup"><span data-stu-id="fb660-128">You can turn on appHost generation with the [`UseAppHost`](../project-sdk/msbuild-props.md#useapphost) boolean setting in the project file.</span></span> <span data-ttu-id="fb660-129">Vous pouvez également basculer le appHost avec le `-p:UseAppHost` paramètre sur la ligne de commande pour la `dotnet` commande spécifique que vous exécutez :</span><span class="sxs-lookup"><span data-stu-id="fb660-129">You can also toggle the appHost with the `-p:UseAppHost` parameter on the command line for the specific `dotnet` command you run:</span></span>

- <span data-ttu-id="fb660-130">Fichier projet</span><span class="sxs-lookup"><span data-stu-id="fb660-130">Project file</span></span>

  ```xml
  <PropertyGroup>
    <UseAppHost>true</UseAppHost>
  </PropertyGroup>
  ```

- <span data-ttu-id="fb660-131">Paramètre de ligne de commande</span><span class="sxs-lookup"><span data-stu-id="fb660-131">Command-line parameter</span></span>

  ```dotnetcli
  dotnet run -p:UseAppHost=true
  ```

<span data-ttu-id="fb660-132">Un appHost est toujours créé lorsque vous publiez votre application [autonome](../deploying/index.md#publish-self-contained).</span><span class="sxs-lookup"><span data-stu-id="fb660-132">An appHost is always created when you publish your app [self-contained](../deploying/index.md#publish-self-contained).</span></span>

<span data-ttu-id="fb660-133">Pour plus d’informations sur le `UseAppHost` paramètre, consultez [propriétés MSBuild pour Microsoft. net. SDK](../project-sdk/msbuild-props.md#useapphost).</span><span class="sxs-lookup"><span data-stu-id="fb660-133">For more information about the `UseAppHost` setting, see [MSBuild properties for Microsoft.NET.Sdk](../project-sdk/msbuild-props.md#useapphost).</span></span>

### <a name="context-of-the-apphost"></a><span data-ttu-id="fb660-134">Contexte de appHost</span><span class="sxs-lookup"><span data-stu-id="fb660-134">Context of the appHost</span></span>

<span data-ttu-id="fb660-135">Lorsque le appHost est activé dans votre projet et que vous utilisez la `dotnet run` commande pour exécuter votre application, l’application est appelée dans le contexte du apphost et non de l’hôte par défaut (l’hôte par défaut est la `dotnet` commande).</span><span class="sxs-lookup"><span data-stu-id="fb660-135">When the appHost is enabled in your project, and you use the `dotnet run` command to run your app, the app is invoked in the context of the appHost and not the default host (the default host is the `dotnet` command).</span></span> <span data-ttu-id="fb660-136">Si le appHost est désactivé dans votre projet, la `dotnet run` commande exécute votre application dans le contexte de l’hôte par défaut.</span><span class="sxs-lookup"><span data-stu-id="fb660-136">If the appHost is disabled in your project, the `dotnet run` command runs your app in the context of the default host.</span></span> <span data-ttu-id="fb660-137">Même si le appHost est désactivé, la publication de votre application comme autonome génère un fichier exécutable appHost, et les utilisateurs utilisent ce fichier exécutable pour exécuter votre application.</span><span class="sxs-lookup"><span data-stu-id="fb660-137">Even if the appHost is disabled, publishing your app as self-contained generates an appHost executable, and users use that executable to run your app.</span></span> <span data-ttu-id="fb660-138">L’exécution de votre application avec `dotnet <filename.dll>` appelle l’application avec l’hôte par défaut, le runtime partagé.</span><span class="sxs-lookup"><span data-stu-id="fb660-138">Running your app with `dotnet <filename.dll>` invokes the app with the default host, the shared runtime.</span></span>

<span data-ttu-id="fb660-139">Lorsqu’une application utilisant appHost est appelée, la partition de certificat accessible par l’application est différente de l’hôte par défaut authentifié.</span><span class="sxs-lookup"><span data-stu-id="fb660-139">When an app using the appHost is invoked, the certificate partition accessed by the app is different from the notarized default host.</span></span> <span data-ttu-id="fb660-140">Si votre application doit accéder aux certificats installés par le biais de l’hôte par défaut, utilisez la `dotnet run` commande pour exécuter votre application à partir de son fichier projet ou utilisez la `dotnet <filename.dll>` commande pour démarrer l’application directement.</span><span class="sxs-lookup"><span data-stu-id="fb660-140">If your app must access the certificates installed through the default host, use the `dotnet run` command to run your app from its project file, or use the `dotnet <filename.dll>` command to start the app directly.</span></span>

<span data-ttu-id="fb660-141">Des informations supplémentaires sur ce scénario sont fournies dans la section [ASP.net Core et MacOS et Certificates](#aspnet-core-and-macos-and-certificates) .</span><span class="sxs-lookup"><span data-stu-id="fb660-141">More information about this scenario is provided in the [ASP.NET Core and macOS and certificates](#aspnet-core-and-macos-and-certificates) section.</span></span>

## <a name="aspnet-core-and-macos-and-certificates"></a><span data-ttu-id="fb660-142">ASP.NET Core et macOS et certificats</span><span class="sxs-lookup"><span data-stu-id="fb660-142">ASP.NET Core and macOS and certificates</span></span>

<span data-ttu-id="fb660-143">.NET Core offre la possibilité de gérer des certificats dans le trousseau macOS avec la <xref:System.Security.Cryptography.X509Certificates> classe.</span><span class="sxs-lookup"><span data-stu-id="fb660-143">.NET Core provides the ability to manage certificates in the macOS Keychain with the <xref:System.Security.Cryptography.X509Certificates> class.</span></span> <span data-ttu-id="fb660-144">L’accès au trousseau macOS utilise l’identité des applications comme clé primaire pour déterminer la partition à prendre en compte.</span><span class="sxs-lookup"><span data-stu-id="fb660-144">Access to the macOS Keychain uses the applications identity as the primary key when deciding which partition to consider.</span></span> <span data-ttu-id="fb660-145">Par exemple, les applications non signées stockent des secrets dans la partition non signée, mais les applications signées stockent leurs secrets dans des partitions auxquelles seules elles peuvent accéder.</span><span class="sxs-lookup"><span data-stu-id="fb660-145">For example, unsigned applications store secrets in the unsigned partition, but signed applications store their secrets in partitions only they can access.</span></span> <span data-ttu-id="fb660-146">La source d’exécution qui appelle votre application détermine la partition à utiliser.</span><span class="sxs-lookup"><span data-stu-id="fb660-146">The source of execution that invokes your app decides which partition to use.</span></span>

<span data-ttu-id="fb660-147">.NET Core fournit trois sources d’exécution : [apphost](#apphost-is-disabled-by-default), hôte par défaut ( `dotnet` commande) et hôte personnalisé.</span><span class="sxs-lookup"><span data-stu-id="fb660-147">.NET Core provides three sources of execution: [appHost](#apphost-is-disabled-by-default), default host (the `dotnet` command), and a custom host.</span></span> <span data-ttu-id="fb660-148">Chaque modèle d’exécution peut avoir des identités différentes, signées ou non signées, et a accès à différentes partitions dans le trousseau.</span><span class="sxs-lookup"><span data-stu-id="fb660-148">Each execution model may have different identities, either signed or unsigned, and has access to different partitions within the Keychain.</span></span> <span data-ttu-id="fb660-149">Les certificats importés par un mode peuvent ne pas être accessibles à partir d’un autre.</span><span class="sxs-lookup"><span data-stu-id="fb660-149">Certificates imported by one mode may not be accessible from another.</span></span> <span data-ttu-id="fb660-150">Par exemple, les versions certifiées de .NET Core ont un hôte par défaut qui est signé.</span><span class="sxs-lookup"><span data-stu-id="fb660-150">For example, the notarized versions of .NET Core have a default host that is signed.</span></span> <span data-ttu-id="fb660-151">Les certificats sont importés dans une partition sécurisée en fonction de son identité.</span><span class="sxs-lookup"><span data-stu-id="fb660-151">Certificates are imported into a secure partition based on its identity.</span></span> <span data-ttu-id="fb660-152">Ces certificats ne sont pas accessibles à partir d’un appHost généré, car le appHost n’est pas signé.</span><span class="sxs-lookup"><span data-stu-id="fb660-152">These certificates aren't accessible from a generated appHost, as the appHost is unsigned.</span></span>

<span data-ttu-id="fb660-153">Un autre exemple, par défaut, ASP.NET Core importe un certificat SSL par défaut par le biais de l’hôte par défaut.</span><span class="sxs-lookup"><span data-stu-id="fb660-153">Another example, by default, ASP.NET Core imports a default SSL certificate through the default host.</span></span> <span data-ttu-id="fb660-154">ASP.NET Core applications qui utilisent un appHost n’ont pas accès à ce certificat et recevront une erreur quand .NET Core détecte que le certificat n’est pas accessible.</span><span class="sxs-lookup"><span data-stu-id="fb660-154">ASP.NET Core applications that use an appHost won't have access to this certificate and will receive an error when .NET Core detects the certificate isn't accessible.</span></span> <span data-ttu-id="fb660-155">Le message d’erreur fournit des instructions sur la façon de résoudre ce problème.</span><span class="sxs-lookup"><span data-stu-id="fb660-155">The error message provides instructions on how to fix this problem.</span></span>

<span data-ttu-id="fb660-156">Si le partage de certificats est requis, macOS fournit des options de configuration avec l' `security` utilitaire.</span><span class="sxs-lookup"><span data-stu-id="fb660-156">If certificate sharing is required, macOS provides configuration options with the `security` utility.</span></span>

<span data-ttu-id="fb660-157">Pour plus d’informations sur la résolution des problèmes liés aux certificats de ASP.NET Core, consultez [appliquer https dans ASP.net Core](/aspnet/core/security/enforcing-ssl?view=aspnetcore-3.1&tabs=visual-studio#troubleshoot-certificate-problems).</span><span class="sxs-lookup"><span data-stu-id="fb660-157">For more information on how to troubleshoot ASP.NET Core certificate issues, see [Enforce HTTPS in ASP.NET Core](/aspnet/core/security/enforcing-ssl?view=aspnetcore-3.1&tabs=visual-studio#troubleshoot-certificate-problems).</span></span>

## <a name="default-entitlements"></a><span data-ttu-id="fb660-158">Droits par défaut</span><span class="sxs-lookup"><span data-stu-id="fb660-158">Default entitlements</span></span>

<span data-ttu-id="fb660-159">L’hôte par défaut de .NET Core ( `dotnet` commande) a un ensemble de droits par défaut.</span><span class="sxs-lookup"><span data-stu-id="fb660-159">.NET Core's default host (the `dotnet` command) has a set of default entitlements.</span></span> <span data-ttu-id="fb660-160">Ces droits sont requis pour le bon fonctionnement de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="fb660-160">These entitlements are required for proper operation of .NET Core.</span></span> <span data-ttu-id="fb660-161">Il est possible que votre application ait besoin de droits supplémentaires. dans ce cas, vous devrez générer et utiliser un [apphost](#apphost-is-disabled-by-default) , puis ajouter les droits nécessaires localement.</span><span class="sxs-lookup"><span data-stu-id="fb660-161">It's possible that your application may need additional entitlements, in which case you'll need to generate and use an [appHost](#apphost-is-disabled-by-default) and then add the necessary entitlements locally.</span></span>

<span data-ttu-id="fb660-162">Ensemble par défaut des droits pour .NET Core :</span><span class="sxs-lookup"><span data-stu-id="fb660-162">Default set of entitlements for .NET Core:</span></span>

- `com.apple.security.cs.allow-jit`
- `com.apple.security.cs.allow-unsigned-executable-memory`
- `com.apple.security.cs.allow-dyld-environment-variables`
- `com.apple.security.cs.disable-library-validation`

## <a name="notarize-a-net-core-app"></a><span data-ttu-id="fb660-163">Notaire une application .NET Core</span><span class="sxs-lookup"><span data-stu-id="fb660-163">Notarize a .NET Core app</span></span>

<span data-ttu-id="fb660-164">Si vous souhaitez que votre application s’exécute sur macOS Catalina (version 10,15) ou une version ultérieure, vous souhaiterez que votre application soit authentifiée.</span><span class="sxs-lookup"><span data-stu-id="fb660-164">If you want your application to run on macOS Catalina (version 10.15) or higher, you'll want to notarize your app.</span></span> <span data-ttu-id="fb660-165">Le appHost que vous envoyez avec votre application pour la notaire doit être utilisé avec au moins les mêmes [droits par défaut](#default-entitlements) pour .net core.</span><span class="sxs-lookup"><span data-stu-id="fb660-165">The appHost you submit with your application for notarization should be used with at least the same [default entitlements](#default-entitlements) for .NET Core.</span></span>

## <a name="next-steps"></a><span data-ttu-id="fb660-166">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="fb660-166">Next steps</span></span>

- <span data-ttu-id="fb660-167">[Dépendances et exigences .net Core](macos.md#dependencies).</span><span class="sxs-lookup"><span data-stu-id="fb660-167">[.NET Core dependencies and requirements](macos.md#dependencies).</span></span>
- <span data-ttu-id="fb660-168">[Installez le runtime et le kit de développement logiciel (SDK) .net Core](macos.md).</span><span class="sxs-lookup"><span data-stu-id="fb660-168">[Install the .NET Core Runtime and SDK](macos.md).</span></span>

---
title: Travailler avec macOS Catalina Notarization
description: Comment gérer les problèmes de notarisation et de certificat avec macOS lorsque vous installez le temps d’exécution .NET Core, SDK, et les applications construites avec .NET Core.
author: thraka
ms.author: adegeo
ms.date: 02/14/2020
ms.openlocfilehash: be39c1ea56699f84736a2b37bc958507b16e826b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/14/2020
ms.locfileid: "79146747"
---
# <a name="macos-catalina-notarization-and-the-impact-on-net-core-downloads-and-projects"></a><span data-ttu-id="39694-103">macOS Catalina Notarization et l’impact sur les téléchargements et projets .NET Core</span><span class="sxs-lookup"><span data-stu-id="39694-103">macOS Catalina Notarization and the impact on .NET Core downloads and projects</span></span>

<span data-ttu-id="39694-104">À partir de macOS Catalina (version 10.15), tous les logiciels construits après le 1er juin 2019 et distribués avec Developer ID, doivent être notariés.</span><span class="sxs-lookup"><span data-stu-id="39694-104">Beginning with macOS Catalina (version 10.15), all software built after June 1, 2019, and distributed with Developer ID, must be notarized.</span></span> <span data-ttu-id="39694-105">Cette exigence s’applique au temps d’exécution .NET Core, .NET Core SDK, et au logiciel créé avec .NET Core.</span><span class="sxs-lookup"><span data-stu-id="39694-105">This requirement applies to the .NET Core runtime, .NET Core SDK, and software created with .NET Core.</span></span> <span data-ttu-id="39694-106">Cet article décrit les scénarios communs que vous pouvez faire face avec .NET Core et macOS notarization.</span><span class="sxs-lookup"><span data-stu-id="39694-106">This article describes the common scenarios you may face with .NET Core and macOS notarization.</span></span>

## <a name="installing-net-core"></a><span data-ttu-id="39694-107">Installation de .NET Core</span><span class="sxs-lookup"><span data-stu-id="39694-107">Installing .NET Core</span></span>

<span data-ttu-id="39694-108">Les installateurs pour les versions .NET Core (à la fois en runtime et SDK) 3.1, 3.0 et 2.1, ont été notariés depuis le 18 février 2020.</span><span class="sxs-lookup"><span data-stu-id="39694-108">The installers for .NET Core (both runtime and SDK) versions 3.1, 3.0, and 2.1, have been notarized since February 18, 2020.</span></span> <span data-ttu-id="39694-109">Les versions publiées antérieurement ne sont pas notariées.</span><span class="sxs-lookup"><span data-stu-id="39694-109">Prior released versions aren't notarized.</span></span> <span data-ttu-id="39694-110">Vous pouvez installer manuellement une version non notariée de .NET Core en `sudo installer` téléchargeant d’abord l’installateur, puis en utilisant la commande.</span><span class="sxs-lookup"><span data-stu-id="39694-110">You can manually install a non-notarized version of .NET Core by first downloading the installer, and then using the `sudo installer` command.</span></span> <span data-ttu-id="39694-111">Pour plus d’informations, voir [Télécharger et installer manuellement pour macOS](sdk.md?pivots=os-macos#download-and-manually-install).</span><span class="sxs-lookup"><span data-stu-id="39694-111">For more information, see [Download and manually install for macOS](sdk.md?pivots=os-macos#download-and-manually-install).</span></span>

<span data-ttu-id="39694-112">En commençant par les versions suivantes, les installateurs .NET Core sont notariés :</span><span class="sxs-lookup"><span data-stu-id="39694-112">Beginning with the following versions, the .NET Core installers are notarized:</span></span>

- <span data-ttu-id="39694-113">Runtime .NET Core</span><span class="sxs-lookup"><span data-stu-id="39694-113">.NET Core Runtime</span></span>
  - <span data-ttu-id="39694-114">2.1.16</span><span class="sxs-lookup"><span data-stu-id="39694-114">2.1.16</span></span>
  - <span data-ttu-id="39694-115">3.0.3</span><span class="sxs-lookup"><span data-stu-id="39694-115">3.0.3</span></span>
  - <span data-ttu-id="39694-116">3.1.2</span><span class="sxs-lookup"><span data-stu-id="39694-116">3.1.2</span></span>

- <span data-ttu-id="39694-117">SDK .NET Core</span><span class="sxs-lookup"><span data-stu-id="39694-117">.NET Core SDK</span></span>
  - <span data-ttu-id="39694-118">2.1.512</span><span class="sxs-lookup"><span data-stu-id="39694-118">2.1.512</span></span>
  - <span data-ttu-id="39694-119">3.0.103</span><span class="sxs-lookup"><span data-stu-id="39694-119">3.0.103</span></span>
  - <span data-ttu-id="39694-120">3.1.102</span><span class="sxs-lookup"><span data-stu-id="39694-120">3.1.102</span></span>

## <a name="apphost-is-disabled-by-default"></a><span data-ttu-id="39694-121">appHost est désactivé par défaut</span><span class="sxs-lookup"><span data-stu-id="39694-121">appHost is disabled by default</span></span>

<span data-ttu-id="39694-122">Par défaut, les versions non notariées du .NET Core SDK 3.0 et plus produisent un Mach-O natif exécutable (connu sous le nom **d’appHost**) lorsque votre projet compile, publie ou est exécuté.</span><span class="sxs-lookup"><span data-stu-id="39694-122">By default, non-notarized versions of the .NET Core SDK 3.0 and above produce a native Mach-O executable (known as the **appHost**) when your project compiles, publishes, or is run.</span></span> <span data-ttu-id="39694-123">Cet exécutable est un moyen pratique d’exécuter votre application.</span><span class="sxs-lookup"><span data-stu-id="39694-123">This executable is a convenient way to run your app.</span></span> <span data-ttu-id="39694-124">Sinon, votre application doit `dotnet <filename.dll>`être lancée en cours d’exécution .</span><span class="sxs-lookup"><span data-stu-id="39694-124">Otherwise, your app must be started by running `dotnet <filename.dll>`.</span></span> <span data-ttu-id="39694-125">Lorsque l’appHost est `dotnet run` activé, la commande est invoquée dans le contexte de l’appHost.</span><span class="sxs-lookup"><span data-stu-id="39694-125">When the appHost is enabled, the `dotnet run` command is invoked in the context of the appHost.</span></span> <span data-ttu-id="39694-126">Pour plus d’informations, voir [Contexte de l’appHost](#context-of-the-apphost).</span><span class="sxs-lookup"><span data-stu-id="39694-126">For more information, see [Context of the appHost](#context-of-the-apphost).</span></span>

<span data-ttu-id="39694-127">En commençant par les versions notariées du .NET Core SDK 3.0 et plus, l’appHost exécutable n’est pas généré par défaut.</span><span class="sxs-lookup"><span data-stu-id="39694-127">Starting with the notarized versions of the .NET Core SDK 3.0 and above, the appHost executable isn't generated by default.</span></span> <span data-ttu-id="39694-128">Vous pouvez activer la génération [`UseAppHost`](../project-sdk/msbuild-props.md#useapphost) d’appHost avec le paramètre boolean dans le fichier du projet.</span><span class="sxs-lookup"><span data-stu-id="39694-128">You can turn on appHost generation with the [`UseAppHost`](../project-sdk/msbuild-props.md#useapphost) boolean setting in the project file.</span></span> <span data-ttu-id="39694-129">Vous pouvez également basculer l’appHost avec le `-p:UseAppHost` paramètre sur la ligne de commande pour la commande spécifique que `dotnet` vous exécutez:</span><span class="sxs-lookup"><span data-stu-id="39694-129">You can also toggle the appHost with the `-p:UseAppHost` parameter on the command line for the specific `dotnet` command you run:</span></span>

- <span data-ttu-id="39694-130">Fichier projet</span><span class="sxs-lookup"><span data-stu-id="39694-130">Project file</span></span>

  ```xml
  <PropertyGroup>
    <UseAppHost>true</UseAppHost>
  </PropertyGroup>
  ```

- <span data-ttu-id="39694-131">Paramètre de ligne de commande</span><span class="sxs-lookup"><span data-stu-id="39694-131">Command-line parameter</span></span>

  ```dotnetcli
  dotnet run -p:UseAppHost=true
  ```

<span data-ttu-id="39694-132">Un appHost est toujours créé lorsque vous publiez votre application [autonome](../deploying/index.md#publish-self-contained).</span><span class="sxs-lookup"><span data-stu-id="39694-132">An appHost is always created when you publish your app [self-contained](../deploying/index.md#publish-self-contained).</span></span>

<span data-ttu-id="39694-133">Pour plus d’informations sur le `UseAppHost` paramètre, voir [propriétés MSBuild pour Microsoft.NET.Sdk](../project-sdk/msbuild-props.md#useapphost).</span><span class="sxs-lookup"><span data-stu-id="39694-133">For more information about the `UseAppHost` setting, see [MSBuild properties for Microsoft.NET.Sdk](../project-sdk/msbuild-props.md#useapphost).</span></span>

### <a name="context-of-the-apphost"></a><span data-ttu-id="39694-134">Contexte de l’appHost</span><span class="sxs-lookup"><span data-stu-id="39694-134">Context of the appHost</span></span>

<span data-ttu-id="39694-135">Lorsque l’appHost est activé dans votre `dotnet run` projet, et que vous utilisez la commande pour exécuter votre application, l’application est `dotnet` invoquée dans le contexte de l’appHost et non l’hôte par défaut (l’hôte par défaut est la commande).</span><span class="sxs-lookup"><span data-stu-id="39694-135">When the appHost is enabled in your project, and you use the `dotnet run` command to run your app, the app is invoked in the context of the appHost and not the default host (the default host is the `dotnet` command).</span></span> <span data-ttu-id="39694-136">Si l’appHost est désactivé `dotnet run` dans votre projet, la commande exécute votre application dans le cadre de l’hôte par défaut.</span><span class="sxs-lookup"><span data-stu-id="39694-136">If the appHost is disabled in your project, the `dotnet run` command runs your app in the context of the default host.</span></span> <span data-ttu-id="39694-137">Même si l’appHost est désactivé, la publication de votre application en tant qu’autonome génère une application Host exécutable, et les utilisateurs utilisent celui exécutable pour exécuter votre application.</span><span class="sxs-lookup"><span data-stu-id="39694-137">Even if the appHost is disabled, publishing your app as self-contained generates an appHost executable, and users use that executable to run your app.</span></span> <span data-ttu-id="39694-138">Exécution de `dotnet <filename.dll>` votre application avec invoque l’application avec l’hôte par défaut, l’heure d’exécution partagée.</span><span class="sxs-lookup"><span data-stu-id="39694-138">Running your app with `dotnet <filename.dll>` invokes the app with the default host, the shared runtime.</span></span>

<span data-ttu-id="39694-139">Lorsqu’une application utilisant l’appHost est invoquée, la partition de certificat consultée par l’application est différente de l’hôte par défaut notarié.</span><span class="sxs-lookup"><span data-stu-id="39694-139">When an app using the appHost is invoked, the certificate partition accessed by the app is different from the notarized default host.</span></span> <span data-ttu-id="39694-140">Si votre application doit accéder aux certificats installés `dotnet run` via l’hôte par défaut, utilisez `dotnet <filename.dll>` la commande pour exécuter votre application à partir de son fichier de projet, ou utilisez la commande pour démarrer l’application directement.</span><span class="sxs-lookup"><span data-stu-id="39694-140">If your app must access the certificates installed through the default host, use the `dotnet run` command to run your app from its project file, or use the `dotnet <filename.dll>` command to start the app directly.</span></span>

<span data-ttu-id="39694-141">Plus d’informations sur ce scénario sont fournies dans la section [ASP.NET Core et macOS et certificats.](#aspnet-core-and-macos-and-certificates)</span><span class="sxs-lookup"><span data-stu-id="39694-141">More information about this scenario is provided in the [ASP.NET Core and macOS and certificates](#aspnet-core-and-macos-and-certificates) section.</span></span>

## <a name="aspnet-core-and-macos-and-certificates"></a><span data-ttu-id="39694-142">ASP.NET Core et macOS et certificats</span><span class="sxs-lookup"><span data-stu-id="39694-142">ASP.NET Core and macOS and certificates</span></span>

<span data-ttu-id="39694-143">.NET Core offre la possibilité de gérer les certificats <xref:System.Security.Cryptography.X509Certificates> dans le macOS Keychain avec la classe.</span><span class="sxs-lookup"><span data-stu-id="39694-143">.NET Core provides the ability to manage certificates in the macOS Keychain with the <xref:System.Security.Cryptography.X509Certificates> class.</span></span> <span data-ttu-id="39694-144">L’accès au macOS Keychain utilise l’identité des applications comme clé principale lors de la décision de la partition à considérer.</span><span class="sxs-lookup"><span data-stu-id="39694-144">Access to the macOS Keychain uses the applications identity as the primary key when deciding which partition to consider.</span></span> <span data-ttu-id="39694-145">Par exemple, les applications non signées stockent des secrets dans la partition non signée, mais les applications signées stockent leurs secrets dans des partitions qu’elles peuvent accéder.</span><span class="sxs-lookup"><span data-stu-id="39694-145">For example, unsigned applications store secrets in the unsigned partition, but signed applications store their secrets in partitions only they can access.</span></span> <span data-ttu-id="39694-146">La source d’exécution qui invoque votre application décide de la partition à utiliser.</span><span class="sxs-lookup"><span data-stu-id="39694-146">The source of execution that invokes your app decides which partition to use.</span></span>

<span data-ttu-id="39694-147">.NET Core fournit trois sources d’exécution : `dotnet` [appHost](#apphost-is-disabled-by-default), hôte par défaut (la commande) et hôte personnalisé.</span><span class="sxs-lookup"><span data-stu-id="39694-147">.NET Core provides three sources of execution: [appHost](#apphost-is-disabled-by-default), default host (the `dotnet` command), and a custom host.</span></span> <span data-ttu-id="39694-148">Chaque modèle d’exécution peut avoir des identités différentes, signées ou non signées, et a accès à différentes partitions au sein du Keychain.</span><span class="sxs-lookup"><span data-stu-id="39694-148">Each execution model may have different identities, either signed or unsigned, and has access to different partitions within the Keychain.</span></span> <span data-ttu-id="39694-149">Les certificats importés par un mode peuvent ne pas être accessibles à partir d’un autre.</span><span class="sxs-lookup"><span data-stu-id="39694-149">Certificates imported by one mode may not be accessible from another.</span></span> <span data-ttu-id="39694-150">Par exemple, les versions notariées de .NET Core ont un hôte par défaut qui est signé.</span><span class="sxs-lookup"><span data-stu-id="39694-150">For example, the notarized versions of .NET Core have a default host that is signed.</span></span> <span data-ttu-id="39694-151">Les certificats sont importés dans une partition sécurisée en fonction de son identité.</span><span class="sxs-lookup"><span data-stu-id="39694-151">Certificates are imported into a secure partition based on its identity.</span></span> <span data-ttu-id="39694-152">Ces certificats ne sont pas accessibles à partir d’une appHost générée, car l’appHost n’est pas signé.</span><span class="sxs-lookup"><span data-stu-id="39694-152">These certificates aren't accessible from a generated appHost, as the appHost is unsigned.</span></span>

<span data-ttu-id="39694-153">Un autre exemple, par défaut, ASP.NET Core importe un certificat SSL par défaut par l’intermédiaire de l’hôte par défaut.</span><span class="sxs-lookup"><span data-stu-id="39694-153">Another example, by default, ASP.NET Core imports a default SSL certificate through the default host.</span></span> <span data-ttu-id="39694-154">ASP.NET applications de base qui utilisent un appHost n’auront pas accès à ce certificat et recevront une erreur lorsque .NET Core détecte que le certificat n’est pas accessible.</span><span class="sxs-lookup"><span data-stu-id="39694-154">ASP.NET Core applications that use an appHost won't have access to this certificate and will receive an error when .NET Core detects the certificate isn't accessible.</span></span> <span data-ttu-id="39694-155">Le message d’erreur fournit des instructions sur la façon de résoudre ce problème.</span><span class="sxs-lookup"><span data-stu-id="39694-155">The error message provides instructions on how to fix this problem.</span></span>

<span data-ttu-id="39694-156">Si le partage de certificat est nécessaire, macOS fournit des options de configuration avec l’utilitaire. `security`</span><span class="sxs-lookup"><span data-stu-id="39694-156">If certificate sharing is required, macOS provides configuration options with the `security` utility.</span></span>

<span data-ttu-id="39694-157">Pour plus d’informations sur la façon de dépanner ASP.NET questions de certificat de base, voir [Enforce HTTPS dans ASP.NET Core](/aspnet/core/security/enforcing-ssl?view=aspnetcore-3.1&tabs=visual-studio#troubleshoot-certificate-problems).</span><span class="sxs-lookup"><span data-stu-id="39694-157">For more information on how to troubleshoot ASP.NET Core certificate issues, see [Enforce HTTPS in ASP.NET Core](/aspnet/core/security/enforcing-ssl?view=aspnetcore-3.1&tabs=visual-studio#troubleshoot-certificate-problems).</span></span>

## <a name="default-entitlements"></a><span data-ttu-id="39694-158">Droits par défaut</span><span class="sxs-lookup"><span data-stu-id="39694-158">Default entitlements</span></span>

<span data-ttu-id="39694-159">.NET Core’s default `dotnet` host (la commande) a un ensemble de droits par défaut.</span><span class="sxs-lookup"><span data-stu-id="39694-159">.NET Core’s default host (the `dotnet` command) has a set of default entitlements.</span></span> <span data-ttu-id="39694-160">Ces droits sont requis pour le bon fonctionnement de .NET Core.</span><span class="sxs-lookup"><span data-stu-id="39694-160">These entitlements are required for proper operation of .NET Core.</span></span> <span data-ttu-id="39694-161">Il est possible que votre demande ait besoin de droits supplémentaires, auquel cas vous devrez générer et utiliser une [appHost,](#apphost-is-disabled-by-default) puis ajouter les droits nécessaires localement.</span><span class="sxs-lookup"><span data-stu-id="39694-161">It's possible that your application may need additional entitlements, in which case you'll need to generate and use an [appHost](#apphost-is-disabled-by-default) and then add the necessary entitlements locally.</span></span>

<span data-ttu-id="39694-162">Ensemble de droits par défaut pour .NET Core:</span><span class="sxs-lookup"><span data-stu-id="39694-162">Default set of entitlements for .NET Core:</span></span>

- `com.apple.security.cs.allow-jit`
- `com.apple.security.cs.allow-unsigned-executable-memory`
- `com.apple.security.cs.allow-dyld-environment-variables`
- `com.apple.security.cs.disable-library-validation`

## <a name="notarize-a-net-core-app"></a><span data-ttu-id="39694-163">Notarize a .NET Core app</span><span class="sxs-lookup"><span data-stu-id="39694-163">Notarize a .NET Core app</span></span>

<span data-ttu-id="39694-164">Si vous souhaitez que votre application s’exécute sur macOS Catalina (version 10.15) ou plus, vous voudrez notarier votre application.</span><span class="sxs-lookup"><span data-stu-id="39694-164">If you want your application to run on macOS Catalina (version 10.15) or higher, you'll want to notarize your app.</span></span> <span data-ttu-id="39694-165">L’appHost que vous soumettez avec votre demande de notarisation doit être utilisé avec au moins les mêmes [droits par défaut](#default-entitlements) pour .NET Core.</span><span class="sxs-lookup"><span data-stu-id="39694-165">The appHost you submit with your application for notarization should be used with at least the same [default entitlements](#default-entitlements) for .NET Core.</span></span>

## <a name="next-steps"></a><span data-ttu-id="39694-166">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="39694-166">Next steps</span></span>

- <span data-ttu-id="39694-167">[.NET Dépendances et exigences](dependencies.md)de base .</span><span class="sxs-lookup"><span data-stu-id="39694-167">[.NET Core dependencies and requirements](dependencies.md).</span></span>
- <span data-ttu-id="39694-168">[Installer le .NET Core SDK](sdk.md).</span><span class="sxs-lookup"><span data-stu-id="39694-168">[Install the .NET Core SDK](sdk.md).</span></span>
- [<span data-ttu-id="39694-169">Installer le .NET Core Runtime</span><span class="sxs-lookup"><span data-stu-id="39694-169">Install the .NET Core Runtime</span></span>](runtime.md)

---
title: Comprendre AssemblyLoadContext-.NET Core
description: Concepts clés pour comprendre l’objectif et le comportement de AssemblyLoadContext dans .NET Core.
ms.date: 08/09/2019
author: sdmaclea
ms.author: stmaclea
ms.openlocfilehash: 4d3f0e50e7c336469bd9af4d1589427388684434
ms.sourcegitcommit: dfcbc096ad7908cd58a5f0aeabd2256f05266bac
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/21/2020
ms.locfileid: "92332820"
---
# <a name="understanding-systemruntimeloaderassemblyloadcontext"></a><span data-ttu-id="d6978-103">Fonctionnement de System. Runtime. Loader. AssemblyLoadContext</span><span class="sxs-lookup"><span data-stu-id="d6978-103">Understanding System.Runtime.Loader.AssemblyLoadContext</span></span>

<span data-ttu-id="d6978-104">La <xref:System.Runtime.Loader.AssemblyLoadContext> classe est unique à .net core.</span><span class="sxs-lookup"><span data-stu-id="d6978-104">The <xref:System.Runtime.Loader.AssemblyLoadContext> class is unique to .NET Core.</span></span> <span data-ttu-id="d6978-105">Cet article tente de compléter la <xref:System.Runtime.Loader.AssemblyLoadContext> documentation de l’API à l’aide d’informations conceptuelles.</span><span class="sxs-lookup"><span data-stu-id="d6978-105">This article attempts to supplement the <xref:System.Runtime.Loader.AssemblyLoadContext> API documentation with conceptual information.</span></span>

<span data-ttu-id="d6978-106">Cet article s’applique aux développeurs qui implémentent le chargement dynamique, en particulier les développeurs d’infrastructures de chargement dynamique.</span><span class="sxs-lookup"><span data-stu-id="d6978-106">This article is relevant to developers implementing dynamic loading, especially dynamic loading framework developers.</span></span>

## <a name="what-is-the-assemblyloadcontext"></a><span data-ttu-id="d6978-107">Qu’est-ce que le AssemblyLoadContext ?</span><span class="sxs-lookup"><span data-stu-id="d6978-107">What is the AssemblyLoadContext?</span></span>

<span data-ttu-id="d6978-108">Chaque application .NET Core utilise implicitement le <xref:System.Runtime.Loader.AssemblyLoadContext> .</span><span class="sxs-lookup"><span data-stu-id="d6978-108">Every .NET Core application implicitly uses the <xref:System.Runtime.Loader.AssemblyLoadContext>.</span></span>
<span data-ttu-id="d6978-109">Il s’agit du fournisseur du runtime pour la localisation et le chargement des dépendances.</span><span class="sxs-lookup"><span data-stu-id="d6978-109">It's the runtime's provider for locating and loading dependencies.</span></span> <span data-ttu-id="d6978-110">Chaque fois qu’une dépendance est chargée, une <xref:System.Runtime.Loader.AssemblyLoadContext> instance est appelée pour la localiser.</span><span class="sxs-lookup"><span data-stu-id="d6978-110">Whenever a dependency is loaded, an <xref:System.Runtime.Loader.AssemblyLoadContext> instance is invoked to locate it.</span></span>

- <span data-ttu-id="d6978-111">Il fournit un service de localisation, de chargement et de mise en cache des assemblys managés et d’autres dépendances.</span><span class="sxs-lookup"><span data-stu-id="d6978-111">It provides a service of locating, loading, and caching managed assemblies and other dependencies.</span></span>

- <span data-ttu-id="d6978-112">Pour prendre en charge le chargement et le déchargement de code dynamique, il crée un contexte isolé pour le chargement du code et de ses dépendances dans sa propre <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span><span class="sxs-lookup"><span data-stu-id="d6978-112">To support dynamic code loading and unloading, it creates an isolated context for loading code and its dependencies in their own <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span>

## <a name="when-do-you-need-multiple-assemblyloadcontext-instances"></a><span data-ttu-id="d6978-113">Quand avez-vous besoin de plusieurs instances AssemblyLoadContext ?</span><span class="sxs-lookup"><span data-stu-id="d6978-113">When do you need multiple AssemblyLoadContext instances?</span></span>

<span data-ttu-id="d6978-114">Une seule <xref:System.Runtime.Loader.AssemblyLoadContext> instance est limitée au chargement d’une seule version d’un <xref:System.Reflection.Assembly> nom d’assembly par simple, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="d6978-114">A single <xref:System.Runtime.Loader.AssemblyLoadContext> instance is limited to loading exactly one version of an <xref:System.Reflection.Assembly> per simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="d6978-115">Cette restriction peut devenir un problème lors du chargement dynamique des modules de code.</span><span class="sxs-lookup"><span data-stu-id="d6978-115">This restriction can become a problem when loading code modules dynamically.</span></span> <span data-ttu-id="d6978-116">Chaque module est compilé indépendamment et peut dépendre de différentes versions d’un <xref:System.Reflection.Assembly> .</span><span class="sxs-lookup"><span data-stu-id="d6978-116">Each module is independently compiled and may depend on different versions of an <xref:System.Reflection.Assembly>.</span></span> <span data-ttu-id="d6978-117">Ce problème se produit généralement lorsque les différents modules dépendent de différentes versions d’une bibliothèque couramment utilisée.</span><span class="sxs-lookup"><span data-stu-id="d6978-117">This problem commonly occurs when different modules depend on different versions of a commonly used library.</span></span>

<span data-ttu-id="d6978-118">Pour prendre en charge le chargement dynamique du code, l' <xref:System.Runtime.Loader.AssemblyLoadContext> API fournit le chargement des versions conflictuelles d’un <xref:System.Reflection.Assembly> dans la même application.</span><span class="sxs-lookup"><span data-stu-id="d6978-118">To support dynamically loading code, the <xref:System.Runtime.Loader.AssemblyLoadContext> API provides for loading conflicting versions of an <xref:System.Reflection.Assembly> in the same application.</span></span> <span data-ttu-id="d6978-119">Chaque <xref:System.Runtime.Loader.AssemblyLoadContext> instance fournit un dictionnaire unique qui mappe chacun <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> à une <xref:System.Reflection.Assembly> instance spécifique.</span><span class="sxs-lookup"><span data-stu-id="d6978-119">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance provides a unique dictionary mapping each <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> to a specific <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="d6978-120">Il fournit également un mécanisme pratique pour regrouper les dépendances liées à un module de code en vue d’un déchargement ultérieur.</span><span class="sxs-lookup"><span data-stu-id="d6978-120">It also provides a convenient mechanism for grouping dependencies related to a code module for later unload.</span></span>

## <a name="what-is-special-about-the-assemblyloadcontextdefault-instance"></a><span data-ttu-id="d6978-121">Qu’est-ce qui est spécial à propos de l’instance AssemblyLoadContext. default ?</span><span class="sxs-lookup"><span data-stu-id="d6978-121">What is special about the AssemblyLoadContext.Default instance?</span></span>

<span data-ttu-id="d6978-122">L' <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance est automatiquement renseignée par le runtime au démarrage.</span><span class="sxs-lookup"><span data-stu-id="d6978-122">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance is automatically populated by the runtime at startup.</span></span>  <span data-ttu-id="d6978-123">Elle utilise la [détection par défaut](default-probing.md) pour rechercher et rechercher toutes les dépendances statiques.</span><span class="sxs-lookup"><span data-stu-id="d6978-123">It uses [default probing](default-probing.md) to locate and find all static dependencies.</span></span>

<span data-ttu-id="d6978-124">Il résout les scénarios de chargement de dépendances les plus courants.</span><span class="sxs-lookup"><span data-stu-id="d6978-124">It solves the most common dependency loading scenarios.</span></span>

## <a name="how-does-assemblyloadcontext-support-dynamic-dependencies"></a><span data-ttu-id="d6978-125">Comment AssemblyLoadContext prend-il en charge les dépendances dynamiques ?</span><span class="sxs-lookup"><span data-stu-id="d6978-125">How does AssemblyLoadContext support dynamic dependencies?</span></span>

<span data-ttu-id="d6978-126"><xref:System.Runtime.Loader.AssemblyLoadContext> a plusieurs événements et fonctions virtuelles qui peuvent être substitués.</span><span class="sxs-lookup"><span data-stu-id="d6978-126"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span>

<span data-ttu-id="d6978-127">L' <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance de ne prend en charge que le remplacement des événements.</span><span class="sxs-lookup"><span data-stu-id="d6978-127">The <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> instance only supports overriding the events.</span></span>

<span data-ttu-id="d6978-128">Les articles [algorithme de chargement d’assembly géré](loading-managed.md), [algorithme de chargement d’assembly satellite](loading-resources.md)et [algorithme de chargement de bibliothèque non managée (natif)](loading-unmanaged.md) font référence à tous les événements et fonctions virtuelles disponibles.</span><span class="sxs-lookup"><span data-stu-id="d6978-128">The articles [Managed assembly loading algorithm](loading-managed.md), [Satellite assembly loading algorithm](loading-resources.md), and [Unmanaged (native) library loading algorithm](loading-unmanaged.md) refer to all the available events and virtual functions.</span></span>  <span data-ttu-id="d6978-129">Les articles montrent la position relative de chaque événement et de chaque fonction dans les algorithmes de chargement.</span><span class="sxs-lookup"><span data-stu-id="d6978-129">The articles show each event and function's relative position in the loading algorithms.</span></span> <span data-ttu-id="d6978-130">Cet article ne reproduit pas ces informations.</span><span class="sxs-lookup"><span data-stu-id="d6978-130">This article doesn't reproduce that information.</span></span>

<span data-ttu-id="d6978-131">Cette section décrit les principes généraux des événements et des fonctions pertinents.</span><span class="sxs-lookup"><span data-stu-id="d6978-131">This section covers the general principles for the relevant events and functions.</span></span>

- <span data-ttu-id="d6978-132">**Soyez renouvelable**.</span><span class="sxs-lookup"><span data-stu-id="d6978-132">**Be repeatable**.</span></span> <span data-ttu-id="d6978-133">Une requête pour une dépendance spécifique doit toujours aboutir à la même réponse.</span><span class="sxs-lookup"><span data-stu-id="d6978-133">A query for a specific dependency must always result in the same response.</span></span> <span data-ttu-id="d6978-134">La même instance de dépendance chargée doit être retournée.</span><span class="sxs-lookup"><span data-stu-id="d6978-134">The same loaded dependency instance must be returned.</span></span> <span data-ttu-id="d6978-135">Cette exigence est fondamentale pour la cohérence du cache.</span><span class="sxs-lookup"><span data-stu-id="d6978-135">This requirement is fundamental  for cache consistency.</span></span> <span data-ttu-id="d6978-136">Pour les assemblys managés, en particulier, nous créons un <xref:System.Reflection.Assembly> cache.</span><span class="sxs-lookup"><span data-stu-id="d6978-136">For managed assemblies in particular, we're creating an <xref:System.Reflection.Assembly> cache.</span></span> <span data-ttu-id="d6978-137">La clé de cache est un nom d’assembly simple, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="d6978-137">The cache key is a simple assembly name, <xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="d6978-138">**En général, ne levez pas d’exception**.</span><span class="sxs-lookup"><span data-stu-id="d6978-138">**Typically don't throw**.</span></span>  <span data-ttu-id="d6978-139">Il est prévu que ces fonctions retournent `null` plutôt que Throw lorsqu’il est impossible de trouver la dépendance demandée.</span><span class="sxs-lookup"><span data-stu-id="d6978-139">It's expected that these functions return `null` rather than throw when unable to find the requested dependency.</span></span> <span data-ttu-id="d6978-140">La levée met fin prématurément à la recherche et propage une exception à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="d6978-140">Throwing will prematurely end the search and be propagate an exception to the caller.</span></span> <span data-ttu-id="d6978-141">La levée doit être limitée à des erreurs inattendues, telles qu’un assembly endommagé ou une condition de mémoire insuffisante.</span><span class="sxs-lookup"><span data-stu-id="d6978-141">Throwing should be restricted to unexpected errors like a corrupted assembly or an out of memory condition.</span></span>
- <span data-ttu-id="d6978-142">**Évitez la récursivité**.</span><span class="sxs-lookup"><span data-stu-id="d6978-142">**Avoid recursion**.</span></span> <span data-ttu-id="d6978-143">N’oubliez pas que ces fonctions et gestionnaires implémentent les règles de chargement pour localiser les dépendances.</span><span class="sxs-lookup"><span data-stu-id="d6978-143">Be aware that these functions and handlers implement the loading rules for locating dependencies.</span></span> <span data-ttu-id="d6978-144">Votre implémentation ne doit pas appeler les API qui déclenchent la récursivité.</span><span class="sxs-lookup"><span data-stu-id="d6978-144">Your implementation shouldn't call APIs that trigger recursion.</span></span> <span data-ttu-id="d6978-145">Votre code doit généralement appeler des fonctions de chargement **AssemblyLoadContext** qui requièrent un argument de référence de mémoire ou un chemin d’accès spécifique.</span><span class="sxs-lookup"><span data-stu-id="d6978-145">Your code should typically call **AssemblyLoadContext** load functions that require a specific path or memory reference argument.</span></span>
- <span data-ttu-id="d6978-146">**Chargez dans le bon AssemblyLoadContext**.</span><span class="sxs-lookup"><span data-stu-id="d6978-146">**Load into the correct AssemblyLoadContext**.</span></span> <span data-ttu-id="d6978-147">Le choix de l’emplacement de chargement des dépendances est spécifique à l’application.</span><span class="sxs-lookup"><span data-stu-id="d6978-147">The choice of where to load dependencies is application-specific.</span></span>  <span data-ttu-id="d6978-148">Le choix est implémenté par ces événements et fonctions.</span><span class="sxs-lookup"><span data-stu-id="d6978-148">The choice is implemented by these events and functions.</span></span> <span data-ttu-id="d6978-149">Lorsque votre code appelle des fonctions de chargement par chemin d’accès **AssemblyLoadContext** , appelez-les sur l’instance où vous souhaitez que le code soit chargé.</span><span class="sxs-lookup"><span data-stu-id="d6978-149">When your code calls **AssemblyLoadContext** load-by-path functions call them on the instance where you want the code loaded.</span></span> <span data-ttu-id="d6978-150">L' `null` <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> option la plus simple consiste à retourner et à gérer le chargement.</span><span class="sxs-lookup"><span data-stu-id="d6978-150">Sometime returning `null` and letting the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> handle the load may be the simplest option.</span></span>
- <span data-ttu-id="d6978-151">**Tenez compte des concurrences de thread**.</span><span class="sxs-lookup"><span data-stu-id="d6978-151">**Be aware of thread races**.</span></span> <span data-ttu-id="d6978-152">Le chargement peut être déclenché par plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="d6978-152">Loading can be triggered by multiple threads.</span></span> <span data-ttu-id="d6978-153">AssemblyLoadContext gère les courses de threads en ajoutant atomiquement des assemblys à son cache.</span><span class="sxs-lookup"><span data-stu-id="d6978-153">The AssemblyLoadContext handles thread races by atomically adding assemblies to its cache.</span></span> <span data-ttu-id="d6978-154">L’instance de la course perdante est ignorée.</span><span class="sxs-lookup"><span data-stu-id="d6978-154">The race loser's instance is discarded.</span></span> <span data-ttu-id="d6978-155">Dans votre logique d’implémentation, n’ajoutez pas de logique supplémentaire qui ne gère pas correctement plusieurs threads.</span><span class="sxs-lookup"><span data-stu-id="d6978-155">In your implementation logic, don't add extra logic that doesn't handle multiple threads properly.</span></span>

## <a name="how-are-dynamic-dependencies-isolated"></a><span data-ttu-id="d6978-156">Comment les dépendances dynamiques sont-elles isolées ?</span><span class="sxs-lookup"><span data-stu-id="d6978-156">How are dynamic dependencies isolated?</span></span>

<span data-ttu-id="d6978-157">Chaque <xref:System.Runtime.Loader.AssemblyLoadContext> instance représente une étendue unique pour les <xref:System.Reflection.Assembly> instances et les <xref:System.Type> définitions.</span><span class="sxs-lookup"><span data-stu-id="d6978-157">Each <xref:System.Runtime.Loader.AssemblyLoadContext> instance represents a unique scope for <xref:System.Reflection.Assembly> instances and <xref:System.Type> definitions.</span></span>

<span data-ttu-id="d6978-158">Il n’y a pas d’isolation binaire entre ces dépendances.</span><span class="sxs-lookup"><span data-stu-id="d6978-158">There's no binary isolation between these dependencies.</span></span> <span data-ttu-id="d6978-159">Elles sont isolées uniquement si elles ne se trouvent pas mutuellement par nom.</span><span class="sxs-lookup"><span data-stu-id="d6978-159">They're only isolated by not finding each other by name.</span></span>

<span data-ttu-id="d6978-160">Dans chaque <xref:System.Runtime.Loader.AssemblyLoadContext> :</span><span class="sxs-lookup"><span data-stu-id="d6978-160">In each <xref:System.Runtime.Loader.AssemblyLoadContext>:</span></span>

- <span data-ttu-id="d6978-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> peut faire référence à une autre <xref:System.Reflection.Assembly> instance.</span><span class="sxs-lookup"><span data-stu-id="d6978-161"><xref:System.Reflection.AssemblyName.Name?displayProperty=nameWithType> may refer to a different <xref:System.Reflection.Assembly> instance.</span></span>
- <span data-ttu-id="d6978-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> peut retourner une instance de type différente pour le même type `name` .</span><span class="sxs-lookup"><span data-stu-id="d6978-162"><xref:System.Type.GetType%2A?displayProperty=nameWithType> may return a different type instance for the same type `name`.</span></span>

## <a name="how-are-dependencies-shared"></a><span data-ttu-id="d6978-163">Comment les dépendances sont-elles partagées ?</span><span class="sxs-lookup"><span data-stu-id="d6978-163">How are dependencies shared?</span></span>

<span data-ttu-id="d6978-164">Les dépendances peuvent facilement être partagées entre les <xref:System.Runtime.Loader.AssemblyLoadContext> instances.</span><span class="sxs-lookup"><span data-stu-id="d6978-164">Dependencies can easily be shared between <xref:System.Runtime.Loader.AssemblyLoadContext> instances.</span></span> <span data-ttu-id="d6978-165">Le modèle général <xref:System.Runtime.Loader.AssemblyLoadContext> permet de charger une dépendance.</span><span class="sxs-lookup"><span data-stu-id="d6978-165">The general model is for one <xref:System.Runtime.Loader.AssemblyLoadContext> to load a dependency.</span></span>  <span data-ttu-id="d6978-166">L’autre partage la dépendance à l’aide d’une référence à l’assembly chargé.</span><span class="sxs-lookup"><span data-stu-id="d6978-166">The other shares the dependency by using a reference to the loaded assembly.</span></span>

<span data-ttu-id="d6978-167">Ce partage est requis pour les assemblys du Runtime.</span><span class="sxs-lookup"><span data-stu-id="d6978-167">This sharing is required of the runtime assemblies.</span></span> <span data-ttu-id="d6978-168">Ces assemblys ne peuvent être chargés que dans le <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="d6978-168">These assemblies can only be loaded into the <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="d6978-169">Il en est de même pour les infrastructures comme `ASP.NET` , `WPF` ou `WinForms` .</span><span class="sxs-lookup"><span data-stu-id="d6978-169">The same is required for frameworks like `ASP.NET`, `WPF`, or `WinForms`.</span></span>

<span data-ttu-id="d6978-170">Il est recommandé de charger les dépendances partagées dans <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="d6978-170">It's recommended that shared dependencies should be loaded into <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType>.</span></span> <span data-ttu-id="d6978-171">Ce partage est le modèle de conception courant.</span><span class="sxs-lookup"><span data-stu-id="d6978-171">This sharing is the common design pattern.</span></span>

<span data-ttu-id="d6978-172">Le partage est implémenté dans le codage de l' <xref:System.Runtime.Loader.AssemblyLoadContext> instance personnalisée.</span><span class="sxs-lookup"><span data-stu-id="d6978-172">Sharing is implemented in the coding of the custom <xref:System.Runtime.Loader.AssemblyLoadContext> instance.</span></span> <span data-ttu-id="d6978-173"><xref:System.Runtime.Loader.AssemblyLoadContext> a plusieurs événements et fonctions virtuelles qui peuvent être substitués.</span><span class="sxs-lookup"><span data-stu-id="d6978-173"><xref:System.Runtime.Loader.AssemblyLoadContext> has various events and virtual functions that can be overridden.</span></span> <span data-ttu-id="d6978-174">Quand l’une de ces fonctions retourne une référence à une <xref:System.Reflection.Assembly> instance qui a été chargée dans une autre <xref:System.Runtime.Loader.AssemblyLoadContext> instance, l' <xref:System.Reflection.Assembly> instance est partagée.</span><span class="sxs-lookup"><span data-stu-id="d6978-174">When any of these functions return a reference to an <xref:System.Reflection.Assembly> instance that was loaded in another <xref:System.Runtime.Loader.AssemblyLoadContext> instance, the <xref:System.Reflection.Assembly> instance is shared.</span></span> <span data-ttu-id="d6978-175">L’algorithme de chargement standard diffère à <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> pour le chargement afin de simplifier le modèle de partage commun.</span><span class="sxs-lookup"><span data-stu-id="d6978-175">The standard load algorithm defers to <xref:System.Runtime.Loader.AssemblyLoadContext.Default?displayProperty=nameWithType> for loading to simplify the common sharing pattern.</span></span>  <span data-ttu-id="d6978-176">Consultez [algorithme de chargement d’assembly managé](loading-managed.md).</span><span class="sxs-lookup"><span data-stu-id="d6978-176">See [Managed assembly loading algorithm](loading-managed.md).</span></span>

## <a name="complications"></a><span data-ttu-id="d6978-177">Complications</span><span class="sxs-lookup"><span data-stu-id="d6978-177">Complications</span></span>

### <a name="type-conversion-issues"></a><span data-ttu-id="d6978-178">Problèmes de conversion de type</span><span class="sxs-lookup"><span data-stu-id="d6978-178">Type conversion issues</span></span>

<span data-ttu-id="d6978-179">Lorsque deux <xref:System.Runtime.Loader.AssemblyLoadContext> instances contiennent des définitions de type `name` , elles ne sont pas du même type.</span><span class="sxs-lookup"><span data-stu-id="d6978-179">When two <xref:System.Runtime.Loader.AssemblyLoadContext> instances contain type definitions with the same `name`, they're not the same type.</span></span> <span data-ttu-id="d6978-180">Ils sont du même type si et seulement s’ils proviennent de la même <xref:System.Reflection.Assembly> instance.</span><span class="sxs-lookup"><span data-stu-id="d6978-180">They're the same type if and only if they come from the same <xref:System.Reflection.Assembly> instance.</span></span>

<span data-ttu-id="d6978-181">Pour compliquer les choses, les messages d’exception concernant ces types incompatibles peuvent prêter à confusion.</span><span class="sxs-lookup"><span data-stu-id="d6978-181">To complicate matters, exception messages about these mismatched types can be confusing.</span></span> <span data-ttu-id="d6978-182">Les types sont référencés dans les messages d’exception par leurs noms de types simples.</span><span class="sxs-lookup"><span data-stu-id="d6978-182">The types are referred to in the exception messages by their simple type names.</span></span> <span data-ttu-id="d6978-183">Dans ce cas, le message d’exception courant se présente sous la forme suivante :</span><span class="sxs-lookup"><span data-stu-id="d6978-183">The common exception message in this case would be of the form:</span></span>

> <span data-ttu-id="d6978-184">L’objet de type’IsolatedType’ne peut pas être converti en type’IsolatedType'.</span><span class="sxs-lookup"><span data-stu-id="d6978-184">Object of type 'IsolatedType' cannot be converted to type 'IsolatedType'.</span></span>

### <a name="debugging-type-conversion-issues"></a><span data-ttu-id="d6978-185">Débogage des problèmes de conversion de type</span><span class="sxs-lookup"><span data-stu-id="d6978-185">Debugging type conversion issues</span></span>

<span data-ttu-id="d6978-186">À partir d’une paire de types incompatibles, il est également important de savoir :</span><span class="sxs-lookup"><span data-stu-id="d6978-186">Given a pair of mismatched types it's important to also know:</span></span>

- <span data-ttu-id="d6978-187">Chaque type <xref:System.Type.Assembly?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="d6978-187">Each type's <xref:System.Type.Assembly?displayProperty=nameWithType></span></span>
- <span data-ttu-id="d6978-188">Chaque type de <xref:System.Runtime.Loader.AssemblyLoadContext> , qui peut être obtenu via la <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> fonction.</span><span class="sxs-lookup"><span data-stu-id="d6978-188">Each type's <xref:System.Runtime.Loader.AssemblyLoadContext>, which can be obtained via the <xref:System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(System.Reflection.Assembly)?displayProperty=nameWithType> function.</span></span>

<span data-ttu-id="d6978-189">À partir de deux objets `a` et `b` , l’évaluation de ce qui suit dans le débogueur s’avère utile :</span><span class="sxs-lookup"><span data-stu-id="d6978-189">Given two objects `a` and `b`, evaluating the following in the debugger will be helpful:</span></span>

```csharp
// In debugger look at each assembly's instance, Location, and FullName
a.GetType().Assembly
b.GetType().Assembly
// In debugger look at each AssemblyLoadContext's instance and name
System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(a.GetType().Assembly)
System.Runtime.Loader.AssemblyLoadContext.GetLoadContext(b.GetType().Assembly)
```

### <a name="resolving-type-conversion-issues"></a><span data-ttu-id="d6978-190">Résolution des problèmes de conversion de type</span><span class="sxs-lookup"><span data-stu-id="d6978-190">Resolving type conversion issues</span></span>

<span data-ttu-id="d6978-191">Il existe deux modèles de conception pour résoudre ces problèmes de conversion de type.</span><span class="sxs-lookup"><span data-stu-id="d6978-191">There are two design patterns for solving these type conversion issues.</span></span>

1. <span data-ttu-id="d6978-192">Utilisez les types partagés communs.</span><span class="sxs-lookup"><span data-stu-id="d6978-192">Use common shared types.</span></span> <span data-ttu-id="d6978-193">Ce type partagé peut être un type de Runtime primitif, ou il peut impliquer la création d’un nouveau type partagé dans un assembly partagé.</span><span class="sxs-lookup"><span data-stu-id="d6978-193">This shared type can either be a primitive runtime type, or it can involve creating a new shared type in a shared assembly.</span></span>  <span data-ttu-id="d6978-194">Le type partagé est souvent une [interface](../../csharp/language-reference/keywords/interface.md) définie dans un assembly d’application.</span><span class="sxs-lookup"><span data-stu-id="d6978-194">Often the shared type is an [interface](../../csharp/language-reference/keywords/interface.md) defined in an application assembly.</span></span> <span data-ttu-id="d6978-195">Voir aussi : [Comment les dépendances sont-elles partagées ?](#how-are-dependencies-shared).</span><span class="sxs-lookup"><span data-stu-id="d6978-195">See also: [How are dependencies shared?](#how-are-dependencies-shared).</span></span>

2. <span data-ttu-id="d6978-196">Utilisez les techniques de marshaling pour convertir d’un type en un autre.</span><span class="sxs-lookup"><span data-stu-id="d6978-196">Use marshaling techniques to convert from one type to another.</span></span>

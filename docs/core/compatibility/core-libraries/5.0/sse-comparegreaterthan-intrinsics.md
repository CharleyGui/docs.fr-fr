---
title: 'Modification avec rupture : les méthodes SSE et SSE2 CompareGreaterThan gèrent correctement les entrées NaN'
description: Découvrez la modification avec rupture .NET 5,0 dans les bibliothèques .NET de base où les méthodes de comparaison SSE et SSE2 ont été corrigées pour gérer correctement les entrées NaN.
ms.date: 11/01/2020
ms.openlocfilehash: 4abffa8d8bf2abfa9ef83673db9154de035d952c
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/24/2020
ms.locfileid: "95760876"
---
# <a name="sse-and-sse2-comparegreaterthan-methods-properly-handle-nan-inputs"></a><span data-ttu-id="37114-103">Les méthodes SSE et SSE2 CompareGreaterThan gèrent correctement les entrées NaN</span><span class="sxs-lookup"><span data-stu-id="37114-103">SSE and SSE2 CompareGreaterThan methods properly handle NaN inputs</span></span>

<span data-ttu-id="37114-104">Les <xref:System.Runtime.Intrinsics.X86.Sse?displayProperty=nameWithType> méthodes et suivantes <xref:System.Runtime.Intrinsics.X86.Sse2?displayProperty=nameWithType> ont été corrigées pour gérer correctement les `NaN` entrées et correspondre au comportement matériel des méthodes équivalentes dans la <xref:System.Runtime.Intrinsics.X86.Avx?displayProperty=nameWithType> classe :</span><span class="sxs-lookup"><span data-stu-id="37114-104">The following <xref:System.Runtime.Intrinsics.X86.Sse?displayProperty=nameWithType> and <xref:System.Runtime.Intrinsics.X86.Sse2?displayProperty=nameWithType> methods have been fixed to properly handle `NaN` inputs and match the hardware behavior of the equivalent methods in the <xref:System.Runtime.Intrinsics.X86.Avx?displayProperty=nameWithType> class:</span></span>

* `CompareGreaterThan`
* `CompareGreaterThanOrEqual`
* `CompareNotGreaterThan`
* `CompareNotGreaterThanOrEqual`
* `CompareScalarGreaterThan`
* `CompareScalarGreaterThanOrEqual`
* `CompareScalarNotGreaterThan`
* `CompareScalarNotGreaterThanOrEqual`

## <a name="change-description"></a><span data-ttu-id="37114-105">Description de la modification</span><span class="sxs-lookup"><span data-stu-id="37114-105">Change description</span></span>

<span data-ttu-id="37114-106">Auparavant, `NaN` les entrées dans les <xref:System.Runtime.Intrinsics.X86.Sse> <xref:System.Runtime.Intrinsics.X86.Sse2> méthodes et retournaient un résultat incorrect.</span><span class="sxs-lookup"><span data-stu-id="37114-106">Previously, `NaN` inputs to the listed <xref:System.Runtime.Intrinsics.X86.Sse> and <xref:System.Runtime.Intrinsics.X86.Sse2> methods returned an incorrect result.</span></span> <span data-ttu-id="37114-107">Le résultat est également différent du résultat généré par la méthode correspondante dans la <xref:System.Runtime.Intrinsics.X86.Avx> classe.</span><span class="sxs-lookup"><span data-stu-id="37114-107">The result also differed from the result generated by the corresponding method in the <xref:System.Runtime.Intrinsics.X86.Avx> class.</span></span>

<span data-ttu-id="37114-108">À compter de .NET 5,0, ces méthodes gèrent correctement `NaN` les entrées et retournent les mêmes résultats que les méthodes correspondantes dans la <xref:System.Runtime.Intrinsics.X86.Avx> classe.</span><span class="sxs-lookup"><span data-stu-id="37114-108">Starting in .NET 5.0, these methods correctly handle `NaN` inputs and return the same results as the corresponding methods in the <xref:System.Runtime.Intrinsics.X86.Avx> class.</span></span>

<span data-ttu-id="37114-109">Les architectures de streaming SIMD Extensions (SSE) et SSE2 (streaming SIMD Extensions 2) (ISA) ne fournissent pas de prise en charge matérielle directe pour ces méthodes de comparaison, afin qu’elles soient implémentées dans le logiciel.</span><span class="sxs-lookup"><span data-stu-id="37114-109">The Streaming SIMD Extensions (SSE) and Streaming SIMD Extensions 2 (SSE2) industry standard architectures (ISAs) don't provide direct hardware support for these comparison methods, so they're implemented in software.</span></span> <span data-ttu-id="37114-110">Auparavant, les méthodes étaient implémentées de manière incorrecte et elles ne géraient pas correctement les `NaN` entrées.</span><span class="sxs-lookup"><span data-stu-id="37114-110">Previously, the methods were improperly implemented, and they incorrectly handled `NaN` inputs.</span></span> <span data-ttu-id="37114-111">Dans le cas d’un code natif, le comportement incorrect peut introduire des bogues.</span><span class="sxs-lookup"><span data-stu-id="37114-111">For code ported from native, the incorrect behavior may introduce bugs.</span></span> <span data-ttu-id="37114-112">Pour un chemin d’accès de code 256 bits, les méthodes peuvent également produire des résultats différents aux méthodes équivalentes dans la <xref:System.Runtime.Intrinsics.X86.Avx> classe.</span><span class="sxs-lookup"><span data-stu-id="37114-112">For a 256-bit code path, the methods can also produce different results to the equivalent methods in the <xref:System.Runtime.Intrinsics.X86.Avx> class.</span></span>

<span data-ttu-id="37114-113">En guise d’exemple de la façon dont les méthodes étaient précédemment incorrectes, vous pouvez implémenter `CompareNotGreaterThan(x,y)` comme `CompareLessThanOrEqual(x,y)` pour les entiers normaux.</span><span class="sxs-lookup"><span data-stu-id="37114-113">As an example of how the methods were previously incorrect, you can implement `CompareNotGreaterThan(x,y)` as `CompareLessThanOrEqual(x,y)` for regular integers.</span></span> <span data-ttu-id="37114-114">Toutefois, pour `NaN` les entrées, cette logique calcule le résultat incorrect.</span><span class="sxs-lookup"><span data-stu-id="37114-114">However, for `NaN` inputs, that logic computes the wrong result.</span></span> <span data-ttu-id="37114-115">Au lieu de cela, l’utilisation de `CompareNotLessThan(y,x)` compare les nombres correctement *et* prend `NaN` en compte les entrées.</span><span class="sxs-lookup"><span data-stu-id="37114-115">Instead, using `CompareNotLessThan(y,x)` compares the numbers correctly *and* takes `NaN` inputs into consideration.</span></span>

## <a name="version-introduced"></a><span data-ttu-id="37114-116">Version introduite</span><span class="sxs-lookup"><span data-stu-id="37114-116">Version introduced</span></span>

<span data-ttu-id="37114-117">5.0</span><span class="sxs-lookup"><span data-stu-id="37114-117">5.0</span></span>

## <a name="recommended-action"></a><span data-ttu-id="37114-118">Action recommandée</span><span class="sxs-lookup"><span data-stu-id="37114-118">Recommended action</span></span>

- <span data-ttu-id="37114-119">Si le comportement précédent était un bogue, aucune modification n’est requise.</span><span class="sxs-lookup"><span data-stu-id="37114-119">If the previous behavior was a bug, no change is required.</span></span>

- <span data-ttu-id="37114-120">Si le comportement précédent était souhaité, vous pouvez maintenir ce comportement en modifiant l’appel approprié comme suit :</span><span class="sxs-lookup"><span data-stu-id="37114-120">If the previous behavior was desired, you can maintain that behavior by changing the relevant invocation as follows:</span></span>

  * `CompareGreaterThan(x,y)` -> `CompareNotLessThanOrEqual(x,y)`
  * `CompareGreaterThanOrEqual(x,y)` -> `CompareNotLessThan(x,y)`
  * `CompareNotGreaterThan(x,y)` -> `CompareLessThanOrEqual(x,y)`
  * `CompareNotGreaterThanOrEqual(x,y)` -> `CompareLessThan(x,y)`
  * `CompareScalarGreaterThan(x,y)` -> `CompareScalarNotLessThanOrEqual(x,y)`
  * `CompareScalarGreaterThanOrEqual(x,y)` -> `CompareScalarNotLessThan(x,y)`
  * `CompareScalarNotGreaterThan(x,y)` -> `CompareScalarLessThanOrEqual(x,y)`
  * `CompareScalarNotGreaterThanOrEqual(x,y)` -> `CompareScalarLessThan(x,y)`

## <a name="affected-apis"></a><span data-ttu-id="37114-121">API affectées</span><span class="sxs-lookup"><span data-stu-id="37114-121">Affected APIs</span></span>

- <xref:System.Runtime.Intrinsics.X86.Sse.CompareGreaterThan(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse.CompareGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse.CompareNotGreaterThan(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse.CompareNotGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse.CompareScalarGreaterThan(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse.CompareScalarGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse.CompareScalarNotGreaterThan(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse.CompareScalarNotGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})?displayProperty=fullName>

- <xref:System.Runtime.Intrinsics.X86.Sse2.CompareGreaterThan(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse2.CompareGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse2.CompareNotGreaterThan(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse2.CompareNotGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse2.CompareScalarGreaterThan(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse2.CompareScalarGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse2.CompareScalarNotGreaterThan(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})?displayProperty=fullName>
- <xref:System.Runtime.Intrinsics.X86.Sse2.CompareScalarNotGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})?displayProperty=fullName>

<!--

#### Category

Core .NET libraries

### Affected APIs

- `M:System.Runtime.Intrinsics.X86.Sse.CompareGreaterThan(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})`
- `M:System.Runtime.Intrinsics.X86.Sse.CompareGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})`
- `M:System.Runtime.Intrinsics.X86.Sse.CompareNotGreaterThan(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})`
- `M:System.Runtime.Intrinsics.X86.Sse.CompareNotGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})`
- `M:System.Runtime.Intrinsics.X86.Sse.CompareScalarGreaterThan(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})`
- `M:System.Runtime.Intrinsics.X86.Sse.CompareScalarGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})`
- `M:System.Runtime.Intrinsics.X86.Sse.CompareScalarNotGreaterThan(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})`
- `M:System.Runtime.Intrinsics.X86.Sse.CompareScalarNotGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Single},System.Runtime.Intrinsics.Vector128{System.Single})`

- `M:System.Runtime.Intrinsics.X86.Sse2.CompareGreaterThan(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})`
- `M:System.Runtime.Intrinsics.X86.Sse2.CompareGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})`
- `M:System.Runtime.Intrinsics.X86.Sse2.CompareNotGreaterThan(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})`
- `M:System.Runtime.Intrinsics.X86.Sse2.CompareNotGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})`
- `M:System.Runtime.Intrinsics.X86.Sse2.CompareScalarGreaterThan(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})`
- `M:System.Runtime.Intrinsics.X86.Sse2.CompareScalarGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})`
- `M:System.Runtime.Intrinsics.X86.Sse2.CompareScalarNotGreaterThan(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})`
- `M:System.Runtime.Intrinsics.X86.Sse2.CompareScalarNotGreaterThanOrEqual(System.Runtime.Intrinsics.Vector128{System.Double},System.Runtime.Intrinsics.Vector128{System.Double})`

-->

---
title: Meilleures pratiques pour l’affichage et la persistance des données mises en forme dans .NET
description: Apprenez à afficher et à conserver efficacement des données numériques et de date dans les applications .NET.
ms.date: 05/01/2019
ms.topic: conceptual
dev_langs:
- csharp
- vb
ms.openlocfilehash: dd2e85ed695072da24b6b25b187810a109b89b25
ms.sourcegitcommit: 4313614f57690f9a5119a37314f0a1fd738ebda2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/22/2021
ms.locfileid: "98693122"
---
# <a name="best-practices-for-displaying-and-persisting-formatted-data"></a><span data-ttu-id="022eb-103">Meilleures pratiques pour l’affichage et la persistance des données mises en forme</span><span class="sxs-lookup"><span data-stu-id="022eb-103">Best practices for displaying and persisting formatted data</span></span>

<span data-ttu-id="022eb-104">Cet article examine comment les données mises en forme, telles que les données numériques et les données de date et d’heure, sont traitées pour l’affichage et le stockage.</span><span class="sxs-lookup"><span data-stu-id="022eb-104">This article examines how formatted data, such as numeric data and date-and-time data, is handled for display and for storage.</span></span>

<span data-ttu-id="022eb-105">Lorsque vous développez avec .NET, utilisez la mise en forme dépendante de la culture pour afficher des données autres que des chaînes, telles que des nombres et des dates, dans une interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="022eb-105">When you develop with .NET, use culture-sensitive formatting to display non-string data, such as numbers and dates, in a user interface.</span></span> <span data-ttu-id="022eb-106">Utilisez la mise en forme avec la [culture invariante](xref:System.Globalization.CultureInfo.InvariantCulture) pour conserver les données qui ne sont pas des chaînes sous forme de chaîne.</span><span class="sxs-lookup"><span data-stu-id="022eb-106">Use formatting with the [invariant culture](xref:System.Globalization.CultureInfo.InvariantCulture) to persist non-string data in string form.</span></span> <span data-ttu-id="022eb-107">N’utilisez pas la mise en forme dépendante de la culture pour rendre des données numériques ou de date et d’heure sous forme de chaîne.</span><span class="sxs-lookup"><span data-stu-id="022eb-107">Do not use culture-sensitive formatting to persist numeric or date-and-time data in string form.</span></span>

## <a name="displaying-formatted-data"></a><span data-ttu-id="022eb-108">Affichage des données mises en forme</span><span class="sxs-lookup"><span data-stu-id="022eb-108">Displaying formatted data</span></span>

<span data-ttu-id="022eb-109">Lorsque vous affichez des données non-chaînées telles que les nombres et les dates et heures aux utilisateurs, mettez-les en forme en utilisant les paramètres de la culture de l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="022eb-109">When you display non-string data such as numbers and dates and times to users, format them by using the user's cultural settings.</span></span> <span data-ttu-id="022eb-110">Par défaut, tous les éléments suivants utilisent la culture du thread actuelle dans les opérations de mise en forme :</span><span class="sxs-lookup"><span data-stu-id="022eb-110">By default, the following all use the current thread culture in formatting operations:</span></span>

- <span data-ttu-id="022eb-111">Chaînes interpolées prises en charge par les compilateurs [C#](../../csharp/language-reference/tokens/interpolated.md) et [Visual Basic](../../visual-basic/programming-guide/language-features/strings/interpolated-strings.md).</span><span class="sxs-lookup"><span data-stu-id="022eb-111">Interpolated strings supported by the [C#](../../csharp/language-reference/tokens/interpolated.md) and [Visual Basic](../../visual-basic/programming-guide/language-features/strings/interpolated-strings.md) compilers.</span></span>
- <span data-ttu-id="022eb-112">Opérations de concaténation de chaîne qui utilisent les opérateurs de concaténation [C#](../../csharp/language-reference/operators/addition-operator.md#string-concatenation) ou [Visual Basic](../../visual-basic/programming-guide/language-features/operators-and-expressions/concatenation-operators.md), ou qui appellent directement la méthode <xref:System.String.Concat%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="022eb-112">String concatenation operations that use the [C#](../../csharp/language-reference/operators/addition-operator.md#string-concatenation) or [Visual Basic](../../visual-basic/programming-guide/language-features/operators-and-expressions/concatenation-operators.md) concatenation operators or that call the <xref:System.String.Concat%2A?displayProperty=nameWithType> method directly.</span></span>
- <span data-ttu-id="022eb-113">Méthode <xref:System.String.Format%2A?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="022eb-113">The <xref:System.String.Format%2A?displayProperty=nameWithType> method.</span></span>
- <span data-ttu-id="022eb-114">Méthodes `ToString` des types numériques et des types de date et d’heure.</span><span class="sxs-lookup"><span data-stu-id="022eb-114">The `ToString` methods of the numeric types and the date and time types.</span></span>

<span data-ttu-id="022eb-115">Pour spécifier explicitement qu’une chaîne doit être mise en forme en utilisant les conventions d’une culture désignée ou de la [culture invariante](xref:System.Globalization.CultureInfo.InvariantCulture), vous pouvez procéder comme suit :</span><span class="sxs-lookup"><span data-stu-id="022eb-115">To explicitly specify that a string should be formatted by using the conventions of a designated culture or the [invariant culture](xref:System.Globalization.CultureInfo.InvariantCulture), you can do the following:</span></span>

- <span data-ttu-id="022eb-116">Quand vous utilisez les méthodes <xref:System.String.Format%2A?displayProperty=nameWithType> et `ToString`, appelez une surcharge qui a un paramètre `provider`, tel que <xref:System.String.Format%28System.IFormatProvider%2CSystem.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> ou <xref:System.DateTime.ToString%28System.IFormatProvider%29?displayProperty=nameWithType> et passez-lui la propriété <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType>, une instance <xref:System.Globalization.CultureInfo> qui représente la culture souhaitée, ou la propriété <xref:System.Globalization.CultureInfo.InvariantCulture?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="022eb-116">When using the <xref:System.String.Format%2A?displayProperty=nameWithType> and `ToString` methods, call an overload that has a `provider` parameter, such as <xref:System.String.Format%28System.IFormatProvider%2CSystem.String%2CSystem.Object%5B%5D%29?displayProperty=nameWithType> or <xref:System.DateTime.ToString%28System.IFormatProvider%29?displayProperty=nameWithType>, and pass it the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> property, a <xref:System.Globalization.CultureInfo> instance that represents the desired culture, or the <xref:System.Globalization.CultureInfo.InvariantCulture?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="022eb-117">Pour la concaténation de chaîne, n’autorisez pas le compilateur à effectuer de conversions implicites.</span><span class="sxs-lookup"><span data-stu-id="022eb-117">For string concatenation, do not allow the compiler to perform any implicit conversions.</span></span> <span data-ttu-id="022eb-118">Au lieu de cela, effectuez une conversion explicite en appelant une surcharge `ToString` ayant un paramètre `provider`.</span><span class="sxs-lookup"><span data-stu-id="022eb-118">Instead, perform an explicit conversion by calling a `ToString` overload that has a `provider` parameter.</span></span> <span data-ttu-id="022eb-119">Par exemple, le compilateur utilise implicitement la culture actuelle lors de la conversion <xref:System.Double> d’une valeur en une chaîne dans le code suivant :</span><span class="sxs-lookup"><span data-stu-id="022eb-119">For example, the compiler implicitly uses the current culture when converting a <xref:System.Double> value to a string in the following code:</span></span>

  [!code-csharp[Implicit String Conversion](./snippets/best-practices-strings/csharp/tostring/Program.cs#1)]
  [!code-vb[Implicit String Conversion](./snippets/best-practices-strings/vb/tostring/Program.vb#1)]

  <span data-ttu-id="022eb-120">Au lieu de cela, vous pouvez spécifier explicitement la culture dont les conventions de mise en forme sont utilisées lors de la conversion en appelant la <xref:System.Double.ToString(System.IFormatProvider)?displayProperty=nameWithType> méthode, comme le montre le code suivant :</span><span class="sxs-lookup"><span data-stu-id="022eb-120">Instead, you can explicitly specify the culture whose formatting conventions are used in the conversion by calling the <xref:System.Double.ToString(System.IFormatProvider)?displayProperty=nameWithType> method, as the following code does:</span></span>

  [!code-csharp[Explicit String Conversion](./snippets/best-practices-strings/csharp/tostring/Program.cs#2)]
  [!code-vb[Implicit String Conversion](./snippets/best-practices-strings/vb/tostring/Program.vb#2)]

- <span data-ttu-id="022eb-121">Pour l’interpolation de chaîne, plutôt que d’affecter une chaîne interpolée à une instance <xref:System.String>, affectez-la à un élément <xref:System.FormattableString>.</span><span class="sxs-lookup"><span data-stu-id="022eb-121">For string interpolation, rather than assigning an interpolated string to a <xref:System.String> instance, assign it to a <xref:System.FormattableString>.</span></span> <span data-ttu-id="022eb-122">Vous pouvez ensuite appeler sa méthode <xref:System.FormattableString.ToString?displayProperty=nameWithType> pour produire une chaîne de résultat qui reflète les conventions de la culture actuelle, ou vous pouvez appeler la méthode <xref:System.FormattableString.ToString(System.IFormatProvider)?displayProperty=nameWithType> pour produire une chaîne de résultat qui reflète les conventions d’une culture spécifiée.</span><span class="sxs-lookup"><span data-stu-id="022eb-122">You can then call its <xref:System.FormattableString.ToString?displayProperty=nameWithType> method produce a result string that reflects the conventions of the current culture, or you can call the <xref:System.FormattableString.ToString(System.IFormatProvider)?displayProperty=nameWithType> method to produce a result string that reflects the conventions of a specified culture.</span></span> <span data-ttu-id="022eb-123">Vous pouvez également transmettre la chaîne pouvant être mise en forme à la méthode <xref:System.FormattableString.Invariant%2A?displayProperty=nameWithType> statique pour produire une chaîne de résultat qui reflète les conventions de la culture invariante.</span><span class="sxs-lookup"><span data-stu-id="022eb-123">You can also pass the formattable string to the static <xref:System.FormattableString.Invariant%2A?displayProperty=nameWithType> method to produce a result string that reflects the conventions of the invariant culture.</span></span> <span data-ttu-id="022eb-124">L'exemple suivant illustre cette approche.</span><span class="sxs-lookup"><span data-stu-id="022eb-124">The following example illustrates this approach.</span></span> <span data-ttu-id="022eb-125">(La sortie de l’exemple correspond à la culture actuelle en-US.)</span><span class="sxs-lookup"><span data-stu-id="022eb-125">(The output from the example reflects a current culture of en-US.)</span></span>

  [!code-csharp[String interpolation](./snippets/best-practices-strings/csharp/formattable/Program.cs)]
  [!code-vb[String interpolation](./snippets/best-practices-strings/vb/formattable/Program.vb)]

## <a name="persisting-formatted-data"></a><span data-ttu-id="022eb-126">Persistance des données mises en forme</span><span class="sxs-lookup"><span data-stu-id="022eb-126">Persisting formatted data</span></span>

<span data-ttu-id="022eb-127">Vous pouvez rendre persistantes des données non-chaînées soit comme données binaires, soit comme données mises en forme.</span><span class="sxs-lookup"><span data-stu-id="022eb-127">You can persist non-string data either as binary data or as formatted data.</span></span> <span data-ttu-id="022eb-128">Si vous choisissez de l'enregistrer en tant que données mises en forme, vous devez appeler une surcharge de méthode de mise en forme qui inclut un paramètre `provider` et le passer à la propriété <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="022eb-128">If you choose to save it as formatted data, you should call a formatting method overload that includes a `provider` parameter and pass it the <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="022eb-129">La culture dite indifférente fournit un format cohérent pour les données mises en forme qui est indépendant de la culture et de l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="022eb-129">The invariant culture provides a consistent format for formatted data that is independent of culture and machine.</span></span> <span data-ttu-id="022eb-130">En revanche, assurer la persistance de données mises en forme à l'aide de cultures autres que la culture dite indifférente a plusieurs limites :</span><span class="sxs-lookup"><span data-stu-id="022eb-130">In contrast, persisting data that is formatted by using cultures other than the invariant culture has a number of limitations:</span></span>

- <span data-ttu-id="022eb-131">Les données seront vraisemblablement inutilisables si elles sont récupérées sur un système ayant une autre culture, ou si l'utilisateur du système actuel change la culture actuelle et essaie de récupérer les données.</span><span class="sxs-lookup"><span data-stu-id="022eb-131">The data is likely to be unusable if it is retrieved on a system that has a different culture, or if the user of the current system changes the current culture and tries to retrieve the data.</span></span>
- <span data-ttu-id="022eb-132">Les propriétés d'une culture sur un ordinateur spécifique peuvent différer des valeurs standard.</span><span class="sxs-lookup"><span data-stu-id="022eb-132">The properties of a culture on a specific computer can differ from standard values.</span></span> <span data-ttu-id="022eb-133">À tout moment, un utilisateur peut personnaliser les paramètres d'affichage selon la culture.</span><span class="sxs-lookup"><span data-stu-id="022eb-133">At any time, a user can customize culture-sensitive display settings.</span></span> <span data-ttu-id="022eb-134">De ce fait, les données mises en forme sont stockées sur un système et peuvent ne pas être lisibles lorsque l'utilisateur personnalise les paramètres de culture.</span><span class="sxs-lookup"><span data-stu-id="022eb-134">Because of this, formatted data that is saved on a system may not be readable after the user customizes cultural settings.</span></span> <span data-ttu-id="022eb-135">La portabilité des données mises en forme sur différents ordinateurs peut être encore plus limitée.</span><span class="sxs-lookup"><span data-stu-id="022eb-135">The portability of formatted data across computers is likely to be even more limited.</span></span>
- <span data-ttu-id="022eb-136">Des normes internationales, régionales ou nationales qui régissent la mise en forme des nombres ou des dates et heures évoluent au fil du temps, et ces modifications sont intégrées dans les mises à jour du système d'exploitation Windows.</span><span class="sxs-lookup"><span data-stu-id="022eb-136">International, regional, or national standards that govern the formatting of numbers or dates and times change over time, and these changes are incorporated into Windows operating system updates.</span></span> <span data-ttu-id="022eb-137">Quand les conventions de mise en forme changent, les données qui ont été mises en forme en utilisant les conventions antérieures peuvent devenir illisibles.</span><span class="sxs-lookup"><span data-stu-id="022eb-137">When formatting conventions change, data that was formatted by using the previous conventions may become unreadable.</span></span>

<span data-ttu-id="022eb-138">L'exemple suivant illustre la portabilité limitée qui résulte de l'utilisation de la mise en forme qui tient compte de la culture pour assurer la persistance des données.</span><span class="sxs-lookup"><span data-stu-id="022eb-138">The following example illustrates the limited portability that results from using culture-sensitive formatting to persist data.</span></span> <span data-ttu-id="022eb-139">L'exemple enregistre un tableau de valeurs de date et d'heure dans un fichier.</span><span class="sxs-lookup"><span data-stu-id="022eb-139">The example saves an array of date and time values to a file.</span></span> <span data-ttu-id="022eb-140">Celles-ci sont mises en forme en utilisant les conventions culturelles de l'anglais (États-Unis).</span><span class="sxs-lookup"><span data-stu-id="022eb-140">These are formatted by using the conventions of the English (United States) culture.</span></span> <span data-ttu-id="022eb-141">Une fois que l'application change la culture du thread actuel pour appliquer le français (Suisse), elle essaie de lire les valeurs enregistrées en utilisant les conventions de mise en forme de la culture actuelle.</span><span class="sxs-lookup"><span data-stu-id="022eb-141">After the application changes the current thread culture to French (Switzerland), it tries to read the saved values by using the formatting conventions of the current culture.</span></span> <span data-ttu-id="022eb-142">La tentative de lecture des éléments de données par deux fois renvoie une exception <xref:System.FormatException> , et le tableau de dates contient maintenant deux éléments incorrects qui sont identiques à <xref:System.DateTime.MinValue>.</span><span class="sxs-lookup"><span data-stu-id="022eb-142">The attempt to read two of the data items throws a <xref:System.FormatException> exception, and the array of dates now contains two incorrect elements that are equal to <xref:System.DateTime.MinValue>.</span></span>

[!code-csharp[Conceptual.Strings.BestPractices#21](~/samples/snippets/csharp/VS_Snippets_CLR/conceptual.strings.bestpractices/cs/persistence.cs#21)]
[!code-vb[Conceptual.Strings.BestPractices#21](~/samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.strings.bestpractices/vb/persistence.vb#21)]

<span data-ttu-id="022eb-143">Toutefois, si vous remplacez la <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> propriété par <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> dans les appels à <xref:System.DateTime.ToString%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType> et <xref:System.DateTime.Parse%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType> , les données de date et d’heure persistantes sont correctement restaurées, comme le montre la sortie suivante :</span><span class="sxs-lookup"><span data-stu-id="022eb-143">However, if you replace the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> property with <xref:System.Globalization.CultureInfo.InvariantCulture%2A?displayProperty=nameWithType> in the calls to <xref:System.DateTime.ToString%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType> and <xref:System.DateTime.Parse%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType>, the persisted date and time data is successfully restored, as the following output shows:</span></span>

```console
06.05.1758 21:26
05.05.1818 07:19
22.04.1870 23:54
08.09.1890 06:47
18.02.1905 15:12
```

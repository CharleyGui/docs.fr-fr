---
title: Encodage de caractères dans .NET
description: Découvrez plus en détail l’encodage et le décodage de caractères dans .NET.
ms.date: 12/22/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- encoding, understanding
- encoding, choosing
- encoding, fallback strategy
ms.assetid: bf6d9823-4c2d-48af-b280-919c5af66ae9
ms.custom: seodec18
ms.openlocfilehash: 3ac5602c32ce0dcfe21e913868faa7ab356e4194
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/30/2019
ms.locfileid: "73120603"
---
# <a name="character-encoding-in-net"></a><span data-ttu-id="71230-103">Encodage de caractères dans .NET</span><span class="sxs-lookup"><span data-stu-id="71230-103">Character Encoding in .NET</span></span>

<span data-ttu-id="71230-104">Les caractères sont des entités abstraites qui peuvent être représentées de nombreuses façons différentes.</span><span class="sxs-lookup"><span data-stu-id="71230-104">Characters are abstract entities that can be represented in many different ways.</span></span> <span data-ttu-id="71230-105">Un encodage de caractères est un système qui associe chaque caractère d'un jeu de caractères pris en charge à une valeur qui représente ce caractère.</span><span class="sxs-lookup"><span data-stu-id="71230-105">A character encoding is a system that pairs each character in a supported character set with some value that represents that character.</span></span> <span data-ttu-id="71230-106">Par exemple, le code Morse est un encodage de caractères qui associe chaque caractère de l'alphabet latin à une séquence de points et de tirets qui conviennent pour la transmission sur des lignes télégraphiques.</span><span class="sxs-lookup"><span data-stu-id="71230-106">For example, Morse code is a character encoding that pairs each character in the Roman alphabet with a pattern of dots and dashes that are suitable for transmission over telegraph lines.</span></span> <span data-ttu-id="71230-107">Un encodage de caractères pour les ordinateurs associe chaque caractère d'un jeu de caractères à une valeur numérique qui représente ce caractère.</span><span class="sxs-lookup"><span data-stu-id="71230-107">A character encoding for computers pairs each character in a supported character set with a numeric value that represents that character.</span></span> <span data-ttu-id="71230-108">Un encodage de caractères a deux composants distincts :</span><span class="sxs-lookup"><span data-stu-id="71230-108">A character encoding has two distinct components:</span></span>

- <span data-ttu-id="71230-109">Un encodeur, qui convertit une séquence de caractères en une séquence de valeurs numériques (octets).</span><span class="sxs-lookup"><span data-stu-id="71230-109">An encoder, which translates a sequence of characters into a sequence of numeric values (bytes).</span></span>

- <span data-ttu-id="71230-110">Un décodeur, qui convertit une séquence d'octets en une séquence de caractères.</span><span class="sxs-lookup"><span data-stu-id="71230-110">A decoder, which translates a sequence of bytes into a sequence of characters.</span></span>

<span data-ttu-id="71230-111">L'encodage de caractères décrit les règles selon lesquelles un encodeur et un décodeur fonctionnent.</span><span class="sxs-lookup"><span data-stu-id="71230-111">Character encoding describes the rules by which an encoder and a decoder operate.</span></span> <span data-ttu-id="71230-112">Par exemple, la classe <xref:System.Text.UTF8Encoding> décrit les règles d'encodage et de décodage d'UTF-8, qui utilise de un à quatre octets pour représenter un caractère Unicode.</span><span class="sxs-lookup"><span data-stu-id="71230-112">For example, the <xref:System.Text.UTF8Encoding> class describes the rules for encoding to, and decoding from, 8-bit Unicode Transformation Format (UTF-8), which uses one to four bytes to represent a single Unicode character.</span></span> <span data-ttu-id="71230-113">L'encodage et le décodage peuvent également inclure une validation.</span><span class="sxs-lookup"><span data-stu-id="71230-113">Encoding and decoding can also include validation.</span></span> <span data-ttu-id="71230-114">Par exemple, la classe <xref:System.Text.UnicodeEncoding> vérifie tous les substituts afin de vérifier qu'ils constituent des paires de substitution valide.</span><span class="sxs-lookup"><span data-stu-id="71230-114">For example, the <xref:System.Text.UnicodeEncoding> class checks all surrogates  to make sure they constitute valid surrogate pairs.</span></span> <span data-ttu-id="71230-115">(Une paire de substitution se compose d’un caractère avec un point de code compris entre U + D800 et U + DBFF, suivi d’un caractère avec un point de code compris entre U + DC00 et et U + DFFF.)  Une stratégie de secours détermine comment un encodeur gère les caractères non valides ou comment un décodeur gère les octets non valides.</span><span class="sxs-lookup"><span data-stu-id="71230-115">(A surrogate pair consists of a character with a code point that ranges from U+D800 to U+DBFF followed by a character with a code point that ranges from U+DC00 to U+DFFF.)  A fallback strategy determines how an encoder handles invalid characters or how a decoder handles invalid bytes.</span></span>

> [!WARNING]
> <span data-ttu-id="71230-116">Les classes d’encodage .NET permettent de stocker et de convertir les données caractères.</span><span class="sxs-lookup"><span data-stu-id="71230-116">.NET encoding classes provide a way to store and convert character data.</span></span> <span data-ttu-id="71230-117">Elles ne doivent pas utilisées pour stocker des données binaires sous forme de chaîne.</span><span class="sxs-lookup"><span data-stu-id="71230-117">They should not be used to store binary data in string form.</span></span> <span data-ttu-id="71230-118">En fonction de l'encodage utilisé, la conversion de données binaires en un format chaîne avec les classes d'encodage peut entraîner un comportement inattendu et produire des données incorrectes ou endommagées.</span><span class="sxs-lookup"><span data-stu-id="71230-118">Depending on the encoding used, converting binary data to string format with the encoding classes can introduce unexpected behavior and produce inaccurate or corrupted data.</span></span> <span data-ttu-id="71230-119">Pour convertir des données binaires en chaîne, utilisez la méthode <xref:System.Convert.ToBase64String%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="71230-119">To convert binary data to a string form, use the <xref:System.Convert.ToBase64String%2A?displayProperty=nameWithType> method.</span></span>

<span data-ttu-id="71230-120">.NET utilise l’encodage UTF-16 (représenté par la classe <xref:System.Text.UnicodeEncoding>) pour représenter des caractères et des chaînes.</span><span class="sxs-lookup"><span data-stu-id="71230-120">.NET uses the UTF-16 encoding (represented by the <xref:System.Text.UnicodeEncoding> class) to represent characters and strings.</span></span> <span data-ttu-id="71230-121">Les applications qui ciblent le common language runtime utilisent des encodeurs pour mapper les représentations de caractères Unicode prises en charge par le common language runtime à d'autres schémas de codage.</span><span class="sxs-lookup"><span data-stu-id="71230-121">Applications that target the common language runtime use encoders to map Unicode character representations supported by the common language runtime to other encoding schemes.</span></span> <span data-ttu-id="71230-122">Elles utilisent des décodeurs pour mapper les caractères des encodages non-Unicode à Unicode.</span><span class="sxs-lookup"><span data-stu-id="71230-122">They use decoders to map characters from non-Unicode encodings to Unicode.</span></span>

<span data-ttu-id="71230-123">Cette rubrique contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="71230-123">This topic consists of the following sections:</span></span>

- [<span data-ttu-id="71230-124">Encodages dans .NET</span><span class="sxs-lookup"><span data-stu-id="71230-124">Encodings in .NET</span></span>](../../../docs/standard/base-types/character-encoding.md#Encodings)

- [<span data-ttu-id="71230-125">Sélection d'une classe d'encodage</span><span class="sxs-lookup"><span data-stu-id="71230-125">Selecting an Encoding Class</span></span>](../../../docs/standard/base-types/character-encoding.md#Selecting)

- [<span data-ttu-id="71230-126">Utilisation d'un objet d'encodage</span><span class="sxs-lookup"><span data-stu-id="71230-126">Using an Encoding Object</span></span>](../../../docs/standard/base-types/character-encoding.md#Using)

- [<span data-ttu-id="71230-127">Choix d'une stratégie de secours</span><span class="sxs-lookup"><span data-stu-id="71230-127">Choosing a Fallback Strategy</span></span>](../../../docs/standard/base-types/character-encoding.md#FallbackStrategy)

- [<span data-ttu-id="71230-128">Implementing a Custom Fallback Strategy</span><span class="sxs-lookup"><span data-stu-id="71230-128">Implementing a Custom Fallback Strategy</span></span>](../../../docs/standard/base-types/character-encoding.md#Custom)

<a name="Encodings"></a>

## <a name="encodings-in-net"></a><span data-ttu-id="71230-129">Encodages dans .NET</span><span class="sxs-lookup"><span data-stu-id="71230-129">Encodings in .NET</span></span>

<span data-ttu-id="71230-130">Toutes les classes d'encodage de caractères de .NET héritent de la classe <xref:System.Text.Encoding?displayProperty=nameWithType>, qui est une classe abstraite définissant les fonctionnalités communes à tous les encodages de caractères.</span><span class="sxs-lookup"><span data-stu-id="71230-130">All character encoding classes in .NET inherit from the <xref:System.Text.Encoding?displayProperty=nameWithType> class, which is an abstract class that defines the functionality common to all character encodings.</span></span> <span data-ttu-id="71230-131">Pour accéder aux objets d’encodage individuels implémentés dans .NET, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="71230-131">To access the individual encoding objects implemented in .NET, do the following:</span></span>

- <span data-ttu-id="71230-132">Utilisez les propriétés statiques de la classe <xref:System.Text.Encoding>, qui retournent des objets représentant les encodages de caractères standard disponibles dans .NET (ASCII, UTF-7, UTF-8, UTF-16 et UTF-32).</span><span class="sxs-lookup"><span data-stu-id="71230-132">Use the static properties of the <xref:System.Text.Encoding> class, which return objects that represent the standard character encodings available in .NET (ASCII, UTF-7, UTF-8, UTF-16, and UTF-32).</span></span> <span data-ttu-id="71230-133">Par exemple, la propriété <xref:System.Text.Encoding.Unicode%2A?displayProperty=nameWithType> retourne un objet <xref:System.Text.UnicodeEncoding> .</span><span class="sxs-lookup"><span data-stu-id="71230-133">For example, the <xref:System.Text.Encoding.Unicode%2A?displayProperty=nameWithType> property returns a <xref:System.Text.UnicodeEncoding> object.</span></span> <span data-ttu-id="71230-134">Chaque objet utilise la stratégie de secours pour les remplacements pour traiter les chaînes qu'il ne peut pas encoder et les octets qu'il ne peut pas décoder.</span><span class="sxs-lookup"><span data-stu-id="71230-134">Each object uses replacement fallback to handle strings that it cannot encode and bytes that it cannot decode.</span></span> <span data-ttu-id="71230-135">(Pour plus d’informations, consultez la section [Replacement Fallback](../../../docs/standard/base-types/character-encoding.md#Replacement) .)</span><span class="sxs-lookup"><span data-stu-id="71230-135">(For more information, see the [Replacement Fallback](../../../docs/standard/base-types/character-encoding.md#Replacement) section.)</span></span>

- <span data-ttu-id="71230-136">Appelez le constructeur de classe de l'encodage.</span><span class="sxs-lookup"><span data-stu-id="71230-136">Call the encoding's class constructor.</span></span> <span data-ttu-id="71230-137">Les objets pour les encodages ASCII, UTF-7, UTF-8, UTF-16 et UTF-32 peuvent être instanciés de cette façon.</span><span class="sxs-lookup"><span data-stu-id="71230-137">Objects for the ASCII, UTF-7, UTF-8, UTF-16, and UTF-32 encodings can be instantiated in this way.</span></span> <span data-ttu-id="71230-138">Par défaut, chaque objet utilise la stratégie de secours pour les remplacements pour traiter les chaînes qu'il ne peut pas encoder et les octets qu'il ne peut pas décoder, mais vous pouvez spécifier qu'au lieu de cela, une exception doit être levée.</span><span class="sxs-lookup"><span data-stu-id="71230-138">By default, each object uses replacement fallback to handle strings that it cannot encode and bytes that it cannot decode, but you can specify that an exception should be thrown instead.</span></span> <span data-ttu-id="71230-139">(Pour plus d’informations, consultez les sections [Replacement Fallback](../../../docs/standard/base-types/character-encoding.md#Replacement) et [Exception Fallback](../../../docs/standard/base-types/character-encoding.md#Exception) .)</span><span class="sxs-lookup"><span data-stu-id="71230-139">(For more information, see the [Replacement Fallback](../../../docs/standard/base-types/character-encoding.md#Replacement) and [Exception Fallback](../../../docs/standard/base-types/character-encoding.md#Exception) sections.)</span></span>

- <span data-ttu-id="71230-140">Appelez le constructeur <xref:System.Text.Encoding.%23ctor%28System.Int32%29?displayProperty=nameWithType> et passez-lui un entier qui représente l'encodage.</span><span class="sxs-lookup"><span data-stu-id="71230-140">Call the <xref:System.Text.Encoding.%23ctor%28System.Int32%29?displayProperty=nameWithType> constructor and pass it an integer that represents the encoding.</span></span> <span data-ttu-id="71230-141">Les objets d'encodage standard utilisent la stratégie de secours pour les remplacements. Les objets d'encodage de page de codes et de jeu de caractères codés sur deux octets (DBCS) utilisent la stratégie de secours la mieux adaptée pour traiter les chaînes qu'ils ne peuvent pas encoder et les octets qu'ils ne peuvent pas décoder.</span><span class="sxs-lookup"><span data-stu-id="71230-141">Standard encoding objects use replacement fallback, and code page and double-byte character set (DBCS) encoding objects use best-fit fallback to handle strings that they cannot encode and bytes that they cannot decode.</span></span> <span data-ttu-id="71230-142">(Pour plus d’informations, consultez la section [Best-Fit Fallback](../../../docs/standard/base-types/character-encoding.md#BestFit) .)</span><span class="sxs-lookup"><span data-stu-id="71230-142">(For more information, see the [Best-Fit Fallback](../../../docs/standard/base-types/character-encoding.md#BestFit) section.)</span></span>

- <span data-ttu-id="71230-143">Appelez la méthode <xref:System.Text.Encoding.GetEncoding%2A?displayProperty=nameWithType>, qui retourne les encodages standard, de page de codes ou DBCS disponibles dans .NET.</span><span class="sxs-lookup"><span data-stu-id="71230-143">Call the <xref:System.Text.Encoding.GetEncoding%2A?displayProperty=nameWithType> method, which returns any standard, code page, or DBCS encoding available in .NET.</span></span> <span data-ttu-id="71230-144">Les surcharges vous permettent de spécifier un objet de secours pour l'encodeur et pour le décodeur.</span><span class="sxs-lookup"><span data-stu-id="71230-144">Overloads let you specify a fallback object for both the encoder and the decoder.</span></span>

> [!NOTE]
> <span data-ttu-id="71230-145">La norme Unicode affecte un point de code (un nombre) et un nom à chaque caractère de chaque jeu de caractères pris en charge.</span><span class="sxs-lookup"><span data-stu-id="71230-145">The Unicode Standard assigns a code point (a number) and a name to each character in every supported script.</span></span> <span data-ttu-id="71230-146">Par exemple, le caractère "A" est représenté par le point de code U+0041 et par le nom "LETTRE MAJUSCULE LATINE A".</span><span class="sxs-lookup"><span data-stu-id="71230-146">For example, the character "A" is represented by the code point U+0041 and the name "LATIN CAPITAL LETTER A".</span></span> <span data-ttu-id="71230-147">Les encodages UTF (Unicode Transformation Format) définissent des moyens d'encoder ce point de code en une séquence d'un ou plusieurs octets.</span><span class="sxs-lookup"><span data-stu-id="71230-147">The Unicode Transformation Format (UTF) encodings define ways to encode that code point into a sequence of one or more bytes.</span></span> <span data-ttu-id="71230-148">Un schéma d'encodage Unicode simplifie le développement d'applications mondialisées, car il permet la représentation avec un encodage unique des caractères provenant de n'importe quel jeu de caractères.</span><span class="sxs-lookup"><span data-stu-id="71230-148">A Unicode encoding scheme simplifies world-ready application development because it allows characters from any character set to be represented in a single encoding.</span></span> <span data-ttu-id="71230-149">Les développeurs d'applications ne doivent plus faire le suivi du schéma d'encodage qui a été utilisé pour produire des caractères pour une langue ou un système d'écriture spécifique, et les données peuvent être partagées entre des systèmes à une échelle internationale sans risque d'endommagement.</span><span class="sxs-lookup"><span data-stu-id="71230-149">Application developers no longer have to keep track of the encoding scheme that was used to produce characters for a specific language or writing system, and data can be shared among systems internationally without being corrupted.</span></span>
>
> <span data-ttu-id="71230-150">.NET prend en charge trois encodages définis par la norme Unicode : UTF-8, UTF-16 et UTF-32.</span><span class="sxs-lookup"><span data-stu-id="71230-150">.NET supports three encodings defined by the Unicode standard: UTF-8, UTF-16, and UTF-32.</span></span> <span data-ttu-id="71230-151">Pour plus d’informations, consultez la norme Unicode dans la [page d’accueil Unicode](https://www.unicode.org/).</span><span class="sxs-lookup"><span data-stu-id="71230-151">For more information, see The Unicode Standard at the [Unicode home page](https://www.unicode.org/).</span></span>

<span data-ttu-id="71230-152">Vous pouvez récupérer des informations sur les encodages disponibles dans .NET en appelant la méthode <xref:System.Text.Encoding.GetEncodings%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="71230-152">You can retrieve information about all the encodings available in .NET by calling the <xref:System.Text.Encoding.GetEncodings%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="71230-153">.NET prend en charge les systèmes d’encodage de caractères répertoriés dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="71230-153">.NET supports the character encoding systems listed in the following table.</span></span>

|<span data-ttu-id="71230-154">Encodage</span><span class="sxs-lookup"><span data-stu-id="71230-154">Encoding</span></span>|<span data-ttu-id="71230-155">Class</span><span class="sxs-lookup"><span data-stu-id="71230-155">Class</span></span>|<span data-ttu-id="71230-156">Description</span><span class="sxs-lookup"><span data-stu-id="71230-156">Description</span></span>|<span data-ttu-id="71230-157">Avantages et inconvénients</span><span class="sxs-lookup"><span data-stu-id="71230-157">Advantages/disadvantages</span></span>|
|--------------|-----------|-----------------|-------------------------------|
|<span data-ttu-id="71230-158">non</span><span class="sxs-lookup"><span data-stu-id="71230-158">ASCII</span></span>|<xref:System.Text.ASCIIEncoding>|<span data-ttu-id="71230-159">Encode une plage de caractères limitée en utilisant les sept bits de poids le plus faible d'un octet.</span><span class="sxs-lookup"><span data-stu-id="71230-159">Encodes a limited range of characters by using the lower seven bits of a byte.</span></span>|<span data-ttu-id="71230-160">Étant donné que cet encodage prend en charge seulement des valeurs de caractère de U+0000 à U+007F, dans la plupart des cas, il ne convient pas aux applications internationalisées.</span><span class="sxs-lookup"><span data-stu-id="71230-160">Because this encoding only supports character values from U+0000 through U+007F, in most cases it is inadequate for internationalized applications.</span></span>|
|<span data-ttu-id="71230-161">UTF-7</span><span class="sxs-lookup"><span data-stu-id="71230-161">UTF-7</span></span>|<xref:System.Text.UTF7Encoding>|<span data-ttu-id="71230-162">Représente les caractères sous forme de séquences de caractères ASCII sur 7 bits.</span><span class="sxs-lookup"><span data-stu-id="71230-162">Represents characters as sequences of 7-bit ASCII characters.</span></span> <span data-ttu-id="71230-163">Les caractères Unicode non-ASCII sont représentés par une séquence d'échappement de caractères ASCII.</span><span class="sxs-lookup"><span data-stu-id="71230-163">Non-ASCII Unicode characters are represented by an escape sequence of ASCII characters.</span></span>|<span data-ttu-id="71230-164">UTF-7 prend en charge les protocoles de messagerie et les protocoles de groupe de discussion.</span><span class="sxs-lookup"><span data-stu-id="71230-164">UTF-7 supports protocols such as email and newsgroup protocols.</span></span> <span data-ttu-id="71230-165">UTF-7 n'est cependant pas particulièrement sécurisé ou robuste.</span><span class="sxs-lookup"><span data-stu-id="71230-165">However, UTF-7 is not particularly secure or robust.</span></span> <span data-ttu-id="71230-166">Dans certains cas, la modification d'un seul bit peut changer radicalement l'interprétation de toute une chaîne UTF-7.</span><span class="sxs-lookup"><span data-stu-id="71230-166">In some cases, changing one bit can radically alter the interpretation of an entire UTF-7 string.</span></span> <span data-ttu-id="71230-167">Dans d'autres cas, des chaînes UTF-7 différentes peuvent correspondre à l'encodage d'un même texte.</span><span class="sxs-lookup"><span data-stu-id="71230-167">In other cases, different UTF-7 strings can encode the same text.</span></span> <span data-ttu-id="71230-168">Pour les séquences incluant des caractères non-ASCII, UTF-7 nécessite davantage d'espace qu'UTF-8, et l'encodage/décodage est plus lent.</span><span class="sxs-lookup"><span data-stu-id="71230-168">For sequences that include non-ASCII characters, UTF-7 requires more space than UTF-8, and encoding/decoding is slower.</span></span> <span data-ttu-id="71230-169">Par conséquent, il est préférable d'utiliser UTF-8 au lieu d'UTF-7 si c'est possible.</span><span class="sxs-lookup"><span data-stu-id="71230-169">Consequently, you should use UTF-8 instead of UTF-7 if possible.</span></span>|
|<span data-ttu-id="71230-170">UTF-8</span><span class="sxs-lookup"><span data-stu-id="71230-170">UTF-8</span></span>|<xref:System.Text.UTF8Encoding>|<span data-ttu-id="71230-171">Représente chaque point de code Unicode sous la forme d'une séquence de un à quatre octets.</span><span class="sxs-lookup"><span data-stu-id="71230-171">Represents each Unicode code point as a sequence of one to four bytes.</span></span>|<span data-ttu-id="71230-172">UTF-8 prend en charge des tailles de données de 8 bits et fonctionne bien avec de nombreux systèmes d'exploitation.</span><span class="sxs-lookup"><span data-stu-id="71230-172">UTF-8 supports 8-bit data sizes and works well with many existing operating systems.</span></span> <span data-ttu-id="71230-173">Pour la plage de caractères ASCII, UTF-8 est identique à l'encodage ASCII et permet un ensemble de caractères plus large.</span><span class="sxs-lookup"><span data-stu-id="71230-173">For the ASCII range of characters, UTF-8 is identical to ASCII encoding and allows a broader set of characters.</span></span> <span data-ttu-id="71230-174">Cependant, pour les jeux de caractères Chinois-Japonais-Coréen (CJC), UTF-8 peut nécessiter trois octets pour chaque caractère et aboutir potentiellement à des tailles de données supérieures à celles d'UTF-16.</span><span class="sxs-lookup"><span data-stu-id="71230-174">However, for Chinese-Japanese-Korean (CJK) scripts, UTF-8 can require three bytes for each character, and can potentially cause larger data sizes than UTF-16.</span></span> <span data-ttu-id="71230-175">Notez que parfois, la quantité de données ASCII, comme des balises HTML, justifie l'augmentation de la taille pour les jeux de caractères CJC.</span><span class="sxs-lookup"><span data-stu-id="71230-175">Note that sometimes the amount of ASCII data, such as HTML tags, justifies the increased size for the CJK range.</span></span>|
|<span data-ttu-id="71230-176">UTF-16</span><span class="sxs-lookup"><span data-stu-id="71230-176">UTF-16</span></span>|<xref:System.Text.UnicodeEncoding>|<span data-ttu-id="71230-177">Représente chaque point de code Unicode sous la forme d'une séquence de un ou deux entiers sur 16 bits.</span><span class="sxs-lookup"><span data-stu-id="71230-177">Represents each Unicode code point as a sequence of one or two 16-bit integers.</span></span> <span data-ttu-id="71230-178">La plupart des caractères Unicode courants ne nécessitent qu'un seul point de code UTF-16, tandis que les caractères Unicode additionnels (U+10000 et supérieurs) nécessitent deux points de code de substitution UTF-16.</span><span class="sxs-lookup"><span data-stu-id="71230-178">Most common Unicode characters require only one UTF-16 code point, although Unicode supplementary characters (U+10000 and greater) require two UTF-16 surrogate code points.</span></span> <span data-ttu-id="71230-179">Les ordres des octets Little Endian et Big Endian sont pris en charge.</span><span class="sxs-lookup"><span data-stu-id="71230-179">Both little-endian and big-endian byte orders are supported.</span></span>|<span data-ttu-id="71230-180">L'encodage UTF-16 est utilisé par le common language runtime pour représenter les valeurs <xref:System.Char> et <xref:System.String> , et il est utilisé par le système d'exploitation Windows pour représenter les `WCHAR` .</span><span class="sxs-lookup"><span data-stu-id="71230-180">UTF-16 encoding is used by the common language runtime to represent <xref:System.Char> and <xref:System.String> values, and it is used by the Windows operating system to represent `WCHAR` values.</span></span>|
|<span data-ttu-id="71230-181">UTF-32</span><span class="sxs-lookup"><span data-stu-id="71230-181">UTF-32</span></span>|<xref:System.Text.UTF32Encoding>|<span data-ttu-id="71230-182">Représente chaque point de code Unicode sous la forme d'un entier 32 bits.</span><span class="sxs-lookup"><span data-stu-id="71230-182">Represents each Unicode code point as a 32-bit integer.</span></span> <span data-ttu-id="71230-183">Les ordres des octets Little Endian et Big Endian sont pris en charge.</span><span class="sxs-lookup"><span data-stu-id="71230-183">Both little-endian and big-endian byte orders are supported.</span></span>|<span data-ttu-id="71230-184">L'encodage UTF-32 est utilisé quand les applications ne doivent pas avoir le comportement du point de code de substitution de l'encodage UTF-16 sur les systèmes d'exploitation pour lesquels l'espace encodé est trop important.</span><span class="sxs-lookup"><span data-stu-id="71230-184">UTF-32 encoding is used when applications want to avoid the surrogate code point behavior of UTF-16 encoding on operating systems for which encoded space is too important.</span></span> <span data-ttu-id="71230-185">Les glyphes uniques restitués à l'affichage peuvent néanmoins encore être encodés avec plusieurs caractères UTF-32.</span><span class="sxs-lookup"><span data-stu-id="71230-185">Single glyphs rendered on a display can still be encoded with more than one UTF-32 character.</span></span>|
|<span data-ttu-id="71230-186">Encodages ANSI/ISO</span><span class="sxs-lookup"><span data-stu-id="71230-186">ANSI/ISO encodings</span></span>||<span data-ttu-id="71230-187">Prend en charge différentes pages de codes.</span><span class="sxs-lookup"><span data-stu-id="71230-187">Provides support for a variety of code pages.</span></span> <span data-ttu-id="71230-188">Sur les systèmes d'exploitation Windows, les pages de codes sont utilisées pour prendre en charge une langue spécifique ou un groupe de langues spécifique.</span><span class="sxs-lookup"><span data-stu-id="71230-188">On Windows operating systems, code pages are used to support a specific language or group of languages.</span></span> <span data-ttu-id="71230-189">Pour un tableau répertoriant les pages de codes prises en charge par .NET, consultez la classe <xref:System.Text.Encoding>.</span><span class="sxs-lookup"><span data-stu-id="71230-189">For a table that lists the code pages supported by .NET, see the <xref:System.Text.Encoding> class.</span></span> <span data-ttu-id="71230-190">Vous pouvez récupérer un objet d'encodage pour une page de codes spécifique en appelant la méthode <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="71230-190">You can retrieve an encoding object for a particular code page by calling the <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> method.</span></span>|<span data-ttu-id="71230-191">Une page de codes contient 256 points de code et commence à zéro.</span><span class="sxs-lookup"><span data-stu-id="71230-191">A code page contains 256 code points and is zero-based.</span></span> <span data-ttu-id="71230-192">Dans la plupart des pages de codes, les points de code de 0 à 127 représentent le jeu de caractères ASCII, et les points de code de 128 à 255 diffèrent considérablement entre les pages de code.</span><span class="sxs-lookup"><span data-stu-id="71230-192">In most code pages, code points 0 through 127 represent the ASCII character set, and code points 128 through 255 differ significantly between code pages.</span></span> <span data-ttu-id="71230-193">Par exemple, la page de codes 1252 fournit les caractères pour les systèmes d'écriture latins, y compris l'anglais, l'allemand et le français.</span><span class="sxs-lookup"><span data-stu-id="71230-193">For example, code page 1252 provides the characters for Latin writing systems, including English, German, and French.</span></span> <span data-ttu-id="71230-194">Les derniers 128 points de code de la page de codes 1252 contiennent les caractères accentués.</span><span class="sxs-lookup"><span data-stu-id="71230-194">The last 128 code points in code page 1252 contain the accent characters.</span></span> <span data-ttu-id="71230-195">La page de codes 1253 fournit les codes des caractères qui sont requis dans le système d'écriture grec.</span><span class="sxs-lookup"><span data-stu-id="71230-195">Code page 1253 provides character codes that are required in the Greek writing system.</span></span> <span data-ttu-id="71230-196">Les derniers 128 points de code de la page de codes 1253 contiennent les caractères grecs.</span><span class="sxs-lookup"><span data-stu-id="71230-196">The last 128 code points in code page 1253 contain the Greek characters.</span></span> <span data-ttu-id="71230-197">Par conséquent, une application qui s'appuie sur les pages de codes ANSI ne peut pas stocker le grec et l'allemand dans le même flux de texte, sauf si elle inclut un identificateur indiquant la page de codes référencée.</span><span class="sxs-lookup"><span data-stu-id="71230-197">As a result, an application that relies on ANSI code pages cannot store Greek and German in the same text stream unless it includes an identifier that indicates the referenced code page.</span></span>|
|<span data-ttu-id="71230-198">Encodages DBCS (Double-Byte Character Set, Jeu de caractères codés sur deux octets)</span><span class="sxs-lookup"><span data-stu-id="71230-198">Double-byte character set (DBCS) encodings</span></span>||<span data-ttu-id="71230-199">Prend en charge des langues comme le chinois, le japonais et le coréen, qui contiennent plus de 256 caractères.</span><span class="sxs-lookup"><span data-stu-id="71230-199">Supports languages, such as Chinese, Japanese, and Korean, that contain more than 256 characters.</span></span> <span data-ttu-id="71230-200">Dans un jeu de caractères DBCS, une paire de points de code (un double octet) représente chaque caractère.</span><span class="sxs-lookup"><span data-stu-id="71230-200">In a DBCS, a pair of code points (a double byte) represents each character.</span></span> <span data-ttu-id="71230-201">La propriété <xref:System.Text.Encoding.IsSingleByte%2A?displayProperty=nameWithType> retourne `false` pour les encodages DBCS.</span><span class="sxs-lookup"><span data-stu-id="71230-201">The <xref:System.Text.Encoding.IsSingleByte%2A?displayProperty=nameWithType> property returns `false` for DBCS encodings.</span></span> <span data-ttu-id="71230-202">Vous pouvez récupérer un objet d'encodage pour un jeu de caractères DBCS spécifique en appelant la méthode <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="71230-202">You can retrieve an encoding object for a particular DBCS by calling the <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> method.</span></span>|<span data-ttu-id="71230-203">Dans un jeu de caractères DBCS, une paire de points de code (un double octet) représente chaque caractère.</span><span class="sxs-lookup"><span data-stu-id="71230-203">In a DBCS, a pair of code points (a double byte) represents each character.</span></span> <span data-ttu-id="71230-204">Quand une application traite des données DBCS, le premier octet d'un caractère DBCS (l'octet de tête) est traité en combinaison avec l'octet de fin qui le suit immédiatement.</span><span class="sxs-lookup"><span data-stu-id="71230-204">When an application handles DBCS data, the first byte of a DBCS character (the lead byte) is processed in combination with the trail byte that immediately follows it.</span></span> <span data-ttu-id="71230-205">Comme une seule paire de points de code sur un double octet peut représenter des caractères différents en fonction de la page de codes, ce schéma ne permet pas non plus la combinaison de deux langues, comme le japonais et le chinois, dans le même flux de données.</span><span class="sxs-lookup"><span data-stu-id="71230-205">Because a single pair of double-byte code points can represent different characters depending on the code page, this scheme still does not allow for the combination of two languages, such as Japanese and Chinese, in the same data stream.</span></span>|

<span data-ttu-id="71230-206">Ces encodages vous permettent de travailler avec des caractères Unicode ainsi qu'avec les encodages les plus couramment utilisés dans les applications héritées.</span><span class="sxs-lookup"><span data-stu-id="71230-206">These encodings enable you to work with Unicode characters as well as with encodings that are most commonly used in legacy applications.</span></span> <span data-ttu-id="71230-207">En outre, vous pouvez créer un encodage personnalisé en définissant une classe qui dérive de <xref:System.Text.Encoding> et en remplaçant ses membres.</span><span class="sxs-lookup"><span data-stu-id="71230-207">In addition, you can create a custom encoding by defining a class that derives from <xref:System.Text.Encoding> and overriding its members.</span></span>

### <a name="platform-notes-net-core"></a><span data-ttu-id="71230-208">Notes sur les plateformes : .NET Core</span><span class="sxs-lookup"><span data-stu-id="71230-208">Platform Notes: .NET Core</span></span>

<span data-ttu-id="71230-209">Par défaut, .NET Core ne met à disposition aucune page de codes autre que la page de codes 28591 et les encodages Unicode, comme UTF-8 et UTF-16.</span><span class="sxs-lookup"><span data-stu-id="71230-209">By default, .NET Core does not make available any code page encodings other than code page 28591 and the Unicode encodings, such as UTF-8 and UTF-16.</span></span> <span data-ttu-id="71230-210">Vous pouvez cependant ajouter à votre application les encodages des pages de code qui se trouvent dans les applications Windows standard ciblant .NET.</span><span class="sxs-lookup"><span data-stu-id="71230-210">However, you can add the code page encodings found in standard Windows apps that target .NET to your app.</span></span> <span data-ttu-id="71230-211">Pour des informations complètes, consultez la rubrique <xref:System.Text.CodePagesEncodingProvider> .</span><span class="sxs-lookup"><span data-stu-id="71230-211">For complete information, see the <xref:System.Text.CodePagesEncodingProvider> topic.</span></span>

<a name="Selecting"></a>

## <a name="selecting-an-encoding-class"></a><span data-ttu-id="71230-212">Sélection d'une classe d'encodage</span><span class="sxs-lookup"><span data-stu-id="71230-212">Selecting an Encoding Class</span></span>

<span data-ttu-id="71230-213">Si vous avez la possibilité de choisir l'encodage à utiliser par votre application, utilisez un encodage Unicode, de préférence <xref:System.Text.UTF8Encoding> ou <xref:System.Text.UnicodeEncoding>.</span><span class="sxs-lookup"><span data-stu-id="71230-213">If you have the opportunity to choose the encoding to be used by your application, you should use a Unicode encoding, preferably either <xref:System.Text.UTF8Encoding> or <xref:System.Text.UnicodeEncoding>.</span></span> <span data-ttu-id="71230-214">(.NET prend également en charge un troisième encodage Unicode, <xref:System.Text.UTF32Encoding>.)</span><span class="sxs-lookup"><span data-stu-id="71230-214">(.NET also supports a third Unicode encoding, <xref:System.Text.UTF32Encoding>.)</span></span>

<span data-ttu-id="71230-215">Si vous envisagez d'utiliser un encodage ASCII (<xref:System.Text.ASCIIEncoding>), choisissez <xref:System.Text.UTF8Encoding> à la place.</span><span class="sxs-lookup"><span data-stu-id="71230-215">If you are planning to use an ASCII encoding (<xref:System.Text.ASCIIEncoding>), choose <xref:System.Text.UTF8Encoding> instead.</span></span> <span data-ttu-id="71230-216">Les deux encodages sont identiques pour le jeu de caractères ASCII, mais <xref:System.Text.UTF8Encoding> présente les avantages suivants :</span><span class="sxs-lookup"><span data-stu-id="71230-216">The two encodings are identical for the ASCII character set, but <xref:System.Text.UTF8Encoding> has the following advantages:</span></span>

- <span data-ttu-id="71230-217">Il peut représenter tous les caractères Unicode, alors que <xref:System.Text.ASCIIEncoding> prend en charge seulement les valeurs des caractères Unicode entre U+0000 et U+007F.</span><span class="sxs-lookup"><span data-stu-id="71230-217">It can represent every Unicode character, whereas <xref:System.Text.ASCIIEncoding> supports only the Unicode character values between U+0000 and U+007F.</span></span>

- <span data-ttu-id="71230-218">Il offre une fonction de détection d'erreur et une meilleure sécurité.</span><span class="sxs-lookup"><span data-stu-id="71230-218">It provides error detection and better security.</span></span>

- <span data-ttu-id="71230-219">Il a été optimisé pour être aussi rapide que possible et il doit normalement être plus rapide n'importe quel autre encodage.</span><span class="sxs-lookup"><span data-stu-id="71230-219">It has been tuned to be as fast as possible and should be faster than any other encoding.</span></span> <span data-ttu-id="71230-220">Même pour du contenu qui est entièrement en ASCII, les opérations effectuées avec <xref:System.Text.UTF8Encoding> sont plus rapides que les opérations effectuées avec <xref:System.Text.ASCIIEncoding>.</span><span class="sxs-lookup"><span data-stu-id="71230-220">Even for content that is entirely ASCII, operations performed with <xref:System.Text.UTF8Encoding> are faster than operations performed with <xref:System.Text.ASCIIEncoding>.</span></span>

<span data-ttu-id="71230-221">Vous devez envisager d'utiliser <xref:System.Text.ASCIIEncoding> seulement pour les applications héritées.</span><span class="sxs-lookup"><span data-stu-id="71230-221">You should consider using <xref:System.Text.ASCIIEncoding> only for legacy applications.</span></span> <span data-ttu-id="71230-222">Cependant, même pour les applications héritées, <xref:System.Text.UTF8Encoding> peut être un meilleur choix pour les raisons suivantes (en supposant que les paramètres par défaut sont utilisés) :</span><span class="sxs-lookup"><span data-stu-id="71230-222">However, even for legacy applications, <xref:System.Text.UTF8Encoding> might be a better choice for the following reasons (assuming default settings):</span></span>

- <span data-ttu-id="71230-223">Si votre application a du contenu qui n'est pas strictement ASCII et qu'elle l'encode avec <xref:System.Text.ASCIIEncoding>, chaque caractère non-ASCII est encodé sous la forme d'un point d'interrogation (?).</span><span class="sxs-lookup"><span data-stu-id="71230-223">If your application has content that is not strictly ASCII and encodes it with <xref:System.Text.ASCIIEncoding>, each non-ASCII character encodes as a question mark (?).</span></span> <span data-ttu-id="71230-224">Si l'application décode ensuite ces données, les informations sont perdues.</span><span class="sxs-lookup"><span data-stu-id="71230-224">If the application then decodes this data, the information is lost.</span></span>

- <span data-ttu-id="71230-225">Si votre application a du contenu qui n'est pas strictement ASCII et qu'elle l'encode avec <xref:System.Text.UTF8Encoding>, le résultat paraît inintelligible s'il est interprété comme étant en ASCII.</span><span class="sxs-lookup"><span data-stu-id="71230-225">If your application has content that is not strictly ASCII and encodes it with <xref:System.Text.UTF8Encoding>, the result seems unintelligible if interpreted as ASCII.</span></span> <span data-ttu-id="71230-226">Cependant, si l'application utilise ensuite un décodeur UTF-8 pour décoder ces données, les données apparaissent à nouveau correctes.</span><span class="sxs-lookup"><span data-stu-id="71230-226">However, if the application then uses a UTF-8 decoder to decode this data, the data performs a round trip successfully.</span></span>

<span data-ttu-id="71230-227">Dans une application web, les caractères envoyés au client en réponse à une demande web doivent refléter l'encodage utilisé sur le client.</span><span class="sxs-lookup"><span data-stu-id="71230-227">In a web application, characters sent to the client in response to a web request should reflect the encoding used on the client.</span></span> <span data-ttu-id="71230-228">Dans la plupart des cas, vous devez définir la propriété <xref:System.Web.HttpResponse.ContentEncoding%2A?displayProperty=nameWithType> à la valeur retournée par la propriété <xref:System.Web.HttpRequest.ContentEncoding%2A?displayProperty=nameWithType> pour afficher le texte dans le encodage attendu par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="71230-228">In most cases, you should set the <xref:System.Web.HttpResponse.ContentEncoding%2A?displayProperty=nameWithType> property to the value returned by the <xref:System.Web.HttpRequest.ContentEncoding%2A?displayProperty=nameWithType> property to display text in the encoding that the user expects.</span></span>

<a name="Using"></a>

## <a name="using-an-encoding-object"></a><span data-ttu-id="71230-229">Utilisation d'un objet d'encodage</span><span class="sxs-lookup"><span data-stu-id="71230-229">Using an Encoding Object</span></span>

<span data-ttu-id="71230-230">Un encodeur convertit une chaîne de caractères (le plus souvent, des caractères Unicode) en son équivalent numérique (en octets).</span><span class="sxs-lookup"><span data-stu-id="71230-230">An encoder converts a string of characters (most commonly, Unicode characters) to its numeric (byte) equivalent.</span></span> <span data-ttu-id="71230-231">Par exemple, vous pouvez utiliser un encodeur ASCII pour convertir des caractères Unicode en ASCII, pour pouvoir les afficher sur la console.</span><span class="sxs-lookup"><span data-stu-id="71230-231">For example, you might use an ASCII encoder to convert Unicode characters to ASCII so that they can be displayed at the console.</span></span> <span data-ttu-id="71230-232">Pour effectuer la conversion, vous appelez la méthode <xref:System.Text.Encoding.GetBytes%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="71230-232">To perform the conversion, you call the <xref:System.Text.Encoding.GetBytes%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="71230-233">Si vous voulez déterminer le nombre d'octets nécessaires pour stocker les caractères encodés avant de procéder à l'encodage, vous pouvez appeler la méthode <xref:System.Text.Encoding.GetByteCount%2A> .</span><span class="sxs-lookup"><span data-stu-id="71230-233">If you want to determine how many bytes are needed to store the encoded characters before performing the encoding, you can call the <xref:System.Text.Encoding.GetByteCount%2A> method.</span></span>

<span data-ttu-id="71230-234">L'exemple suivant utilise un tableau d'octets seuls pour encoder des chaînes dans deux opérations distinctes.</span><span class="sxs-lookup"><span data-stu-id="71230-234">The following example uses a single byte array to encode strings in two separate operations.</span></span> <span data-ttu-id="71230-235">Il gère un index qui indique la position de départ dans le tableau d'octets pour l'ensemble suivant d'octets encodés en ASCII.</span><span class="sxs-lookup"><span data-stu-id="71230-235">It maintains an index that indicates the starting position in the byte array for the next set of ASCII-encoded bytes.</span></span> <span data-ttu-id="71230-236">Il appelle la méthode <xref:System.Text.ASCIIEncoding.GetByteCount%28System.String%29?displayProperty=nameWithType> pour vérifier que le tableau d'octets est assez grand pour contenir la chaîne encodée.</span><span class="sxs-lookup"><span data-stu-id="71230-236">It calls the <xref:System.Text.ASCIIEncoding.GetByteCount%28System.String%29?displayProperty=nameWithType> method to ensure that the byte array is large enough to accommodate the encoded string.</span></span> <span data-ttu-id="71230-237">Il appelle ensuite la méthode <xref:System.Text.ASCIIEncoding.GetBytes%28System.String%2CSystem.Int32%2CSystem.Int32%2CSystem.Byte%5B%5D%2CSystem.Int32%29?displayProperty=nameWithType> pour encoder les caractères de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="71230-237">It then calls the <xref:System.Text.ASCIIEncoding.GetBytes%28System.String%2CSystem.Int32%2CSystem.Int32%2CSystem.Byte%5B%5D%2CSystem.Int32%29?displayProperty=nameWithType> method to encode the characters in the string.</span></span>

[!code-csharp[Conceptual.Encoding#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/getbytes1.cs#8)]
[!code-vb[Conceptual.Encoding#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/getbytes1.vb#8)]

<span data-ttu-id="71230-238">Un décodeur convertit un tableau d'octets qui reflète un encodage de caractères spécifique en un jeu de caractères dans un tableau de caractères ou dans une chaîne.</span><span class="sxs-lookup"><span data-stu-id="71230-238">A decoder converts a byte array that reflects a particular character encoding into a set of characters, either in a character array or in a string.</span></span> <span data-ttu-id="71230-239">Pour décoder un tableau d'octets en un tableau de caractères, vous appelez la méthode <xref:System.Text.Encoding.GetChars%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="71230-239">To decode a byte array into a character array, you call the <xref:System.Text.Encoding.GetChars%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="71230-240">Pour décoder un tableau d'octets en un tableau de caractères, vous appelez la méthode <xref:System.Text.Encoding.GetString%2A> .</span><span class="sxs-lookup"><span data-stu-id="71230-240">To decode a byte array into a string, you call the <xref:System.Text.Encoding.GetString%2A> method.</span></span> <span data-ttu-id="71230-241">Si vous voulez déterminer le nombre d'octets nécessaires pour stocker les caractères décodés avant de procéder au décodage, vous pouvez appeler la méthode <xref:System.Text.Encoding.GetCharCount%2A> .</span><span class="sxs-lookup"><span data-stu-id="71230-241">If you want to determine how many characters are needed to store the decoded bytes before performing the decoding, you can call the <xref:System.Text.Encoding.GetCharCount%2A> method.</span></span>

<span data-ttu-id="71230-242">L'exemple suivant encode trois chaînes, puis les décode dans un même tableau de caractères.</span><span class="sxs-lookup"><span data-stu-id="71230-242">The following example encodes three strings and then decodes them into a single array of characters.</span></span> <span data-ttu-id="71230-243">Il gère un index qui indique la position de départ dans le tableau de caractères pour l'ensemble suivant de caractères décodés.</span><span class="sxs-lookup"><span data-stu-id="71230-243">It maintains an index that indicates the starting position in the character array for the next set of decoded characters.</span></span> <span data-ttu-id="71230-244">Il appelle la méthode <xref:System.Text.ASCIIEncoding.GetCharCount%2A> pour vérifier que le tableau de caractères est assez grand pour contenir les caractères décodés.</span><span class="sxs-lookup"><span data-stu-id="71230-244">It calls the <xref:System.Text.ASCIIEncoding.GetCharCount%2A> method to ensure that the character array is large enough to accommodate all the decoded characters.</span></span> <span data-ttu-id="71230-245">Il appelle ensuite la méthode <xref:System.Text.ASCIIEncoding.GetChars%28System.Byte%5B%5D%2CSystem.Int32%2CSystem.Int32%2CSystem.Char%5B%5D%2CSystem.Int32%29?displayProperty=nameWithType> pour décoder le tableau d'octets.</span><span class="sxs-lookup"><span data-stu-id="71230-245">It then calls the <xref:System.Text.ASCIIEncoding.GetChars%28System.Byte%5B%5D%2CSystem.Int32%2CSystem.Int32%2CSystem.Char%5B%5D%2CSystem.Int32%29?displayProperty=nameWithType> method to decode the byte array.</span></span>

[!code-csharp[Conceptual.Encoding#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/getchars1.cs#9)]
[!code-vb[Conceptual.Encoding#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/getchars1.vb#9)]

<span data-ttu-id="71230-246">Les méthodes d'encodage et de décodage d'une classe dérivée de <xref:System.Text.Encoding> sont conçues pour fonctionner sur un ensemble de données complet ; autrement dit, toutes les données à encoder ou à décoder sont fournies dans un seul appel de méthode.</span><span class="sxs-lookup"><span data-stu-id="71230-246">The encoding and decoding methods of a class derived from <xref:System.Text.Encoding> are designed to work on a complete set of data; that is, all the data to be encoded or decoded is supplied in a single method call.</span></span> <span data-ttu-id="71230-247">Cependant, dans certains cas, les données sont disponibles dans un flux, et les données à encoder ou à décoder peuvent être disponibles seulement via des opérations de lecture distinctes.</span><span class="sxs-lookup"><span data-stu-id="71230-247">However, in some cases, data is available in a stream, and the data to be encoded or decoded may be available only from separate read operations.</span></span> <span data-ttu-id="71230-248">Ceci nécessite la conservation par l'opération d'encodage ou de décodage des états enregistrés depuis son précédent appel.</span><span class="sxs-lookup"><span data-stu-id="71230-248">This requires the encoding or decoding operation to remember any saved state from its previous invocation.</span></span> <span data-ttu-id="71230-249">Les méthodes des classes dérivées de <xref:System.Text.Encoder> et de <xref:System.Text.Decoder> sont capables de traiter les opérations de codage et de décodage qui recouvrent plusieurs appels de méthode.</span><span class="sxs-lookup"><span data-stu-id="71230-249">Methods of classes derived from <xref:System.Text.Encoder> and <xref:System.Text.Decoder> are able to handle encoding and decoding operations that span multiple method calls.</span></span>

<span data-ttu-id="71230-250">Un objet <xref:System.Text.Encoder> pour un encodage particulier est disponible auprès de la propriété <xref:System.Text.Encoding.GetEncoder%2A?displayProperty=nameWithType> de cet encodage.</span><span class="sxs-lookup"><span data-stu-id="71230-250">An <xref:System.Text.Encoder> object for a particular encoding is available from that encoding's <xref:System.Text.Encoding.GetEncoder%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="71230-251">Un objet <xref:System.Text.Decoder> pour un encodage particulier est disponible auprès de la propriété <xref:System.Text.Encoding.GetDecoder%2A?displayProperty=nameWithType> de cet encodage.</span><span class="sxs-lookup"><span data-stu-id="71230-251">A <xref:System.Text.Decoder> object for a particular encoding is available from that encoding's <xref:System.Text.Encoding.GetDecoder%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="71230-252">Pour les opérations de décodage, notez que les classes dérivées de <xref:System.Text.Decoder> incluent une méthode <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> , mais qu'elles n'ont pas de méthode correspondant à <xref:System.Text.Encoding.GetString%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="71230-252">For decoding operations, note that classes derived from <xref:System.Text.Decoder> include a <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> method, but they do not have a method that corresponds to <xref:System.Text.Encoding.GetString%2A?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="71230-253">L'exemple suivant montre la différence entre l'utilisation des méthodes <xref:System.Text.Encoding.GetChars%2A?displayProperty=nameWithType> et <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> pour le décodage d'un tableau d'octets Unicode.</span><span class="sxs-lookup"><span data-stu-id="71230-253">The following example illustrates the difference between using the <xref:System.Text.Encoding.GetChars%2A?displayProperty=nameWithType> and <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> methods for decoding a Unicode byte array.</span></span> <span data-ttu-id="71230-254">L'exemple encode une chaîne qui contient des caractères Unicode vers un fichier, puis utilise les deux méthodes de décodage pour les décoder par dix octets à la fois.</span><span class="sxs-lookup"><span data-stu-id="71230-254">The example encodes a string that contains some Unicode characters to a file, and then uses the two decoding methods to decode them ten bytes at a time.</span></span> <span data-ttu-id="71230-255">Une paire de substitution se trouvant dans les dixième et onzième octets, elle est décodée dans des appels de méthode distincts.</span><span class="sxs-lookup"><span data-stu-id="71230-255">Because a surrogate pair occurs in the tenth and eleventh bytes, it is decoded in separate method calls.</span></span> <span data-ttu-id="71230-256">Comme la sortie le montre, la méthode <xref:System.Text.Encoding.GetChars%2A?displayProperty=nameWithType> ne peut pas décoder correctement les octets et les remplace par U+FFFD (CARACTÈRE DE REMPLACEMENT).</span><span class="sxs-lookup"><span data-stu-id="71230-256">As the output shows, the <xref:System.Text.Encoding.GetChars%2A?displayProperty=nameWithType> method is not able to correctly decode the bytes and instead replaces them with U+FFFD (REPLACEMENT CHARACTER).</span></span> <span data-ttu-id="71230-257">En revanche, la méthode <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> peut décoder correctement le tableau d'octets pour obtenir la chaîne d'origine.</span><span class="sxs-lookup"><span data-stu-id="71230-257">On the other hand, the <xref:System.Text.Decoder.GetChars%2A?displayProperty=nameWithType> method is able to successfully decode the byte array to get the original string.</span></span>

[!code-csharp[Conceptual.Encoding#10](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/stream1.cs#10)]
[!code-vb[Conceptual.Encoding#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/stream1.vb#10)]

<a name="FallbackStrategy"></a>

## <a name="choosing-a-fallback-strategy"></a><span data-ttu-id="71230-258">Choix d'une stratégie de secours</span><span class="sxs-lookup"><span data-stu-id="71230-258">Choosing a Fallback Strategy</span></span>

<span data-ttu-id="71230-259">Quand une méthode tente d'encoder ou de décoder un caractère, mais qu'il n'existe pas de mappage, elle doit implémenter une stratégie de secours qui détermine comment l'échec du mappage doit être traité.</span><span class="sxs-lookup"><span data-stu-id="71230-259">When a method tries to encode or decode a character but no mapping exists, it must implement a fallback strategy that determines how the failed mapping should be handled.</span></span> <span data-ttu-id="71230-260">Il existe trois types de stratégies de secours :</span><span class="sxs-lookup"><span data-stu-id="71230-260">There are three types of fallback strategies:</span></span>

- <span data-ttu-id="71230-261">Best-Fit Fallback</span><span class="sxs-lookup"><span data-stu-id="71230-261">Best-fit fallback</span></span>

- <span data-ttu-id="71230-262">Replacement Fallback</span><span class="sxs-lookup"><span data-stu-id="71230-262">Replacement fallback</span></span>

- <span data-ttu-id="71230-263">Exception Fallback</span><span class="sxs-lookup"><span data-stu-id="71230-263">Exception fallback</span></span>

> [!IMPORTANT]
> <span data-ttu-id="71230-264">Les problèmes les plus courants des opérations d'encodage se produisent quand un caractère Unicode ne peut pas être mappé à un encodage de page de codes particulier.</span><span class="sxs-lookup"><span data-stu-id="71230-264">The most common problems in encoding operations occur when a Unicode character cannot be mapped to a particular code page encoding.</span></span> <span data-ttu-id="71230-265">Les problèmes les plus courants des opérations de décodage se produisent quand des séquences d'octets non valides ne peut pas être traduites en caractères Unicode valides.</span><span class="sxs-lookup"><span data-stu-id="71230-265">The most common problems in decoding operations occur when invalid byte sequences cannot be translated into valid Unicode characters.</span></span> <span data-ttu-id="71230-266">Pour ces raisons, vous devez savoir quelle stratégie de secours est utilisée par un objet de codage particulier.</span><span class="sxs-lookup"><span data-stu-id="71230-266">For these reasons, you should know which fallback strategy a particular encoding object uses.</span></span> <span data-ttu-id="71230-267">Chaque fois que c'est possible, vous devez spécifier la stratégie de secours utilisée par un objet d'encodage quand vous instanciez l'objet.</span><span class="sxs-lookup"><span data-stu-id="71230-267">Whenever possible, you should specify the fallback strategy used by an encoding object when you instantiate the object.</span></span>

<a name="BestFit"></a>

### <a name="best-fit-fallback"></a><span data-ttu-id="71230-268">Best-Fit Fallback</span><span class="sxs-lookup"><span data-stu-id="71230-268">Best-Fit Fallback</span></span>

<span data-ttu-id="71230-269">Quand un caractère n'a pas de correspondance exacte dans l'encodage cible, l'encodeur peut essayer de le mapper à un caractère similaire.</span><span class="sxs-lookup"><span data-stu-id="71230-269">When a character does not have an exact match in the target encoding, the encoder can try to map it to a similar character.</span></span> <span data-ttu-id="71230-270">(La stratégie de secours la mieux adaptée est principalement un codage plutôt qu'un problème de décodage.</span><span class="sxs-lookup"><span data-stu-id="71230-270">(Best-fit fallback is mostly an encoding rather than a decoding issue.</span></span> <span data-ttu-id="71230-271">Il y a très peu de pages de codes qui contiennent des caractères qui ne peuvent pas être correctement mappés au format Unicode.) L’option de secours la mieux adaptée est la valeur par défaut pour les encodages de pages de codes et de jeux de caractères codés sur deux octets, qui sont récupérés par le <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> et <xref:System.Text.Encoding.GetEncoding%28System.String%29?displayProperty=nameWithType> surcharges.</span><span class="sxs-lookup"><span data-stu-id="71230-271">There are very few code pages that contain characters that cannot be successfully mapped to Unicode.) Best-fit fallback is the default for code page and double-byte character set encodings that are retrieved by the <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> and <xref:System.Text.Encoding.GetEncoding%28System.String%29?displayProperty=nameWithType> overloads.</span></span>

> [!NOTE]
> <span data-ttu-id="71230-272">En théorie, les classes d'encodage Unicode fournies dans .NET (<xref:System.Text.UTF8Encoding>, <xref:System.Text.UnicodeEncoding> et <xref:System.Text.UTF32Encoding>) prennent en charge tous les caractères de tous les jeux de caractères : elles peuvent donc être utilisées pour éliminer les problèmes de la stratégie de secours la mieux adaptée.</span><span class="sxs-lookup"><span data-stu-id="71230-272">In theory, the Unicode encoding classes provided in .NET (<xref:System.Text.UTF8Encoding>, <xref:System.Text.UnicodeEncoding>, and <xref:System.Text.UTF32Encoding>) support every character in every character set, so they can be used to eliminate best-fit fallback issues.</span></span>

<span data-ttu-id="71230-273">Les stratégies de secours les mieux adaptées varient pour les différentes pages de codes.</span><span class="sxs-lookup"><span data-stu-id="71230-273">Best-fit strategies vary for different code pages.</span></span> <span data-ttu-id="71230-274">Par exemple, pour certaines pages de codes, les caractères latins à pleine chasse sont mappés aux caractères latins à demi-chasse plus courants.</span><span class="sxs-lookup"><span data-stu-id="71230-274">For example, for some code pages, full-width Latin characters map to the more common half-width Latin characters.</span></span> <span data-ttu-id="71230-275">Pour d'autres pages de codes, ce mappage n'est pas effectué.</span><span class="sxs-lookup"><span data-stu-id="71230-275">For other code pages, this mapping is not made.</span></span> <span data-ttu-id="71230-276">Même avec une stratégie la plus adaptée appliquée de façon agressive, il n'existe pas d'ajustement possible pour certains caractères dans certains encodages.</span><span class="sxs-lookup"><span data-stu-id="71230-276">Even under an aggressive best-fit strategy, there is no imaginable fit for some characters in some encodings.</span></span> <span data-ttu-id="71230-277">Par exemple, un idéogramme chinois n'a pas de mappage acceptable avec la page de codes 1252.</span><span class="sxs-lookup"><span data-stu-id="71230-277">For example, a Chinese ideograph has no reasonable mapping to code page 1252.</span></span> <span data-ttu-id="71230-278">Dans ce cas, une chaîne de remplacement est utilisée.</span><span class="sxs-lookup"><span data-stu-id="71230-278">In this case, a replacement string is used.</span></span> <span data-ttu-id="71230-279">Par défaut, cette chaîne est simplement un POINT D'INTERROGATION (U+003F).</span><span class="sxs-lookup"><span data-stu-id="71230-279">By default, this string is just a single QUESTION MARK (U+003F).</span></span>

> [!NOTE]
> <span data-ttu-id="71230-280">Les stratégies de secours les mieux adaptées ne sont pas documentées en détail.</span><span class="sxs-lookup"><span data-stu-id="71230-280">Best-fit strategies are not documented in detail.</span></span> <span data-ttu-id="71230-281">Toutefois, plusieurs pages de codes sont documentées sur le site Web du [consortium Unicode](https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WindowsBestFit/).</span><span class="sxs-lookup"><span data-stu-id="71230-281">However, several code pages are documented at the [Unicode Consortium's](https://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WindowsBestFit/) website.</span></span> <span data-ttu-id="71230-282">Consultez le fichier **readme.txt** de ce dossier pour obtenir une description sur la manière d’interpréter les fichiers de mappage.</span><span class="sxs-lookup"><span data-stu-id="71230-282">Please review the **readme.txt** file in that folder for a description of how to interpret the mapping files.</span></span>

<span data-ttu-id="71230-283">L'exemple suivant utilise la page de codes 1252 (la page de codes Windows pour les langues d'Europe occidentale) pour illustrer le mappage le mieux adapté et ses inconvénients.</span><span class="sxs-lookup"><span data-stu-id="71230-283">The following example uses code page 1252 (the Windows code page for Western European languages) to illustrate best-fit mapping and its drawbacks.</span></span> <span data-ttu-id="71230-284">La méthode <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> est utilisée pour récupérer un objet d'encodage pour la page de codes 1252.</span><span class="sxs-lookup"><span data-stu-id="71230-284">The <xref:System.Text.Encoding.GetEncoding%28System.Int32%29?displayProperty=nameWithType> method is used to retrieve an encoding object for code page 1252.</span></span> <span data-ttu-id="71230-285">Par défaut, elle utilise un mappage le mieux adapté pour les caractères Unicode qu'elle ne prend pas en charge.</span><span class="sxs-lookup"><span data-stu-id="71230-285">By default, it uses a best-fit mapping for Unicode characters that it does not support.</span></span> <span data-ttu-id="71230-286">L'exemple instancie une chaîne contenant trois caractères non-ASCII, LETTRE MAJUSCULE LATINE S CERCLÉE (U+24C8), EXPOSANT CINQ (U+2075) et INFINI (U+221E), séparés par des espaces.</span><span class="sxs-lookup"><span data-stu-id="71230-286">The example instantiates a string that contains three non-ASCII characters - CIRCLED LATIN CAPITAL LETTER S (U+24C8), SUPERSCRIPT FIVE (U+2075), and INFINITY (U+221E) - separated by spaces.</span></span> <span data-ttu-id="71230-287">Comme le montre la sortie de l'exemple, quand la chaîne est encodée, les trois caractères d'origine autres qu'un espace sont remplacés par POINT D'INTERROGATION (U+003F), CHIFFRE CINQ (U+0035) et CHIFFRE HUIT (U+0038).</span><span class="sxs-lookup"><span data-stu-id="71230-287">As the output from the example shows, when the string is encoded, the three original non-space characters are replaced by QUESTION MARK (U+003F), DIGIT FIVE (U+0035), and DIGIT EIGHT (U+0038).</span></span> <span data-ttu-id="71230-288">CHIFFRE HUIT est un substitut particulièrement médiocre pour le caractère INFINI non pris en charge, et POINT D'INTERROGATION indique qu'aucun mappage n'est disponible pour le caractère d'origine.</span><span class="sxs-lookup"><span data-stu-id="71230-288">DIGIT EIGHT is a particularly poor replacement for the unsupported INFINITY character, and QUESTION MARK indicates that no mapping was available for the original character.</span></span>

[!code-csharp[Conceptual.Encoding#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/bestfit1.cs#1)]
[!code-vb[Conceptual.Encoding#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/bestfit1.vb#1)]

<span data-ttu-id="71230-289">Le mappage le mieux adapté est le comportement par défaut pour un objet <xref:System.Text.Encoding> qui encode des données Unicode en données de page de codes, et il existe des applications héritées qui s'appuient sur ce comportement.</span><span class="sxs-lookup"><span data-stu-id="71230-289">Best-fit mapping is the default behavior for an <xref:System.Text.Encoding> object that encodes Unicode data into code page data, and there are legacy applications that rely on this behavior.</span></span> <span data-ttu-id="71230-290">Cependant, la plupart des nouvelles applications doivent éviter ce comportement le mieux adapté pour des raisons de sécurité.</span><span class="sxs-lookup"><span data-stu-id="71230-290">However, most new applications should avoid best-fit behavior for security reasons.</span></span> <span data-ttu-id="71230-291">Par exemple, les applications ne doivent pas établir un nom de domaine via un encodage le mieux adapté.</span><span class="sxs-lookup"><span data-stu-id="71230-291">For example, applications should not put a domain name through a best-fit encoding.</span></span>

> [!NOTE]
> <span data-ttu-id="71230-292">Vous pouvez également implémenter un mappage de stratégie de secours la mieux adaptée personnalisé pour un encodage.</span><span class="sxs-lookup"><span data-stu-id="71230-292">You can also implement a custom best-fit fallback mapping for an encoding.</span></span> <span data-ttu-id="71230-293">Pour plus d’informations, consultez la section [Implementing a Custom Fallback Strategy](../../../docs/standard/base-types/character-encoding.md#Custom) .</span><span class="sxs-lookup"><span data-stu-id="71230-293">For more information, see the [Implementing a Custom Fallback Strategy](../../../docs/standard/base-types/character-encoding.md#Custom) section.</span></span>

<span data-ttu-id="71230-294">Si la stratégie de secours la mieux adaptée est la stratégie par défaut pour un objet d'encodage, vous pouvez choisir une autre stratégie de secours quand vous récupérez un objet <xref:System.Text.Encoding> , en appelant la surcharge <xref:System.Text.Encoding.GetEncoding%28System.Int32%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> ou <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="71230-294">If best-fit fallback is the default for an encoding object, you can choose another fallback strategy when you retrieve an <xref:System.Text.Encoding> object by calling the <xref:System.Text.Encoding.GetEncoding%28System.Int32%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> or <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> overload.</span></span> <span data-ttu-id="71230-295">La section suivante contient un exemple qui remplace chaque caractère qui ne peut pas être mappé à la page de codes 1252 par un astérisque (\*).</span><span class="sxs-lookup"><span data-stu-id="71230-295">The following section includes an example that replaces each character that cannot be mapped to code page 1252 with an asterisk (\*).</span></span>

[!code-csharp[Conceptual.Encoding#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/bestfit1a.cs#3)]
[!code-vb[Conceptual.Encoding#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/bestfit1a.vb#3)]

<a name="Replacement"></a>

### <a name="replacement-fallback"></a><span data-ttu-id="71230-296">Replacement Fallback</span><span class="sxs-lookup"><span data-stu-id="71230-296">Replacement Fallback</span></span>

<span data-ttu-id="71230-297">Quand un caractère n'a pas de correspondance exacte dans le schéma cible, mais qu'il n'existe pas de caractère approprié auquel il peut être mappé, l'application peut spécifier un caractère ou une chaîne de remplacement.</span><span class="sxs-lookup"><span data-stu-id="71230-297">When a character does not have an exact match in the target scheme, but there is no appropriate character that it can be mapped to, the application can specify a replacement character or string.</span></span> <span data-ttu-id="71230-298">Il s'agit du comportement par défaut pour le décodeur Unicode, qui remplace toutes les séquences de deux octets qu'il ne peut pas décoder par CARACTÈRE_DE_REMPLACEMENT (U+FFFD).</span><span class="sxs-lookup"><span data-stu-id="71230-298">This is the default behavior for the Unicode decoder, which replaces any two-byte sequence that it cannot decode with REPLACEMENT_CHARACTER (U+FFFD).</span></span> <span data-ttu-id="71230-299">C'est également le comportement par défaut de la classe <xref:System.Text.ASCIIEncoding> , qui remplace chaque caractère qu'elle ne peut pas encoder ou décoder par un point d'interrogation.</span><span class="sxs-lookup"><span data-stu-id="71230-299">It is also the default behavior of the <xref:System.Text.ASCIIEncoding> class, which replaces each character that it cannot encode or decode with a question mark.</span></span> <span data-ttu-id="71230-300">L'exemple suivant illustre le remplacement de caractères pour la chaîne Unicode de l'exemple précédent.</span><span class="sxs-lookup"><span data-stu-id="71230-300">The following example illustrates character replacement for the Unicode string from the previous example.</span></span> <span data-ttu-id="71230-301">Comme le montre la sortie, chaque caractère qui ne peut pas être décodé en une valeur d'octet ASCII est remplacé par 0x3F, qui est le code ASCII pour un point d'interrogation.</span><span class="sxs-lookup"><span data-stu-id="71230-301">As the output shows, each character that cannot be decoded into an ASCII byte value is replaced by 0x3F, which is the ASCII code for a question mark.</span></span>

[!code-csharp[Conceptual.Encoding#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/replacementascii.cs#2)]
[!code-vb[Conceptual.Encoding#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/replacementascii.vb#2)]

<span data-ttu-id="71230-302">.NET comprend les classes <xref:System.Text.EncoderReplacementFallback> et <xref:System.Text.DecoderReplacementFallback>, qui substituent une chaîne de remplacement si un caractère ne se mappe pas exactement dans une opération d'encodage ou de décodage.</span><span class="sxs-lookup"><span data-stu-id="71230-302">.NET includes the <xref:System.Text.EncoderReplacementFallback> and <xref:System.Text.DecoderReplacementFallback> classes, which substitute a replacement string if a character does not map exactly in an encoding or decoding operation.</span></span> <span data-ttu-id="71230-303">Par défaut, cette chaîne de remplacement est un point d'interrogation, mais vous pouvez appeler une surcharge de constructeur de classe pour choisir une autre chaîne.</span><span class="sxs-lookup"><span data-stu-id="71230-303">By default, this replacement string is a question mark, but you can call a class constructor overload to choose a different string.</span></span> <span data-ttu-id="71230-304">En général, la chaîne de remplacement est un caractère unique, même si ce n'est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="71230-304">Typically, the replacement string is a single character, although this is not a requirement.</span></span> <span data-ttu-id="71230-305">L'exemple suivant change le comportement de l'encodeur de la page de codes 1252 en instanciant un objet <xref:System.Text.EncoderReplacementFallback> qui utilise un astérisque (\*) comme chaîne de remplacement.</span><span class="sxs-lookup"><span data-stu-id="71230-305">The following example changes the behavior of the code page 1252 encoder by instantiating an <xref:System.Text.EncoderReplacementFallback> object that uses an asterisk (\*) as a replacement string.</span></span>

[!code-csharp[Conceptual.Encoding#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/bestfit1a.cs#3)]
[!code-vb[Conceptual.Encoding#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/bestfit1a.vb#3)]

> [!NOTE]
> <span data-ttu-id="71230-306">Vous pouvez également implémenter une classe de remplacement pour un encodage.</span><span class="sxs-lookup"><span data-stu-id="71230-306">You can also implement a replacement class for an encoding.</span></span> <span data-ttu-id="71230-307">Pour plus d’informations, consultez la section [Implementing a Custom Fallback Strategy](../../../docs/standard/base-types/character-encoding.md#Custom) .</span><span class="sxs-lookup"><span data-stu-id="71230-307">For more information, see the [Implementing a Custom Fallback Strategy](../../../docs/standard/base-types/character-encoding.md#Custom) section.</span></span>

<span data-ttu-id="71230-308">En plus du POINT D'INTERROGATION (U+003F), le CARACTÈRE DE REMPLACEMENT Unicode (U+FFFD) est couramment utilisé comme chaîne de remplacement, en particulier lors du décodage de séquences d'octets qui ne peuvent pas être converties en caractères Unicode.</span><span class="sxs-lookup"><span data-stu-id="71230-308">In addition to QUESTION MARK (U+003F), the Unicode REPLACEMENT CHARACTER (U+FFFD) is commonly used as a replacement string, particularly when decoding byte sequences that cannot be successfully translated into Unicode characters.</span></span> <span data-ttu-id="71230-309">Vous êtes cependant libre de choisir n'importe quelle chaîne de remplacement, qui peut contenir plusieurs caractères.</span><span class="sxs-lookup"><span data-stu-id="71230-309">However, you are free to choose any replacement string, and it can contain multiple characters.</span></span>

<a name="Exception"></a>

### <a name="exception-fallback"></a><span data-ttu-id="71230-310">Exception Fallback</span><span class="sxs-lookup"><span data-stu-id="71230-310">Exception Fallback</span></span>

<span data-ttu-id="71230-311">Au lieu de fournir une stratégie de secours la mieux adaptée ou une chaîne de remplacement, un encodeur peut lever une <xref:System.Text.EncoderFallbackException> si elle ne peut pas encoder un jeu de caractères, et un décodeur peut lever une <xref:System.Text.DecoderFallbackException> s'il ne peut pas décoder un tableau d'octets.</span><span class="sxs-lookup"><span data-stu-id="71230-311">Instead of providing a best-fit fallback or a replacement string, an encoder can throw an <xref:System.Text.EncoderFallbackException> if it is unable to encode a set of characters, and a decoder can throw a <xref:System.Text.DecoderFallbackException> if it is unable to decode a byte array.</span></span> <span data-ttu-id="71230-312">Pour lever une exception dans les opérations d'encodage et de décodage, vous fournissez un objet <xref:System.Text.EncoderExceptionFallback> et un objet <xref:System.Text.DecoderExceptionFallback> , respectivement, à la méthode <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="71230-312">To throw an exception in encoding and decoding operations, you supply an <xref:System.Text.EncoderExceptionFallback> object and a <xref:System.Text.DecoderExceptionFallback> object, respectively, to the <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="71230-313">L'exemple suivant montre la stratégie de secours pour les exceptions avec la classe <xref:System.Text.ASCIIEncoding> .</span><span class="sxs-lookup"><span data-stu-id="71230-313">The following example illustrates exception fallback with the <xref:System.Text.ASCIIEncoding> class.</span></span>

[!code-csharp[Conceptual.Encoding#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/exceptionascii.cs#4)]
[!code-vb[Conceptual.Encoding#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/exceptionascii.vb#4)]

> [!NOTE]
> <span data-ttu-id="71230-314">Vous pouvez également implémenter un gestionnaire d'exceptions personnalisé pour une opération d'encodage.</span><span class="sxs-lookup"><span data-stu-id="71230-314">You can also implement a custom exception handler for an encoding operation.</span></span> <span data-ttu-id="71230-315">Pour plus d’informations, consultez la section [Implementing a Custom Fallback Strategy](../../../docs/standard/base-types/character-encoding.md#Custom) .</span><span class="sxs-lookup"><span data-stu-id="71230-315">For more information, see the [Implementing a Custom Fallback Strategy](../../../docs/standard/base-types/character-encoding.md#Custom) section.</span></span>

<span data-ttu-id="71230-316">Les objets <xref:System.Text.EncoderFallbackException> et <xref:System.Text.DecoderFallbackException> fournissent les informations suivantes sur la condition qui a provoqué l'exception :</span><span class="sxs-lookup"><span data-stu-id="71230-316">The <xref:System.Text.EncoderFallbackException> and <xref:System.Text.DecoderFallbackException> objects provide the following information about the condition that caused the exception:</span></span>

- <span data-ttu-id="71230-317">L'objet <xref:System.Text.EncoderFallbackException> comprend une méthode <xref:System.Text.EncoderFallbackException.IsUnknownSurrogate%2A> , qui indique si le ou les caractères qui ne peuvent pas être encodés représentent une paire de substitution inconnue (auquel cas la méthode retourne `true`) ou un seul caractère inconnu (auquel cas la méthode retourne `false`).</span><span class="sxs-lookup"><span data-stu-id="71230-317">The <xref:System.Text.EncoderFallbackException> object includes an <xref:System.Text.EncoderFallbackException.IsUnknownSurrogate%2A> method, which indicates whether the character or characters that cannot be encoded represent an unknown surrogate pair (in which case, the method returns `true`) or an unknown single character (in which case, the method returns `false`).</span></span> <span data-ttu-id="71230-318">Les caractères de la paire de substitution sont disponibles dans les propriétés <xref:System.Text.EncoderFallbackException.CharUnknownHigh%2A?displayProperty=nameWithType> et <xref:System.Text.EncoderFallbackException.CharUnknownLow%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="71230-318">The characters in the surrogate pair are available from the <xref:System.Text.EncoderFallbackException.CharUnknownHigh%2A?displayProperty=nameWithType> and <xref:System.Text.EncoderFallbackException.CharUnknownLow%2A?displayProperty=nameWithType> properties.</span></span> <span data-ttu-id="71230-319">Le caractère unique inconnu est disponible dans la propriété <xref:System.Text.EncoderFallbackException.CharUnknown%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="71230-319">The unknown single character is available from the <xref:System.Text.EncoderFallbackException.CharUnknown%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="71230-320">La propriété <xref:System.Text.EncoderFallbackException.Index%2A?displayProperty=nameWithType> indique la position dans la chaîne du premier caractère qui n'a pas pu être encodé.</span><span class="sxs-lookup"><span data-stu-id="71230-320">The <xref:System.Text.EncoderFallbackException.Index%2A?displayProperty=nameWithType> property indicates the position in the string at which the first character that could not be encoded was found.</span></span>

- <span data-ttu-id="71230-321">L'objet <xref:System.Text.DecoderFallbackException> comprend une propriété <xref:System.Text.DecoderFallbackException.BytesUnknown%2A> qui retourne un tableau d'octets qui ne peut pas être décodé.</span><span class="sxs-lookup"><span data-stu-id="71230-321">The <xref:System.Text.DecoderFallbackException> object includes a <xref:System.Text.DecoderFallbackException.BytesUnknown%2A> property that returns an array of bytes that cannot be decoded.</span></span> <span data-ttu-id="71230-322">La propriété <xref:System.Text.DecoderFallbackException.Index%2A?displayProperty=nameWithType> indique la position de départ des octets inconnus.</span><span class="sxs-lookup"><span data-stu-id="71230-322">The <xref:System.Text.DecoderFallbackException.Index%2A?displayProperty=nameWithType> property indicates the starting position of the unknown bytes.</span></span>

<span data-ttu-id="71230-323">Bien que les objets <xref:System.Text.EncoderFallbackException> et <xref:System.Text.DecoderFallbackException> fournissent des informations de diagnostic adéquates sur l'exception, ils ne fournissent pas d'accès à la mémoire tampon d'encodage ou de décodage.</span><span class="sxs-lookup"><span data-stu-id="71230-323">Although the <xref:System.Text.EncoderFallbackException> and <xref:System.Text.DecoderFallbackException> objects provide adequate diagnostic information about the exception, they do not provide access to the encoding or decoding buffer.</span></span> <span data-ttu-id="71230-324">Par conséquent, ils ne permettent pas le remplacement ou la correction des données non valides dans la méthode d'encodage ou de décodage.</span><span class="sxs-lookup"><span data-stu-id="71230-324">Therefore, they do not allow invalid data to be replaced or corrected within the encoding or decoding method.</span></span>

<a name="Custom"></a>

## <a name="implementing-a-custom-fallback-strategy"></a><span data-ttu-id="71230-325">Implementing a Custom Fallback Strategy</span><span class="sxs-lookup"><span data-stu-id="71230-325">Implementing a Custom Fallback Strategy</span></span>

<span data-ttu-id="71230-326">En plus du mappage le mieux adapté implémenté en interne par les pages de codes, .NET comprend les classes suivantes pour l’implémentation d’une stratégie de secours :</span><span class="sxs-lookup"><span data-stu-id="71230-326">In addition to the best-fit mapping that is implemented internally by code pages, .NET includes the following classes for implementing a fallback strategy:</span></span>

- <span data-ttu-id="71230-327">Utilisez <xref:System.Text.EncoderReplacementFallback> et <xref:System.Text.EncoderReplacementFallbackBuffer> pour remplacer des caractères dans les opérations d'encodage.</span><span class="sxs-lookup"><span data-stu-id="71230-327">Use <xref:System.Text.EncoderReplacementFallback> and <xref:System.Text.EncoderReplacementFallbackBuffer> to replace characters in encoding operations.</span></span>

- <span data-ttu-id="71230-328">Utilisez <xref:System.Text.DecoderReplacementFallback> et <xref:System.Text.DecoderReplacementFallbackBuffer> pour remplacer des caractères dans les opérations de décodage.</span><span class="sxs-lookup"><span data-stu-id="71230-328">Use <xref:System.Text.DecoderReplacementFallback> and <xref:System.Text.DecoderReplacementFallbackBuffer> to replace characters in decoding operations.</span></span>

- <span data-ttu-id="71230-329">Utilisez <xref:System.Text.EncoderExceptionFallback> et <xref:System.Text.EncoderExceptionFallbackBuffer> pour lever une <xref:System.Text.EncoderFallbackException> quand un caractère ne peut pas être encodé.</span><span class="sxs-lookup"><span data-stu-id="71230-329">Use <xref:System.Text.EncoderExceptionFallback> and <xref:System.Text.EncoderExceptionFallbackBuffer> to throw an <xref:System.Text.EncoderFallbackException> when a character cannot be encoded.</span></span>

- <span data-ttu-id="71230-330">Utilisez <xref:System.Text.DecoderExceptionFallback> et <xref:System.Text.DecoderExceptionFallbackBuffer> pour lever une <xref:System.Text.DecoderFallbackException> quand un caractère ne peut pas être décodé.</span><span class="sxs-lookup"><span data-stu-id="71230-330">Use <xref:System.Text.DecoderExceptionFallback> and <xref:System.Text.DecoderExceptionFallbackBuffer> to throw a <xref:System.Text.DecoderFallbackException> when a character cannot be decoded.</span></span>

<span data-ttu-id="71230-331">En outre, vous pouvez implémenter une solution personnalisée qui utilise une stratégie de secours la mieux adaptée, une stratégie de secours pour les remplacements ou une stratégie de secours pour les exceptions, en procédant comme suit :</span><span class="sxs-lookup"><span data-stu-id="71230-331">In addition, you can implement a custom solution that uses best-fit fallback, replacement fallback, or exception fallback, by following these steps:</span></span>

1. <span data-ttu-id="71230-332">Dérivez une classe de <xref:System.Text.EncoderFallback> pour les opérations d'encodage, et de <xref:System.Text.DecoderFallback> pour les opérations de décodage.</span><span class="sxs-lookup"><span data-stu-id="71230-332">Derive a class from <xref:System.Text.EncoderFallback> for encoding operations, and from <xref:System.Text.DecoderFallback> for decoding operations.</span></span>

2. <span data-ttu-id="71230-333">Dérivez une classe de <xref:System.Text.EncoderFallbackBuffer> pour les opérations d'encodage, et de <xref:System.Text.DecoderFallbackBuffer> pour les opérations de décodage.</span><span class="sxs-lookup"><span data-stu-id="71230-333">Derive a class from <xref:System.Text.EncoderFallbackBuffer> for encoding operations, and from <xref:System.Text.DecoderFallbackBuffer> for decoding operations.</span></span>

3. <span data-ttu-id="71230-334">Pour la stratégie de secours pour les exceptions, si les classes prédéfinies <xref:System.Text.EncoderFallbackException> et <xref:System.Text.DecoderFallbackException> ne répondent pas à vos besoins, dérivez une classe depuis un objet d'exception comme <xref:System.Exception> ou <xref:System.ArgumentException>.</span><span class="sxs-lookup"><span data-stu-id="71230-334">For exception fallback, if the predefined <xref:System.Text.EncoderFallbackException> and <xref:System.Text.DecoderFallbackException> classes do not meet your needs, derive a class from an exception object such as <xref:System.Exception> or <xref:System.ArgumentException>.</span></span>

### <a name="deriving-from-encoderfallback-or-decoderfallback"></a><span data-ttu-id="71230-335">Dérivation depuis EncoderFallback ou DecoderFallback</span><span class="sxs-lookup"><span data-stu-id="71230-335">Deriving from EncoderFallback or DecoderFallback</span></span>

<span data-ttu-id="71230-336">Pour implémenter une solution de stratégie de secours personnalisée, vous devez créer une classe qui hérite de <xref:System.Text.EncoderFallback> pour les opérations d'encodage, et de <xref:System.Text.DecoderFallback> pour les opérations de décodage.</span><span class="sxs-lookup"><span data-stu-id="71230-336">To implement a custom fallback solution, you must create a class that inherits from <xref:System.Text.EncoderFallback> for encoding operations, and from <xref:System.Text.DecoderFallback> for decoding operations.</span></span> <span data-ttu-id="71230-337">Les instances de ces classes sont passées à la méthode <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> et elle servent d'intermédiaire entre la classe d'encodage et l'implémentation de la stratégie de secours.</span><span class="sxs-lookup"><span data-stu-id="71230-337">Instances of these classes are passed to the <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> method and serve as the intermediary between the encoding class and the fallback implementation.</span></span>

<span data-ttu-id="71230-338">Quand vous créez une solution de secours personnalisée pour un encodeur ou un décodeur, vous devez implémenter les membres suivants :</span><span class="sxs-lookup"><span data-stu-id="71230-338">When you create a custom fallback solution for an encoder or decoder, you must implement the following members:</span></span>

- <span data-ttu-id="71230-339">La propriété <xref:System.Text.EncoderFallback.MaxCharCount%2A?displayProperty=nameWithType> ou <xref:System.Text.DecoderFallback.MaxCharCount%2A?displayProperty=nameWithType> , qui retourne le nombre maximal possible de caractères qui peuvent être retournés par la stratégie de secours la mieux adaptée, par la stratégie de secours pour les remplacements ou par la stratégie de secours pour les exceptions pour remplacer un caractère unique.</span><span class="sxs-lookup"><span data-stu-id="71230-339">The <xref:System.Text.EncoderFallback.MaxCharCount%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallback.MaxCharCount%2A?displayProperty=nameWithType> property, which returns the maximum possible number of characters that the best-fit, replacement, or exception fallback can return to replace a single character.</span></span> <span data-ttu-id="71230-340">Pour une stratégie de secours pour les exceptions personnalisée, sa valeur est zéro.</span><span class="sxs-lookup"><span data-stu-id="71230-340">For a custom exception fallback, its value is zero.</span></span>

- <span data-ttu-id="71230-341">La méthode <xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> ou <xref:System.Text.DecoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> , qui retourne votre implémentation personnalisée de <xref:System.Text.EncoderFallbackBuffer> ou de <xref:System.Text.DecoderFallbackBuffer> .</span><span class="sxs-lookup"><span data-stu-id="71230-341">The <xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> method, which returns your custom <xref:System.Text.EncoderFallbackBuffer> or <xref:System.Text.DecoderFallbackBuffer> implementation.</span></span> <span data-ttu-id="71230-342">La méthode est appelée par l'encodeur quand il rencontre le premier caractère qu'il est impossible d'encoder correctement, ou par le décodeur quand il rencontre le premier octet qu'il est impossible de décoder correctement.</span><span class="sxs-lookup"><span data-stu-id="71230-342">The method is called by the encoder when it encounters the first character that it is unable to successfully encode, or by the decoder when it encounters the first byte that it is unable to successfully decode.</span></span>

### <a name="deriving-from-encoderfallbackbuffer-or-decoderfallbackbuffer"></a><span data-ttu-id="71230-343">Dérivation depuis EncoderFallbackBuffer ou DecoderFallbackBuffer</span><span class="sxs-lookup"><span data-stu-id="71230-343">Deriving from EncoderFallbackBuffer or DecoderFallbackBuffer</span></span>

<span data-ttu-id="71230-344">Pour implémenter une solution de secours personnalisée, vous devez aussi créer une classe qui hérite de <xref:System.Text.EncoderFallbackBuffer> pour les opérations d'encodage, et de <xref:System.Text.DecoderFallbackBuffer> pour les opérations de décodage.</span><span class="sxs-lookup"><span data-stu-id="71230-344">To implement a custom fallback solution, you must also create a class that inherits from <xref:System.Text.EncoderFallbackBuffer> for encoding operations, and from <xref:System.Text.DecoderFallbackBuffer> for decoding operations.</span></span> <span data-ttu-id="71230-345">Les instances de ces classes sont retournées par la méthode <xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A> des classes <xref:System.Text.EncoderFallback> et <xref:System.Text.DecoderFallback> .</span><span class="sxs-lookup"><span data-stu-id="71230-345">Instances of these classes are returned by the <xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A> method  of the <xref:System.Text.EncoderFallback> and <xref:System.Text.DecoderFallback> classes.</span></span> <span data-ttu-id="71230-346">La méthode <xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> est appelée par l'encodeur quand il rencontre le premier caractère qu'il ne peut pas encoder, et la méthode <xref:System.Text.DecoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> est appelée par le décodeur quand il rencontre un ou plusieurs octets qu'il ne peut pas décoder.</span><span class="sxs-lookup"><span data-stu-id="71230-346">The <xref:System.Text.EncoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> method is called by the encoder when it encounters the first character that it is not able to encode, and the <xref:System.Text.DecoderFallback.CreateFallbackBuffer%2A?displayProperty=nameWithType> method is called by the decoder when it encounters one or more bytes that it is not able to decode.</span></span> <span data-ttu-id="71230-347">Les classes <xref:System.Text.EncoderFallbackBuffer> et <xref:System.Text.DecoderFallbackBuffer> fournissent l'implémentation de la stratégie de secours.</span><span class="sxs-lookup"><span data-stu-id="71230-347">The <xref:System.Text.EncoderFallbackBuffer> and <xref:System.Text.DecoderFallbackBuffer> classes provide the fallback implementation.</span></span> <span data-ttu-id="71230-348">Chaque instance représente une mémoire tampon qui contient les caractères de secours destinés à remplacer le caractère qui ne peut pas être encodé ou la séquence d'octets qui ne peut pas être décodée.</span><span class="sxs-lookup"><span data-stu-id="71230-348">Each instance represents a buffer that contains the fallback characters that will replace the character that cannot be encoded or the byte sequence that cannot be decoded.</span></span>

<span data-ttu-id="71230-349">Quand vous créez une solution de secours personnalisée pour un encodeur ou un décodeur, vous devez implémenter les membres suivants :</span><span class="sxs-lookup"><span data-stu-id="71230-349">When you create a custom fallback solution for an encoder or decoder, you must implement the following members:</span></span>

- <span data-ttu-id="71230-350">La méthode <xref:System.Text.EncoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> ou <xref:System.Text.DecoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="71230-350">The <xref:System.Text.EncoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="71230-351"><xref:System.Text.EncoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> est appelée par l'encodeur pour fournir à la mémoire tampon de secours des informations concernant le caractère qu'elle ne peut pas encoder.</span><span class="sxs-lookup"><span data-stu-id="71230-351"><xref:System.Text.EncoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> is called by the encoder to provide the fallback buffer with information about the character that it cannot encode.</span></span> <span data-ttu-id="71230-352">Étant donné que le caractère à encoder peut être une paire de substitution, cette méthode est surchargée.</span><span class="sxs-lookup"><span data-stu-id="71230-352">Because the character to be encoded may be a surrogate pair, this method is overloaded.</span></span> <span data-ttu-id="71230-353">Le caractère à encoder et son index dans la chaîne sont passés à une surcharge.</span><span class="sxs-lookup"><span data-stu-id="71230-353">One overload is passed the character to be encoded and its index in the string.</span></span> <span data-ttu-id="71230-354">La demi-zone haute et la demi-zone basse, ainsi que son index dans la chaîne, sont passés à la deuxième surcharge.</span><span class="sxs-lookup"><span data-stu-id="71230-354">The second overload is passed the high and low surrogate along with its index in the string.</span></span> <span data-ttu-id="71230-355">La méthode <xref:System.Text.DecoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> est appelée par le décodeur pour fournir à la mémoire tampon de secours des informations sur les octets qu'elle ne peut pas décoder.</span><span class="sxs-lookup"><span data-stu-id="71230-355">The <xref:System.Text.DecoderFallbackBuffer.Fallback%2A?displayProperty=nameWithType> method is called by the decoder to provide the fallback buffer with information about the bytes that it cannot decode.</span></span> <span data-ttu-id="71230-356">Cette méthode reçoit un tableau d'octets qu'elle ne peut pas décoder, ainsi que l'index du premier octet.</span><span class="sxs-lookup"><span data-stu-id="71230-356">This method is passed an array of bytes that it cannot decode, along with the index of the first byte.</span></span> <span data-ttu-id="71230-357">La méthode de secours doit retourner `true` si la mémoire tampon de secours peut fournir un ou plusieurs caractères les mieux adaptés ou de remplacement ; sinon, elle doit retourner `false`.</span><span class="sxs-lookup"><span data-stu-id="71230-357">The fallback method should return `true` if the fallback buffer can supply a best-fit or replacement character or characters; otherwise, it should return `false`.</span></span> <span data-ttu-id="71230-358">Pour une stratégie de secours pour les exceptions, la méthode de secours doit lever une exception.</span><span class="sxs-lookup"><span data-stu-id="71230-358">For an exception fallback, the fallback method should throw an exception.</span></span>

- <span data-ttu-id="71230-359">La méthode <xref:System.Text.EncoderFallbackBuffer.GetNextChar%2A?displayProperty=nameWithType> ou <xref:System.Text.DecoderFallbackBuffer.GetNextChar%2A?displayProperty=nameWithType> , qui est appelée de façon répétée par l'encodeur ou par le décodeur pour obtenir le caractère suivant de la mémoire tampon de secours.</span><span class="sxs-lookup"><span data-stu-id="71230-359">The <xref:System.Text.EncoderFallbackBuffer.GetNextChar%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallbackBuffer.GetNextChar%2A?displayProperty=nameWithType> method, which is called repeatedly by the encoder or decoder to get the next character from the fallback buffer.</span></span> <span data-ttu-id="71230-360">Quand tous les caractères de secours ont été retournés, la méthode doit retourner U+0000.</span><span class="sxs-lookup"><span data-stu-id="71230-360">When all fallback characters have been returned, the method should return U+0000.</span></span>

- <span data-ttu-id="71230-361">La propriété <xref:System.Text.EncoderFallbackBuffer.Remaining%2A?displayProperty=nameWithType> ou <xref:System.Text.DecoderFallbackBuffer.Remaining%2A?displayProperty=nameWithType> , qui retourne le nombre de caractères restants dans la mémoire tampon de secours.</span><span class="sxs-lookup"><span data-stu-id="71230-361">The <xref:System.Text.EncoderFallbackBuffer.Remaining%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallbackBuffer.Remaining%2A?displayProperty=nameWithType> property, which returns the number of characters remaining in the fallback buffer.</span></span>

- <span data-ttu-id="71230-362">La méthode <xref:System.Text.EncoderFallbackBuffer.MovePrevious%2A?displayProperty=nameWithType> ou <xref:System.Text.DecoderFallbackBuffer.MovePrevious%2A?displayProperty=nameWithType> , qui déplace la position actuelle dans la mémoire tampon de secours au caractère précédent.</span><span class="sxs-lookup"><span data-stu-id="71230-362">The <xref:System.Text.EncoderFallbackBuffer.MovePrevious%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallbackBuffer.MovePrevious%2A?displayProperty=nameWithType> method, which moves the current position in the fallback buffer to the previous character.</span></span>

- <span data-ttu-id="71230-363">La méthode <xref:System.Text.EncoderFallbackBuffer.Reset%2A?displayProperty=nameWithType> ou <xref:System.Text.DecoderFallbackBuffer.Reset%2A?displayProperty=nameWithType> , qui réinitialise la mémoire tampon de secours.</span><span class="sxs-lookup"><span data-stu-id="71230-363">The <xref:System.Text.EncoderFallbackBuffer.Reset%2A?displayProperty=nameWithType> or <xref:System.Text.DecoderFallbackBuffer.Reset%2A?displayProperty=nameWithType> method, which reinitializes the fallback buffer.</span></span>

<span data-ttu-id="71230-364">Si l'implémentation de la stratégie de secours est une stratégie de secours la mieux adaptée ou de remplacement, les classes dérivées de <xref:System.Text.EncoderFallbackBuffer> et de <xref:System.Text.DecoderFallbackBuffer> gèrent également deux champs d'instance privés : le nombre exact de caractères dans la mémoire tampon et l'index du caractère suivant dans la mémoire tampon à retourner.</span><span class="sxs-lookup"><span data-stu-id="71230-364">If the fallback implementation is a best-fit fallback or a replacement fallback, the classes derived from <xref:System.Text.EncoderFallbackBuffer> and <xref:System.Text.DecoderFallbackBuffer> also maintain two private instance fields: the exact number of characters in the buffer; and the index of the next character in the buffer to return.</span></span>

### <a name="an-encoderfallback-example"></a><span data-ttu-id="71230-365">Exemple de stratégie de secours d'encodeur</span><span class="sxs-lookup"><span data-stu-id="71230-365">An EncoderFallback Example</span></span>

<span data-ttu-id="71230-366">L'exemple précédent utilisait une stratégie de sauvegarde pour les remplacements pour remplacer les caractères Unicode qui ne correspondaient pas aux caractères ASCII par un astérisque (\*).</span><span class="sxs-lookup"><span data-stu-id="71230-366">An earlier example used replacement fallback to replace Unicode characters that did not correspond to ASCII characters with an asterisk (\*).</span></span> <span data-ttu-id="71230-367">L'exemple suivant utilise à la place une implémentation de stratégie de secours la mieux adaptée personnalisée pour fournir un meilleur mappage des caractères non-ASCII.</span><span class="sxs-lookup"><span data-stu-id="71230-367">The following example uses a custom best-fit fallback implementation instead to provide a better mapping of non-ASCII characters.</span></span>

<span data-ttu-id="71230-368">Le code suivant définit une classe nommée `CustomMapper` qui est dérivée de <xref:System.Text.EncoderFallback> pour gérer le mappage le mieux adapté des caractères non-ASCII.</span><span class="sxs-lookup"><span data-stu-id="71230-368">The following code defines a class named `CustomMapper` that is derived from <xref:System.Text.EncoderFallback> to handle the best-fit mapping of non-ASCII characters.</span></span> <span data-ttu-id="71230-369">Sa méthode `CreateFallbackBuffer` retourne un objet `CustomMapperFallbackBuffer` , qui fournit l'implémentation de <xref:System.Text.EncoderFallbackBuffer> .</span><span class="sxs-lookup"><span data-stu-id="71230-369">Its `CreateFallbackBuffer` method returns a `CustomMapperFallbackBuffer` object, which provides the <xref:System.Text.EncoderFallbackBuffer> implementation.</span></span> <span data-ttu-id="71230-370">La classe `CustomMapper` utilise un objet <xref:System.Collections.Generic.Dictionary%602> pour stocker les mappages des caractères Unicode non pris en charge (la valeur de la clé) et leurs caractères 8 bits correspondants (qui sont stockés dans deux octets consécutifs dans un entier 64 bits).</span><span class="sxs-lookup"><span data-stu-id="71230-370">The `CustomMapper` class uses a <xref:System.Collections.Generic.Dictionary%602> object to store the mappings of unsupported Unicode characters (the key value) and their corresponding 8-bit characters (which are stored in two consecutive bytes in a 64-bit integer).</span></span> <span data-ttu-id="71230-371">Pour que ce mappage soit disponible pour la mémoire tampon de secours, l'instance de `CustomMapper` est passée comme paramètre au constructeur de classe `CustomMapperFallbackBuffer` .</span><span class="sxs-lookup"><span data-stu-id="71230-371">To make this mapping available to the fallback buffer, the `CustomMapper` instance is passed as a parameter to the `CustomMapperFallbackBuffer` class constructor.</span></span> <span data-ttu-id="71230-372">Comme le mappage le plus long est la chaîne "INF" pour le caractère Unicode U+221E, la propriété `MaxCharCount` retourne 3.</span><span class="sxs-lookup"><span data-stu-id="71230-372">Because the longest mapping is the string "INF" for the Unicode character U+221E, the `MaxCharCount` property returns 3.</span></span>

[!code-csharp[Conceptual.Encoding#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/custom1.cs#5)]
[!code-vb[Conceptual.Encoding#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/custom1.vb#5)]

<span data-ttu-id="71230-373">Le code suivant définit la classe `CustomMapperFallbackBuffer` , qui est dérivée de <xref:System.Text.EncoderFallbackBuffer>.</span><span class="sxs-lookup"><span data-stu-id="71230-373">The following code defines the `CustomMapperFallbackBuffer` class, which is derived from <xref:System.Text.EncoderFallbackBuffer>.</span></span> <span data-ttu-id="71230-374">Le dictionnaire qui contient les mappages les mieux adaptés et qui est défini dans l'instance de `CustomMapper` est disponible à partir de son constructeur de classe.</span><span class="sxs-lookup"><span data-stu-id="71230-374">The dictionary that contains best-fit mappings and that is defined in the `CustomMapper` instance is available from its class constructor.</span></span> <span data-ttu-id="71230-375">Sa méthode `Fallback` retourne `true` si un des caractères Unicode que l'encodeur ASCII ne peut pas encoder est défini dans le dictionnaire de mappage ; sinon, elle retourne `false`.</span><span class="sxs-lookup"><span data-stu-id="71230-375">Its `Fallback` method returns `true` if any of the Unicode characters that the ASCII encoder cannot encode are defined in the mapping dictionary; otherwise, it returns `false`.</span></span> <span data-ttu-id="71230-376">Pour chaque stratégie de secours, la variable privée `count` indique le nombre de caractères qui restent à retourner, et la variable privée `index` indique la position du caractère suivant à retourner dans la mémoire tampon de la chaîne, `charsToReturn`.</span><span class="sxs-lookup"><span data-stu-id="71230-376">For each fallback, the private `count` variable indicates the number of characters that remain to be returned, and the private `index` variable indicates the position in the string buffer, `charsToReturn`, of the next character to return.</span></span>

[!code-csharp[Conceptual.Encoding#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/custom1.cs#6)]
[!code-vb[Conceptual.Encoding#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/custom1.vb#6)]

<span data-ttu-id="71230-377">Le code suivant instancie ensuite l'objet `CustomMapper` et passe une instance de celui-ci à la méthode <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="71230-377">The following code then instantiates the `CustomMapper` object and passes an instance of it to the <xref:System.Text.Encoding.GetEncoding%28System.String%2CSystem.Text.EncoderFallback%2CSystem.Text.DecoderFallback%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="71230-378">La sortie indique que l'implémentation de la stratégie de secours la mieux adaptée gère correctement les trois caractères non-ASCII de la chaîne d'origine.</span><span class="sxs-lookup"><span data-stu-id="71230-378">The output indicates that the best-fit fallback implementation successfully handles the three non-ASCII characters in the original string.</span></span>

[!code-csharp[Conceptual.Encoding#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.encoding/cs/custom1.cs#7)]
[!code-vb[Conceptual.Encoding#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.encoding/vb/custom1.vb#7)]

## <a name="see-also"></a><span data-ttu-id="71230-379">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="71230-379">See also</span></span>

- <xref:System.Text.Encoder>
- <xref:System.Text.Decoder>
- <xref:System.Text.DecoderFallback>
- <xref:System.Text.Encoding>
- <xref:System.Text.EncoderFallback>
- [<span data-ttu-id="71230-380">Globalisation et localisation</span><span class="sxs-lookup"><span data-stu-id="71230-380">Globalization and Localization</span></span>](../../../docs/standard/globalization-localization/index.md)

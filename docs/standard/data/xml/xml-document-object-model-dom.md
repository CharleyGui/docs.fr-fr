---
title: DOM (Document Object Model) XML
ms.date: 03/30/2017
ms.technology: dotnet-standard
ms.assetid: b5e52844-4820-47c0-a61d-de2da33e9f54
author: mairaw
ms.author: mairaw
ms.openlocfilehash: 160d056491ca71f6de039e8cac7302a61504fcd5
ms.sourcegitcommit: d6e27023aeaffc4b5a3cb4b88685018d6284ada4
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/09/2019
ms.locfileid: "67662483"
---
# <a name="xml-document-object-model-dom"></a><span data-ttu-id="97111-102">DOM (Document Object Model) XML</span><span class="sxs-lookup"><span data-stu-id="97111-102">XML Document Object Model (DOM)</span></span>

<span data-ttu-id="97111-103">La classe DOM (Document Object Model) XML fournit une représentation en mémoire d'un document XML.</span><span class="sxs-lookup"><span data-stu-id="97111-103">The XML Document Object Model (DOM) class is an in-memory representation of an XML document.</span></span> <span data-ttu-id="97111-104">Le DOM vous permet de lire, de manipuler et de modifier un document XML par programme.</span><span class="sxs-lookup"><span data-stu-id="97111-104">The DOM allows you to programmatically read, manipulate, and modify an XML document.</span></span> <span data-ttu-id="97111-105">La classe **XmlReader** lit également le code XML, mais elle garantit seulement un accès en lecture seule, en avant uniquement et non mis en cache.</span><span class="sxs-lookup"><span data-stu-id="97111-105">The **XmlReader** class also reads XML; however, it provides non-cached, forward-only, read-only access.</span></span> <span data-ttu-id="97111-106">Cela signifie que **XmlReader** n'offre pas la possibilité de modifier les valeurs d'un attribut ou le contenu d'un élément, ni d'insérer ou de supprimer des nœuds.</span><span class="sxs-lookup"><span data-stu-id="97111-106">This means that there are no capabilities to edit the values of an attribute or content of an element, or the ability to insert and remove nodes with the **XmlReader**.</span></span> <span data-ttu-id="97111-107">La modification est la fonction principale du DOM.</span><span class="sxs-lookup"><span data-stu-id="97111-107">Editing is the primary function of the DOM.</span></span> <span data-ttu-id="97111-108">Ce dernier régit la représentation en mémoire commune et structurée des données XML, bien que les données XML véritables soient stockées de façon linéaire lorsqu'elles se trouvent dans un fichier ou qu'elles proviennent d'un autre objet.</span><span class="sxs-lookup"><span data-stu-id="97111-108">It is the common and structured way that XML data is represented in memory, although the actual XML data is stored in a linear fashion when in a file or coming in from another object.</span></span> <span data-ttu-id="97111-109">Voici des données XML :</span><span class="sxs-lookup"><span data-stu-id="97111-109">The following is XML data.</span></span>

## <a name="input"></a><span data-ttu-id="97111-110">Entrée</span><span class="sxs-lookup"><span data-stu-id="97111-110">Input</span></span>

```xml
<?xml version="1.0"?>
  <books>
    <book>
        <author>Carson</author>
        <price format="dollar">31.95</price>
        <pubdate>05/01/2001</pubdate>
    </book>
    <pubinfo>
        <publisher>MSPress</publisher>
        <state>WA</state>
    </pubinfo>
  </books>
```

<span data-ttu-id="97111-111">L'illustration suivante montre comment la mémoire est structurée lorsque ces données XML sont lues dans la structure DOM.</span><span class="sxs-lookup"><span data-stu-id="97111-111">The following illustration shows how memory is structured when this XML data is read into the DOM structure.</span></span>

<span data-ttu-id="97111-112">![Structure d’un document XML](../../../../docs/standard/data/xml/media/xml-to-domtree.gif "XML_To_DOMTree")</span><span class="sxs-lookup"><span data-stu-id="97111-112">![XML document structure](../../../../docs/standard/data/xml/media/xml-to-domtree.gif "XML_To_DOMTree") XML document structure</span></span>

<span data-ttu-id="97111-113">Au sein de la structure d'un document XML, chaque cercle de cette illustration représente un nœud, appelé objet **XmlNode**.</span><span class="sxs-lookup"><span data-stu-id="97111-113">Within the XML document structure, each circle in this illustration represents a node, which is called an **XmlNode** object.</span></span> <span data-ttu-id="97111-114">L’objet **XmlNode** est l’objet de base de l’arborescence DOM.</span><span class="sxs-lookup"><span data-stu-id="97111-114">The **XmlNode** object is the basic object in the DOM tree.</span></span> <span data-ttu-id="97111-115">La classe **XmlDocument**, extension de **XmlNode**, prend en charge des méthodes destinées à exécuter des opérations sur le document dans son ensemble, par exemple pour charger ce dernier en mémoire ou l'enregistrer sous la forme d'un fichier.</span><span class="sxs-lookup"><span data-stu-id="97111-115">The **XmlDocument** class, which extends **XmlNode**, supports methods for performing operations on the document as a whole (for example, loading it into memory or saving the XML to a file.</span></span> <span data-ttu-id="97111-116">La classe **XmlDocument** offre en outre une solution pour afficher et manipuler les nœuds du document XML entier.</span><span class="sxs-lookup"><span data-stu-id="97111-116">In addition, **XmlDocument** provides a means to view and manipulate the nodes in the entire XML document.</span></span> <span data-ttu-id="97111-117">Les classes **XmlNode** et **XmlDocument** bénéficient toutes deux d'améliorations sur le plan des performances et des possibilités d'utilisation. Elles comprennent des méthodes et des propriétés qui permettent :</span><span class="sxs-lookup"><span data-stu-id="97111-117">Both **XmlNode** and **XmlDocument** have performance and usability enhancements and have methods and properties to:</span></span>

- <span data-ttu-id="97111-118">d'accéder et de modifier des nœuds spécifiques au DOM, tels que les nœuds d'élément, de référence d'entité, et bien d'autres ;</span><span class="sxs-lookup"><span data-stu-id="97111-118">Access and modify nodes specific to the DOM, such as element nodes, entity reference nodes, and so on.</span></span>

- <span data-ttu-id="97111-119">d'extraire des nœuds entiers, en plus des informations qu'ils contiennent, telles que le texte des nœuds d'élément.</span><span class="sxs-lookup"><span data-stu-id="97111-119">Retrieve entire nodes, in addition to the information the node contains, such as the text in an element node.</span></span>

  > [!NOTE]
  > <span data-ttu-id="97111-120">Si une application n'a pas besoin des fonctionnalités de structure ou de modifications proposées par le DOM, les classes **XmlReader** et **XmlWriter** assurent un accès en flux continu non mis en cache et en avant uniquement au code XML.</span><span class="sxs-lookup"><span data-stu-id="97111-120">If an application does not require the structure or editing capabilities provided by the DOM, the **XmlReader** and **XmlWriter** classes provide non-cached, forward-only stream access to XML.</span></span> <span data-ttu-id="97111-121">Pour plus d’informations, consultez <xref:System.Xml.XmlReader> et <xref:System.Xml.XmlWriter>.</span><span class="sxs-lookup"><span data-stu-id="97111-121">For more information, see <xref:System.Xml.XmlReader> and <xref:System.Xml.XmlWriter>.</span></span>

<span data-ttu-id="97111-122">Les objets **Node** comportent un ensemble de méthodes et de propriétés, ainsi que des caractéristiques de base et bien définies.</span><span class="sxs-lookup"><span data-stu-id="97111-122">**Node** objects have a set of methods and properties, as well as basic and well-defined characteristics.</span></span> <span data-ttu-id="97111-123">Voici certaines de ces caractéristiques :</span><span class="sxs-lookup"><span data-stu-id="97111-123">Some of these characteristics are:</span></span>

- <span data-ttu-id="97111-124">Un nœud ne possède qu'un seul nœud parent, qui est le nœud situé juste au-dessus de lui.</span><span class="sxs-lookup"><span data-stu-id="97111-124">Nodes have a single parent node, a parent node being a node directly above them.</span></span> <span data-ttu-id="97111-125">Le seul nœud qui est dépourvu de parent est la racine du document, puisqu'il s'agit du nœud de premier niveau qui contient le document lui-même et les fragments de document.</span><span class="sxs-lookup"><span data-stu-id="97111-125">The only nodes that do not have a parent is the Document root, as it is the top-level node and contains the document itself and document fragments.</span></span>

- <span data-ttu-id="97111-126">La plupart des nœuds peuvent comporter plusieurs nœuds enfants, qui sont les nœuds situés directement sous eux.</span><span class="sxs-lookup"><span data-stu-id="97111-126">Most nodes can have multiple child nodes, which are nodes directly below them.</span></span> <span data-ttu-id="97111-127">La liste suivante répertorie des types de nœuds pouvant comporter des nœuds enfants :</span><span class="sxs-lookup"><span data-stu-id="97111-127">The following is a list of node types that can have child nodes.</span></span>

  - <span data-ttu-id="97111-128">**Document**</span><span class="sxs-lookup"><span data-stu-id="97111-128">**Document**</span></span>

  - <span data-ttu-id="97111-129">**DocumentFragment**</span><span class="sxs-lookup"><span data-stu-id="97111-129">**DocumentFragment**</span></span>

  - <span data-ttu-id="97111-130">**EntityReference**</span><span class="sxs-lookup"><span data-stu-id="97111-130">**EntityReference**</span></span>

  - <span data-ttu-id="97111-131">**Élément**</span><span class="sxs-lookup"><span data-stu-id="97111-131">**Element**</span></span>

  - <span data-ttu-id="97111-132">**Attribut**</span><span class="sxs-lookup"><span data-stu-id="97111-132">**Attribute**</span></span>

  <span data-ttu-id="97111-133">Les nœuds **XmlDeclaration**, **Notation**, **Entity**, **CDATASection**, **Text**, **Comment**, **ProcessingInstruction** et **DocumentType** n’ont pas de nœuds enfants.</span><span class="sxs-lookup"><span data-stu-id="97111-133">The **XmlDeclaration**, **Notation**, **Entity**, **CDATASection**, **Text**, **Comment**, **ProcessingInstruction**, and **DocumentType** nodes do not have child nodes.</span></span>

- <span data-ttu-id="97111-134">Les nœuds situés au même niveau, représentés dans le diagramme par les nœuds **book** et **pubinfo**, sont des nœuds frères.</span><span class="sxs-lookup"><span data-stu-id="97111-134">Nodes that are at the same level, represented in the diagram by the **book** and **pubinfo** nodes, are siblings.</span></span>

<span data-ttu-id="97111-135">L'une des caractéristiques du DOM est la manière dont il gère les attributs.</span><span class="sxs-lookup"><span data-stu-id="97111-135">One characteristic of the DOM is how it handles attributes.</span></span> <span data-ttu-id="97111-136">Les attributs ne sont pas des nœuds qui font partie des relations parent-enfant et frère.</span><span class="sxs-lookup"><span data-stu-id="97111-136">Attributes are not nodes that are part of the parent, child, and sibling relationships.</span></span> <span data-ttu-id="97111-137">Ils sont considérés comme une propriété du nœud d'élément et sont constitués d'une paire composée d'un nom et d'une valeur.</span><span class="sxs-lookup"><span data-stu-id="97111-137">Attributes are considered a property of the element node and are made up of a name and a value pair.</span></span> <span data-ttu-id="97111-138">Par exemple, si vous avez des données XML composées de `format="dollar` associées à l'élément `price`, le mot `format` correspond au nom et la valeur de l'attribut `format` est `dollar`.</span><span class="sxs-lookup"><span data-stu-id="97111-138">For example, if you have XML data consisting of `format="dollar`" associated with the element `price`, the word `format` is the name, and the value of the `format` attribute is `dollar`.</span></span> <span data-ttu-id="97111-139">Pour extraire l'attribut `format="dollar"` du nœud **price**, vous appelez la méthode **GetAttribute** lorsque le curseur se trouve au nœud d'élément `price`.</span><span class="sxs-lookup"><span data-stu-id="97111-139">To retrieve the `format="dollar"` attribute of the **price** node, you call the **GetAttribute** method when the cursor is located at the `price` element node.</span></span> <span data-ttu-id="97111-140">Pour plus d'informations, consultez [Accès aux attributs dans le DOM](../../../../docs/standard/data/xml/accessing-attributes-in-the-dom.md).</span><span class="sxs-lookup"><span data-stu-id="97111-140">For more information, see [Accessing Attributes in the DOM](../../../../docs/standard/data/xml/accessing-attributes-in-the-dom.md).</span></span>

<span data-ttu-id="97111-141">Lorsque le code XML est lu en mémoire, des nœuds sont créés.</span><span class="sxs-lookup"><span data-stu-id="97111-141">As XML is read into memory, nodes are created.</span></span> <span data-ttu-id="97111-142">Toutefois, tous les nœuds ne sont pas du même type.</span><span class="sxs-lookup"><span data-stu-id="97111-142">However, not all nodes are the same type.</span></span> <span data-ttu-id="97111-143">Un élément, dans XML, possède des règles et une syntaxe différentes de celles d'une instruction de traitement.</span><span class="sxs-lookup"><span data-stu-id="97111-143">An element in XML has different rules and syntax than a processing instruction.</span></span> <span data-ttu-id="97111-144">C'est pourquoi, à mesure que des données diverses sont lues, un type de nœud est assigné à chaque nœud.</span><span class="sxs-lookup"><span data-stu-id="97111-144">Therefore, as various data is read, a node type is assigned to each node.</span></span> <span data-ttu-id="97111-145">Ce type de nœud détermine les caractéristiques et la fonctionnalité du nœud.</span><span class="sxs-lookup"><span data-stu-id="97111-145">This node type determines the characteristics and functionality of the node.</span></span>

<span data-ttu-id="97111-146">Pour plus d'informations sur les types de nœuds générés en mémoire, consultez [Types de nœuds XML](../../../../docs/standard/data/xml/types-of-xml-nodes.md).</span><span class="sxs-lookup"><span data-stu-id="97111-146">For more information on the types of nodes generated in memory, see [Types of XML Nodes](../../../../docs/standard/data/xml/types-of-xml-nodes.md).</span></span> <span data-ttu-id="97111-147">Pour plus d’informations sur les objets créés dans l’arborescence de nœuds, consultez [Mappage de la hiérarchie d’objets à des données XML](../../../../docs/standard/data/xml/mapping-the-object-hierarchy-to-xml-data.md).</span><span class="sxs-lookup"><span data-stu-id="97111-147">For more information on the objects created in the node tree, see [Mapping the Object Hierarchy to XML Data](../../../../docs/standard/data/xml/mapping-the-object-hierarchy-to-xml-data.md).</span></span>

<span data-ttu-id="97111-148">Microsoft a étendu les API disponibles dans les recommandations du World Wide Web Consortium (W3C) DOM Level 1 et Level 2 afin de faciliter la manipulation d'un document XML.</span><span class="sxs-lookup"><span data-stu-id="97111-148">Microsoft has extended the APIs that are available in the World Wide Web Consortium (W3C) DOM Level 1 and Level 2 to make it easier to work with an XML document.</span></span> <span data-ttu-id="97111-149">En plus d'assurer une prise en charge complète des normes W3C, les classes, méthodes et propriétés supplémentaires ajoutent une fonctionnalité qui dépasse ce que le DOM XML du W3C permet de faire.</span><span class="sxs-lookup"><span data-stu-id="97111-149">While fully supporting the W3C standards, the additional classes, methods, and properties add functionality beyond what can be done using the W3C XML DOM.</span></span> <span data-ttu-id="97111-150">De nouvelles classes vous permettent d'accéder aux données relationnelles, tout en proposant des méthodes qui permettent de les synchroniser avec des données ADO.NET et d'exposer simultanément des données comme des données XML.</span><span class="sxs-lookup"><span data-stu-id="97111-150">New classes enable you to access relational data, giving you methods for synchronizing with ADO.NET data, simultaneously exposing data as XML.</span></span> <span data-ttu-id="97111-151">Pour plus d’informations, consultez [Synchronisation d’un DataSet avec un XmlDataDocument](../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataset-and-xmldatadocument-synchronization.md).</span><span class="sxs-lookup"><span data-stu-id="97111-151">For more information, see [Synchronizing a DataSet with an XmlDataDocument](../../../../docs/framework/data/adonet/dataset-datatable-dataview/dataset-and-xmldatadocument-synchronization.md).</span></span>

<span data-ttu-id="97111-152">Le DOM revêt un intérêt tout particulier pour la lecture de données XML et leur chargement en mémoire afin d'en modifier la structure, d'y ajouter ou d'en supprimer des nœuds, ou encore de modifier les données contenues dans un nœud tout comme dans le texte contenu dans un élément.</span><span class="sxs-lookup"><span data-stu-id="97111-152">The DOM is most useful for reading XML data into memory to change its structure, to add or remove nodes, or to modify the data held by a node as in the text contained by an element.</span></span> <span data-ttu-id="97111-153">Cependant, d'autres classes sont disponibles et offrent de meilleures performances que le DOM dans d'autres scénarios.</span><span class="sxs-lookup"><span data-stu-id="97111-153">However, other classes are available that are faster than the DOM in other scenarios.</span></span> <span data-ttu-id="97111-154">Pour un accès rapide en flux continu non mis en cache et en avant uniquement au code XML, utilisez **XmlReader** et **XmlWriter**.</span><span class="sxs-lookup"><span data-stu-id="97111-154">For fast, non-cached, forward-only stream access to XML, use the **XmlReader** and **XmlWriter**.</span></span> <span data-ttu-id="97111-155">Si vous avez besoin d’un accès aléatoire avec un modèle de curseur et **XPath**, utilisez la classe **XPathNavigator**.</span><span class="sxs-lookup"><span data-stu-id="97111-155">If you need random access with a cursor model and **XPath**, use the **XPathNavigator** class.</span></span>

## <a name="see-also"></a><span data-ttu-id="97111-156">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="97111-156">See also</span></span>

- [<span data-ttu-id="97111-157">Types de nœuds XML</span><span class="sxs-lookup"><span data-stu-id="97111-157">Types of XML Nodes</span></span>](../../../../docs/standard/data/xml/types-of-xml-nodes.md)
- [<span data-ttu-id="97111-158">Mappage de la hiérarchie d’objets à des données XML</span><span class="sxs-lookup"><span data-stu-id="97111-158">Mapping the Object Hierarchy to XML Data</span></span>](../../../../docs/standard/data/xml/mapping-the-object-hierarchy-to-xml-data.md)

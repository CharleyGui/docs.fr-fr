---
title: Collections forcées
ms.date: 03/30/2017
helpviewer_keywords:
- garbage collection, forced
ms.assetid: 019008fe-4708-4e65-bebf-04fd9941e149
ms.openlocfilehash: 25e94221355569931a31b566a53434cbed9ea93f
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/24/2020
ms.locfileid: "95714235"
---
# <a name="induced-collections"></a><span data-ttu-id="4b117-102">Collections forcées</span><span class="sxs-lookup"><span data-stu-id="4b117-102">Induced Collections</span></span>

<span data-ttu-id="4b117-103">Dans la plupart des cas, le Garbage collector peut déterminer le meilleur moment pour exécuter une collection. En outre, vous devez lui permettre de s’exécuter de façon indépendante.</span><span class="sxs-lookup"><span data-stu-id="4b117-103">In most cases, the garbage collector can determine the best time to perform a collection, and you should let it run independently.</span></span> <span data-ttu-id="4b117-104">Dans de rares cas, une collection forcée peut toutefois améliorer les performances de votre application.</span><span class="sxs-lookup"><span data-stu-id="4b117-104">There are rare situations when a forced collection might improve your application's performance.</span></span> <span data-ttu-id="4b117-105">Vous pouvez alors induire le garbage collection à l’aide de la méthode <xref:System.GC.Collect%2A?displayProperty=nameWithType> pour forcer un garbage collection.</span><span class="sxs-lookup"><span data-stu-id="4b117-105">In these cases, you can induce garbage collection by using the <xref:System.GC.Collect%2A?displayProperty=nameWithType> method to force a garbage collection.</span></span>  
  
 <span data-ttu-id="4b117-106">Utilisez la méthode <xref:System.GC.Collect%2A?displayProperty=nameWithType> quand la quantité de mémoire utilisée à un point spécifique dans le code de votre application diminue considérablement.</span><span class="sxs-lookup"><span data-stu-id="4b117-106">Use the <xref:System.GC.Collect%2A?displayProperty=nameWithType> method when there is a significant reduction in the amount of memory being used at a specific point in your application's code.</span></span> <span data-ttu-id="4b117-107">Par exemple, si votre application utilise une boîte de dialogue complexe comportant plusieurs contrôles, l’appel de <xref:System.GC.Collect%2A> quand la boîte de dialogue est fermée peut améliorer les performances en libérant immédiatement la mémoire utilisée par la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="4b117-107">For example, if your application uses a complex dialog box that has several controls, calling <xref:System.GC.Collect%2A> when the dialog box is closed could improve performance by immediately reclaiming the memory used by the dialog box.</span></span> <span data-ttu-id="4b117-108">Vérifiez que votre application n’induit pas trop fréquemment le garbage collection. En effet, les performances risquent d’être affectées si le Garbage collector tente de récupérer des objets à des moments inopportuns.</span><span class="sxs-lookup"><span data-stu-id="4b117-108">Be sure that your application is not inducing garbage collection too frequently, because that can decrease performance if the garbage collector is trying to reclaim objects at non-optimal times.</span></span> <span data-ttu-id="4b117-109">Vous pouvez fournir une valeur d’énumération <xref:System.GCCollectionMode.Optimized?displayProperty=nameWithType> à la méthode <xref:System.GC.Collect%2A> pour effectuer une collection uniquement lorsqu’elle est productive, comme décrit dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="4b117-109">You can supply a <xref:System.GCCollectionMode.Optimized?displayProperty=nameWithType> enumeration value to the <xref:System.GC.Collect%2A> method to collect only when collection would be productive, as discussed in the next section.</span></span>  
  
## <a name="gc-collection-mode"></a><span data-ttu-id="4b117-110">Mode de collection GC</span><span class="sxs-lookup"><span data-stu-id="4b117-110">GC collection mode</span></span>  

 <span data-ttu-id="4b117-111">Vous pouvez utiliser l’une des surcharges de méthode <xref:System.GC.Collect%2A?displayProperty=nameWithType> qui inclut une valeur <xref:System.GCCollectionMode> pour spécifier le comportement d’une collection forcée, comme suit.</span><span class="sxs-lookup"><span data-stu-id="4b117-111">You can use one of the <xref:System.GC.Collect%2A?displayProperty=nameWithType> method overloads that includes a <xref:System.GCCollectionMode> value to specify the behavior for a forced collection as follows.</span></span>  
  
|<span data-ttu-id="4b117-112">Valeur `GCCollectionMode`</span><span class="sxs-lookup"><span data-stu-id="4b117-112">`GCCollectionMode` value</span></span>|<span data-ttu-id="4b117-113">Description</span><span class="sxs-lookup"><span data-stu-id="4b117-113">Description</span></span>|  
|------------------------------|-----------------|  
|<xref:System.GCCollectionMode.Default>|<span data-ttu-id="4b117-114">Utilise le paramètre de garbage collection par défaut pour la version en cours d’exécution de .NET.</span><span class="sxs-lookup"><span data-stu-id="4b117-114">Uses the default garbage collection setting for the running version of .NET.</span></span>|  
|<xref:System.GCCollectionMode.Forced>|<span data-ttu-id="4b117-115">Force l’exécution immédiate du garbage collection.</span><span class="sxs-lookup"><span data-stu-id="4b117-115">Forces garbage collection to occur immediately.</span></span> <span data-ttu-id="4b117-116">Cela équivaut à appeler la surcharge <xref:System.GC.Collect?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="4b117-116">This is equivalent to calling the <xref:System.GC.Collect?displayProperty=nameWithType> overload.</span></span> <span data-ttu-id="4b117-117">Il en résulte une collection de blocage complète de toutes les générations.</span><span class="sxs-lookup"><span data-stu-id="4b117-117">It results in a full blocking collection of all generations.</span></span><br /><br /> <span data-ttu-id="4b117-118">Vous pouvez également compacter le tas d’objets volumineux en définissant la propriété <xref:System.Runtime.GCSettings.LargeObjectHeapCompactionMode%2A?displayProperty=nameWithType> sur <xref:System.Runtime.GCLargeObjectHeapCompactionMode.CompactOnce?displayProperty=nameWithType> avant de forcer un garbage collection de blocage complet immédiat.</span><span class="sxs-lookup"><span data-stu-id="4b117-118">You can also compact the large object heap by setting the <xref:System.Runtime.GCSettings.LargeObjectHeapCompactionMode%2A?displayProperty=nameWithType> property to <xref:System.Runtime.GCLargeObjectHeapCompactionMode.CompactOnce?displayProperty=nameWithType> before forcing an immediate full blocking garbage collection.</span></span>|  
|<xref:System.GCCollectionMode.Optimized>|<span data-ttu-id="4b117-119">Permet au Garbage collector de déterminer si le moment est opportun pour récupérer des objets.</span><span class="sxs-lookup"><span data-stu-id="4b117-119">Enables the garbage collector to determine whether the current time is optimal to reclaim objects.</span></span><br /><br /> <span data-ttu-id="4b117-120">Le Garbage collector peut déterminer qu’une collection n’est pas assez productive pour être effectuée. Dans ce cas, aucun objet n’est récupéré.</span><span class="sxs-lookup"><span data-stu-id="4b117-120">The garbage collector could determine that a collection would not be productive enough to be justified, in which case it will return without reclaiming objects.</span></span>|  
  
## <a name="background-or-blocking-collections"></a><span data-ttu-id="4b117-121">Collections d’arrière-plan ou de blocage</span><span class="sxs-lookup"><span data-stu-id="4b117-121">Background or blocking collections</span></span>  

 <span data-ttu-id="4b117-122">Vous pouvez appeler la surcharge de méthode <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%2CSystem.Boolean%29?displayProperty=nameWithType> pour spécifier si une collection induite bloque ou non.</span><span class="sxs-lookup"><span data-stu-id="4b117-122">You can call the <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%2CSystem.Boolean%29?displayProperty=nameWithType> method overload to specify whether an induced collection is blocking or not.</span></span> <span data-ttu-id="4b117-123">Le type de collection effectué dépend d’une combinaison des paramètres `mode` et `blocking` de la méthode.</span><span class="sxs-lookup"><span data-stu-id="4b117-123">The type of collection performed depends on a combination of the method's `mode` and `blocking` parameters.</span></span> <span data-ttu-id="4b117-124">`mode` est membre de l’énumération <xref:System.GCCollectionMode> et `blocking` est une valeur <xref:System.Boolean>.</span><span class="sxs-lookup"><span data-stu-id="4b117-124">`mode` is a member of the <xref:System.GCCollectionMode> enumeration, and `blocking` is a <xref:System.Boolean> value.</span></span> <span data-ttu-id="4b117-125">Le tableau suivant résume l’interaction des arguments `mode` et `blocking`.</span><span class="sxs-lookup"><span data-stu-id="4b117-125">The following table summarizes the interaction of the `mode` and `blocking` arguments.</span></span>  
  
|`mode`|`blocking` = `true`|`blocking` = `false`|  
|------------|--------------------------|---------------------------|  
|<span data-ttu-id="4b117-126"><xref:System.GCCollectionMode.Forced> ou <xref:System.GCCollectionMode.Default></span><span class="sxs-lookup"><span data-stu-id="4b117-126"><xref:System.GCCollectionMode.Forced> or <xref:System.GCCollectionMode.Default></span></span>|<span data-ttu-id="4b117-127">Une collection de blocage est exécutée dès que possible.</span><span class="sxs-lookup"><span data-stu-id="4b117-127">A blocking collection is performed as soon as possible.</span></span> <span data-ttu-id="4b117-128">Si une collection d’arrière-plan est en cours et que la génération a la valeur 0 ou 1, la méthode <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%2CSystem.Boolean%29> déclenche immédiatement une collection de blocage et retourne une valeur quand la collection est terminée.</span><span class="sxs-lookup"><span data-stu-id="4b117-128">If a background collection is in progress and generation is 0 or 1, the <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%2CSystem.Boolean%29> method immediately triggers a blocking collection and returns when the collection is finished.</span></span> <span data-ttu-id="4b117-129">Si une collection d’arrière-plan est en cours et que le paramètre `generation` a la valeur 2, la méthode attend la fin de la collection d’arrière-plan, déclenche une collection de blocage de génération 2, puis retourne une valeur.</span><span class="sxs-lookup"><span data-stu-id="4b117-129">If a background collection is in progress and the `generation` parameter is 2, the method waits until the background collection is finished, triggers a blocking generation 2 collection, and then returns.</span></span>|<span data-ttu-id="4b117-130">Une collection est exécutée dès que possible.</span><span class="sxs-lookup"><span data-stu-id="4b117-130">A collection is performed as soon as possible.</span></span> <span data-ttu-id="4b117-131">La méthode <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%2CSystem.Boolean%29> demande une collection d'arrière-plan, mais cela n'est pas garanti ; selon les cas, une collection bloquante peut toujours être exécutée.</span><span class="sxs-lookup"><span data-stu-id="4b117-131">The <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%2CSystem.Boolean%29> method requests a background collection, but this is not guaranteed; depending on the circumstances, a blocking collection may still be performed.</span></span> <span data-ttu-id="4b117-132">Si une collection d’arrière-plan est déjà en cours, la méthode retourne immédiatement une valeur.</span><span class="sxs-lookup"><span data-stu-id="4b117-132">If a background collection is already in progress, the method returns immediately.</span></span>|  
|<xref:System.GCCollectionMode.Optimized>|<span data-ttu-id="4b117-133">Une collecte bloquante peut être exécutée, selon l'état du récupérateur de mémoire et du paramètre `generation`.</span><span class="sxs-lookup"><span data-stu-id="4b117-133">A blocking collection may be performed, depending on the state of the garbage collector and the `generation` parameter.</span></span> <span data-ttu-id="4b117-134">Le Garbage collector tente de fournir des performances optimales.</span><span class="sxs-lookup"><span data-stu-id="4b117-134">The garbage collector tries to provide optimal performance.</span></span>|<span data-ttu-id="4b117-135">Une collection de blocage peut être effectuée, en fonction de l’état du Garbage collector.</span><span class="sxs-lookup"><span data-stu-id="4b117-135">A collection may be performed, depending on the state of the garbage collector.</span></span> <span data-ttu-id="4b117-136">La méthode <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%2CSystem.Boolean%29> demande une collection d'arrière-plan, mais cela n'est pas garanti ; selon les cas, une collection bloquante peut toujours être exécutée.</span><span class="sxs-lookup"><span data-stu-id="4b117-136">The <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%2CSystem.Boolean%29> method requests a background collection, but this is not guaranteed; depending on the circumstances, a blocking collection may still be performed.</span></span> <span data-ttu-id="4b117-137">Le Garbage collector tente de fournir des performances optimales.</span><span class="sxs-lookup"><span data-stu-id="4b117-137">The garbage collector tries to provide optimal performance.</span></span> <span data-ttu-id="4b117-138">Si une collection d’arrière-plan est déjà en cours, la méthode retourne immédiatement une valeur.</span><span class="sxs-lookup"><span data-stu-id="4b117-138">If a background collection is already in progress, the method returns immediately.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="4b117-139">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="4b117-139">See also</span></span>

- [<span data-ttu-id="4b117-140">Modes de latence</span><span class="sxs-lookup"><span data-stu-id="4b117-140">Latency Modes</span></span>](latency.md)
- [<span data-ttu-id="4b117-141">Garbage collection</span><span class="sxs-lookup"><span data-stu-id="4b117-141">Garbage Collection</span></span>](index.md)

---
title: Modes de latence
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- garbage collection, intrusiveness
- garbage collection, latency modes
ms.assetid: 96278bb7-6eab-4612-8594-ceebfc887d81
ms.openlocfilehash: a8eaf0c80aa32978eead80c51a905cbcd66a537b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/15/2020
ms.locfileid: "74283592"
---
# <a name="latency-modes"></a><span data-ttu-id="3e32f-102">Modes de latence</span><span class="sxs-lookup"><span data-stu-id="3e32f-102">Latency modes</span></span>

<span data-ttu-id="3e32f-103">Pour récupérer des objets, le collecteur d’ordures (GC) doit arrêter tous les fils d’exécution dans une application.</span><span class="sxs-lookup"><span data-stu-id="3e32f-103">To reclaim objects, the garbage collector (GC) must stop all the executing threads in an application.</span></span> <span data-ttu-id="3e32f-104">La période pendant laquelle le éboueur est actif est appelée sa *latence.*</span><span class="sxs-lookup"><span data-stu-id="3e32f-104">The period of time during which the garbage collector is active is referred to as its *latency*.</span></span>

<span data-ttu-id="3e32f-105">Dans certaines situations, par exemple, quand une application récupère des données ou affiche du contenu, un garbage collection complet peut se produire à un moment critique et nuire aux performances.</span><span class="sxs-lookup"><span data-stu-id="3e32f-105">In some situations, such as when an application retrieves data or displays content, a full garbage collection can occur at a critical time and impede performance.</span></span> <span data-ttu-id="3e32f-106">Vous pouvez ajuster le niveau d'intrusion du garbage collector en définissant la propriété <xref:System.Runtime.GCSettings.LatencyMode%2A?displayProperty=nameWithType> sur l'une des valeurs<xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3e32f-106">You can adjust the intrusiveness of the garbage collector by setting the <xref:System.Runtime.GCSettings.LatencyMode%2A?displayProperty=nameWithType> property to one of the <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> values.</span></span>

## <a name="low-latency-settings"></a><span data-ttu-id="3e32f-107">Paramètres de latence faible</span><span class="sxs-lookup"><span data-stu-id="3e32f-107">Low latency settings</span></span>

<span data-ttu-id="3e32f-108">L’utilisation d’un réglage de latence « faible » signifie que le collecteur d’ordures empiète moins dans votre application.</span><span class="sxs-lookup"><span data-stu-id="3e32f-108">Using a "low" latency setting means the garbage collector intrudes less in your application.</span></span> <span data-ttu-id="3e32f-109">La collecte des ordures est plus conservatrice au sujet de la récupération de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="3e32f-109">Garbage collection is more conservative about reclaiming memory.</span></span>

<span data-ttu-id="3e32f-110">L'énumération <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> fournit deux paramètres de latence faible :</span><span class="sxs-lookup"><span data-stu-id="3e32f-110">The <xref:System.Runtime.GCLatencyMode?displayProperty=nameWithType> enumeration provides two low latency settings:</span></span>

- <span data-ttu-id="3e32f-111">[GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) supprime les collections de génération 2 et n’exécute que des collections de génération 0 et 1.</span><span class="sxs-lookup"><span data-stu-id="3e32f-111">[GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) suppresses generation 2 collections and performs only generation 0 and 1 collections.</span></span> <span data-ttu-id="3e32f-112">Elle ne peut être utilisée que pour de courtes durées.</span><span class="sxs-lookup"><span data-stu-id="3e32f-112">It can be used only for short periods of time.</span></span> <span data-ttu-id="3e32f-113">Sur des périodes plus longues, si le système connaît une sollicitation de mémoire importante, le garbage collector déclenchera une collection, qui pourra brièvement suspendre l'application et interrompre une opération critique.</span><span class="sxs-lookup"><span data-stu-id="3e32f-113">Over longer periods, if the system is under memory pressure, the garbage collector will trigger a collection, which can briefly pause the application and disrupt a time-critical operation.</span></span> <span data-ttu-id="3e32f-114">Ce paramètre est disponible uniquement pour le garbage collection des stations de travail.</span><span class="sxs-lookup"><span data-stu-id="3e32f-114">This setting is available only for workstation garbage collection.</span></span>

- <span data-ttu-id="3e32f-115">[GCLatencyMode.SustainedLowLatency](xref:System.Runtime.GCLatencyMode.SustainedLowLatency) supprime les collections de première génération 2 et n’exécute que des collections de génération 0, 1 et de la génération 2.</span><span class="sxs-lookup"><span data-stu-id="3e32f-115">[GCLatencyMode.SustainedLowLatency](xref:System.Runtime.GCLatencyMode.SustainedLowLatency) suppresses foreground generation 2 collections and performs only generation 0, 1, and background generation 2 collections.</span></span> <span data-ttu-id="3e32f-116">Il peut être utilisé pour de longues périodes et est disponible à la fois pour le garbage collection des stations de travail et des serveurs.</span><span class="sxs-lookup"><span data-stu-id="3e32f-116">It can be used for longer periods of time, and is available for both workstation and server garbage collection.</span></span> <span data-ttu-id="3e32f-117">Ce paramètre ne peut pas être utilisé si la collecte des ordures de fond est désactivée.</span><span class="sxs-lookup"><span data-stu-id="3e32f-117">This setting cannot be used if background garbage collection is disabled.</span></span>

<span data-ttu-id="3e32f-118">Pendant les périodes de faible latence, les collections de génération 2 sont empêchées, sauf dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="3e32f-118">During low latency periods, generation 2 collections are suppressed unless the following occurs:</span></span>

- <span data-ttu-id="3e32f-119">Le système reçoit une notification de mémoire insuffisante du système d'exploitation.</span><span class="sxs-lookup"><span data-stu-id="3e32f-119">The system receives a low memory notification from the operating system.</span></span>

- <span data-ttu-id="3e32f-120">Le code d’application induit <xref:System.GC.Collect%2A?displayProperty=nameWithType> une collection en appelant `generation` la méthode et en spécifiant 2 pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="3e32f-120">Application code induces a collection by calling the <xref:System.GC.Collect%2A?displayProperty=nameWithType> method and specifying 2 for the `generation` parameter.</span></span>

## <a name="scenarios"></a><span data-ttu-id="3e32f-121">Scénarios</span><span class="sxs-lookup"><span data-stu-id="3e32f-121">Scenarios</span></span>

<span data-ttu-id="3e32f-122">Le tableau suivant répertorie <xref:System.Runtime.GCLatencyMode> les scénarios d’application pour l’utilisation des valeurs :</span><span class="sxs-lookup"><span data-stu-id="3e32f-122">The following table lists the application scenarios for using the <xref:System.Runtime.GCLatencyMode> values:</span></span>

|<span data-ttu-id="3e32f-123">Mode de latence</span><span class="sxs-lookup"><span data-stu-id="3e32f-123">Latency mode</span></span>|<span data-ttu-id="3e32f-124">Scénarios d’application</span><span class="sxs-lookup"><span data-stu-id="3e32f-124">Application scenarios</span></span>|
|------------------|---------------------------|
|<xref:System.Runtime.GCLatencyMode.Batch>|<span data-ttu-id="3e32f-125">Pour les applications qui n’ont pas d’interface utilisateur (interface utilisateur) ou d’opérations côté serveur.</span><span class="sxs-lookup"><span data-stu-id="3e32f-125">For applications that have no user interface (UI) or server-side operations.</span></span><br /><br /><span data-ttu-id="3e32f-126">Lorsque la collecte des ordures de fond est désactivée, c’est le mode par défaut pour la collecte des ordures de poste de travail et de serveur.</span><span class="sxs-lookup"><span data-stu-id="3e32f-126">When background garbage collection is disabled, this is the default mode for workstation and server garbage collection.</span></span> <span data-ttu-id="3e32f-127"><xref:System.Runtime.GCLatencyMode.Batch>le mode remplace également le paramètre [gcConcurrent,](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) c’est-à-dire qu’il empêche les collections de fond ou simultanées.</span><span class="sxs-lookup"><span data-stu-id="3e32f-127"><xref:System.Runtime.GCLatencyMode.Batch> mode also overrides the [gcConcurrent](../../framework/configure-apps/file-schema/runtime/gcconcurrent-element.md) setting, that is, it prevents background or concurrent collections.</span></span>|
|<xref:System.Runtime.GCLatencyMode.Interactive>|<span data-ttu-id="3e32f-128">Pour la plupart des applications qui ont une interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3e32f-128">For most applications that have a UI.</span></span><br /><br /><span data-ttu-id="3e32f-129">Il s’agit du mode par défaut pour le poste de travail et la collecte des ordures serveur.</span><span class="sxs-lookup"><span data-stu-id="3e32f-129">This is the default mode for workstation and server garbage collection.</span></span> <span data-ttu-id="3e32f-130">Toutefois, si une application est hébergée, les paramètres de collecteur d’ordures du processus d’hébergement priment.</span><span class="sxs-lookup"><span data-stu-id="3e32f-130">However, if an app is hosted, the garbage collector settings of the hosting process take precedence.</span></span>|
|<xref:System.Runtime.GCLatencyMode.LowLatency>|<span data-ttu-id="3e32f-131">Pour les applications qui ont des opérations de courte durée pour lesquelles le temps est important, et durant lesquelles les interruptions du garbage collector pourraient provoquer des perturbations.</span><span class="sxs-lookup"><span data-stu-id="3e32f-131">For applications that have short-term, time-sensitive operations during which interruptions from the garbage collector could be disruptive.</span></span> <span data-ttu-id="3e32f-132">Par exemple, les applications qui rendent des animations ou des fonctions d’acquisition de données.</span><span class="sxs-lookup"><span data-stu-id="3e32f-132">For example, applications that render animations or data acquisition functions.</span></span>|
|<xref:System.Runtime.GCLatencyMode.SustainedLowLatency>|<span data-ttu-id="3e32f-133">Pour les applications qui ont des opérations pour lesquelles le temps est important, pendant une durée définie mais potentiellement longue durant laquelle les interruptions du garbage collector pourraient provoquer des perturbations.</span><span class="sxs-lookup"><span data-stu-id="3e32f-133">For applications that have time-sensitive operations for a contained but potentially longer duration of time during which interruptions from the garbage collector could be disruptive.</span></span> <span data-ttu-id="3e32f-134">Par exemple, les applications nécessitant des temps de réponse rapides en raison du changement des données de marché pendant les heures de négociation.</span><span class="sxs-lookup"><span data-stu-id="3e32f-134">For example, applications that need quick response times as market data changes during trading hours.</span></span><br /><br /><span data-ttu-id="3e32f-135">Ce mode augmente davantage la taille du tas managé que les autres modes.</span><span class="sxs-lookup"><span data-stu-id="3e32f-135">This mode results in a larger managed heap size than other modes.</span></span> <span data-ttu-id="3e32f-136">Parce qu'il ne compacte pas le tas managé, une fragmentation plus importante est possible.</span><span class="sxs-lookup"><span data-stu-id="3e32f-136">Because it does not compact the managed heap, higher fragmentation is possible.</span></span> <span data-ttu-id="3e32f-137">Assurez-vous que suffisamment de mémoire est disponible.</span><span class="sxs-lookup"><span data-stu-id="3e32f-137">Ensure that sufficient memory is available.</span></span>|

## <a name="guidelines-for-using-low-latency"></a><span data-ttu-id="3e32f-138">Lignes directrices pour l’utilisation d’une faible latence</span><span class="sxs-lookup"><span data-stu-id="3e32f-138">Guidelines for using low latency</span></span>

<span data-ttu-id="3e32f-139">Lorsque vous utilisez le mode [GCLatencyMode.LowLatency,](xref:System.Runtime.GCLatencyMode.LowLatency) tenez compte des lignes directrices suivantes :</span><span class="sxs-lookup"><span data-stu-id="3e32f-139">When you use [GCLatencyMode.LowLatency](xref:System.Runtime.GCLatencyMode.LowLatency) mode, consider the following guidelines:</span></span>

- <span data-ttu-id="3e32f-140">Choisissez une période aussi courte que possible pour la faible latence.</span><span class="sxs-lookup"><span data-stu-id="3e32f-140">Keep the period of time in low latency as short as possible.</span></span>

- <span data-ttu-id="3e32f-141">Évitez d'allouer de grandes quantités de mémoire pendant les périodes de faible latence.</span><span class="sxs-lookup"><span data-stu-id="3e32f-141">Avoid allocating high amounts of memory during low latency periods.</span></span> <span data-ttu-id="3e32f-142">Vous pouvez recevoir des notifications de mémoire insuffisante, car le garbage collection récupère moins d'objets.</span><span class="sxs-lookup"><span data-stu-id="3e32f-142">Low memory notifications can occur because garbage collection reclaims fewer objects.</span></span>

- <span data-ttu-id="3e32f-143">En mode de latence, minimisez le nombre de nouvelles allocations, en particulier les allocations sur le tas de gros objets et les objets épinglés.</span><span class="sxs-lookup"><span data-stu-id="3e32f-143">While in the low latency mode, minimize the number of new allocations, in particular allocations onto the large object heap and pinned objects.</span></span>

- <span data-ttu-id="3e32f-144">N'oubliez pas les threads qui peuvent être à l'origine d'allocations.</span><span class="sxs-lookup"><span data-stu-id="3e32f-144">Be aware of threads that could be allocating.</span></span> <span data-ttu-id="3e32f-145">Étant <xref:System.Runtime.GCSettings.LatencyMode%2A> donné que le paramètre de propriété est à l’échelle du processus, <xref:System.OutOfMemoryException> des exceptions peuvent être générées sur n’importe quel thread qui est alloué.</span><span class="sxs-lookup"><span data-stu-id="3e32f-145">Because the <xref:System.Runtime.GCSettings.LatencyMode%2A> property setting is process-wide, <xref:System.OutOfMemoryException> exceptions can be generated on any thread that is allocating.</span></span>

- <span data-ttu-id="3e32f-146">Enveloppez le code de latence faible dans les régions d’exécution limitées.</span><span class="sxs-lookup"><span data-stu-id="3e32f-146">Wrap the low latency code in constrained execution regions.</span></span> <span data-ttu-id="3e32f-147">Pour plus d’informations, voir [Régions d’exécution contrainte](../../../docs/framework/performance/constrained-execution-regions.md).</span><span class="sxs-lookup"><span data-stu-id="3e32f-147">For more information, see [Constrained execution regions](../../../docs/framework/performance/constrained-execution-regions.md).</span></span>

- <span data-ttu-id="3e32f-148">Vous pouvez forcer les collections de génération 2 pendant une période de latence basse en appelant la méthode <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%29?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="3e32f-148">You can force generation 2 collections during a low latency period by calling the <xref:System.GC.Collect%28System.Int32%2CSystem.GCCollectionMode%29?displayProperty=nameWithType> method.</span></span>

## <a name="see-also"></a><span data-ttu-id="3e32f-149">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3e32f-149">See also</span></span>

- <xref:System.GC?displayProperty=nameWithType>
- [<span data-ttu-id="3e32f-150">Collections forcées</span><span class="sxs-lookup"><span data-stu-id="3e32f-150">Induced Collections</span></span>](../../../docs/standard/garbage-collection/induced.md)
- [<span data-ttu-id="3e32f-151">Garbage collection</span><span class="sxs-lookup"><span data-stu-id="3e32f-151">Garbage Collection</span></span>](../../../docs/standard/garbage-collection/index.md)

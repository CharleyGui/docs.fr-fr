---
title: Workstation vs collecte des ordures serveur (GC)
description: En savoir plus sur la collecte des stations de travail et des ordures serveur dans .NET.
ms.date: 04/21/2020
helpviewer_keywords:
- garbage collection, workstation
- garbage collection, server
- workstation garbage collection
- server garbage collection
ms.openlocfilehash: 6b8e5f6802e5d44669b95d43d4e897fa4a418512
ms.sourcegitcommit: 73aa9653547a1cd70ee6586221f79cc29b588ebd
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/23/2020
ms.locfileid: "82103554"
---
# <a name="workstation-and-server-garbage-collection"></a><span data-ttu-id="93580-103">Garbage collection de station de travail et de serveur</span><span class="sxs-lookup"><span data-stu-id="93580-103">Workstation and server garbage collection</span></span>

<span data-ttu-id="93580-104">Le garbage collector s'ajuste automatiquement et peut travailler dans une large gamme de scénarios.</span><span class="sxs-lookup"><span data-stu-id="93580-104">The garbage collector is self-tuning and can work in a wide variety of scenarios.</span></span> <span data-ttu-id="93580-105">Cependant, vous pouvez [définir le type de collecte des ordures](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) en fonction des caractéristiques de la charge de travail.</span><span class="sxs-lookup"><span data-stu-id="93580-105">However, you can [set the type of garbage collection](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) based on the characteristics of the workload.</span></span> <span data-ttu-id="93580-106">Le CLR fournit les types de garbage collection suivants :</span><span class="sxs-lookup"><span data-stu-id="93580-106">The CLR provides the following types of garbage collection:</span></span>

- <span data-ttu-id="93580-107">Collecte des ordures de poste de travail (GC), qui est conçu pour les applications client.</span><span class="sxs-lookup"><span data-stu-id="93580-107">Workstation garbage collection (GC), which is designed for client apps.</span></span> <span data-ttu-id="93580-108">C’est la saveur GC par défaut pour les applications autonomes.</span><span class="sxs-lookup"><span data-stu-id="93580-108">It's the default GC flavor for standalone apps.</span></span> <span data-ttu-id="93580-109">Pour les applications hébergées, par exemple, celles hébergées par ASP.NET, l’hôte détermine la saveur GC par défaut.</span><span class="sxs-lookup"><span data-stu-id="93580-109">For hosted apps, for example, those hosted by ASP.NET, the host determines the default GC flavor.</span></span>

  <span data-ttu-id="93580-110">Le garbage collection de station de travail peut être simultané ou non simultané.</span><span class="sxs-lookup"><span data-stu-id="93580-110">Workstation garbage collection can be concurrent or non-concurrent.</span></span> <span data-ttu-id="93580-111">La collecte simultanée (ou *de fond)* des ordures permet aux threads gérés de poursuivre leurs opérations lors d’une collecte des ordures.</span><span class="sxs-lookup"><span data-stu-id="93580-111">Concurrent (or *background*) garbage collection enables managed threads to continue operations during a garbage collection.</span></span> <span data-ttu-id="93580-112">[La collecte des ordures de fond](background-gc.md) remplace la collecte [simultanée des ordures](background-gc.md#concurrent-garbage-collection) dans .NET Framework 4 et les versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="93580-112">[Background garbage collection](background-gc.md) replaces [concurrent garbage collection](background-gc.md#concurrent-garbage-collection) in .NET Framework 4 and later versions.</span></span>

- <span data-ttu-id="93580-113">Garbage collection de serveur, prévu pour les applications serveur qui ont besoin d'un débit et d'une extensibilité.</span><span class="sxs-lookup"><span data-stu-id="93580-113">Server garbage collection, which is intended for server applications that need high throughput and scalability.</span></span>

  - <span data-ttu-id="93580-114">Dans .NET Core, la collecte des ordures du serveur peut être non simultanée ou arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="93580-114">In .NET Core, server garbage collection can be non-concurrent or background.</span></span>

  - <span data-ttu-id="93580-115">Dans .NET Framework 4.5 et les versions ultérieures, la collecte des ordures du serveur peut être non simultanée ou arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="93580-115">In .NET Framework 4.5 and later versions, server garbage collection can be non-concurrent or background.</span></span> <span data-ttu-id="93580-116">Dans .NET Framework 4 et les versions précédentes, la collecte des ordures du serveur n’est pas simultanée.</span><span class="sxs-lookup"><span data-stu-id="93580-116">In .NET Framework 4 and previous versions, server garbage collection is non-concurrent.</span></span>

<span data-ttu-id="93580-117">L’illustration suivante montre les fils dédiés qui effectuent la collecte des ordures sur un serveur :</span><span class="sxs-lookup"><span data-stu-id="93580-117">The following illustration shows the dedicated threads that perform the garbage collection on a server:</span></span>

![Threads de garbage collection du serveur](./media/gc-server.png)

## <a name="performance-considerations"></a><span data-ttu-id="93580-119">Considérations relatives aux performances</span><span class="sxs-lookup"><span data-stu-id="93580-119">Performance considerations</span></span>

### <a name="workstation-gc"></a><span data-ttu-id="93580-120">Garbage collector pour station de travail</span><span class="sxs-lookup"><span data-stu-id="93580-120">Workstation GC</span></span>

<span data-ttu-id="93580-121">Voici les considérations liées aux threads et aux performances pour le garbage collection de station de travail :</span><span class="sxs-lookup"><span data-stu-id="93580-121">The following are threading and performance considerations for workstation garbage collection:</span></span>

- <span data-ttu-id="93580-122">La collecte se produit sur le thread utilisateur qui a déclenché le garbage collection et reste à la même priorité.</span><span class="sxs-lookup"><span data-stu-id="93580-122">The collection occurs on the user thread that triggered the garbage collection and remains at the same priority.</span></span> <span data-ttu-id="93580-123">Étant donné que les threads utilisateur sont généralement exécutés à la priorité normale, le garbage collector (qui s'exécute sur un thread de priorité normale) doit rivaliser avec d'autres threads pour le temps processeur.</span><span class="sxs-lookup"><span data-stu-id="93580-123">Because user threads typically run at normal priority, the garbage collector (which runs on a normal priority thread) must compete with other threads for CPU time.</span></span> <span data-ttu-id="93580-124">(Les fils qui exécutent le code natif ne sont pas suspendus sur le serveur ou la collecte des ordures de poste de travail.)</span><span class="sxs-lookup"><span data-stu-id="93580-124">(Threads that run native code are not suspended on either server or workstation garbage collection.)</span></span>

- <span data-ttu-id="93580-125">La collecte des ordures de poste de travail est toujours utilisée sur un ordinateur qui n’a qu’un seul processeur, quel que soit le réglage de [configuration.](../../core/run-time-config/garbage-collector.md#systemgcservercomplus_gcserver)</span><span class="sxs-lookup"><span data-stu-id="93580-125">Workstation garbage collection is always used on a computer that has only one processor, regardless of the [configuration setting](../../core/run-time-config/garbage-collector.md#systemgcservercomplus_gcserver).</span></span>

### <a name="server-gc"></a><span data-ttu-id="93580-126">Garbage collector pour serveur</span><span class="sxs-lookup"><span data-stu-id="93580-126">Server GC</span></span>

<span data-ttu-id="93580-127">Voici les considérations liées aux threads et aux performances pour le garbage collection de serveur :</span><span class="sxs-lookup"><span data-stu-id="93580-127">The following are threading and performance considerations for server garbage collection:</span></span>

- <span data-ttu-id="93580-128">La collecte se produit sur plusieurs threads dédiés qui s'exécutent au niveau de priorité `THREAD_PRIORITY_HIGHEST` .</span><span class="sxs-lookup"><span data-stu-id="93580-128">The collection occurs on multiple dedicated threads that are running at `THREAD_PRIORITY_HIGHEST` priority level.</span></span>

- <span data-ttu-id="93580-129">Un tas et un thread dédié pour effectuer le garbage collection sont fournis pour chaque UC, et les tas sont collectés au même moment.</span><span class="sxs-lookup"><span data-stu-id="93580-129">A heap and a dedicated thread to perform garbage collection are provided for each CPU, and the heaps are collected at the same time.</span></span> <span data-ttu-id="93580-130">Chaque tas contient un tas de petits objets et un tas d'objets volumineux, et tous les tas peuvent faire l'objet d'accès par du code utilisateur.</span><span class="sxs-lookup"><span data-stu-id="93580-130">Each heap contains a small object heap and a large object heap, and all heaps can be accessed by user code.</span></span> <span data-ttu-id="93580-131">Les objets des différents tas peuvent faire référence les uns aux autres.</span><span class="sxs-lookup"><span data-stu-id="93580-131">Objects on different heaps can refer to each other.</span></span>

- <span data-ttu-id="93580-132">Étant donné que plusieurs threads de garbage collection fonctionnent ensemble, le garbage collection de serveur est plus rapide que le garbage collection de station de travail sur un tas de même taille.</span><span class="sxs-lookup"><span data-stu-id="93580-132">Because multiple garbage collection threads work together, server garbage collection is faster than workstation garbage collection on the same size heap.</span></span>

- <span data-ttu-id="93580-133">Le garbage collection de serveur présente souvent des segments de plus grande taille.</span><span class="sxs-lookup"><span data-stu-id="93580-133">Server garbage collection often has larger size segments.</span></span> <span data-ttu-id="93580-134">Cependant, il ne s’agit que d’une généralisation : la taille du segment est spécifique à la mise en œuvre et peut être modifiée.</span><span class="sxs-lookup"><span data-stu-id="93580-134">However, this is only a generalization: segment size is implementation-specific and is subject to change.</span></span> <span data-ttu-id="93580-135">Ne faites pas d’hypothèses sur la taille des segments attribués par le collecteur d’ordures lors de l’accordage de votre application.</span><span class="sxs-lookup"><span data-stu-id="93580-135">Don't make assumptions about the size of segments allocated by the garbage collector when tuning your app.</span></span>

- <span data-ttu-id="93580-136">Le garbage collection de serveur peut consommer beaucoup de ressources.</span><span class="sxs-lookup"><span data-stu-id="93580-136">Server garbage collection can be resource-intensive.</span></span> <span data-ttu-id="93580-137">Par exemple, imaginez qu’il existe 12 processus qui utilisent le serveur GC fonctionnant sur un ordinateur qui a quatre processeurs.</span><span class="sxs-lookup"><span data-stu-id="93580-137">For example, imagine that there are 12 processes that use server GC running on a computer that has four processors.</span></span> <span data-ttu-id="93580-138">Si tous les processus se produisent pour ramasser les ordures en même temps, ils interfèrent les uns avec les autres, car il y aurait 12 threads prévus sur le même processeur.</span><span class="sxs-lookup"><span data-stu-id="93580-138">If all the processes happen to collect garbage at the same time, they would interfere with each other, as there would be 12 threads scheduled on the same processor.</span></span> <span data-ttu-id="93580-139">Si les processus sont actifs, ce n’est pas une bonne idée de les avoir tous utiliser serveur GC.</span><span class="sxs-lookup"><span data-stu-id="93580-139">If the processes are active, it's not a good idea to have them all use server GC.</span></span>

<span data-ttu-id="93580-140">Si vous exécutez des centaines d’instances d’une application, envisagez d’utiliser la collecte des ordures de poste de travail avec la collecte simultanée des ordures désactivées.</span><span class="sxs-lookup"><span data-stu-id="93580-140">If you're running hundreds of instances of an application, consider using workstation garbage collection with concurrent garbage collection disabled.</span></span> <span data-ttu-id="93580-141">Cela provoquera moins de changements de contexte, ce qui peut améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="93580-141">This will result in less context switching, which can improve performance.</span></span>

## <a name="see-also"></a><span data-ttu-id="93580-142">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="93580-142">See also</span></span>

- [<span data-ttu-id="93580-143">Collecte des ordures de fond</span><span class="sxs-lookup"><span data-stu-id="93580-143">Background garbage collection</span></span>](background-gc.md)
- [<span data-ttu-id="93580-144">Options de configuration en temps d’exécution pour la collecte des ordures</span><span class="sxs-lookup"><span data-stu-id="93580-144">Run-time configuration options for garbage collection</span></span>](../../core/run-time-config/garbage-collector.md)

---
title: Station de travail et garbage collection serveur (GC)
description: En savoir plus sur les garbage collection de station de travail et de serveur dans .NET.
ms.date: 04/21/2020
helpviewer_keywords:
- garbage collection, workstation
- garbage collection, server
- workstation garbage collection
- server garbage collection
ms.openlocfilehash: 640b5f42c1f841c2537284e4721e827248e3d300
ms.sourcegitcommit: ef50c99928183a0bba75e07b9f22895cd4c480f8
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/07/2020
ms.locfileid: "87917014"
---
# <a name="workstation-and-server-garbage-collection"></a><span data-ttu-id="c2e29-103">Garbage collection de station de travail et de serveur</span><span class="sxs-lookup"><span data-stu-id="c2e29-103">Workstation and server garbage collection</span></span>

<span data-ttu-id="c2e29-104">Le garbage collector s'ajuste automatiquement et peut travailler dans une large gamme de scénarios.</span><span class="sxs-lookup"><span data-stu-id="c2e29-104">The garbage collector is self-tuning and can work in a wide variety of scenarios.</span></span> <span data-ttu-id="c2e29-105">Toutefois, vous pouvez [définir le type de garbage collection](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) en fonction des caractéristiques de la charge de travail.</span><span class="sxs-lookup"><span data-stu-id="c2e29-105">However, you can [set the type of garbage collection](../../core/run-time-config/garbage-collector.md#flavors-of-garbage-collection) based on the characteristics of the workload.</span></span> <span data-ttu-id="c2e29-106">Le CLR fournit les types de garbage collection suivants :</span><span class="sxs-lookup"><span data-stu-id="c2e29-106">The CLR provides the following types of garbage collection:</span></span>

- <span data-ttu-id="c2e29-107">Station de travail garbage collection (GC), conçue pour les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="c2e29-107">Workstation garbage collection (GC), which is designed for client apps.</span></span> <span data-ttu-id="c2e29-108">Il s’agit de la version de catalogue global par défaut pour les applications autonomes.</span><span class="sxs-lookup"><span data-stu-id="c2e29-108">It's the default GC flavor for standalone apps.</span></span> <span data-ttu-id="c2e29-109">Pour les applications hébergées, par exemple, celles hébergées par ASP.NET, l’hôte détermine la version GC par défaut.</span><span class="sxs-lookup"><span data-stu-id="c2e29-109">For hosted apps, for example, those hosted by ASP.NET, the host determines the default GC flavor.</span></span>

  <span data-ttu-id="c2e29-110">Le garbage collection de station de travail peut être simultané ou non simultané.</span><span class="sxs-lookup"><span data-stu-id="c2e29-110">Workstation garbage collection can be concurrent or non-concurrent.</span></span> <span data-ttu-id="c2e29-111">La garbage collection simultanée (ou d' *arrière-plan*) permet aux threads managés de continuer à fonctionner pendant une garbage collection.</span><span class="sxs-lookup"><span data-stu-id="c2e29-111">Concurrent (or *background*) garbage collection enables managed threads to continue operations during a garbage collection.</span></span> <span data-ttu-id="c2e29-112">L' [garbage collection d’arrière-plan](background-gc.md) remplace les [garbage collection simultanées](background-gc.md#concurrent-garbage-collection) dans .NET Framework 4 et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="c2e29-112">[Background garbage collection](background-gc.md) replaces [concurrent garbage collection](background-gc.md#concurrent-garbage-collection) in .NET Framework 4 and later versions.</span></span>

- <span data-ttu-id="c2e29-113">Garbage collection de serveur, prévu pour les applications serveur qui ont besoin d'un débit et d'une extensibilité.</span><span class="sxs-lookup"><span data-stu-id="c2e29-113">Server garbage collection, which is intended for server applications that need high throughput and scalability.</span></span>

  - <span data-ttu-id="c2e29-114">Dans .NET Core, les garbage collection serveur peuvent être non simultanés ou en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="c2e29-114">In .NET Core, server garbage collection can be non-concurrent or background.</span></span>

  - <span data-ttu-id="c2e29-115">Dans .NET Framework 4,5 et versions ultérieures, le garbage collection de serveur peut être non simultané ou en arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="c2e29-115">In .NET Framework 4.5 and later versions, server garbage collection can be non-concurrent or background.</span></span> <span data-ttu-id="c2e29-116">Dans .NET Framework 4 et versions antérieures, le garbage collection de serveur n’est pas simultané.</span><span class="sxs-lookup"><span data-stu-id="c2e29-116">In .NET Framework 4 and previous versions, server garbage collection is non-concurrent.</span></span>

<span data-ttu-id="c2e29-117">L’illustration suivante montre les threads dédiés qui exécutent les garbage collection sur un serveur :</span><span class="sxs-lookup"><span data-stu-id="c2e29-117">The following illustration shows the dedicated threads that perform the garbage collection on a server:</span></span>

![Threads de garbage collection du serveur](media/gc-server.png)

## <a name="performance-considerations"></a><span data-ttu-id="c2e29-119">Considérations relatives aux performances</span><span class="sxs-lookup"><span data-stu-id="c2e29-119">Performance considerations</span></span>

### <a name="workstation-gc"></a><span data-ttu-id="c2e29-120">Garbage collector pour station de travail</span><span class="sxs-lookup"><span data-stu-id="c2e29-120">Workstation GC</span></span>

<span data-ttu-id="c2e29-121">Voici les considérations liées aux threads et aux performances pour le garbage collection de station de travail :</span><span class="sxs-lookup"><span data-stu-id="c2e29-121">The following are threading and performance considerations for workstation garbage collection:</span></span>

- <span data-ttu-id="c2e29-122">La collecte se produit sur le thread utilisateur qui a déclenché le garbage collection et reste à la même priorité.</span><span class="sxs-lookup"><span data-stu-id="c2e29-122">The collection occurs on the user thread that triggered the garbage collection and remains at the same priority.</span></span> <span data-ttu-id="c2e29-123">Étant donné que les threads utilisateur sont généralement exécutés à la priorité normale, le garbage collector (qui s'exécute sur un thread de priorité normale) doit rivaliser avec d'autres threads pour le temps processeur.</span><span class="sxs-lookup"><span data-stu-id="c2e29-123">Because user threads typically run at normal priority, the garbage collector (which runs on a normal priority thread) must compete with other threads for CPU time.</span></span> <span data-ttu-id="c2e29-124">(Les threads qui exécutent du code natif ne sont pas suspendus sur le serveur ou la station de travail garbage collection.)</span><span class="sxs-lookup"><span data-stu-id="c2e29-124">(Threads that run native code are not suspended on either server or workstation garbage collection.)</span></span>

- <span data-ttu-id="c2e29-125">Le garbage collection de station de travail est toujours utilisé sur un ordinateur doté d’un seul processeur, quel que soit le [paramètre de configuration](../../core/run-time-config/garbage-collector.md#workstation-vs-server).</span><span class="sxs-lookup"><span data-stu-id="c2e29-125">Workstation garbage collection is always used on a computer that has only one processor, regardless of the [configuration setting](../../core/run-time-config/garbage-collector.md#workstation-vs-server).</span></span>

### <a name="server-gc"></a><span data-ttu-id="c2e29-126">Garbage collector pour serveur</span><span class="sxs-lookup"><span data-stu-id="c2e29-126">Server GC</span></span>

<span data-ttu-id="c2e29-127">Voici les considérations liées aux threads et aux performances pour le garbage collection de serveur :</span><span class="sxs-lookup"><span data-stu-id="c2e29-127">The following are threading and performance considerations for server garbage collection:</span></span>

- <span data-ttu-id="c2e29-128">La collecte se produit sur plusieurs threads dédiés qui s'exécutent au niveau de priorité `THREAD_PRIORITY_HIGHEST` .</span><span class="sxs-lookup"><span data-stu-id="c2e29-128">The collection occurs on multiple dedicated threads that are running at `THREAD_PRIORITY_HIGHEST` priority level.</span></span>

- <span data-ttu-id="c2e29-129">Un tas et un thread dédié pour effectuer le garbage collection sont fournis pour chaque UC, et les tas sont collectés au même moment.</span><span class="sxs-lookup"><span data-stu-id="c2e29-129">A heap and a dedicated thread to perform garbage collection are provided for each CPU, and the heaps are collected at the same time.</span></span> <span data-ttu-id="c2e29-130">Chaque tas contient un tas de petits objets et un tas d'objets volumineux, et tous les tas peuvent faire l'objet d'accès par du code utilisateur.</span><span class="sxs-lookup"><span data-stu-id="c2e29-130">Each heap contains a small object heap and a large object heap, and all heaps can be accessed by user code.</span></span> <span data-ttu-id="c2e29-131">Les objets des différents tas peuvent faire référence les uns aux autres.</span><span class="sxs-lookup"><span data-stu-id="c2e29-131">Objects on different heaps can refer to each other.</span></span>

- <span data-ttu-id="c2e29-132">Étant donné que plusieurs threads de garbage collection fonctionnent ensemble, le garbage collection de serveur est plus rapide que le garbage collection de station de travail sur un tas de même taille.</span><span class="sxs-lookup"><span data-stu-id="c2e29-132">Because multiple garbage collection threads work together, server garbage collection is faster than workstation garbage collection on the same size heap.</span></span>

- <span data-ttu-id="c2e29-133">Le garbage collection de serveur présente souvent des segments de plus grande taille.</span><span class="sxs-lookup"><span data-stu-id="c2e29-133">Server garbage collection often has larger size segments.</span></span> <span data-ttu-id="c2e29-134">Toutefois, il ne s’agit que d’une généralisation : la taille de segment est spécifique à l’implémentation et peut faire l’objet de modifications.</span><span class="sxs-lookup"><span data-stu-id="c2e29-134">However, this is only a generalization: segment size is implementation-specific and is subject to change.</span></span> <span data-ttu-id="c2e29-135">N’effectuez pas d’hypothèses sur la taille des segments alloués par le garbage collector lors du paramétrage de votre application.</span><span class="sxs-lookup"><span data-stu-id="c2e29-135">Don't make assumptions about the size of segments allocated by the garbage collector when tuning your app.</span></span>

- <span data-ttu-id="c2e29-136">Le garbage collection de serveur peut consommer beaucoup de ressources.</span><span class="sxs-lookup"><span data-stu-id="c2e29-136">Server garbage collection can be resource-intensive.</span></span> <span data-ttu-id="c2e29-137">Par exemple, imaginez qu’il y a 12 processus qui utilisent le garbage collector de serveur exécuté sur un ordinateur doté de quatre processeurs.</span><span class="sxs-lookup"><span data-stu-id="c2e29-137">For example, imagine that there are 12 processes that use server GC running on a computer that has four processors.</span></span> <span data-ttu-id="c2e29-138">Si tous les processus se produisent pour collecter les opérations de garbage collection en même temps, ils interféreraient entre eux, car 12 threads sont planifiés sur le même processeur.</span><span class="sxs-lookup"><span data-stu-id="c2e29-138">If all the processes happen to collect garbage at the same time, they would interfere with each other, as there would be 12 threads scheduled on the same processor.</span></span> <span data-ttu-id="c2e29-139">Si les processus sont actifs, il n’est pas judicieux de leur demander d’utiliser le garbage collection de serveur.</span><span class="sxs-lookup"><span data-stu-id="c2e29-139">If the processes are active, it's not a good idea to have them all use server GC.</span></span>

<span data-ttu-id="c2e29-140">Si vous exécutez des centaines d’instances d’une application, envisagez d’utiliser des garbage collection de station de travail avec garbage collection simultanée désactivée.</span><span class="sxs-lookup"><span data-stu-id="c2e29-140">If you're running hundreds of instances of an application, consider using workstation garbage collection with concurrent garbage collection disabled.</span></span> <span data-ttu-id="c2e29-141">Cela provoquera moins de changements de contexte, ce qui peut améliorer les performances.</span><span class="sxs-lookup"><span data-stu-id="c2e29-141">This will result in less context switching, which can improve performance.</span></span>

## <a name="see-also"></a><span data-ttu-id="c2e29-142">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c2e29-142">See also</span></span>

- [<span data-ttu-id="c2e29-143">garbage collection d’arrière-plan</span><span class="sxs-lookup"><span data-stu-id="c2e29-143">Background garbage collection</span></span>](background-gc.md)
- [<span data-ttu-id="c2e29-144">Options de configuration au moment de l’exécution pour garbage collection</span><span class="sxs-lookup"><span data-stu-id="c2e29-144">Run-time configuration options for garbage collection</span></span>](../../core/run-time-config/garbage-collector.md)

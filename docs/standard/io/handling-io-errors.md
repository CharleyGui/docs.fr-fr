---
title: Gestion des erreurs E/S dans .NET
ms.date: 08/27/2018
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- I/O, exception handling
- I/O, errors
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: 51eb0e758f1ae8fb41c842ef9b32a9f8928af9ac
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/30/2019
ms.locfileid: "73120739"
---
# <a name="handling-io-errors-in-net"></a><span data-ttu-id="dd420-102">Gestion des erreurs E/S dans .NET</span><span class="sxs-lookup"><span data-stu-id="dd420-102">Handling I/O errors in .NET</span></span>

<span data-ttu-id="dd420-103">Outre les exceptions qui peuvent être levées dans n’importe quel appel de méthode (comme <xref:System.OutOfMemoryException> lorsqu’un système est sous contrainte ou <xref:System.NullReferenceException> en raison d’erreurs de programmation), les méthodes du système de fichiers .NET peuvent lever les exceptions suivantes :</span><span class="sxs-lookup"><span data-stu-id="dd420-103">In addition to the exceptions that can be thrown in any method call (such as an <xref:System.OutOfMemoryException> when a system is stressed or an <xref:System.NullReferenceException> due to programmer error), .NET file system methods can throw the following exceptions:</span></span>

- <span data-ttu-id="dd420-104"><xref:System.IO.IOException?displayProperty=nameWithType>, la classe de base de tous les types d’exceptions <xref:System.IO>.</span><span class="sxs-lookup"><span data-stu-id="dd420-104"><xref:System.IO.IOException?displayProperty=nameWithType>, the base class of all <xref:System.IO> exception types.</span></span> <span data-ttu-id="dd420-105">Elle est levée pour les erreurs dont les codes d’erreur à partir du système d’exploitation ne sont pas directement mappés vers un autre type d’exception.</span><span class="sxs-lookup"><span data-stu-id="dd420-105">It is thrown for errors whose return codes from the operating system don't directly map to any other exception type.</span></span>
- <span data-ttu-id="dd420-106"><xref:System.IO.FileNotFoundException?displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="dd420-106"><xref:System.IO.FileNotFoundException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="dd420-107"><xref:System.IO.DirectoryNotFoundException?displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="dd420-107"><xref:System.IO.DirectoryNotFoundException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="dd420-108"><xref:System.IO.DriveNotFoundException??displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="dd420-108"><xref:System.IO.DriveNotFoundException??displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="dd420-109"><xref:System.IO.PathTooLongException?displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="dd420-109"><xref:System.IO.PathTooLongException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="dd420-110"><xref:System.OperationCanceledException?displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="dd420-110"><xref:System.OperationCanceledException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="dd420-111"><xref:System.UnauthorizedAccessException?displayProperty=nameWithType>.,</span><span class="sxs-lookup"><span data-stu-id="dd420-111"><xref:System.UnauthorizedAccessException?displayProperty=nameWithType>.</span></span>
- <span data-ttu-id="dd420-112"><xref:System.ArgumentException?displayProperty=nameWithType>, qui est levée pour les caractères de chemin non valides sur le .NET Framework et .NET Core 2.0 et les versions précédentes.</span><span class="sxs-lookup"><span data-stu-id="dd420-112"><xref:System.ArgumentException?displayProperty=nameWithType>, which is thrown for invalid path characters on .NET Framework and on .NET Core 2.0 and previous versions.</span></span>
- <span data-ttu-id="dd420-113"><xref:System.NotSupportedException?displayProperty=nameWithType>, qui est levée pour les deux-points non valides dans le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="dd420-113"><xref:System.NotSupportedException?displayProperty=nameWithType>, which is thrown for invalid colons in .NET Framework.</span></span>
- <span data-ttu-id="dd420-114"><xref:System.Security.SecurityException?displayProperty=nameWithType>, qui est levée pour les applications exécutées en mode de confiance limitée et qui ne disposent pas des autorisations nécessaires sur le .NET Framework uniquement.</span><span class="sxs-lookup"><span data-stu-id="dd420-114"><xref:System.Security.SecurityException?displayProperty=nameWithType>, which is thrown for applications running in limited trust that lack the necessary permissions on .NET Framework only.</span></span> <span data-ttu-id="dd420-115">(La confiance totale est la valeur par défaut sur le .NET Framework.)</span><span class="sxs-lookup"><span data-stu-id="dd420-115">(Full trust is the default on .NET Framework.)</span></span>

## <a name="mapping-error-codes-to-exceptions"></a><span data-ttu-id="dd420-116">Mappage des codes d'erreur aux exceptions</span><span class="sxs-lookup"><span data-stu-id="dd420-116">Mapping error codes to exceptions</span></span>

<span data-ttu-id="dd420-117">Étant donné que le système de fichiers est une ressource de système d’exploitation, les méthodes E/S dans .NET Core et .NET Framework encapsulent les appels avec le système d’exploitation sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="dd420-117">Because the file system is an operating system resource, I/O methods in both .NET Core and .NET Framework wrap calls to the underlying operating system.</span></span> <span data-ttu-id="dd420-118">Lorsqu’une erreur E/S se produit dans le code exécuté par le système d’exploitation, celui-ci retourne des informations sur l’erreur à la méthode E/S .NET.</span><span class="sxs-lookup"><span data-stu-id="dd420-118">When an I/O error occurs in code executed by the operating system, the operating system returns error information to the .NET I/O method.</span></span> <span data-ttu-id="dd420-119">La méthode convertit ensuite les informations sur l’erreur, généralement sous la forme d’un code d’erreur, dans un type d’exception .NET.</span><span class="sxs-lookup"><span data-stu-id="dd420-119">The method then translates the error information, typically in the form of an error code, into a .NET exception type.</span></span> <span data-ttu-id="dd420-120">Dans la plupart des cas, cela signifie traduire directement le code d’erreur dans son type d’exception correspondant. La méthode n’effectue pas un mappage spécial de l’erreur en fonction du contexte de l’appel de la méthode.</span><span class="sxs-lookup"><span data-stu-id="dd420-120">In most cases, it does this by directly translating the error code into its corresponding exception type; it does not perform any special mapping of the error based on the context of the method call.</span></span>

<span data-ttu-id="dd420-121">Par exemple, sur le système d’exploitation Windows, un appel de méthode qui retourne un code d’erreur `ERROR_FILE_NOT_FOUND` (ou 0x02) est mappé à <xref:System.IO.FileNotFoundException> et le code d’erreur `ERROR_PATH_NOT_FOUND` (ou 0x03) correspond à <xref:System.IO.DirectoryNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="dd420-121">For example, on the Windows operating system, a method call that returns an error code of `ERROR_FILE_NOT_FOUND` (or 0x02) maps to a <xref:System.IO.FileNotFoundException>, and an error code of `ERROR_PATH_NOT_FOUND` (or 0x03) maps to a <xref:System.IO.DirectoryNotFoundException>.</span></span>

<span data-ttu-id="dd420-122">Toutefois, les conditions précises sous lesquelles le système d’exploitation retourne des codes d’erreur particuliers sont souvent non documentées ou mal documentées.</span><span class="sxs-lookup"><span data-stu-id="dd420-122">However, the precise conditions under which the operating system returns particular error codes is often undocumented or poorly documented.</span></span> <span data-ttu-id="dd420-123">Par conséquent, des exceptions inattendues peuvent se produire.</span><span class="sxs-lookup"><span data-stu-id="dd420-123">As a result, unexpected exceptions can occur.</span></span> <span data-ttu-id="dd420-124">Par exemple, étant donné que vous travaillez avec un répertoire au lieu d’un fichier, vous pourriez penser que le fait de fournir un chemin d’accès de répertoire non valide au constructeur <xref:System.IO.DirectoryInfo.%23ctor%2A?displayProperty=nameWithType> lèverait une exception <xref:System.IO.DirectoryNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="dd420-124">For example, because you are working with a directory rather than a file, you would expect that providing an invalid directory path to the <xref:System.IO.DirectoryInfo.%23ctor%2A?displayProperty=nameWithType> constructor throws a <xref:System.IO.DirectoryNotFoundException>.</span></span> <span data-ttu-id="dd420-125">Toutefois, une exception <xref:System.IO.FileNotFoundException> peut également être levée.</span><span class="sxs-lookup"><span data-stu-id="dd420-125">However, it may also throw a <xref:System.IO.FileNotFoundException>.</span></span>

## <a name="exception-handling-in-io-operations"></a><span data-ttu-id="dd420-126">Gestion des exceptions dans les opérations E/S</span><span class="sxs-lookup"><span data-stu-id="dd420-126">Exception handling in I/O operations</span></span>

<span data-ttu-id="dd420-127">En raison de cette dépendance envers le système d’exploitation, des conditions d’exception identiques (par exemple, l’erreur répertoire introuvable dans ce cas) peuvent faire qu’une méthode E/S lève l’une des exceptions de la classe entière d’exceptions E/S.</span><span class="sxs-lookup"><span data-stu-id="dd420-127">Because of this reliance on the operating system, identical exception conditions (such as the directory not found error in our example) can result in an I/O method throwing any one of the entire class of I/O exceptions.</span></span> <span data-ttu-id="dd420-128">Cela signifie que, lors de l’appel d’API E/S, votre code doit être prêt à gérer la plupart ou toutes ces exceptions, comme indiqué dans le tableau suivant :</span><span class="sxs-lookup"><span data-stu-id="dd420-128">This means that, when calling I/O APIs, your code should be prepared to handle most or all of these exceptions, as shown in the following table:</span></span>

| <span data-ttu-id="dd420-129">Type d'exception</span><span class="sxs-lookup"><span data-stu-id="dd420-129">Exception type</span></span> | <span data-ttu-id="dd420-130">.NET Core</span><span class="sxs-lookup"><span data-stu-id="dd420-130">.NET Core</span></span> | <span data-ttu-id="dd420-131">.NET Framework</span><span class="sxs-lookup"><span data-stu-id="dd420-131">.NET Framework</span></span> |
|---|---|---|
| <xref:System.IO.IOException> | <span data-ttu-id="dd420-132">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-132">Yes</span></span> | <span data-ttu-id="dd420-133">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-133">Yes</span></span> |
| <xref:System.IO.FileNotFoundException> | <span data-ttu-id="dd420-134">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-134">Yes</span></span> | <span data-ttu-id="dd420-135">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-135">Yes</span></span> |
| <xref:System.IO.DirectoryNotFoundException> | <span data-ttu-id="dd420-136">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-136">Yes</span></span> | <span data-ttu-id="dd420-137">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-137">Yes</span></span> |
| <xref:System.IO.DriveNotFoundException?> | <span data-ttu-id="dd420-138">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-138">Yes</span></span> | <span data-ttu-id="dd420-139">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-139">Yes</span></span> |
| <xref:System.IO.PathTooLongException> | <span data-ttu-id="dd420-140">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-140">Yes</span></span> | <span data-ttu-id="dd420-141">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-141">Yes</span></span> |
| <xref:System.OperationCanceledException> | <span data-ttu-id="dd420-142">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-142">Yes</span></span> | <span data-ttu-id="dd420-143">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-143">Yes</span></span> |
| <xref:System.UnauthorizedAccessException> | <span data-ttu-id="dd420-144">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-144">Yes</span></span> | <span data-ttu-id="dd420-145">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-145">Yes</span></span> |
| <xref:System.ArgumentException> | <span data-ttu-id="dd420-146">.NET Core 2.0 et versions antérieures</span><span class="sxs-lookup"><span data-stu-id="dd420-146">.NET Core 2.0 and earlier</span></span>| <span data-ttu-id="dd420-147">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-147">Yes</span></span> |
| <xref:System.NotSupportedException> | <span data-ttu-id="dd420-148">Non</span><span class="sxs-lookup"><span data-stu-id="dd420-148">No</span></span> | <span data-ttu-id="dd420-149">Oui</span><span class="sxs-lookup"><span data-stu-id="dd420-149">Yes</span></span> |
| <xref:System.Security.SecurityException> | <span data-ttu-id="dd420-150">Non</span><span class="sxs-lookup"><span data-stu-id="dd420-150">No</span></span> | <span data-ttu-id="dd420-151">Confiance limitée uniquement</span><span class="sxs-lookup"><span data-stu-id="dd420-151">Limited trust only</span></span> |

## <a name="handling-ioexception"></a><span data-ttu-id="dd420-152">Gestion d’IOException</span><span class="sxs-lookup"><span data-stu-id="dd420-152">Handling IOException</span></span>

<span data-ttu-id="dd420-153">Comme la classe de base pour les exceptions dans l’espace de noms <xref:System.IO>, <xref:System.IO.IOException> est également levée pour n’importe quel code d’erreur qui n’est pas mappé à un type d’exception prédéfini.</span><span class="sxs-lookup"><span data-stu-id="dd420-153">As the base class for exceptions in the <xref:System.IO> namespace, <xref:System.IO.IOException> is also thrown for any error code that does not map to a predefined exception type.</span></span> <span data-ttu-id="dd420-154">Cela signifie qu’elle peut être levée par n’importe quelle opération E/S.</span><span class="sxs-lookup"><span data-stu-id="dd420-154">This means that it can be thrown by any I/O operation.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="dd420-155">Étant donné que <xref:System.IO.IOException> est la classe de base des autres types d’exception dans l’espace de noms <xref:System.IO>, vous devez la gérer dans un bloc `catch` une fois que vous avez géré les autres exceptions E/S associées.</span><span class="sxs-lookup"><span data-stu-id="dd420-155">Because <xref:System.IO.IOException> is the base class of the other exception types in the <xref:System.IO> namespace, you should handle in a `catch` block after you've handled the other I/O-related exceptions.</span></span>

<span data-ttu-id="dd420-156">En outre, à compter de .NET Core 2.1, les contrôles de validation de l’exactitude du chemin d’accès (par exemple, pour s’assurer que des caractères non valides ne sont pas présents dans un chemin d’accès) ont été supprimés, et le runtime lève une exception mappée à partir d’un code d’erreur de système d’exploitation plutôt qu’à partir de son propre code de validation.</span><span class="sxs-lookup"><span data-stu-id="dd420-156">In addition, starting with .NET Core 2.1, validation checks for path correctness (for example, to ensure that invalid characters are not present in a path) have been removed, and the runtime throws an exception mapped from an operating system error code rather than from its own validation code.</span></span> <span data-ttu-id="dd420-157">L’exception la plus susceptible d’être levée dans ce cas est <xref:System.IO.IOException>, bien que n’importe quel autre type d’exception puisse également être levé.</span><span class="sxs-lookup"><span data-stu-id="dd420-157">The most likely exception to be thrown in this case is an <xref:System.IO.IOException>, although any other exception type could also be thrown.</span></span>

<span data-ttu-id="dd420-158">Notez que, dans votre code gestion des exceptions, vous devez toujours gérer <xref:System.IO.IOException> en dernier.</span><span class="sxs-lookup"><span data-stu-id="dd420-158">Note that, in your exception handling code, you should always handle the <xref:System.IO.IOException> last.</span></span> <span data-ttu-id="dd420-159">Sinon, étant donné qu’il s’agit de la classe de base de toutes les autres exceptions d’E/S, les blocs catch des classes dérivées ne seront pas évalués.</span><span class="sxs-lookup"><span data-stu-id="dd420-159">Otherwise, because it is the base class of all other IO exceptions, the catch blocks of derived classes will not be evaluated.</span></span>

<span data-ttu-id="dd420-160">Dans le cas de <xref:System.IO.IOException>, vous pouvez obtenir des informations supplémentaires sur l’erreur à partir de la propriété [IOException.HResult](xref:System.Exception.HResult).</span><span class="sxs-lookup"><span data-stu-id="dd420-160">In the case of an <xref:System.IO.IOException>, you can get additional error information from the [IOException.HResult](xref:System.Exception.HResult) property.</span></span> <span data-ttu-id="dd420-161">Pour convertir la valeur HResult en un code d’erreur Win32, éliminez les 16 bits supérieurs de la valeur de 32 bits.</span><span class="sxs-lookup"><span data-stu-id="dd420-161">To convert the HResult value to a Win32 error code, you strip out the upper 16 bits of the 32-bit value.</span></span> <span data-ttu-id="dd420-162">Le tableau suivant répertorie les codes d’erreur qui peuvent être encapsulés dans <xref:System.IO.IOException>.</span><span class="sxs-lookup"><span data-stu-id="dd420-162">The following table lists error codes that may be wrapped in an <xref:System.IO.IOException>.</span></span>

| <span data-ttu-id="dd420-163">HResult</span><span class="sxs-lookup"><span data-stu-id="dd420-163">HResult</span></span> | <span data-ttu-id="dd420-164">Constante</span><span class="sxs-lookup"><span data-stu-id="dd420-164">Constant</span></span> | <span data-ttu-id="dd420-165">Description</span><span class="sxs-lookup"><span data-stu-id="dd420-165">Description</span></span> |
| --- | --- | --- |
| <span data-ttu-id="dd420-166">ERROR_SHARING_VIOLATION</span><span class="sxs-lookup"><span data-stu-id="dd420-166">ERROR_SHARING_VIOLATION</span></span> | <span data-ttu-id="dd420-167">32</span><span class="sxs-lookup"><span data-stu-id="dd420-167">32</span></span> | <span data-ttu-id="dd420-168">Le nom de fichier est manquant ou le fichier ou le répertoire est en cours d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="dd420-168">The file name is missing, or the file or directory is in use.</span></span> |
| <span data-ttu-id="dd420-169">ERROR_FILE_EXISTS</span><span class="sxs-lookup"><span data-stu-id="dd420-169">ERROR_FILE_EXISTS</span></span> | <span data-ttu-id="dd420-170">80</span><span class="sxs-lookup"><span data-stu-id="dd420-170">80</span></span> | <span data-ttu-id="dd420-171">Le fichier existe déjà.</span><span class="sxs-lookup"><span data-stu-id="dd420-171">The file already exists.</span></span> |
| <span data-ttu-id="dd420-172">ERROR_INVALID_PARAMETER</span><span class="sxs-lookup"><span data-stu-id="dd420-172">ERROR_INVALID_PARAMETER</span></span> | <span data-ttu-id="dd420-173">87</span><span class="sxs-lookup"><span data-stu-id="dd420-173">87</span></span> | <span data-ttu-id="dd420-174">Un argument fourni à la méthode n’est pas valide.</span><span class="sxs-lookup"><span data-stu-id="dd420-174">An argument supplied to the method is invalid.</span></span> |
| <span data-ttu-id="dd420-175">ERROR_ALREADY_EXISTS</span><span class="sxs-lookup"><span data-stu-id="dd420-175">ERROR_ALREADY_EXISTS</span></span> | <span data-ttu-id="dd420-176">183</span><span class="sxs-lookup"><span data-stu-id="dd420-176">183</span></span> | <span data-ttu-id="dd420-177">Le fichier ou le répertoire existe déjà.</span><span class="sxs-lookup"><span data-stu-id="dd420-177">The file or directory already exists.</span></span> |

<span data-ttu-id="dd420-178">Vous pouvez les gérer à l’aide d’une clause `When` dans une instruction catch, comme le montre l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="dd420-178">You can handle these using a `When` clause in a catch statement, as the following example shows.</span></span>

[!code-csharp[io-exception-handling](~/samples/snippets/standard/io/io-exceptions/cs/io-exceptions.cs)]
[!code-vb[io-exception-handling](~/samples/snippets/standard/io/io-exceptions/vb/io-exceptions.vb)]

## <a name="see-also"></a><span data-ttu-id="dd420-179">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="dd420-179">See also</span></span>

- [<span data-ttu-id="dd420-180">Gestion et levée d’exceptions dans .NET</span><span class="sxs-lookup"><span data-stu-id="dd420-180">Handling and throwing exceptions in .NET</span></span>](../exceptions/index.md)
- [<span data-ttu-id="dd420-181">Gestion des exceptions (bibliothèque parallèle de tâches)</span><span class="sxs-lookup"><span data-stu-id="dd420-181">Exception handling (Task Parallel Library)</span></span>](../parallel-programming/exception-handling-task-parallel-library.md)
- [<span data-ttu-id="dd420-182">Meilleures pratiques pour les exceptions</span><span class="sxs-lookup"><span data-stu-id="dd420-182">Best practices for exceptions</span></span>](../exceptions/best-practices-for-exceptions.md)
- [<span data-ttu-id="dd420-183">Utiliser des exceptions spécifiques dans un bloc Catch</span><span class="sxs-lookup"><span data-stu-id="dd420-183">How to use specific exceptions in a catch block</span></span>](../exceptions/how-to-use-specific-exceptions-in-a-catch-block.md)

---
title: Application d'attributs d'interopérabilité
ms.date: 03/30/2017
helpviewer_keywords:
- design-time attributes
- .NET Framework, exposing components to COM
- attributes [.NET Framework], design-time functionality
- conversion-tool attributes
- attributes [.NET Framework], interop-specific
- attributes [.NET Framework], conversion-tool
- interoperation with unmanaged code, applying attributes
- interoperation with unmanaged code, exposing .NET Framework components
- COM interop, exposing COM components
- COM interop, applying attributes
ms.assetid: b6014613-641c-4912-9e2f-83a99210a037
ms.openlocfilehash: ca104c512641774217de5e270dc50b7393fc5725
ms.sourcegitcommit: 00aa62e2f469c2272a457b04e66b4cc3c97a800b
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/28/2020
ms.locfileid: "78159245"
---
# <a name="applying-interop-attributes"></a><span data-ttu-id="abf51-102">Application d'attributs d'interopérabilité</span><span class="sxs-lookup"><span data-stu-id="abf51-102">Applying Interop Attributes</span></span>
<span data-ttu-id="abf51-103">L’espace de noms <xref:System.Runtime.InteropServices> propose trois catégories d’attributs spécifiques à l’interopérabilité : ceux que vous appliquez au moment du design, ceux que les interfaces API et les outils de COM Interop appliquent au cours du processus de conversion et ceux que vous appliquez ou que COM Interop applique.</span><span class="sxs-lookup"><span data-stu-id="abf51-103">The <xref:System.Runtime.InteropServices> namespace provides three categories of interop-specific attributes: those applied by you at design time, those applied by COM interop tools and APIs during the conversion process, and those applied either by you or COM interop.</span></span>  
  
 <span data-ttu-id="abf51-104">Si vous n’êtes pas habitué aux tâches relatives à l’application d’attributs à du code managé, consultez [Extension des métadonnées à l’aide des attributs](../../../docs/standard/attributes/index.md).</span><span class="sxs-lookup"><span data-stu-id="abf51-104">If you are unfamiliar with the task of applying attributes to managed code, see [Extending Metadata Using Attributes](../../../docs/standard/attributes/index.md).</span></span> <span data-ttu-id="abf51-105">Comme pour les autres attributs personnalisés, vous pouvez appliquer des attributs spécifiques à l’interopérabilité à des types, à des méthodes, à des paramètres, à des propriétés, à des champs et à d’autres membres.</span><span class="sxs-lookup"><span data-stu-id="abf51-105">Like other custom attributes, you can apply interop-specific attributes to types, methods, properties, parameters, fields, and other members.</span></span>  
  
## <a name="design-time-attributes"></a><span data-ttu-id="abf51-106">Attributs au moment du design</span><span class="sxs-lookup"><span data-stu-id="abf51-106">Design-Time Attributes</span></span>  
 <span data-ttu-id="abf51-107">Vous pouvez ajuster le résultat du processus de conversion effectué par les interfaces API et les outils de COM Interop à l’aide d’attributs au moment du design.</span><span class="sxs-lookup"><span data-stu-id="abf51-107">You can adjust the outcome of the conversion process performed by COM interop tools and APIs by using design-time attributes.</span></span> <span data-ttu-id="abf51-108">Le tableau suivant décrit les attributs que vous pouvez appliquer à votre code source managé.</span><span class="sxs-lookup"><span data-stu-id="abf51-108">The following table describes the attributes that you can apply to your managed source code.</span></span> <span data-ttu-id="abf51-109">Les outils de COM Interop peuvent également parfois appliquer les attributs décrits dans ce tableau.</span><span class="sxs-lookup"><span data-stu-id="abf51-109">COM interop tools, on occasion, might also apply the attributes described in this table.</span></span>  
  
|<span data-ttu-id="abf51-110">Attribut</span><span class="sxs-lookup"><span data-stu-id="abf51-110">Attribute</span></span>|<span data-ttu-id="abf51-111">Description</span><span class="sxs-lookup"><span data-stu-id="abf51-111">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.AutomationProxyAttribute>|<span data-ttu-id="abf51-112">Indique si le type doit être marshalé en utilisant Automation Marshaler ou un proxy et un stub personnalisés.</span><span class="sxs-lookup"><span data-stu-id="abf51-112">Specifies whether the type should be marshaled using the Automation marshaler or a custom proxy and stub.</span></span>|  
|<xref:System.Runtime.InteropServices.ClassInterfaceAttribute>|<span data-ttu-id="abf51-113">Contrôle le type d’interface généré pour une classe.</span><span class="sxs-lookup"><span data-stu-id="abf51-113">Controls the type of interface generated for a class.</span></span>|  
|<xref:System.Runtime.InteropServices.CoClassAttribute>|<span data-ttu-id="abf51-114">Identifie le CLSID de la coclasse d’origine importée à partir d’une bibliothèque de types.</span><span class="sxs-lookup"><span data-stu-id="abf51-114">Identifies the CLSID of the original coclass imported from a type library.</span></span><br /><br /> <span data-ttu-id="abf51-115">Les outils de COM Interop appliquent généralement cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-115">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComImportAttribute>|<span data-ttu-id="abf51-116">Indique qu’une définition d’interface ou de coclasse a été importée à partir d’une bibliothèque de types COM.</span><span class="sxs-lookup"><span data-stu-id="abf51-116">Indicates that a coclass or interface definition was imported from a COM type library.</span></span> <span data-ttu-id="abf51-117">Le runtime utilise cet indicateur pour savoir comment activer et marshaler le type.</span><span class="sxs-lookup"><span data-stu-id="abf51-117">The runtime uses this flag to know how to activate and marshal the type.</span></span> <span data-ttu-id="abf51-118">Cet attribut interdit au type d’être de nouveau exporté vers une bibliothèque de types.</span><span class="sxs-lookup"><span data-stu-id="abf51-118">This attribute prohibits the type from being exported back to a type library.</span></span><br /><br /> <span data-ttu-id="abf51-119">Les outils de COM Interop appliquent généralement cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-119">COM interop tools typically apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComRegisterFunctionAttribute>|<span data-ttu-id="abf51-120">Indique qu’une méthode doit être appelée quand l’assembly est inscrit en vue de son utilisation à partir de COM, de sorte que le code écrit par l’utilisateur puisse être exécuté au cours du processus d’inscription.</span><span class="sxs-lookup"><span data-stu-id="abf51-120">Indicates that a method should be called when the assembly is registered for use from COM, so that user-written code can be executed during the registration process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComSourceInterfacesAttribute>|<span data-ttu-id="abf51-121">Identifie les interfaces qui sont des sources d’événements pour la classe.</span><span class="sxs-lookup"><span data-stu-id="abf51-121">Identifies interfaces that are sources of events for the class.</span></span><br /><br /> <span data-ttu-id="abf51-122">Les outils de COM Interop peuvent appliquer cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-122">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ComUnregisterFunctionAttribute>|<span data-ttu-id="abf51-123">Indique qu’une méthode doit être appelée quand l’inscription de l’assembly dans COM est annulée, de sorte que le code écrit par l’utilisateur puisse s’exécuter au cours du processus.</span><span class="sxs-lookup"><span data-stu-id="abf51-123">Indicates that a method should be called when the assembly is unregistered from COM, so that user-written code can execute during the process.</span></span>|  
|<xref:System.Runtime.InteropServices.ComVisibleAttribute>|<span data-ttu-id="abf51-124">Rend les types invisibles à COM quand l’attribut a la valeur **false**.</span><span class="sxs-lookup"><span data-stu-id="abf51-124">Renders types invisible to COM when the attribute value equals **false**.</span></span> <span data-ttu-id="abf51-125">Cet attribut peut être appliqué à un type individuel ou à l’intégralité de l’assembly pour contrôler la visibilité COM.</span><span class="sxs-lookup"><span data-stu-id="abf51-125">This attribute can be applied to an individual type or to an entire assembly to control COM visibility.</span></span> <span data-ttu-id="abf51-126">Par défaut, tous les types publics managés sont visibles ; l’attribut n’est pas nécessaire pour les rendre visibles.</span><span class="sxs-lookup"><span data-stu-id="abf51-126">By default, all managed, public types are visible; the attribute is not needed to make them visible.</span></span>|  
|<xref:System.Runtime.InteropServices.DispIdAttribute>|<span data-ttu-id="abf51-127">Spécifie l’identificateur de répartition COM (DISPID) d’une méthode ou d’un champ.</span><span class="sxs-lookup"><span data-stu-id="abf51-127">Specifies the COM dispatch identifier (DISPID) of a method or field.</span></span> <span data-ttu-id="abf51-128">Cet attribut contient le DISPID de la méthode, du champ ou de la propriété qu’il décrit.</span><span class="sxs-lookup"><span data-stu-id="abf51-128">This attribute contains the DISPID for the method, field, or property it describes.</span></span><br /><br /> <span data-ttu-id="abf51-129">Les outils de COM Interop peuvent appliquer cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-129">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.ComDefaultInterfaceAttribute>|<span data-ttu-id="abf51-130">Indique l’interface par défaut pour une classe COM implémentée dans .NET.</span><span class="sxs-lookup"><span data-stu-id="abf51-130">Indicates the default interface for a COM class implemented in .NET.</span></span><br /><br /> <span data-ttu-id="abf51-131">Les outils de COM Interop peuvent appliquer cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-131">COM interop tools can apply this attribute.</span></span>|
|<xref:System.Runtime.InteropServices.FieldOffsetAttribute>|<span data-ttu-id="abf51-132">Indique la position physique de chaque champ dans une classe en cas d’utilisation avec **StructLayoutAttribute** et d’affectation d’Explicit à **LayoutKind**.</span><span class="sxs-lookup"><span data-stu-id="abf51-132">Indicates the physical position of each field within a class when used with the **StructLayoutAttribute**, and the **LayoutKind** is set to Explicit.</span></span>|  
|<xref:System.Runtime.InteropServices.GuidAttribute>|<span data-ttu-id="abf51-133">Spécifie l’identificateur global unique (GUID) d’une classe, d’une interface ou d’une bibliothèque de types toute entière.</span><span class="sxs-lookup"><span data-stu-id="abf51-133">Specifies the globally unique identifier (GUID) of a class, interface, or an entire type library.</span></span> <span data-ttu-id="abf51-134">La chaîne doit être passée à l’attribut sous la forme d’un argument de constructeur acceptable pour le type **System.Guid**.</span><span class="sxs-lookup"><span data-stu-id="abf51-134">The string passed to the attribute must be a format that is an acceptable constructor argument for the type **System.Guid**.</span></span><br /><br /> <span data-ttu-id="abf51-135">Les outils de COM Interop peuvent appliquer cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-135">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.IDispatchImplAttribute>|<span data-ttu-id="abf51-136">Indique l’implémentation d’interface **IDispatch** utilisée par le common language runtime lors de l’exposition d’interfaces Dual et de dispinterfaces à COM.</span><span class="sxs-lookup"><span data-stu-id="abf51-136">Indicates which **IDispatch** interface implementation the common language runtime uses when exposing dual interfaces and dispinterfaces to COM.</span></span>|  
|<xref:System.Runtime.InteropServices.InAttribute>|<span data-ttu-id="abf51-137">Indique que des données doivent être marshalées dans l’appelant.</span><span class="sxs-lookup"><span data-stu-id="abf51-137">Indicates that data should be marshaled in to the caller.</span></span> <span data-ttu-id="abf51-138">Peut s’utiliser pour attribuer des paramètres.</span><span class="sxs-lookup"><span data-stu-id="abf51-138">Can be used to attribute parameters.</span></span>|  
|<xref:System.Runtime.InteropServices.InterfaceTypeAttribute>|<span data-ttu-id="abf51-139">Contrôle le mode d’exposition d’une interface managée à des clients COM (Dual, dérivée d’IUnknown ou IDispatch uniquement).</span><span class="sxs-lookup"><span data-stu-id="abf51-139">Controls how a managed interface is exposed to COM clients (Dual, IUnknown-derived, or IDispatch only).</span></span><br /><br /> <span data-ttu-id="abf51-140">Les outils de COM Interop peuvent appliquer cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-140">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.LCIDConversionAttribute>|<span data-ttu-id="abf51-141">Indique que la signature d’une méthode non managée attend un paramètre LCID.</span><span class="sxs-lookup"><span data-stu-id="abf51-141">Indicates that an unmanaged method signature expects an LCID parameter.</span></span><br /><br /> <span data-ttu-id="abf51-142">Les outils de COM Interop peuvent appliquer cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-142">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.MarshalAsAttribute>|<span data-ttu-id="abf51-143">Indique le mode de marshaling des données figurant dans des champs ou des paramètres entre du code managé et non managé.</span><span class="sxs-lookup"><span data-stu-id="abf51-143">Indicates how the data in fields or parameters should be marshaled between managed and unmanaged code.</span></span> <span data-ttu-id="abf51-144">L’attribut est toujours facultatif, car chaque type de données possède un comportement de marshaling par défaut.</span><span class="sxs-lookup"><span data-stu-id="abf51-144">The attribute is always optional because each data type has default marshaling behavior.</span></span><br /><br /> <span data-ttu-id="abf51-145">Les outils de COM Interop peuvent appliquer cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-145">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OptionalAttribute>|<span data-ttu-id="abf51-146">Indique qu'un paramètre est facultatif.</span><span class="sxs-lookup"><span data-stu-id="abf51-146">Indicates that a parameter is optional.</span></span><br /><br /> <span data-ttu-id="abf51-147">Les outils de COM Interop peuvent appliquer cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-147">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.OutAttribute>|<span data-ttu-id="abf51-148">Indique que les données d’un champ ou d’un paramètre doivent être remarshalées depuis un objet appelé vers son appelant.</span><span class="sxs-lookup"><span data-stu-id="abf51-148">Indicates that the data in a field or parameter must be marshaled from a called object back to its caller.</span></span>|  
|<xref:System.Runtime.InteropServices.PreserveSigAttribute>|<span data-ttu-id="abf51-149">Supprime la transformation de la signature HRESULT ou retval qui s’effectue normalement au cours des appels d’interopérabilité.</span><span class="sxs-lookup"><span data-stu-id="abf51-149">Suppresses the HRESULT or retval signature transformation that normally takes place during interoperation calls.</span></span> <span data-ttu-id="abf51-150">Cet attribut affecte le marshaling ainsi que l’exportation des bibliothèques de types.</span><span class="sxs-lookup"><span data-stu-id="abf51-150">The attribute affects marshaling as well as type library exporting.</span></span><br /><br /> <span data-ttu-id="abf51-151">Les outils de COM Interop peuvent appliquer cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-151">COM interop tools can apply this attribute.</span></span>|  
|<xref:System.Runtime.InteropServices.ProgIdAttribute>|<span data-ttu-id="abf51-152">Spécifie le ProgID d’une classe .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="abf51-152">Specifies the ProgID of a .NET Framework class.</span></span> <span data-ttu-id="abf51-153">Peut s’utiliser pour attribuer des classes.</span><span class="sxs-lookup"><span data-stu-id="abf51-153">Can be used to attribute classes.</span></span>|  
|<xref:System.Runtime.InteropServices.StructLayoutAttribute>|<span data-ttu-id="abf51-154">Contrôle la disposition physique des champs d’une classe.</span><span class="sxs-lookup"><span data-stu-id="abf51-154">Controls the physical layout of the fields of a class.</span></span><br /><br /> <span data-ttu-id="abf51-155">Les outils de COM Interop peuvent appliquer cet attribut.</span><span class="sxs-lookup"><span data-stu-id="abf51-155">COM interop tools can apply this attribute.</span></span>|  
  
## <a name="conversion-tool-attributes"></a><span data-ttu-id="abf51-156">Attributs d’outils de conversion</span><span class="sxs-lookup"><span data-stu-id="abf51-156">Conversion-Tool Attributes</span></span>  
 <span data-ttu-id="abf51-157">Le tableau suivant décrit les attributs que les outils de COM Interop appliquent au cours du processus de conversion.</span><span class="sxs-lookup"><span data-stu-id="abf51-157">The following table describes attributes that COM interop tools apply during the conversion process.</span></span> <span data-ttu-id="abf51-158">Vous n’appliquez pas ces attributs au moment du design.</span><span class="sxs-lookup"><span data-stu-id="abf51-158">You do not apply these attributes at design time.</span></span>  
  
|<span data-ttu-id="abf51-159">Attribut</span><span class="sxs-lookup"><span data-stu-id="abf51-159">Attribute</span></span>|<span data-ttu-id="abf51-160">Description</span><span class="sxs-lookup"><span data-stu-id="abf51-160">Description</span></span>|  
|---------------|-----------------|  
|<xref:System.Runtime.InteropServices.ComAliasNameAttribute>|<span data-ttu-id="abf51-161">Indique l’alias COM pour un type de paramètre ou de champ.</span><span class="sxs-lookup"><span data-stu-id="abf51-161">Indicates the COM alias for a parameter or field type.</span></span> <span data-ttu-id="abf51-162">Peut s’utiliser pour attribuer des paramètres, champs ou valeurs de retour.</span><span class="sxs-lookup"><span data-stu-id="abf51-162">Can be used to attribute parameters, fields, or return values.</span></span>|  
|<xref:System.Runtime.InteropServices.ComConversionLossAttribute>|<span data-ttu-id="abf51-163">Indique que des informations sur une classe ou une interface ont été perdues lors de leur importation d’une bibliothèque de types vers un assembly.</span><span class="sxs-lookup"><span data-stu-id="abf51-163">Indicates that information about a class or interface was lost when it was imported from a type library to an assembly.</span></span>|  
|<xref:System.Runtime.InteropServices.ComEventInterfaceAttribute>|<span data-ttu-id="abf51-164">Identifie l’interface source et la classe qui implémente les méthodes de l’interface d’événement.</span><span class="sxs-lookup"><span data-stu-id="abf51-164">Identifies the source interface and the class that implements the methods of the event interface.</span></span>|  
|<xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>|<span data-ttu-id="abf51-165">Indique que l’assembly a été importé à l’origine à partir d’une bibliothèque de types COM.</span><span class="sxs-lookup"><span data-stu-id="abf51-165">Indicates that the assembly was originally imported from a COM type library.</span></span> <span data-ttu-id="abf51-166">Cet attribut contient la définition de la bibliothèque de types d’origine.</span><span class="sxs-lookup"><span data-stu-id="abf51-166">This attribute contains the type library definition of the original type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibFuncAttribute>|<span data-ttu-id="abf51-167">Contient les **FUNCFLAGS** qui ont été importés à l’origine pour cette fonction à partir de la bibliothèque de types COM.</span><span class="sxs-lookup"><span data-stu-id="abf51-167">Contains the **FUNCFLAGS** that were originally imported for this function from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibTypeAttribute>|<span data-ttu-id="abf51-168">Contient les **TYPEFLAGS** qui ont été importés à l’origine pour ce type à partir de la bibliothèque de types COM.</span><span class="sxs-lookup"><span data-stu-id="abf51-168">Contains the **TYPEFLAGS** that were originally imported for this type from the COM type library.</span></span>|  
|<xref:System.Runtime.InteropServices.TypeLibVarAttribute>|<span data-ttu-id="abf51-169">Contient les **VARFLAGS** qui ont été importés à l’origine pour cette variable à partir de la bibliothèque de types COM.</span><span class="sxs-lookup"><span data-stu-id="abf51-169">Contains the **VARFLAGS** that were originally imported for this variable from the COM type library.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="abf51-170">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="abf51-170">See also</span></span>

- <xref:System.Runtime.InteropServices>
- [<span data-ttu-id="abf51-171">Exposition de composants .NET Framework à COM</span><span class="sxs-lookup"><span data-stu-id="abf51-171">Exposing .NET Framework Components to COM</span></span>](../../../docs/framework/interop/exposing-dotnet-components-to-com.md)
- [<span data-ttu-id="abf51-172">Attributs</span><span class="sxs-lookup"><span data-stu-id="abf51-172">Attributes</span></span>](../../../docs/standard/attributes/index.md)
- [<span data-ttu-id="abf51-173">Qualification des types .NET pour l’interopérabilité</span><span class="sxs-lookup"><span data-stu-id="abf51-173">Qualifying .NET Types for Interoperation</span></span>](../../../docs/standard/native-interop/qualify-net-types-for-interoperation.md)
- [<span data-ttu-id="abf51-174">Empaquetage d’un assembly .NET Framework pour COM</span><span class="sxs-lookup"><span data-stu-id="abf51-174">Packaging a .NET Framework Assembly for COM</span></span>](../../../docs/framework/interop/packaging-an-assembly-for-com.md)

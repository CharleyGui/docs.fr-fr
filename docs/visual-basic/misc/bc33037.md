---
title: Impossible de recopier la valeur du paramètre’ByRef' ' <parametername> 'dans l’argument correspondant, car le type' <typename1> 'ne peut pas être converti en type' <typename2> '
ms.date: 07/20/2015
f1_keywords:
- vbc33037
- BC33037
helpviewer_keywords:
- BC33037
ms.assetid: 3ff137e2-e062-4e54-abf5-e902e2d18968
ms.openlocfilehash: df924804c07c686f4bb23d843d7cbd5fbc1fdba2
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/04/2020
ms.locfileid: "84379690"
---
# <a name="cannot-copy-the-value-of-byref-parameter-parametername-back-to-the-matching-argument-because-type-typename1-cannot-be-converted-to-type-typename2"></a><span data-ttu-id="697a2-102">Impossible de recopier la valeur du paramètre’ByRef' ' \<parametername> 'dans l’argument correspondant, car le type' \<typename1> 'ne peut pas être converti en type' \<typename2> '</span><span class="sxs-lookup"><span data-stu-id="697a2-102">Cannot copy the value of 'ByRef' parameter '\<parametername>' back to the matching argument because type '\<typename1>' cannot be converted to type '\<typename2>'</span></span>
<span data-ttu-id="697a2-103">Une procédure est déclarée avec un type de paramètre qui ne peut pas être reconverti en type d’argument appelant.</span><span class="sxs-lookup"><span data-stu-id="697a2-103">A procedure is declared with a parameter type which cannot be converted back to the calling argument type.</span></span>  
  
 <span data-ttu-id="697a2-104">Quand vous définissez une classe ou une structure, vous pouvez définir un ou plusieurs opérateurs de conversion pour convertir le type de la classe ou de la structure en d’autres types.</span><span class="sxs-lookup"><span data-stu-id="697a2-104">When you define a class or structure, you can define one or more conversion operators to convert that class or structure type to other types.</span></span> <span data-ttu-id="697a2-105">Vous pouvez également définir des opérateurs de conversion inverse pour convertir ces autres types vers le type de votre classe ou de votre structure.</span><span class="sxs-lookup"><span data-stu-id="697a2-105">You can also define reverse conversion operators to convert those other types back to your class or structure type.</span></span> <span data-ttu-id="697a2-106">Quand vous utilisez votre type de classe ou de structure dans un appel de procédure, Visual Basic pouvez utiliser ces opérateurs de conversion pour convertir le type d’un argument vers le type de son paramètre correspondant.</span><span class="sxs-lookup"><span data-stu-id="697a2-106">When you use your class or structure type in a procedure call, Visual Basic can use these conversion operators to convert the type of an argument to the type of its corresponding parameter.</span></span>  
  
 <span data-ttu-id="697a2-107">Si vous passez l’argument [ByRef](../language-reference/modifiers/byref.md), Visual Basic copie parfois la valeur de l’argument dans une variable locale de la procédure au lieu de passer une référence.</span><span class="sxs-lookup"><span data-stu-id="697a2-107">If you pass the argument [ByRef](../language-reference/modifiers/byref.md), Visual Basic sometimes copies the argument value into a local variable in the procedure instead of passing a reference.</span></span> <span data-ttu-id="697a2-108">Dans ce cas, quand la procédure est retournée, Visual Basic doit ensuite copier la valeur de la variable locale dans l’argument du code appelant.</span><span class="sxs-lookup"><span data-stu-id="697a2-108">In such a case, when the procedure returns, Visual Basic must then copy the local variable value back into the argument in the calling code.</span></span>  
  
 <span data-ttu-id="697a2-109">Si une valeur d’argument `ByRef` est copiée dans la procédure, et si l’argument et le paramètre sont du même type, aucune conversion n’est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="697a2-109">If a `ByRef` argument value is copied into the procedure and the argument and parameter are of the same type, no conversion is necessary.</span></span> <span data-ttu-id="697a2-110">Toutefois, si les types sont différents, Visual Basic doit effectuer une conversion dans les deux directions.</span><span class="sxs-lookup"><span data-stu-id="697a2-110">But if the types are different, Visual Basic must convert in both directions.</span></span> <span data-ttu-id="697a2-111">Si l’un des types est votre type de classe ou de structure, Visual Basic devez le convertir vers et à partir de l’autre type.</span><span class="sxs-lookup"><span data-stu-id="697a2-111">If one of the types is your class or structure type, Visual Basic must convert it both to and from the other type.</span></span> <span data-ttu-id="697a2-112">Cela signifie que vous devez définir des opérateurs de conversion dans les deux sens.</span><span class="sxs-lookup"><span data-stu-id="697a2-112">This means you must define conversion operators in both directions.</span></span>  
  
 <span data-ttu-id="697a2-113">**ID d’erreur :** BC33037</span><span class="sxs-lookup"><span data-stu-id="697a2-113">**Error ID:** BC33037</span></span>  
  
## <a name="to-correct-this-error"></a><span data-ttu-id="697a2-114">Pour corriger cette erreur</span><span class="sxs-lookup"><span data-stu-id="697a2-114">To correct this error</span></span>  
  
- <span data-ttu-id="697a2-115">Si possible, utilisez un argument d’appel du même type que le paramètre de procédure, afin Visual Basic n’a pas besoin d’effectuer de conversion.</span><span class="sxs-lookup"><span data-stu-id="697a2-115">If possible, use a calling argument of the same type as the procedure parameter, so Visual Basic does not need to do any conversion.</span></span>  
  
- <span data-ttu-id="697a2-116">Si vous devez appeler la procédure avec un type d’argument différent du type de paramètre, mais n’avez pas besoin de retourner une valeur dans l’argument d’appel, définissez le paramètre sur [ByVal](../language-reference/modifiers/byval.md) au lieu de `ByRef`.</span><span class="sxs-lookup"><span data-stu-id="697a2-116">If you need to call the procedure with an argument type different from the parameter type but do not need to return a value into the calling argument, define the parameter to be [ByVal](../language-reference/modifiers/byval.md) instead of `ByRef`.</span></span>  
  
- <span data-ttu-id="697a2-117">Si vous avez besoin de retourner une valeur dans l’argument d’appel, définissez l’opérateur de conversion inverse pour Visual Basic pouvez reconvertir en type d’argument appelant.</span><span class="sxs-lookup"><span data-stu-id="697a2-117">If you need to return a value into the calling argument, define the reverse conversion operator so Visual Basic can convert back to the calling argument type.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="697a2-118">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="697a2-118">See also</span></span>

- [<span data-ttu-id="697a2-119">Procédures</span><span class="sxs-lookup"><span data-stu-id="697a2-119">Procedures</span></span>](../programming-guide/language-features/procedures/index.md)
- [<span data-ttu-id="697a2-120">Paramètres et arguments d’une procédure</span><span class="sxs-lookup"><span data-stu-id="697a2-120">Procedure Parameters and Arguments</span></span>](../programming-guide/language-features/procedures/procedure-parameters-and-arguments.md)
- [<span data-ttu-id="697a2-121">Passage des arguments par valeur et par référence</span><span class="sxs-lookup"><span data-stu-id="697a2-121">Passing Arguments by Value and by Reference</span></span>](../programming-guide/language-features/procedures/passing-arguments-by-value-and-by-reference.md)
- [<span data-ttu-id="697a2-122">Procédures d'opérateur</span><span class="sxs-lookup"><span data-stu-id="697a2-122">Operator Procedures</span></span>](../programming-guide/language-features/procedures/operator-procedures.md)
- [<span data-ttu-id="697a2-123">Operator Statement</span><span class="sxs-lookup"><span data-stu-id="697a2-123">Operator Statement</span></span>](../language-reference/statements/operator-statement.md)
- [<span data-ttu-id="697a2-124">Comment : définir un opérateur</span><span class="sxs-lookup"><span data-stu-id="697a2-124">How to: Define an Operator</span></span>](../programming-guide/language-features/procedures/how-to-define-an-operator.md)
- [<span data-ttu-id="697a2-125">Guide pratique : définir un opérateur de conversion</span><span class="sxs-lookup"><span data-stu-id="697a2-125">How to: Define a Conversion Operator</span></span>](../programming-guide/language-features/procedures/how-to-define-a-conversion-operator.md)

---
title: Clé
ms.date: 07/20/2015
f1_keywords:
- vb.AnonymousKey
helpviewer_keywords:
- anonymous types [Visual Basic], key
- Key [Visual Basic]
- Key keyword [Visual Basic]
ms.assetid: 7697a928-7d14-4430-a72a-c9e96e8d6c11
ms.openlocfilehash: 92c8809779d6cab524f67ee47f355b72ab152403
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/22/2019
ms.locfileid: "74351517"
---
# <a name="key-visual-basic"></a><span data-ttu-id="c6992-102">Key (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="c6992-102">Key (Visual Basic)</span></span>
<span data-ttu-id="c6992-103">Le mot clé `Key` vous permet de spécifier le comportement des propriétés de types anonymes.</span><span class="sxs-lookup"><span data-stu-id="c6992-103">The `Key` keyword enables you to specify behavior for properties of anonymous types.</span></span> <span data-ttu-id="c6992-104">Seules les propriétés que vous désignez en tant que propriétés de clé participent aux tests d’égalité entre les instances de type anonyme ou le calcul des valeurs de code de hachage.</span><span class="sxs-lookup"><span data-stu-id="c6992-104">Only properties you designate as key properties participate in tests of equality between anonymous type instances, or calculation of hash code values.</span></span> <span data-ttu-id="c6992-105">Les valeurs des propriétés de clé ne peuvent pas être modifiées.</span><span class="sxs-lookup"><span data-stu-id="c6992-105">The values of key properties cannot be changed.</span></span>  
  
 <span data-ttu-id="c6992-106">Vous désignez une propriété d’un type anonyme en tant que propriété de clé en plaçant le mot clé `Key` devant sa déclaration dans la liste d’initialisation.</span><span class="sxs-lookup"><span data-stu-id="c6992-106">You designate a property of an anonymous type as a key property by placing the keyword `Key` in front of its declaration in the initialization list.</span></span> <span data-ttu-id="c6992-107">Dans l’exemple suivant, `Airline` et `FlightNo` sont des propriétés de clé, mais `Gate` ne l’est pas.</span><span class="sxs-lookup"><span data-stu-id="c6992-107">In the following example, `Airline` and `FlightNo` are key properties, but `Gate` is not.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#26](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#26)]  
  
 <span data-ttu-id="c6992-108">Lorsqu’un nouveau type anonyme est créé, il hérite directement de <xref:System.Object>.</span><span class="sxs-lookup"><span data-stu-id="c6992-108">When a new anonymous type is created, it inherits directly from <xref:System.Object>.</span></span> <span data-ttu-id="c6992-109">Le compilateur remplace trois membres hérités : <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>et <xref:System.Object.ToString%2A>.</span><span class="sxs-lookup"><span data-stu-id="c6992-109">The compiler overrides three inherited members: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="c6992-110">Le code de substitution produit pour <xref:System.Object.Equals%2A> et <xref:System.Object.GetHashCode%2A> est basé sur les propriétés de clé.</span><span class="sxs-lookup"><span data-stu-id="c6992-110">The override code that is produced for <xref:System.Object.Equals%2A> and <xref:System.Object.GetHashCode%2A> is based on key properties.</span></span> <span data-ttu-id="c6992-111">S’il n’existe aucune propriété de clé dans le type, <xref:System.Object.GetHashCode%2A> et <xref:System.Object.Equals%2A> ne sont pas substitués.</span><span class="sxs-lookup"><span data-stu-id="c6992-111">If there are no key properties in the type, <xref:System.Object.GetHashCode%2A> and <xref:System.Object.Equals%2A> are not overridden.</span></span>  
  
## <a name="equality"></a><span data-ttu-id="c6992-112">Égalité</span><span class="sxs-lookup"><span data-stu-id="c6992-112">Equality</span></span>  
 <span data-ttu-id="c6992-113">Deux instances de type anonyme sont égales si elles sont des instances du même type et si les valeurs de leurs propriétés de clé sont égales.</span><span class="sxs-lookup"><span data-stu-id="c6992-113">Two anonymous type instances are equal if they are instances of the same type and if the values of their key properties are equal.</span></span> <span data-ttu-id="c6992-114">Dans les exemples suivants, `flight2` est égal à `flight1` de l’exemple précédent parce qu’il s’agit d’instances du même type anonyme et qu’elles ont des valeurs correspondantes pour leurs propriétés de clé.</span><span class="sxs-lookup"><span data-stu-id="c6992-114">In the following examples, `flight2` is equal to `flight1` from the previous example because they are instances of the same anonymous type and they have matching values for their key properties.</span></span> <span data-ttu-id="c6992-115">Toutefois, `flight3` n’est pas égal à `flight1`, car elle a une valeur différente pour une propriété de clé, `FlightNo`.</span><span class="sxs-lookup"><span data-stu-id="c6992-115">However, `flight3` is not equal to `flight1` because it has a different value for a key property, `FlightNo`.</span></span> <span data-ttu-id="c6992-116">L' `flight4` d’instance n’est pas du même type que `flight1`, car ils désignent des propriétés différentes en tant que propriétés de clé.</span><span class="sxs-lookup"><span data-stu-id="c6992-116">Instance `flight4` is not the same type as `flight1` because they designate different properties as key properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#27](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#27)]  
  
 <span data-ttu-id="c6992-117">Si deux instances sont déclarées avec uniquement des propriétés non-clés, identiques dans le nom, le type, l’ordre et la valeur, les deux instances ne sont pas égales.</span><span class="sxs-lookup"><span data-stu-id="c6992-117">If two instances are declared with only non-key properties, identical in name, type, order, and value, the two instances are not equal.</span></span> <span data-ttu-id="c6992-118">Une instance sans propriétés de clé est uniquement égale à elle-même.</span><span class="sxs-lookup"><span data-stu-id="c6992-118">An instance without key properties is equal only to itself.</span></span>  
  
 <span data-ttu-id="c6992-119">Pour plus d’informations sur les conditions dans lesquelles deux instances de type anonyme sont des instances du même type anonyme, consultez [types anonymes](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md).</span><span class="sxs-lookup"><span data-stu-id="c6992-119">For more information about the conditions under which two anonymous type instances are instances of the same anonymous type, see [Anonymous Types](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md).</span></span>  
  
## <a name="hash-code-calculation"></a><span data-ttu-id="c6992-120">Calcul du code de hachage</span><span class="sxs-lookup"><span data-stu-id="c6992-120">Hash Code Calculation</span></span>  
 <span data-ttu-id="c6992-121">Comme <xref:System.Object.Equals%2A>, la fonction de hachage définie dans <xref:System.Object.GetHashCode%2A> pour un type anonyme est basée sur les propriétés de clé du type.</span><span class="sxs-lookup"><span data-stu-id="c6992-121">Like <xref:System.Object.Equals%2A>, the hash function that is defined in <xref:System.Object.GetHashCode%2A> for an anonymous type is based on the key properties of the type.</span></span> <span data-ttu-id="c6992-122">Les exemples suivants illustrent l’interaction entre les propriétés de clé et les valeurs de code de hachage.</span><span class="sxs-lookup"><span data-stu-id="c6992-122">The following examples show the interaction between key properties and hash code values.</span></span>  
  
 <span data-ttu-id="c6992-123">Les instances d’un type anonyme qui ont les mêmes valeurs pour toutes les propriétés de clé ont la même valeur de code de hachage, même si les propriétés non-clés n’ont pas de valeurs correspondantes.</span><span class="sxs-lookup"><span data-stu-id="c6992-123">Instances of an anonymous type that have the same values for all key properties have the same hash code value, even if non-key properties do not have matching values.</span></span> <span data-ttu-id="c6992-124">L’instruction suivante retourne `True`.</span><span class="sxs-lookup"><span data-stu-id="c6992-124">The following statement returns `True`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#37](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#37)]  
  
 <span data-ttu-id="c6992-125">Les instances d’un type anonyme qui ont des valeurs différentes pour une ou plusieurs propriétés de clé ont des valeurs de code de hachage différentes.</span><span class="sxs-lookup"><span data-stu-id="c6992-125">Instances of an anonymous type that have different values for one or more key properties have different hash code values.</span></span> <span data-ttu-id="c6992-126">L’instruction suivante retourne `False`.</span><span class="sxs-lookup"><span data-stu-id="c6992-126">The following statement returns `False`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#38](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#38)]  
  
 <span data-ttu-id="c6992-127">Les instances de types anonymes qui désignent des propriétés différentes en tant que propriétés de clé ne sont pas des instances du même type.</span><span class="sxs-lookup"><span data-stu-id="c6992-127">Instances of anonymous types that designate different properties as key properties are not instances of the same type.</span></span> <span data-ttu-id="c6992-128">Elles ont des valeurs de code de hachage différentes, même lorsque les noms et les valeurs de toutes les propriétés sont identiques.</span><span class="sxs-lookup"><span data-stu-id="c6992-128">They have different hash code values even when the names and values of all properties are the same.</span></span> <span data-ttu-id="c6992-129">L’instruction suivante retourne `False`.</span><span class="sxs-lookup"><span data-stu-id="c6992-129">The following statement returns `False`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#39](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#39)]  
  
## <a name="read-only-values"></a><span data-ttu-id="c6992-130">Valeurs en lecture seule</span><span class="sxs-lookup"><span data-stu-id="c6992-130">Read-Only Values</span></span>  
 <span data-ttu-id="c6992-131">Les valeurs des propriétés de clé ne peuvent pas être modifiées.</span><span class="sxs-lookup"><span data-stu-id="c6992-131">The values of key properties cannot be changed.</span></span> <span data-ttu-id="c6992-132">Par exemple, dans `flight1` dans les exemples précédents, les champs `Airline` et `FlightNo` sont en lecture seule, mais `Gate` peuvent être modifiés.</span><span class="sxs-lookup"><span data-stu-id="c6992-132">For example, in `flight1` in the earlier examples, the `Airline` and `FlightNo` fields are read-only, but `Gate` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#28](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#28)]  
  
## <a name="see-also"></a><span data-ttu-id="c6992-133">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c6992-133">See also</span></span>

- [<span data-ttu-id="c6992-134">Définition du type anonyme</span><span class="sxs-lookup"><span data-stu-id="c6992-134">Anonymous Type Definition</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-type-definition.md)
- [<span data-ttu-id="c6992-135">Guide pratique : déduire les types et les noms de propriétés dans des déclarations de types anonymes</span><span class="sxs-lookup"><span data-stu-id="c6992-135">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)
- [<span data-ttu-id="c6992-136">Types anonymes</span><span class="sxs-lookup"><span data-stu-id="c6992-136">Anonymous Types</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/anonymous-types.md)

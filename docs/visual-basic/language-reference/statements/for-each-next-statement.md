---
title: For Each...Next, instruction (Visual Basic)
ms.date: 07/20/2015
f1_keywords:
- vb.ForEach
- vb.ForEachNext
- vb.Each
- ForEachNext
helpviewer_keywords:
- infinite loops
- Next statement [Visual Basic], For Each...Next
- endless loops
- loop structures [Visual Basic], For Each...Next
- loops, endless
- Each keyword [Visual Basic]
- instructions, repeating
- For Each statement [Visual Basic]
- collections, instruction repetition
- loops, infinite
- For Each...Next statements
- For keyword [Visual Basic], For Each...Next statements
- Exit statement [Visual Basic], For Each...Next statements
- iteration
ms.assetid: ebce3120-95c3-42b1-b70b-fa7da40c75e2
ms.openlocfilehash: ebfd05a39c290e379bea2b925e7ea30c40d303fe
ms.sourcegitcommit: 581ab03291e91983459e56e40ea8d97b5189227e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/27/2019
ms.locfileid: "70046319"
---
# <a name="for-eachnext-statement-visual-basic"></a><span data-ttu-id="8821a-102">For Each...Next, instruction (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="8821a-102">For Each...Next Statement (Visual Basic)</span></span>

<span data-ttu-id="8821a-103">Répète un groupe d’instructions pour chaque élément d’une collection.</span><span class="sxs-lookup"><span data-stu-id="8821a-103">Repeats a group of statements for each element in a collection.</span></span>

## <a name="syntax"></a><span data-ttu-id="8821a-104">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="8821a-104">Syntax</span></span>

```
For Each element [ As datatype ] In group
    [ statements ]
    [ Continue For ]
    [ statements ]
    [ Exit For ]
    [ statements ]
Next [ element ]
```

## <a name="parts"></a><span data-ttu-id="8821a-105">Composants</span><span class="sxs-lookup"><span data-stu-id="8821a-105">Parts</span></span>

|<span data-ttu-id="8821a-106">Terme</span><span class="sxs-lookup"><span data-stu-id="8821a-106">Term</span></span>|<span data-ttu-id="8821a-107">Définition</span><span class="sxs-lookup"><span data-stu-id="8821a-107">Definition</span></span>|
|---|---|
|`element`|<span data-ttu-id="8821a-108">Obligatoire dans l' `For Each` instruction.</span><span class="sxs-lookup"><span data-stu-id="8821a-108">Required in the `For Each` statement.</span></span> <span data-ttu-id="8821a-109">Facultatif dans l' `Next` instruction.</span><span class="sxs-lookup"><span data-stu-id="8821a-109">Optional in the `Next` statement.</span></span> <span data-ttu-id="8821a-110">Variable.</span><span class="sxs-lookup"><span data-stu-id="8821a-110">Variable.</span></span> <span data-ttu-id="8821a-111">Utilisé pour itérer au sein des éléments de la collection.</span><span class="sxs-lookup"><span data-stu-id="8821a-111">Used to iterate through the elements of the collection.</span></span>|
|`datatype`|<span data-ttu-id="8821a-112">Facultatif si [`Option Infer`](option-infer-statement.md) est activé (valeur par défaut) `element` ou si est déjà déclaré ; `Option Infer` obligatoire si est `element` désactivé et n’est pas déjà déclaré.</span><span class="sxs-lookup"><span data-stu-id="8821a-112">Optional if [`Option Infer`](option-infer-statement.md) is on (the default) or `element` is already declared; required if `Option Infer` is off and `element` isn't already declared.</span></span> <span data-ttu-id="8821a-113">Type de données de l' `element`.</span><span class="sxs-lookup"><span data-stu-id="8821a-113">The data type of `element`.</span></span>|
|`group`|<span data-ttu-id="8821a-114">Requis.</span><span class="sxs-lookup"><span data-stu-id="8821a-114">Required.</span></span> <span data-ttu-id="8821a-115">Variable avec un type qui est un type de collection ou un objet.</span><span class="sxs-lookup"><span data-stu-id="8821a-115">A variable with a type that's a collection type or Object.</span></span> <span data-ttu-id="8821a-116">Fait référence à la collection sur laquelle `statements` le doit être répété.</span><span class="sxs-lookup"><span data-stu-id="8821a-116">Refers to the collection over which the `statements` are to be repeated.</span></span>|
|`statements`|<span data-ttu-id="8821a-117">facultatif.</span><span class="sxs-lookup"><span data-stu-id="8821a-117">Optional.</span></span> <span data-ttu-id="8821a-118">Une ou plusieurs instructions entre `For Each` et `Next` qui s’exécutent sur chaque `group`élément dans.</span><span class="sxs-lookup"><span data-stu-id="8821a-118">One or more statements between `For Each` and `Next` that run on each item in `group`.</span></span>|
|`Continue For`|<span data-ttu-id="8821a-119">facultatif.</span><span class="sxs-lookup"><span data-stu-id="8821a-119">Optional.</span></span> <span data-ttu-id="8821a-120">Transfère le contrôle au début de la `For Each` boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-120">Transfers control to the start of the `For Each` loop.</span></span>|
|`Exit For`|<span data-ttu-id="8821a-121">facultatif.</span><span class="sxs-lookup"><span data-stu-id="8821a-121">Optional.</span></span> <span data-ttu-id="8821a-122">Transfère le contrôle hors de `For Each` la boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-122">Transfers control out of the `For Each` loop.</span></span>|
|`Next`|<span data-ttu-id="8821a-123">Requis.</span><span class="sxs-lookup"><span data-stu-id="8821a-123">Required.</span></span> <span data-ttu-id="8821a-124">Termine la définition de la `For Each` boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-124">Terminates the definition of the `For Each` loop.</span></span>|

## <a name="simple-example"></a><span data-ttu-id="8821a-125">Exemple simple</span><span class="sxs-lookup"><span data-stu-id="8821a-125">Simple Example</span></span>

<span data-ttu-id="8821a-126">Utiliser une `For Each`... `Next` boucle lorsque vous souhaitez répéter un ensemble d’instructions pour chaque élément d’une collection ou d’un tableau.</span><span class="sxs-lookup"><span data-stu-id="8821a-126">Use a `For Each`...`Next` loop when you want to repeat a set of statements for each element of a collection or array.</span></span>

> [!TIP]
> <span data-ttu-id="8821a-127">[Pour... L’instruction suivante](../../../visual-basic/language-reference/statements/for-next-statement.md) fonctionne bien lorsque vous pouvez associer chaque itération d’une boucle à une variable de contrôle et déterminer les valeurs initiale et finale de cette variable.</span><span class="sxs-lookup"><span data-stu-id="8821a-127">A [For...Next Statement](../../../visual-basic/language-reference/statements/for-next-statement.md) works well when you can associate each iteration of a loop with a control variable and determine that variable's initial and final values.</span></span> <span data-ttu-id="8821a-128">Toutefois, lorsque vous travaillez avec une collection, le concept de valeurs initiales et finales n’est pas significatif et vous ne connaissez pas nécessairement le nombre d’éléments de la collection.</span><span class="sxs-lookup"><span data-stu-id="8821a-128">However, when you are dealing with a collection, the concept of initial and final values isn't meaningful, and you don't necessarily know how many elements the collection has.</span></span> <span data-ttu-id="8821a-129">Dans ce genre de cas, une `For Each`... `Next` la boucle est souvent un meilleur choix.</span><span class="sxs-lookup"><span data-stu-id="8821a-129">In this kind of case, a `For Each`...`Next` loop is often a better choice.</span></span>

<span data-ttu-id="8821a-130">Dans l’exemple suivant, le `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="8821a-130">In the following example, the `For Each`…`Next`</span></span> <span data-ttu-id="8821a-131">l’instruction itère au sein de tous les éléments d’une collection de listes.</span><span class="sxs-lookup"><span data-stu-id="8821a-131">statement iterates through all the elements of a List collection.</span></span>

[!code-vb[VbVbalrStatements#121](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#121)]

<span data-ttu-id="8821a-132">Pour obtenir plus d’exemples, consultez [Collections](../../../standard/collections/index.md) et [tableaux](../../../visual-basic/programming-guide/language-features/arrays/index.md).</span><span class="sxs-lookup"><span data-stu-id="8821a-132">For more examples, see [Collections](../../../standard/collections/index.md) and [Arrays](../../../visual-basic/programming-guide/language-features/arrays/index.md).</span></span>

## <a name="nested-loops"></a><span data-ttu-id="8821a-133">Boucles imbriquées</span><span class="sxs-lookup"><span data-stu-id="8821a-133">Nested Loops</span></span>

<span data-ttu-id="8821a-134">Vous pouvez imbriquer `For Each` des boucles en plaçant une boucle dans une autre.</span><span class="sxs-lookup"><span data-stu-id="8821a-134">You can nest `For Each` loops by putting one loop within another.</span></span>

<span data-ttu-id="8821a-135">L’exemple suivant illustre l’imbrication `For Each`de...`Next`</span><span class="sxs-lookup"><span data-stu-id="8821a-135">The following example demonstrates nested `For Each`…`Next`</span></span> <span data-ttu-id="8821a-136">celles.</span><span class="sxs-lookup"><span data-stu-id="8821a-136">structures.</span></span>

[!code-vb[VbVbalrStatements#122](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#122)]

<span data-ttu-id="8821a-137">Lorsque vous imbriquez des boucles, chaque boucle doit `element` avoir une variable unique.</span><span class="sxs-lookup"><span data-stu-id="8821a-137">When you nest loops, each loop must have a unique `element` variable.</span></span>

<span data-ttu-id="8821a-138">Vous pouvez également imbriquer différents genres de structures de contrôle dans les deux.</span><span class="sxs-lookup"><span data-stu-id="8821a-138">You can also nest different kinds of control structures within each other.</span></span> <span data-ttu-id="8821a-139">Pour plus d’informations, consultez [structures de contrôle imbriquées](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).</span><span class="sxs-lookup"><span data-stu-id="8821a-139">For more information, see [Nested Control Structures](../../../visual-basic/programming-guide/language-features/control-flow/nested-control-structures.md).</span></span>

## <a name="exit-for-and-continue-for"></a><span data-ttu-id="8821a-140">Quitter pour et continuer pour</span><span class="sxs-lookup"><span data-stu-id="8821a-140">Exit For and Continue For</span></span>

<span data-ttu-id="8821a-141">L’instruction [Exit for](../../../visual-basic/language-reference/statements/exit-statement.md) provoque l’arrêt de l' `For`exécution de...`Next`</span><span class="sxs-lookup"><span data-stu-id="8821a-141">The [Exit For](../../../visual-basic/language-reference/statements/exit-statement.md) statement causes execution to exit the `For`…`Next`</span></span> <span data-ttu-id="8821a-142">effectue une boucle et transfère le contrôle à l’instruction `Next` qui suit l’instruction.</span><span class="sxs-lookup"><span data-stu-id="8821a-142">loop and transfers control to the statement that follows the `Next` statement.</span></span>

<span data-ttu-id="8821a-143">L' `Continue For` instruction transfère immédiatement le contrôle à l’itération suivante de la boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-143">The `Continue For` statement transfers control immediately to the next iteration of the loop.</span></span> <span data-ttu-id="8821a-144">Pour plus d’informations, consultez [instruction continue](../../../visual-basic/language-reference/statements/continue-statement.md).</span><span class="sxs-lookup"><span data-stu-id="8821a-144">For more information, see [Continue Statement](../../../visual-basic/language-reference/statements/continue-statement.md).</span></span>

<span data-ttu-id="8821a-145">L’exemple suivant montre comment utiliser les `Continue For` instructions et. `Exit For`</span><span class="sxs-lookup"><span data-stu-id="8821a-145">The following example shows how to use the `Continue For` and `Exit For` statements.</span></span>

[!code-vb[VbVbalrStatements#123](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#123)]

<span data-ttu-id="8821a-146">Vous pouvez placer n’importe quel `Exit For` nombre d’instructions `For Each` dans une boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-146">You can put any number of `Exit For` statements in a `For Each` loop.</span></span> <span data-ttu-id="8821a-147">Lorsqu’il est utilisé dans `For Each` les boucles `Exit For` imbriquées, l’exécution quitte la boucle la plus profonde et transfère le contrôle au niveau d’imbrication supérieur suivant.</span><span class="sxs-lookup"><span data-stu-id="8821a-147">When used within nested `For Each` loops, `Exit For` causes execution to exit the innermost loop and transfers control to the next higher level of nesting.</span></span>

<span data-ttu-id="8821a-148">`Exit For`est souvent utilisé après une évaluation d’une condition, par exemple dans un `If`... `Then`... `Else` structure.</span><span class="sxs-lookup"><span data-stu-id="8821a-148">`Exit For` is often used after an evaluation of some condition, for example, in an `If`...`Then`...`Else` structure.</span></span> <span data-ttu-id="8821a-149">Vous pouvez utiliser `Exit For` pour les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="8821a-149">You might want to use `Exit For` for the following conditions:</span></span>

- <span data-ttu-id="8821a-150">La poursuite de l’itération est inutile ou impossible.</span><span class="sxs-lookup"><span data-stu-id="8821a-150">Continuing to iterate is unnecessary or impossible.</span></span> <span data-ttu-id="8821a-151">Cela peut être dû à une valeur erronée ou à une demande d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="8821a-151">This might be caused by an erroneous value or a termination request.</span></span>

- <span data-ttu-id="8821a-152">Une exception est interceptée dans `Try`... `Catch`... `Finally`. Vous pouvez utiliser `Exit For` à la fin `Finally` du bloc.</span><span class="sxs-lookup"><span data-stu-id="8821a-152">An exception is caught in a `Try`...`Catch`...`Finally`. You might use `Exit For` at the end of the `Finally` block.</span></span>

- <span data-ttu-id="8821a-153">Il s’agit d’une boucle sans fin, qui est une boucle qui peut exécuter un nombre de fois très long, voire infini.</span><span class="sxs-lookup"><span data-stu-id="8821a-153">There an endless loop, which is a loop that could run a large or even infinite number of times.</span></span> <span data-ttu-id="8821a-154">Si vous détectez une telle condition, vous pouvez `Exit For` utiliser pour échapper la boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-154">If you detect such a condition, you can use `Exit For` to escape the loop.</span></span> <span data-ttu-id="8821a-155">Pour plus d’informations, consultez [do... Instruction de boucle](../../../visual-basic/language-reference/statements/do-loop-statement.md).</span><span class="sxs-lookup"><span data-stu-id="8821a-155">For more information, see [Do...Loop Statement](../../../visual-basic/language-reference/statements/do-loop-statement.md).</span></span>

## <a name="iterators"></a><span data-ttu-id="8821a-156">Iterators</span><span class="sxs-lookup"><span data-stu-id="8821a-156">Iterators</span></span>

<span data-ttu-id="8821a-157">Vous utilisez un *itérateur* pour exécuter une itération personnalisée sur une collection.</span><span class="sxs-lookup"><span data-stu-id="8821a-157">You use an *iterator* to perform a custom iteration over a collection.</span></span> <span data-ttu-id="8821a-158">Un itérateur peut être une fonction ou un `Get` accesseur.</span><span class="sxs-lookup"><span data-stu-id="8821a-158">An iterator can be a function or a `Get` accessor.</span></span> <span data-ttu-id="8821a-159">Elle utilise une `Yield` instruction pour retourner chaque élément de la collection un par un.</span><span class="sxs-lookup"><span data-stu-id="8821a-159">It uses a `Yield` statement to return each element of the collection one at a time.</span></span>

<span data-ttu-id="8821a-160">Vous appelez un itérateur à l’aide `For Each...Next` d’une instruction.</span><span class="sxs-lookup"><span data-stu-id="8821a-160">You call an iterator by using a `For Each...Next` statement.</span></span> <span data-ttu-id="8821a-161">Chaque itération de la boucle `For Each` appelle l’itérateur.</span><span class="sxs-lookup"><span data-stu-id="8821a-161">Each iteration of the `For Each` loop calls the iterator.</span></span> <span data-ttu-id="8821a-162">Quand une `Yield` instruction est atteinte dans l’itérateur, l’expression dans l' `Yield` instruction est retournée, et l’emplacement actuel dans le code est conservé.</span><span class="sxs-lookup"><span data-stu-id="8821a-162">When a `Yield` statement is reached in the iterator, the expression in the `Yield` statement is returned, and the current location in code is retained.</span></span> <span data-ttu-id="8821a-163">L’exécution est redémarrée à partir de cet emplacement la prochaine fois que l’itérateur est appelé.</span><span class="sxs-lookup"><span data-stu-id="8821a-163">Execution is restarted from that location the next time that the iterator is called.</span></span>

<span data-ttu-id="8821a-164">L’exemple suivant utilise une fonction d’itérateur.</span><span class="sxs-lookup"><span data-stu-id="8821a-164">The following example uses an iterator function.</span></span> <span data-ttu-id="8821a-165">La fonction Iterator a une `Yield` instruction qui se trouve à l’intérieur d’une instruction [for... Next](../../../visual-basic/language-reference/statements/for-next-statement.md) .</span><span class="sxs-lookup"><span data-stu-id="8821a-165">The iterator function has a `Yield` statement that's inside a [For…Next](../../../visual-basic/language-reference/statements/for-next-statement.md) loop.</span></span> <span data-ttu-id="8821a-166">Dans la `ListEvenNumbers` méthode, chaque itération `For Each` du corps d’instruction crée un appel à la fonction d’itérateur, qui passe à l' `Yield` instruction suivante.</span><span class="sxs-lookup"><span data-stu-id="8821a-166">In the `ListEvenNumbers` method, each iteration of the `For Each` statement body creates a call to the iterator function, which proceeds to the next `Yield` statement.</span></span>

[!code-vb[VbVbalrStatements#127](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#127)]

<span data-ttu-id="8821a-167">Pour plus d’informations, consultez [itérateurs](../../programming-guide/concepts/iterators.md), [instruction yield](../../../visual-basic/language-reference/statements/yield-statement.md)et [iterator](../../../visual-basic/language-reference/modifiers/iterator.md).</span><span class="sxs-lookup"><span data-stu-id="8821a-167">For more information, see [Iterators](../../programming-guide/concepts/iterators.md), [Yield Statement](../../../visual-basic/language-reference/statements/yield-statement.md), and [Iterator](../../../visual-basic/language-reference/modifiers/iterator.md).</span></span>

## <a name="technical-implementation"></a><span data-ttu-id="8821a-168">Implémentation technique</span><span class="sxs-lookup"><span data-stu-id="8821a-168">Technical Implementation</span></span>

<span data-ttu-id="8821a-169">Quand un `For Each`...`Next`</span><span class="sxs-lookup"><span data-stu-id="8821a-169">When a `For Each`…`Next`</span></span> <span data-ttu-id="8821a-170">l’instruction s’exécute, Visual Basic évalue la collection une seule fois, avant le démarrage de la boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-170">statement runs, Visual Basic evaluates the collection only one time, before the loop starts.</span></span> <span data-ttu-id="8821a-171">Si votre bloc d’instructions `element` change `group`ou, ces modifications n’affectent pas l’itération de la boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-171">If your statement block changes `element` or `group`, these changes don't affect the iteration of the loop.</span></span>

<span data-ttu-id="8821a-172">Lorsque tous les éléments de la collection ont été assignés successivement à `element`, la `For Each` boucle s’arrête et le contrôle passe à l’instruction `Next` qui suit l’instruction.</span><span class="sxs-lookup"><span data-stu-id="8821a-172">When all the elements in the collection have been successively assigned to `element`, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span>

<span data-ttu-id="8821a-173">Si l' [Option Infer](option-infer-statement.md) est définie sur on (paramètre par défaut), le compilateur Visual Basic peut déduire `element`le type de données de.</span><span class="sxs-lookup"><span data-stu-id="8821a-173">If [Option Infer](option-infer-statement.md) is on (its default setting), the Visual Basic compiler can infer the data type of `element`.</span></span> <span data-ttu-id="8821a-174">Si elle est désactivée et `element` n’a pas été déclarée en dehors de la boucle, vous devez la déclarer dans l' `For Each` instruction.</span><span class="sxs-lookup"><span data-stu-id="8821a-174">If it is off and `element` hasn't been declared outside the loop, you must declare it in the `For Each` statement.</span></span> <span data-ttu-id="8821a-175">Pour déclarer explicitement le type de `element` données, utilisez une `As` clause.</span><span class="sxs-lookup"><span data-stu-id="8821a-175">To declare the data type of `element` explicitly, use an `As` clause.</span></span> <span data-ttu-id="8821a-176">À moins que le type de données de l’élément `For Each`ne soit défini en dehors de... `Next` construit, sa portée est le corps de la boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-176">Unless the data type of element is defined outside the `For Each`...`Next` construct, its scope is the body of the loop.</span></span> <span data-ttu-id="8821a-177">Notez que vous ne pouvez `element` pas déclarer à la fois à l’extérieur et à l’intérieur de la boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-177">Note that you cannot declare `element` both outside and inside the loop.</span></span>

<span data-ttu-id="8821a-178">Vous pouvez éventuellement spécifier `element` dans l' `Next` instruction.</span><span class="sxs-lookup"><span data-stu-id="8821a-178">You can optionally specify `element` in the `Next` statement.</span></span> <span data-ttu-id="8821a-179">Cela améliore la lisibilité de votre programme, en particulier si vous avez des `For Each` boucles imbriquées.</span><span class="sxs-lookup"><span data-stu-id="8821a-179">This improves the readability of your program, especially if you have nested `For Each` loops.</span></span> <span data-ttu-id="8821a-180">Vous devez spécifier la même variable que celle qui apparaît dans l’instruction correspondante `For Each` .</span><span class="sxs-lookup"><span data-stu-id="8821a-180">You must specify the same variable as the one that appears in the corresponding `For Each` statement.</span></span>

<span data-ttu-id="8821a-181">Vous souhaiterez peut-être éviter de modifier `element` la valeur de à l’intérieur d’une boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-181">You might want to avoid changing the value of `element` inside a loop.</span></span> <span data-ttu-id="8821a-182">Cela peut compliquer la lecture et le débogage de votre code.</span><span class="sxs-lookup"><span data-stu-id="8821a-182">Doing this can make it more difficult to read and debug your code.</span></span> <span data-ttu-id="8821a-183">La modification de la `group` valeur de n’affecte pas la collection ou ses éléments, qui ont été déterminés lors de la première entrée de la boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-183">Changing the value of `group` doesn't affect the collection or its elements, which were determined when the loop was first entered.</span></span>

<span data-ttu-id="8821a-184">Lorsque vous imbriquez des boucles, si `Next` une instruction d’un niveau d’imbrication externe est rencontrée `Next` avant le d’un niveau interne, le compilateur signale une erreur.</span><span class="sxs-lookup"><span data-stu-id="8821a-184">When you're nesting loops, if a `Next` statement of an outer nesting level is encountered before the `Next` of an inner level, the compiler signals an error.</span></span> <span data-ttu-id="8821a-185">Toutefois, le compilateur peut détecter cette erreur qui se chevauche uniquement `element` si vous `Next` spécifiez dans chaque instruction.</span><span class="sxs-lookup"><span data-stu-id="8821a-185">However, the compiler can detect this overlapping error only if you specify `element` in every `Next` statement.</span></span>

<span data-ttu-id="8821a-186">Si votre code dépend de la traversée d’une collection dans un ordre particulier `For Each`, une... `Next` la boucle n’est pas le meilleur choix, sauf si vous connaissez les caractéristiques de l’objet énumérateur que la collection expose.</span><span class="sxs-lookup"><span data-stu-id="8821a-186">If your code depends on traversing a collection in a particular order, a `For Each`...`Next` loop isn't the best choice, unless you know the characteristics of the enumerator object the collection exposes.</span></span> <span data-ttu-id="8821a-187">L’ordre de traversée n’est pas déterminé par Visual Basic, mais <xref:System.Collections.IEnumerator.MoveNext%2A> par la méthode de l’objet énumérateur.</span><span class="sxs-lookup"><span data-stu-id="8821a-187">The order of traversal isn't determined by Visual Basic, but by the <xref:System.Collections.IEnumerator.MoveNext%2A> method of the enumerator object.</span></span> <span data-ttu-id="8821a-188">Par conséquent, vous pouvez ne pas être en mesure de prédire quel élément de la collection est le premier `element`à retourner dans, ou qui est le suivant à retourner après un élément donné.</span><span class="sxs-lookup"><span data-stu-id="8821a-188">Therefore, you might not be able to predict which element of the collection is the first to be returned in `element`, or which is the next to be returned after a given element.</span></span> <span data-ttu-id="8821a-189">Vous pouvez obtenir des résultats plus fiables à l’aide d’une structure de `For`boucle différente, telle que... `Next` ou`Do`... `Loop`.</span><span class="sxs-lookup"><span data-stu-id="8821a-189">You might achieve more reliable results using a different loop structure, such as `For`...`Next` or `Do`...`Loop`.</span></span>

<span data-ttu-id="8821a-190">Le Runtime doit pouvoir convertir les éléments dans `group` `element`en.</span><span class="sxs-lookup"><span data-stu-id="8821a-190">The runtime must be able to convert the elements in `group` to `element`.</span></span> <span data-ttu-id="8821a-191">L’instruction`Option Strict`[] contrôle si les conversions étendues et restrictives sont autorisées (`Option Strict` est désactivé, sa valeur par défaut) ou si seules les conversions étendues sont autorisées`Option Strict` (est activé).</span><span class="sxs-lookup"><span data-stu-id="8821a-191">The [`Option Strict`] statement controls whether both widening and narrowing conversions are allowed (`Option Strict` is off, its default value), or whether only widening conversions are allowed (`Option Strict` is on).</span></span> <span data-ttu-id="8821a-192">Pour plus d’informations, consultez [conversions restrictives](#narrowing-conversions).</span><span class="sxs-lookup"><span data-stu-id="8821a-192">For more information, see [Narrowing conversions](#narrowing-conversions).</span></span>

<span data-ttu-id="8821a-193">Le type de données `group` de doit être un type référence qui fait référence à une collection ou à un tableau qui est énumérable.</span><span class="sxs-lookup"><span data-stu-id="8821a-193">The data type of `group` must be a reference type that refers to a collection or an array that's enumerable.</span></span> <span data-ttu-id="8821a-194">Cela signifie généralement que `group` fait référence à un objet qui implémente l' <xref:System.Collections.IEnumerable> interface de l' `System.Collections` espace de noms ou l' <xref:System.Collections.Generic.IEnumerable%601> interface `System.Collections.Generic` de l’espace de noms.</span><span class="sxs-lookup"><span data-stu-id="8821a-194">Most commonly this means that `group` refers to an object that implements the <xref:System.Collections.IEnumerable> interface of the `System.Collections` namespace or the <xref:System.Collections.Generic.IEnumerable%601> interface of the `System.Collections.Generic` namespace.</span></span> <span data-ttu-id="8821a-195">`System.Collections.IEnumerable`définit la <xref:System.Collections.IEnumerable.GetEnumerator%2A> méthode, qui retourne un objet énumérateur pour la collection.</span><span class="sxs-lookup"><span data-stu-id="8821a-195">`System.Collections.IEnumerable` defines the <xref:System.Collections.IEnumerable.GetEnumerator%2A> method, which returns an enumerator object for the collection.</span></span> <span data-ttu-id="8821a-196">L’objet énumérateur implémente l' `System.Collections.IEnumerator` interface de l' `System.Collections` espace de noms et expose la <xref:System.Collections.IEnumerator.Current%2A> propriété <xref:System.Collections.IEnumerator.Reset%2A> et <xref:System.Collections.IEnumerator.MoveNext%2A> les méthodes et.</span><span class="sxs-lookup"><span data-stu-id="8821a-196">The enumerator object implements the `System.Collections.IEnumerator` interface of the `System.Collections` namespace and exposes the <xref:System.Collections.IEnumerator.Current%2A> property and the <xref:System.Collections.IEnumerator.Reset%2A> and <xref:System.Collections.IEnumerator.MoveNext%2A> methods.</span></span> <span data-ttu-id="8821a-197">Visual Basic les utilise pour parcourir la collection.</span><span class="sxs-lookup"><span data-stu-id="8821a-197">Visual Basic uses these to traverse the collection.</span></span>

### <a name="narrowing-conversions"></a><span data-ttu-id="8821a-198">conversions restrictives</span><span class="sxs-lookup"><span data-stu-id="8821a-198">Narrowing Conversions</span></span>

<span data-ttu-id="8821a-199">Lorsque `Option Strict` a la `On`valeur, les conversions restrictives provoquent normalement des erreurs de compilation.</span><span class="sxs-lookup"><span data-stu-id="8821a-199">When `Option Strict` is set to `On`, narrowing conversions ordinarily cause compiler errors.</span></span> <span data-ttu-id="8821a-200">Toutefois, `For Each` dans une instruction, les conversions des éléments dans `group` vers `element` sont évaluées et exécutées au moment de l’exécution, et les erreurs du compilateur provoquées par les conversions restrictives sont supprimées.</span><span class="sxs-lookup"><span data-stu-id="8821a-200">In a `For Each` statement, however, conversions from the elements in `group` to `element` are evaluated and performed at run time, and compiler errors caused by narrowing conversions are suppressed.</span></span>

<span data-ttu-id="8821a-201">Dans l’exemple suivant, l’assignation de `m` comme valeur initiale pour `n` ne se compile pas `Option Strict` lorsque est `Integer` activé, car la conversion `Long` d’un en est une conversion restrictive.</span><span class="sxs-lookup"><span data-stu-id="8821a-201">In the following example, the assignment of `m` as the initial value for `n` doesn't compile when `Option Strict` is on because the conversion of a `Long` to an `Integer` is a narrowing conversion.</span></span> <span data-ttu-id="8821a-202">Toutefois, `For Each` dans l’instruction, aucune erreur du compilateur n’est signalée, même si `number` l’assignation à requiert la `Long` même `Integer`conversion de en.</span><span class="sxs-lookup"><span data-stu-id="8821a-202">In the `For Each` statement, however, no compiler error is reported, even though the assignment to `number` requires the same conversion from `Long` to `Integer`.</span></span> <span data-ttu-id="8821a-203">Dans l' `For Each` instruction qui contient un grand nombre, une erreur d’exécution se produit lorsque <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> est appliqué au grand nombre.</span><span class="sxs-lookup"><span data-stu-id="8821a-203">In the `For Each` statement that contains a large number, a run-time error occurs when <xref:Microsoft.VisualBasic.CompilerServices.Conversions.ToInteger%2A> is applied to the large number.</span></span>

[!code-vb[VbVbalrStatements#89](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/Class3.vb#89)]

### <a name="ienumerator-calls"></a><span data-ttu-id="8821a-204">Appels IEnumerator</span><span class="sxs-lookup"><span data-stu-id="8821a-204">IEnumerator Calls</span></span>

<span data-ttu-id="8821a-205">Lorsque l’exécution d' `For Each`un... la boucle démarre, Visual Basic vérifie que `group` fait référence à un objet de collection valide. `Next`</span><span class="sxs-lookup"><span data-stu-id="8821a-205">When execution of a `For Each`...`Next` loop starts, Visual Basic verifies that `group` refers to a valid collection object.</span></span> <span data-ttu-id="8821a-206">Si ce n’est pas le cas, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="8821a-206">If not, it throws an exception.</span></span> <span data-ttu-id="8821a-207">Sinon, elle appelle la <xref:System.Collections.IEnumerator.MoveNext%2A> méthode et la <xref:System.Collections.IEnumerator.Current%2A> propriété de l’objet énumérateur pour retourner le premier élément.</span><span class="sxs-lookup"><span data-stu-id="8821a-207">Otherwise, it calls the <xref:System.Collections.IEnumerator.MoveNext%2A> method and the <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object to return the first element.</span></span> <span data-ttu-id="8821a-208">Si `MoveNext` indique qu’il n’y a pas d’élément suivant, autrement dit, si la collection est `For Each` vide, la boucle s’arrête et le contrôle passe `Next` à l’instruction qui suit l’instruction.</span><span class="sxs-lookup"><span data-stu-id="8821a-208">If `MoveNext` indicates that there is no next element, that is, if the collection is empty, the `For Each` loop stops and control passes to the statement following the `Next` statement.</span></span> <span data-ttu-id="8821a-209">Sinon, Visual Basic définit `element` sur le premier élément et exécute le bloc d’instructions.</span><span class="sxs-lookup"><span data-stu-id="8821a-209">Otherwise, Visual Basic sets `element` to the first element and runs the statement block.</span></span>

<span data-ttu-id="8821a-210">Chaque fois que Visual Basic rencontre l' `Next` instruction, il retourne à l' `For Each` instruction.</span><span class="sxs-lookup"><span data-stu-id="8821a-210">Each time Visual Basic encounters the `Next` statement, it returns to the `For Each` statement.</span></span> <span data-ttu-id="8821a-211">Là encore, `MoveNext` il `Current` appelle et retourne l’élément suivant, et il exécute à nouveau le bloc ou arrête la boucle en fonction du résultat.</span><span class="sxs-lookup"><span data-stu-id="8821a-211">Again it calls `MoveNext` and `Current` to return the next element, and again it either runs the block or stops the loop depending on the result.</span></span> <span data-ttu-id="8821a-212">Ce processus se poursuit `MoveNext` jusqu’à ce qu’indique qu’il n’existe `Exit For` aucun élément suivant ou qu’une instruction soit rencontrée.</span><span class="sxs-lookup"><span data-stu-id="8821a-212">This process continues until `MoveNext` indicates that there is no next element or an `Exit For` statement is encountered.</span></span>

<span data-ttu-id="8821a-213">**Modification de la collection.**</span><span class="sxs-lookup"><span data-stu-id="8821a-213">**Modifying the Collection.**</span></span> <span data-ttu-id="8821a-214">L’objet énumérateur retourné par <xref:System.Collections.IEnumerable.GetEnumerator%2A> normalement ne vous permet pas de modifier la collection en ajoutant, en supprimant, en remplaçant ou en réordonnant des éléments.</span><span class="sxs-lookup"><span data-stu-id="8821a-214">The enumerator object returned by <xref:System.Collections.IEnumerable.GetEnumerator%2A> normally doesn't let you change the collection by adding, deleting, replacing, or reordering any elements.</span></span> <span data-ttu-id="8821a-215">Si vous modifiez la collection après avoir lancé un `For Each`... Loop, l’objet énumérateur devient non valide et la tentative suivante d’accès à un élément provoque <xref:System.InvalidOperationException> une exception. `Next`</span><span class="sxs-lookup"><span data-stu-id="8821a-215">If you change the collection after you have initiated a `For Each`...`Next` loop, the enumerator object becomes invalid, and the next attempt to access an element causes an <xref:System.InvalidOperationException> exception.</span></span>

<span data-ttu-id="8821a-216">Toutefois, ce blocage de modification n’est pas déterminé par Visual Basic, mais plutôt par l’implémentation <xref:System.Collections.IEnumerable> de l’interface.</span><span class="sxs-lookup"><span data-stu-id="8821a-216">However, this blocking of modification isn't determined by Visual Basic, but rather by the implementation of the <xref:System.Collections.IEnumerable> interface.</span></span> <span data-ttu-id="8821a-217">Il est possible d’implémenter `IEnumerable` de manière à permettre la modification pendant l’itération.</span><span class="sxs-lookup"><span data-stu-id="8821a-217">It is possible to implement `IEnumerable` in a way that allows for modification during iteration.</span></span> <span data-ttu-id="8821a-218">Si vous envisagez d’effectuer une telle modification dynamique, assurez-vous que vous `IEnumerable` comprenez les caractéristiques de l’implémentation sur la collection que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="8821a-218">If you are considering doing such dynamic modification, make sure that you understand the characteristics of the `IEnumerable` implementation on the collection you are using.</span></span>

<span data-ttu-id="8821a-219">**Modification des éléments de la collection.**</span><span class="sxs-lookup"><span data-stu-id="8821a-219">**Modifying Collection Elements.**</span></span> <span data-ttu-id="8821a-220">La <xref:System.Collections.IEnumerator.Current%2A> propriété de l’objet énumérateur est [ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md)et retourne une copie locale de chaque élément de la collection.</span><span class="sxs-lookup"><span data-stu-id="8821a-220">The <xref:System.Collections.IEnumerator.Current%2A> property of the enumerator object is [ReadOnly](../../../visual-basic/language-reference/modifiers/readonly.md), and it returns a local copy of each collection element.</span></span> <span data-ttu-id="8821a-221">Cela signifie que vous ne pouvez pas modifier les éléments eux `For Each`-mêmes dans un... `Next` boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-221">This means that you cannot modify the elements themselves in a `For Each`...`Next` loop.</span></span> <span data-ttu-id="8821a-222">Toute modification que vous effectuez affecte uniquement la copie locale `Current` à partir de et n’est pas reflétée dans la collection sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="8821a-222">Any modification you make affects only the local copy from `Current` and isn't reflected back into the underlying collection.</span></span> <span data-ttu-id="8821a-223">Toutefois, si un élément est un type référence, vous pouvez modifier les membres de l’instance vers laquelle il pointe.</span><span class="sxs-lookup"><span data-stu-id="8821a-223">However, if an element is a reference type, you can modify the members of the instance to which it points.</span></span> <span data-ttu-id="8821a-224">L’exemple suivant modifie le `BackColor` membre de chaque `thisControl` élément.</span><span class="sxs-lookup"><span data-stu-id="8821a-224">The following example modifies the `BackColor` member of each `thisControl` element.</span></span> <span data-ttu-id="8821a-225">Toutefois, vous ne pouvez pas `thisControl` le modifier.</span><span class="sxs-lookup"><span data-stu-id="8821a-225">You cannot, however, modify `thisControl` itself.</span></span>

```vb
Sub lightBlueBackground(ByVal thisForm As System.Windows.Forms.Form)
    For Each thisControl As System.Windows.Forms.Control In thisForm.Controls
        thisControl.BackColor = System.Drawing.Color.LightBlue
    Next thisControl
End Sub
```

<span data-ttu-id="8821a-226">L’exemple précédent peut modifier le `BackColor` membre de chaque `thisControl` élément, même s’il ne `thisControl` peut pas se modifier lui-même.</span><span class="sxs-lookup"><span data-stu-id="8821a-226">The previous example can modify the `BackColor` member of each `thisControl` element, although it cannot modify `thisControl` itself.</span></span>

<span data-ttu-id="8821a-227">**Parcours des tableaux.**</span><span class="sxs-lookup"><span data-stu-id="8821a-227">**Traversing Arrays.**</span></span> <span data-ttu-id="8821a-228">Étant donné <xref:System.Array> que la classe implémente l' <xref:System.Collections.IEnumerable> interface, tous les tableaux <xref:System.Array.GetEnumerator%2A> exposent la méthode.</span><span class="sxs-lookup"><span data-stu-id="8821a-228">Because the <xref:System.Array> class implements the <xref:System.Collections.IEnumerable> interface, all arrays expose the <xref:System.Array.GetEnumerator%2A> method.</span></span> <span data-ttu-id="8821a-229">Cela signifie que vous pouvez effectuer une itération au sein d' `For Each`un tableau avec un... `Next` boucle.</span><span class="sxs-lookup"><span data-stu-id="8821a-229">This means that you can iterate through an array with a `For Each`...`Next` loop.</span></span> <span data-ttu-id="8821a-230">Toutefois, vous ne pouvez lire que les éléments du tableau.</span><span class="sxs-lookup"><span data-stu-id="8821a-230">However, you can only read the array elements.</span></span> <span data-ttu-id="8821a-231">Vous ne pouvez pas les modifier.</span><span class="sxs-lookup"><span data-stu-id="8821a-231">You cannot change them.</span></span>

## <a name="example"></a><span data-ttu-id="8821a-232">Exemple</span><span class="sxs-lookup"><span data-stu-id="8821a-232">Example</span></span>

<span data-ttu-id="8821a-233">L’exemple suivant répertorie tous les dossiers dans le dossier C:\ dans le répertoire à <xref:System.IO.DirectoryInfo> l’aide de la classe.</span><span class="sxs-lookup"><span data-stu-id="8821a-233">The following example lists all the folders in the C:\ directory by using the <xref:System.IO.DirectoryInfo> class.</span></span>

[!code-vb[VbVbalrStatements#124](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#124)]

## <a name="example"></a><span data-ttu-id="8821a-234">Exemple</span><span class="sxs-lookup"><span data-stu-id="8821a-234">Example</span></span>

<span data-ttu-id="8821a-235">L’exemple suivant illustre une procédure de tri d’une collection.</span><span class="sxs-lookup"><span data-stu-id="8821a-235">The following example illustrates a procedure for sorting a collection.</span></span> <span data-ttu-id="8821a-236">L’exemple trie les instances d' `Car` une classe qui sont stockées dans <xref:System.Collections.Generic.List%601>un.</span><span class="sxs-lookup"><span data-stu-id="8821a-236">The example sorts instances of a `Car` class that are stored in a <xref:System.Collections.Generic.List%601>.</span></span> <span data-ttu-id="8821a-237">La classe `Car` implémente l’interface <xref:System.IComparable%601>, ce qui implique l’implémentation de la méthode <xref:System.IComparable%601.CompareTo%2A>.</span><span class="sxs-lookup"><span data-stu-id="8821a-237">The `Car` class implements the <xref:System.IComparable%601> interface, which requires that the <xref:System.IComparable%601.CompareTo%2A> method be implemented.</span></span>

<span data-ttu-id="8821a-238">Chaque appel à la <xref:System.IComparable%601.CompareTo%2A> méthode effectue une comparaison unique qui est utilisée pour le tri.</span><span class="sxs-lookup"><span data-stu-id="8821a-238">Each call to the <xref:System.IComparable%601.CompareTo%2A> method makes a single comparison that's used for sorting.</span></span> <span data-ttu-id="8821a-239">Le code écrit par l’utilisateur dans la méthode `CompareTo` retourne une valeur pour chaque comparaison de l’objet actuel avec un autre objet.</span><span class="sxs-lookup"><span data-stu-id="8821a-239">User-written code in the `CompareTo` method returns a value for each comparison of the current object with another object.</span></span> <span data-ttu-id="8821a-240">La valeur retournée est inférieure à zéro si l’objet actuel est inférieur à l’autre objet, supérieure à zéro l’objet actuel est supérieur à l’autre et égale à zéro s’ils sont égaux.</span><span class="sxs-lookup"><span data-stu-id="8821a-240">The value returned is less than zero if the current object is less than the other object, greater than zero if the current object is greater than the other object, and zero if they are equal.</span></span> <span data-ttu-id="8821a-241">Cela vous permet de définir dans le code les critères définissant « supérieur à », « inférieur à » et « égal à ».</span><span class="sxs-lookup"><span data-stu-id="8821a-241">This enables you to define in code the criteria for greater than, less than, and equal.</span></span>

<span data-ttu-id="8821a-242">Dans la méthode `ListCars`, l’instruction `cars.Sort()` trie la liste.</span><span class="sxs-lookup"><span data-stu-id="8821a-242">In the `ListCars` method, the `cars.Sort()` statement sorts the list.</span></span> <span data-ttu-id="8821a-243">Cet appel à la méthode <xref:System.Collections.Generic.List%601.Sort%2A> de <xref:System.Collections.Generic.List%601> entraîne l’appel automatique de la méthode `CompareTo` pour les objets `Car` dans `List`.</span><span class="sxs-lookup"><span data-stu-id="8821a-243">This call to the <xref:System.Collections.Generic.List%601.Sort%2A> method of the <xref:System.Collections.Generic.List%601> causes the `CompareTo` method to be called automatically for the `Car` objects in the `List`.</span></span>

[!code-vb[VbVbalrStatements#125](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrStatements/VB/class9.vb#125)]

## <a name="see-also"></a><span data-ttu-id="8821a-244">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="8821a-244">See also</span></span>

- [<span data-ttu-id="8821a-245">Collections</span><span class="sxs-lookup"><span data-stu-id="8821a-245">Collections</span></span>](../../../standard/collections/index.md)
- [<span data-ttu-id="8821a-246">For...Next (instruction)</span><span class="sxs-lookup"><span data-stu-id="8821a-246">For...Next Statement</span></span>](../../../visual-basic/language-reference/statements/for-next-statement.md)
- [<span data-ttu-id="8821a-247">Structures de boucle</span><span class="sxs-lookup"><span data-stu-id="8821a-247">Loop Structures</span></span>](../../../visual-basic/programming-guide/language-features/control-flow/loop-structures.md)
- [<span data-ttu-id="8821a-248">While...End While (instruction)</span><span class="sxs-lookup"><span data-stu-id="8821a-248">While...End While Statement</span></span>](../../../visual-basic/language-reference/statements/while-end-while-statement.md)
- [<span data-ttu-id="8821a-249">Do...Loop (instruction)</span><span class="sxs-lookup"><span data-stu-id="8821a-249">Do...Loop Statement</span></span>](../../../visual-basic/language-reference/statements/do-loop-statement.md)
- [<span data-ttu-id="8821a-250">Conversions étendues et restrictives</span><span class="sxs-lookup"><span data-stu-id="8821a-250">Widening and Narrowing Conversions</span></span>](../../../visual-basic/programming-guide/language-features/data-types/widening-and-narrowing-conversions.md)
- [<span data-ttu-id="8821a-251">Initialiseurs d’objets : Types nommés et anonymes</span><span class="sxs-lookup"><span data-stu-id="8821a-251">Object Initializers: Named and Anonymous Types</span></span>](../../../visual-basic/programming-guide/language-features/objects-and-classes/object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="8821a-252">Initialiseurs de collection</span><span class="sxs-lookup"><span data-stu-id="8821a-252">Collection Initializers</span></span>](../../../visual-basic/programming-guide/language-features/collection-initializers/index.md)
- [<span data-ttu-id="8821a-253">Tableaux</span><span class="sxs-lookup"><span data-stu-id="8821a-253">Arrays</span></span>](../../../visual-basic/programming-guide/language-features/arrays/index.md)

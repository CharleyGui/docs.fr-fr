---
title: Event, instruction
ms.date: 05/12/2018
f1_keywords:
- vb.Event
- vb.Custom
helpviewer_keywords:
- Event statement [Visual Basic]
- declaring events [Visual Basic], syntax
- Public keyword [Visual Basic], Event statements
- Custom keyword [Visual Basic]
- declarations [Visual Basic], events
- event keyword [Visual Basic]
- WithEvents keyword [Visual Basic], Event statements
- events [Visual Basic], declaring
- ByVal keyword [Visual Basic], Event statements
- events [Visual Basic], custom
- ByRef keyword [Visual Basic], Event statements
- declaring user-defined events
ms.assetid: 306ff8ed-74dd-4b6a-bd2f-e91b17474042
ms.openlocfilehash: 0575a67f89f734c79259036fe48d6e2671c2d1ed
ms.sourcegitcommit: d2db216e46323f73b32ae312c9e4135258e5d68e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/22/2020
ms.locfileid: "90873260"
---
# <a name="event-statement"></a><span data-ttu-id="57063-102">Event, instruction</span><span class="sxs-lookup"><span data-stu-id="57063-102">Event Statement</span></span>

<span data-ttu-id="57063-103">Déclare un événement défini par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="57063-103">Declares a user-defined event.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="57063-104">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="57063-104">Syntax</span></span>  
  
```vb  
[ <attrlist> ] [ accessmodifier ] _  
[ Shared ] [ Shadows ] Event eventname[(parameterlist)] _  
[ Implements implementslist ]  
' -or-  
[ <attrlist> ] [ accessmodifier ] _  
[ Shared ] [ Shadows ] Event eventname As delegatename _  
[ Implements implementslist ]  
' -or-  
 [ <attrlist> ] [ accessmodifier ] _  
[ Shared ] [ Shadows ] Custom Event eventname As delegatename _  
[ Implements implementslist ]  
   [ <attrlist> ] AddHandler(ByVal value As delegatename)  
      [ statements ]  
   End AddHandler  
   [ <attrlist> ] RemoveHandler(ByVal value As delegatename)  
      [ statements ]  
   End RemoveHandler  
   [ <attrlist> ] RaiseEvent(delegatesignature)  
      [ statements ]  
   End RaiseEvent  
End Event  
```  
  
## <a name="parts"></a><span data-ttu-id="57063-105">Éléments</span><span class="sxs-lookup"><span data-stu-id="57063-105">Parts</span></span>  
  
|<span data-ttu-id="57063-106">Élément</span><span class="sxs-lookup"><span data-stu-id="57063-106">Part</span></span>|<span data-ttu-id="57063-107">Description</span><span class="sxs-lookup"><span data-stu-id="57063-107">Description</span></span>|  
|---|---|  
|`attrlist`|<span data-ttu-id="57063-108">facultatif.</span><span class="sxs-lookup"><span data-stu-id="57063-108">Optional.</span></span> <span data-ttu-id="57063-109">Liste des attributs qui s'appliquent à cet événement.</span><span class="sxs-lookup"><span data-stu-id="57063-109">List of attributes that apply to this event.</span></span> <span data-ttu-id="57063-110">Les attributs multiples sont séparés par des virgules.</span><span class="sxs-lookup"><span data-stu-id="57063-110">Multiple attributes are separated by commas.</span></span> <span data-ttu-id="57063-111">Vous devez placer la [liste des attributs](attribute-list.md) entre crochets pointus (« `<` » et «» `>` ).</span><span class="sxs-lookup"><span data-stu-id="57063-111">You must enclose the [Attribute List](attribute-list.md) in angle brackets ("`<`" and "`>`").</span></span>|  
|`accessmodifier`|<span data-ttu-id="57063-112">Optionnel.</span><span class="sxs-lookup"><span data-stu-id="57063-112">Optional.</span></span> <span data-ttu-id="57063-113">Spécifie le code pouvant accéder à l'événement.</span><span class="sxs-lookup"><span data-stu-id="57063-113">Specifies what code can access the event.</span></span> <span data-ttu-id="57063-114">Il peut s'agir d'une des méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="57063-114">Can be one of the following:</span></span><br /><br /> <span data-ttu-id="57063-115">-   [Public](../modifiers/public.md): tout code pouvant accéder à l’élément qui le déclare peut y accéder.</span><span class="sxs-lookup"><span data-stu-id="57063-115">-   [Public](../modifiers/public.md)—any code that can access the element that declares it can access it.</span></span><br /><span data-ttu-id="57063-116">-   [Protégé](../modifiers/protected.md): seul le code dans sa classe ou une classe dérivée peut y accéder.</span><span class="sxs-lookup"><span data-stu-id="57063-116">-   [Protected](../modifiers/protected.md)—only code within its class or a derived class can access it.</span></span><br /><span data-ttu-id="57063-117">-   [Friend](../modifiers/friend.md): seul le code dans le même assembly peut y accéder.</span><span class="sxs-lookup"><span data-stu-id="57063-117">-   [Friend](../modifiers/friend.md)—only code in the same assembly can access it.</span></span><br /><span data-ttu-id="57063-118">-   [Privé](../modifiers/private.md): seul le code de l’élément qui le déclare peut y accéder.</span><span class="sxs-lookup"><span data-stu-id="57063-118">-   [Private](../modifiers/private.md)—only code in the element that declares it can access it.</span></span><br /> <span data-ttu-id="57063-119">-   Le code [Protected Friend](../modifiers/protected-friend.md)uniquement dans la classe de l’événement, une classe dérivée ou le même assembly peut y accéder.</span><span class="sxs-lookup"><span data-stu-id="57063-119">-   [Protected Friend](../modifiers/protected-friend.md)-only code in the event's class, a derived class, or the same assembly can access it.</span></span> <br /><span data-ttu-id="57063-120">- Le code [privé protégé](../modifiers/private-protected.md)uniquement dans la classe de l’événement ou une classe dérivée dans le même assembly peut y accéder.</span><span class="sxs-lookup"><span data-stu-id="57063-120">- [Private Protected](../modifiers/private-protected.md)-only code in the event's class or a derived class in the same assembly can access it.</span></span>|  
|`Shared`|<span data-ttu-id="57063-121">Optionnel.</span><span class="sxs-lookup"><span data-stu-id="57063-121">Optional.</span></span> <span data-ttu-id="57063-122">Spécifie que cet événement n'est pas associé à une instance spécifique d'une classe ou d'une structure.</span><span class="sxs-lookup"><span data-stu-id="57063-122">Specifies that this event is not associated with a specific instance of a class or structure.</span></span>|  
|`Shadows`|<span data-ttu-id="57063-123">Optionnel.</span><span class="sxs-lookup"><span data-stu-id="57063-123">Optional.</span></span> <span data-ttu-id="57063-124">Indique que cet élément redéclare et masque un élément de programmation du même nom ou un ensemble d'éléments surchargés dans une classe de base.</span><span class="sxs-lookup"><span data-stu-id="57063-124">Indicates that this event redeclares and hides an identically named programming element, or set of overloaded elements, in a base class.</span></span> <span data-ttu-id="57063-125">Vous pouvez occulter tout type d'élément déclaré par un autre type.</span><span class="sxs-lookup"><span data-stu-id="57063-125">You can shadow any kind of declared element with any other kind.</span></span><br /><br /> <span data-ttu-id="57063-126">Un élément occulté n'est pas disponible à partir de la classe dérivée qui l'occulte, sauf à partir de l'emplacement où l'élément d'occultation est inaccessible.</span><span class="sxs-lookup"><span data-stu-id="57063-126">A shadowed element is unavailable from within the derived class that shadows it, except from where the shadowing element is inaccessible.</span></span> <span data-ttu-id="57063-127">Par exemple, si un élément `Private` occulte un élément de la classe de base, le code qui n'est pas autorisé à accéder à l'élément `Private` accède à la place à l'élément de la classe de base.</span><span class="sxs-lookup"><span data-stu-id="57063-127">For example, if a `Private` element shadows a base-class element, code that does not have permission to access the `Private` element accesses the base-class element instead.</span></span>|  
|`eventname`|<span data-ttu-id="57063-128">Obligatoire.</span><span class="sxs-lookup"><span data-stu-id="57063-128">Required.</span></span> <span data-ttu-id="57063-129">Nom de l'événement. Ce nom respecte les conventions standard d'affectation de noms aux variables.</span><span class="sxs-lookup"><span data-stu-id="57063-129">Name of the event; follows standard variable naming conventions.</span></span>|  
|`parameterlist`|<span data-ttu-id="57063-130">Optionnel.</span><span class="sxs-lookup"><span data-stu-id="57063-130">Optional.</span></span> <span data-ttu-id="57063-131">Liste des variables locales qui représentent les paramètres de cet événement.</span><span class="sxs-lookup"><span data-stu-id="57063-131">List of local variables that represent the parameters of this event.</span></span> <span data-ttu-id="57063-132">Vous devez placer la [liste de paramètres](parameter-list.md) entre parenthèses.</span><span class="sxs-lookup"><span data-stu-id="57063-132">You must enclose the [Parameter List](parameter-list.md) in parentheses.</span></span>|  
|`Implements`|<span data-ttu-id="57063-133">Optionnel.</span><span class="sxs-lookup"><span data-stu-id="57063-133">Optional.</span></span> <span data-ttu-id="57063-134">Indique que cet événement implémente un événement d'une interface.</span><span class="sxs-lookup"><span data-stu-id="57063-134">Indicates that this event implements an event of an interface.</span></span>|  
|`implementslist`|<span data-ttu-id="57063-135">Obligatoire si `Implements` est utilisé.</span><span class="sxs-lookup"><span data-stu-id="57063-135">Required if `Implements` is supplied.</span></span> <span data-ttu-id="57063-136">Liste des procédures `Sub` en cours d'implémentation.</span><span class="sxs-lookup"><span data-stu-id="57063-136">List of `Sub` procedures being implemented.</span></span> <span data-ttu-id="57063-137">Les procédures multiples sont séparées par des virgules :</span><span class="sxs-lookup"><span data-stu-id="57063-137">Multiple procedures are separated by commas:</span></span><br /><br /> <span data-ttu-id="57063-138">*implementedprocedure* [, *implementedprocedure* ...]</span><span class="sxs-lookup"><span data-stu-id="57063-138">*implementedprocedure* [ , *implementedprocedure* ... ]</span></span><br /><br /> <span data-ttu-id="57063-139">Chaque `implementedprocedure` emploie la syntaxe et les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="57063-139">Each `implementedprocedure` has the following syntax and parts:</span></span><br /><br /> <span data-ttu-id="57063-140">`interface`.`definedname`</span><span class="sxs-lookup"><span data-stu-id="57063-140">`interface`.`definedname`</span></span><br /><br /> <span data-ttu-id="57063-141">-   `interface` Souhaitée.</span><span class="sxs-lookup"><span data-stu-id="57063-141">-   `interface` - Required.</span></span> <span data-ttu-id="57063-142">Nom d'une interface que la classe ou la structure qui contient cette procédure implémente.</span><span class="sxs-lookup"><span data-stu-id="57063-142">Name of an interface that this procedure's containing class or structure is implementing.</span></span><br /><span data-ttu-id="57063-143">-   `Definedname` Souhaitée.</span><span class="sxs-lookup"><span data-stu-id="57063-143">-   `Definedname` - Required.</span></span> <span data-ttu-id="57063-144">Nom par lequel la procédure est définie dans `interface`.</span><span class="sxs-lookup"><span data-stu-id="57063-144">Name by which the procedure is defined in `interface`.</span></span> <span data-ttu-id="57063-145">Il ne doit pas être identique à `name`, le nom que cette procédure utilise pour implémenter la procédure définie.</span><span class="sxs-lookup"><span data-stu-id="57063-145">This does not have to be the same as `name`, the name that this procedure is using to implement the defined procedure.</span></span>|  
|`Custom`|<span data-ttu-id="57063-146">Obligatoire.</span><span class="sxs-lookup"><span data-stu-id="57063-146">Required.</span></span> <span data-ttu-id="57063-147">Les événements déclarés comme `Custom` doivent définir des accesseurs `AddHandler`, `RemoveHandler` et `RaiseEvent` personnalisés.</span><span class="sxs-lookup"><span data-stu-id="57063-147">Events declared as `Custom` must define custom `AddHandler`, `RemoveHandler`, and `RaiseEvent` accessors.</span></span>|  
|`delegatename`|<span data-ttu-id="57063-148">Optionnel.</span><span class="sxs-lookup"><span data-stu-id="57063-148">Optional.</span></span> <span data-ttu-id="57063-149">Nom d'un délégué qui spécifie la signature du gestionnaire d'événements.</span><span class="sxs-lookup"><span data-stu-id="57063-149">The name of a delegate that specifies the event-handler signature.</span></span>|  
|`AddHandler`|<span data-ttu-id="57063-150">Obligatoire.</span><span class="sxs-lookup"><span data-stu-id="57063-150">Required.</span></span> <span data-ttu-id="57063-151">Déclare un accesseur `AddHandler`, qui spécifie les instructions à exécuter quand un gestionnaire d’événements est ajouté, soit explicitement en utilisant l’instruction `AddHandler`, soit implicitement en utilisant la clause `Handles`.</span><span class="sxs-lookup"><span data-stu-id="57063-151">Declares an `AddHandler` accessor, which specifies the statements to execute when an event handler is added, either explicitly by using the `AddHandler` statement or implicitly by using the `Handles` clause.</span></span>|  
|`End AddHandler`|<span data-ttu-id="57063-152">Obligatoire.</span><span class="sxs-lookup"><span data-stu-id="57063-152">Required.</span></span> <span data-ttu-id="57063-153">Met fin au bloc `AddHandler`.</span><span class="sxs-lookup"><span data-stu-id="57063-153">Terminates the `AddHandler` block.</span></span>|  
|`value`|<span data-ttu-id="57063-154">Obligatoire.</span><span class="sxs-lookup"><span data-stu-id="57063-154">Required.</span></span> <span data-ttu-id="57063-155">Nom du paramètre.</span><span class="sxs-lookup"><span data-stu-id="57063-155">Parameter name.</span></span>|  
|`RemoveHandler`|<span data-ttu-id="57063-156">Obligatoire.</span><span class="sxs-lookup"><span data-stu-id="57063-156">Required.</span></span> <span data-ttu-id="57063-157">Déclare un accesseur `RemoveHandler`, qui spécifie les instructions à exécuter quand un gestionnaire d’événements est supprimé à l’aide de l’instruction `RemoveHandler`.</span><span class="sxs-lookup"><span data-stu-id="57063-157">Declares a `RemoveHandler` accessor, which specifies the statements to execute when an event handler is removed using the `RemoveHandler` statement.</span></span>|  
|`End RemoveHandler`|<span data-ttu-id="57063-158">Obligatoire.</span><span class="sxs-lookup"><span data-stu-id="57063-158">Required.</span></span> <span data-ttu-id="57063-159">Met fin au bloc `RemoveHandler`.</span><span class="sxs-lookup"><span data-stu-id="57063-159">Terminates the `RemoveHandler` block.</span></span>|  
|`RaiseEvent`|<span data-ttu-id="57063-160">Obligatoire.</span><span class="sxs-lookup"><span data-stu-id="57063-160">Required.</span></span> <span data-ttu-id="57063-161">Déclare un accesseur `RaiseEvent`, qui spécifie les instructions à exécuter quand l’événement est déclenché à l’aide de l’instruction `RaiseEvent`.</span><span class="sxs-lookup"><span data-stu-id="57063-161">Declares a `RaiseEvent` accessor, which specifies the statements to execute when the event is raised using the `RaiseEvent` statement.</span></span> <span data-ttu-id="57063-162">En général, il appelle une liste de délégués gérée par les accesseurs `AddHandler` et `RemoveHandler`.</span><span class="sxs-lookup"><span data-stu-id="57063-162">Typically, this invokes a list of delegates maintained by the `AddHandler` and `RemoveHandler` accessors.</span></span>|  
|`End RaiseEvent`|<span data-ttu-id="57063-163">Obligatoire.</span><span class="sxs-lookup"><span data-stu-id="57063-163">Required.</span></span> <span data-ttu-id="57063-164">Met fin au bloc `RaiseEvent`.</span><span class="sxs-lookup"><span data-stu-id="57063-164">Terminates the `RaiseEvent` block.</span></span>|  
|`delegatesignature`|<span data-ttu-id="57063-165">Obligatoire.</span><span class="sxs-lookup"><span data-stu-id="57063-165">Required.</span></span> <span data-ttu-id="57063-166">Liste des paramètres correspondant aux paramètres requis par le délégué `delegatename`.</span><span class="sxs-lookup"><span data-stu-id="57063-166">List of parameters that matches the parameters required by the `delegatename` delegate.</span></span> <span data-ttu-id="57063-167">Vous devez placer la [liste de paramètres](parameter-list.md) entre parenthèses.</span><span class="sxs-lookup"><span data-stu-id="57063-167">You must enclose the [Parameter List](parameter-list.md) in parentheses.</span></span>|  
|`statements`|<span data-ttu-id="57063-168">Optionnel.</span><span class="sxs-lookup"><span data-stu-id="57063-168">Optional.</span></span> <span data-ttu-id="57063-169">Instructions qui contiennent les corps des méthodes `AddHandler`, `RemoveHandler` et `RaiseEvent`.</span><span class="sxs-lookup"><span data-stu-id="57063-169">Statements that contain the bodies of the `AddHandler`, `RemoveHandler`, and `RaiseEvent` methods.</span></span>|  
|`End Event`|<span data-ttu-id="57063-170">Obligatoire.</span><span class="sxs-lookup"><span data-stu-id="57063-170">Required.</span></span> <span data-ttu-id="57063-171">Met fin au bloc `Event`.</span><span class="sxs-lookup"><span data-stu-id="57063-171">Terminates the `Event` block.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="57063-172">Notes</span><span class="sxs-lookup"><span data-stu-id="57063-172">Remarks</span></span>  

 <span data-ttu-id="57063-173">Une fois que l'événement a été déclaré, utilisez l'instruction `RaiseEvent` pour le déclencher.</span><span class="sxs-lookup"><span data-stu-id="57063-173">Once the event has been declared, use the `RaiseEvent` statement to raise the event.</span></span> <span data-ttu-id="57063-174">Les fragments de code suivants illustrent la déclaration et le déclenchement possibles d'un événement standard :</span><span class="sxs-lookup"><span data-stu-id="57063-174">A typical event might be declared and raised as shown in the following fragments:</span></span>  
  
 [!code-vb[VbVbalrEvents#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#13)]  
  
> [!NOTE]
> <span data-ttu-id="57063-175">Vous pouvez déclarer des arguments d’événement de la même manière que des arguments de procédures, avec les exceptions suivantes : les événements ne peuvent pas avoir d’arguments nommés, d’arguments `ParamArray` ni d’arguments `Optional`.</span><span class="sxs-lookup"><span data-stu-id="57063-175">You can declare event arguments just as you do arguments of procedures, with the following exceptions: events cannot have named arguments, `ParamArray` arguments, or `Optional` arguments.</span></span> <span data-ttu-id="57063-176">Les événements n'ont pas de valeurs de retour.</span><span class="sxs-lookup"><span data-stu-id="57063-176">Events do not have return values.</span></span>  
  
 <span data-ttu-id="57063-177">Pour gérer un événement, vous devez l'associer à une sous-routine du gestionnaire d'événements à l'aide de l'instruction `Handles` ou `AddHandler`.</span><span class="sxs-lookup"><span data-stu-id="57063-177">To handle an event, you must associate it with an event handler subroutine using either the `Handles` or `AddHandler` statement.</span></span> <span data-ttu-id="57063-178">Les signatures de la sous-routine et de l'événement doivent correspondre.</span><span class="sxs-lookup"><span data-stu-id="57063-178">The signatures of the subroutine and the event must match.</span></span> <span data-ttu-id="57063-179">Pour gérer un événement partagé, vous devez utiliser l'instruction `AddHandler`.</span><span class="sxs-lookup"><span data-stu-id="57063-179">To handle a shared event, you must use the `AddHandler` statement.</span></span>  
  
 <span data-ttu-id="57063-180">Vous pouvez utiliser `Event` seulement au niveau du module.</span><span class="sxs-lookup"><span data-stu-id="57063-180">You can use `Event` only at module level.</span></span> <span data-ttu-id="57063-181">Cela signifie que le *contexte de déclaration* pour un événement doit être une classe, une structure, un module ou une interface, et ne peut pas être un fichier source, un espace de noms, une procédure ou un bloc.</span><span class="sxs-lookup"><span data-stu-id="57063-181">This means the *declaration context* for an event must be a class, structure, module, or interface, and cannot be a source file, namespace, procedure, or block.</span></span> <span data-ttu-id="57063-182">Pour plus d’informations, consultez [Contextes de déclaration et niveaux d’accès par défaut](declaration-contexts-and-default-access-levels.md).</span><span class="sxs-lookup"><span data-stu-id="57063-182">For more information, see [Declaration Contexts and Default Access Levels](declaration-contexts-and-default-access-levels.md).</span></span>  
  
 <span data-ttu-id="57063-183">Dans la plupart des cas, vous pouvez utiliser la première syntaxe présente dans la section Syntaxe de cette rubrique pour déclarer des événements.</span><span class="sxs-lookup"><span data-stu-id="57063-183">In most circumstances, you can use the first syntax in the Syntax section of this topic for declaring events.</span></span> <span data-ttu-id="57063-184">Toutefois, certains scénarios nécessitent un plus grand contrôle sur le comportement détaillé de l'événement.</span><span class="sxs-lookup"><span data-stu-id="57063-184">However, some scenarios require that you have more control over the detailed behavior of the event.</span></span> <span data-ttu-id="57063-185">La dernière syntaxe présente dans la section Syntaxe de cette rubrique, qui utilise le mot clé `Custom`, fournit ce contrôle en vous permettant de définir des événements personnalisés.</span><span class="sxs-lookup"><span data-stu-id="57063-185">The last syntax in the Syntax section of this topic, which uses the `Custom` keyword, provides that control by enabling you to define custom events.</span></span> <span data-ttu-id="57063-186">Dans un événement personnalisé, vous spécifiez exactement ce qui se passe quand le code ajoute ou supprime un gestionnaire d'événements pour l'événement, ou quand le code déclenche l'événement.</span><span class="sxs-lookup"><span data-stu-id="57063-186">In a custom event, you specify exactly what occurs when code adds or removes an event handler to or from the event, or when code raises the event.</span></span> <span data-ttu-id="57063-187">Pour obtenir des exemples, consultez [Comment : déclarer des événements personnalisés pour économiser de la mémoire](../../programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md) et [Comment : déclarer des événements personnalisés pour éviter les blocages](../../programming-guide/language-features/events/how-to-declare-custom-events-to-avoid-blocking.md).</span><span class="sxs-lookup"><span data-stu-id="57063-187">For examples, see [How to: Declare Custom Events To Conserve Memory](../../programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md) and [How to: Declare Custom Events To Avoid Blocking](../../programming-guide/language-features/events/how-to-declare-custom-events-to-avoid-blocking.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="57063-188">Exemple</span><span class="sxs-lookup"><span data-stu-id="57063-188">Example</span></span>  

 <span data-ttu-id="57063-189">L'exemple suivant utilise des événements pour décompter les secondes de 10 à 0.</span><span class="sxs-lookup"><span data-stu-id="57063-189">The following example uses events to count down seconds from 10 to 0.</span></span> <span data-ttu-id="57063-190">Le code illustre plusieurs méthodes, propriétés et instructions liées à des événements.</span><span class="sxs-lookup"><span data-stu-id="57063-190">The code illustrates several of the event-related methods, properties, and statements.</span></span> <span data-ttu-id="57063-191">Cela inclut l'instruction `RaiseEvent`.</span><span class="sxs-lookup"><span data-stu-id="57063-191">This includes the `RaiseEvent` statement.</span></span>  
  
 <span data-ttu-id="57063-192">La classe qui déclenche un événement est la source de l'événement, et les méthodes qui traitent l'événement sont les gestionnaires d'événements.</span><span class="sxs-lookup"><span data-stu-id="57063-192">The class that raises an event is the event source, and the methods that process the event are the event handlers.</span></span> <span data-ttu-id="57063-193">Une source d'événement peut avoir plusieurs gestionnaires pour les événements qu'elle génère.</span><span class="sxs-lookup"><span data-stu-id="57063-193">An event source can have multiple handlers for the events it generates.</span></span> <span data-ttu-id="57063-194">Quand la classe déclenche l'événement, celui-ci se produit pour chaque classe ayant choisi de gérer les événements pour cette instance de l'objet.</span><span class="sxs-lookup"><span data-stu-id="57063-194">When the class raises the event, that event is raised on every class that has elected to handle events for that instance of the object.</span></span>  
  
 <span data-ttu-id="57063-195">L'exemple utilise également un formulaire (`Form1`) avec un bouton (`Button1`) et une zone de texte (`TextBox1`).</span><span class="sxs-lookup"><span data-stu-id="57063-195">The example also uses a form (`Form1`) with a button (`Button1`) and a text box (`TextBox1`).</span></span> <span data-ttu-id="57063-196">Quand vous cliquez sur le bouton, la première zone de texte affiche un compte à rebours de 10 à 0 secondes.</span><span class="sxs-lookup"><span data-stu-id="57063-196">When you click the button, the first text box displays a countdown from 10 to 0 seconds.</span></span> <span data-ttu-id="57063-197">Quand la durée totale (10 secondes) s'est écoulée, la première zone de texte affiche « Terminé ».</span><span class="sxs-lookup"><span data-stu-id="57063-197">When the full time (10 seconds) has elapsed, the first text box displays "Done".</span></span>  
  
 <span data-ttu-id="57063-198">Le code correspondant à `Form1` indique les états de début et de fin du formulaire.</span><span class="sxs-lookup"><span data-stu-id="57063-198">The code for `Form1` specifies the initial and terminal states of the form.</span></span> <span data-ttu-id="57063-199">Il contient également le code exécuté lors du déclenchement des événements.</span><span class="sxs-lookup"><span data-stu-id="57063-199">It also contains the code executed when events are raised.</span></span>  
  
 <span data-ttu-id="57063-200">Pour utiliser cet exemple, ouvrez un nouveau projet Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="57063-200">To use this example, open a new Windows Forms project.</span></span> <span data-ttu-id="57063-201">Ajoutez ensuite un bouton nommé `Button1` et une zone de texte nommée `TextBox1` au formulaire principal, nommé `Form1`.</span><span class="sxs-lookup"><span data-stu-id="57063-201">Then add a button named `Button1` and a text box named `TextBox1` to the main form, named `Form1`.</span></span> <span data-ttu-id="57063-202">Cliquez ensuite avec le bouton droit sur le formulaire, puis cliquez sur **afficher le code** pour ouvrir l’éditeur de code.</span><span class="sxs-lookup"><span data-stu-id="57063-202">Then right-click the form and click **View Code** to open the code editor.</span></span>  
  
 <span data-ttu-id="57063-203">Ajoutez une variable `WithEvents` à la section des déclarations de la classe `Form1` :</span><span class="sxs-lookup"><span data-stu-id="57063-203">Add a `WithEvents` variable to the declarations section of the `Form1` class:</span></span>  
  
 [!code-vb[VbVbalrEvents#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#14)]  
  
 <span data-ttu-id="57063-204">Ajoutez le code suivant au code pour `Form1`.</span><span class="sxs-lookup"><span data-stu-id="57063-204">Add the following code to the code for `Form1`.</span></span> <span data-ttu-id="57063-205">Remplacez toute procédure en double éventuelle, telle que `Form_Load` ou `Button_Click`.</span><span class="sxs-lookup"><span data-stu-id="57063-205">Replace any duplicate procedures that may exist, such as `Form_Load` or `Button_Click`.</span></span>  
  
 [!code-vb[VbVbalrEvents#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrEvents/VB/Class1.vb#15)]  
  
 <span data-ttu-id="57063-206">Appuyez sur F5 pour exécuter l’exemple précédent, puis cliquez sur le bouton **Démarrer**.</span><span class="sxs-lookup"><span data-stu-id="57063-206">Press F5 to run the previous example, and click the button labeled **Start**.</span></span> <span data-ttu-id="57063-207">La première zone de texte commence à décompter les secondes.</span><span class="sxs-lookup"><span data-stu-id="57063-207">The first text box starts to count down the seconds.</span></span> <span data-ttu-id="57063-208">Quand la durée totale (10 secondes) s'est écoulée, la première zone de texte affiche « Terminé ».</span><span class="sxs-lookup"><span data-stu-id="57063-208">When the full time (10 seconds) has elapsed, the first text box displays "Done".</span></span>  
  
> [!NOTE]
> <span data-ttu-id="57063-209">La méthode `My.Application.DoEvents` ne traite pas les événements de la même manière que le formulaire.</span><span class="sxs-lookup"><span data-stu-id="57063-209">The `My.Application.DoEvents` method does not process events in the same way the form does.</span></span> <span data-ttu-id="57063-210">Pour permettre au formulaire de gérer les événements directement, vous pouvez utiliser le multithreading.</span><span class="sxs-lookup"><span data-stu-id="57063-210">To enable the form to handle the events directly, you can use multithreading.</span></span> <span data-ttu-id="57063-211">Pour plus d’informations, consultez [threads managés](../../../standard/threading/index.md).</span><span class="sxs-lookup"><span data-stu-id="57063-211">For more information, see [Managed Threading](../../../standard/threading/index.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="57063-212">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="57063-212">See also</span></span>

- [<span data-ttu-id="57063-213">RaiseEvent, instruction</span><span class="sxs-lookup"><span data-stu-id="57063-213">RaiseEvent Statement</span></span>](raiseevent-statement.md)
- [<span data-ttu-id="57063-214">Implements, instruction</span><span class="sxs-lookup"><span data-stu-id="57063-214">Implements Statement</span></span>](implements-statement.md)
- [<span data-ttu-id="57063-215">Événements</span><span class="sxs-lookup"><span data-stu-id="57063-215">Events</span></span>](../../programming-guide/language-features/events/index.md)
- [<span data-ttu-id="57063-216">AddHandler, instruction</span><span class="sxs-lookup"><span data-stu-id="57063-216">AddHandler Statement</span></span>](addhandler-statement.md)
- [<span data-ttu-id="57063-217">RemoveHandler, instruction</span><span class="sxs-lookup"><span data-stu-id="57063-217">RemoveHandler Statement</span></span>](removehandler-statement.md)
- [<span data-ttu-id="57063-218">Poignées</span><span class="sxs-lookup"><span data-stu-id="57063-218">Handles</span></span>](handles-clause.md)
- [<span data-ttu-id="57063-219">Delegate, instruction</span><span class="sxs-lookup"><span data-stu-id="57063-219">Delegate Statement</span></span>](delegate-statement.md)
- [<span data-ttu-id="57063-220">Comment : déclarer des événements personnalisés pour économiser la mémoire</span><span class="sxs-lookup"><span data-stu-id="57063-220">How to: Declare Custom Events To Conserve Memory</span></span>](../../programming-guide/language-features/events/how-to-declare-custom-events-to-conserve-memory.md)
- [<span data-ttu-id="57063-221">Comment : déclarer des événements personnalisés pour éviter les blocages</span><span class="sxs-lookup"><span data-stu-id="57063-221">How to: Declare Custom Events To Avoid Blocking</span></span>](../../programming-guide/language-features/events/how-to-declare-custom-events-to-avoid-blocking.md)
- [<span data-ttu-id="57063-222">Partagé</span><span class="sxs-lookup"><span data-stu-id="57063-222">Shared</span></span>](../modifiers/shared.md)
- [<span data-ttu-id="57063-223">Shadows</span><span class="sxs-lookup"><span data-stu-id="57063-223">Shadows</span></span>](../modifiers/shadows.md)

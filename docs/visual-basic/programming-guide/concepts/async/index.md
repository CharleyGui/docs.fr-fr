---
title: Programmation asynchrone avec Async et Await
ms.date: 07/20/2015
ms.assetid: bd7e462b-583b-4395-9c36-45aa9e61072c
ms.openlocfilehash: b3ca0398936d257612b30828e3048797894ccc20
ms.sourcegitcommit: 5d769956a04b6d68484dd717077fabc191c21da5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/17/2020
ms.locfileid: "76163629"
---
# <a name="asynchronous-programming-with-async-and-await-visual-basic"></a><span data-ttu-id="2dc27-102">Programmation asynchrone avec Async et await (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2dc27-102">Asynchronous programming with Async and Await (Visual Basic)</span></span>

<span data-ttu-id="2dc27-103">Vous pouvez éviter des goulots d'étranglement de performance et améliorer la réactivité globale de votre application à l'aide de la programmation asynchrone.</span><span class="sxs-lookup"><span data-stu-id="2dc27-103">You can avoid performance bottlenecks and enhance the overall responsiveness of your application by using asynchronous programming.</span></span> <span data-ttu-id="2dc27-104">Toutefois, les techniques traditionnelles pour écrire des applications asynchrones peuvent être complexes et rendre ces applications difficiles à écrire, déboguer et mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="2dc27-104">However, traditional techniques for writing asynchronous applications can be complicated, making them difficult to write, debug, and maintain.</span></span>

<span data-ttu-id="2dc27-105">Visual Studio 2012 a introduit une approche simplifiée, la programmation async, qui tire parti de la prise en charge asynchrone de .NET Framework 4.5 et des versions ultérieures ainsi que de Windows Runtime.</span><span class="sxs-lookup"><span data-stu-id="2dc27-105">Visual Studio 2012 introduced a simplified approach, async programming, that leverages asynchronous support in the .NET Framework 4.5 and higher as well as  in the Windows Runtime.</span></span> <span data-ttu-id="2dc27-106">Le compilateur effectue le travail difficile dont se chargeait le développeur jusqu’à maintenant. En outre, votre application conserve une structure logique qui ressemble à du code synchrone.</span><span class="sxs-lookup"><span data-stu-id="2dc27-106">The compiler does the difficult work that the developer used to do, and your application retains a logical structure that resembles synchronous code.</span></span> <span data-ttu-id="2dc27-107">Par conséquent, vous obtenez tous les avantages de la programmation asynchrone avec peu d'effort.</span><span class="sxs-lookup"><span data-stu-id="2dc27-107">As a result, you get all the advantages of asynchronous programming with a fraction of the effort.</span></span>

<span data-ttu-id="2dc27-108">Cette rubrique fournit une vue d'ensemble sur quand et comment utiliser la programmation asynchrone, et inclut des liens vers des rubriques du support, qui contiennent des informations et des exemples.</span><span class="sxs-lookup"><span data-stu-id="2dc27-108">This topic provides an overview of when and how to use async programming and includes links to support topics that contain details and examples.</span></span>

## <a name="BKMK_WhentoUseAsynchrony"></a> <span data-ttu-id="2dc27-109">Le comportement asynchrone améliore la réactivité</span><span class="sxs-lookup"><span data-stu-id="2dc27-109">Async improves responsiveness</span></span>

<span data-ttu-id="2dc27-110">Le comportement asynchrone est essentiel pour les activités qui sont potentiellement bloquantes, par exemple lorsque votre application accède au Web.</span><span class="sxs-lookup"><span data-stu-id="2dc27-110">Asynchrony is essential for activities that are potentially blocking, such as when your application accesses the web.</span></span> <span data-ttu-id="2dc27-111">L'accès à une ressource Web est parfois lent ou différé.</span><span class="sxs-lookup"><span data-stu-id="2dc27-111">Access to a web resource sometimes is slow or delayed.</span></span> <span data-ttu-id="2dc27-112">Si cette activité est bloquée dans un processus synchrone, l'application entière doit attendre.</span><span class="sxs-lookup"><span data-stu-id="2dc27-112">If such an activity is blocked within a synchronous process, the entire application must wait.</span></span> <span data-ttu-id="2dc27-113">Dans un processus asynchrone, l'application peut poursuivre une autre tâche qui ne dépend pas de la ressource Web jusqu'à ce que la tâche potentiellement bloquante soit terminée.</span><span class="sxs-lookup"><span data-stu-id="2dc27-113">In an asynchronous process, the application can continue with other work that doesn't depend on the web resource until the potentially blocking task finishes.</span></span>

<span data-ttu-id="2dc27-114">Le tableau suivant indique les zones classiques où la programmation asynchrone améliore la réactivité.</span><span class="sxs-lookup"><span data-stu-id="2dc27-114">The following table shows typical areas where asynchronous programming improves responsiveness.</span></span> <span data-ttu-id="2dc27-115">Les API répertoriées de .NET Framework 4.5 et de Windows Runtime contiennent des méthodes qui prennent en charge la programmation async.</span><span class="sxs-lookup"><span data-stu-id="2dc27-115">The listed APIs from the  .NET Framework 4.5 and the Windows Runtime contain methods that support async programming.</span></span>

|<span data-ttu-id="2dc27-116">Domaine d'application</span><span class="sxs-lookup"><span data-stu-id="2dc27-116">Application area</span></span>|<span data-ttu-id="2dc27-117">API de prise en charge qui contiennent des méthodes async</span><span class="sxs-lookup"><span data-stu-id="2dc27-117">Supporting APIs that contain async methods</span></span>|
|----------------------|------------------------------------------------|
|<span data-ttu-id="2dc27-118">Accès Web</span><span class="sxs-lookup"><span data-stu-id="2dc27-118">Web access</span></span>|<span data-ttu-id="2dc27-119"><xref:System.Net.Http.HttpClient>, <xref:Windows.Web.Syndication.SyndicationClient></span><span class="sxs-lookup"><span data-stu-id="2dc27-119"><xref:System.Net.Http.HttpClient>, <xref:Windows.Web.Syndication.SyndicationClient></span></span>|
|<span data-ttu-id="2dc27-120">Utilisation de fichiers</span><span class="sxs-lookup"><span data-stu-id="2dc27-120">Working with files</span></span>|<span data-ttu-id="2dc27-121"><xref:Windows.Storage.StorageFile>, <xref:System.IO.StreamWriter>, <xref:System.IO.StreamReader>, <xref:System.Xml.XmlReader></span><span class="sxs-lookup"><span data-stu-id="2dc27-121"><xref:Windows.Storage.StorageFile>, <xref:System.IO.StreamWriter>, <xref:System.IO.StreamReader>, <xref:System.Xml.XmlReader></span></span>|
|<span data-ttu-id="2dc27-122">Utilisation d'images</span><span class="sxs-lookup"><span data-stu-id="2dc27-122">Working with images</span></span>|<span data-ttu-id="2dc27-123"><xref:Windows.Media.Capture.MediaCapture>, <xref:Windows.Graphics.Imaging.BitmapEncoder>, <xref:Windows.Graphics.Imaging.BitmapDecoder></span><span class="sxs-lookup"><span data-stu-id="2dc27-123"><xref:Windows.Media.Capture.MediaCapture>, <xref:Windows.Graphics.Imaging.BitmapEncoder>, <xref:Windows.Graphics.Imaging.BitmapDecoder></span></span>|
|<span data-ttu-id="2dc27-124">Programmation WCF</span><span class="sxs-lookup"><span data-stu-id="2dc27-124">WCF programming</span></span>|[<span data-ttu-id="2dc27-125">Opérations synchrones et asynchrones</span><span class="sxs-lookup"><span data-stu-id="2dc27-125">Synchronous and Asynchronous Operations</span></span>](../../../../framework/wcf/synchronous-and-asynchronous-operations.md)|
|||

<span data-ttu-id="2dc27-126">Le comportement asynchrone est particulièrement utile pour les applications qui accèdent au thread d'interface utilisateur, car toute activité liée à l'interface utilisateur partage généralement un thread.</span><span class="sxs-lookup"><span data-stu-id="2dc27-126">Asynchrony proves especially valuable for applications that access the UI thread because all UI-related activity usually shares one thread.</span></span> <span data-ttu-id="2dc27-127">Si un processus est bloqué dans une application synchrone, tous les processus sont bloqués.</span><span class="sxs-lookup"><span data-stu-id="2dc27-127">If any process is blocked in a synchronous application, all are blocked.</span></span> <span data-ttu-id="2dc27-128">Votre application ne répond plus et vous pouvez conclure qu'elle a rencontré une défaillance, alors qu'elle attend simplement.</span><span class="sxs-lookup"><span data-stu-id="2dc27-128">Your application stops responding, and you might conclude that it has failed when instead it's just waiting.</span></span>

<span data-ttu-id="2dc27-129">Lorsque vous utilisez des méthodes asynchrones, l'application continue à répondre à l'interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2dc27-129">When you use asynchronous methods, the application continues to respond to the UI.</span></span> <span data-ttu-id="2dc27-130">Vous pouvez redimensionner ou réduire une fenêtre, par exemple, ou vous pouvez fermer l'application si vous ne souhaitez pas attendre qu'elle se termine.</span><span class="sxs-lookup"><span data-stu-id="2dc27-130">You can resize or minimize a window, for example, or you can close the application if you don't want to wait for it to finish.</span></span>

<span data-ttu-id="2dc27-131">L'approche basée sur async ajoute l'équivalent d'une transmission automatique à la liste d'options dont vous disposez pour concevoir des opérations asynchrones.</span><span class="sxs-lookup"><span data-stu-id="2dc27-131">The async-based approach adds the equivalent of an automatic transmission to the list of options that you can choose from when designing asynchronous operations.</span></span> <span data-ttu-id="2dc27-132">En d'autres termes, vous obtenez tous les avantages de la programmation asynchrone classique mais avec beaucoup moins d'efforts du point de vue du développeur.</span><span class="sxs-lookup"><span data-stu-id="2dc27-132">That is, you get all the benefits of traditional asynchronous programming but with much less effort from the developer.</span></span>

## <a name="BKMK_HowtoWriteanAsyncMethod"></a> <span data-ttu-id="2dc27-133">Les méthodes async sont plus faciles à écrire</span><span class="sxs-lookup"><span data-stu-id="2dc27-133">Async methods are easier to write</span></span>

<span data-ttu-id="2dc27-134">Les mots clés [async](../../../../visual-basic/language-reference/modifiers/async.md) et [await](../../../../visual-basic/language-reference/operators/await-operator.md) en Visual Basic sont au cœur de la programmation async.</span><span class="sxs-lookup"><span data-stu-id="2dc27-134">The [Async](../../../../visual-basic/language-reference/modifiers/async.md) and [Await](../../../../visual-basic/language-reference/operators/await-operator.md) keywords in Visual Basic are the heart of async programming.</span></span> <span data-ttu-id="2dc27-135">Avec ces deux mots clés, vous pouvez utiliser des ressources dans .NET Framework ou Windows Runtime pour créer une méthode asynchrone presque aussi facilement qu’une méthode synchrone.</span><span class="sxs-lookup"><span data-stu-id="2dc27-135">By using those two keywords, you can use resources in the .NET Framework or the Windows Runtime to create an asynchronous method almost as easily as you create a synchronous method.</span></span> <span data-ttu-id="2dc27-136">Les méthodes asynchrones définies avec `Async` et `Await` sont appelées méthodes async.</span><span class="sxs-lookup"><span data-stu-id="2dc27-136">Asynchronous methods that you define by using `Async` and `Await` are referred to as async methods.</span></span>

<span data-ttu-id="2dc27-137">L'exemple suivant illustre une méthode async.</span><span class="sxs-lookup"><span data-stu-id="2dc27-137">The following example shows an async method.</span></span> <span data-ttu-id="2dc27-138">Presque tous les éléments du code doivent vous sembler familiers.</span><span class="sxs-lookup"><span data-stu-id="2dc27-138">Almost everything in the code should look completely familiar to you.</span></span> <span data-ttu-id="2dc27-139">Les commentaires indiquent les fonctionnalités que vous ajoutez pour créer le comportement asynchrone.</span><span class="sxs-lookup"><span data-stu-id="2dc27-139">The comments call out the features that you add to create the asynchrony.</span></span>

<span data-ttu-id="2dc27-140">Le fichier d’exemple complet Windows Presentation Foundation (WPF) se trouve à la fin de cette rubrique. Vous pouvez télécharger l’exemple sur [Exemple async : exemple de « programmation asynchrone avec async et await »](https://docs.microsoft.com/samples/dotnet/samples/async-and-await-vb/).</span><span class="sxs-lookup"><span data-stu-id="2dc27-140">You can find a complete Windows Presentation Foundation (WPF) example file at the end of this topic, and you can download the sample from [Async Sample: Example from "Asynchronous Programming with Async and Await"](https://docs.microsoft.com/samples/dotnet/samples/async-and-await-vb/).</span></span>

```vb
' Three things to note about writing an Async Function:
'  - The function has an Async modifier.
'  - Its return type is Task or Task(Of T). (See "Return Types" section.)
'  - As a matter of convention, its name ends in "Async".
Async Function AccessTheWebAsync() As Task(Of Integer)
    Using client As New HttpClient()
        ' Call and await separately.
        '  - AccessTheWebAsync can do other things while GetStringAsync is also running.
        '  - getStringTask stores the task we get from the call to GetStringAsync.
        '  - Task(Of String) means it is a task which returns a String when it is done.
        Dim getStringTask As Task(Of String) =
            client.GetStringAsync("https://docs.microsoft.com/dotnet")
        ' You can do other work here that doesn't rely on the string from GetStringAsync.
        DoIndependentWork()
        ' The Await operator suspends AccessTheWebAsync.
        '  - AccessTheWebAsync does not continue until getStringTask is complete.
        '  - Meanwhile, control returns to the caller of AccessTheWebAsync.
        '  - Control resumes here when getStringTask is complete.
        '  - The Await operator then retrieves the String result from getStringTask.
        Dim urlContents As String = Await getStringTask
        ' The Return statement specifies an Integer result.
        ' A method which awaits AccessTheWebAsync receives the Length value.
        Return urlContents.Length

    End Using

End Function
```

<span data-ttu-id="2dc27-141">Si `AccessTheWebAsync` n'a aucun travail qu'il peut effectuer entre l'appel de `GetStringAsync` et l'attente de son achèvement, vous pouvez simplifier votre code en appelant et attendant dans l'instruction unique suivante.</span><span class="sxs-lookup"><span data-stu-id="2dc27-141">If `AccessTheWebAsync` doesn't have any work that it can do between calling `GetStringAsync` and awaiting its completion, you can simplify your code by calling and awaiting in the following single statement.</span></span>

```vb
Dim urlContents As String = Await client.GetStringAsync()
```

<span data-ttu-id="2dc27-142">Les caractéristiques suivantes résument ce qui fait de l’exemple précédent une méthode Async :</span><span class="sxs-lookup"><span data-stu-id="2dc27-142">The following characteristics summarize what makes the previous example an async method:</span></span>

- <span data-ttu-id="2dc27-143">La signature de la méthode inclut un modificateur `Async`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-143">The method signature includes an `Async` modifier.</span></span>
- <span data-ttu-id="2dc27-144">Le nom d'une méthode async, par convention, se termine par un suffixe « Async ».</span><span class="sxs-lookup"><span data-stu-id="2dc27-144">The name of an async method, by convention, ends with an "Async" suffix.</span></span>
- <span data-ttu-id="2dc27-145">Le type de retour est l’un des types suivants :</span><span class="sxs-lookup"><span data-stu-id="2dc27-145">The return type is one of the following types:</span></span>

  - <span data-ttu-id="2dc27-146">[Task (Of TResult)](xref:System.Threading.Tasks.Task%601) si votre méthode a une instruction return dans laquelle l’opérande a le type TResult.</span><span class="sxs-lookup"><span data-stu-id="2dc27-146">[Task(Of TResult)](xref:System.Threading.Tasks.Task%601) if your method has a return statement in which the operand has type TResult.</span></span>
  - <span data-ttu-id="2dc27-147"><xref:System.Threading.Tasks.Task> si votre méthode n'a aucune instruction de retour, ou si elle a une instruction de retour sans opérande.</span><span class="sxs-lookup"><span data-stu-id="2dc27-147"><xref:System.Threading.Tasks.Task> if your method has no return statement or has a return statement with no operand.</span></span>
  - <span data-ttu-id="2dc27-148">[Sub](../../../../visual-basic/programming-guide/language-features/procedures/sub-procedures.md) si vous écrivez un gestionnaire d’événements async.</span><span class="sxs-lookup"><span data-stu-id="2dc27-148">[Sub](../../../../visual-basic/programming-guide/language-features/procedures/sub-procedures.md) if you're writing an async event handler.</span></span>

  <span data-ttu-id="2dc27-149">Pour plus d’informations, consultez « Types et paramètres de retour » dans la suite de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="2dc27-149">For more information, see "Return Types and Parameters" later in this topic.</span></span>

- <span data-ttu-id="2dc27-150">La méthode inclut généralement au moins une expression await, qui marque le point au-delà duquel la méthode ne peut pas poursuivre son exécution tant que l'opération asynchrone attendue n'est pas terminée.</span><span class="sxs-lookup"><span data-stu-id="2dc27-150">The method usually includes at least one await expression, which marks a point where the method can't continue until the awaited asynchronous operation is complete.</span></span> <span data-ttu-id="2dc27-151">Dans le même temps, la méthode est interrompue, et le contrôle retourne à l'appelant de la méthode.</span><span class="sxs-lookup"><span data-stu-id="2dc27-151">In the meantime, the method is suspended, and control returns to the method's caller.</span></span> <span data-ttu-id="2dc27-152">La section suivante de cette rubrique illustre ce qui se produit au point d'interruption.</span><span class="sxs-lookup"><span data-stu-id="2dc27-152">The next section of this topic illustrates what happens at the suspension point.</span></span>

<span data-ttu-id="2dc27-153">Dans les méthodes async, vous utilisez les mots clés et les types fournis pour indiquer ce que vous souhaitez faire, et le compilateur effectue le reste, notamment le suivi de ce qui doit se produire lorsque le contrôle retourne à un point d'attente dans une méthode interrompue.</span><span class="sxs-lookup"><span data-stu-id="2dc27-153">In async methods, you use the provided keywords and types to indicate what you want to do, and the compiler does the rest, including keeping track of what must happen when control returns to an await point in a suspended method.</span></span> <span data-ttu-id="2dc27-154">Il peut être difficile de gérer des processus de routine, tels que les boucles et la gestion des exceptions, dans le code asynchrone traditionnel.</span><span class="sxs-lookup"><span data-stu-id="2dc27-154">Some routine processes, such as loops and exception handling, can be difficult to handle in traditional asynchronous code.</span></span> <span data-ttu-id="2dc27-155">Dans une méthode async, vous écrivez ces éléments comme vous l’auriez fait dans une solution synchrone, et le problème est résolu.</span><span class="sxs-lookup"><span data-stu-id="2dc27-155">In an async method, you write these elements much as you would in a synchronous solution, and the problem is solved.</span></span>

<span data-ttu-id="2dc27-156">Pour plus d’informations sur le comportement asynchrone dans les versions antérieures de .NET Framework, consultez la page [Programmation asynchrone .NET Framework traditionnelle et TPL](../../../../standard/parallel-programming/tpl-and-traditional-async-programming.md).</span><span class="sxs-lookup"><span data-stu-id="2dc27-156">For more information about asynchrony in previous versions of the .NET Framework, see [TPL and Traditional .NET Framework Asynchronous Programming](../../../../standard/parallel-programming/tpl-and-traditional-async-programming.md).</span></span>

## <a name="BKMK_WhatHappensUnderstandinganAsyncMethod"></a><span data-ttu-id="2dc27-157">Ce qui se passe dans une méthode Async</span><span class="sxs-lookup"><span data-stu-id="2dc27-157">What happens in an Async method</span></span>

<span data-ttu-id="2dc27-158">La chose la plus importante à comprendre en programmation asynchrone est le déplacement du flux de contrôle d'une méthode à l'autre.</span><span class="sxs-lookup"><span data-stu-id="2dc27-158">The most important thing to understand in asynchronous programming is how the control flow moves from method to method.</span></span> <span data-ttu-id="2dc27-159">Le diagramme suivant présente le processus :</span><span class="sxs-lookup"><span data-stu-id="2dc27-159">The following diagram leads you through the process:</span></span>

![Diagramme illustrant le suivi d’un programme asynchrone.](./media/index/navigation-trace-async-program.png)

<span data-ttu-id="2dc27-161">Les nombres dans le diagramme correspondent aux étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="2dc27-161">The numbers in the diagram correspond to the following steps:</span></span>

1. <span data-ttu-id="2dc27-162">Un gestionnaire d’événements appelle et attend la méthode Async `AccessTheWebAsync`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-162">An event handler calls and awaits the `AccessTheWebAsync` async method.</span></span>

2. <span data-ttu-id="2dc27-163">`AccessTheWebAsync` crée une instance <xref:System.Net.Http.HttpClient> et appelle la méthode asynchrone <xref:System.Net.Http.HttpClient.GetStringAsync%2A> pour télécharger le contenu d'un site Web comme une chaîne.</span><span class="sxs-lookup"><span data-stu-id="2dc27-163">`AccessTheWebAsync` creates an <xref:System.Net.Http.HttpClient> instance and calls the <xref:System.Net.Http.HttpClient.GetStringAsync%2A> asynchronous method to download the contents of a website as a string.</span></span>

3. <span data-ttu-id="2dc27-164">Quelque chose se produit dans `GetStringAsync` et suspend sa progression.</span><span class="sxs-lookup"><span data-stu-id="2dc27-164">Something happens in `GetStringAsync` that suspends its progress.</span></span> <span data-ttu-id="2dc27-165">Elle peut être obligée d'attendre la fin d'un téléchargement sur un site Web ou de toute autre activité bloquante.</span><span class="sxs-lookup"><span data-stu-id="2dc27-165">Perhaps it must wait for a website to download or some other blocking activity.</span></span> <span data-ttu-id="2dc27-166">Pour éviter de bloquer les ressources, `GetStringAsync` cède le contrôle à son appelant, `AccessTheWebAsync`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-166">To avoid blocking resources, `GetStringAsync` yields control to its caller, `AccessTheWebAsync`.</span></span>

     <span data-ttu-id="2dc27-167">`GetStringAsync` retourne une [tâche (de TResult)](xref:System.Threading.Tasks.Task%601) où TResult est une chaîne, et `AccessTheWebAsync` affecte la tâche à la variable `getStringTask`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-167">`GetStringAsync` returns a [Task(Of TResult)](xref:System.Threading.Tasks.Task%601) where TResult is a string, and `AccessTheWebAsync` assigns the task to the `getStringTask` variable.</span></span> <span data-ttu-id="2dc27-168">La tâche représente le processus en cours de l'appel de `GetStringAsync`, avec l'engagement de produire une valeur de chaîne réelle lorsque le travail est terminé.</span><span class="sxs-lookup"><span data-stu-id="2dc27-168">The task represents the ongoing process for the call to `GetStringAsync`, with a commitment to produce an actual string value when the work is complete.</span></span>

4. <span data-ttu-id="2dc27-169">Étant donné que `getStringTask` n'a pas encore été attendu, `AccessTheWebAsync` peut continuer avec un autre travail qui ne dépend pas du résultat final issu de `GetStringAsync`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-169">Because `getStringTask` hasn't been awaited yet, `AccessTheWebAsync` can continue with other work that doesn't depend on the final result from `GetStringAsync`.</span></span> <span data-ttu-id="2dc27-170">Cette opération est représentée par un appel à la méthode synchrone `DoIndependentWork`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-170">That work is represented by a call to the synchronous method `DoIndependentWork`.</span></span>

5. <span data-ttu-id="2dc27-171">`DoIndependentWork` est une méthode synchrone qui effectue son travail et retourne à son appelant.</span><span class="sxs-lookup"><span data-stu-id="2dc27-171">`DoIndependentWork` is a synchronous method that does its work and returns to its caller.</span></span>

6. <span data-ttu-id="2dc27-172">`AccessTheWebAsync` n'a plus de travail à exécuter sans un résultat de `getStringTask`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-172">`AccessTheWebAsync` has run out of work that it can do without a result from `getStringTask`.</span></span> <span data-ttu-id="2dc27-173">`AccessTheWebAsync` veut ensuite calculer et retourner la longueur de la chaîne téléchargée, mais la méthode ne peut pas calculer cette valeur avant d'avoir la chaîne.</span><span class="sxs-lookup"><span data-stu-id="2dc27-173">`AccessTheWebAsync` next wants to calculate and return the length of the downloaded string, but the method can't calculate that value until the method has the string.</span></span>

     <span data-ttu-id="2dc27-174">Par conséquent, `AccessTheWebAsync` utilise un opérateur await pour interrompre sa progression et pour céder le contrôle à la méthode ayant appelé `AccessTheWebAsync`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-174">Therefore, `AccessTheWebAsync` uses an await operator to suspend its progress and to yield control to the method that called `AccessTheWebAsync`.</span></span> <span data-ttu-id="2dc27-175">`AccessTheWebAsync` retourne un `Task(Of Integer)` à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="2dc27-175">`AccessTheWebAsync` returns a `Task(Of Integer)` to the caller.</span></span> <span data-ttu-id="2dc27-176">La tâche représente la promesse de produire un résultat entier qui est la longueur de la chaîne téléchargée.</span><span class="sxs-lookup"><span data-stu-id="2dc27-176">The task represents a promise to produce an integer result that's the length of the downloaded string.</span></span>

    > [!NOTE]
    > <span data-ttu-id="2dc27-177">Si `GetStringAsync` (et donc `getStringTask`) est terminé avant que `AccessTheWebAsync` ne l'attende, le contrôle reste dans `AccessTheWebAsync`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-177">If `GetStringAsync` (and therefore `getStringTask`) is complete before `AccessTheWebAsync` awaits it, control remains in `AccessTheWebAsync`.</span></span> <span data-ttu-id="2dc27-178">Le fait de suspendre, puis de retourner à `AccessTheWebAsync` ne sert à rien si le processus asynchrone appelé (`getStringTask`) s'est déjà effectué et si AccessTheWebSync n'a pas à attendre le résultat final.</span><span class="sxs-lookup"><span data-stu-id="2dc27-178">The expense of suspending and then returning to `AccessTheWebAsync` would be wasted if the called asynchronous process (`getStringTask`) has already completed and AccessTheWebSync doesn't have to wait for the final result.</span></span>

     <span data-ttu-id="2dc27-179">Dans l'appelant (le gestionnaire d'événements dans cet exemple), le modèle de traitement continue.</span><span class="sxs-lookup"><span data-stu-id="2dc27-179">Inside the caller (the event handler in this example), the processing pattern continues.</span></span> <span data-ttu-id="2dc27-180">L'appelant peut effectuer d'autres tâches qui ne dépendent pas du résultat de `AccessTheWebAsync` avant d'attendre ce résultat, ou l'appelant peut attendre immédiatement.</span><span class="sxs-lookup"><span data-stu-id="2dc27-180">The caller might do other work that doesn't depend on the result from `AccessTheWebAsync` before awaiting that result, or the caller might await immediately.</span></span>   <span data-ttu-id="2dc27-181">Le gestionnaire d'événements attend `AccessTheWebAsync`, et `AccessTheWebAsync` attend `GetStringAsync`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-181">The event handler is waiting for `AccessTheWebAsync`, and `AccessTheWebAsync` is waiting for `GetStringAsync`.</span></span>

7. <span data-ttu-id="2dc27-182">`GetStringAsync` se termine et génère un résultat de chaîne.</span><span class="sxs-lookup"><span data-stu-id="2dc27-182">`GetStringAsync` completes and produces a string result.</span></span> <span data-ttu-id="2dc27-183">Le résultat de chaîne n'est pas retourné par l'appel de `GetStringAsync` de la façon à laquelle vous pourriez vous attendre.</span><span class="sxs-lookup"><span data-stu-id="2dc27-183">The string result isn't returned by the call to `GetStringAsync` in the way that you might expect.</span></span> <span data-ttu-id="2dc27-184">(N'oubliez pas que la méthode a déjà retourné une tâche à l'étape 3.) Au lieu de cela, le résultat chaîne est stocké dans la tâche qui représente l'achèvement de la méthode, `getStringTask`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-184">(Remember that the method already returned a task in step 3.) Instead, the string result is stored in the task that represents the completion of the method, `getStringTask`.</span></span> <span data-ttu-id="2dc27-185">L'opérateur await récupère le résultat de `getStringTask`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-185">The await operator retrieves the result from `getStringTask`.</span></span> <span data-ttu-id="2dc27-186">L'instruction d'assignation assigne le résultat récupéré à `urlContents`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-186">The assignment statement assigns the retrieved result to `urlContents`.</span></span>

8. <span data-ttu-id="2dc27-187">Lorsque `AccessTheWebAsync` a le résultat de chaîne, la méthode peut calculer la longueur de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="2dc27-187">When `AccessTheWebAsync` has the string result, the method can calculate the length of the string.</span></span> <span data-ttu-id="2dc27-188">Puis, le travail d'`AccessTheWebAsync` est également interrompu, et le gestionnaire d'événements en attente peut reprendre.</span><span class="sxs-lookup"><span data-stu-id="2dc27-188">Then the work of `AccessTheWebAsync` is also complete, and the waiting event handler can resume.</span></span> <span data-ttu-id="2dc27-189">Dans l'exemple complet à la fin de la rubrique, vous pouvez vérifier que le gestionnaire d'événements récupère et imprime la valeur du résultat de la longueur.</span><span class="sxs-lookup"><span data-stu-id="2dc27-189">In the full example at the end of the topic, you can confirm that the event handler retrieves and prints the value of the length result.</span></span>

<span data-ttu-id="2dc27-190">Si vous débutez en programmation asynchrone, prenez une minute pour déterminer la différence entre le comportement synchrone et le comportement asynchrone.</span><span class="sxs-lookup"><span data-stu-id="2dc27-190">If you are new to asynchronous programming, take a minute to consider the difference between synchronous and asynchronous behavior.</span></span> <span data-ttu-id="2dc27-191">Une méthode synchrone retourne une fois son travail terminé (étape 5), mais une méthode asynchrone retourne une valeur de tâche lorsque son travail est interrompu (étapes 3 et 6).</span><span class="sxs-lookup"><span data-stu-id="2dc27-191">A synchronous method returns when its work is complete (step 5), but an async method returns a task value when its work is suspended (steps 3 and 6).</span></span> <span data-ttu-id="2dc27-192">Lorsque la méthode async termine finalement son travail, la tâche est marquée comme terminée et le résultat, le cas échéant, est stocké dans la tâche.</span><span class="sxs-lookup"><span data-stu-id="2dc27-192">When the async method eventually completes its work, the task is marked as completed and the result, if any, is stored in the task.</span></span>

<span data-ttu-id="2dc27-193">Pour plus d’informations sur le flux de contrôle, consultez la page [Flux de contrôle dans les programmes async (Visual Basic)](control-flow-in-async-programs.md).</span><span class="sxs-lookup"><span data-stu-id="2dc27-193">For more information about control flow, see [Control Flow in Async Programs (Visual Basic)](control-flow-in-async-programs.md).</span></span>

## <a name="BKMK_APIAsyncMethods"></a> <span data-ttu-id="2dc27-194">Méthodes async d’API</span><span class="sxs-lookup"><span data-stu-id="2dc27-194">API Async Methods</span></span>

<span data-ttu-id="2dc27-195">Vous pouvez vous demander où rechercher les méthodes telles que `GetStringAsync` qui prennent en charge la programmation async.</span><span class="sxs-lookup"><span data-stu-id="2dc27-195">You might be wondering where to find methods such as `GetStringAsync` that support async programming.</span></span> <span data-ttu-id="2dc27-196">La .NET Framework 4,5 ou une version ultérieure contient de nombreux membres qui fonctionnent avec `Async` et `Await`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-196">The .NET Framework 4.5 or higher contains many members that work with `Async` and `Await`.</span></span> <span data-ttu-id="2dc27-197">Vous pouvez reconnaître ces membres par le suffixe « Async » joint au nom de membre et un type de retour <xref:System.Threading.Tasks.Task> ou [Task (Of TResult)](xref:System.Threading.Tasks.Task%601).</span><span class="sxs-lookup"><span data-stu-id="2dc27-197">You can recognize these members by the "Async" suffix that's attached to the member name and a return type of <xref:System.Threading.Tasks.Task> or [Task(Of TResult)](xref:System.Threading.Tasks.Task%601).</span></span> <span data-ttu-id="2dc27-198">Par exemple, la classe `System.IO.Stream` contient des méthodes telles que <xref:System.IO.Stream.CopyToAsync%2A>, <xref:System.IO.Stream.ReadAsync%2A> et <xref:System.IO.Stream.WriteAsync%2A> en même temps que les méthodes synchrones <xref:System.IO.Stream.CopyTo%2A>, <xref:System.IO.Stream.Read%2A> et <xref:System.IO.Stream.Write%2A>.</span><span class="sxs-lookup"><span data-stu-id="2dc27-198">For example, the `System.IO.Stream` class contains methods such as <xref:System.IO.Stream.CopyToAsync%2A>, <xref:System.IO.Stream.ReadAsync%2A>, and <xref:System.IO.Stream.WriteAsync%2A> alongside the synchronous methods <xref:System.IO.Stream.CopyTo%2A>, <xref:System.IO.Stream.Read%2A>, and <xref:System.IO.Stream.Write%2A>.</span></span>

<span data-ttu-id="2dc27-199">Windows Runtime contient également de nombreuses méthodes utilisables avec `Async` et `Await` dans les applications Windows.</span><span class="sxs-lookup"><span data-stu-id="2dc27-199">The Windows Runtime also contains many methods that you can use with `Async` and `Await` in Windows apps.</span></span> <span data-ttu-id="2dc27-200">Pour plus d’informations et pour obtenir des exemples de méthodes, consultez [appeler des API asynchrones dans C# ou Visual Basic](/windows/uwp/threading-async/call-asynchronous-apis-in-csharp-or-visual-basic), [programmation asynchrone (applications Windows Runtime)](https://docs.microsoft.com/previous-versions/windows/apps/hh464924(v=win.10))et [WhenAny : pontage entre le .NET Framework et le Windows Runtime](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/jj635140(v=vs.120)).</span><span class="sxs-lookup"><span data-stu-id="2dc27-200">For more information and example methods, see [Call asynchronous APIs in C# or Visual Basic](/windows/uwp/threading-async/call-asynchronous-apis-in-csharp-or-visual-basic), [Asynchronous programming (Windows Runtime apps)](https://docs.microsoft.com/previous-versions/windows/apps/hh464924(v=win.10)), and [WhenAny: Bridging between the .NET Framework and the Windows Runtime](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/jj635140(v=vs.120)).</span></span>

## <a name="BKMK_Threads"></a> <span data-ttu-id="2dc27-201">Threads</span><span class="sxs-lookup"><span data-stu-id="2dc27-201">Threads</span></span>

<span data-ttu-id="2dc27-202">Les méthodes Async sont conçues pour être des opérations non bloquantes.</span><span class="sxs-lookup"><span data-stu-id="2dc27-202">Async methods are intended to be non-blocking operations.</span></span> <span data-ttu-id="2dc27-203">Une expression `Await` dans une méthode Async ne bloque pas le thread actuel pendant que la tâche attendue est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="2dc27-203">An `Await` expression in an async method doesn't block the current thread while the awaited task is running.</span></span> <span data-ttu-id="2dc27-204">Au lieu de cela, l'expression inscrit le reste de la méthode comme continuation et retourne le contrôle à l'appelant de la méthode async.</span><span class="sxs-lookup"><span data-stu-id="2dc27-204">Instead, the expression signs up the rest of the method as a continuation and returns control to the caller of the async method.</span></span>

<span data-ttu-id="2dc27-205">Les mots clés `Async` et `Await` n’entraînent pas la création de threads supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="2dc27-205">The `Async` and `Await` keywords don't cause additional threads to be created.</span></span> <span data-ttu-id="2dc27-206">Les méthodes Async ne requièrent pas de Multi-Threading, car une méthode Async ne s’exécute pas sur son propre thread.</span><span class="sxs-lookup"><span data-stu-id="2dc27-206">Async methods don't require multi-threading because an async method doesn't run on its own thread.</span></span> <span data-ttu-id="2dc27-207">La méthode s'exécute sur le contexte de synchronisation actuel et utilise du temps sur le thread uniquement lorsqu'elle est active.</span><span class="sxs-lookup"><span data-stu-id="2dc27-207">The method runs on the current synchronization context and uses time on the thread only when the method is active.</span></span> <span data-ttu-id="2dc27-208">Vous pouvez utiliser <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> pour déplacer le travail lié au processeur vers un thread d'arrière-plan, mais un thread d'arrière-plan ne permet pas à un processus qui attend simplement les résultats de devenir disponible.</span><span class="sxs-lookup"><span data-stu-id="2dc27-208">You can use <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> to move CPU-bound work to a background thread, but a background thread doesn't help with a process that's just waiting for results to become available.</span></span>

<span data-ttu-id="2dc27-209">L’approche basée sur async en matière de programmation asynchrone est préférable aux approches existantes, dans presque tous les cas.</span><span class="sxs-lookup"><span data-stu-id="2dc27-209">The async-based approach to asynchronous programming is preferable to existing approaches in almost every case.</span></span> <span data-ttu-id="2dc27-210">En particulier, cette approche est mieux que <xref:System.ComponentModel.BackgroundWorker> pour les opérations liées aux e/s, car le code est plus simple et vous n’avez pas à vous prémunir contre les conditions de concurrence.</span><span class="sxs-lookup"><span data-stu-id="2dc27-210">In particular, this approach is better than <xref:System.ComponentModel.BackgroundWorker> for I/O-bound operations because the code is simpler and you don't have to guard against race conditions.</span></span> <span data-ttu-id="2dc27-211">Combinée à <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType>, la programmation asynchrone est meilleure que <xref:System.ComponentModel.BackgroundWorker> pour les opérations utilisant le processeur de manière intensive car la programmation asynchrone sépare les détails de coordination de l'exécution de votre code à partir du travail que `Task.Run` transfère au pool de threads.</span><span class="sxs-lookup"><span data-stu-id="2dc27-211">In combination with <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType>, async programming is better than <xref:System.ComponentModel.BackgroundWorker> for CPU-bound operations because async programming separates the coordination details of running your code from the work that `Task.Run` transfers to the threadpool.</span></span>

## <a name="BKMK_AsyncandAwait"></a> <span data-ttu-id="2dc27-212">Async et Await</span><span class="sxs-lookup"><span data-stu-id="2dc27-212">Async and Await</span></span>

<span data-ttu-id="2dc27-213">Si vous spécifiez qu’une méthode est une méthode async en utilisant un modificateur [Async](../../../../visual-basic/language-reference/modifiers/async.md), vous activez les deux fonctionnalités suivantes.</span><span class="sxs-lookup"><span data-stu-id="2dc27-213">If you specify that a method is an async method by using an [Async](../../../../visual-basic/language-reference/modifiers/async.md) modifier, you enable the following two capabilities.</span></span>

- <span data-ttu-id="2dc27-214">La méthode async marquée peut utiliser [Await](../../../../visual-basic/language-reference/operators/await-operator.md) pour indiquer des points d’interruption.</span><span class="sxs-lookup"><span data-stu-id="2dc27-214">The marked async method can use [Await](../../../../visual-basic/language-reference/operators/await-operator.md) to designate suspension points.</span></span> <span data-ttu-id="2dc27-215">L'opérateur await indique au compilateur que la méthode async ne peut pas continuer au-delà de ce point, tant que le processus asynchrone attendu n'est pas terminé.</span><span class="sxs-lookup"><span data-stu-id="2dc27-215">The await operator tells the compiler that the async method can't continue past that point until the awaited asynchronous process is complete.</span></span> <span data-ttu-id="2dc27-216">Entre-temps, le contrôle retourne à l'appelant de la méthode async.</span><span class="sxs-lookup"><span data-stu-id="2dc27-216">In the meantime, control returns to the caller of the async method.</span></span>

  <span data-ttu-id="2dc27-217">La suspension d’une méthode Async au niveau d’une expression `Await` ne constitue pas une sortie de la méthode et les blocs `Finally` ne s’exécutent pas.</span><span class="sxs-lookup"><span data-stu-id="2dc27-217">The suspension of an async method at an `Await` expression doesn't constitute an exit from the method, and `Finally` blocks don't run.</span></span>

- <span data-ttu-id="2dc27-218">La méthode async marquée peut elle-même être attendue par les méthodes qui l'appellent.</span><span class="sxs-lookup"><span data-stu-id="2dc27-218">The marked async method can itself be awaited by methods that call it.</span></span>

<span data-ttu-id="2dc27-219">Une méthode Async contient généralement une ou plusieurs occurrences d’un opérateur `Await`, mais l’absence d' `Await` expressions ne provoque pas d’erreur du compilateur.</span><span class="sxs-lookup"><span data-stu-id="2dc27-219">An async method typically contains one or more occurrences of an `Await` operator, but the absence of `Await` expressions doesn't cause a compiler error.</span></span> <span data-ttu-id="2dc27-220">Si une méthode Async n’utilise pas un opérateur `Await` pour marquer un point de suspension, la méthode s’exécute en tant que méthode synchrone, en dépit du modificateur `Async`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-220">If an async method doesn't use an `Await` operator to mark a suspension point, the method executes as a synchronous method does, despite the `Async` modifier.</span></span> <span data-ttu-id="2dc27-221">Le compilateur émet un avertissement pour ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="2dc27-221">The compiler issues a warning for such methods.</span></span>

<span data-ttu-id="2dc27-222">`Async` et `Await` sont des mots clés contextuels.</span><span class="sxs-lookup"><span data-stu-id="2dc27-222">`Async` and `Await` are contextual keywords.</span></span> <span data-ttu-id="2dc27-223">Pour plus d'informations et des exemples, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="2dc27-223">For more information and examples, see the following topics:</span></span>

- [<span data-ttu-id="2dc27-224">Async</span><span class="sxs-lookup"><span data-stu-id="2dc27-224">Async</span></span>](../../../../visual-basic/language-reference/modifiers/async.md)
- [<span data-ttu-id="2dc27-225">Await (opérateur)</span><span class="sxs-lookup"><span data-stu-id="2dc27-225">Await Operator</span></span>](../../../../visual-basic/language-reference/operators/await-operator.md)

## <a name="BKMK_ReturnTypesandParameters"></a> <span data-ttu-id="2dc27-226">Paramètres et types de retour</span><span class="sxs-lookup"><span data-stu-id="2dc27-226">Return types and parameters</span></span>

<span data-ttu-id="2dc27-227">Dans .NET Framework programmation, une méthode Async retourne généralement un <xref:System.Threading.Tasks.Task> ou une [tâche (de TResult)](xref:System.Threading.Tasks.Task%601).</span><span class="sxs-lookup"><span data-stu-id="2dc27-227">In .NET Framework programming, an async method typically returns a <xref:System.Threading.Tasks.Task> or a [Task(Of TResult)](xref:System.Threading.Tasks.Task%601).</span></span> <span data-ttu-id="2dc27-228">Dans une méthode async, un opérateur `Await` est appliqué à une tâche retournée à partir d’un appel à une autre méthode async.</span><span class="sxs-lookup"><span data-stu-id="2dc27-228">Inside an async method, an `Await` operator is applied to a task that's returned from a call to another async method.</span></span>

<span data-ttu-id="2dc27-229">Vous spécifiez [Task (Of TResult)](xref:System.Threading.Tasks.Task%601) comme type de retour si la méthode contient une instruction [Return](../../../../visual-basic/language-reference/statements/return-statement.md) qui spécifie un opérande de type `TResult`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-229">You specify [Task(Of TResult)](xref:System.Threading.Tasks.Task%601) as the return type if the method contains a [Return](../../../../visual-basic/language-reference/statements/return-statement.md) statement that specifies an operand of type `TResult`.</span></span>

<span data-ttu-id="2dc27-230">Vous utilisez `Task` comme type de retour si la méthode n'a aucune instruction return ou une instruction return qui ne retourne pas d'opérande.</span><span class="sxs-lookup"><span data-stu-id="2dc27-230">You use `Task` as the return type if the method has no return statement or has a return statement that doesn't return an operand.</span></span>

<span data-ttu-id="2dc27-231">L’exemple suivant montre comment déclarer et appeler une méthode qui retourne une [tâche (de TResult)](xref:System.Threading.Tasks.Task%601) ou une <xref:System.Threading.Tasks.Task>:</span><span class="sxs-lookup"><span data-stu-id="2dc27-231">The following example shows how you declare and call a method that returns a [Task(Of TResult)](xref:System.Threading.Tasks.Task%601) or a <xref:System.Threading.Tasks.Task>:</span></span>

```vb
' Signature specifies Task(Of Integer)
Async Function TaskOfTResult_MethodAsync() As Task(Of Integer)

    Dim hours As Integer
    ' . . .
    ' Return statement specifies an integer result.
    Return hours
End Function

' Calls to TaskOfTResult_MethodAsync
Dim returnedTaskTResult As Task(Of Integer) = TaskOfTResult_MethodAsync()
Dim intResult As Integer = Await returnedTaskTResult
' or, in a single statement
Dim intResult As Integer = Await TaskOfTResult_MethodAsync()

' Signature specifies Task
Async Function Task_MethodAsync() As Task

    ' . . .
    ' The method has no return statement.
End Function

' Calls to Task_MethodAsync
Task returnedTask = Task_MethodAsync()
Await returnedTask
' or, in a single statement
Await Task_MethodAsync()
```

<span data-ttu-id="2dc27-232">Chaque tâche retournée représente le travail en cours.</span><span class="sxs-lookup"><span data-stu-id="2dc27-232">Each returned task represents ongoing work.</span></span> <span data-ttu-id="2dc27-233">Une tâche encapsule des informations sur l’état du processus asynchrone et, éventuellement, le résultat final du processus ou l’exception que le processus déclenche s’il ne réussit pas.</span><span class="sxs-lookup"><span data-stu-id="2dc27-233">A task encapsulates information about the state of the asynchronous process and, eventually, either the final result from the process or the exception that the process raises if it doesn't succeed.</span></span>

<span data-ttu-id="2dc27-234">Une méthode async peut également être une méthode `Sub`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-234">An async method can also be a `Sub` method.</span></span> <span data-ttu-id="2dc27-235">Ce type de retour est essentiellement utilisé pour définir les gestionnaires d’événements, où un type de retour est obligatoire.</span><span class="sxs-lookup"><span data-stu-id="2dc27-235">This return type is used primarily to define event handlers, where a return type is required.</span></span> <span data-ttu-id="2dc27-236">Les gestionnaires d'événements asynchrones servent souvent de point de départ aux programmes asynchrones.</span><span class="sxs-lookup"><span data-stu-id="2dc27-236">Async event handlers often serve as the starting point for async programs.</span></span>

<span data-ttu-id="2dc27-237">Une méthode Async qui est une procédure `Sub` ne peut pas être attendue, et l’appelant ne peut pas intercepter les exceptions levées par la méthode.</span><span class="sxs-lookup"><span data-stu-id="2dc27-237">An async method that's a `Sub` procedure can't be awaited, and the caller can't catch any exceptions that the method throws.</span></span>

<span data-ttu-id="2dc27-238">Une méthode async ne peut pas déclarer de paramètres [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md), mais elle peut appeler des méthodes qui comportent ces paramètres.</span><span class="sxs-lookup"><span data-stu-id="2dc27-238">An async method can't declare [ByRef](../../../../visual-basic/language-reference/modifiers/byref.md) parameters, but the method can call methods that have such parameters.</span></span>

<span data-ttu-id="2dc27-239">Pour plus d’informations ainsi que des exemples, consultez la page [Types de retour Async (Visual Basic)](async-return-types.md).</span><span class="sxs-lookup"><span data-stu-id="2dc27-239">For more information and examples, see [Async Return Types (Visual Basic)](async-return-types.md).</span></span> <span data-ttu-id="2dc27-240">Pour plus d’informations sur l’interception des exceptions dans les méthodes async, consultez la page [Instruction Try...Catch...Finally](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).</span><span class="sxs-lookup"><span data-stu-id="2dc27-240">For more information about how to catch exceptions in async methods, see [Try...Catch...Finally Statement](../../../../visual-basic/language-reference/statements/try-catch-finally-statement.md).</span></span>

<span data-ttu-id="2dc27-241">Les API asynchrones dans la programmation Windows Runtime ont l’un des types de retour suivants, qui sont semblables aux tâches :</span><span class="sxs-lookup"><span data-stu-id="2dc27-241">Asynchronous APIs in Windows Runtime programming have one of the following return types, which are similar to tasks:</span></span>

- <span data-ttu-id="2dc27-242">[IAsyncOperation (Of TResult)](xref:Windows.Foundation.IAsyncOperation%601), qui correspond à [Task (Of TResult)](xref:System.Threading.Tasks.Task%601)</span><span class="sxs-lookup"><span data-stu-id="2dc27-242">[IAsyncOperation(Of TResult)](xref:Windows.Foundation.IAsyncOperation%601), which corresponds to [Task(Of TResult)](xref:System.Threading.Tasks.Task%601)</span></span>
- <span data-ttu-id="2dc27-243"><xref:Windows.Foundation.IAsyncAction>, qui correspond à <xref:System.Threading.Tasks.Task></span><span class="sxs-lookup"><span data-stu-id="2dc27-243"><xref:Windows.Foundation.IAsyncAction>, which corresponds to <xref:System.Threading.Tasks.Task></span></span>
- [<span data-ttu-id="2dc27-244">IAsyncActionWithProgress (of TProgress)</span><span class="sxs-lookup"><span data-stu-id="2dc27-244">IAsyncActionWithProgress(Of TProgress)</span></span>](xref:Windows.Foundation.IAsyncActionWithProgress%601)
- [<span data-ttu-id="2dc27-245">IAsyncOperationWithProgress (Of TResult, TProgress)</span><span class="sxs-lookup"><span data-stu-id="2dc27-245">IAsyncOperationWithProgress(Of TResult, TProgress)</span></span>](xref:Windows.Foundation.IAsyncOperationWithProgress%602)

<span data-ttu-id="2dc27-246">Pour plus d’informations et pour obtenir un exemple, consultez [appeler C# des API asynchrones dans ou Visual Basic](/windows/uwp/threading-async/call-asynchronous-apis-in-csharp-or-visual-basic).</span><span class="sxs-lookup"><span data-stu-id="2dc27-246">For more information and an example, see [Call asynchronous APIs in C# or Visual Basic](/windows/uwp/threading-async/call-asynchronous-apis-in-csharp-or-visual-basic).</span></span>

## <a name="BKMK_NamingConvention"></a> <span data-ttu-id="2dc27-247">Convention d’affectation de noms</span><span class="sxs-lookup"><span data-stu-id="2dc27-247">Naming convention</span></span>

<span data-ttu-id="2dc27-248">Par convention, on ajoute « Async » aux noms des méthodes qui possèdent un modificateur `Async`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-248">By convention, you append "Async" to the names of methods that have an `Async` modifier.</span></span>

<span data-ttu-id="2dc27-249">Vous pouvez ignorer la convention où un événement, une classe de base, ou un contrat d'interface suggère un nom différent.</span><span class="sxs-lookup"><span data-stu-id="2dc27-249">You can ignore the convention where an event, base class, or interface contract suggests a different name.</span></span> <span data-ttu-id="2dc27-250">Par exemple, vous ne devez pas renommer les gestionnaires d’événements communs, tels que `Button1_Click`.</span><span class="sxs-lookup"><span data-stu-id="2dc27-250">For example, you shouldn't rename common event handlers, such as `Button1_Click`.</span></span>

## <a name="BKMK_RelatedTopics"></a> <span data-ttu-id="2dc27-251">Rubriques connexes et exemples (Visual Studio)</span><span class="sxs-lookup"><span data-stu-id="2dc27-251">Related topics and samples (Visual Studio)</span></span>

|<span data-ttu-id="2dc27-252">Titre</span><span class="sxs-lookup"><span data-stu-id="2dc27-252">Title</span></span>|<span data-ttu-id="2dc27-253">Description</span><span class="sxs-lookup"><span data-stu-id="2dc27-253">Description</span></span>|<span data-ttu-id="2dc27-254">Aperçu</span><span class="sxs-lookup"><span data-stu-id="2dc27-254">Sample</span></span>|
|-----------|-----------------|------------|
|[<span data-ttu-id="2dc27-255">Procédure pas à pas : accès au web avec Async et Await (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2dc27-255">Walkthrough: Accessing the Web by Using Async and Await (Visual Basic)</span></span>](walkthrough-accessing-the-web-by-using-async-and-await.md)|<span data-ttu-id="2dc27-256">Montre comment convertir une solution WPF synchrone en une solution WPF asynchrone.</span><span class="sxs-lookup"><span data-stu-id="2dc27-256">Shows how to convert a synchronous WPF solution to an asynchronous WPF solution.</span></span> <span data-ttu-id="2dc27-257">L’application télécharge une série de sites web.</span><span class="sxs-lookup"><span data-stu-id="2dc27-257">The application downloads a series of websites.</span></span>|[<span data-ttu-id="2dc27-258">Exemple Async : Accès à la procédure web</span><span class="sxs-lookup"><span data-stu-id="2dc27-258">Async Sample: Accessing the Web Walkthrough</span></span>](https://code.msdn.microsoft.com/Async-Sample-Accessing-the-9c10497f)|
|[<span data-ttu-id="2dc27-259">Guide pratique : étendre la procédure pas à pas Async à l’aide de Task.WhenAll (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2dc27-259">How to: Extend the Async Walkthrough by Using Task.WhenAll (Visual Basic)</span></span>](how-to-extend-the-async-walkthrough-by-using-task-whenall.md)|<span data-ttu-id="2dc27-260">Ajoute <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> à la procédure précédente.</span><span class="sxs-lookup"><span data-stu-id="2dc27-260">Adds <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> to the previous walkthrough.</span></span> <span data-ttu-id="2dc27-261">L'utilisation de `WhenAll` démarre tous les téléchargements en même temps.</span><span class="sxs-lookup"><span data-stu-id="2dc27-261">The use of `WhenAll` starts all the downloads at the same time.</span></span>||
|[<span data-ttu-id="2dc27-262">Guide pratique : effectuer plusieurs requêtes web en parallèle avec Async et Await (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2dc27-262">How to: Make Multiple Web Requests in Parallel by Using Async and Await (Visual Basic)</span></span>](how-to-make-multiple-web-requests-in-parallel-by-using-async-and-await.md)|<span data-ttu-id="2dc27-263">Explique comment démarrer plusieurs tâches en même temps.</span><span class="sxs-lookup"><span data-stu-id="2dc27-263">Demonstrates how to start several tasks at the same time.</span></span>|[<span data-ttu-id="2dc27-264">Exemple Async : effectuer plusieurs requêtes web en parallèle</span><span class="sxs-lookup"><span data-stu-id="2dc27-264">Async Sample: Make Multiple Web Requests in Parallel</span></span>](https://code.msdn.microsoft.com/Async-Make-Multiple-Web-49adb82e)|
|[<span data-ttu-id="2dc27-265">Types de retour Async (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2dc27-265">Async Return Types (Visual Basic)</span></span>](async-return-types.md)|<span data-ttu-id="2dc27-266">Décrit les types que les méthodes async peuvent retourner et explique quand chaque type est approprié.</span><span class="sxs-lookup"><span data-stu-id="2dc27-266">Illustrates the types that async methods can return and explains when each type is appropriate.</span></span>||
|[<span data-ttu-id="2dc27-267">Flux de contrôle dans les programmes Async (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2dc27-267">Control Flow in Async Programs (Visual Basic)</span></span>](control-flow-in-async-programs.md)|<span data-ttu-id="2dc27-268">Effectue le suivi en détail du flux de contrôle via une série d'expressions await dans un programme asynchrone.</span><span class="sxs-lookup"><span data-stu-id="2dc27-268">Traces in detail the flow of control through a succession of await expressions in an asynchronous program.</span></span>|[<span data-ttu-id="2dc27-269">Exemple Async : flux de contrôle dans les programmes Async</span><span class="sxs-lookup"><span data-stu-id="2dc27-269">Async Sample: Control Flow in Async Programs</span></span>](https://code.msdn.microsoft.com/Async-Sample-Control-Flow-5c804fc0)|
|[<span data-ttu-id="2dc27-270">Ajuster une application Async (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2dc27-270">Fine-Tuning Your Async Application (Visual Basic)</span></span>](fine-tuning-your-async-application.md)|<span data-ttu-id="2dc27-271">Indique comment ajouter les fonctionnalités suivantes à votre solution async :</span><span class="sxs-lookup"><span data-stu-id="2dc27-271">Shows how to add the following functionality to your async solution:</span></span><br /><br /> <span data-ttu-id="2dc27-272">- [Annuler une tâche Asynch ou une liste de tâches (Visual Basic)](../../../../visual-basic/programming-guide/concepts/async/cancel-an-async-task-or-a-list-of-tasks.md)</span><span class="sxs-lookup"><span data-stu-id="2dc27-272">- [Cancel an Async Task or a List of Tasks (Visual Basic)](../../../../visual-basic/programming-guide/concepts/async/cancel-an-async-task-or-a-list-of-tasks.md)</span></span><br /><span data-ttu-id="2dc27-273">- [Annuler des tâches Asynch après une période spécifique (Visual Basic)](cancel-async-tasks-after-a-period-of-time.md)</span><span class="sxs-lookup"><span data-stu-id="2dc27-273">- [Cancel Async Tasks after a Period of Time (Visual Basic)](cancel-async-tasks-after-a-period-of-time.md)</span></span><br /><span data-ttu-id="2dc27-274">- [Annuler les tâches Asynch restantes lorsque l’une d’elles est terminée (Visual Basic)](cancel-remaining-async-tasks-after-one-is-complete.md)</span><span class="sxs-lookup"><span data-stu-id="2dc27-274">- [Cancel Remaining Async Tasks after One Is Complete (Visual Basic)](cancel-remaining-async-tasks-after-one-is-complete.md)</span></span><br /><span data-ttu-id="2dc27-275">- [Démarrer plusieurs tâches Asynch et les traiter une fois terminées (Visual Basic)](start-multiple-async-tasks-and-process-them-as-they-complete.md)</span><span class="sxs-lookup"><span data-stu-id="2dc27-275">- [Start Multiple Async Tasks and Process Them As They Complete (Visual Basic)](start-multiple-async-tasks-and-process-them-as-they-complete.md)</span></span>|[<span data-ttu-id="2dc27-276">Exemple Async : ajuster une application</span><span class="sxs-lookup"><span data-stu-id="2dc27-276">Async Sample: Fine Tuning Your Application</span></span>](https://code.msdn.microsoft.com/Async-Fine-Tuning-Your-a676abea)|
|[<span data-ttu-id="2dc27-277">Gérer la réentrance dans Async Apps (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2dc27-277">Handling Reentrancy in Async Apps (Visual Basic)</span></span>](handling-reentrancy-in-async-apps.md)|<span data-ttu-id="2dc27-278">Montre comment gérer les cas dans lesquels une opération asynchrone active est redémarrée pendant son exécution.</span><span class="sxs-lookup"><span data-stu-id="2dc27-278">Shows how to handle cases in which an active asynchronous operation is restarted while it's running.</span></span>||
|<span data-ttu-id="2dc27-279">[WhenAny : transition entre .NET Framework et Windows Runtime](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/jj635140(v=vs.120))</span><span class="sxs-lookup"><span data-stu-id="2dc27-279">[WhenAny: Bridging between the .NET Framework and the Windows Runtime](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/jj635140(v=vs.120))</span></span>|<span data-ttu-id="2dc27-280">Montre comment établir un pont entre les types de tâches du .NET Framework et IAsyncOperations dans Windows Runtime pour pouvoir utiliser <xref:System.Threading.Tasks.Task.WhenAny%2A> avec une méthode Windows Runtime.</span><span class="sxs-lookup"><span data-stu-id="2dc27-280">Shows how to bridge between Task types in the .NET Framework and IAsyncOperations in the Windows Runtime so that you can use <xref:System.Threading.Tasks.Task.WhenAny%2A> with a Windows Runtime method.</span></span>|<span data-ttu-id="2dc27-281">[Exemple Async : transition entre .NET et Windows Runtime (AsTask et WhenAny)](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/jj635140(v=vs.120))</span><span class="sxs-lookup"><span data-stu-id="2dc27-281">[Async Sample: Bridging between .NET and Windows Runtime (AsTask and WhenAny)](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/jj635140(v=vs.120))</span></span>|
|<span data-ttu-id="2dc27-282">Annulation Asynch : combler l'écart entre .NET Framework et Windows Runtime</span><span class="sxs-lookup"><span data-stu-id="2dc27-282">Async Cancellation: Bridging between the .NET Framework and the Windows Runtime</span></span>|<span data-ttu-id="2dc27-283">Montre comment établir un pont entre les types de tâches du .NET Framework et IAsyncOperations dans Windows Runtime pour pouvoir utiliser <xref:System.Threading.CancellationTokenSource> avec une méthode Windows Runtime.</span><span class="sxs-lookup"><span data-stu-id="2dc27-283">Shows how to bridge between Task types in the .NET Framework and IAsyncOperations in the Windows Runtime so that you can use <xref:System.Threading.CancellationTokenSource> with a Windows Runtime method.</span></span>|[<span data-ttu-id="2dc27-284">Exemple Async : transition entre .NET et Windows Runtime (AsTask & Annulation)</span><span class="sxs-lookup"><span data-stu-id="2dc27-284">Async Sample: Bridging between .NET and Windows Runtime (AsTask & Cancellation)</span></span>](https://code.msdn.microsoft.com/Async-Sample-Bridging-9479eca3)|
|[<span data-ttu-id="2dc27-285">Utiliser async pour l’accès aux fichiers (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="2dc27-285">Using Async for File Access (Visual Basic)</span></span>](using-async-for-file-access.md)|<span data-ttu-id="2dc27-286">Répertorie et explique les avantages de l'utilisation d'async et d'await pour accéder aux fichiers.</span><span class="sxs-lookup"><span data-stu-id="2dc27-286">Lists and demonstrates the benefits of using async and await to access files.</span></span>||
|[<span data-ttu-id="2dc27-287">Modèle asynchrone basé sur les tâches (TAP, Task-based Asynchronous Pattern)</span><span class="sxs-lookup"><span data-stu-id="2dc27-287">Task-based Asynchronous Pattern (TAP)</span></span>](../../../../standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md)|<span data-ttu-id="2dc27-288">Décrit un nouveau modèle pour le comportement asynchrone dans le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2dc27-288">Describes a new pattern for asynchrony in the .NET Framework.</span></span> <span data-ttu-id="2dc27-289">Le modèle est basé sur les types <xref:System.Threading.Tasks.Task> et [Task (Of TResult)](xref:System.Threading.Tasks.Task%601) .</span><span class="sxs-lookup"><span data-stu-id="2dc27-289">The pattern is based on the <xref:System.Threading.Tasks.Task> and [Task(Of TResult)](xref:System.Threading.Tasks.Task%601) types.</span></span>||
|[<span data-ttu-id="2dc27-290">Vidéos Async sur Channel 9</span><span class="sxs-lookup"><span data-stu-id="2dc27-290">Async Videos on Channel 9</span></span>](https://channel9.msdn.com/search?term=async+&type=All)|<span data-ttu-id="2dc27-291">Fournit des liens vers diverses vidéos sur la programmation asynchrone.</span><span class="sxs-lookup"><span data-stu-id="2dc27-291">Provides links to a variety of videos about async programming.</span></span>||

## <a name="BKMK_CompleteExample"></a> <span data-ttu-id="2dc27-292">Exemple complet</span><span class="sxs-lookup"><span data-stu-id="2dc27-292">Complete Example</span></span>

<span data-ttu-id="2dc27-293">Le code suivant est le fichier MainWindow.xaml.vb de l’application WPF (Windows Presentation Foundation) traitée dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="2dc27-293">The following code is the MainWindow.xaml.vb file from the Windows Presentation Foundation (WPF) application that this topic discusses.</span></span> <span data-ttu-id="2dc27-294">Vous pouvez télécharger l’exemple sur [Exemple async : exemple de « programmation asynchrone avec async et await »](https://docs.microsoft.com/samples/dotnet/samples/async-and-await-vb/).</span><span class="sxs-lookup"><span data-stu-id="2dc27-294">You can download the sample from [Async Sample: Example from "Asynchronous Programming with Async and Await"](https://docs.microsoft.com/samples/dotnet/samples/async-and-await-vb/).</span></span>

[!code-vb[async](~/samples/async/async-and-await/vb/MainWindow.xaml.vb)]

## <a name="see-also"></a><span data-ttu-id="2dc27-295">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2dc27-295">See also</span></span>

- [<span data-ttu-id="2dc27-296">Await (opérateur)</span><span class="sxs-lookup"><span data-stu-id="2dc27-296">Await Operator</span></span>](../../../../visual-basic/language-reference/operators/await-operator.md)
- [<span data-ttu-id="2dc27-297">Async</span><span class="sxs-lookup"><span data-stu-id="2dc27-297">Async</span></span>](../../../../visual-basic/language-reference/modifiers/async.md)

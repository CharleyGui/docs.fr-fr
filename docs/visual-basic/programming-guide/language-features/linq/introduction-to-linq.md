---
title: Introduction à LINQ
ms.date: 08/28/2018
helpviewer_keywords:
- queries [LINQ in Visual Basic], about LINQ in Visual Basic queries
- query execution [LINQ in Visual Basic]
- range variables [Visual Basic]
- LINQ [Visual Basic]
- LINQ [Visual Basic], about LINQ in Visual Basic
- query expressions [LINQ in Visual Basic]
- LINQ
- deferred execution
- iteration variables [Visual Basic]
ms.assetid: 3047d86e-0d49-40e2-928b-dc02e46c7984
ms.openlocfilehash: 3f58edf326ab9415d78d7065d74d8c1954fbbf37
ms.sourcegitcommit: 09b4090b78f52fd09b0e430cd4b26576f1fdf96e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/22/2020
ms.locfileid: "76315861"
---
# <a name="introduction-to-linq-in-visual-basic"></a><span data-ttu-id="2bac3-102">Introduction à LINQ dans Visual Basic</span><span class="sxs-lookup"><span data-stu-id="2bac3-102">Introduction to LINQ in Visual Basic</span></span>
<span data-ttu-id="2bac3-103">LINQ (Language-Integrated Query) ajoute des fonctionnalités de requête à Visual Basic et fournit des fonctionnalités simples et puissantes quand vous travaillez avec tous les types de données.</span><span class="sxs-lookup"><span data-stu-id="2bac3-103">Language-Integrated Query (LINQ) adds query capabilities to Visual Basic and provides simple and powerful capabilities when you work with all kinds of data.</span></span> <span data-ttu-id="2bac3-104">Plutôt que d’envoyer une requête à une base de données à traiter, ou d’utiliser une syntaxe de requête différente pour chaque type de données que vous recherchez, LINQ introduit des requêtes dans le cadre du langage de Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="2bac3-104">Rather than sending a query to a database to be processed, or working with different query syntax for each type of data that you are searching, LINQ introduces queries as part of the Visual Basic language.</span></span> <span data-ttu-id="2bac3-105">Il utilise une syntaxe unifiée indépendamment du type de données.</span><span class="sxs-lookup"><span data-stu-id="2bac3-105">It uses a unified syntax regardless of the type of data.</span></span>  
  
 <span data-ttu-id="2bac3-106">LINQ vous permet d’interroger des données à partir d’une base de données SQL Server, d’un fichier XML, de tableaux et de collections en mémoire, de jeux de données ADO.NET ou de toute autre source de données distante ou locale qui prend en charge LINQ.</span><span class="sxs-lookup"><span data-stu-id="2bac3-106">LINQ enables you to query data from a SQL Server database, XML, in-memory arrays and collections, ADO.NET datasets, or any other remote or local data source that supports LINQ.</span></span> <span data-ttu-id="2bac3-107">Vous pouvez effectuer toutes ces tâches avec les éléments de langage d’Visual Basic courants.</span><span class="sxs-lookup"><span data-stu-id="2bac3-107">You can do all this with common Visual Basic language elements.</span></span> <span data-ttu-id="2bac3-108">Étant donné que vos requêtes sont écrites en Visual Basic langage, les résultats de votre requête sont retournés en tant qu’objets fortement typés.</span><span class="sxs-lookup"><span data-stu-id="2bac3-108">Because your queries are written in the Visual Basic language, your query results are returned as strongly-typed objects.</span></span> <span data-ttu-id="2bac3-109">Ces objets prennent en charge IntelliSense, qui vous permet d'écrire du code plus rapidement et d'intercepter les erreurs dans vos requêtes au moment de la compilation plutôt qu'au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="2bac3-109">These objects support IntelliSense, which enables you to write code faster and catch errors in your queries at compile time instead of at run time.</span></span> <span data-ttu-id="2bac3-110">Les requêtes LINQ peuvent être utilisées comme source de requêtes supplémentaires pour affiner les résultats.</span><span class="sxs-lookup"><span data-stu-id="2bac3-110">LINQ queries can be used as the source of additional queries to refine results.</span></span> <span data-ttu-id="2bac3-111">Elles peuvent également être liées à des contrôles pour que les utilisateurs puissent afficher et modifier facilement vos résultats de requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-111">They can also be bound to controls so that users can easily view and modify your query results.</span></span>  
  
 <span data-ttu-id="2bac3-112">Par exemple, l'exemple de code suivant affiche une requête LINQ qui retourne une liste de clients à partir d'une collection et les regroupe en fonction de leur emplacement.</span><span class="sxs-lookup"><span data-stu-id="2bac3-112">For example, the following code example shows a LINQ query that returns a list of customers from a collection and groups them based on their location.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#1)]  
  
## <a name="running-the-examples"></a><span data-ttu-id="2bac3-113">Exécution des exemples</span><span class="sxs-lookup"><span data-stu-id="2bac3-113">Running the examples</span></span>  
 <span data-ttu-id="2bac3-114">Pour exécuter les exemples de l’introduction et de la section [structure d’une requête LINQ](#structure-of-a-linq-query) , incluez le code suivant, qui retourne les listes Customers et Orders.</span><span class="sxs-lookup"><span data-stu-id="2bac3-114">To run the examples in the introduction and in the [Structure of a LINQ Query](#structure-of-a-linq-query) section, include the following code, which returns lists of customers and orders.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#31)]  
  
## <a name="linq-providers"></a><span data-ttu-id="2bac3-115">Fournisseurs LINQ</span><span class="sxs-lookup"><span data-stu-id="2bac3-115">LINQ providers</span></span>  
 <span data-ttu-id="2bac3-116">Un *fournisseur LINQ* mappe vos requêtes LINQ Visual Basic à la source de données interrogée.</span><span class="sxs-lookup"><span data-stu-id="2bac3-116">A *LINQ provider* maps your Visual Basic LINQ queries to the data source being queried.</span></span> <span data-ttu-id="2bac3-117">Quand vous écrivez une requête LINQ, le fournisseur prend cette requête et la traduit en commandes que la source de données sera en mesure d'exécuter.</span><span class="sxs-lookup"><span data-stu-id="2bac3-117">When you write a LINQ query, the provider takes that query and translates it into commands that the data source will be able to execute.</span></span> <span data-ttu-id="2bac3-118">Le fournisseur convertit également des données de la source en objets qui composent votre résultat de la requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-118">The provider also converts data from the source to the objects that make up your query result.</span></span> <span data-ttu-id="2bac3-119">Enfin, il convertit des objets en données quand vous envoyez des mises à jour à la source de données.</span><span class="sxs-lookup"><span data-stu-id="2bac3-119">Finally, it converts objects to data when you send updates to the data source.</span></span>  
  
 <span data-ttu-id="2bac3-120">Visual Basic comprend les fournisseurs LINQ suivants.</span><span class="sxs-lookup"><span data-stu-id="2bac3-120">Visual Basic includes the following LINQ providers.</span></span>  
  
|<span data-ttu-id="2bac3-121">Fournisseur</span><span class="sxs-lookup"><span data-stu-id="2bac3-121">Provider</span></span>|<span data-ttu-id="2bac3-122">Description</span><span class="sxs-lookup"><span data-stu-id="2bac3-122">Description</span></span>|  
|---|---|  
|<span data-ttu-id="2bac3-123">LINQ to Objects</span><span class="sxs-lookup"><span data-stu-id="2bac3-123">LINQ to Objects</span></span>|<span data-ttu-id="2bac3-124">Le fournisseur LINQ to Objects vous permet d'interroger des collections et des tableaux en mémoire.</span><span class="sxs-lookup"><span data-stu-id="2bac3-124">The LINQ to Objects provider enables you to query in-memory collections and arrays.</span></span> <span data-ttu-id="2bac3-125">Si un objet prend en charge l'interface <xref:System.Collections.IEnumerable> ou <xref:System.Collections.Generic.IEnumerable%601>, le fournisseur LINQ to Objects vous permet de l'interroger.</span><span class="sxs-lookup"><span data-stu-id="2bac3-125">If an object supports either the <xref:System.Collections.IEnumerable> or <xref:System.Collections.Generic.IEnumerable%601> interface, the LINQ to Objects provider enables you to query it.</span></span><br /><br /> <span data-ttu-id="2bac3-126">Vous pouvez activer le fournisseur de LINQ to Objects en important l’espace de noms <xref:System.Linq>, qui est importé par défaut pour tous les projets Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="2bac3-126">You can enable the LINQ to Objects provider by importing the <xref:System.Linq> namespace, which is imported by default for all Visual Basic projects.</span></span><br /><br /> <span data-ttu-id="2bac3-127">Pour plus d’informations sur le fournisseur de LINQ to Objects, consultez [LINQ to Objects](../../concepts/linq/linq-to-objects.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-127">For more information about the LINQ to Objects provider, see [LINQ to Objects](../../concepts/linq/linq-to-objects.md).</span></span>|  
|<span data-ttu-id="2bac3-128">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="2bac3-128">LINQ to SQL</span></span>|<span data-ttu-id="2bac3-129">Le fournisseur LINQ to SQL vous permet d'interroger et de modifier des données dans une base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="2bac3-129">The LINQ to SQL provider enables you to query and modify data in a SQL Server database.</span></span> <span data-ttu-id="2bac3-130">Cela facilite le mappage du modèle objet d'une application aux tables et objets d'une base de données.</span><span class="sxs-lookup"><span data-stu-id="2bac3-130">This makes it easy to map the object model for an application to the tables and objects in a database.</span></span><br /><br /> <span data-ttu-id="2bac3-131">Visual Basic simplifie l’utilisation de LINQ to SQL en incluant le Concepteur Objet Relationnel (Concepteur O/R).</span><span class="sxs-lookup"><span data-stu-id="2bac3-131">Visual Basic makes it easier to work with LINQ to SQL by including the Object Relational Designer (O/R Designer).</span></span> <span data-ttu-id="2bac3-132">Ce concepteur est utilisé pour créer un modèle objet dans une application qui effectue un mappage aux objets d'une base de données.</span><span class="sxs-lookup"><span data-stu-id="2bac3-132">This designer is used to create an object model in an application that maps to objects in a database.</span></span> <span data-ttu-id="2bac3-133">Le Concepteur O/R fournit également des fonctionnalités permettant de mapper des procédures stockées et des fonctions à l’objet <xref:System.Data.Linq.DataContext>, qui gère la communication avec la base de données et stocke l’état des contrôles d’accès concurrentiel optimiste.</span><span class="sxs-lookup"><span data-stu-id="2bac3-133">The O/R Designer also provides functionality to map stored procedures and functions to the <xref:System.Data.Linq.DataContext> object, which manages communication with the database and stores state for optimistic concurrency checks.</span></span><br /><br /> <span data-ttu-id="2bac3-134">Pour plus d’informations sur le fournisseur de LINQ to SQL, consultez [LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-134">For more information about the LINQ to SQL provider, see [LINQ to SQL](../../../../framework/data/adonet/sql/linq/index.md).</span></span> <span data-ttu-id="2bac3-135">Pour plus d’informations sur la Concepteur Objet Relationnel, consultez [LINQ to SQL Tools dans Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2).</span><span class="sxs-lookup"><span data-stu-id="2bac3-135">For more information about the Object Relational Designer, see [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2).</span></span>|  
|<span data-ttu-id="2bac3-136">LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="2bac3-136">LINQ to XML</span></span>|<span data-ttu-id="2bac3-137">Le fournisseur LINQ to XML vous permet d'interroger et de modifier du code XML.</span><span class="sxs-lookup"><span data-stu-id="2bac3-137">The LINQ to XML provider enables you to query and modify XML.</span></span> <span data-ttu-id="2bac3-138">Vous pouvez modifier du code XML en mémoire ou le charger à partir d'un fichier, mais également l'enregistrer dans un fichier.</span><span class="sxs-lookup"><span data-stu-id="2bac3-138">You can modify in-memory XML, or you can load XML from and save XML to a file.</span></span><br /><br /> <span data-ttu-id="2bac3-139">En outre, le fournisseur LINQ to XML active des littéraux XML et des propriétés d’axe XML qui vous permettent d’écrire du code XML directement dans votre code Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="2bac3-139">Additionally, the LINQ to XML provider enables XML literals and XML axis properties that enable you to write XML directly in your Visual Basic code.</span></span> <span data-ttu-id="2bac3-140">Pour plus d’informations, consultez [XML](../../../../visual-basic/programming-guide/language-features/xml/index.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-140">For more information, see [XML](../../../../visual-basic/programming-guide/language-features/xml/index.md).</span></span>|  
|<span data-ttu-id="2bac3-141">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="2bac3-141">LINQ to DataSet</span></span>|<span data-ttu-id="2bac3-142">Le fournisseur LINQ to DataSet vous permet d’interroger et de mettre à jour des données dans un jeu de données ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="2bac3-142">The LINQ to DataSet provider enables you to query and update data in an ADO.NET dataset.</span></span> <span data-ttu-id="2bac3-143">Vous pouvez ajouter la puissance de LINQ aux applications qui utilisent des groupes de données afin de simplifier et d'étendre vos capacités de requête, d'agrégation et de mise à jour des données dans votre dataset.</span><span class="sxs-lookup"><span data-stu-id="2bac3-143">You can add the power of LINQ to applications that use datasets in order to simplify and extend your capabilities for querying, aggregating, and updating the data in your dataset.</span></span><br /><br /> <span data-ttu-id="2bac3-144">Pour plus d’informations, [consultez LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-144">For more information, see [LINQ to DataSet](../../../../framework/data/adonet/linq-to-dataset.md).</span></span>|  
  
## <a name="structure-of-a-linq-query"></a><span data-ttu-id="2bac3-145">Structure d’une requête LINQ</span><span class="sxs-lookup"><span data-stu-id="2bac3-145">Structure of a LINQ query</span></span>  
 <span data-ttu-id="2bac3-146">Une requête LINQ, souvent appelée *expression de requête*, se compose d’une combinaison de clauses de requête qui identifient les sources de données et les variables d’itération pour la requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-146">A LINQ query, often referred to as a *query expression*, consists of a combination of query clauses that identify the data sources and iteration variables for the query.</span></span> <span data-ttu-id="2bac3-147">Une expression de requête peut également inclure des instructions de tri, de filtrage, de regroupement et de jonction ou des calculs applicables aux données sources.</span><span class="sxs-lookup"><span data-stu-id="2bac3-147">A query expression can also include instructions for sorting, filtering, grouping, and joining, or calculations to apply to the source data.</span></span> <span data-ttu-id="2bac3-148">La syntaxe de l'expression de requête ressemble à la syntaxe de SQL ; par conséquent, une grande partie de cette syntaxe vous semblera familière.</span><span class="sxs-lookup"><span data-stu-id="2bac3-148">Query expression syntax resembles the syntax of SQL; therefore, you may find much of the syntax familiar.</span></span>  
  
 <span data-ttu-id="2bac3-149">Une expression de requête commence par une clause `From`.</span><span class="sxs-lookup"><span data-stu-id="2bac3-149">A query expression starts with a `From` clause.</span></span> <span data-ttu-id="2bac3-150">Cette clause identifie les données sources d'une requête et les variables utilisées pour faire individuellement référence à chaque élément des données sources.</span><span class="sxs-lookup"><span data-stu-id="2bac3-150">This clause identifies the source data for a query and the variables that are used to refer to each element of the source data individually.</span></span> <span data-ttu-id="2bac3-151">Ces variables sont des variables de *plages* nommées ou des *variables d’itération*.</span><span class="sxs-lookup"><span data-stu-id="2bac3-151">These variables are named *range variables* or *iteration variables*.</span></span> <span data-ttu-id="2bac3-152">La clause `From` est nécessaire pour une requête, à l'exception des requêtes `Aggregate`, où la clause `From` est facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-152">The `From` clause is required for a query, except for `Aggregate` queries, where the `From` clause is optional.</span></span> <span data-ttu-id="2bac3-153">Après avoir identifié la portée et la source de la requête dans les clauses `From` ou `Aggregate`, vous pouvez inclure toute combinaison de clauses de requête pour affiner la requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-153">After the scope and source of the query are identified in the `From` or `Aggregate` clauses, you can include any combination of query clauses to refine the query.</span></span> <span data-ttu-id="2bac3-154">Pour plus d’informations sur les clauses de requête, consultez Visual Basic opérateurs de requête LINQ plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="2bac3-154">For details about query clauses, see Visual Basic LINQ Query Operators later in this topic.</span></span> <span data-ttu-id="2bac3-155">Par exemple, la requête suivante identifie une collection de sources de données client comme variable `customers` et une variable d’itération appelée `cust`.</span><span class="sxs-lookup"><span data-stu-id="2bac3-155">For example, the following query identifies a source collection of customer data as the `customers` variable, and an iteration variable named `cust`.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#2)]  
  
 <span data-ttu-id="2bac3-156">Cet exemple représente une requête valide en elle-même ; toutefois, la requête gagne en puissance quand vous ajoutez davantage de clauses de requête pour affiner le résultat.</span><span class="sxs-lookup"><span data-stu-id="2bac3-156">This example is a valid query by itself; however, the query becomes far more powerful when you add more query clauses to refine the result.</span></span> <span data-ttu-id="2bac3-157">Par exemple, vous pouvez ajouter une clause `Where` pour filtrer le résultat en fonction d'une ou plusieurs valeurs.</span><span class="sxs-lookup"><span data-stu-id="2bac3-157">For example, you can add a `Where` clause to filter the result by one or more values.</span></span> <span data-ttu-id="2bac3-158">Les expressions de requête forment une ligne unique de code ; il vous suffit d'ajouter des clauses de requête supplémentaires à la fin de la requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-158">Query expressions are a single line of code; you can just append additional query clauses to the end of the query.</span></span> <span data-ttu-id="2bac3-159">Vous pouvez décomposer une requête sur plusieurs lignes de texte pour améliorer la lisibilité en utilisant le caractère de continuation de ligne de soulignement (\_).</span><span class="sxs-lookup"><span data-stu-id="2bac3-159">You can break up a query across multiple lines of text to improve readability by using the underscore (\_) line-continuation character.</span></span> <span data-ttu-id="2bac3-160">L'exemple de code suivant illustre une requête qui inclut une clause `Where`.</span><span class="sxs-lookup"><span data-stu-id="2bac3-160">The following code example shows an example of a query that includes a `Where` clause.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#3)]  
  
 <span data-ttu-id="2bac3-161">Autre clause de requête performante, la clause `Select` vous permet de retourner uniquement des champs sélectionnés de la source de données.</span><span class="sxs-lookup"><span data-stu-id="2bac3-161">Another powerful query clause is the `Select` clause, which enables you to return only selected fields from the data source.</span></span> <span data-ttu-id="2bac3-162">Les requêtes LINQ retournent des collections énumérables d'objets fortement typés.</span><span class="sxs-lookup"><span data-stu-id="2bac3-162">LINQ queries return enumerable collections of strongly typed objects.</span></span> <span data-ttu-id="2bac3-163">Une requête peut retourner une collection de types anonymes ou nommés.</span><span class="sxs-lookup"><span data-stu-id="2bac3-163">A query can return a collection of anonymous types or named types.</span></span> <span data-ttu-id="2bac3-164">Vous pouvez utiliser la clause `Select` pour retourner uniquement un champ de la source de données.</span><span class="sxs-lookup"><span data-stu-id="2bac3-164">You can use the `Select` clause to return only a single field from the data source.</span></span> <span data-ttu-id="2bac3-165">Dans ce cas, le type de la collection retournée est le type de ce champ unique.</span><span class="sxs-lookup"><span data-stu-id="2bac3-165">When you do this, the type of the collection returned is the type of that single field.</span></span> <span data-ttu-id="2bac3-166">Vous pouvez également utiliser la clause `Select` pour retourner plusieurs champs de la source de données.</span><span class="sxs-lookup"><span data-stu-id="2bac3-166">You can also use the `Select` clause to return multiple fields from the data source.</span></span> <span data-ttu-id="2bac3-167">Dans ce cas, le type de la collection retournée est un nouveau type anonyme.</span><span class="sxs-lookup"><span data-stu-id="2bac3-167">When you do this, the type of the collection returned is a new anonymous type.</span></span> <span data-ttu-id="2bac3-168">Vous pouvez également faire correspondre les champs retournés par la requête aux champs d'un type nommé spécifié.</span><span class="sxs-lookup"><span data-stu-id="2bac3-168">You can also match the fields returned by the query to the fields of a specified named type.</span></span> <span data-ttu-id="2bac3-169">L’exemple de code suivant affiche une expression de requête qui retourne une collection de types anonymes dont les membres sont remplis des données des champs sélectionnés de la source de données.</span><span class="sxs-lookup"><span data-stu-id="2bac3-169">The following code example shows a query expression that returns a collection of anonymous types that have members populated with data from the selected fields from the data source.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#4)]  
  
 <span data-ttu-id="2bac3-170">Les requêtes LINQ peuvent également être utilisées pour combiner plusieurs sources de données et retourner un résultat unique.</span><span class="sxs-lookup"><span data-stu-id="2bac3-170">LINQ queries can also be used to combine multiple sources of data and return a single result.</span></span> <span data-ttu-id="2bac3-171">Cette opération peut être effectuée à l'aide d'une ou plusieurs clauses `From` ou en utilisant les clauses de requête `Join` ou `Group Join`.</span><span class="sxs-lookup"><span data-stu-id="2bac3-171">This can be done with one or more `From` clauses, or by using the `Join` or `Group Join` query clauses.</span></span> <span data-ttu-id="2bac3-172">L'exemple de code suivant illustre une expression de requête qui combine des données de client et de commande et retourne une collection de types anonymes contenant ces deux types de données.</span><span class="sxs-lookup"><span data-stu-id="2bac3-172">The following code example shows a query expression that combines customer and order data and returns a collection of anonymous types containing customer and order data.</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#5)]  
  
 <span data-ttu-id="2bac3-173">Vous pouvez utiliser la clause `Group Join` pour créer un résultat de requête hiérarchique contenant une collection d'objets customer.</span><span class="sxs-lookup"><span data-stu-id="2bac3-173">You can use the `Group Join` clause to create a hierarchical query result that contains a collection of customer objects.</span></span> <span data-ttu-id="2bac3-174">Chaque objet customer possède une propriété contenant une collection de toutes les commandes de ce client.</span><span class="sxs-lookup"><span data-stu-id="2bac3-174">Each customer object has a property that contains a collection of all orders for that customer.</span></span> <span data-ttu-id="2bac3-175">L'exemple de code suivant affiche une expression de requête qui combine des données client/commande sous forme de résultat hiérarchique et retourne une collection de types anonymes.</span><span class="sxs-lookup"><span data-stu-id="2bac3-175">The following code example shows a query expression that combines customer and order data as a hierarchical result and returns a collection of anonymous types.</span></span> <span data-ttu-id="2bac3-176">La requête retourne un type qui inclut une propriété `CustomerOrders` contenant une collection de données de commande pour le client.</span><span class="sxs-lookup"><span data-stu-id="2bac3-176">The query returns a type that includes a `CustomerOrders` property that contains a collection of order data for the customer.</span></span> <span data-ttu-id="2bac3-177">Il inclut également une propriété `OrderTotal` qui contient la somme des totaux pour toutes les commandes de ce client.</span><span class="sxs-lookup"><span data-stu-id="2bac3-177">It also includes an `OrderTotal` property that contains the sum of the totals for all the orders for that customer.</span></span> <span data-ttu-id="2bac3-178">(Cette requête est équivalente à une JOINTURE EXTERNE GAUCHE.)</span><span class="sxs-lookup"><span data-stu-id="2bac3-178">(This query is equivalent to a LEFT OUTER JOIN.)</span></span>  
  
 [!code-vb[VbVbalrIntroToLINQ#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/class2.vb#6)]  
  
 <span data-ttu-id="2bac3-179">Il existe plusieurs opérateurs de requête LINQ supplémentaires qui vous permettent de créer des expressions de requête puissantes.</span><span class="sxs-lookup"><span data-stu-id="2bac3-179">There are several additional LINQ query operators that you can use to create powerful query expressions.</span></span> <span data-ttu-id="2bac3-180">La section suivante de cette rubrique présente les différentes clauses de requête que vous pouvez inclure dans une expression de requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-180">The next section of this topic discusses the various query clauses that you can include in a query expression.</span></span> <span data-ttu-id="2bac3-181">Pour plus d’informations sur Visual Basic clauses de requête, consultez [requêtes](../../../../visual-basic/language-reference/queries/index.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-181">For details about Visual Basic query clauses, see [Queries](../../../../visual-basic/language-reference/queries/index.md).</span></span>  
  
## <a name="visual-basic-linq-query-operators"></a><span data-ttu-id="2bac3-182">Visual Basic opérateurs de requête LINQ</span><span class="sxs-lookup"><span data-stu-id="2bac3-182">Visual Basic LINQ query operators</span></span>  

<span data-ttu-id="2bac3-183">Les classes de l'espace de noms <xref:System.Linq> et des autres espaces de noms qui prennent en charge les requêtes LINQ incluent des méthodes que vous pouvez appeler pour créer et affiner les requêtes en fonction des besoins de votre application.</span><span class="sxs-lookup"><span data-stu-id="2bac3-183">The classes in the <xref:System.Linq> namespace and the other namespaces that support LINQ queries include methods that you can call to create and refine queries based on the needs of your application.</span></span> <span data-ttu-id="2bac3-184">Visual Basic comprend des mots clés pour les clauses de requête communes suivantes.</span><span class="sxs-lookup"><span data-stu-id="2bac3-184">Visual Basic includes keywords for the following common query clauses.</span></span> <span data-ttu-id="2bac3-185">Pour plus d’informations sur Visual Basic clauses de requête, consultez [requêtes](../../../language-reference/queries/index.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-185">For details about Visual Basic query clauses, see [Queries](../../../language-reference/queries/index.md).</span></span>

### <a name="from-clause"></a><span data-ttu-id="2bac3-186">Clause From</span><span class="sxs-lookup"><span data-stu-id="2bac3-186">From clause</span></span>

<span data-ttu-id="2bac3-187">Une clause [`From`](../../../../visual-basic/language-reference/queries/from-clause.md) ou une clause `Aggregate` est nécessaire pour commencer une requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-187">Either a [`From` clause](../../../../visual-basic/language-reference/queries/from-clause.md) or an `Aggregate` clause is required to begin a query.</span></span> <span data-ttu-id="2bac3-188">Une clause `From` spécifie une collection de sources et une variable d'itération pour une requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-188">A `From` clause specifies a source collection and an iteration variable for a query.</span></span> <span data-ttu-id="2bac3-189">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-189">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#7)]

### <a name="select-clause"></a><span data-ttu-id="2bac3-190">Select (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-190">Select clause</span></span>

<span data-ttu-id="2bac3-191">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-191">Optional.</span></span> <span data-ttu-id="2bac3-192">Une [clause`Select`](../../../../visual-basic/language-reference/queries/select-clause.md) déclare un ensemble de variables d’itération pour une requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-192">A [`Select` clause](../../../../visual-basic/language-reference/queries/select-clause.md) declares a set of iteration variables for a query.</span></span> <span data-ttu-id="2bac3-193">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-193">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#8)]

<span data-ttu-id="2bac3-194">Si une clause `Select` n'est pas spécifiée, les variables d'itération de la requête se composent des variables d'itération spécifiées par la clause `From` ou `Aggregate`.</span><span class="sxs-lookup"><span data-stu-id="2bac3-194">If a `Select` clause is not specified, the iteration variables for the query consist of the iteration variables specified by the `From` or `Aggregate` clause.</span></span>

### <a name="where-clause"></a><span data-ttu-id="2bac3-195">Where (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-195">Where clause</span></span>

<span data-ttu-id="2bac3-196">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-196">Optional.</span></span> <span data-ttu-id="2bac3-197">Une [clause`Where`](../../../../visual-basic/language-reference/queries/where-clause.md) spécifie une condition de filtrage pour une requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-197">A [`Where` clause](../../../../visual-basic/language-reference/queries/where-clause.md) specifies a filtering condition for a query.</span></span> <span data-ttu-id="2bac3-198">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-198">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#9)]

### <a name="order-by-clause"></a><span data-ttu-id="2bac3-199">Order By (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-199">Order By clause</span></span>

<span data-ttu-id="2bac3-200">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-200">Optional.</span></span> <span data-ttu-id="2bac3-201">Une [clause`Order By`](../../../../visual-basic/language-reference/queries/order-by-clause.md) spécifie l’ordre de tri des colonnes dans une requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-201">An [`Order By` clause](../../../../visual-basic/language-reference/queries/order-by-clause.md) specifies the sort order for columns in a query.</span></span> <span data-ttu-id="2bac3-202">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-202">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#10)]

### <a name="join-clause"></a><span data-ttu-id="2bac3-203">Join (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-203">Join clause</span></span>

<span data-ttu-id="2bac3-204">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-204">Optional.</span></span> <span data-ttu-id="2bac3-205">Une [clause`Join`](../../../../visual-basic/language-reference/queries/join-clause.md) combine deux collections en une collection unique.</span><span class="sxs-lookup"><span data-stu-id="2bac3-205">A [`Join` clause](../../../../visual-basic/language-reference/queries/join-clause.md) combines two collections into a single collection.</span></span> <span data-ttu-id="2bac3-206">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-206">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#11](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#11)]

### <a name="group-by-clause"></a><span data-ttu-id="2bac3-207">Group By (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-207">Group By clause</span></span>

<span data-ttu-id="2bac3-208">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-208">Optional.</span></span> <span data-ttu-id="2bac3-209">Une [clause`Group By`](../../../../visual-basic/language-reference/queries/group-by-clause.md) regroupe les éléments d’un résultat de requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-209">A [`Group By` clause](../../../../visual-basic/language-reference/queries/group-by-clause.md) groups the elements of a query result.</span></span> <span data-ttu-id="2bac3-210">Elle peut être utilisée pour appliquer des fonctions d’agrégation à chaque groupe.</span><span class="sxs-lookup"><span data-stu-id="2bac3-210">It can be used to apply aggregate functions to each group.</span></span> <span data-ttu-id="2bac3-211">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-211">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#12](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#12)]

### <a name="group-join-clause"></a><span data-ttu-id="2bac3-212">Group Join (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-212">Group Join clause</span></span>

<span data-ttu-id="2bac3-213">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-213">Optional.</span></span> <span data-ttu-id="2bac3-214">Une [clause`Group Join`](../../../../visual-basic/language-reference/queries/group-join-clause.md) combine deux collections en une collection hiérarchique unique.</span><span class="sxs-lookup"><span data-stu-id="2bac3-214">A [`Group Join` clause](../../../../visual-basic/language-reference/queries/group-join-clause.md) combines two collections into a single hierarchical collection.</span></span> <span data-ttu-id="2bac3-215">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-215">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#13)]

### <a name="aggregate-clause"></a><span data-ttu-id="2bac3-216">Aggregate (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-216">Aggregate clause</span></span>

<span data-ttu-id="2bac3-217">Une clause [`Aggregate`](../../../../visual-basic/language-reference/queries/aggregate-clause.md) ou une clause `From` est nécessaire pour commencer une requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-217">Either an [`Aggregate` clause](../../../../visual-basic/language-reference/queries/aggregate-clause.md) or a `From` clause is required to begin a query.</span></span> <span data-ttu-id="2bac3-218">Une clause `Aggregate` applique une ou plusieurs fonctions d’agrégation à une collection.</span><span class="sxs-lookup"><span data-stu-id="2bac3-218">An `Aggregate` clause applies one or more aggregate functions to a collection.</span></span> <span data-ttu-id="2bac3-219">Par exemple, vous pouvez utiliser la clause `Aggregate` pour calculer une somme pour tous les éléments retournés par une requête, comme l’illustre l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="2bac3-219">For example, you can use the `Aggregate` clause to calculate a sum for all the elements returned by a query, as the following example does.</span></span>

 [!code-vb[VbVbalrIntroToLINQ#14](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#14)]

<span data-ttu-id="2bac3-220">Vous pouvez également utiliser la clause `Aggregate` pour modifier une requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-220">You can also use the `Aggregate` clause to modify a query.</span></span> <span data-ttu-id="2bac3-221">Par exemple, vous pouvez utiliser la clause `Aggregate` pour effectuer un calcul sur une collection de requêtes connexe.</span><span class="sxs-lookup"><span data-stu-id="2bac3-221">For example, you can use the `Aggregate` clause to perform a calculation on a related query collection.</span></span> <span data-ttu-id="2bac3-222">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-222">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#15)]

### <a name="let-clause"></a><span data-ttu-id="2bac3-223">Let (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-223">Let clause</span></span>

<span data-ttu-id="2bac3-224">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-224">Optional.</span></span> <span data-ttu-id="2bac3-225">Une [clause`Let`](../../../../visual-basic/language-reference/queries/let-clause.md) calcule une valeur et l’assigne à une nouvelle variable dans la requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-225">A [`Let` clause](../../../../visual-basic/language-reference/queries/let-clause.md) computes a value and assigns it to a new variable in the query.</span></span> <span data-ttu-id="2bac3-226">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-226">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#16](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#16)]

### <a name="distinct-clause"></a><span data-ttu-id="2bac3-227">Distinct (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-227">Distinct clause</span></span>

<span data-ttu-id="2bac3-228">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-228">Optional.</span></span> <span data-ttu-id="2bac3-229">Une clause `Distinct` restreint les valeurs de la variable d’itération actuelle pour éliminer les valeurs en double dans les résultats de la requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-229">A `Distinct` clause restricts the values of the current iteration variable to eliminate duplicate values in query results.</span></span> <span data-ttu-id="2bac3-230">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-230">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#17](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#17)]

### <a name="skip-clause"></a><span data-ttu-id="2bac3-231">Skip (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-231">Skip clause</span></span>

<span data-ttu-id="2bac3-232">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-232">Optional.</span></span> <span data-ttu-id="2bac3-233">Une [clause`Skip`](../../../../visual-basic/language-reference/queries/skip-clause.md) ignore un nombre spécifié d’éléments dans une collection, puis retourne les éléments restants.</span><span class="sxs-lookup"><span data-stu-id="2bac3-233">A [`Skip` clause](../../../../visual-basic/language-reference/queries/skip-clause.md) bypasses a specified number of elements in a collection and then returns the remaining elements.</span></span> <span data-ttu-id="2bac3-234">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-234">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#18](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#18)]

### <a name="skip-while-clause"></a><span data-ttu-id="2bac3-235">SkipWhile (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-235">Skip While clause</span></span>

<span data-ttu-id="2bac3-236">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-236">Optional.</span></span> <span data-ttu-id="2bac3-237">Une [clause`Skip While`](../../../../visual-basic/language-reference/queries/skip-while-clause.md) ignore les éléments d’une collection tant qu’une condition spécifiée est `true` puis retourne les éléments restants.</span><span class="sxs-lookup"><span data-stu-id="2bac3-237">A [`Skip While` clause](../../../../visual-basic/language-reference/queries/skip-while-clause.md) bypasses elements in a collection as long as a specified condition is `true` and then returns the remaining elements.</span></span> <span data-ttu-id="2bac3-238">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-238">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#19](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#19)]

### <a name="take-clause"></a><span data-ttu-id="2bac3-239">Take (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-239">Take clause</span></span>

<span data-ttu-id="2bac3-240">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-240">Optional.</span></span> <span data-ttu-id="2bac3-241">Une [clause`Take`](../../../../visual-basic/language-reference/queries/take-clause.md) retourne un nombre spécifié d’éléments contigus à partir du début d’une collection.</span><span class="sxs-lookup"><span data-stu-id="2bac3-241">A [`Take` clause](../../../../visual-basic/language-reference/queries/take-clause.md) returns a specified number of contiguous elements from the start of a collection.</span></span> <span data-ttu-id="2bac3-242">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-242">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#20](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#20)]

### <a name="take-while-clause"></a><span data-ttu-id="2bac3-243">Take While (clause)</span><span class="sxs-lookup"><span data-stu-id="2bac3-243">Take While clause</span></span>

<span data-ttu-id="2bac3-244">Option facultative.</span><span class="sxs-lookup"><span data-stu-id="2bac3-244">Optional.</span></span> <span data-ttu-id="2bac3-245">Une [clause`Take While`](../../../../visual-basic/language-reference/queries/take-while-clause.md) comprend des éléments dans une collection tant qu’une condition spécifiée est `true` et ignore les éléments restants.</span><span class="sxs-lookup"><span data-stu-id="2bac3-245">A [`Take While` clause](../../../../visual-basic/language-reference/queries/take-while-clause.md) includes elements in a collection as long as a specified condition is `true` and bypasses the remaining elements.</span></span> <span data-ttu-id="2bac3-246">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2bac3-246">For example:</span></span>

 [!code-vb[VbVbalrIntroToLINQ#21](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#21)]
  
## <a name="use-additional-linq-query-features"></a><span data-ttu-id="2bac3-247">Utiliser des fonctionnalités de requête LINQ supplémentaires</span><span class="sxs-lookup"><span data-stu-id="2bac3-247">Use additional LINQ query features</span></span>  
  
<span data-ttu-id="2bac3-248">Vous pouvez utiliser des fonctionnalités de requête LINQ supplémentaires en appelant des membres des types énumérables et requêtables fournis par LINQ.</span><span class="sxs-lookup"><span data-stu-id="2bac3-248">You can use additional LINQ query features by calling members of the enumerable and queryable types provided by LINQ.</span></span> <span data-ttu-id="2bac3-249">Vous pouvez utiliser ces fonctions supplémentaires en appelant un opérateur de requête particulier sur le résultat d'une expression de requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-249">You can use these additional capabilities by calling a particular query operator on the result of a query expression.</span></span> <span data-ttu-id="2bac3-250">Par exemple, l’exemple suivant utilise la méthode <xref:System.Linq.Enumerable.Union%2A?displayProperty=nameWithType> pour combiner les résultats de deux requêtes en un seul résultat de requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-250">For example, the following example uses the <xref:System.Linq.Enumerable.Union%2A?displayProperty=nameWithType> method to combine the results of two queries into one query result.</span></span> <span data-ttu-id="2bac3-251">Il utilise la méthode <xref:System.Linq.Enumerable.ToList%2A?displayProperty=nameWithType> pour retourner le résultat de la requête sous forme de liste générique.</span><span class="sxs-lookup"><span data-stu-id="2bac3-251">It uses the <xref:System.Linq.Enumerable.ToList%2A?displayProperty=nameWithType> method to return the query result as a generic list.</span></span>
  
 [!code-vb[VbVbalrIntroToLINQ#22](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrIntroToLINQ/VB/Class1.vb#22)]  
  
 <span data-ttu-id="2bac3-252">Pour plus d’informations sur les fonctionnalités LINQ supplémentaires, consultez [vue d’ensemble des opérateurs de requête standard](../../concepts/linq/standard-query-operators-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-252">For details about additional LINQ capabilities, see [Standard Query Operators Overview](../../concepts/linq/standard-query-operators-overview.md).</span></span>  
  
## <a name="connect-to-a-database-by-using-linq-to-sql"></a><span data-ttu-id="2bac3-253">Se connecter à une base de données à l’aide de LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="2bac3-253">Connect to a database by using LINQ to SQL</span></span>  
 <span data-ttu-id="2bac3-254">Dans Visual Basic, vous identifiez les objets de base de données SQL Server, tels que les tables, les vues et les procédures stockées, auxquels vous souhaitez accéder à l’aide d’un fichier de LINQ to SQL.</span><span class="sxs-lookup"><span data-stu-id="2bac3-254">In Visual Basic, you identify the SQL Server database objects, such as tables, views, and stored procedures, that you want to access by using a LINQ to SQL file.</span></span> <span data-ttu-id="2bac3-255">Un fichier LINQ to SQL possède une extension .dbml.</span><span class="sxs-lookup"><span data-stu-id="2bac3-255">A LINQ to SQL file has an extension of .dbml.</span></span>  
  
 <span data-ttu-id="2bac3-256">Lorsque vous disposez d’une connexion valide à une base de données SQL Server, vous pouvez ajouter un modèle d’élément de **Classes LINQ to SQL** à votre projet.</span><span class="sxs-lookup"><span data-stu-id="2bac3-256">When you have a valid connection to a SQL Server database, you can add a **LINQ to SQL Classes** item template to your project.</span></span> <span data-ttu-id="2bac3-257">Le Concepteur Objet Relationnel (Concepteur O/R) s'affiche alors.</span><span class="sxs-lookup"><span data-stu-id="2bac3-257">This will display the Object Relational Designer (O/R designer).</span></span> <span data-ttu-id="2bac3-258">Le Concepteur O/R vous permet de faire glisser les éléments auxquels vous souhaitez accéder dans votre code à partir de la **Explorateur de serveurs**/**Explorateur de base de données** sur l’aire du concepteur.</span><span class="sxs-lookup"><span data-stu-id="2bac3-258">The O/R Designer enables you to drag the items that you want to access in your code from the **Server Explorer**/**Database Explorer** onto the designer surface.</span></span> <span data-ttu-id="2bac3-259">Le fichier LINQ to SQL ajoute un objet <xref:System.Data.Linq.DataContext> à votre projet.</span><span class="sxs-lookup"><span data-stu-id="2bac3-259">The LINQ to SQL file adds a <xref:System.Data.Linq.DataContext> object to your project.</span></span> <span data-ttu-id="2bac3-260">Cet objet inclut des propriétés et des collections pour les tables et vues auxquelles vous souhaitez accéder, et aux méthodes des procédures stockées que vous souhaitez appeler.</span><span class="sxs-lookup"><span data-stu-id="2bac3-260">This object includes properties and collections for the tables and views that you want access to, and methods for the stored procedures that you want to call.</span></span> <span data-ttu-id="2bac3-261">Après avoir enregistré vos modifications dans le fichier LINQ to SQL (.dbml), vous pouvez accéder à ces objets dans votre code en référençant l'objet <xref:System.Data.Linq.DataContext> défini par le Concepteur O/R.</span><span class="sxs-lookup"><span data-stu-id="2bac3-261">After you have saved your changes to the LINQ to SQL (.dbml) file, you can access these objects in your code by referencing the <xref:System.Data.Linq.DataContext> object that is defined by the O/R Designer.</span></span> <span data-ttu-id="2bac3-262">L'objet <xref:System.Data.Linq.DataContext> de votre projet est nommé d'après le nom de votre fichier LINQ to SQL.</span><span class="sxs-lookup"><span data-stu-id="2bac3-262">The <xref:System.Data.Linq.DataContext> object for your project is named based on the name of your LINQ to SQL file.</span></span> <span data-ttu-id="2bac3-263">Par exemple, un fichier LINQ to SQL nommé Northwind.dbml créera un objet <xref:System.Data.Linq.DataContext> nommé `NorthwindDataContext`.</span><span class="sxs-lookup"><span data-stu-id="2bac3-263">For example, a LINQ to SQL file that is named Northwind.dbml will create a <xref:System.Data.Linq.DataContext> object named `NorthwindDataContext`.</span></span>  
  
 <span data-ttu-id="2bac3-264">Pour obtenir des exemples d’instructions pas à pas, consultez [Comment : interroger une base de données](how-to-query-a-database-by-using-linq.md) et [Comment : appeler une procédure stockée](how-to-call-a-stored-procedure-by-using-linq.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-264">For examples with step-by-step instructions, see [How to: Query a Database](how-to-query-a-database-by-using-linq.md) and [How to: Call a Stored Procedure](how-to-call-a-stored-procedure-by-using-linq.md).</span></span>  
  
## <a name="visual-basic-features-that-support-linq"></a><span data-ttu-id="2bac3-265">Fonctionnalités Visual Basic qui prennent en charge LINQ</span><span class="sxs-lookup"><span data-stu-id="2bac3-265">Visual Basic features that support LINQ</span></span>  
 <span data-ttu-id="2bac3-266">Visual Basic comprend d’autres fonctionnalités notables qui facilitent l’utilisation de LINQ et réduisent la quantité de code que vous devez écrire pour effectuer des requêtes LINQ.</span><span class="sxs-lookup"><span data-stu-id="2bac3-266">Visual Basic includes other notable features that make the use of LINQ simple and reduce the amount of code that you must write to perform LINQ queries.</span></span> <span data-ttu-id="2bac3-267">Ces référentiels sont notamment les suivants :</span><span class="sxs-lookup"><span data-stu-id="2bac3-267">These include the following:</span></span>  
  
- <span data-ttu-id="2bac3-268">Les **types anonymes**, qui vous permettent de créer un nouveau type basé sur un résultat de requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-268">**Anonymous types**, which enable you to create a new type based on a query result.</span></span>  
  
- <span data-ttu-id="2bac3-269">Les **variables implicitement typées**, qui vous permettent de différer la spécification d’un type et de laisser le compilateur déduire le type en fonction du résultat de la requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-269">**Implicitly typed variables**, which enable you to defer specifying a type and let the compiler infer the type based on the query result.</span></span>  
  
- <span data-ttu-id="2bac3-270">Les **méthodes d’extension**, qui vous permettent d’étendre un type existant avec vos propres méthodes sans modifier le type lui-même.</span><span class="sxs-lookup"><span data-stu-id="2bac3-270">**Extension methods**, which enable you to extend an existing type with your own methods without modifying the type itself.</span></span>  
  
 <span data-ttu-id="2bac3-271">Pour plus d’informations, consultez [Visual Basic fonctionnalités qui prennent en charge LINQ](../../concepts/linq/features-that-support-linq.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-271">For details, see [Visual Basic Features That Support LINQ](../../concepts/linq/features-that-support-linq.md).</span></span>  
  
## <a name="deferred-and-immediate-query-execution"></a><span data-ttu-id="2bac3-272">Exécution de requête différée et immédiate</span><span class="sxs-lookup"><span data-stu-id="2bac3-272">Deferred and immediate query execution</span></span>

 <span data-ttu-id="2bac3-273">L'exécution d'une requête est distincte de sa création.</span><span class="sxs-lookup"><span data-stu-id="2bac3-273">Query execution is separate from creating a query.</span></span> <span data-ttu-id="2bac3-274">Après avoir créé une requête, son exécution est déclenchée par un mécanisme distinct.</span><span class="sxs-lookup"><span data-stu-id="2bac3-274">After a query is created, its execution is triggered by a separate mechanism.</span></span> <span data-ttu-id="2bac3-275">Une requête peut être exécutée dès qu’elle est définie (*exécution immédiate*), ou la définition peut être stockée et la requête peut être exécutée ultérieurement (*exécution différée*).</span><span class="sxs-lookup"><span data-stu-id="2bac3-275">A query can be executed as soon as it is defined (*immediate execution*), or the definition can be stored and the query can be executed later (*deferred execution*).</span></span>  
  
 <span data-ttu-id="2bac3-276">Par défaut, quand vous créez une requête, cette dernière ne s'exécute pas immédiatement.</span><span class="sxs-lookup"><span data-stu-id="2bac3-276">By default, when you create a query, the query itself does not execute immediately.</span></span> <span data-ttu-id="2bac3-277">À la place, la définition de la requête est stockée dans la variable utilisée pour référencer le résultat de la requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-277">Instead, the query definition is stored in the variable that is used to reference the query result.</span></span> <span data-ttu-id="2bac3-278">Quand vous accédez à la variable de résultat de la requête ultérieurement dans le code, par exemple, dans une boucle `For…Next`, la requête est exécutée.</span><span class="sxs-lookup"><span data-stu-id="2bac3-278">When the query result variable is accessed later in code, such as in a `For…Next` loop, the query is executed.</span></span> <span data-ttu-id="2bac3-279">Ce processus est appelé « *exécution différée*».</span><span class="sxs-lookup"><span data-stu-id="2bac3-279">This process is referred to as *deferred execution*.</span></span>  
  
 <span data-ttu-id="2bac3-280">Les requêtes peuvent également être exécutées quand elles sont définies, ce qui est appelé *exécution immédiate*.</span><span class="sxs-lookup"><span data-stu-id="2bac3-280">Queries can also be executed when they are defined, which is referred to as *immediate execution*.</span></span> <span data-ttu-id="2bac3-281">Vous pouvez déclencher l'exécution immédiate en appliquant une méthode qui requiert l'accès aux éléments individuels du résultat de la requête.</span><span class="sxs-lookup"><span data-stu-id="2bac3-281">You can trigger immediate execution by applying a method that requires access to individual elements of the query result.</span></span> <span data-ttu-id="2bac3-282">L'inclusion d'une fonction d'agrégation, telle que `Count`, `Sum`, `Average`, `Min` ou `Max` peut engendrer un tel résultat.</span><span class="sxs-lookup"><span data-stu-id="2bac3-282">This can be the result of including an aggregate function, such as `Count`, `Sum`, `Average`, `Min`, or `Max`.</span></span> <span data-ttu-id="2bac3-283">Pour plus d’informations sur les fonctions d’agrégation, consultez [Aggregate, clause](../../../language-reference/queries/aggregate-clause.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-283">For more information about aggregate functions, see [Aggregate Clause](../../../language-reference/queries/aggregate-clause.md).</span></span>  
  
 <span data-ttu-id="2bac3-284">L'utilisation de la méthode `ToList` ou `ToArray` force également l'exécution immédiate.</span><span class="sxs-lookup"><span data-stu-id="2bac3-284">Using the `ToList` or `ToArray` methods will also force immediate execution.</span></span> <span data-ttu-id="2bac3-285">Cela peut être utile quand vous souhaitez exécuter immédiatement la requête et mettre en cache les résultats.</span><span class="sxs-lookup"><span data-stu-id="2bac3-285">This can be useful when you want to execute the query immediately and cache the results.</span></span> <span data-ttu-id="2bac3-286">Pour plus d’informations sur ces méthodes, consultez [conversion des types de données](../../concepts/linq/converting-data-types.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-286">For more information about these methods, see [Converting Data Types](../../concepts/linq/converting-data-types.md).</span></span>  
  
 <span data-ttu-id="2bac3-287">Pour plus d’informations sur l’exécution des requêtes, consultez [écriture de votre première requête LINQ](../../concepts/linq/writing-your-first-linq-query.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-287">For more information about query execution, see [Writing Your First LINQ Query](../../concepts/linq/writing-your-first-linq-query.md).</span></span>  
  
## <a name="xml-in-visual-basic"></a><span data-ttu-id="2bac3-288">XML en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="2bac3-288">XML in Visual Basic</span></span>  
 <span data-ttu-id="2bac3-289">Les fonctionnalités XML de Visual Basic incluent des littéraux XML et des propriétés d’axe XML, qui vous permettent de créer, d’accéder, d’interroger et de modifier facilement du code XML dans votre code.</span><span class="sxs-lookup"><span data-stu-id="2bac3-289">The XML features in Visual Basic include XML literals and XML axis properties, which enable you easily to create, access, query, and modify XML in your code.</span></span> <span data-ttu-id="2bac3-290">Les littéraux XML vous permettent d'écrire directement en XML dans votre code.</span><span class="sxs-lookup"><span data-stu-id="2bac3-290">XML literals enable you to write XML directly in your code.</span></span> <span data-ttu-id="2bac3-291">Le compilateur Visual Basic traite le XML comme un objet de donnée de première classe.</span><span class="sxs-lookup"><span data-stu-id="2bac3-291">The Visual Basic compiler treats the XML as a first-class data object.</span></span>  
  
 <span data-ttu-id="2bac3-292">L'exemple de code suivant montre comment créer un élément XML, accéder à ses sous-éléments et attributs, et interroger son contenu à l'aide de LINQ.</span><span class="sxs-lookup"><span data-stu-id="2bac3-292">The following code example shows how to create an XML element, access its sub-elements and attributes, and query the contents of the element by using LINQ.</span></span>  
  
 [!code-vb[VbXmlSamples#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbXMLSamples/VB/XMLSamples3.vb#8)]  
  
 <span data-ttu-id="2bac3-293">Pour plus d’informations, consultez [XML](../xml/index.md).</span><span class="sxs-lookup"><span data-stu-id="2bac3-293">For more information, see [XML](../xml/index.md).</span></span>  
  
## <a name="related-resources"></a><span data-ttu-id="2bac3-294">Ressources connexes</span><span class="sxs-lookup"><span data-stu-id="2bac3-294">Related resources</span></span>  
  
|<span data-ttu-id="2bac3-295">Rubrique</span><span class="sxs-lookup"><span data-stu-id="2bac3-295">Topic</span></span>|<span data-ttu-id="2bac3-296">Description</span><span class="sxs-lookup"><span data-stu-id="2bac3-296">Description</span></span>|  
|---|---|  
|[<span data-ttu-id="2bac3-297">XML</span><span class="sxs-lookup"><span data-stu-id="2bac3-297">XML</span></span>](../../language-features/xml/index.md)|<span data-ttu-id="2bac3-298">Décrit les fonctionnalités XML de Visual Basic qui peuvent être interrogées et qui vous permettent d’inclure du XML en tant qu’objets de données de première classe dans votre code Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="2bac3-298">Describes the XML features in Visual Basic that can be queried and that enable you to include XML as first-class data objects in your Visual Basic code.</span></span>|  
|[<span data-ttu-id="2bac3-299">Requêtes</span><span class="sxs-lookup"><span data-stu-id="2bac3-299">Queries</span></span>](../../../language-reference/queries/index.md)|<span data-ttu-id="2bac3-300">Fournit des informations de référence sur les clauses de requête qui sont disponibles dans Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="2bac3-300">Provides reference information about the query clauses that are available in Visual Basic.</span></span>|  
|[<span data-ttu-id="2bac3-301">LINQ (Language Integrated Query)</span><span class="sxs-lookup"><span data-stu-id="2bac3-301">LINQ (Language-Integrated Query)</span></span>](../../concepts/linq/index.md)|<span data-ttu-id="2bac3-302">Inclut des informations générales, un guide de programmation et des exemples de requêtes LINQ.</span><span class="sxs-lookup"><span data-stu-id="2bac3-302">Includes general information, programming guidance, and samples for LINQ.</span></span>|  
|[<span data-ttu-id="2bac3-303">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="2bac3-303">LINQ to SQL</span></span>](../../../../framework/data/adonet/sql/linq/index.md)|<span data-ttu-id="2bac3-304">Inclut des informations générales, un guide de programmation et des exemples de LINQ to SQL.</span><span class="sxs-lookup"><span data-stu-id="2bac3-304">Includes general information, programming guidance, and samples for LINQ to SQL.</span></span>|  
|[<span data-ttu-id="2bac3-305">LINQ to Objects</span><span class="sxs-lookup"><span data-stu-id="2bac3-305">LINQ to Objects</span></span>](../../concepts/linq/linq-to-objects.md)|<span data-ttu-id="2bac3-306">Inclut des informations générales, un guide de programmation et des exemples de LINQ to Objects.</span><span class="sxs-lookup"><span data-stu-id="2bac3-306">Includes general information, programming guidance, and samples for LINQ to Objects.</span></span>|  
|[<span data-ttu-id="2bac3-307">LINQ to ADO.NET (page de portail)</span><span class="sxs-lookup"><span data-stu-id="2bac3-307">LINQ to ADO.NET (Portal Page)</span></span>](../../concepts/linq/linq-to-adonet-portal-page.md)|<span data-ttu-id="2bac3-308">Contient des liens vers des informations générales, des conseils de programmation et des exemples pour LINQ to ADO.NET.</span><span class="sxs-lookup"><span data-stu-id="2bac3-308">Includes links to general information, programming guidance, and samples for LINQ to ADO.NET.</span></span>|  
|[<span data-ttu-id="2bac3-309">LINQ to XML</span><span class="sxs-lookup"><span data-stu-id="2bac3-309">LINQ to XML</span></span>](../../concepts/linq/linq-to-xml.md)|<span data-ttu-id="2bac3-310">Inclut des informations générales, un guide de programmation et des exemples de LINQ to XML.</span><span class="sxs-lookup"><span data-stu-id="2bac3-310">Includes general information, programming guidance, and samples for LINQ to XML.</span></span>|  
  
## <a name="how-to-and-walkthrough-topics"></a><span data-ttu-id="2bac3-311">Rubriques de procédures et procédures pas à pas</span><span class="sxs-lookup"><span data-stu-id="2bac3-311">How to and walkthrough topics</span></span>
 [<span data-ttu-id="2bac3-312">Guide pratique : interroger une base de données</span><span class="sxs-lookup"><span data-stu-id="2bac3-312">How to: Query a Database</span></span>](how-to-query-a-database-by-using-linq.md)  
  
 [<span data-ttu-id="2bac3-313">Guide pratique : appeler une procédure stockée</span><span class="sxs-lookup"><span data-stu-id="2bac3-313">How to: Call a Stored Procedure</span></span>](how-to-call-a-stored-procedure-by-using-linq.md)  
  
 [<span data-ttu-id="2bac3-314">Guide pratique : modifier des données dans une base de données</span><span class="sxs-lookup"><span data-stu-id="2bac3-314">How to: Modify Data in a Database</span></span>](how-to-modify-data-in-a-database-by-using-linq.md)  
  
 [<span data-ttu-id="2bac3-315">Guide pratique : combiner des données avec des jointures</span><span class="sxs-lookup"><span data-stu-id="2bac3-315">How to: Combine Data with Joins</span></span>](how-to-combine-data-with-linq-by-using-joins.md)  
  
 [<span data-ttu-id="2bac3-316">Guide pratique : trier les résultats d’une requête</span><span class="sxs-lookup"><span data-stu-id="2bac3-316">How to: Sort Query Results</span></span>](how-to-sort-query-results-by-using-linq.md)  
  
 [<span data-ttu-id="2bac3-317">Guide pratique : filtrer les résultats d’une requête</span><span class="sxs-lookup"><span data-stu-id="2bac3-317">How to: Filter Query Results</span></span>](how-to-filter-query-results-by-using-linq.md)  
  
 [<span data-ttu-id="2bac3-318">Guide pratique : compter, additionner ou faire la moyenne de données</span><span class="sxs-lookup"><span data-stu-id="2bac3-318">How to: Count, Sum, or Average Data</span></span>](how-to-count-sum-or-average-data-by-using-linq.md)  
  
 [<span data-ttu-id="2bac3-319">Guide pratique : rechercher la valeur minimale ou maximale dans un résultat de requête</span><span class="sxs-lookup"><span data-stu-id="2bac3-319">How to: Find the Minimum or Maximum Value in a Query Result</span></span>](how-to-find-the-minimum-or-maximum-value-in-a-query-result.md)  
  
 [<span data-ttu-id="2bac3-320">Guide pratique pour affecter des procédures stockées pour effectuer des mises à jour, des insertions et des suppressions (Concepteur O/R)</span><span class="sxs-lookup"><span data-stu-id="2bac3-320">How to: Assign stored procedures to perform updates, inserts, and deletes (O/R Designer)</span></span>](/visualstudio/data-tools/how-to-assign-stored-procedures-to-perform-updates-inserts-and-deletes-o-r-designer)  
  
## <a name="featured-book-chapters"></a><span data-ttu-id="2bac3-321">Chapitres de livres proposés</span><span class="sxs-lookup"><span data-stu-id="2bac3-321">Featured book chapters</span></span>  
 <span data-ttu-id="2bac3-322">[Chapitre 17 : LINQ](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652502(v=orm.10)) en [programmation Visual Basic 2008](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652504(v=orm.10))</span><span class="sxs-lookup"><span data-stu-id="2bac3-322">[Chapter 17: LINQ](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652502(v=orm.10)) in [Programming Visual Basic 2008](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2008/ff652504(v=orm.10))</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2bac3-323">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2bac3-323">See also</span></span>

- [<span data-ttu-id="2bac3-324">LINQ (Language Integrated Query)</span><span class="sxs-lookup"><span data-stu-id="2bac3-324">LINQ (Language-Integrated Query)</span></span>](../../concepts/linq/index.md)
- [<span data-ttu-id="2bac3-325">Vue d’ensemble de LINQ to XML en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="2bac3-325">Overview of LINQ to XML in Visual Basic</span></span>](../../language-features/xml/overview-of-linq-to-xml.md)
- [<span data-ttu-id="2bac3-326">Vue d’ensemble de LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="2bac3-326">LINQ to DataSet Overview</span></span>](../../../../framework/data/adonet/linq-to-dataset-overview.md)
- [<span data-ttu-id="2bac3-327">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="2bac3-327">LINQ to SQL</span></span>](../../../../framework/data/adonet/sql/linq/index.md)
- [<span data-ttu-id="2bac3-328">Outils LINQ to SQL dans Visual Studio</span><span class="sxs-lookup"><span data-stu-id="2bac3-328">LINQ to SQL Tools in Visual Studio</span></span>](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2)
- [<span data-ttu-id="2bac3-329">DataContext, méthodes (Concepteur O/R)</span><span class="sxs-lookup"><span data-stu-id="2bac3-329">DataContext Methods (O/R Designer)</span></span>](/visualstudio/data-tools/datacontext-methods-o-r-designer)

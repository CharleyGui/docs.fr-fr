---
title: Types anonymes
ms.date: 07/20/2015
f1_keywords:
- vb.AnonymousType
helpviewer_keywords:
- anonymous types [Visual Basic], about anonymous types
- anonymous types [Visual Basic]
- types [Visual Basic], anonymous
ms.assetid: 7b87532c-4b3e-4398-8503-6ea9d67574a4
ms.openlocfilehash: bbe84ce8a62705027c00bc26db74a3c21fa34fd9
ms.sourcegitcommit: f8c270376ed905f6a8896ce0fe25b4f4b38ff498
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/04/2020
ms.locfileid: "84411795"
---
# <a name="anonymous-types-visual-basic"></a><span data-ttu-id="58553-102">Types anonymes (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="58553-102">Anonymous Types (Visual Basic)</span></span>
<span data-ttu-id="58553-103">Visual Basic prend en charge les types anonymes, qui vous permettent de créer des objets sans écrire de définition de classe pour le type de données.</span><span class="sxs-lookup"><span data-stu-id="58553-103">Visual Basic supports anonymous types, which enable you to create objects without writing a class definition for the data type.</span></span> <span data-ttu-id="58553-104">À la place, le compilateur se charge de générer une classe.</span><span class="sxs-lookup"><span data-stu-id="58553-104">Instead, the compiler generates a class for you.</span></span> <span data-ttu-id="58553-105">La classe n’a pas de nom utilisable, hérite directement de <xref:System.Object> et contient les propriétés que vous spécifiez lors de la déclaration de l’objet.</span><span class="sxs-lookup"><span data-stu-id="58553-105">The class has no usable name, inherits directly from <xref:System.Object>, and contains the properties you specify in declaring the object.</span></span> <span data-ttu-id="58553-106">Étant donné que le nom du type de données n’est pas spécifié, il est appelé *type anonyme*.</span><span class="sxs-lookup"><span data-stu-id="58553-106">Because the name of the data type is not specified, it is referred to as an *anonymous type*.</span></span>  
  
 <span data-ttu-id="58553-107">L’exemple suivant déclare et crée une variable `product` comme une instance d’un type anonyme qui a deux propriétés, `Name` et `Price` .</span><span class="sxs-lookup"><span data-stu-id="58553-107">The following example declares and creates variable `product` as an instance of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#1)]  
  
 <span data-ttu-id="58553-108">Une *expression de requête* utilise des types anonymes pour combiner des colonnes de données sélectionnées par une requête.</span><span class="sxs-lookup"><span data-stu-id="58553-108">A *query expression* uses anonymous types to combine columns of data selected by a query.</span></span> <span data-ttu-id="58553-109">Vous ne pouvez pas définir le type du résultat à l’avance, car vous ne pouvez pas prédire les colonnes qu’une requête particulière peut sélectionner.</span><span class="sxs-lookup"><span data-stu-id="58553-109">You cannot define the type of the result in advance, because you cannot predict the columns a particular query might select.</span></span> <span data-ttu-id="58553-110">Les types anonymes vous permettent d’écrire une requête qui sélectionne un nombre quelconque de colonnes, dans n’importe quel ordre.</span><span class="sxs-lookup"><span data-stu-id="58553-110">Anonymous types enable you to write a query that selects any number of columns, in any order.</span></span> <span data-ttu-id="58553-111">Le compilateur crée un type de données qui correspond aux propriétés spécifiées et à l’ordre spécifié.</span><span class="sxs-lookup"><span data-stu-id="58553-111">The compiler creates a data type that matches the specified properties and the specified order.</span></span>  
  
 <span data-ttu-id="58553-112">Dans les exemples suivants, `products` est une liste d’objets Product, chacun ayant de nombreuses propriétés.</span><span class="sxs-lookup"><span data-stu-id="58553-112">In the following examples, `products` is a list of product objects, each of which has many properties.</span></span> <span data-ttu-id="58553-113">`namePriceQuery`La variable contient la définition d’une requête qui, lorsqu’elle est exécutée, retourne une collection d’instances d’un type anonyme qui a deux propriétés, `Name` et `Price` .</span><span class="sxs-lookup"><span data-stu-id="58553-113">Variable `namePriceQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#2)]  
  
 <span data-ttu-id="58553-114">`nameQuantityQuery`La variable contient la définition d’une requête qui, lorsqu’elle est exécutée, retourne une collection d’instances d’un type anonyme qui a deux propriétés, `Name` et `OnHand` .</span><span class="sxs-lookup"><span data-stu-id="58553-114">Variable `nameQuantityQuery` holds the definition of a query that, when it is executed, returns a collection of instances of an anonymous type that has two properties, `Name` and `OnHand`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#3)]  
  
 <span data-ttu-id="58553-115">Pour plus d’informations sur le code créé par le compilateur pour un type anonyme, consultez [définition de type anonyme](anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="58553-115">For more information about the code created by the compiler for an anonymous type, see [Anonymous Type Definition](anonymous-type-definition.md).</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="58553-116">Le nom du type anonyme est généré par le compilateur et peut varier de la compilation à la compilation.</span><span class="sxs-lookup"><span data-stu-id="58553-116">The name of the anonymous type is compiler generated and may vary from compilation to compilation.</span></span> <span data-ttu-id="58553-117">Votre code ne doit pas utiliser ou s’appuyer sur le nom d’un type anonyme, car le nom peut changer quand un projet est recompilé.</span><span class="sxs-lookup"><span data-stu-id="58553-117">Your code should not use or rely on the name of an anonymous type because the name might change when a project is recompiled.</span></span>  
  
## <a name="declaring-an-anonymous-type"></a><span data-ttu-id="58553-118">Déclaration d’un type anonyme</span><span class="sxs-lookup"><span data-stu-id="58553-118">Declaring an Anonymous Type</span></span>  
 <span data-ttu-id="58553-119">La déclaration d’une instance d’un type anonyme utilise une liste d’initialiseurs pour spécifier les propriétés du type.</span><span class="sxs-lookup"><span data-stu-id="58553-119">The declaration of an instance of an anonymous type uses an initializer list to specify the properties of the type.</span></span> <span data-ttu-id="58553-120">Vous pouvez spécifier uniquement des propriétés lorsque vous déclarez un type anonyme, et non d’autres éléments de classe tels que des méthodes ou des événements.</span><span class="sxs-lookup"><span data-stu-id="58553-120">You can specify only properties when you declare an anonymous type, not other class elements such as methods or events.</span></span> <span data-ttu-id="58553-121">Dans l’exemple suivant, `product1` est une instance d’un type anonyme qui a deux propriétés : `Name` et `Price` .</span><span class="sxs-lookup"><span data-stu-id="58553-121">In the following example, `product1` is an instance of an anonymous type that has two properties: `Name` and `Price`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#4)]  
  
 <span data-ttu-id="58553-122">Si vous désignez des propriétés en tant que propriétés de clé, vous pouvez les utiliser pour comparer deux instances de type anonymes pour déterminer leur égalité.</span><span class="sxs-lookup"><span data-stu-id="58553-122">If you designate properties as key properties, you can use them to compare two anonymous type instances for equality.</span></span> <span data-ttu-id="58553-123">Toutefois, les valeurs des propriétés de clé ne peuvent pas être modifiées.</span><span class="sxs-lookup"><span data-stu-id="58553-123">However, the values of key properties cannot be changed.</span></span> <span data-ttu-id="58553-124">Pour plus d’informations, consultez la section Propriétés de clé plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="58553-124">See the Key Properties section later in this topic for more information.</span></span>  
  
 <span data-ttu-id="58553-125">Notez que la déclaration d’une instance d’un type anonyme est semblable à la déclaration d’une instance d’un type nommé à l’aide d’un initialiseur d’objet :</span><span class="sxs-lookup"><span data-stu-id="58553-125">Notice that declaring an instance of an anonymous type is like declaring an instance of a named type by using an object initializer:</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#5)]  
  
 <span data-ttu-id="58553-126">Pour plus d’informations sur d’autres façons de spécifier des propriétés de type anonyme, consultez [Comment : déduire les types et les noms de propriétés dans des déclarations de type anonyme](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span><span class="sxs-lookup"><span data-stu-id="58553-126">For more information about other ways to specify anonymous type properties, see [How to: Infer Property Names and Types in Anonymous Type Declarations](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md).</span></span>  
  
## <a name="key-properties"></a><span data-ttu-id="58553-127">Propriétés de clé</span><span class="sxs-lookup"><span data-stu-id="58553-127">Key Properties</span></span>  
 <span data-ttu-id="58553-128">Les propriétés de clé diffèrent des propriétés non-clés de plusieurs façons :</span><span class="sxs-lookup"><span data-stu-id="58553-128">Key properties differ from non-key properties in several fundamental ways:</span></span>  
  
- <span data-ttu-id="58553-129">Seules les valeurs des propriétés de clé sont comparées afin de déterminer si deux instances sont égales.</span><span class="sxs-lookup"><span data-stu-id="58553-129">Only the values of key properties are compared in order to determine whether two instances are equal.</span></span>  
  
- <span data-ttu-id="58553-130">Les valeurs des propriétés de clé sont en lecture seule et ne peuvent pas être modifiées.</span><span class="sxs-lookup"><span data-stu-id="58553-130">The values of key properties are read-only and cannot be changed.</span></span>  
  
- <span data-ttu-id="58553-131">Seules les valeurs de propriété de clé sont incluses dans l’algorithme de code de hachage généré par le compilateur pour un type anonyme.</span><span class="sxs-lookup"><span data-stu-id="58553-131">Only key property values are included in the compiler-generated hash code algorithm for an anonymous type.</span></span>  
  
### <a name="equality"></a><span data-ttu-id="58553-132">Égalité</span><span class="sxs-lookup"><span data-stu-id="58553-132">Equality</span></span>  
 <span data-ttu-id="58553-133">Les instances de types anonymes peuvent être égales uniquement si elles sont des instances du même type anonyme.</span><span class="sxs-lookup"><span data-stu-id="58553-133">Instances of anonymous types can be equal only if they are instances of the same anonymous type.</span></span> <span data-ttu-id="58553-134">Le compilateur traite deux instances comme des instances du même type s’ils remplissent les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="58553-134">The compiler treats two instances as instances of the same type if they meet the following conditions:</span></span>  
  
- <span data-ttu-id="58553-135">Ils sont déclarés dans le même assembly.</span><span class="sxs-lookup"><span data-stu-id="58553-135">They are declared in the same assembly.</span></span>  
  
- <span data-ttu-id="58553-136">Leurs propriétés ont les mêmes noms, les mêmes types déduits et sont déclarées dans le même ordre.</span><span class="sxs-lookup"><span data-stu-id="58553-136">Their properties have the same names, the same inferred types, and are declared in the same order.</span></span> <span data-ttu-id="58553-137">Les comparaisons de noms ne respectent pas la casse.</span><span class="sxs-lookup"><span data-stu-id="58553-137">Name comparisons are not case-sensitive.</span></span>  
  
- <span data-ttu-id="58553-138">Les mêmes propriétés dans chaque sont marquées en tant que propriétés de clé.</span><span class="sxs-lookup"><span data-stu-id="58553-138">The same properties in each are marked as key properties.</span></span>  
  
- <span data-ttu-id="58553-139">Au moins une propriété de chaque déclaration est une propriété de clé.</span><span class="sxs-lookup"><span data-stu-id="58553-139">At least one property in each declaration is a key property.</span></span>  
  
 <span data-ttu-id="58553-140">Une instance d’un type anonyme qui n’a pas de propriétés de clé est uniquement égale à elle-même.</span><span class="sxs-lookup"><span data-stu-id="58553-140">An instance of an anonymous types that has no key properties is equal only to itself.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#6)]  
  
 <span data-ttu-id="58553-141">Deux instances du même type anonyme sont égales si les valeurs de leurs propriétés de clé sont égales.</span><span class="sxs-lookup"><span data-stu-id="58553-141">Two instances of the same anonymous type are equal if the values of their key properties are equal.</span></span> <span data-ttu-id="58553-142">Les exemples suivants illustrent la manière dont l’égalité est testée.</span><span class="sxs-lookup"><span data-stu-id="58553-142">The following examples illustrate how equality is tested.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#7)]  
  
### <a name="read-only-values"></a><span data-ttu-id="58553-143">Valeurs en lecture seule</span><span class="sxs-lookup"><span data-stu-id="58553-143">Read-Only Values</span></span>  
 <span data-ttu-id="58553-144">Les valeurs des propriétés de clé ne peuvent pas être modifiées.</span><span class="sxs-lookup"><span data-stu-id="58553-144">The values of key properties cannot be changed.</span></span> <span data-ttu-id="58553-145">Par exemple, dans `prod8` dans l’exemple précédent, les `Name` `Price` champs et sont `read-only` , mais ils `OnHand` peuvent être modifiés.</span><span class="sxs-lookup"><span data-stu-id="58553-145">For example, in `prod8` in the previous example, the `Name` and `Price` fields are `read-only`, but `OnHand` can be changed.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#8)]  
  
## <a name="anonymous-types-from-query-expressions"></a><span data-ttu-id="58553-146">Types anonymes à partir d’expressions de requête</span><span class="sxs-lookup"><span data-stu-id="58553-146">Anonymous Types from Query Expressions</span></span>  
 <span data-ttu-id="58553-147">Les expressions de requête ne nécessitent pas toujours la création de types anonymes.</span><span class="sxs-lookup"><span data-stu-id="58553-147">Query expressions do not always require the creation of anonymous types.</span></span> <span data-ttu-id="58553-148">Lorsque cela est possible, ils utilisent un type existant pour contenir les données de la colonne.</span><span class="sxs-lookup"><span data-stu-id="58553-148">When possible, they use an existing type to hold the column data.</span></span> <span data-ttu-id="58553-149">Cela se produit lorsque la requête retourne des enregistrements entiers de la source de données ou un seul champ de chaque enregistrement.</span><span class="sxs-lookup"><span data-stu-id="58553-149">This occurs when the query returns either whole records from the data source, or only one field from each record.</span></span> <span data-ttu-id="58553-150">Dans les exemples de code suivants, `customers` est une collection d’objets d’une `Customer` classe.</span><span class="sxs-lookup"><span data-stu-id="58553-150">In the following code examples, `customers` is a collection of objects of a `Customer` class.</span></span> <span data-ttu-id="58553-151">La classe possède de nombreuses propriétés, et vous pouvez inclure une ou plusieurs d’entre elles dans le résultat de la requête, dans n’importe quel ordre.</span><span class="sxs-lookup"><span data-stu-id="58553-151">The class has many properties, and you can include one or more of them in the query result, in any order.</span></span> <span data-ttu-id="58553-152">Dans les deux premiers exemples, aucun type anonyme n’est nécessaire, car les requêtes sélectionnent des éléments de types nommés :</span><span class="sxs-lookup"><span data-stu-id="58553-152">In the first two examples, no anonymous types are required because the queries select elements of named types:</span></span>  
  
- <span data-ttu-id="58553-153">`custs1`contient une collection de chaînes, car `cust.Name` est une chaîne.</span><span class="sxs-lookup"><span data-stu-id="58553-153">`custs1` contains a collection of strings, because `cust.Name` is a string.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#30](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#30)]  
  
- <span data-ttu-id="58553-154">`custs2`contient une collection d' `Customer` objets, car chaque élément de `customers` est un `Customer` objet et la totalité de l’élément est sélectionnée par la requête.</span><span class="sxs-lookup"><span data-stu-id="58553-154">`custs2` contains a collection of `Customer` objects, because each element of `customers` is a `Customer` object, and the whole element is selected by the query.</span></span>  
  
     [!code-vb[VbVbalrAnonymousTypes#31](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#31)]  
  
 <span data-ttu-id="58553-155">Toutefois, les types nommés appropriés ne sont pas toujours disponibles.</span><span class="sxs-lookup"><span data-stu-id="58553-155">However, appropriate named types are not always available.</span></span> <span data-ttu-id="58553-156">Vous pouvez sélectionner des noms et des adresses de clients pour un seul objectif, des numéros d’identification client et des emplacements pour un autre, ainsi que des noms de clients, des adresses et des historiques de commande pour un troisième.</span><span class="sxs-lookup"><span data-stu-id="58553-156">You might want to select customer names and addresses for one purpose, customer ID numbers and locations for another, and customer names, addresses, and order histories for a third.</span></span> <span data-ttu-id="58553-157">Les types anonymes vous permettent de sélectionner n’importe quelle combinaison de propriétés, dans n’importe quel ordre, sans déclarer d’abord un nouveau type nommé pour contenir le résultat.</span><span class="sxs-lookup"><span data-stu-id="58553-157">Anonymous types enable you to select any combination of properties, in any order, without first declaring a new named type to hold the result.</span></span> <span data-ttu-id="58553-158">Au lieu de cela, le compilateur crée un type anonyme pour chaque compilation des propriétés.</span><span class="sxs-lookup"><span data-stu-id="58553-158">Instead, the compiler creates an anonymous type for each compilation of properties.</span></span> <span data-ttu-id="58553-159">La requête suivante sélectionne uniquement le nom et le numéro d’ID du client à partir de chaque `Customer` objet dans `customers` .</span><span class="sxs-lookup"><span data-stu-id="58553-159">The following query selects only the customer's name and ID number from each `Customer` object in `customers`.</span></span> <span data-ttu-id="58553-160">Par conséquent, le compilateur crée un type anonyme qui contient uniquement ces deux propriétés.</span><span class="sxs-lookup"><span data-stu-id="58553-160">Therefore, the compiler creates an anonymous type that contains only those two properties.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTYpes#32](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#32)]  
  
 <span data-ttu-id="58553-161">Les noms et les types de données des propriétés dans le type anonyme sont extraits des arguments à `Select` , `cust.Name` et `cust.ID` .</span><span class="sxs-lookup"><span data-stu-id="58553-161">Both the names and the data types of the properties in the anonymous type are taken from the arguments to `Select`, `cust.Name` and `cust.ID`.</span></span> <span data-ttu-id="58553-162">Les propriétés d’un type anonyme créé par une requête sont toujours des propriétés de clé.</span><span class="sxs-lookup"><span data-stu-id="58553-162">The properties in an anonymous type that is created by a query are always key properties.</span></span> <span data-ttu-id="58553-163">Lorsque `custs3` est exécuté dans la `For Each` boucle suivante, le résultat est une collection d’instances d’un type anonyme avec deux propriétés de clé, `Name` et `ID` .</span><span class="sxs-lookup"><span data-stu-id="58553-163">When `custs3` is executed in the following `For Each` loop, the result is a collection of instances of an anonymous type with two key properties, `Name` and `ID`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#33](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class2.vb#33)]  
  
 <span data-ttu-id="58553-164">Les éléments de la collection représentée par `custs3` sont fortement typés, et vous pouvez utiliser IntelliSense pour parcourir les propriétés disponibles et vérifier leurs types.</span><span class="sxs-lookup"><span data-stu-id="58553-164">The elements in the collection represented by `custs3` are strongly typed, and you can use IntelliSense to navigate through the available properties and to verify their types.</span></span>  
  
 <span data-ttu-id="58553-165">Pour plus d’informations, consultez [Introduction à LINQ dans Visual Basic](../linq/introduction-to-linq.md).</span><span class="sxs-lookup"><span data-stu-id="58553-165">For more information, see [Introduction to LINQ in Visual Basic](../linq/introduction-to-linq.md).</span></span>  
  
## <a name="deciding-whether-to-use-anonymous-types"></a><span data-ttu-id="58553-166">Choix de l’utilisation des types anonymes</span><span class="sxs-lookup"><span data-stu-id="58553-166">Deciding Whether to Use Anonymous Types</span></span>  
 <span data-ttu-id="58553-167">Avant de créer un objet en tant qu’instance d’une classe anonyme, déterminez s’il s’agit de la meilleure option.</span><span class="sxs-lookup"><span data-stu-id="58553-167">Before you create an object as an instance of an anonymous class, consider whether that is the best option.</span></span> <span data-ttu-id="58553-168">Par exemple, si vous souhaitez créer un objet temporaire pour contenir des données associées et que vous n’avez pas besoin d’autres champs et méthodes qu’une classe complète peut contenir, un type anonyme est une bonne solution.</span><span class="sxs-lookup"><span data-stu-id="58553-168">For example, if you want to create a temporary object to contain related data, and you have no need for other fields and methods that a complete class might contain, an anonymous type is a good solution.</span></span> <span data-ttu-id="58553-169">Les types anonymes sont également pratiques si vous souhaitez une sélection de propriétés différente pour chaque déclaration, ou si vous souhaitez modifier l’ordre des propriétés.</span><span class="sxs-lookup"><span data-stu-id="58553-169">Anonymous types are also convenient if you want a different selection of properties for each declaration, or if you want to change the order of the properties.</span></span> <span data-ttu-id="58553-170">Toutefois, si votre projet comprend plusieurs objets qui ont les mêmes propriétés, dans un ordre fixe, vous pouvez les déclarer plus facilement en utilisant un type nommé avec un constructeur de classe.</span><span class="sxs-lookup"><span data-stu-id="58553-170">However, if your project includes several objects that have the same properties, in a fixed order, you can declare them more easily by using a named type with a class constructor.</span></span> <span data-ttu-id="58553-171">Par exemple, avec un constructeur approprié, il est plus facile de déclarer plusieurs instances d’une `Product` classe que de déclarer plusieurs instances d’un type anonyme.</span><span class="sxs-lookup"><span data-stu-id="58553-171">For example, with an appropriate constructor, it is easier to declare several instances of a `Product` class than it is to declare several instances of an anonymous type.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#9](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#9)]  
  
 <span data-ttu-id="58553-172">Un autre avantage des types nommés est que le compilateur peut intercepter une faute de frappe accidentelle d’un nom de propriété.</span><span class="sxs-lookup"><span data-stu-id="58553-172">Another advantage of named types is that the compiler can catch an accidental mistyping of a property name.</span></span> <span data-ttu-id="58553-173">Dans les exemples précédents, `firstProd2` , `secondProd2` et `thirdProd2` sont destinés à être des instances du même type anonyme.</span><span class="sxs-lookup"><span data-stu-id="58553-173">In the previous examples, `firstProd2`, `secondProd2`, and `thirdProd2` are intended to be instances of the same anonymous type.</span></span> <span data-ttu-id="58553-174">Toutefois, si vous deviez déclarer accidentellement de `thirdProd2` l’une des façons suivantes, son type serait différent de celui de `firstProd2` et `secondProd2` .</span><span class="sxs-lookup"><span data-stu-id="58553-174">However, if you were to accidentally declare `thirdProd2` in one of the following ways, its type would be different from that of `firstProd2` and `secondProd2`.</span></span>  
  
 [!code-vb[VbVbalrAnonymousTypes#10](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrAnonymousTypes/VB/Class1.vb#10)]  
  
 <span data-ttu-id="58553-175">Plus important encore, il existe des limitations sur l’utilisation de types anonymes qui ne s’appliquent pas aux instances de types nommés.</span><span class="sxs-lookup"><span data-stu-id="58553-175">More importantly, there are limitations on the use of anonymous types that do not apply to instances of named types.</span></span> <span data-ttu-id="58553-176">`firstProd2`, `secondProd2` et `thirdProd2` sont des instances du même type anonyme.</span><span class="sxs-lookup"><span data-stu-id="58553-176">`firstProd2`, `secondProd2`, and `thirdProd2` are instances of the same anonymous type.</span></span> <span data-ttu-id="58553-177">Toutefois, le nom du type anonyme partagé n’est pas disponible et ne peut pas apparaître lorsqu’un nom de type est attendu dans votre code.</span><span class="sxs-lookup"><span data-stu-id="58553-177">However, the name for the shared anonymous type is not available and cannot appear where a type name is expected in your code.</span></span> <span data-ttu-id="58553-178">Par exemple, un type anonyme ne peut pas être utilisé pour définir une signature de méthode, pour déclarer une autre variable ou un autre champ, ou dans une déclaration de type.</span><span class="sxs-lookup"><span data-stu-id="58553-178">For example, an anonymous type cannot be used to define a method signature, to declare another variable or field, or in any type declaration.</span></span> <span data-ttu-id="58553-179">Par conséquent, les types anonymes ne sont pas appropriés lorsque vous devez partager des informations entre les méthodes.</span><span class="sxs-lookup"><span data-stu-id="58553-179">As a result, anonymous types are not appropriate when you have to share information across methods.</span></span>  
  
## <a name="an-anonymous-type-definition"></a><span data-ttu-id="58553-180">Définition de type anonyme</span><span class="sxs-lookup"><span data-stu-id="58553-180">An Anonymous Type Definition</span></span>  
 <span data-ttu-id="58553-181">En réponse à la déclaration d’une instance d’un type anonyme, le compilateur crée une nouvelle définition de classe qui contient les propriétés spécifiées.</span><span class="sxs-lookup"><span data-stu-id="58553-181">In response to the declaration of an instance of an anonymous type, the compiler creates a new class definition that contains the specified properties.</span></span>  
  
 <span data-ttu-id="58553-182">Si le type anonyme contient au moins une propriété de clé, la définition remplace trois membres hérités de <xref:System.Object> : <xref:System.Object.Equals%2A> , <xref:System.Object.GetHashCode%2A> et <xref:System.Object.ToString%2A> .</span><span class="sxs-lookup"><span data-stu-id="58553-182">If the anonymous type contains at least one key property, the definition overrides three members inherited from <xref:System.Object>: <xref:System.Object.Equals%2A>, <xref:System.Object.GetHashCode%2A>, and <xref:System.Object.ToString%2A>.</span></span> <span data-ttu-id="58553-183">Le code produit pour tester l’égalité et déterminer la valeur de code de hachage ne prend en compte que les propriétés de clé.</span><span class="sxs-lookup"><span data-stu-id="58553-183">The code produced for testing equality and determining the hash code value considers only the key properties.</span></span> <span data-ttu-id="58553-184">Si le type anonyme ne contient aucune propriété de clé, seul <xref:System.Object.ToString%2A> est substitué.</span><span class="sxs-lookup"><span data-stu-id="58553-184">If the anonymous type contains no key properties, only <xref:System.Object.ToString%2A> is overridden.</span></span> <span data-ttu-id="58553-185">Les propriétés explicitement nommées d’un type anonyme ne peuvent pas entrer en conflit avec ces méthodes générées.</span><span class="sxs-lookup"><span data-stu-id="58553-185">Explicitly named properties of an anonymous type cannot conflict with these generated methods.</span></span> <span data-ttu-id="58553-186">Autrement dit, vous ne pouvez pas utiliser `.Equals` , `.GetHashCode` ou `.ToString` pour nommer une propriété.</span><span class="sxs-lookup"><span data-stu-id="58553-186">That is, you cannot use `.Equals`, `.GetHashCode`, or `.ToString` to name a property.</span></span>  
  
 <span data-ttu-id="58553-187">Les définitions de types anonymes qui ont au moins une propriété de clé implémentent également l' <xref:System.IEquatable%601?displayProperty=nameWithType> interface, où `T` est le type du type anonyme.</span><span class="sxs-lookup"><span data-stu-id="58553-187">Anonymous type definitions that have at least one key property also implement the <xref:System.IEquatable%601?displayProperty=nameWithType> interface, where `T` is the type of the anonymous type.</span></span>  
  
 <span data-ttu-id="58553-188">Pour plus d’informations sur le code créé par le compilateur et les fonctionnalités des méthodes substituées, consultez [définition de type anonyme](anonymous-type-definition.md).</span><span class="sxs-lookup"><span data-stu-id="58553-188">For more information about the code created by the compiler and the functionality of the overridden methods, see [Anonymous Type Definition](anonymous-type-definition.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="58553-189">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="58553-189">See also</span></span>

- [<span data-ttu-id="58553-190">Initialiseurs d'objets : types nommés et anonymes</span><span class="sxs-lookup"><span data-stu-id="58553-190">Object Initializers: Named and Anonymous Types</span></span>](object-initializers-named-and-anonymous-types.md)
- [<span data-ttu-id="58553-191">Inférence de type local</span><span class="sxs-lookup"><span data-stu-id="58553-191">Local Type Inference</span></span>](../variables/local-type-inference.md)
- [<span data-ttu-id="58553-192">Introduction à LINQ en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="58553-192">Introduction to LINQ in Visual Basic</span></span>](../linq/introduction-to-linq.md)
- [<span data-ttu-id="58553-193">Comment : déduire les types et les noms de propriétés dans des déclarations de types anonymes</span><span class="sxs-lookup"><span data-stu-id="58553-193">How to: Infer Property Names and Types in Anonymous Type Declarations</span></span>](how-to-infer-property-names-and-types-in-anonymous-type-declarations.md)
- [<span data-ttu-id="58553-194">Définition du type anonyme</span><span class="sxs-lookup"><span data-stu-id="58553-194">Anonymous Type Definition</span></span>](anonymous-type-definition.md)
- [<span data-ttu-id="58553-195">Clé</span><span class="sxs-lookup"><span data-stu-id="58553-195">Key</span></span>](../../../language-reference/modifiers/key.md)

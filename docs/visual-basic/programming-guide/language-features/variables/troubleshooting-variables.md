---
title: Résolution des problèmes de variables
ms.date: 07/20/2015
helpviewer_keywords:
- troubleshooting [Visual Basic], variables
- variables [Visual Basic], troubleshooting
ms.assetid: 928a2dc8-e565-4ae4-8ba3-80cc0cb50090
ms.openlocfilehash: e2bcf0b779d98ea4b109ea6d33b69a15110d423c
ms.sourcegitcommit: bf5c5850654187705bc94cc40ebfb62fe346ab02
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/23/2020
ms.locfileid: "91080164"
---
# <a name="troubleshooting-variables-in-visual-basic"></a><span data-ttu-id="c626a-102">Dépannage des variables en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="c626a-102">Troubleshooting Variables in Visual Basic</span></span>

<span data-ttu-id="c626a-103">Cette page répertorie certains problèmes courants qui peuvent se produire lors de l’utilisation de variables dans Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="c626a-103">This page lists some common problems that can occur when working with variables in Visual Basic.</span></span>  
  
## <a name="unable-to-access-members-of-an-object"></a><span data-ttu-id="c626a-104">Impossible d’accéder aux membres d’un objet</span><span class="sxs-lookup"><span data-stu-id="c626a-104">Unable to Access Members of an Object</span></span>  

 <span data-ttu-id="c626a-105">Si votre code tente d’accéder à une propriété ou à une méthode sur un objet, il existe deux résultats possibles en cas d’erreur :</span><span class="sxs-lookup"><span data-stu-id="c626a-105">If your code attempts to access a property or method on an object, there are two possible error outcomes:</span></span>  
  
- <span data-ttu-id="c626a-106">Le compilateur peut générer un message d’erreur si vous déclarez la variable objet comme étant d’un type spécifique et que vous faites ensuite référence à un membre non défini par ce type.</span><span class="sxs-lookup"><span data-stu-id="c626a-106">The compiler can generate an error message if you declare the object variable to be of a specific type and then refer to a member not defined by that type.</span></span>  
  
- <span data-ttu-id="c626a-107">Une exception <xref:System.MemberAccessException> runtime se produit quand l’objet assigné à une variable objet n’expose pas le membre auquel votre code essaie d’accéder.</span><span class="sxs-lookup"><span data-stu-id="c626a-107">A run-time <xref:System.MemberAccessException> occurs when the object assigned to an object variable does not expose the member your code is trying to access.</span></span> <span data-ttu-id="c626a-108">Dans le cas d’une variable de [Object Data Type](../../../language-reference/data-types/object-data-type.md), vous pouvez également recevoir cette exception si le membre n’est pas `Public`.</span><span class="sxs-lookup"><span data-stu-id="c626a-108">In the case of a variable of [Object Data Type](../../../language-reference/data-types/object-data-type.md), you can also get this exception if the member is not `Public`.</span></span> <span data-ttu-id="c626a-109">Cela est dû au fait que la liaison tardive autorise l’accès uniquement aux membres `Public` .</span><span class="sxs-lookup"><span data-stu-id="c626a-109">This is because late binding allows access only to `Public` members.</span></span>  
  
 <span data-ttu-id="c626a-110">Quand l’ [Option Strict Statement](../../../language-reference/statements/option-strict-statement.md) affecte la valeur `On`à la vérification de type, une variable objet peut accéder uniquement aux méthodes et aux propriétés de la classe avec laquelle vous la déclarez.</span><span class="sxs-lookup"><span data-stu-id="c626a-110">When the [Option Strict Statement](../../../language-reference/statements/option-strict-statement.md) sets type checking `On`, an object variable can access only the methods and properties of the class with which you declare it.</span></span> <span data-ttu-id="c626a-111">L'exemple suivant illustre ce comportement.</span><span class="sxs-lookup"><span data-stu-id="c626a-111">The following example illustrates this.</span></span>  

 [!code-vb[VbVbalrVariables#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrVariables/VB/Class1.vb#2)]  
  
 <span data-ttu-id="c626a-112">Dans cet exemple, `p` peut utiliser uniquement les membres de la <xref:System.Object> classe proprement dite, qui n’incluent pas la propriété `Left` .</span><span class="sxs-lookup"><span data-stu-id="c626a-112">In this example, `p` can use only the members of the <xref:System.Object> class itself, which do not include the `Left` property.</span></span> <span data-ttu-id="c626a-113">En revanche, `q` a été déclaré comme étant de type <xref:System.Windows.Forms.Label>. Il peut donc utiliser toutes les méthodes et propriétés de la classe <xref:System.Windows.Forms.Label> dans l’espace de noms <xref:System.Windows.Forms> .</span><span class="sxs-lookup"><span data-stu-id="c626a-113">On the other hand, `q` was declared to be of type <xref:System.Windows.Forms.Label>, so it can use all the methods and properties of the <xref:System.Windows.Forms.Label> class in the <xref:System.Windows.Forms> namespace.</span></span>  
  
### <a name="correct-approach"></a><span data-ttu-id="c626a-114">Approche correcte</span><span class="sxs-lookup"><span data-stu-id="c626a-114">Correct Approach</span></span>  

 <span data-ttu-id="c626a-115">Pour pouvoir accéder à tous les membres d’un objet d’une classe particulière, déclarez la variable objet comme étant du type de cette classe dans la mesure du possible.</span><span class="sxs-lookup"><span data-stu-id="c626a-115">To be able to access all the members of an object of a particular class, declare the object variable to be of the type of that class when possible.</span></span> <span data-ttu-id="c626a-116">Si c’est impossible, par exemple si vous ne connaissez pas le type de l’objet au moment de la compilation, vous devez affecter la valeur `Option Strict` à `Off` et déclarer la variable comme étant [Object Data Type](../../../language-reference/data-types/object-data-type.md).</span><span class="sxs-lookup"><span data-stu-id="c626a-116">If you cannot do this, for example if you do not know the object type at compile time, you must set `Option Strict` to `Off` and declare the variable to be of the [Object Data Type](../../../language-reference/data-types/object-data-type.md).</span></span> <span data-ttu-id="c626a-117">Cela permet d’affecter des objets de tout type à la variable, et vous devez prendre les mesures nécessaires pour vous assurer que l’objet actuellement affecté est d’un type acceptable.</span><span class="sxs-lookup"><span data-stu-id="c626a-117">This allows objects of any type to be assigned to the variable, and you should take steps to ensure that the currently assigned object is of an acceptable type.</span></span> <span data-ttu-id="c626a-118">Vous pouvez utiliser l' [opérateur typeof](../../../language-reference/operators/typeof-operator.md) pour effectuer cette détermination.</span><span class="sxs-lookup"><span data-stu-id="c626a-118">You can use the [TypeOf Operator](../../../language-reference/operators/typeof-operator.md) to make this determination.</span></span>  
  
## <a name="other-components-cannot-access-your-variable"></a><span data-ttu-id="c626a-119">D’autres composants ne peuvent pas accéder à votre variable</span><span class="sxs-lookup"><span data-stu-id="c626a-119">Other Components Cannot Access Your Variable</span></span>  

 <span data-ttu-id="c626a-120">Les noms de Visual Basic ne respectent pas la *casse*.</span><span class="sxs-lookup"><span data-stu-id="c626a-120">Visual Basic names are *case-insensitive*.</span></span> <span data-ttu-id="c626a-121">Si deux noms diffèrent uniquement par la casse, le compilateur les interprète comme étant identiques.</span><span class="sxs-lookup"><span data-stu-id="c626a-121">If two names differ in alphabetic case only, the compiler interprets them as the same name.</span></span> <span data-ttu-id="c626a-122">Par exemple, il considère que `ABC` et `abc` font référence au même élément déclaré.</span><span class="sxs-lookup"><span data-stu-id="c626a-122">For example, it considers `ABC` and `abc` to refer to the same declared element.</span></span>  
  
 <span data-ttu-id="c626a-123">Toutefois, le Common Language Runtime (CLR) utilise la liaison *qui respecte la casse* .</span><span class="sxs-lookup"><span data-stu-id="c626a-123">However, the common language runtime (CLR) uses *case-sensitive* binding.</span></span> <span data-ttu-id="c626a-124">Ainsi, quand vous générez un assembly ou une DLL et que vous le mettez à disposition d’autres assemblys, la casse de vos noms est respectée.</span><span class="sxs-lookup"><span data-stu-id="c626a-124">Therefore, when you produce an assembly or a DLL and make it available to other assemblies, your names are no longer case-insensitive.</span></span> <span data-ttu-id="c626a-125">Par exemple, si vous définissez une classe avec un élément nommé `ABC`et que d’autres assemblys utilisent votre classe par le biais du Common Language Runtime, ils doivent faire référence à l’élément en tant que `ABC`.</span><span class="sxs-lookup"><span data-stu-id="c626a-125">For example, if you define a class with an element called `ABC`, and other assemblies make use of your class through the common language runtime, they must refer to the element as `ABC`.</span></span> <span data-ttu-id="c626a-126">Si, par la suite, vous recompilez votre classe et que vous changez le nom de l’élément en `abc`, les autres assemblys qui utilisent votre classe ne peuvent plus accéder à cet élément.</span><span class="sxs-lookup"><span data-stu-id="c626a-126">If you subsequently recompile your class and change the element's name to `abc`, the other assemblies using your class can no longer access that element.</span></span> <span data-ttu-id="c626a-127">Ainsi, quand vous publiez une version mise à jour d’un assembly, vous ne devez pas modifier la casse des éléments publics.</span><span class="sxs-lookup"><span data-stu-id="c626a-127">Therefore, when you release an updated version of an assembly, you should not change the alphabetic case of any public elements.</span></span>  
  
 <span data-ttu-id="c626a-128">Pour plus d'informations, consultez [Common Language Runtime](../../../../standard/clr.md).</span><span class="sxs-lookup"><span data-stu-id="c626a-128">For more information, see [Common Language Runtime](../../../../standard/clr.md).</span></span>  
  
### <a name="correct-approach"></a><span data-ttu-id="c626a-129">Approche correcte</span><span class="sxs-lookup"><span data-stu-id="c626a-129">Correct Approach</span></span>  

 <span data-ttu-id="c626a-130">Pour permettre à d’autres composants d’accéder à vos variables, traitez leurs noms comme s’ils respectaient la casse.</span><span class="sxs-lookup"><span data-stu-id="c626a-130">To allow other components to access your variables, treat their names as if they were case-sensitive.</span></span> <span data-ttu-id="c626a-131">Quand vous testez votre classe ou module, vérifiez que les autres assemblys se lient aux variables prévues.</span><span class="sxs-lookup"><span data-stu-id="c626a-131">When you are testing your class or module, make sure other assemblies are binding to the variables you expect them to.</span></span> <span data-ttu-id="c626a-132">Une fois que vous avez publié un composant, ne modifiez pas les noms de variables existants, notamment leur casse.</span><span class="sxs-lookup"><span data-stu-id="c626a-132">Once you have published a component, do not make any modifications to existing variable names, including changing their cases.</span></span>  
  
## <a name="wrong-variable-being-used"></a><span data-ttu-id="c626a-133">Variable incorrecte utilisée</span><span class="sxs-lookup"><span data-stu-id="c626a-133">Wrong Variable Being Used</span></span>  

 <span data-ttu-id="c626a-134">Quand plusieurs variables portent le même nom, le compilateur Visual Basic tente de résoudre chaque référence à ce nom.</span><span class="sxs-lookup"><span data-stu-id="c626a-134">When you have more than one variable with the same name, the Visual Basic compiler attempts to resolve each reference to that name.</span></span> <span data-ttu-id="c626a-135">Si les variables ont une portée différente, le compilateur résout une référence à la déclaration dont la portée est la plus petite.</span><span class="sxs-lookup"><span data-stu-id="c626a-135">If the variables have different scope, the compiler resolves a reference to the declaration with the narrowest scope.</span></span> <span data-ttu-id="c626a-136">Si elles ont la même portée, la résolution échoue et le compilateur signale une erreur.</span><span class="sxs-lookup"><span data-stu-id="c626a-136">If they have the same scope, the resolution fails and the compiler signals an error.</span></span> <span data-ttu-id="c626a-137">Pour plus d'informations, consultez [References to Declared Elements](../declared-elements/references-to-declared-elements.md).</span><span class="sxs-lookup"><span data-stu-id="c626a-137">For more information, see [References to Declared Elements](../declared-elements/references-to-declared-elements.md).</span></span>  
  
### <a name="correct-approach"></a><span data-ttu-id="c626a-138">Approche correcte</span><span class="sxs-lookup"><span data-stu-id="c626a-138">Correct Approach</span></span>  

 <span data-ttu-id="c626a-139">Évitez d’utiliser des variables ayant le même nom mais une portée différente.</span><span class="sxs-lookup"><span data-stu-id="c626a-139">Avoid using variables with the same name but different scope.</span></span> <span data-ttu-id="c626a-140">Si vous utilisez d’autres assemblys ou projets, évitez d’utiliser des noms définis dans ces composants externes.</span><span class="sxs-lookup"><span data-stu-id="c626a-140">If you are using other assemblies or projects, avoid using any names defined in those external components as much as possible.</span></span> <span data-ttu-id="c626a-141">Si plusieurs variables ont le même nom, n’oubliez pas de qualifier chaque référence à celui-ci.</span><span class="sxs-lookup"><span data-stu-id="c626a-141">If you have more than one variable with the same name, be sure you qualify every reference to it.</span></span> <span data-ttu-id="c626a-142">Pour plus d'informations, consultez [References to Declared Elements](../declared-elements/references-to-declared-elements.md).</span><span class="sxs-lookup"><span data-stu-id="c626a-142">For more information, see [References to Declared Elements](../declared-elements/references-to-declared-elements.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c626a-143">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c626a-143">See also</span></span>

- [<span data-ttu-id="c626a-144">Variables</span><span class="sxs-lookup"><span data-stu-id="c626a-144">Variables</span></span>](index.md)
- [<span data-ttu-id="c626a-145">Déclaration de variable</span><span class="sxs-lookup"><span data-stu-id="c626a-145">Variable Declaration</span></span>](variable-declaration.md)
- [<span data-ttu-id="c626a-146">Variables objets</span><span class="sxs-lookup"><span data-stu-id="c626a-146">Object Variables</span></span>](object-variables.md)
- [<span data-ttu-id="c626a-147">Déclaration des variables objets</span><span class="sxs-lookup"><span data-stu-id="c626a-147">Object Variable Declaration</span></span>](object-variable-declaration.md)
- [<span data-ttu-id="c626a-148">Guide pratique : accéder aux membres d’un objet</span><span class="sxs-lookup"><span data-stu-id="c626a-148">How to: Access Members of an Object</span></span>](how-to-access-members-of-an-object.md)
- [<span data-ttu-id="c626a-149">Valeurs des variables objets</span><span class="sxs-lookup"><span data-stu-id="c626a-149">Object Variable Values</span></span>](object-variable-values.md)
- [<span data-ttu-id="c626a-150">Comment : déterminer le type désigné par une variable objet</span><span class="sxs-lookup"><span data-stu-id="c626a-150">How to: Determine What Type an Object Variable Refers To</span></span>](how-to-determine-what-type-an-object-variable-refers-to.md)
- [<span data-ttu-id="c626a-151">References to Declared Elements</span><span class="sxs-lookup"><span data-stu-id="c626a-151">References to Declared Elements</span></span>](../declared-elements/references-to-declared-elements.md)
- [<span data-ttu-id="c626a-152">Declared Element Names</span><span class="sxs-lookup"><span data-stu-id="c626a-152">Declared Element Names</span></span>](../declared-elements/declared-element-names.md)

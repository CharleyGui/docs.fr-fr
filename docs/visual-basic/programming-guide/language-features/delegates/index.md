---
title: Délégués
ms.date: 07/20/2015
helpviewer_keywords:
- delegates [Visual Basic]
- Visual Basic code, delegates
ms.assetid: 410b60dc-5e60-4ec0-bfae-426755a2ee28
ms.openlocfilehash: 15b4cb0a038429c5fe67d3e013818a7a2170abcc
ms.sourcegitcommit: 17ee6605e01ef32506f8fdc686954244ba6911de
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/22/2019
ms.locfileid: "74345235"
---
# <a name="delegates-visual-basic"></a><span data-ttu-id="bad7c-102">Délégués (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="bad7c-102">Delegates (Visual Basic)</span></span>

<span data-ttu-id="bad7c-103">Les délégués sont des objets qui font référence à des méthodes.</span><span class="sxs-lookup"><span data-stu-id="bad7c-103">Delegates are objects that refer to methods.</span></span> <span data-ttu-id="bad7c-104">Ils sont parfois décrits comme des *pointeurs de fonction de type sécurisé*, car ils sont comparables aux pointeurs de fonction utilisés dans d’autres langages de programmation.</span><span class="sxs-lookup"><span data-stu-id="bad7c-104">They are sometimes described as *type-safe function pointers* because they are similar to function pointers used in other programming languages.</span></span> <span data-ttu-id="bad7c-105">But unlike function pointers, Visual Basic delegates are a reference type based on the class <xref:System.Delegate?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="bad7c-105">But unlike function pointers, Visual Basic delegates are a reference type based on the class <xref:System.Delegate?displayProperty=nameWithType>.</span></span> <span data-ttu-id="bad7c-106">Les délégués peuvent faire référence à des méthodes partagées (méthodes qui peuvent être appelées sans une instance spécifique de classe) et des méthodes d’instance.</span><span class="sxs-lookup"><span data-stu-id="bad7c-106">Delegates can reference both shared methods — methods that can be called without a specific instance of a class — and instance methods.</span></span>

## <a name="delegates-and-events"></a><span data-ttu-id="bad7c-107">Délégués et événements</span><span class="sxs-lookup"><span data-stu-id="bad7c-107">Delegates and Events</span></span>

<span data-ttu-id="bad7c-108">Les délégués sont utiles dans les situations où un intermédiaire est nécessaire entre une procédure appelante et la procédure appelée.</span><span class="sxs-lookup"><span data-stu-id="bad7c-108">Delegates are useful in situations where you need an intermediary between a calling procedure and the procedure being called.</span></span> <span data-ttu-id="bad7c-109">Par exemple, vous pouvez créer un objet qui déclenche des événements pour pouvoir appeler différents gestionnaires d’événements dans différentes circonstances.</span><span class="sxs-lookup"><span data-stu-id="bad7c-109">For example, you might want an object that raises events to be able to call different event handlers under different circumstances.</span></span> <span data-ttu-id="bad7c-110">Malheureusement, l’objet qui déclenche les événements ne peut pas savoir à l’avance quel gestionnaire d’événements gère un événement donné.</span><span class="sxs-lookup"><span data-stu-id="bad7c-110">Unfortunately, the object raising the events cannot know ahead of time which event handler is handling a specific event.</span></span> <span data-ttu-id="bad7c-111">Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the `AddHandler` statement.</span><span class="sxs-lookup"><span data-stu-id="bad7c-111">Visual Basic lets you dynamically associate event handlers with events by creating a delegate for you when you use the `AddHandler` statement.</span></span> <span data-ttu-id="bad7c-112">À l’exécution, le délégué transmet les appels au gestionnaire d’événements approprié.</span><span class="sxs-lookup"><span data-stu-id="bad7c-112">At run time, the delegate forwards calls to the appropriate event handler.</span></span>

<span data-ttu-id="bad7c-113">Although you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you.</span><span class="sxs-lookup"><span data-stu-id="bad7c-113">Although you can create your own delegates, in most cases Visual Basic creates the delegate and takes care of the details for you.</span></span> <span data-ttu-id="bad7c-114">Par exemple, une instruction `Event` définit implicitement une classe déléguée nommée `<EventName>EventHandler` comme classe imbriquée de la classe contenant l’instruction `Event`, avec la même signature que l’événement.</span><span class="sxs-lookup"><span data-stu-id="bad7c-114">For example, an `Event` statement implicitly defines a delegate class named `<EventName>EventHandler` as a nested class of the class containing the `Event` statement, and with the same signature as the event.</span></span> <span data-ttu-id="bad7c-115">L’instruction `AddressOf` crée implicitement une instance d’un délégué qui fait référence à une procédure spécifique.</span><span class="sxs-lookup"><span data-stu-id="bad7c-115">The `AddressOf` statement implicitly creates an instance of a delegate that refers to a specific procedure.</span></span> <span data-ttu-id="bad7c-116">Les deux lignes de code suivantes sont équivalentes.</span><span class="sxs-lookup"><span data-stu-id="bad7c-116">The following two lines of code are equivalent.</span></span> <span data-ttu-id="bad7c-117">Dans la première ligne, vous voyez la création explicite d’une instance de `EventHandler`, avec une référence à la méthode `Button1_Click` envoyée comme argument.</span><span class="sxs-lookup"><span data-stu-id="bad7c-117">In the first line, you see the explicit creation of an instance of `EventHandler`, with a reference to method `Button1_Click` sent as the argument.</span></span> <span data-ttu-id="bad7c-118">La deuxième ligne est un moyen plus commode de faire la même chose.</span><span class="sxs-lookup"><span data-stu-id="bad7c-118">The second line is a more convenient way to do the same thing.</span></span>

[!code-vb[VbVbalrDelegates#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#6)]

<span data-ttu-id="bad7c-119">Vous pouvez utiliser la syntaxe raccourcie pour créer des délégués dès l’instant où le compilateur peut déterminer le type du délégué par le contexte.</span><span class="sxs-lookup"><span data-stu-id="bad7c-119">You can use the shorthand way of creating delegates anywhere the compiler can determine the delegate's type by the context.</span></span>

## <a name="declaring-events-that-use-an-existing-delegate-type"></a><span data-ttu-id="bad7c-120">Déclaration d’événements utilisant un type délégué existant</span><span class="sxs-lookup"><span data-stu-id="bad7c-120">Declaring Events that Use an Existing Delegate Type</span></span>

<span data-ttu-id="bad7c-121">Dans certaines situations, vous souhaiterez peut-être déclarer un événement pour utiliser un type délégué existant comme son délégué sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="bad7c-121">In some situations, you may want to declare an event to use an existing delegate type as its underlying delegate.</span></span> <span data-ttu-id="bad7c-122">La syntaxe suivante montre comment :</span><span class="sxs-lookup"><span data-stu-id="bad7c-122">The following syntax demonstrates how:</span></span>

[!code-vb[VbVbalrDelegates#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class1.vb#7)]

<span data-ttu-id="bad7c-123">C’est utile pour acheminer plusieurs événements vers le même gestionnaire.</span><span class="sxs-lookup"><span data-stu-id="bad7c-123">This is useful when you want to route multiple events to the same handler.</span></span>

## <a name="delegate-variables-and-parameters"></a><span data-ttu-id="bad7c-124">Paramètres et variables délégués</span><span class="sxs-lookup"><span data-stu-id="bad7c-124">Delegate Variables and Parameters</span></span>

<span data-ttu-id="bad7c-125">Vous pouvez utiliser des délégués pour d’autres tâches non liées aux événements, telles que le threading libre, ou avec des procédures qui doivent appeler différentes versions de fonctions à l’exécution.</span><span class="sxs-lookup"><span data-stu-id="bad7c-125">You can use delegates for other, non-event related tasks, such as free threading or with procedures that need to call different versions of functions at run time.</span></span>

<span data-ttu-id="bad7c-126">Par exemple, supposons que vous disposez d’une application de petites annonces qui comprend une zone de liste avec les noms de voitures.</span><span class="sxs-lookup"><span data-stu-id="bad7c-126">For example, suppose you have a classified-ad application that includes a list box with the names of cars.</span></span> <span data-ttu-id="bad7c-127">Les annonces sont triées par titre, qui correspond normalement à la marque de la voiture.</span><span class="sxs-lookup"><span data-stu-id="bad7c-127">The ads are sorted by title, which is normally the make of the car.</span></span> <span data-ttu-id="bad7c-128">Vous pouvez rencontrer le cas de figure où certaines voitures indiquent l’année de la voiture avant la marque.</span><span class="sxs-lookup"><span data-stu-id="bad7c-128">A problem you may face occurs when some cars include the year of the car before the make.</span></span> <span data-ttu-id="bad7c-129">Le problème est que la fonctionnalité de tri prédéfinie de la zone de liste trie seulement par code de caractères ; elle place en premier toutes les annonces qui commencent par une date, suivies des annonces qui commencent par la marque.</span><span class="sxs-lookup"><span data-stu-id="bad7c-129">The problem is that the built-in sort functionality of the list box sorts only by character codes; it places all the ads starting with dates first, followed by the ads starting with the make.</span></span>

<span data-ttu-id="bad7c-130">Pour résoudre ce problème, vous pouvez créer une procédure de tri dans une classe qui utilise le tri alphabétique standard sur la plupart des zones de liste, mais qui est capable, à l’exécution, de passer à la procédure de tri personnalisé pour les annonces de voiture.</span><span class="sxs-lookup"><span data-stu-id="bad7c-130">To fix this, you can create a sort procedure in a class that uses the standard alphabetic sort on most list boxes, but is able to switch at run time to the custom sort procedure for car ads.</span></span> <span data-ttu-id="bad7c-131">Pour ce faire, transmettez la procédure de tri personnalisée à la classe de tri à l’exécution, à l’aide de délégués.</span><span class="sxs-lookup"><span data-stu-id="bad7c-131">To do this, you pass the custom sort procedure to the sort class at run time, using delegates.</span></span>

## <a name="addressof-and-lambda-expressions"></a><span data-ttu-id="bad7c-132">Expressions lambda et AddressOf</span><span class="sxs-lookup"><span data-stu-id="bad7c-132">AddressOf and Lambda Expressions</span></span>

<span data-ttu-id="bad7c-133">Chaque classe déléguée définit un constructeur auquel les caractéristiques d’une méthode objet sont passées.</span><span class="sxs-lookup"><span data-stu-id="bad7c-133">Each delegate class defines a constructor that is passed the specification of an object method.</span></span> <span data-ttu-id="bad7c-134">L’argument d’un constructeur délégué doit être une référence à une méthode ou une expression lambda.</span><span class="sxs-lookup"><span data-stu-id="bad7c-134">An argument to a delegate constructor must be a reference to a method, or a lambda expression.</span></span>

<span data-ttu-id="bad7c-135">Pour spécifier une référence à une méthode, utilisez la syntaxe suivante :</span><span class="sxs-lookup"><span data-stu-id="bad7c-135">To specify a reference to a method, use the following syntax:</span></span>

<span data-ttu-id="bad7c-136">`AddressOf` [`expression`.]`methodName`</span><span class="sxs-lookup"><span data-stu-id="bad7c-136">`AddressOf` [`expression`.]`methodName`</span></span>

<span data-ttu-id="bad7c-137">Le type de compilation de `expression` doit être le nom d’une classe ou d’une interface qui contient une méthode portant le nom spécifié, dont la signature corresponde à celle de la classe déléguée.</span><span class="sxs-lookup"><span data-stu-id="bad7c-137">The compile-time type of the `expression` must be the name of a class or an interface that contains a method of the specified name whose signature matches the signature of the delegate class.</span></span> <span data-ttu-id="bad7c-138">La méthode `methodName` peut être une méthode partagée ou d’instance.</span><span class="sxs-lookup"><span data-stu-id="bad7c-138">The `methodName` can be either a shared method or an instance method.</span></span> <span data-ttu-id="bad7c-139">`methodName` n’est pas facultatif, même si l’on crée un délégué pour la méthode par défaut de la classe.</span><span class="sxs-lookup"><span data-stu-id="bad7c-139">The `methodName` is not optional, even if you create a delegate for the default method of the class.</span></span>

<span data-ttu-id="bad7c-140">Pour spécifier une expression lambda, utilisez la syntaxe suivante :</span><span class="sxs-lookup"><span data-stu-id="bad7c-140">To specify a lambda expression, use the following syntax:</span></span>

<span data-ttu-id="bad7c-141">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span><span class="sxs-lookup"><span data-stu-id="bad7c-141">`Function` ([`parm` As `type`, `parm2` As `type2`, ...]) `expression`</span></span>

<span data-ttu-id="bad7c-142">L’exemple suivant illustre les expressions lambda et `AddressOf` utilisées pour spécifier la référence d’un délégué.</span><span class="sxs-lookup"><span data-stu-id="bad7c-142">The following example shows both `AddressOf` and lambda expressions used to specify the reference for a delegate.</span></span>

[!code-vb[VbVbalrDelegates#15](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrDelegates/VB/Class2.vb#15)]

<span data-ttu-id="bad7c-143">La signature de la fonction doit correspondre à celle du type délégué.</span><span class="sxs-lookup"><span data-stu-id="bad7c-143">The signature of the function must match that of the delegate type.</span></span> <span data-ttu-id="bad7c-144">Pour plus d’informations sur les expressions lambda, consultez [Expressions Lambda](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="bad7c-144">For more information about lambda expressions, see [Lambda Expressions](../../../../visual-basic/programming-guide/language-features/procedures/lambda-expressions.md).</span></span> <span data-ttu-id="bad7c-145">Pour voir plus d’exemples d’affectation d’expressions lambda et `AddressOf` aux délégués, consultez la page [Conversion souple des délégués](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md).</span><span class="sxs-lookup"><span data-stu-id="bad7c-145">For more examples of lambda expression and `AddressOf` assignments to delegates, see [Relaxed Delegate Conversion](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md).</span></span>

## <a name="related-topics"></a><span data-ttu-id="bad7c-146">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="bad7c-146">Related Topics</span></span>

|<span data-ttu-id="bad7c-147">Titre</span><span class="sxs-lookup"><span data-stu-id="bad7c-147">Title</span></span>|<span data-ttu-id="bad7c-148">Description</span><span class="sxs-lookup"><span data-stu-id="bad7c-148">Description</span></span>|
|-----------|-----------------|
|[<span data-ttu-id="bad7c-149">Guide pratique : appeler une méthode déléguée</span><span class="sxs-lookup"><span data-stu-id="bad7c-149">How to: Invoke a Delegate Method</span></span>](../../../../visual-basic/programming-guide/language-features/delegates/how-to-invoke-a-delegate-method.md)|<span data-ttu-id="bad7c-150">Fournit un exemple d’association d’une méthode à un délégué, puis d’appel de cette méthode par le biais du délégué.</span><span class="sxs-lookup"><span data-stu-id="bad7c-150">Provides an example that shows how to associate a method with a delegate and then invoke that method through the delegate.</span></span>|
|[<span data-ttu-id="bad7c-151">Guide pratique : passer des procédures à une autre procédure en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="bad7c-151">How to: Pass Procedures to Another Procedure in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/delegates/how-to-pass-procedures-to-another-procedure.md)|<span data-ttu-id="bad7c-152">Montre comment utiliser des délégués pour transmettre une procédure à une autre procédure.</span><span class="sxs-lookup"><span data-stu-id="bad7c-152">Demonstrates how to use delegates to pass one procedure to another procedure.</span></span>|
|[<span data-ttu-id="bad7c-153">Conversion simplifiée des délégués</span><span class="sxs-lookup"><span data-stu-id="bad7c-153">Relaxed Delegate Conversion</span></span>](../../../../visual-basic/programming-guide/language-features/delegates/relaxed-delegate-conversion.md)|<span data-ttu-id="bad7c-154">Explique comment affecter des sous-routines et des fonctions aux délégués ou aux gestionnaires même si leurs signatures ne sont pas identiques.</span><span class="sxs-lookup"><span data-stu-id="bad7c-154">Describes how you can assign subs and functions to delegates or handlers even when their signatures are not identical</span></span>|
|[<span data-ttu-id="bad7c-155">Événements</span><span class="sxs-lookup"><span data-stu-id="bad7c-155">Events</span></span>](../../../../visual-basic/programming-guide/language-features/events/index.md)|<span data-ttu-id="bad7c-156">Fournit une vue d’ensemble des événements en Visual Basic.</span><span class="sxs-lookup"><span data-stu-id="bad7c-156">Provides an overview of events in Visual Basic.</span></span>|

---
title: Durée de vie
ms.date: 07/20/2015
helpviewer_keywords:
- static variables [Visual Basic], lifetime
- static variables [Visual Basic], Visual Basic
- declared elements [Visual Basic], lifetime
- Shared variable lifetime [Visual Basic]
- lifetime [Visual Basic], declared elements
- lifetime [Visual Basic], Visual Basic
- lifetime [Visual Basic]
ms.assetid: bd91e390-690a-469a-9946-8dca70bc14e7
ms.openlocfilehash: 293537ad33c8e751d49d820fc57ea525e68bc203
ms.sourcegitcommit: 30a558d23e3ac5a52071121a52c305c85fe15726
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/25/2019
ms.locfileid: "75347775"
---
# <a name="lifetime-in-visual-basic"></a><span data-ttu-id="d91d4-102">Durée de vie dans Visual Basic</span><span class="sxs-lookup"><span data-stu-id="d91d4-102">Lifetime in Visual Basic</span></span>
<span data-ttu-id="d91d4-103">La durée de *vie* d’un élément déclaré est la période pendant laquelle il peut être utilisé.</span><span class="sxs-lookup"><span data-stu-id="d91d4-103">The *lifetime* of a declared element is the period of time during which it is available for use.</span></span> <span data-ttu-id="d91d4-104">Les variables sont les seuls éléments qui ont une durée de vie.</span><span class="sxs-lookup"><span data-stu-id="d91d4-104">Variables are the only elements that have lifetime.</span></span> <span data-ttu-id="d91d4-105">À cet effet, le compilateur traite les paramètres de procédure et les retours de fonction comme des cas spéciaux de variables.</span><span class="sxs-lookup"><span data-stu-id="d91d4-105">For this purpose, the compiler treats procedure parameters and function returns as special cases of variables.</span></span> <span data-ttu-id="d91d4-106">La durée de vie d’une variable représente la durée pendant laquelle elle peut contenir une valeur.</span><span class="sxs-lookup"><span data-stu-id="d91d4-106">The lifetime of a variable represents the period of time during which it can hold a value.</span></span> <span data-ttu-id="d91d4-107">Sa valeur peut changer pendant sa durée de vie, mais elle contient toujours une valeur.</span><span class="sxs-lookup"><span data-stu-id="d91d4-107">Its value can change over its lifetime, but it always holds some value.</span></span>  
  
## <a name="different-lifetimes"></a><span data-ttu-id="d91d4-108">Durées de vie différentes</span><span class="sxs-lookup"><span data-stu-id="d91d4-108">Different Lifetimes</span></span>  
 <span data-ttu-id="d91d4-109">Une *variable membre* (déclarée au niveau du module, en dehors de toute procédure) a généralement la même durée de vie que l’élément dans lequel elle est déclarée.</span><span class="sxs-lookup"><span data-stu-id="d91d4-109">A *member variable* (declared at module level, outside any procedure) typically has the same lifetime as the element in which it is declared.</span></span> <span data-ttu-id="d91d4-110">Une variable non partagée déclarée dans une classe ou une structure existe en tant que copie distincte pour chaque instance de la classe ou de la structure dans laquelle elle est déclarée.</span><span class="sxs-lookup"><span data-stu-id="d91d4-110">A nonshared variable declared in a class or structure exists as a separate copy for each instance of the class or structure in which it is declared.</span></span> <span data-ttu-id="d91d4-111">Chaque variable de ce type a la même durée de vie que son instance.</span><span class="sxs-lookup"><span data-stu-id="d91d4-111">Each such variable has the same lifetime as its instance.</span></span> <span data-ttu-id="d91d4-112">Toutefois, une variable de `Shared` n’a qu’une seule durée de vie, qui dure pendant toute la durée d’exécution de votre application.</span><span class="sxs-lookup"><span data-stu-id="d91d4-112">However, a `Shared` variable has only a single lifetime, which lasts for the entire time your application is running.</span></span>  
  
 <span data-ttu-id="d91d4-113">Une *variable locale* (déclarée à l’intérieur d’une procédure) existe uniquement pendant l’exécution de la procédure dans laquelle elle est déclarée.</span><span class="sxs-lookup"><span data-stu-id="d91d4-113">A *local variable* (declared inside a procedure) exists only while the procedure in which it is declared is running.</span></span> <span data-ttu-id="d91d4-114">Cela s’applique également aux paramètres de cette procédure et à tout retour de fonction.</span><span class="sxs-lookup"><span data-stu-id="d91d4-114">This applies also to that procedure's parameters and to any function return.</span></span> <span data-ttu-id="d91d4-115">Toutefois, si cette procédure appelle d’autres procédures, les variables locales conservent leurs valeurs pendant l’exécution des procédures appelées.</span><span class="sxs-lookup"><span data-stu-id="d91d4-115">However, if that procedure calls other procedures, the local variables retain their values while the called procedures are running.</span></span>  
  
## <a name="beginning-of-lifetime"></a><span data-ttu-id="d91d4-116">Début de la durée de vie</span><span class="sxs-lookup"><span data-stu-id="d91d4-116">Beginning of Lifetime</span></span>  
 <span data-ttu-id="d91d4-117">La durée de vie d’une variable locale commence lorsque le contrôle entre dans la procédure dans laquelle elle est déclarée.</span><span class="sxs-lookup"><span data-stu-id="d91d4-117">A local variable's lifetime begins when control enters the procedure in which it is declared.</span></span> <span data-ttu-id="d91d4-118">Chaque variable locale est initialisée à la valeur par défaut pour son type de données dès que la procédure commence à s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="d91d4-118">Every local variable is initialized to the default value for its data type as soon as the procedure begins running.</span></span> <span data-ttu-id="d91d4-119">Lorsque la procédure rencontre une instruction `Dim` qui spécifie des valeurs initiales, elle définit ces variables sur ces valeurs, même si votre code s’est déjà vu assigner d’autres valeurs.</span><span class="sxs-lookup"><span data-stu-id="d91d4-119">When the procedure encounters a `Dim` statement that specifies initial values, it sets those variables to those values, even if your code had already assigned other values to them.</span></span>  
  
 <span data-ttu-id="d91d4-120">Chaque membre d’une variable de structure est initialisé comme s’il s’agissait d’une variable distincte.</span><span class="sxs-lookup"><span data-stu-id="d91d4-120">Each member of a structure variable is initialized as if it were a separate variable.</span></span> <span data-ttu-id="d91d4-121">De même, chaque élément d’une variable de tableau est initialisé individuellement.</span><span class="sxs-lookup"><span data-stu-id="d91d4-121">Similarly, each element of an array variable is initialized individually.</span></span>  
  
 <span data-ttu-id="d91d4-122">Les variables déclarées dans un bloc à l’intérieur d’une procédure (par exemple une boucle `For`) sont initialisées à l’entrée de la procédure.</span><span class="sxs-lookup"><span data-stu-id="d91d4-122">Variables declared within a block inside a procedure (such as a `For` loop) are initialized on entry to the procedure.</span></span> <span data-ttu-id="d91d4-123">Ces initialisations prennent effet, que votre code exécute ou non le bloc.</span><span class="sxs-lookup"><span data-stu-id="d91d4-123">These initializations take effect whether or not your code ever executes the block.</span></span>  
  
## <a name="end-of-lifetime"></a><span data-ttu-id="d91d4-124">Fin de la durée de vie</span><span class="sxs-lookup"><span data-stu-id="d91d4-124">End of Lifetime</span></span>  
 <span data-ttu-id="d91d4-125">Lorsqu’une procédure se termine, les valeurs de ses variables locales ne sont pas conservées et Visual Basic récupère leur mémoire.</span><span class="sxs-lookup"><span data-stu-id="d91d4-125">When a procedure terminates, the values of its local variables are not preserved, and Visual Basic reclaims their memory.</span></span> <span data-ttu-id="d91d4-126">La prochaine fois que vous appelez la procédure, toutes ses variables locales sont créées et réinitialisées.</span><span class="sxs-lookup"><span data-stu-id="d91d4-126">The next time you call the procedure, all its local variables are created afresh and reinitialized.</span></span>  
  
 <span data-ttu-id="d91d4-127">Lorsqu’une instance d’une classe ou d’une structure se termine, ses variables non partagées perdent leur mémoire et leurs valeurs.</span><span class="sxs-lookup"><span data-stu-id="d91d4-127">When an instance of a class or structure terminates, its nonshared variables lose their memory and their values.</span></span> <span data-ttu-id="d91d4-128">Chaque nouvelle instance de la classe ou de la structure crée et réinitialise ses variables non partagées.</span><span class="sxs-lookup"><span data-stu-id="d91d4-128">Each new instance of the class or structure creates and reinitializes its nonshared variables.</span></span> <span data-ttu-id="d91d4-129">Toutefois, les variables `Shared` sont conservées jusqu’à ce que votre application cesse de s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="d91d4-129">However, `Shared` variables are preserved until your application stops running.</span></span>  
  
## <a name="extension-of-lifetime"></a><span data-ttu-id="d91d4-130">Extension de la durée de vie</span><span class="sxs-lookup"><span data-stu-id="d91d4-130">Extension of Lifetime</span></span>  
 <span data-ttu-id="d91d4-131">Si vous déclarez une variable locale avec le mot clé `Static`, sa durée de vie est plus longue que la durée d’exécution de sa procédure.</span><span class="sxs-lookup"><span data-stu-id="d91d4-131">If you declare a local variable with the `Static` keyword, its lifetime is longer than the execution time of its procedure.</span></span> <span data-ttu-id="d91d4-132">Le tableau suivant montre comment la déclaration de procédure détermine la durée pendant laquelle une variable `Static` existe.</span><span class="sxs-lookup"><span data-stu-id="d91d4-132">The following table shows how the procedure declaration determines how long a `Static` variable exists.</span></span>  
  
|<span data-ttu-id="d91d4-133">Emplacement et partage des procédures</span><span class="sxs-lookup"><span data-stu-id="d91d4-133">Procedure location and sharing</span></span>|<span data-ttu-id="d91d4-134">La durée de vie des variables statiques commence</span><span class="sxs-lookup"><span data-stu-id="d91d4-134">Static variable lifetime begins</span></span>|<span data-ttu-id="d91d4-135">Fin de la durée de vie des variables statiques</span><span class="sxs-lookup"><span data-stu-id="d91d4-135">Static variable lifetime ends</span></span>|  
|------------------------------------|-------------------------------------|-----------------------------------|  
|<span data-ttu-id="d91d4-136">Dans un module (partagé par défaut)</span><span class="sxs-lookup"><span data-stu-id="d91d4-136">In a module (shared by default)</span></span>|<span data-ttu-id="d91d4-137">La première fois que la procédure est appelée</span><span class="sxs-lookup"><span data-stu-id="d91d4-137">The first time the procedure is called</span></span>|<span data-ttu-id="d91d4-138">Quand votre application cesse de s’exécuter</span><span class="sxs-lookup"><span data-stu-id="d91d4-138">When your application stops running</span></span>|  
|<span data-ttu-id="d91d4-139">Dans une classe, `Shared` (la procédure n’est pas un membre d’instance)</span><span class="sxs-lookup"><span data-stu-id="d91d4-139">In a class, `Shared` (procedure is not an instance member)</span></span>|<span data-ttu-id="d91d4-140">La première fois que la procédure est appelée sur une instance spécifique ou sur le nom de la classe ou de la structure elle-même</span><span class="sxs-lookup"><span data-stu-id="d91d4-140">The first time the procedure is called either on a specific instance or on the class or structure name itself</span></span>|<span data-ttu-id="d91d4-141">Quand votre application cesse de s’exécuter</span><span class="sxs-lookup"><span data-stu-id="d91d4-141">When your application stops running</span></span>|  
|<span data-ttu-id="d91d4-142">Dans une instance d’une classe, non `Shared` (la procédure est un membre d’instance)</span><span class="sxs-lookup"><span data-stu-id="d91d4-142">In an instance of a class, not `Shared` (procedure is an instance member)</span></span>|<span data-ttu-id="d91d4-143">La première fois que la procédure est appelée sur l’instance spécifique</span><span class="sxs-lookup"><span data-stu-id="d91d4-143">The first time the procedure is called on the specific instance</span></span>|<span data-ttu-id="d91d4-144">Lorsque l’instance est libérée pour garbage collection (GC)</span><span class="sxs-lookup"><span data-stu-id="d91d4-144">When the instance is released for garbage collection (GC)</span></span>|  
  
## <a name="static-variables-of-the-same-name"></a><span data-ttu-id="d91d4-145">Variables statiques du même nom</span><span class="sxs-lookup"><span data-stu-id="d91d4-145">Static Variables of the Same Name</span></span>  
 <span data-ttu-id="d91d4-146">Vous pouvez déclarer des variables statiques portant le même nom dans plusieurs procédures.</span><span class="sxs-lookup"><span data-stu-id="d91d4-146">You can declare static variables with the same name in more than one procedure.</span></span> <span data-ttu-id="d91d4-147">Dans ce cas, le compilateur Visual Basic considère chaque variable de ce type comme un élément distinct.</span><span class="sxs-lookup"><span data-stu-id="d91d4-147">If you do this, the Visual Basic compiler considers each such variable to be a separate element.</span></span> <span data-ttu-id="d91d4-148">L’initialisation de l’une de ces variables n’affecte pas les valeurs des autres.</span><span class="sxs-lookup"><span data-stu-id="d91d4-148">The initialization of one of these variables does not affect the values of the others.</span></span> <span data-ttu-id="d91d4-149">Il en va de même si vous définissez une procédure avec un ensemble de surcharges et que vous déclarez une variable statique avec le même nom dans chaque surcharge.</span><span class="sxs-lookup"><span data-stu-id="d91d4-149">The same applies if you define a procedure with a set of overloads and declare a static variable with the same name in each overload.</span></span>  
  
## <a name="containing-elements-for-static-variables"></a><span data-ttu-id="d91d4-150">Contenant des éléments pour les variables statiques</span><span class="sxs-lookup"><span data-stu-id="d91d4-150">Containing Elements for Static Variables</span></span>  
 <span data-ttu-id="d91d4-151">Vous pouvez déclarer une variable locale statique dans une classe, c’est-à-dire à l’intérieur d’une procédure de cette classe.</span><span class="sxs-lookup"><span data-stu-id="d91d4-151">You can declare a static local variable within a class, that is, inside a procedure in that class.</span></span> <span data-ttu-id="d91d4-152">Toutefois, vous ne pouvez pas déclarer une variable locale statique dans une structure, qu’il s’agisse d’un membre de structure ou d’une variable locale d’une procédure au sein de cette structure.</span><span class="sxs-lookup"><span data-stu-id="d91d4-152">However, you cannot declare a static local variable within a structure, either as a structure member or as a local variable of a procedure within that structure.</span></span>  
  
## <a name="example"></a><span data-ttu-id="d91d4-153">Exemple</span><span class="sxs-lookup"><span data-stu-id="d91d4-153">Example</span></span>  
  
### <a name="description"></a><span data-ttu-id="d91d4-154">Description</span><span class="sxs-lookup"><span data-stu-id="d91d4-154">Description</span></span>  
 <span data-ttu-id="d91d4-155">L’exemple suivant déclare une variable avec le mot clé [static](../../../../visual-basic/language-reference/modifiers/static.md) .</span><span class="sxs-lookup"><span data-stu-id="d91d4-155">The following example declares a variable with the [Static](../../../../visual-basic/language-reference/modifiers/static.md) keyword.</span></span> <span data-ttu-id="d91d4-156">(Notez que vous n’avez pas besoin du mot clé `Dim` lorsque l' [instruction Dim](../../../../visual-basic/language-reference/statements/dim-statement.md) utilise un modificateur tel que `Static`.)</span><span class="sxs-lookup"><span data-stu-id="d91d4-156">(Note that you do not need the `Dim` keyword when the [Dim Statement](../../../../visual-basic/language-reference/statements/dim-statement.md) uses a modifier such as `Static`.)</span></span>  
  
### <a name="code"></a><span data-ttu-id="d91d4-157">Code</span><span class="sxs-lookup"><span data-stu-id="d91d4-157">Code</span></span>  
 [!code-vb[VbVbalrKeywords#13](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrKeywords/VB/class7.vb#13)]  
  
### <a name="comments"></a><span data-ttu-id="d91d4-158">Comments</span><span class="sxs-lookup"><span data-stu-id="d91d4-158">Comments</span></span>  
 <span data-ttu-id="d91d4-159">Dans l’exemple précédent, la variable `applesSold` continue d’exister après que la procédure `runningTotal` retournée au code appelant.</span><span class="sxs-lookup"><span data-stu-id="d91d4-159">In the preceding example, the variable `applesSold` continues to exist after the procedure `runningTotal` returns to the calling code.</span></span> <span data-ttu-id="d91d4-160">La prochaine fois que `runningTotal` est appelée, `applesSold` conserve sa valeur précédemment calculée.</span><span class="sxs-lookup"><span data-stu-id="d91d4-160">The next time `runningTotal` is called, `applesSold` retains its previously calculated value.</span></span>  
  
 <span data-ttu-id="d91d4-161">Si `applesSold` avait été déclaré sans utiliser `Static`, les valeurs accumulées précédentes ne seront pas conservées entre les appels à `runningTotal`.</span><span class="sxs-lookup"><span data-stu-id="d91d4-161">If `applesSold` had been declared without using `Static`, the previous accumulated values would not be preserved across calls to `runningTotal`.</span></span> <span data-ttu-id="d91d4-162">Lors du prochain appel de `runningTotal`, `applesSold` aurait été recréé et initialisé à 0, et `runningTotal` aurait simplement retourné la même valeur que celle avec laquelle il a été appelé.</span><span class="sxs-lookup"><span data-stu-id="d91d4-162">The next time `runningTotal` was called, `applesSold` would have been recreated and initialized to 0, and `runningTotal` would have simply returned the same value with which it was called.</span></span>  
  
### <a name="compile-the-code"></a><span data-ttu-id="d91d4-163">Compiler le code</span><span class="sxs-lookup"><span data-stu-id="d91d4-163">Compile the code</span></span>  
 <span data-ttu-id="d91d4-164">Vous pouvez initialiser la valeur d’une variable locale statique dans le cadre de sa déclaration.</span><span class="sxs-lookup"><span data-stu-id="d91d4-164">You can initialize the value of a static local variable as part of its declaration.</span></span> <span data-ttu-id="d91d4-165">Si vous déclarez un tableau à `Static`, vous pouvez initialiser son rang (nombre de dimensions), la longueur de chaque dimension et les valeurs des éléments individuels.</span><span class="sxs-lookup"><span data-stu-id="d91d4-165">If you declare an array to be `Static`, you can initialize its rank (number of dimensions), the length of each dimension, and the values of the individual elements.</span></span>  
  
### <a name="security"></a><span data-ttu-id="d91d4-166">Sécurité</span><span class="sxs-lookup"><span data-stu-id="d91d4-166">Security</span></span>  
 <span data-ttu-id="d91d4-167">Dans l’exemple précédent, vous pouvez produire la même durée de vie en déclarant `applesSold` au niveau du module.</span><span class="sxs-lookup"><span data-stu-id="d91d4-167">In the preceding example, you can produce the same lifetime by declaring `applesSold` at module level.</span></span> <span data-ttu-id="d91d4-168">Toutefois, si vous avez modifié l’étendue d’une variable de cette manière, la procédure n’aura plus d’accès exclusif à celle-ci.</span><span class="sxs-lookup"><span data-stu-id="d91d4-168">If you changed the scope of a variable this way, however, the procedure would no longer have exclusive access to it.</span></span> <span data-ttu-id="d91d4-169">Étant donné que d’autres procédures peuvent accéder à `applesSold` et modifier sa valeur, le total cumulé n’est pas fiable et le code peut être plus difficile à gérer.</span><span class="sxs-lookup"><span data-stu-id="d91d4-169">Because other procedures could access `applesSold` and change its value, the running total could be unreliable and the code could be more difficult to maintain.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d91d4-170">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d91d4-170">See also</span></span>

- [<span data-ttu-id="d91d4-171">Shared</span><span class="sxs-lookup"><span data-stu-id="d91d4-171">Shared</span></span>](../../../../visual-basic/language-reference/modifiers/shared.md)
- [<span data-ttu-id="d91d4-172">Nothing</span><span class="sxs-lookup"><span data-stu-id="d91d4-172">Nothing</span></span>](../../../../visual-basic/language-reference/nothing.md)
- [<span data-ttu-id="d91d4-173">Noms d’éléments déclarés</span><span class="sxs-lookup"><span data-stu-id="d91d4-173">Declared Element Names</span></span>](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md)
- [<span data-ttu-id="d91d4-174">Références aux éléments déclarés</span><span class="sxs-lookup"><span data-stu-id="d91d4-174">References to Declared Elements</span></span>](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md)
- [<span data-ttu-id="d91d4-175">Étendue dans Visual Basic</span><span class="sxs-lookup"><span data-stu-id="d91d4-175">Scope in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md)
- [<span data-ttu-id="d91d4-176">Niveaux d’accès dans Visual Basic</span><span class="sxs-lookup"><span data-stu-id="d91d4-176">Access levels in Visual Basic</span></span>](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md)
- [<span data-ttu-id="d91d4-177">Variables</span><span class="sxs-lookup"><span data-stu-id="d91d4-177">Variables</span></span>](../../../../visual-basic/programming-guide/language-features/variables/index.md)
- [<span data-ttu-id="d91d4-178">Déclaration de variable</span><span class="sxs-lookup"><span data-stu-id="d91d4-178">Variable Declaration</span></span>](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md)
- [<span data-ttu-id="d91d4-179">Dépannage des types de données</span><span class="sxs-lookup"><span data-stu-id="d91d4-179">Troubleshooting Data Types</span></span>](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md)
- [<span data-ttu-id="d91d4-180">Static</span><span class="sxs-lookup"><span data-stu-id="d91d4-180">Static</span></span>](../../../../visual-basic/language-reference/modifiers/static.md)

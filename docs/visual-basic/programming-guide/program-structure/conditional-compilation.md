---
title: Compilation conditionnelle en Visual Basic
ms.date: 07/20/2015
helpviewer_keywords:
- conditional compilation [Visual Basic], about conditional compilation
- compilation [Visual Basic], conditional
ms.assetid: 9c35e55e-7eee-44fb-a586-dad1f1884848
ms.openlocfilehash: 4698435cb2ab15d16d8a8a898a01a9ffbc4f69c2
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "64639810"
---
# <a name="conditional-compilation-in-visual-basic"></a><span data-ttu-id="e1792-102">Compilation conditionnelle en Visual Basic</span><span class="sxs-lookup"><span data-stu-id="e1792-102">Conditional Compilation in Visual Basic</span></span>
<span data-ttu-id="e1792-103">Dans *compilation conditionnelle*, blocs de code dans un programme spécifiques compiler de façon sélective tandis que d’autres sont ignorés.</span><span class="sxs-lookup"><span data-stu-id="e1792-103">In *conditional compilation*, particular blocks of code in a program are compiled selectively while others are ignored.</span></span>  
  
 <span data-ttu-id="e1792-104">Par exemple, vous souhaiterez écrire des instructions de débogage qui comparent la rapidité de différentes approches pour la même tâche de programmation, ou vous peuvent souhaiter localiser une application pour plusieurs langues.</span><span class="sxs-lookup"><span data-stu-id="e1792-104">For example, you may want to write debugging statements that compare the speed of different approaches to the same programming task, or you may want to localize an application for multiple languages.</span></span> <span data-ttu-id="e1792-105">Instructions de compilation conditionnelle sont conçues pour s’exécuter pendant la compilation, pas au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="e1792-105">Conditional compilation statements are designed to run during compile time, not at run time.</span></span>  
  
 <span data-ttu-id="e1792-106">Vous désignez des blocs de code à compiler de façon conditionnelle avec la `#If...Then...#Else` directive.</span><span class="sxs-lookup"><span data-stu-id="e1792-106">You denote blocks of code to be conditionally compiled with the `#If...Then...#Else` directive.</span></span> <span data-ttu-id="e1792-107">Par exemple, pour créer le Français et allemand versions de la même application à partir de la même le code source, incorporez des segments de code spécifique à la plateforme dans `#If...Then` instructions à l’aide de l’une des constantes prédéfinies `FrenchVersion` et `GermanVersion`.</span><span class="sxs-lookup"><span data-stu-id="e1792-107">For example, to create French- and German-language versions of the same application from the same source code, you embed platform-specific code segments in `#If...Then` statements using the predefined constants `FrenchVersion` and `GermanVersion`.</span></span> <span data-ttu-id="e1792-108">L’exemple suivant montre comment :</span><span class="sxs-lookup"><span data-stu-id="e1792-108">The following example demonstrates how:</span></span>  
  
 [!code-vb[VbVbalrConditionalComp#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbalrConditionalComp/VB/Class1.vb#5)]  
  
 <span data-ttu-id="e1792-109">Si vous définissez la valeur de la `FrenchVersion` constante de compilation conditionnelle à `True` au moment de la compilation, le code conditionnel pour la version Français est compilé.</span><span class="sxs-lookup"><span data-stu-id="e1792-109">If you set the value of the `FrenchVersion` conditional compilation constant to `True` at compile time, the conditional code for the French version is compiled.</span></span> <span data-ttu-id="e1792-110">Si vous définissez la valeur de la `GermanVersion` constante à `True`, le compilateur utilise la version allemande.</span><span class="sxs-lookup"><span data-stu-id="e1792-110">If you set the value of the `GermanVersion` constant to `True`, the compiler uses the German version.</span></span> <span data-ttu-id="e1792-111">Si aucun n’est défini `True`, le code dans la dernière `Else` bloquer s’exécute.</span><span class="sxs-lookup"><span data-stu-id="e1792-111">If neither is set to `True`, the code in the last `Else` block runs.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="e1792-112">La saisie semi-automatique ne fonctionne pas lorsque vous modifiez du code et à l’aide de directives de compilation conditionnelle Si le code ne fait pas partie de la branche active.</span><span class="sxs-lookup"><span data-stu-id="e1792-112">Autocompletion will not function when editing code and using conditional compilation directives if the code is not part of the current branch.</span></span>  
  
## <a name="declaring-conditional-compilation-constants"></a><span data-ttu-id="e1792-113">Déclarer des constantes de Compilation conditionnelle</span><span class="sxs-lookup"><span data-stu-id="e1792-113">Declaring Conditional Compilation Constants</span></span>  
 <span data-ttu-id="e1792-114">Vous pouvez définir des constantes de compilation conditionnelle dans un des trois façons :</span><span class="sxs-lookup"><span data-stu-id="e1792-114">You can set conditional compilation constants in one of three ways:</span></span>  
  
- <span data-ttu-id="e1792-115">Dans le **du Concepteur de projets**</span><span class="sxs-lookup"><span data-stu-id="e1792-115">In the **Project Designer**</span></span>  
  
- <span data-ttu-id="e1792-116">Sur la ligne de commande lorsque vous utilisez le compilateur de ligne de commande</span><span class="sxs-lookup"><span data-stu-id="e1792-116">At the command line when using the command-line compiler</span></span>  
  
- <span data-ttu-id="e1792-117">Dans votre code</span><span class="sxs-lookup"><span data-stu-id="e1792-117">In your code</span></span>  
  
 <span data-ttu-id="e1792-118">Constantes de compilation conditionnelle ont une portée spéciale et ne sont pas accessibles à partir du code standard.</span><span class="sxs-lookup"><span data-stu-id="e1792-118">Conditional compilation constants have a special scope and cannot be accessed from standard code.</span></span> <span data-ttu-id="e1792-119">La portée d’une constante de compilation conditionnelle est dépendante de la façon dont elle est définie.</span><span class="sxs-lookup"><span data-stu-id="e1792-119">The scope of a conditional compilation constant is dependent on the way it is set.</span></span> <span data-ttu-id="e1792-120">Le tableau suivant répertorie la portée des constantes déclarées à l’aide de chacun des trois méthodes mentionnées ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="e1792-120">The following table lists the scope of constants declared using each of the three ways mentioned above.</span></span>  
  
|<span data-ttu-id="e1792-121">Configuration (constante)</span><span class="sxs-lookup"><span data-stu-id="e1792-121">How constant is set</span></span>|<span data-ttu-id="e1792-122">Étendue de constante</span><span class="sxs-lookup"><span data-stu-id="e1792-122">Scope of constant</span></span>|  
|---|---|  
|<span data-ttu-id="e1792-123">**Concepteur de projets**</span><span class="sxs-lookup"><span data-stu-id="e1792-123">**Project Designer**</span></span>|<span data-ttu-id="e1792-124">Public, pour tous les fichiers dans le projet</span><span class="sxs-lookup"><span data-stu-id="e1792-124">Public to all files in the project</span></span>|  
|<span data-ttu-id="e1792-125">Ligne de commande</span><span class="sxs-lookup"><span data-stu-id="e1792-125">Command line</span></span>|<span data-ttu-id="e1792-126">Public, pour tous les fichiers passés au compilateur de ligne de commande</span><span class="sxs-lookup"><span data-stu-id="e1792-126">Public to all files passed to the command-line compiler</span></span>|  
|<span data-ttu-id="e1792-127">`#Const` instruction de code</span><span class="sxs-lookup"><span data-stu-id="e1792-127">`#Const` statement in code</span></span>|<span data-ttu-id="e1792-128">Privée pour le fichier dans lequel elle est déclarée</span><span class="sxs-lookup"><span data-stu-id="e1792-128">Private to the file in which it is declared</span></span>|  
  
|<span data-ttu-id="e1792-129">Pour définir des constantes dans le Concepteur de projets</span><span class="sxs-lookup"><span data-stu-id="e1792-129">To set constants in the Project Designer</span></span>|  
|---|  
|<span data-ttu-id="e1792-130">-Avant de créer votre fichier exécutable, définissez des constantes dans le **Concepteur de projets** en suivant les étapes fournies dans [la gestion des propriétés de projet et Solution](/visualstudio/ide/managing-project-and-solution-properties).</span><span class="sxs-lookup"><span data-stu-id="e1792-130">-   Before creating your executable file, set constants in the **Project Designer** by following the steps provided in [Managing Project and Solution Properties](/visualstudio/ide/managing-project-and-solution-properties).</span></span>|  
  
|<span data-ttu-id="e1792-131">Pour définir des constantes à la ligne de commande</span><span class="sxs-lookup"><span data-stu-id="e1792-131">To set constants at the command line</span></span>|  
|---|  
|<span data-ttu-id="e1792-132">-Utilisez le **/d** commutateur pour entrer des constantes de compilation conditionnelle, comme dans l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="e1792-132">-   Use the **/d** switch to enter conditional compilation constants, as in the following example:</span></span><br />     `vbc MyProj.vb /d:conFrenchVersion=–1:conANSI=0`<br />     <span data-ttu-id="e1792-133">Aucun espace n’est nécessaire entre le **/d** commutateur et la première constante.</span><span class="sxs-lookup"><span data-stu-id="e1792-133">No space is required between the **/d** switch and the first constant.</span></span> <span data-ttu-id="e1792-134">Pour plus d’informations, consultez [/ define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md).</span><span class="sxs-lookup"><span data-stu-id="e1792-134">For more information, see [/define (Visual Basic)](../../../visual-basic/reference/command-line-compiler/define.md).</span></span><br />     <span data-ttu-id="e1792-135">Les déclarations de ligne de commande substituent les déclarations entrées dans le **Concepteur de projet**, mais ne les suppriment pas.</span><span class="sxs-lookup"><span data-stu-id="e1792-135">Command-line declarations override declarations entered in the **Project Designer**, but do not erase them.</span></span> <span data-ttu-id="e1792-136">Arguments définis **Concepteur de projets** restent en vigueur pour les compilations ultérieures.</span><span class="sxs-lookup"><span data-stu-id="e1792-136">Arguments set in **Project Designer** remain in effect for subsequent compilations.</span></span><br />     <span data-ttu-id="e1792-137">Lorsque vous écrivez des constantes dans le code lui-même, ne sont pas des règles strictes quant à leur emplacement, car leur étendue est l’ensemble du module dans lequel ils sont déclarés.</span><span class="sxs-lookup"><span data-stu-id="e1792-137">When writing constants in the code itself, there are no strict rules as to their placement, since their scope is the entire module in which they are declared.</span></span>|  
  
|<span data-ttu-id="e1792-138">Pour définir des constantes dans votre code</span><span class="sxs-lookup"><span data-stu-id="e1792-138">To set constants in your code</span></span>|  
|---|  
|<span data-ttu-id="e1792-139">-Placez les constantes dans le bloc de déclaration du module dans lequel elles sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="e1792-139">-   Place the constants in the declaration block of the module in which they are used.</span></span> <span data-ttu-id="e1792-140">Cela permet de maintenir votre code organisé et plus facile à lire.</span><span class="sxs-lookup"><span data-stu-id="e1792-140">This helps keep your code organized and easier to read.</span></span>|  
  
## <a name="related-topics"></a><span data-ttu-id="e1792-141">Rubriques connexes</span><span class="sxs-lookup"><span data-stu-id="e1792-141">Related Topics</span></span>  
  
|<span data-ttu-id="e1792-142">Titre</span><span class="sxs-lookup"><span data-stu-id="e1792-142">Title</span></span>|<span data-ttu-id="e1792-143">Description</span><span class="sxs-lookup"><span data-stu-id="e1792-143">Description</span></span>|  
|---|---|  
|[<span data-ttu-id="e1792-144">Structure de programme et conventions de codage</span><span class="sxs-lookup"><span data-stu-id="e1792-144">Program Structure and Code Conventions</span></span>](../../../visual-basic/programming-guide/program-structure/program-structure-and-code-conventions.md)|<span data-ttu-id="e1792-145">Fournit des suggestions pour rendre votre code facile à lire et à gérer.</span><span class="sxs-lookup"><span data-stu-id="e1792-145">Provides suggestions for making your code easy to read and maintain.</span></span>|  
  
## <a name="reference"></a><span data-ttu-id="e1792-146">Référence</span><span class="sxs-lookup"><span data-stu-id="e1792-146">Reference</span></span>  
 [<span data-ttu-id="e1792-147">#Const (directive)</span><span class="sxs-lookup"><span data-stu-id="e1792-147">#Const Directive</span></span>](../../../visual-basic/language-reference/directives/const-directive.md)  
  
 [<span data-ttu-id="e1792-148">#If...Then...#Else, directives</span><span class="sxs-lookup"><span data-stu-id="e1792-148">#If...Then...#Else Directives</span></span>](../../../visual-basic/language-reference/directives/if-then-else-directives.md)  
  
 [<span data-ttu-id="e1792-149">/define (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="e1792-149">/define (Visual Basic)</span></span>](../../../visual-basic/reference/command-line-compiler/define.md)

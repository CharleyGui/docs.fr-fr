---
title: Vue d'ensemble des convertisseurs de types pour XAML
ms.date: 03/30/2017
helpviewer_keywords:
- XAML [XAML Services], type converters
- XAML [XAML Services], TypeConverter
- type conversion for XAML [XAML Services]
ms.assetid: 51a65860-efcb-4fe0-95a0-1c679cde66b7
ms.openlocfilehash: 6e78210178fda65bb3baad0d24eb3a20cd6f2a3e
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/15/2020
ms.locfileid: "90540111"
---
# <a name="overview-of-type-converters-for-xaml"></a><span data-ttu-id="48056-102">Vue d’ensemble des convertisseurs de type pour XAML</span><span class="sxs-lookup"><span data-stu-id="48056-102">Overview of type converters for XAML</span></span>

<span data-ttu-id="48056-103">Les convertisseurs de type fournissent la logique nécessaire à un writer d'objet qui convertit une chaîne de balisage XAML en objets particuliers d'un graphique d'objets.</span><span class="sxs-lookup"><span data-stu-id="48056-103">Type converters supply logic for an object writer that converts from a string in XAML markup into particular objects in an object graph.</span></span> <span data-ttu-id="48056-104">Dans les services XAML .NET, le convertisseur de type doit être une classe qui dérive de <xref:System.ComponentModel.TypeConverter> .</span><span class="sxs-lookup"><span data-stu-id="48056-104">In .NET XAML Services, the type converter must be a class that derives from <xref:System.ComponentModel.TypeConverter>.</span></span> <span data-ttu-id="48056-105">Certains convertisseurs prennent également en charge le chemin d'enregistrement XAML et peuvent être utilisés pour sérialiser un objet sous forme de chaîne dans le balisage de sérialisation.</span><span class="sxs-lookup"><span data-stu-id="48056-105">Some converters also support the XAML save path and can be used to serialize an object into a string form in serialization markup.</span></span> <span data-ttu-id="48056-106">Cette rubrique décrit comment et quand les convertisseurs de type en XAML sont appelés, et fournit des conseils d'implémentation pour les substitutions de méthode de <xref:System.ComponentModel.TypeConverter>.</span><span class="sxs-lookup"><span data-stu-id="48056-106">This topic describes how and when type converters in XAML are invoked, and provides implementation advice for the method overrides of <xref:System.ComponentModel.TypeConverter>.</span></span>

## <a name="type-conversion-concepts"></a><span data-ttu-id="48056-107">Concepts de conversion de type</span><span class="sxs-lookup"><span data-stu-id="48056-107">Type Conversion Concepts</span></span>

<span data-ttu-id="48056-108">Les sections suivantes expliquent les concepts de base relatifs à la façon dont XAML utilise les chaînes et comment les Writers d’objet des services XAML .NET utilisent des convertisseurs de type pour traiter certaines valeurs de chaîne rencontrées dans une source XAML.</span><span class="sxs-lookup"><span data-stu-id="48056-108">The following sections explain basic concepts about how XAML uses strings, and how object writers in .NET XAML Services use type converters to process some of the string values that are encountered in a XAML source.</span></span>

### <a name="xaml-and-string-values"></a><span data-ttu-id="48056-109">XAML et valeurs de chaîne</span><span class="sxs-lookup"><span data-stu-id="48056-109">XAML and String Values</span></span>

<span data-ttu-id="48056-110">Lorsque vous définissez une valeur d'attribut dans un fichier XAML, le type initial de cette valeur est une chaîne dans un sens général et une valeur d'attribut de chaîne dans le sens de XML.</span><span class="sxs-lookup"><span data-stu-id="48056-110">When you set an attribute value in a XAML file, the initial type of that value is a string in a general sense, and a string attribute value in an XML sense.</span></span> <span data-ttu-id="48056-111">Même les autres primitives telles que <xref:System.Double> sont initialement des chaînes pour un processeur XAML.</span><span class="sxs-lookup"><span data-stu-id="48056-111">Even other primitives such as <xref:System.Double> are initially strings to a XAML processor.</span></span>

<span data-ttu-id="48056-112">Dans la plupart des cas, un processeur XAML a besoin de deux éléments d'informations pour traiter une valeur d'attribut.</span><span class="sxs-lookup"><span data-stu-id="48056-112">In most cases, a XAML processor needs two pieces of information to process an attribute value.</span></span> <span data-ttu-id="48056-113">Le premier élément d'information est le type valeur de la propriété à définir.</span><span class="sxs-lookup"><span data-stu-id="48056-113">The first piece of information is the value type of the property that is being set.</span></span> <span data-ttu-id="48056-114">N'importe quelle chaîne qui définit une valeur d'attribut et qui est traitée en XAML doit au final être convertie ou résolue en une valeur de ce type.</span><span class="sxs-lookup"><span data-stu-id="48056-114">Any string that defines an attribute value and that is processed in XAML must ultimately be converted or resolved to a value of that type.</span></span> <span data-ttu-id="48056-115">Si la valeur est une primitive comprise par l'analyseur XAML (telle qu'une valeur numérique), une conversion directe de la chaîne est tentée.</span><span class="sxs-lookup"><span data-stu-id="48056-115">If the value is a primitive that is understood by the XAML parser (such as a numeric value), a direct conversion of the string is attempted.</span></span> <span data-ttu-id="48056-116">Si la valeur de l'attribut référence une énumération, la chaîne fournie est utilisée pour rechercher une correspondance de nom avec une constante nommée dans cette énumération.</span><span class="sxs-lookup"><span data-stu-id="48056-116">If the value for the attribute references an enumeration, the supplied string is checked for a name match to a named constant in that enumeration.</span></span> <span data-ttu-id="48056-117">Si la valeur n’est pas une primitive comprise par l’analyseur ou un nom de constante d’une énumération, le type applicable doit pouvoir fournir une valeur ou une référence basée sur une chaîne convertie.</span><span class="sxs-lookup"><span data-stu-id="48056-117">If the value is not a parser-understood primitive or a constant name from an enumeration, the applicable type must be able to provide a value or reference that is based on a converted string.</span></span>

> [!NOTE]
> <span data-ttu-id="48056-118">Les directives de langage XAML n'utilisent pas de convertisseur de type.</span><span class="sxs-lookup"><span data-stu-id="48056-118">XAML language directives do not use type converters.</span></span>

### <a name="type-converters-and-markup-extensions"></a><span data-ttu-id="48056-119">Convertisseurs de type et extensions de balisage</span><span class="sxs-lookup"><span data-stu-id="48056-119">Type Converters and Markup Extensions</span></span>

<span data-ttu-id="48056-120">Les utilisations d'extension de balisage doivent être gérées par un processeur XAML avant qu'il ne recherche le type de propriété et d'autres considérations.</span><span class="sxs-lookup"><span data-stu-id="48056-120">Markup extension usages must be handled by a XAML processor before it checks for property type and other considerations.</span></span> <span data-ttu-id="48056-121">Par exemple, si une propriété définie en tant qu'attribut a généralement une conversion de type, mais que dans un cas particulier, elle est définie par une utilisation d'extension de balisage, le comportement d'extension de balisage est traité en premier.</span><span class="sxs-lookup"><span data-stu-id="48056-121">For example, if a property being set as an attribute normally has a type conversion, but in a particular case is set by a markup extension usage, then the markup extension behavior processes first.</span></span> <span data-ttu-id="48056-122">Faire référence à un objet existant constitue une situation courante où il est nécessaire d'utiliser une extension de balisage.</span><span class="sxs-lookup"><span data-stu-id="48056-122">One common situation where a markup extension is necessary is to make a reference to an object that already exists.</span></span> <span data-ttu-id="48056-123">Pour ce scénario, un convertisseur de type sans état peut uniquement générer une nouvelle instance, ce qui n'est peut-être pas souhaitable.</span><span class="sxs-lookup"><span data-stu-id="48056-123">For this scenario, a stateless type converter can only generate a new instance, which might not be desirable.</span></span> <span data-ttu-id="48056-124">Pour plus d’informations sur les extensions de balisage, consultez [Markup Extensions for XAML Overview](markup-extensions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="48056-124">For more information about markup extensions, see [Markup Extensions for XAML Overview](markup-extensions-overview.md).</span></span>

### <a name="native-type-converters"></a><span data-ttu-id="48056-125">Convertisseurs de type natif</span><span class="sxs-lookup"><span data-stu-id="48056-125">Native Type Converters</span></span>

<span data-ttu-id="48056-126">Dans les implémentations de services XAML Windows Presentation Foundation (WPF) et .NET, il existe certains types CLR qui gèrent la conversion de type natif.</span><span class="sxs-lookup"><span data-stu-id="48056-126">In the Windows Presentation Foundation (WPF) and .NET XAML services implementations, there are certain CLR types that have native type conversion handling.</span></span> <span data-ttu-id="48056-127">Toutefois, ces types CLR ne sont pas considérés conventionnellement comme des primitives.</span><span class="sxs-lookup"><span data-stu-id="48056-127">However, those CLR types are not conventionally thought of as primitives.</span></span> <span data-ttu-id="48056-128">Un exemple d'un tel type est <xref:System.DateTime>.</span><span class="sxs-lookup"><span data-stu-id="48056-128">An example of such a type is <xref:System.DateTime>.</span></span> <span data-ttu-id="48056-129">L'une des raisons réside dans le fonctionnement de l'architecture .NET Framework : le type <xref:System.DateTime> est défini dans mscorlib, la bibliothèque la plus élémentaire du .NET.</span><span class="sxs-lookup"><span data-stu-id="48056-129">One reason for this is how the .NET Framework architecture works: the type <xref:System.DateTime> is defined in mscorlib, the most basic library in .NET.</span></span> <span data-ttu-id="48056-130"><xref:System.DateTime> n’est pas autorisé à être attribué avec un attribut qui provient d’un autre assembly qui introduit une dépendance ( <xref:System.ComponentModel.TypeConverterAttribute> est du système).</span><span class="sxs-lookup"><span data-stu-id="48056-130"><xref:System.DateTime> is not permitted to be attributed with an attribute that comes from another assembly that introduces a dependency (<xref:System.ComponentModel.TypeConverterAttribute> is from System).</span></span> <span data-ttu-id="48056-131">Par conséquent, le mécanisme de découverte du convertisseur de type habituel par attribution ne peut pas être pris en charge.</span><span class="sxs-lookup"><span data-stu-id="48056-131">Therefore, the usual type converter discovery mechanism by attributing cannot be supported.</span></span> <span data-ttu-id="48056-132">À la place, l'analyseur XAML dispose d'une liste des types qui doivent faire l'objet d'un traitement natif et traite ces types de la même façon que les véritables primitives.</span><span class="sxs-lookup"><span data-stu-id="48056-132">Instead, the XAML parser has a list of types that need native processing, and it processes these types similar to how the true primitives are processed.</span></span> <span data-ttu-id="48056-133">Dans le cas de <xref:System.DateTime>, ce traitement implique un appel à <xref:System.DateTime.Parse%2A>.</span><span class="sxs-lookup"><span data-stu-id="48056-133">In the case of <xref:System.DateTime>, this processing involves a call to <xref:System.DateTime.Parse%2A>.</span></span>

## <a name="implementing-a-type-converter"></a><span data-ttu-id="48056-134">Implémentation d'un convertisseur de type</span><span class="sxs-lookup"><span data-stu-id="48056-134">Implementing a Type Converter</span></span>

<span data-ttu-id="48056-135">Les sections suivantes traitent de l'API de la classe <xref:System.ComponentModel.TypeConverter> .</span><span class="sxs-lookup"><span data-stu-id="48056-135">The following sections discuss the API of the <xref:System.ComponentModel.TypeConverter> class.</span></span>

### <a name="typeconverter"></a><span data-ttu-id="48056-136">TypeConverter</span><span class="sxs-lookup"><span data-stu-id="48056-136">TypeConverter</span></span>

<span data-ttu-id="48056-137">Sous les services XAML .NET, tous les convertisseurs de type utilisés pour le XAML sont des classes qui dérivent de la classe de base <xref:System.ComponentModel.TypeConverter> .</span><span class="sxs-lookup"><span data-stu-id="48056-137">Under .NET XAML Services, all type converters that are used for XAML purposes are classes that derive from the base class <xref:System.ComponentModel.TypeConverter>.</span></span> <span data-ttu-id="48056-138">La classe <xref:System.ComponentModel.TypeConverter> existait dans les versions du .NET Framework antérieures à l'introduction de XAML ; l'un des scénarios <xref:System.ComponentModel.TypeConverter> d'origine consistait à fournir une conversion de chaînes pour les éditeurs de propriétés dans les concepteurs visuels.</span><span class="sxs-lookup"><span data-stu-id="48056-138">The <xref:System.ComponentModel.TypeConverter> class existed in versions of the .NET Framework before XAML existed; one of the original <xref:System.ComponentModel.TypeConverter> scenarios was to provide string conversion for property editors in visual designers.</span></span>

<span data-ttu-id="48056-139">Pour XAML, le rôle de <xref:System.ComponentModel.TypeConverter> a été étendu.</span><span class="sxs-lookup"><span data-stu-id="48056-139">For XAML, the role of <xref:System.ComponentModel.TypeConverter> is expanded.</span></span> <span data-ttu-id="48056-140">Aux fins du langage XAML, <xref:System.ComponentModel.TypeConverter> est la classe de base permettant la prise en charge de certaines conversions en chaînes et à partir de chaînes.</span><span class="sxs-lookup"><span data-stu-id="48056-140">For XAML purposes, <xref:System.ComponentModel.TypeConverter> is the base class for providing support for certain to-string and from-string conversions.</span></span> <span data-ttu-id="48056-141">Les conversions à partir de chaînes permettent d'analyser une valeur d'attribut de chaîne à partir du code XAML.</span><span class="sxs-lookup"><span data-stu-id="48056-141">From-string enables parsing a string attribute value from XAML.</span></span> <span data-ttu-id="48056-142">Les conversions en chaînes permettent de reconvertir une valeur d'exécution d'une propriété d'objet particulière en attribut en XAML pour la sérialisation.</span><span class="sxs-lookup"><span data-stu-id="48056-142">To-string might enable processing a run-time value of a particular object property back into an attribute in XAML for serialization.</span></span>

<span data-ttu-id="48056-143"><xref:System.ComponentModel.TypeConverter> définit quatre membres qui sont utiles pour la conversion en chaînes et à partir de chaînes à des fins de traitement XAML :</span><span class="sxs-lookup"><span data-stu-id="48056-143"><xref:System.ComponentModel.TypeConverter> defines four members that are relevant for converting to-string and from-string for XAML processing purposes:</span></span>

- <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A>

- <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A>

- <xref:System.ComponentModel.TypeConverter.ConvertTo%2A>

- <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A>

<span data-ttu-id="48056-144">Parmi ces membres, la méthode la plus importante est <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A>, qui convertit la chaîne d'entrée en type d'objet requis.</span><span class="sxs-lookup"><span data-stu-id="48056-144">Of these members, the most important method is <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A>, which converts the input string to the required object type.</span></span> <span data-ttu-id="48056-145">La méthode <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> peut être implémentée pour convertir une plage plus large de types vers le type de destination prévu du convertisseur.</span><span class="sxs-lookup"><span data-stu-id="48056-145">The <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> method can be implemented to convert a wider range of types into the intended destination type of the converter.</span></span> <span data-ttu-id="48056-146">Par conséquent, elle peut remplir des fonctions qui dépassent le cadre du langage XAML, telles que la prise en charge des conversions au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="48056-146">Therefore, it can serve purposes that extend beyond XAML, such as supporting run-time conversions.</span></span> <span data-ttu-id="48056-147">Toutefois, pour l'utilisation de XAML, seul le chemin de code capable de traiter une entrée <xref:System.String> est important.</span><span class="sxs-lookup"><span data-stu-id="48056-147">However, for XAML use, only the code path that can process a <xref:System.String> input is important.</span></span>

<span data-ttu-id="48056-148">La deuxième méthode la plus importante est <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> .</span><span class="sxs-lookup"><span data-stu-id="48056-148">The second-most important method is <xref:System.ComponentModel.TypeConverter.ConvertTo%2A>.</span></span> <span data-ttu-id="48056-149">Si une application est convertie en représentation de balisage (par exemple, si elle est enregistrée en XAML sous forme de fichier), <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> est impliqué dans le scénario plus vaste d’un TEXTWRITER XAML pour produire une représentation de balisage.</span><span class="sxs-lookup"><span data-stu-id="48056-149">If an application is converted to a markup representation (for example, if it is saved to XAML as a file), <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> is involved in the larger scenario of a XAML text writer to produce a markup representation.</span></span> <span data-ttu-id="48056-150">Dans ce cas, le chemin de code important pour XAML est lorsque l'appelant passe un `destinationType` de <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="48056-150">In this case, the important code path for XAML is when the caller passes a `destinationType` of <xref:System.String>.</span></span>

<span data-ttu-id="48056-151"><xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> et <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A> sont des méthodes de support utilisées lorsqu'un service interroge les fonctions de l'implémentation <xref:System.ComponentModel.TypeConverter> .</span><span class="sxs-lookup"><span data-stu-id="48056-151"><xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> and <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A> are support methods that are used when a service queries the capabilities of the <xref:System.ComponentModel.TypeConverter> implementation.</span></span> <span data-ttu-id="48056-152">Vous devez implémenter ces méthodes pour retourner `true` dans des cas spécifiques au type pris en charge par les méthodes de conversion correspondantes de votre convertisseur.</span><span class="sxs-lookup"><span data-stu-id="48056-152">You must implement these methods to return `true` for type-specific cases that the equivalent conversion methods of your converter support.</span></span> <span data-ttu-id="48056-153">Pour le langage XAML, cela correspond généralement au type <xref:System.String> .</span><span class="sxs-lookup"><span data-stu-id="48056-153">For XAML purposes, this generally means the <xref:System.String> type.</span></span>

### <a name="culture-information-and-type-converters-for-xaml"></a><span data-ttu-id="48056-154">Informations de culture et convertisseurs de type pour XAML</span><span class="sxs-lookup"><span data-stu-id="48056-154">Culture Information and Type Converters for XAML</span></span>

<span data-ttu-id="48056-155">Chaque implémentation <xref:System.ComponentModel.TypeConverter> peut interpréter de façon unique ce qui constitue une chaîne valide dans le cadre d'une conversion ; elle peut également utiliser ou ignorer la description de type passée en tant que paramètres.</span><span class="sxs-lookup"><span data-stu-id="48056-155">Each <xref:System.ComponentModel.TypeConverter> implementation can uniquely interpret what is a valid string for a conversion, and it can also use or ignore the type description that is passed as parameters.</span></span> <span data-ttu-id="48056-156">Considération importante relative à la culture et à la conversion de type XAML : bien que l'utilisation de chaînes localisables en tant que valeurs d'attribut soit prise en charge par XAML, vous ne pouvez pas employer ces chaînes localisables comme entrée de convertisseur de type avec des spécifications de culture particulières.</span><span class="sxs-lookup"><span data-stu-id="48056-156">An important consideration for culture and XAML type conversion is the following: although using localizable strings as attribute values is supported by XAML, you cannot use these localizable strings as type converter input with specific culture requirements.</span></span> <span data-ttu-id="48056-157">Cette restriction est due au fait que les convertisseurs de types des valeurs d'attribut XAML impliquent un comportement de traitement XAML de langage fixe qui utilise la culture `en-US` .</span><span class="sxs-lookup"><span data-stu-id="48056-157">This limitation is because type converters for XAML attribute values involve a necessarily fixed-language XAML-processing behavior that uses `en-US` culture.</span></span> <span data-ttu-id="48056-158">Pour plus d’informations sur les raisons de conception de cette restriction, consultez la spécification de langage XAML ([ \[ MS-XAML \] ](/previous-versions/msp-n-p/ff650760(v=pandp.10))) ou [vue d’ensemble de la globalisation et de la localisation WPF](/dotnet/desktop/wpf/advanced/wpf-globalization-and-localization-overview).</span><span class="sxs-lookup"><span data-stu-id="48056-158">For more information about the design reasons for this restriction, see the XAML language specification ([\[MS-XAML\]](/previous-versions/msp-n-p/ff650760(v=pandp.10))) or [WPF Globalization and Localization Overview](/dotnet/desktop/wpf/advanced/wpf-globalization-and-localization-overview).</span></span>

<span data-ttu-id="48056-159">Par exemple, certaines cultures utilisent une virgule au lieu d'un point comme séparateur décimal pour les nombres sous forme de chaîne, ce qui peut poser un problème.</span><span class="sxs-lookup"><span data-stu-id="48056-159">As an example where culture can be an issue, some cultures use a comma instead of a period as the decimal point delimiter for numbers in string form.</span></span> <span data-ttu-id="48056-160">Cette utilisation crée un conflit avec le comportement de nombreux convertisseurs de type existants, qui consiste à utiliser une virgule comme délimiteur.</span><span class="sxs-lookup"><span data-stu-id="48056-160">This use collides with the behavior that many existing type converters have, which is to use a comma as a delimiter.</span></span> <span data-ttu-id="48056-161">Le passage d'une culture via `xml:lang` dans le code XAML environnant ne résout pas le problème.</span><span class="sxs-lookup"><span data-stu-id="48056-161">Passing a culture through `xml:lang` in the surrounding XAML does not solve the issue.</span></span>

### <a name="implementing-convertfrom"></a><span data-ttu-id="48056-162">Implémentation de ConvertFrom</span><span class="sxs-lookup"><span data-stu-id="48056-162">Implementing ConvertFrom</span></span>

<span data-ttu-id="48056-163">Pour être utilisable en tant qu'implémentation <xref:System.ComponentModel.TypeConverter> qui prend en charge le code XAML, la méthode <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> du convertisseur doit accepter une chaîne comme paramètre `value` .</span><span class="sxs-lookup"><span data-stu-id="48056-163">To be usable as a <xref:System.ComponentModel.TypeConverter> implementation that supports XAML, the <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> method for that converter must accept a string as the `value` parameter.</span></span> <span data-ttu-id="48056-164">Si la chaîne a un format valide et qu'elle peut être convertie par l'implémentation de <xref:System.ComponentModel.TypeConverter> , l'objet retourné doit prendre en charge un cast vers le type attendu par la propriété.</span><span class="sxs-lookup"><span data-stu-id="48056-164">If the string is in a valid format and can be converted by the <xref:System.ComponentModel.TypeConverter> implementation, the returned object must support a cast to the type that is expected by the property.</span></span> <span data-ttu-id="48056-165">Sinon, l'implémentation <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> doit retourner `null`.</span><span class="sxs-lookup"><span data-stu-id="48056-165">Otherwise, the <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> implementation must return `null`.</span></span>

<span data-ttu-id="48056-166">Chaque implémentation de <xref:System.ComponentModel.TypeConverter> peut interpréter de façon unique ce qui constitue une chaîne valide dans le cadre d'une conversion ; elle peut également utiliser ou ignorer la description de type ou les contextes de culture passés en tant que paramètres.</span><span class="sxs-lookup"><span data-stu-id="48056-166">Each <xref:System.ComponentModel.TypeConverter> implementation can uniquely interpret what constitutes a valid string for a conversion, and it can also use or ignore the type description or culture contexts that are passed as parameters.</span></span> <span data-ttu-id="48056-167">Cependant, le traitement XAML WPF ne passe pas nécessairement des valeurs au contexte de description de type dans tous les cas, ni de culture en fonction de `xml:lang`.</span><span class="sxs-lookup"><span data-stu-id="48056-167">However, the WPF XAML processing might not pass values to the type description context in all cases and also might not pass culture based on `xml:lang`.</span></span>

> [!NOTE]
> <span data-ttu-id="48056-168">N’utilisez pas les accolades ( {} ), en particulier l’accolade ouvrante ({), en tant qu’élément de votre format de chaîne.</span><span class="sxs-lookup"><span data-stu-id="48056-168">Do not use the braces ({}), specifically the opening brace ({), as an element of your string format.</span></span> <span data-ttu-id="48056-169">Ces caractères sont réservés comme entrée et sortie d’une séquence d’extension de balisage.</span><span class="sxs-lookup"><span data-stu-id="48056-169">These characters are reserved as the entry and exit for a markup extension sequence.</span></span>

<span data-ttu-id="48056-170">Il convient de lever une exception si votre convertisseur de type doit avoir accès à un service XAML à partir du writer d’objet des services XAML .NET, mais que l' <xref:System.IServiceProvider.GetService%2A> appel effectué par rapport au contexte ne retourne pas ce service.</span><span class="sxs-lookup"><span data-stu-id="48056-170">It is appropriate to throw an exception when your type converter must have access to a XAML service from .NET XAML Services object writer, but the <xref:System.IServiceProvider.GetService%2A> call that is made against the context does not return that service.</span></span>

### <a name="implementing-convertto"></a><span data-ttu-id="48056-171">Implémentation de ConvertTo</span><span class="sxs-lookup"><span data-stu-id="48056-171">Implementing ConvertTo</span></span>

<span data-ttu-id="48056-172">La méthode<xref:System.ComponentModel.TypeConverter.ConvertTo%2A> peut être utilisée pour assurer la prise en charge de la sérialisation.</span><span class="sxs-lookup"><span data-stu-id="48056-172"><xref:System.ComponentModel.TypeConverter.ConvertTo%2A> is potentially used for serialization support.</span></span> <span data-ttu-id="48056-173">La prise en charge de la sérialisation via <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> pour votre type personnalisé et son convertisseur de type n'est pas une spécification absolue.</span><span class="sxs-lookup"><span data-stu-id="48056-173">Serialization support through <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> for your custom type and its type converter is not an absolute requirement.</span></span> <span data-ttu-id="48056-174">Toutefois, si vous implémentez un contrôle ou que vous utilisez la sérialisation dans le cadre des fonctionnalités ou de la conception de la classe, vous devez implémenter <xref:System.ComponentModel.TypeConverter.ConvertTo%2A>.</span><span class="sxs-lookup"><span data-stu-id="48056-174">However, if you are implementing a control, or using serialization of as part of the features or design of your class, you should implement <xref:System.ComponentModel.TypeConverter.ConvertTo%2A>.</span></span>

<span data-ttu-id="48056-175">Pour être utilisable en tant qu'implémentation de <xref:System.ComponentModel.TypeConverter> qui prend en charge XAML, la méthode <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> de ce convertisseur doit accepter une instance du type (ou une valeur) prise en charge comme paramètre `value` .</span><span class="sxs-lookup"><span data-stu-id="48056-175">To be usable as a <xref:System.ComponentModel.TypeConverter> implementation that supports XAML, the <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> method for that converter must accept an instance of the type (or a value) that is supported as the `value` parameter.</span></span> <span data-ttu-id="48056-176">Lorsque le paramètre `destinationType` est de type <xref:System.String>, l'objet retourné doit pouvoir être casté en <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="48056-176">When the `destinationType` parameter is of type <xref:System.String>, the returned object must be able to be cast as <xref:System.String>.</span></span> <span data-ttu-id="48056-177">La chaîne retournée doit représenter une valeur sérialisée de `value`.</span><span class="sxs-lookup"><span data-stu-id="48056-177">The returned string must represent a serialized value of `value`.</span></span> <span data-ttu-id="48056-178">Idéalement, le format de sérialisation que vous choisissez doit pouvoir générer la même valeur que si cette chaîne était passée à l'implémentation de <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> du même convertisseur, sans perte significative d'informations.</span><span class="sxs-lookup"><span data-stu-id="48056-178">Ideally, the serialization format that you choose should be able to generate the same value as if that string were passed to the <xref:System.ComponentModel.TypeConverter.ConvertFrom%2A> implementation of the same converter, without significant loss of information.</span></span>

<span data-ttu-id="48056-179">Si la valeur ne peut pas être sérialisée ou que le convertisseur ne prend pas en charge la sérialisation, l'implémentation de <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> doit retourner la valeur `null` et peut lever une exception.</span><span class="sxs-lookup"><span data-stu-id="48056-179">If the value cannot be serialized or the converter does not support serialization, the <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> implementation must return `null` and can throw an exception.</span></span> <span data-ttu-id="48056-180">Toutefois, si vous levez des exceptions, vous devez signaler que cette conversion ne peut pas être utilisée dans le cadre de votre implémentation de <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> afin que la meilleure pratique qui consiste à effectuer d'abord une vérification avec <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> pour éviter les exceptions soit prise en charge.</span><span class="sxs-lookup"><span data-stu-id="48056-180">However, if you do throw exceptions, you should report the inability to use that conversion as part of your <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> implementation so that the best practice of checking with <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> first to avoid exceptions is supported.</span></span>

<span data-ttu-id="48056-181">Si le paramètre `destinationType` n'est pas de type <xref:System.String>, vous pouvez choisir votre propre gestion de convertisseur.</span><span class="sxs-lookup"><span data-stu-id="48056-181">If the `destinationType` parameter is not of type <xref:System.String>, you can choose your own converter handling.</span></span> <span data-ttu-id="48056-182">En général, vous rétablissez le traitement de l'implémentation de base, ce qui, dans la méthode <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> de base, lève une exception spécifique.</span><span class="sxs-lookup"><span data-stu-id="48056-182">Typically, you revert to base implementation handling, which in the base <xref:System.ComponentModel.TypeConverter.ConvertTo%2A> raises a specific exception.</span></span>

<span data-ttu-id="48056-183">Il convient de lever une exception si votre convertisseur de type doit avoir accès à un service XAML à partir du writer d’objet des services XAML .NET, mais que l' <xref:System.IServiceProvider.GetService%2A> appel effectué par rapport au contexte ne retourne pas ce service.</span><span class="sxs-lookup"><span data-stu-id="48056-183">It is appropriate to throw an exception when your type converter must have access to a XAML service from .NET XAML Services object writer, but the <xref:System.IServiceProvider.GetService%2A> call that is made against the context does not return that service.</span></span>

### <a name="implementing-canconvertfrom"></a><span data-ttu-id="48056-184">Implémentation de CanConvertFrom</span><span class="sxs-lookup"><span data-stu-id="48056-184">Implementing CanConvertFrom</span></span>

<span data-ttu-id="48056-185">Votre implémentation de <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A> doit retourner la valeur `true` pour `sourceType` de type <xref:System.String> , et sinon déférer à l'implémentation de base.</span><span class="sxs-lookup"><span data-stu-id="48056-185">Your <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A> implementation should return `true` for `sourceType` of type <xref:System.String> and otherwise, defer to the base implementation.</span></span> <span data-ttu-id="48056-186">Ne levez pas d'exceptions à partir de la méthode <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A>.</span><span class="sxs-lookup"><span data-stu-id="48056-186">Do not throw exceptions from <xref:System.ComponentModel.TypeConverter.CanConvertFrom%2A>.</span></span>

### <a name="implementing-canconvertto"></a><span data-ttu-id="48056-187">Implémentation de CanConvertTo</span><span class="sxs-lookup"><span data-stu-id="48056-187">Implementing CanConvertTo</span></span>

<span data-ttu-id="48056-188">Votre implémentation de <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> doit retourner la valeur `true` pour `destinationType` de type <xref:System.String>, et sinon déférer à l'implémentation de base.</span><span class="sxs-lookup"><span data-stu-id="48056-188">Your <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A> implementation should return `true` for `destinationType` of type <xref:System.String>, and otherwise defer to the base implementation.</span></span> <span data-ttu-id="48056-189">Ne levez pas d'exceptions à partir de la méthode <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A>.</span><span class="sxs-lookup"><span data-stu-id="48056-189">Do not throw exceptions from <xref:System.ComponentModel.TypeConverter.CanConvertTo%2A>.</span></span>

## <a name="applying-the-typeconverterattribute"></a><span data-ttu-id="48056-190">Application de TypeConverterAttribute</span><span class="sxs-lookup"><span data-stu-id="48056-190">Applying the TypeConverterAttribute</span></span>

<span data-ttu-id="48056-191">Pour que votre convertisseur de type personnalisé soit utilisé comme convertisseur de type agissant pour une classe personnalisée par les services XAML .NET, vous devez appliquer <xref:System.ComponentModel.TypeConverterAttribute> à votre définition de classe.</span><span class="sxs-lookup"><span data-stu-id="48056-191">For your custom type converter to be used as the acting type converter for a custom class by .NET XAML Services, you must apply the <xref:System.ComponentModel.TypeConverterAttribute> to your class definition.</span></span> <span data-ttu-id="48056-192">La propriété <xref:System.ComponentModel.TypeConverterAttribute.ConverterTypeName%2A> que vous spécifiez via l'attribut doit être le nom de type du convertisseur de type personnalisé.</span><span class="sxs-lookup"><span data-stu-id="48056-192">The <xref:System.ComponentModel.TypeConverterAttribute.ConverterTypeName%2A> that you specify through the attribute must be the type name of your custom type converter.</span></span> <span data-ttu-id="48056-193">Si vous appliquez cet attribut, lorsqu'un processeur XAML gère des valeurs où le type de propriété utilise votre type de classe personnalisée, il peut entrer des chaînes et retourner des instances d'objet.</span><span class="sxs-lookup"><span data-stu-id="48056-193">If you apply this attribute, when a XAML processor handles values where the property type uses your custom class type, it can input strings and return object instances.</span></span>

<span data-ttu-id="48056-194">Vous pouvez également fournir un convertisseur de type en fonction de la propriété.</span><span class="sxs-lookup"><span data-stu-id="48056-194">You can also provide a type converter on a per-property basis.</span></span> <span data-ttu-id="48056-195">Au lieu d’appliquer un <xref:System.ComponentModel.TypeConverterAttribute> à la définition de classe, appliquez-le à une définition de propriété (la définition principale, et non les `get` / `set` implémentations qu’il contient).</span><span class="sxs-lookup"><span data-stu-id="48056-195">Instead of applying a <xref:System.ComponentModel.TypeConverterAttribute> to the class definition, apply it to a property definition (the main definition, not the `get`/`set` implementations within it).</span></span> <span data-ttu-id="48056-196">Le type de la propriété doit correspondre au type traité par votre convertisseur de type personnalisé.</span><span class="sxs-lookup"><span data-stu-id="48056-196">The type of the property must match the type that is processed by your custom type converter.</span></span> <span data-ttu-id="48056-197">Avec cet attribut appliqué, lorsqu'un processeur XAML gère des valeurs de cette propriété, il peut traiter des chaînes d'entrée et retourner des instances d'objet.</span><span class="sxs-lookup"><span data-stu-id="48056-197">With this attribute applied, when a XAML processor handles values of that property, it can process input strings and return object instances.</span></span> <span data-ttu-id="48056-198">La technique de conversion de type par propriété est utile si vous choisissez d’utiliser un type de propriété à partir de Microsoft .NET Framework ou d’une autre bibliothèque où vous ne pouvez pas contrôler la définition de classe et ne pouvez pas l’appliquer <xref:System.ComponentModel.TypeConverterAttribute> .</span><span class="sxs-lookup"><span data-stu-id="48056-198">The per-property type converter technique is useful if you choose to use a property type from Microsoft .NET Framework or from some other library where you cannot control the class definition and cannot apply a <xref:System.ComponentModel.TypeConverterAttribute> there.</span></span>

<span data-ttu-id="48056-199">Pour fournir un comportement de conversion de type pour un membre attaché personnalisé, appliquez <xref:System.ComponentModel.TypeConverterAttribute> à la méthode `Get` d'accesseur du modèle d'implémentation du membre attaché.</span><span class="sxs-lookup"><span data-stu-id="48056-199">To supply a type conversion behavior for a custom attached member, apply <xref:System.ComponentModel.TypeConverterAttribute> to the `Get` accessor method of the implementation pattern for the attached member.</span></span>

## <a name="accessing-service-provider-context-from-a-markup-extension-implementation"></a><span data-ttu-id="48056-200">Accès au contexte de fournisseur de services à partir d'une implémentation de l'extension du balisage</span><span class="sxs-lookup"><span data-stu-id="48056-200">Accessing Service Provider Context from a Markup Extension Implementation</span></span>

<span data-ttu-id="48056-201">Les services disponibles sont les mêmes pour tous les convertisseurs de valeurs.</span><span class="sxs-lookup"><span data-stu-id="48056-201">The available services are the same for any value converter.</span></span> <span data-ttu-id="48056-202">La seule différence réside dans le mode de réception du contexte de service par chaque convertisseur de valeurs.</span><span class="sxs-lookup"><span data-stu-id="48056-202">The difference is in how each value converter receives the service context.</span></span> <span data-ttu-id="48056-203">L’accès aux services et les services disponibles sont documentés dans la rubrique [Type Converters and Markup Extensions for XAML](type-converters-and-markup-extensions.md).</span><span class="sxs-lookup"><span data-stu-id="48056-203">Accessing services and the services available are documented in the topic [Type Converters and Markup Extensions for XAML](type-converters-and-markup-extensions.md).</span></span>

## <a name="type-converters-in-the-xaml-node-stream"></a><span data-ttu-id="48056-204">Convertisseurs de type et flux de nœud XAML</span><span class="sxs-lookup"><span data-stu-id="48056-204">Type Converters in the XAML Node Stream</span></span>

<span data-ttu-id="48056-205">Si vous utilisez un flux de nœud XAML, l'action d'un convertisseur de type n'est pas encore exécutée ou n'a pas encore produit de résultat final.</span><span class="sxs-lookup"><span data-stu-id="48056-205">If you are working with a XAML node stream, the action or end result of a type converter is not yet executed.</span></span> <span data-ttu-id="48056-206">Dans un chemin de chargement, la chaîne d'attribut dont le type doit finalement être converti pour qu'elle puisse être chargée demeure sous la forme d'une valeur de texte dans un membre de début et un membre de fin.</span><span class="sxs-lookup"><span data-stu-id="48056-206">In a load path, the attribute string that eventually needs to be type-converted in order to load remains as a text value within a start member and end member.</span></span> <span data-ttu-id="48056-207">Le convertisseur de type qui est finalement requis pour cette opération peut être déterminé à l'aide de la propriété <xref:System.Xaml.XamlMember.TypeConverter%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="48056-207">The type converter that is eventually needed for this operation can be determined by using the <xref:System.Xaml.XamlMember.TypeConverter%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="48056-208">Toutefois, l'obtention d'une valeur valide à partir de <xref:System.Xaml.XamlMember.TypeConverter%2A?displayProperty=nameWithType> repose sur la disponibilité d'un contexte de schéma XAML permettant d'accéder à ces informations via le membre sous-jacent ou le type de la valeur d'objet que le membre utilise.</span><span class="sxs-lookup"><span data-stu-id="48056-208">However, obtaining a valid value from <xref:System.Xaml.XamlMember.TypeConverter%2A?displayProperty=nameWithType> relies on having a XAML schema context, which can access such information through the underlying member, or the type of the object value that the member uses.</span></span> <span data-ttu-id="48056-209">L'appel réel du comportement de conversion de type requiert également le contexte de schéma XAML car cette opération nécessite un mappage de type et la création d'une instance de convertisseur.</span><span class="sxs-lookup"><span data-stu-id="48056-209">Invoking the type conversion behavior also requires the XAML schema context because that requires type-mapping and creating a converter instance.</span></span>

## <a name="see-also"></a><span data-ttu-id="48056-210">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="48056-210">See also</span></span>

- <xref:System.ComponentModel.TypeConverterAttribute>
- [<span data-ttu-id="48056-211">Convertisseurs de types et extensions de balisage pour XAML</span><span class="sxs-lookup"><span data-stu-id="48056-211">Type Converters and Markup Extensions for XAML</span></span>](type-converters-and-markup-extensions.md)
- [<span data-ttu-id="48056-212">Vue d’ensemble du langage XAML (WPF)</span><span class="sxs-lookup"><span data-stu-id="48056-212">XAML Overview (WPF)</span></span>](../fundamentals/xaml.md)

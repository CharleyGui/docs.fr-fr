---
title: 'CA5383 : Assurez-vous d’utiliser des cookies sécurisés dans ASP.NET Core (analyse du code)'
description: Fournit des informations sur la règle d’analyse du code CA5383, notamment les causes, comment corriger les violations et quand la supprimer.
ms.date: 05/07/2020
ms.topic: reference
author: LLLXXXCCC
ms.author: linche
f1_keywords:
- CA5383
- UseSecureCookiesASPNetCore
ms.openlocfilehash: 067ab60dd5c156e559cbf4105c4b5732c61f9448
ms.sourcegitcommit: 2e4adc490c1d2a705a0592b295d606b10b9f51f1
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/25/2020
ms.locfileid: "96587223"
---
# <a name="ca5383-ensure-use-secure-cookies-in-aspnet-core"></a>CA5383 : Vérifier l’utilisation de cookies sécurisés dans ASP.Net Core

| | Valeur |
|-|-|
| **Identificateur de la règle** |CA5383|
| **Catégorie** |Microsoft.Security|
| **Correction en rupture ou sans rupture** |Sans rupture|

## <a name="cause"></a>Cause

La <xref:Microsoft.AspNetCore.Http.CookieOptions.Secure?displayProperty=fullName> propriété peut être définie comme `false` lors de l’appel de <xref:Microsoft.AspNetCore.Http.IResponseCookies.Append%2A?displayProperty=fullName> . Pour le moment, cette règle examine uniquement la classe Microsoft. AspNetCore. http. Internal. ResponseCookies, qui est l’une des implémentations de <xref:Microsoft.AspNetCore.Http.IResponseCookies> .

Cette règle est similaire à [CA5382](ca5382.md), mais l’analyse ne peut pas déterminer si la <xref:Microsoft.AspNetCore.Http.CookieOptions.Secure> propriété est absolument `false` ou non définie.

## <a name="rule-description"></a>Description de la règle

Les applications disponibles sur HTTPs doivent utiliser des cookies sécurisés, qui indiquent au navigateur que le cookie doit être transmis uniquement à l’aide du protocole TLS (Transport Layer Security).

## <a name="how-to-fix-violations"></a>Comment corriger les violations

Affectez à la propriété la valeur <xref:Microsoft.AspNetCore.Http.CookieOptions.Secure> `true` dans toutes les circonstances.

## <a name="when-to-suppress-warnings"></a>Quand supprimer les avertissements

- Si les cookies sont configurés pour être sécurisés par défaut, par exemple à l’aide <xref:Microsoft.AspNetCore.CookiePolicy.CookiePolicyMiddleware?displayProperty=fullName> de dans `Startup.Configure` :

```
public class Startup
{
    public void Configure(IApplicationBuilder app, IWebHostEnvironment env)
    {
        app.UseCookiePolicy(
            new CookiePolicyOptions
            {
                Secure = CookieSecurePolicy.Always
            });
    }
}
```

- Si vous êtes sûr qu’il n’y a pas de données sensibles dans les cookies.

## <a name="configurability"></a>Configurabilité

Vous pouvez configurer les parties de votre code base à exclure de l’analyse. Par exemple, pour spécifier que la règle ne doit pas être exécutée sur un code dans des types nommés `MyType` , ajoutez la paire clé-valeur suivante à un fichier *. editorconfig* dans votre projet :

```ini
dotnet_code_quality.CA5383.excluded_symbol_names = MyType
```

Formats de noms de symboles autorisés dans la valeur de l’option (séparés par `|` ) :

- Nom de symbole uniquement (comprend tous les symboles portant le nom, quel que soit le type ou l’espace de noms conteneur)
- Noms qualifiés complets dans le format d' [ID de documentation](https://github.com/dotnet/csharplang/blob/master/spec/documentation-comments.md#id-string-format)du symbole. Chaque nom de symbole requiert un préfixe de type de symbole, tel que le préfixe « M : » pour les méthodes, le préfixe pour les types, le préfixe `T:` « N : » pour les espaces de noms, etc.
- `.ctor` pour les constructeurs et `.cctor` les constructeurs statiques

Exemples :

| Valeur d’option | Résumé |
| --- | --- |
|`dotnet_code_quality.CA5383.excluded_symbol_names = MyType` | Correspond à tous les symboles nommés’MyType’dans la compilation
|`dotnet_code_quality.CA5383.excluded_symbol_names = MyType1|MyType2` | Correspond à tous les symboles nommés’MyType1 'ou’MyType2 'dans la compilation
|`dotnet_code_quality.CA5383.excluded_symbol_names = M:NS.MyType.MyMethod(ParamType)` | Correspond à la méthode spécifique’MyMethod’avec la signature complète donnée
|`dotnet_code_quality.CA5383.excluded_symbol_names = M:NS1.MyType1.MyMethod1(ParamType)|M:NS2.MyType2.MyMethod2(ParamType)` | Met en correspondance des méthodes spécifiques « MyMethod1 » et « MyMethod2 » avec la signature complète respective

Vous pouvez configurer toutes ces options uniquement pour cette règle, pour toutes les règles ou pour toutes les règles de cette catégorie (sécurité). Pour plus d’informations, consultez Options de configuration d’une [règle de qualité du code](../code-quality-rule-options.md).

## <a name="example"></a> Exemple

L’extrait de code suivant illustre le modèle détecté par cette règle.

Encontre

```csharp
using System;
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Http.Internal;

class ExampleClass
{
    public void ExampleMethod(string key, string value)
    {
        var cookieOptions = new CookieOptions();
        cookieOptions.Secure = false;
        Random r = new Random();

        if (r.Next(6) == 4)
        {
            cookieOptions.Secure = true;
        }

        var responseCookies = new ResponseCookies(null, null);
        responseCookies.Append(key, value, cookieOptions);
    }
}
```

Solution :

```csharp
using Microsoft.AspNetCore.Http;
using Microsoft.AspNetCore.Http.Internal;

class ExampleClass
{
    public void ExampleMethod(string key, string value)
    {
        var cookieOptions = new CookieOptions();
        cookieOptions.Secure = true;
        var responseCookies = new ResponseCookies(null, null);
        responseCookies.Append(key, value, cookieOptions);
    }
}
```

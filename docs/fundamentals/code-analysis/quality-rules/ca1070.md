---
title: 'Ca1070 : ne déclarez pas les champs d’événement comme étant virtuels (analyse du code)'
description: 'En savoir plus sur la règle d’analyse du code ca1070 : ne pas déclarer les champs d’événement comme virtuels'
ms.date: 04/30/2020
ms.topic: reference
f1_keywords:
- CA1070
helpviewer_keywords:
- CA1070
author: mavasani
ms.author: mavasani
ms.openlocfilehash: 0a13305cebe1ad7f82205e9fc144a96095037cdd
ms.sourcegitcommit: e301979e3049ce412d19b094c60ed95b316a8f8c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/16/2020
ms.locfileid: "98190947"
---
# <a name="ca1070-do-not-declare-event-fields-as-virtual"></a><span data-ttu-id="ed7f6-103">CA1070 : Ne pas déclarer de champs d’événement comme virtuels</span><span class="sxs-lookup"><span data-stu-id="ed7f6-103">CA1070: Do not declare event fields as virtual</span></span>

| | <span data-ttu-id="ed7f6-104">Valeur</span><span class="sxs-lookup"><span data-stu-id="ed7f6-104">Value</span></span> |
|-|-|
| <span data-ttu-id="ed7f6-105">**Identificateur de la règle**</span><span class="sxs-lookup"><span data-stu-id="ed7f6-105">**Rule ID**</span></span> |<span data-ttu-id="ed7f6-106">CA1070</span><span class="sxs-lookup"><span data-stu-id="ed7f6-106">CA1070</span></span>|
| <span data-ttu-id="ed7f6-107">**Catégorie**</span><span class="sxs-lookup"><span data-stu-id="ed7f6-107">**Category**</span></span> |<span data-ttu-id="ed7f6-108">Microsoft. Design</span><span class="sxs-lookup"><span data-stu-id="ed7f6-108">Microsoft.Design</span></span>|
| <span data-ttu-id="ed7f6-109">**Correction en rupture ou sans rupture**</span><span class="sxs-lookup"><span data-stu-id="ed7f6-109">**Fix is breaking or non-breaking**</span></span> |<span data-ttu-id="ed7f6-110">Rupture</span><span class="sxs-lookup"><span data-stu-id="ed7f6-110">Breaking</span></span>|

## <a name="cause"></a><span data-ttu-id="ed7f6-111">Cause</span><span class="sxs-lookup"><span data-stu-id="ed7f6-111">Cause</span></span>

<span data-ttu-id="ed7f6-112">Un [événement de type champ](../../../csharp/event-pattern.md#defining-and-raising-field-like-events) a été déclaré comme étant virtuel.</span><span class="sxs-lookup"><span data-stu-id="ed7f6-112">A [field-like event](../../../csharp/event-pattern.md#defining-and-raising-field-like-events) was declared as virtual.</span></span>

<span data-ttu-id="ed7f6-113">Par défaut, cette règle recherche uniquement les types visibles de l’extérieur, mais elle peut [être configurée](#configure-code-to-analyze).</span><span class="sxs-lookup"><span data-stu-id="ed7f6-113">By default, this rule only looks at externally visible types, but this is [configurable](#configure-code-to-analyze).</span></span>

## <a name="rule-description"></a><span data-ttu-id="ed7f6-114">Description de la règle</span><span class="sxs-lookup"><span data-stu-id="ed7f6-114">Rule description</span></span>

<span data-ttu-id="ed7f6-115">Suivez ces [instructions de conception .net](../../../csharp/programming-guide/events/how-to-raise-base-class-events-in-derived-classes.md) pour déclencher des événements de classe de base dans les classes dérivées.</span><span class="sxs-lookup"><span data-stu-id="ed7f6-115">Follow these [.NET design guidelines](../../../csharp/programming-guide/events/how-to-raise-base-class-events-in-derived-classes.md) to raise base class events in derived classes.</span></span> <span data-ttu-id="ed7f6-116">Ne déclarez pas d’événements virtuels dans une classe de base.</span><span class="sxs-lookup"><span data-stu-id="ed7f6-116">Do not declare virtual events in a base class.</span></span> <span data-ttu-id="ed7f6-117">Les événements substitués dans une classe dérivée ont un comportement indéfini.</span><span class="sxs-lookup"><span data-stu-id="ed7f6-117">Overridden events in a derived class have undefined behavior.</span></span> <span data-ttu-id="ed7f6-118">Le compilateur C# ne gère pas cette opération correctement et il est imprévisible si un abonné à l’événement dérivé s’abonne réellement à l’événement de classe de base.</span><span class="sxs-lookup"><span data-stu-id="ed7f6-118">The C# compiler does not handle this correctly and it is unpredictable whether a subscriber to the derived event will actually be subscribing to the base class event.</span></span>

```csharp
using System;
public class C
{
    // CA1070: Event 'ThresholdReached' should not be declared virtual.
    public virtual event EventHandler ThresholdReached;
}
```

## <a name="how-to-fix-violations"></a><span data-ttu-id="ed7f6-119">Comment corriger les violations</span><span class="sxs-lookup"><span data-stu-id="ed7f6-119">How to fix violations</span></span>

<span data-ttu-id="ed7f6-120">Suivez ces [instructions de conception .net](../../../csharp/programming-guide/events/how-to-raise-base-class-events-in-derived-classes.md) et évitez les événements de type champ virtuel.</span><span class="sxs-lookup"><span data-stu-id="ed7f6-120">Follow these [.NET design guidelines](../../../csharp/programming-guide/events/how-to-raise-base-class-events-in-derived-classes.md) and avoid virtual field-like events.</span></span>

## <a name="when-to-suppress-warnings"></a><span data-ttu-id="ed7f6-121">Quand supprimer les avertissements</span><span class="sxs-lookup"><span data-stu-id="ed7f6-121">When to suppress warnings</span></span>

<span data-ttu-id="ed7f6-122">Si l’événement est une API publique visible de l’extérieur qui fait déjà partie d’une bibliothèque livrée, il est possible de supprimer sans risque un avertissement de cette règle afin d’éviter une modification avec rupture pour les consommateurs de la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="ed7f6-122">If the event is an externally visible public API that is already part of a shipped library, then it is safe to suppress a warning from this rule to avoid a breaking change for the library consumers.</span></span>

## <a name="configure-code-to-analyze"></a><span data-ttu-id="ed7f6-123">Configurer le code pour analyser</span><span class="sxs-lookup"><span data-stu-id="ed7f6-123">Configure code to analyze</span></span>

<span data-ttu-id="ed7f6-124">Utilisez l’option suivante pour configurer les parties de votre code base pour l’exécution de cette règle.</span><span class="sxs-lookup"><span data-stu-id="ed7f6-124">Use the following option to configure which parts of your codebase to run this rule on.</span></span>

- [<span data-ttu-id="ed7f6-125">Inclure des surfaces d’API spécifiques</span><span class="sxs-lookup"><span data-stu-id="ed7f6-125">Include specific API surfaces</span></span>](#include-specific-api-surfaces)

<span data-ttu-id="ed7f6-126">Vous pouvez configurer cette option uniquement pour cette règle, pour toutes les règles ou pour toutes les règles de cette catégorie (conception).</span><span class="sxs-lookup"><span data-stu-id="ed7f6-126">You can configure this option for just this rule, for all rules, or for all rules in this category (Design).</span></span> <span data-ttu-id="ed7f6-127">Pour plus d’informations, consultez Options de configuration d’une [règle de qualité du code](../code-quality-rule-options.md).</span><span class="sxs-lookup"><span data-stu-id="ed7f6-127">For more information, see [Code quality rule configuration options](../code-quality-rule-options.md).</span></span>

[!INCLUDE[api-surface](~/includes/code-analysis/api-surface.md)]

## <a name="see-also"></a><span data-ttu-id="ed7f6-128">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ed7f6-128">See also</span></span>

- [<span data-ttu-id="ed7f6-129">Règles de conception</span><span class="sxs-lookup"><span data-stu-id="ed7f6-129">Design rules</span></span>](design-warnings.md)

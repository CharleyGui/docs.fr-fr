---
title: Combinaison de conteneurs et d’approches serverless
description: Combinaison de conteneurs et de Kubernetes avec des approches sans serveur
ms.date: 06/30/2019
ms.openlocfilehash: 58aff43adbdd2e629370cc685f32c7b61c25f85e
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/23/2019
ms.locfileid: "71183433"
---
# <a name="combining-containers-and-serverless-approaches"></a><span data-ttu-id="c620b-103">Combinaison de conteneurs et d’approches serverless</span><span class="sxs-lookup"><span data-stu-id="c620b-103">Combining containers and serverless approaches</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="c620b-104">Souvent, les applications basées sur des microservices s’appuient fortement sur les conteneurs, l’orchestration et le transfert de messages pour la communication entre les nœuds.</span><span class="sxs-lookup"><span data-stu-id="c620b-104">Frequently, microservices-based applications rely heavily on containers, orchestration, and message-passing for communication between nodes.</span></span> <span data-ttu-id="c620b-105">Cette messagerie est une tâche idéale pour Azure Functions, mais avec le reste de l’application configurée et déployée à l’aide de Kubernetes et des outils associés, il serait agréable de pouvoir tirer parti des Azure Functions au sein de ce même ensemble d’outils.</span><span class="sxs-lookup"><span data-stu-id="c620b-105">This messaging is an ideal task for Azure Functions, but with the rest of the application configured and deployed using Kubernetes and related tools, it would be nice to be able to leverage Azure Functions within this same toolset.</span></span> <span data-ttu-id="c620b-106">Heureusement, vous pouvez encapsuler Azure Functions dans des conteneurs d’ancrage et les déployer en utilisant les mêmes processus et outils que le reste de votre application basée sur Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="c620b-106">Fortunately, you can wrap Azure Functions in Docker containers and deploy them using the same processes and tools as the rest of your Kubernetes-based app.</span></span>

## <a name="when-does-it-make-sense-to-use-containers-with-serverless"></a><span data-ttu-id="c620b-107">Quand est-il judicieux d’utiliser des conteneurs sans serveur ?</span><span class="sxs-lookup"><span data-stu-id="c620b-107">When does it make sense to use containers with serverless?</span></span>

<span data-ttu-id="c620b-108">Par défaut, vos fonctions sans serveur n’ont aucune connaissance de la plateforme sur laquelle elles s’exécuteront.</span><span class="sxs-lookup"><span data-stu-id="c620b-108">By default, your serverless functions have no knowledge of the platform on which they'll run.</span></span> <span data-ttu-id="c620b-109">Toutefois, dans certains cas, vous pouvez avoir des exigences spécifiques qui vous permettent de personnaliser l’image conteneur dans laquelle votre code s’exécutera.</span><span class="sxs-lookup"><span data-stu-id="c620b-109">However, in some cases you may have specific requirements that make it important for you to customize the container image in which your code will run.</span></span> <span data-ttu-id="c620b-110">Vous pouvez utiliser une image personnalisée, car votre fonction s’appuie sur une version de langage spécifique ou présente des dépendances ou des exigences de configuration qui ne sont pas prises en charge par l’image par défaut.</span><span class="sxs-lookup"><span data-stu-id="c620b-110">You may want to use a custom image because your function relies on a specific language version or has dependencies or configuration requirements that aren't supported by the default image.</span></span> <span data-ttu-id="c620b-111">Dans ces cas, il peut être judicieux de personnaliser votre propre conteneur et de déployer votre fonction dans un conteneur d’ancrage personnalisé.</span><span class="sxs-lookup"><span data-stu-id="c620b-111">In these cases, it may make sense to customize your own container and deploy your function in a custom Docker container.</span></span>

## <a name="when-should-you-avoid-using-containers-with-azure-functions"></a><span data-ttu-id="c620b-112">Quand devez-vous éviter d’utiliser des conteneurs avec Azure Functions ?</span><span class="sxs-lookup"><span data-stu-id="c620b-112">When should you avoid using containers with Azure Functions?</span></span>

<span data-ttu-id="c620b-113">Si vous vous attendez à bénéficier de la facturation du plan de consommation pour votre fonction, vous ne pourrez pas le faire si vous utilisez votre propre conteneur.</span><span class="sxs-lookup"><span data-stu-id="c620b-113">If you're expecting to benefit from the consumption plan billing for your function, you won't be able to do so if you're using your own container.</span></span> <span data-ttu-id="c620b-114">En outre, si vous allez au-delà de l’utilisation d’un conteneur d’ancrage et que vous déployez vos fonctions sur votre propre cluster Kubernetes, vous ne bénéficierez plus de la mise à l’échelle intégrée fournie par Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="c620b-114">What's more, if you go beyond just using a Docker container and deploy your functions to your own Kubernetes cluster, you'll no longer benefit from the built-in scaling provided by Azure Functions.</span></span> <span data-ttu-id="c620b-115">Vous devez utiliser les fonctionnalités de mise à l’échelle de Kubernetes, décrites ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="c620b-115">You'll need to use Kubernetes' scaling features, described below.</span></span>

## <a name="how-to-combine-serverless-and-docker-containers"></a><span data-ttu-id="c620b-116">Comment combiner des conteneurs sans serveur et des conteneurs d’ancrage</span><span class="sxs-lookup"><span data-stu-id="c620b-116">How to combine serverless and Docker containers</span></span>

<span data-ttu-id="c620b-117">Pour inclure dans un wrapper une fonction Azure dans un conteneur d’ancrage, installez le Azure Functions Core Tools puis exécutez la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="c620b-117">To wrap an Azure Function in a Docker container, install the Azure Functions Core Tools and then run the following command:</span></span>

```console
func init ProjectName --docker
```

<span data-ttu-id="c620b-118">Choisissez le runtime de travail de votre choix parmi les options suivantes :</span><span class="sxs-lookup"><span data-stu-id="c620b-118">Choose which worker runtime you want from the following options:</span></span>

- <span data-ttu-id="c620b-119">`dotnet` (C#)</span><span class="sxs-lookup"><span data-stu-id="c620b-119">`dotnet` (C#)</span></span>
- <span data-ttu-id="c620b-120">`node` (JavaScript)</span><span class="sxs-lookup"><span data-stu-id="c620b-120">`node` (JavaScript)</span></span>
- `python`

<span data-ttu-id="c620b-121">Lorsque le projet est créé, il inclut un fichier dockerfile.</span><span class="sxs-lookup"><span data-stu-id="c620b-121">When the project is created, it will include a Dockerfile.</span></span> <span data-ttu-id="c620b-122">À présent, vous pouvez créer et tester votre fonction localement.</span><span class="sxs-lookup"><span data-stu-id="c620b-122">Now, you can create and test your function locally.</span></span> <span data-ttu-id="c620b-123">Générez et exécutez-le à l’aide des commandes `docker build` et `docker run`.</span><span class="sxs-lookup"><span data-stu-id="c620b-123">Build and run it using the  `docker build` and `docker run` commands.</span></span> <span data-ttu-id="c620b-124">Pour obtenir des instructions détaillées pour commencer à créer des Azure Functions avec la prise en charge de l’ancrage, consultez le didacticiel [créer une fonction sur Linux à l’aide d’une image personnalisée](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image) .</span><span class="sxs-lookup"><span data-stu-id="c620b-124">For detailed steps to get started building Azure Functions with Docker support, see the [Create a function on Linux using a custom image](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image) tutorial.</span></span>

## <a name="how-to-combine-serverless-and-kubernetes-with-keda"></a><span data-ttu-id="c620b-125">Comment combiner sans serveur et Kubernetes avec KEDA</span><span class="sxs-lookup"><span data-stu-id="c620b-125">How to combine serverless and Kubernetes with KEDA</span></span>

<span data-ttu-id="c620b-126">Azure Functions est mis à l’échelle automatiquement pour répondre à la demande en fonction du taux d’événements ciblant une fonction donnée.</span><span class="sxs-lookup"><span data-stu-id="c620b-126">Azure functions scale automatically to meet demand based on the rate of events that are targeting a given function.</span></span> <span data-ttu-id="c620b-127">En outre, vous pouvez tirer parti de Kubernetes pour héberger vos fonctions et utiliser la mise à l’échelle automatique pilotée par les événements basée sur Kubernetes, ou KEDA.</span><span class="sxs-lookup"><span data-stu-id="c620b-127">Additionally, you can leverage Kubernetes to host your functions and use Kubernetes-based Event Driven Autoscaling, or KEDA.</span></span> <span data-ttu-id="c620b-128">Quand aucun événement ne se produit, KEDA peut passer à 0 instance, puis, en réponse aux événements, il peut augmenter le nombre de conteneurs pour répondre à la demande à l’aide de son adapteur automatique Pod horizontal.</span><span class="sxs-lookup"><span data-stu-id="c620b-128">When no events are occurring, KEDA can scale down to 0 instances, and then in response to events it can scale up the number of containers to meet the demand using its horizontal pod autoscaler.</span></span> <span data-ttu-id="c620b-129">[En savoir plus sur la mise à l’échelle d’Azure Functions avec Keda](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda).</span><span class="sxs-lookup"><span data-stu-id="c620b-129">[Learn more about scaling Azure functions with KEDA](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda).</span></span>

## <a name="references"></a><span data-ttu-id="c620b-130">Références</span><span class="sxs-lookup"><span data-stu-id="c620b-130">References</span></span>

- [<span data-ttu-id="c620b-131">Exécuter Azure Functions dans un conteneur d’ancrage</span><span class="sxs-lookup"><span data-stu-id="c620b-131">Run Azure Functions in a Docker Container</span></span>](https://markheath.net/post/azure-functions-docker)
- [<span data-ttu-id="c620b-132">Créer une fonction sur Linux à l’aide d’une image personnalisée</span><span class="sxs-lookup"><span data-stu-id="c620b-132">Create a function on Linux using a custom image</span></span>](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image)
- [<span data-ttu-id="c620b-133">Azure Functions avec la mise à l’échelle automatique pilotée par les événements Kubernetes</span><span class="sxs-lookup"><span data-stu-id="c620b-133">Azure Functions with Kubernetes Event Driven Autoscaling</span></span>](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda)

>[!div class="step-by-step"]
><span data-ttu-id="c620b-134">[Précédent](leverage-serverless-functions.md)
>[Suivant](deploy-containers-azure.md)</span><span class="sxs-lookup"><span data-stu-id="c620b-134">[Previous](leverage-serverless-functions.md)
[Next](deploy-containers-azure.md)</span></span>

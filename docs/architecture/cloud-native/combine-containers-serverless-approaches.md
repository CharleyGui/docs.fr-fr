---
title: Combinaison de conteneurs et d’approches sans serveur pour les services Cloud natifs
description: Combinaison de conteneurs et de Kubernetes avec des approches sans serveur
ms.date: 04/23/2020
ms.openlocfilehash: a6ae17543c9075ca84126a4c19f9f51887f7fe9a
ms.sourcegitcommit: 957c49696eaf048c284ef8f9f8ffeb562357ad95
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/07/2020
ms.locfileid: "82895635"
---
# <a name="combining-containers-and-serverless-approaches"></a><span data-ttu-id="708ab-103">Combinaison de conteneurs et d’approches serverless</span><span class="sxs-lookup"><span data-stu-id="708ab-103">Combining containers and serverless approaches</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="708ab-104">Les applications Cloud natives implémentent généralement des services tirant parti des conteneurs et de l’orchestration.</span><span class="sxs-lookup"><span data-stu-id="708ab-104">Cloud-native applications typically implement services leveraging containers and orchestration.</span></span> <span data-ttu-id="708ab-105">Il existe souvent des occasions d’exposer certains services de l’application en tant que Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="708ab-105">There are often opportunities to expose some of the application's services as Azure Functions.</span></span> <span data-ttu-id="708ab-106">Toutefois, avec une application Cloud-Native déployée sur Kubernetes, il serait intéressant de tirer parti de Azure Functions au sein de ce même ensemble d’outils.</span><span class="sxs-lookup"><span data-stu-id="708ab-106">However, with a cloud-native app deployed to Kubernetes, it would be nice to leverage Azure Functions within this same toolset.</span></span> <span data-ttu-id="708ab-107">Heureusement, vous pouvez encapsuler Azure Functions à l’intérieur de conteneurs d’ancrage et les déployer à l’aide des mêmes processus et outils que le reste de votre application basée sur Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="708ab-107">Fortunately, you can wrap Azure Functions inside Docker containers and deploy them using the same processes and tools as the rest of your Kubernetes-based app.</span></span>

## <a name="when-does-it-make-sense-to-use-containers-with-serverless"></a><span data-ttu-id="708ab-108">Quand est-il judicieux d’utiliser des conteneurs sans serveur ?</span><span class="sxs-lookup"><span data-stu-id="708ab-108">When does it make sense to use containers with serverless?</span></span>

<span data-ttu-id="708ab-109">Votre fonction Azure n’a aucune connaissance de la plateforme sur laquelle elle est déployée.</span><span class="sxs-lookup"><span data-stu-id="708ab-109">Your Azure Function has no knowledge of the platform on which it's deployed.</span></span> <span data-ttu-id="708ab-110">Pour certains scénarios, vous pouvez avoir des exigences spécifiques et devez personnaliser l’environnement d’exécution de votre code de fonction.</span><span class="sxs-lookup"><span data-stu-id="708ab-110">For some scenarios, you may have specific requirements and need to customize the environment on which your function code will run.</span></span> <span data-ttu-id="708ab-111">Vous aurez besoin d’une image personnalisée qui prend en charge les dépendances ou d’une configuration non prise en charge par l’image par défaut.</span><span class="sxs-lookup"><span data-stu-id="708ab-111">You'll need a custom image that supports dependencies or a configuration not supported by the default image.</span></span> <span data-ttu-id="708ab-112">Dans ces cas, il est logique de déployer votre fonction dans un conteneur d’ancrage personnalisé.</span><span class="sxs-lookup"><span data-stu-id="708ab-112">In these cases, it makes sense to deploy your function in a custom Docker container.</span></span>

## <a name="when-should-you-avoid-using-containers-with-azure-functions"></a><span data-ttu-id="708ab-113">Quand devez-vous éviter d’utiliser des conteneurs avec Azure Functions ?</span><span class="sxs-lookup"><span data-stu-id="708ab-113">When should you avoid using containers with Azure Functions?</span></span>

<span data-ttu-id="708ab-114">Si vous souhaitez utiliser la facturation de la consommation, vous ne pourrez pas exécuter votre fonction dans un conteneur.</span><span class="sxs-lookup"><span data-stu-id="708ab-114">If you want to use consumption billing, you won't be able to run your function in a container.</span></span> <span data-ttu-id="708ab-115">De plus, si vous déployez votre fonction sur un cluster Kubernetes, vous ne bénéficierez plus de la mise à l’échelle intégrée fournie par Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="708ab-115">What's more, if you deploy your function to a Kubernetes cluster, you'll no longer benefit from the built-in scaling provided by Azure Functions.</span></span> <span data-ttu-id="708ab-116">Vous devez utiliser les fonctionnalités de mise à l’échelle de Kubernetes, décrites précédemment dans ce chapitre.</span><span class="sxs-lookup"><span data-stu-id="708ab-116">You'll need to use Kubernetes' scaling features, described earlier in this chapter.</span></span>

## <a name="how-to-combine-serverless-and-docker-containers"></a><span data-ttu-id="708ab-117">Comment combiner des conteneurs sans serveur et des conteneurs d’ancrage</span><span class="sxs-lookup"><span data-stu-id="708ab-117">How to combine serverless and Docker containers</span></span>

<span data-ttu-id="708ab-118">Pour inclure dans un wrapper une fonction Azure dans un conteneur d’ancrage, installez le [Azure Functions Core Tools](https://github.com/Azure/azure-functions-core-tools) puis exécutez la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="708ab-118">To wrap an Azure Function in a Docker container, install the [Azure Functions Core Tools](https://github.com/Azure/azure-functions-core-tools) and then run the following command:</span></span>

```console
func init ProjectName --worker-runtime dotnet --docker
```

<span data-ttu-id="708ab-119">Lorsque le projet est créé, il inclut un fichier dockerfile et le runtime du Worker configurés sur `dotnet`.</span><span class="sxs-lookup"><span data-stu-id="708ab-119">When the project is created, it will include a Dockerfile and the worker runtime configured to `dotnet`.</span></span> <span data-ttu-id="708ab-120">À présent, vous pouvez créer et tester votre fonction localement.</span><span class="sxs-lookup"><span data-stu-id="708ab-120">Now, you can create and test your function locally.</span></span> <span data-ttu-id="708ab-121">Générez et exécutez-le `docker build` à `docker run` l’aide des commandes et.</span><span class="sxs-lookup"><span data-stu-id="708ab-121">Build and run it using the  `docker build` and `docker run` commands.</span></span> <span data-ttu-id="708ab-122">Pour obtenir des instructions détaillées pour commencer à créer des Azure Functions avec la prise en charge de l’ancrage, consultez le didacticiel [créer une fonction sur Linux à l’aide d’une image personnalisée](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image) .</span><span class="sxs-lookup"><span data-stu-id="708ab-122">For detailed steps to get started building Azure Functions with Docker support, see the [Create a function on Linux using a custom image](https://docs.microsoft.com/azure/azure-functions/functions-create-function-linux-custom-image) tutorial.</span></span>

## <a name="how-to-combine-serverless-and-kubernetes-with-keda"></a><span data-ttu-id="708ab-123">Comment combiner sans serveur et Kubernetes avec KEDA</span><span class="sxs-lookup"><span data-stu-id="708ab-123">How to combine serverless and Kubernetes with KEDA</span></span>

<span data-ttu-id="708ab-124">Dans ce chapitre, vous avez vu que la plateforme Azure Functions est automatiquement mise à l’échelle pour répondre à la demande.</span><span class="sxs-lookup"><span data-stu-id="708ab-124">In this chapter, you've seen that the Azure Functions' platform automatically scales out to meet demand.</span></span> <span data-ttu-id="708ab-125">Toutefois, lorsque vous déployez des fonctions en conteneur vers AKS, vous perdez la fonctionnalité de mise à l’échelle intégrée.</span><span class="sxs-lookup"><span data-stu-id="708ab-125">When deploying containerized functions to AKS, however, you lose the built-in scaling functionality.</span></span> <span data-ttu-id="708ab-126">L’Kubernetes de la récupération est [basée sur des événements (Keda)](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda).</span><span class="sxs-lookup"><span data-stu-id="708ab-126">To the rescue comes [Kubernetes-based Event Driven (KEDA)](https://docs.microsoft.com/azure/azure-functions/functions-kubernetes-keda).</span></span> <span data-ttu-id="708ab-127">Il permet une mise à l’échelle automatique fine pour `event-driven Kubernetes workloads,` inclure des fonctions en conteneur.</span><span class="sxs-lookup"><span data-stu-id="708ab-127">It enables fine-grained autoscaling for `event-driven Kubernetes workloads,` including containerized functions.</span></span>

<span data-ttu-id="708ab-128">KEDA fournit une fonctionnalité de mise à l’échelle pilotée par les événements au runtime des fonctions dans un conteneur d’ancrage.</span><span class="sxs-lookup"><span data-stu-id="708ab-128">KEDA provides event-driven scaling functionality to the Functions' runtime in a Docker container.</span></span> <span data-ttu-id="708ab-129">KEDA peut être mis à l’échelle à partir de zéro instance (quand aucun `n instances`événement ne se produit) vers, en fonction de la charge.</span><span class="sxs-lookup"><span data-stu-id="708ab-129">KEDA can scale from zero instances (when no events are occurring) out to `n instances`, based on load.</span></span> <span data-ttu-id="708ab-130">Il permet la mise à l’échelle automatique en exposant des métriques personnalisées à l’échelle automatique Kubernetes (la barre verticale du Pod).</span><span class="sxs-lookup"><span data-stu-id="708ab-130">It enables autoscaling by exposing custom metrics to the Kubernetes autoscaler (Horizontal Pod Autoscaler).</span></span> <span data-ttu-id="708ab-131">L’utilisation de conteneurs Functions avec KEDA permet de répliquer des fonctionnalités de fonction serverless dans n’importe quel cluster Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="708ab-131">Using Functions containers with KEDA makes it possible to replicate serverless function capabilities in any Kubernetes cluster.</span></span>

<span data-ttu-id="708ab-132">Il est à noter que le projet KEDA est désormais géré par le Cloud Native Computing Foundation (CNCF).</span><span class="sxs-lookup"><span data-stu-id="708ab-132">It is worth noting that the KEDA project is now managed by the Cloud Native Computing Foundation (CNCF).</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="708ab-133">[Précédent](leverage-serverless-functions.md)
>[suivant](deploy-containers-azure.md)</span><span class="sxs-lookup"><span data-stu-id="708ab-133">[Previous](leverage-serverless-functions.md)
[Next](deploy-containers-azure.md)</span></span>

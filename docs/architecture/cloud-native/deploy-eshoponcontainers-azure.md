---
title: Déploiement d’eShopOnContainers sur Azure
description: Déploiement de l’application eShopOnContainers à l’aide du service Azure Kubernetes, Helm et DevSpaces.
ms.date: 06/30/2019
ms.openlocfilehash: 21033cc904dc595193c69f3452ce2522740f8ff6
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/23/2019
ms.locfileid: "71183272"
---
# <a name="deploying-eshoponcontainers-to-azure"></a><span data-ttu-id="28bc4-103">Déploiement d’eShopOnContainers sur Azure</span><span class="sxs-lookup"><span data-stu-id="28bc4-103">Deploying eShopOnContainers to Azure</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="28bc4-104">La logique de prise en charge de l’application eShopOnContainers peut être prise en charge par Azure à l’aide d’un large éventail de services.</span><span class="sxs-lookup"><span data-stu-id="28bc4-104">The logic supporting the eShopOnContainers application can be supported by Azure using a variety of services.</span></span> <span data-ttu-id="28bc4-105">L’approche recommandée consiste à exploiter Kubernetes à l’aide d’Azure Kubernetes service (AKS).</span><span class="sxs-lookup"><span data-stu-id="28bc4-105">The recommended approach is to leverage Kubernetes using Azure Kubernetes Service (AKS).</span></span> <span data-ttu-id="28bc4-106">Cela peut être combiné avec le déploiement Helm pour garantir une configuration d’infrastructure facilement répétée.</span><span class="sxs-lookup"><span data-stu-id="28bc4-106">This can be combined with Helm deployment to ensure easily repeated infrastructure configuration.</span></span> <span data-ttu-id="28bc4-107">Les développeurs peuvent éventuellement tirer parti de Azure Dev Spaces pour Kubernetes dans le cadre de leur processus de développement.</span><span class="sxs-lookup"><span data-stu-id="28bc4-107">Optionally, developers can leverage Azure Dev Spaces for Kubernetes as part of their development process.</span></span> <span data-ttu-id="28bc4-108">Une autre option consiste à héberger les fonctionnalités de l’application à l’aide de fonctionnalités sans serveur Azure comme Azure Functions et Azure Logic Apps.</span><span class="sxs-lookup"><span data-stu-id="28bc4-108">Another option is to host the functionality of the app using Azure Serverless features like Azure Functions and Azure Logic Apps.</span></span>

## <a name="azure-kubernetes-service"></a><span data-ttu-id="28bc4-109">Azure Kubernetes Service</span><span class="sxs-lookup"><span data-stu-id="28bc4-109">Azure Kubernetes Service</span></span>

<span data-ttu-id="28bc4-110">Si vous souhaitez héberger l’application eShopOnContainers dans votre propre cluster AKS, la première étape consiste à créer votre cluster.</span><span class="sxs-lookup"><span data-stu-id="28bc4-110">If you'd like to host the eShopOnContainers application in your own AKS cluster, the first step is to create your cluster.</span></span> <span data-ttu-id="28bc4-111">Vous pouvez le faire à l’aide de la Portail Azure, qui vous guidera tout au long des étapes nécessaires, ou vous pouvez utiliser le Azure CLI, en veillant à activer l’Access Control basé sur les rôles (RBAC) et le routage des applications.</span><span class="sxs-lookup"><span data-stu-id="28bc4-111">You can do this using the Azure portal, which will walk you through the required steps, or you can use the Azure CLI, taking care to ensure you enable Role-Based Access Control (RBAC) and application routing when you do so.</span></span> <span data-ttu-id="28bc4-112">La documentation de eShopOnContainers décrit les étapes nécessaires à la création de votre propre cluster AKS.</span><span class="sxs-lookup"><span data-stu-id="28bc4-112">The eShopOnContainers' documentation describes the steps involved in creating your own AKS cluster.</span></span> <span data-ttu-id="28bc4-113">Une fois le cluster créé, vous devez activer l’accès au tableau de bord Kubernetes, à partir duquel vous devez être en mesure d’accéder au tableau de bord Kubernetes pour gérer le cluster.</span><span class="sxs-lookup"><span data-stu-id="28bc4-113">Once the cluster is created, you must enable access to the Kubernetes dashboard, at which point you should be able to browse to the Kubernetes dashboard to manage the cluster.</span></span>

<span data-ttu-id="28bc4-114">Une fois que le cluster a été créé et configuré, vous pouvez y déployer l’application à l’aide de Helm et de l’écran de veille.</span><span class="sxs-lookup"><span data-stu-id="28bc4-114">Once the cluster has been created and configured, you can deploy the application to it using Helm and Tiller.</span></span>

## <a name="deploying-to-azure-kubernetes-service-using-helm"></a><span data-ttu-id="28bc4-115">Déploiement sur le service Azure Kubernetes à l’aide de Helm</span><span class="sxs-lookup"><span data-stu-id="28bc4-115">Deploying to Azure Kubernetes Service using Helm</span></span>

<span data-ttu-id="28bc4-116">Les déploiements de base sur AKS peuvent utiliser des scripts CLI personnalisés ou des fichiers de déploiement simples, mais des applications plus complexes doivent utiliser un outil de gestion des dépendances comme Helm.</span><span class="sxs-lookup"><span data-stu-id="28bc4-116">Basic deployments to AKS may use custom CLI scripts or simple deployment files, but more complex applications should use a dependency management tool like Helm.</span></span> <span data-ttu-id="28bc4-117">Helm est géré par la Fondation informatique Native Cloud et vous aide à définir, installer et mettre à niveau des applications Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="28bc4-117">Helm is maintained by the Cloud-native Computing Foundation and helps you define, install, and upgrade Kubernetes applications.</span></span> <span data-ttu-id="28bc4-118">Helm se compose d’un client de ligne de commande, Helm, qui utilise des graphiques Helm et un composant in-cluster, jusqu’à présent.</span><span class="sxs-lookup"><span data-stu-id="28bc4-118">Helm is composed of a command-line client, helm, which uses helm charts, and an in-cluster component, Tiller.</span></span> <span data-ttu-id="28bc4-119">Les graphiques Helm utilisent des fichiers au format YAML standard pour décrire un ensemble connexe de ressources Kubernetes et sont généralement associés à une version parallèle à l’application qu’ils décrivent.</span><span class="sxs-lookup"><span data-stu-id="28bc4-119">Helm Charts use standard YAML-formatted files to describe a related set of Kubernetes resources and are typically versioned alongside the application they describe.</span></span> <span data-ttu-id="28bc4-120">Les graphiques Helm vont du plus simple au plus complexe selon les exigences de l’installation qu’ils décrivent.</span><span class="sxs-lookup"><span data-stu-id="28bc4-120">Helm Charts range from simple to complex depending on the requirements of the installation they describe.</span></span>

<span data-ttu-id="28bc4-121">Vous trouverez les graphiques eShopOnContainers Helm dans le dossier/K8S/Helm.</span><span class="sxs-lookup"><span data-stu-id="28bc4-121">You'll find the eShopOnContainers helm charts in the /k8s/helm folder.</span></span> <span data-ttu-id="28bc4-122">La figure 2-6 montre comment les différents composants de l’application sont organisés dans une structure de dossiers utilisée par Helm pour définir et gérer des déploiements.</span><span class="sxs-lookup"><span data-stu-id="28bc4-122">Figure 2-6 shows how the different components of the application are organized into a folder structure used by helm to define and managed deployments.</span></span>

<span data-ttu-id="28bc4-123">![architecture eShopOnContainers](./media/eshoponcontainers-helm-folder.png)
**Figure 2-6**.</span><span class="sxs-lookup"><span data-stu-id="28bc4-123">![eShopOnContainers Architecture](./media/eshoponcontainers-helm-folder.png)
**Figure 2-6**.</span></span> <span data-ttu-id="28bc4-124">Dossier eShopOnContainers Helm.</span><span class="sxs-lookup"><span data-stu-id="28bc4-124">The eShopOnContainers helm folder.</span></span>

<span data-ttu-id="28bc4-125">Chaque composant individuel est installé à l’aide d’une commande `helm install`.</span><span class="sxs-lookup"><span data-stu-id="28bc4-125">Each individual component is installed using a `helm install` command.</span></span> <span data-ttu-id="28bc4-126">Ces commandes sont facilement scriptées, et eShopOnContainers fournit un script « déployer tout » qui parcourt les différents composants et les installe à l’aide de leurs graphiques Helm respectifs.</span><span class="sxs-lookup"><span data-stu-id="28bc4-126">These commands are easily scripted, and eShopOnContainers provides a "deploy all" script that loops through the different components and installs them using their respective helm charts.</span></span> <span data-ttu-id="28bc4-127">Le résultat est un processus reproductible, avec version avec l’application dans le contrôle de code source, que tous les membres de l’équipe peuvent déployer sur un cluster AKS à l’aide d’une commande de script d’une ligne.</span><span class="sxs-lookup"><span data-stu-id="28bc4-127">The result is a repeatable process, versioned with the application in source control, that anyone on the team can deploy to an AKS cluster with a one-line script command.</span></span> <span data-ttu-id="28bc4-128">En particulier lorsqu’il est associé à Azure Dev Spaces, cela permet aux développeurs de diagnostiquer et de tester facilement leurs modifications individuelles sur leurs applications Cloud natives basées sur des microservices.</span><span class="sxs-lookup"><span data-stu-id="28bc4-128">Especially when combined with Azure Dev Spaces, this makes it easy for developers to diagnose and test their individual changes to their microservice-based cloud-native apps.</span></span>

## <a name="azure-dev-spaces"></a><span data-ttu-id="28bc4-129">Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="28bc4-129">Azure Dev Spaces</span></span>

<span data-ttu-id="28bc4-130">Azure Dev Spaces aide les développeurs individuels à héberger leur propre version unique de clusters AKS dans Azure pendant le développement.</span><span class="sxs-lookup"><span data-stu-id="28bc4-130">Azure Dev Spaces helps individual developers host their own unique version of AKS clusters in Azure during development.</span></span> <span data-ttu-id="28bc4-131">Cela réduit la configuration requise de l’ordinateur local et permet aux membres de l’équipe de voir rapidement comment leurs modifications se comporteront dans un environnement AKS réel.</span><span class="sxs-lookup"><span data-stu-id="28bc4-131">This minimizes local machine requirements and allows team members to quickly see how their changes will behave in a real AKS environment.</span></span> <span data-ttu-id="28bc4-132">Azure Dev Spaces offre une interface CLI permettant aux développeurs de gérer leurs espaces de développement et de les déployer dans un espace de développement enfant spécifique en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="28bc4-132">Azure Dev Spaces offers a CLI for developers to use to manage their dev spaces and to deploy to a specific child dev space as needed.</span></span> <span data-ttu-id="28bc4-133">Chaque espace de développement enfant est référencé à l’aide d’un sous-domaine d’URL unique, ce qui permet des déploiements côte à côte de clusters modifiés, de sorte que les développeurs individuels puissent éviter les conflits entre les travaux en cours.</span><span class="sxs-lookup"><span data-stu-id="28bc4-133">Each child dev space is referenced using a unique URL subdomain, allowing side-by-side deployments of modified clusters so that individual developers can avoid conflicting with each other's work in progress.</span></span> <span data-ttu-id="28bc4-134">Dans la figure 2-7, vous pouvez voir comment Developer Julie a déployé sa propre version du microservice Bikes dans son espace de développement.</span><span class="sxs-lookup"><span data-stu-id="28bc4-134">In Figure 2-7 you can see how developer Susie has deployed her own version of the Bikes microservice into her dev space.</span></span> <span data-ttu-id="28bc4-135">Elle est ensuite en mesure de tester ses modifications à l’aide d’une URL personnalisée commençant par le nom de son espace (susie.s.dev.myapp.eus.azds.io).</span><span class="sxs-lookup"><span data-stu-id="28bc4-135">She's then able to test her changes using a custom URL starting with the name of her space (susie.s.dev.myapp.eus.azds.io).</span></span>

<span data-ttu-id="28bc4-136">![architecture eShopOnContainers](./media/azure-devspaces-one.png)
**Figure 2-7**.</span><span class="sxs-lookup"><span data-stu-id="28bc4-136">![eShopOnContainers Architecture](./media/azure-devspaces-one.png)
**Figure 2-7**.</span></span> <span data-ttu-id="28bc4-137">Developer Julie déploie sa propre version du microservice Bikes et le teste.</span><span class="sxs-lookup"><span data-stu-id="28bc4-137">Developer Susie deploys her own version of the Bikes microservice and tests it.</span></span>

<span data-ttu-id="28bc4-138">En même temps, le développeur John souhaite personnaliser le microservice de réservations et doit tester ses modifications.</span><span class="sxs-lookup"><span data-stu-id="28bc4-138">At the same time, developer John is customizing the Reservations microservice and needs to test his changes.</span></span> <span data-ttu-id="28bc4-139">Il peut déployer ses modifications dans son propre espace de développement sans conflit avec les modifications apportées à Julie, comme illustré dans la figure 2-8.</span><span class="sxs-lookup"><span data-stu-id="28bc4-139">He's able to deploy his changes to his own dev space without conflicting with Susie's changes as shown in Figure 2-8.</span></span> <span data-ttu-id="28bc4-140">Il peut tester ses modifications à l’aide de sa propre URL, qui est précédée du nom de son espace (john.s.dev.myapp.eus.azds.io).</span><span class="sxs-lookup"><span data-stu-id="28bc4-140">He can test his changes using his own URL which is prefixed with the name of his space (john.s.dev.myapp.eus.azds.io).</span></span>

<span data-ttu-id="28bc4-141">![architecture eShopOnContainers](./media/azure-devspaces-two.png)
**Figure 2-8**.</span><span class="sxs-lookup"><span data-stu-id="28bc4-141">![eShopOnContainers Architecture](./media/azure-devspaces-two.png)
**Figure 2-8**.</span></span> <span data-ttu-id="28bc4-142">Le développeur John déploie sa propre version du microservice de réservations et le teste sans conflit avec d’autres développeurs.</span><span class="sxs-lookup"><span data-stu-id="28bc4-142">Developer John deploys his own version of the Reservations microservice and tests it without conflicting with other developers.</span></span>

<span data-ttu-id="28bc4-143">À l’aide de Azure Dev Spaces, les équipes peuvent travailler directement avec AKS tout en modifiant, déployant et testant leurs modifications de manière indépendante.</span><span class="sxs-lookup"><span data-stu-id="28bc4-143">Using Azure Dev Spaces, teams can work directly with AKS while independently changing, deploying, and testing their changes.</span></span> <span data-ttu-id="28bc4-144">Cette approche réduit le besoin d’environnements hébergés dédiés distincts, car chaque développeur a son propre environnement AKS.</span><span class="sxs-lookup"><span data-stu-id="28bc4-144">This approach reduces the need for separate dedicated hosted environments since every developer effectively has their own AKS environment.</span></span> <span data-ttu-id="28bc4-145">Les développeurs peuvent travailler avec Azure Dev Spaces à l’aide de l’interface CLI ou lancer leur application pour Azure Dev Spaces directement à partir de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="28bc4-145">Developers can work with Azure Dev Spaces using its CLI or launch their application to Azure Dev Spaces directly from Visual Studio.</span></span> [<span data-ttu-id="28bc4-146">En savoir plus sur le fonctionnement de Azure Dev Spaces et sur la configuration.</span><span class="sxs-lookup"><span data-stu-id="28bc4-146">Learn more about how Azure Dev Spaces works and is configured.</span></span>](https://docs.microsoft.com/azure/dev-spaces/how-dev-spaces-works)

## <a name="azure-functions-and-logic-apps-serverless"></a><span data-ttu-id="28bc4-147">Azure Functions et Logic Apps (sans serveur)</span><span class="sxs-lookup"><span data-stu-id="28bc4-147">Azure Functions and Logic Apps (Serverless)</span></span>

<span data-ttu-id="28bc4-148">L’exemple eShopOnContainers comprend la prise en charge du suivi des campagnes marketing en ligne.</span><span class="sxs-lookup"><span data-stu-id="28bc4-148">The eShopOnContainers sample includes support for tracking online marketing campaigns.</span></span> <span data-ttu-id="28bc4-149">Une fonction Azure est utilisée pour extraire les détails d’une campagne marketing pour un ID de campagne donné.</span><span class="sxs-lookup"><span data-stu-id="28bc4-149">An Azure Function is used to pull marketing campaign details for a given campaign ID.</span></span> <span data-ttu-id="28bc4-150">Au lieu de créer une application ASP.NET Core complète à cet effet, un seul point de terminaison Azure Function est plus simple et suffisant.</span><span class="sxs-lookup"><span data-stu-id="28bc4-150">Rather than creating a complete ASP.NET Core application for this purpose, a single Azure Function endpoint is simpler and sufficient.</span></span> <span data-ttu-id="28bc4-151">Les Azure Functions ont un modèle de génération et de déploiement bien plus simple que les applications ASP.NET Core complètes, en particulier lorsqu’elles sont configurées pour s’exécuter dans Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="28bc4-151">Azure Functions have a much simpler build and deployment model than full ASP.NET Core applications, especially when configured to run in Kubernetes.</span></span> <span data-ttu-id="28bc4-152">Le déploiement de la fonction est un script à l’aide de modèles ARM (Azure Resource Manager) et du Azure CLI.</span><span class="sxs-lookup"><span data-stu-id="28bc4-152">Deploying the function is scripted using Azure Resource Manager (ARM) templates and the Azure CLI.</span></span> <span data-ttu-id="28bc4-153">Le microservice détails de la campagne n’est pas orienté client et n’a pas les mêmes exigences que le magasin en ligne, ce qui en fait un bon candidat pour la Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="28bc4-153">This campaign details microservice isn't customer-facing and doesn't have the same requirements as the online store, making it a good candidate for Azure Functions.</span></span> <span data-ttu-id="28bc4-154">La fonction nécessite une configuration pour fonctionner correctement, comme les données de chaîne de connexion à la base de données et les paramètres d’URI de base d’image.</span><span class="sxs-lookup"><span data-stu-id="28bc4-154">The function requires some configuration to work properly, such as database connection string data and image base URI settings.</span></span> <span data-ttu-id="28bc4-155">Vous configurez Azure Functions dans le portail Azure.</span><span class="sxs-lookup"><span data-stu-id="28bc4-155">You configure Azure Functions in the Azure Portal.</span></span>

## <a name="references"></a><span data-ttu-id="28bc4-156">Références</span><span class="sxs-lookup"><span data-stu-id="28bc4-156">References</span></span>

- <span data-ttu-id="28bc4-157">[eShopOnContainers : créer un cluster Kubernetes dans AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Deploy-to-Azure-Kubernetes-Service-(AKS)#create-kubernetes-cluster-in-aks)</span><span class="sxs-lookup"><span data-stu-id="28bc4-157">[eShopOnContainers: Create Kubernetes cluster in AKS](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Deploy-to-Azure-Kubernetes-Service-(AKS)#create-kubernetes-cluster-in-aks)</span></span>
- [<span data-ttu-id="28bc4-158">eShopOnContainers : Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="28bc4-158">eShopOnContainers: Azure Dev Spaces</span></span>](https://github.com/dotnet-architecture/eShopOnContainers/wiki/Azure-Dev-Spaces)
- [<span data-ttu-id="28bc4-159">Azure Dev Spaces</span><span class="sxs-lookup"><span data-stu-id="28bc4-159">Azure Dev Spaces</span></span>](https://docs.microsoft.com/azure/dev-spaces/about)

>[!div class="step-by-step"]
><span data-ttu-id="28bc4-160">[Précédent](map-eshoponcontainers-azure-services.md)
>[Suivant](centralized-configuration.md)</span><span class="sxs-lookup"><span data-stu-id="28bc4-160">[Previous](map-eshoponcontainers-azure-services.md)
[Next](centralized-configuration.md)</span></span>

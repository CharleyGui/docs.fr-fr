---
title: Communication service-service
description: Découvrez comment les microservices natifs du cloud en arrière communiquent avec d’autres microservices back-end.
author: robvet
ms.date: 09/09/2019
ms.openlocfilehash: 926be3c2eb4513c89ebcd1f31dceb7d58639dc6f
ms.sourcegitcommit: 79b0dd8bfc63f33a02137121dd23475887ecefda
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/01/2020
ms.locfileid: "80523559"
---
# <a name="service-to-service-communication"></a><span data-ttu-id="6e54b-103">Communication service-service</span><span class="sxs-lookup"><span data-stu-id="6e54b-103">Service-to-service communication</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="6e54b-104">En passant du client front-end, nous nous attaquons maintenant aux microservices back-end communiquer les uns avec les autres.</span><span class="sxs-lookup"><span data-stu-id="6e54b-104">Moving from the front-end client, we now address back-end microservices communicate with each other.</span></span>

<span data-ttu-id="6e54b-105">Lors de la construction d’une application cloud-native, vous voudrez être sensible à la façon dont les services back-end communiquent les uns avec les autres.</span><span class="sxs-lookup"><span data-stu-id="6e54b-105">When constructing a cloud-native application, you'll want to be sensitive to how back-end services communicate with each other.</span></span> <span data-ttu-id="6e54b-106">Idéalement, moins il y a de communication interspède, mieux c’est.</span><span class="sxs-lookup"><span data-stu-id="6e54b-106">Ideally, the less inter-service communication, the better.</span></span> <span data-ttu-id="6e54b-107">Cependant, l’évitement n’est pas toujours possible car les services back-end comptent souvent les uns sur les autres pour effectuer une opération.</span><span class="sxs-lookup"><span data-stu-id="6e54b-107">However, avoidance isn't always possible as back-end services often rely on one another to complete an operation.</span></span>

<span data-ttu-id="6e54b-108">Il existe plusieurs approches largement acceptées pour mettre en œuvre la communication interseuvre.</span><span class="sxs-lookup"><span data-stu-id="6e54b-108">There are several widely accepted approaches to implementing cross-service communication.</span></span> <span data-ttu-id="6e54b-109">Le *type d’interaction de communication* déterminera souvent la meilleure approche.</span><span class="sxs-lookup"><span data-stu-id="6e54b-109">The *type of communication interaction* will often determine the best approach.</span></span>

<span data-ttu-id="6e54b-110">Considérez les types d’interaction suivants :</span><span class="sxs-lookup"><span data-stu-id="6e54b-110">Consider the following interaction types:</span></span>

- <span data-ttu-id="6e54b-111">*Requête* - quand un microservice d’appel nécessite une réponse d’un microservice appelé, tel que, "Hey, donnez-moi les informations de l’acheteur pour un client donné Id."</span><span class="sxs-lookup"><span data-stu-id="6e54b-111">*Query* – when a calling microservice requires a response from a called microservice, such as, "Hey, give me the buyer information for a given customer Id."</span></span>

- <span data-ttu-id="6e54b-112">*Commandez* - lorsque le microservice d’appel a besoin d’un autre microservice pour exécuter une action, mais ne nécessite pas de réponse, comme, "Hey, il suffit d’expédier cet ordre."</span><span class="sxs-lookup"><span data-stu-id="6e54b-112">*Command* – when the calling microservice needs another microservice to execute an action but doesn't require a response, such as, "Hey, just ship this order."</span></span>

- <span data-ttu-id="6e54b-113">*Événement* - quand un microservice, appelé l’éditeur, soulève un événement que l’état a changé ou une action a eu lieu.</span><span class="sxs-lookup"><span data-stu-id="6e54b-113">*Event* – when a microservice, called the publisher, raises an event that state has changed or an action has occurred.</span></span> <span data-ttu-id="6e54b-114">D’autres microservices, appelés abonnés, qui sont intéressés, peuvent réagir de façon appropriée à l’événement.</span><span class="sxs-lookup"><span data-stu-id="6e54b-114">Other microservices, called subscribers, who are interested, can react to the event appropriately.</span></span> <span data-ttu-id="6e54b-115">L’éditeur et les abonnés ne sont pas au courant l’un de l’autre.</span><span class="sxs-lookup"><span data-stu-id="6e54b-115">The publisher and the subscribers aren't aware of each other.</span></span>

<span data-ttu-id="6e54b-116">Les systèmes de microservice utilisent généralement une combinaison de ces types d’interaction lors de l’exécution d’opérations qui nécessitent une interaction interservices.</span><span class="sxs-lookup"><span data-stu-id="6e54b-116">Microservice systems typically use a combination of these interaction types when executing operations that require cross-service interaction.</span></span> <span data-ttu-id="6e54b-117">Examinons de près chacun d’eux et comment vous pourriez les mettre en œuvre.</span><span class="sxs-lookup"><span data-stu-id="6e54b-117">Let's take a close look at each and how you might implement them.</span></span>

## <a name="queries"></a><span data-ttu-id="6e54b-118">Requêtes</span><span class="sxs-lookup"><span data-stu-id="6e54b-118">Queries</span></span>

<span data-ttu-id="6e54b-119">Plusieurs fois, un microservice peut avoir besoin de *poser des questions* à un autre, nécessitant une réponse immédiate pour terminer une opération.</span><span class="sxs-lookup"><span data-stu-id="6e54b-119">Many times, one microservice might need to *query* another, requiring an immediate response to complete an operation.</span></span> <span data-ttu-id="6e54b-120">Un microservice de panier d’achat peut avoir besoin d’informations sur le produit et d’un prix pour ajouter un article à son panier.</span><span class="sxs-lookup"><span data-stu-id="6e54b-120">A shopping basket microservice may need product information and a price to add an item to its basket.</span></span> <span data-ttu-id="6e54b-121">Il existe un certain nombre d’approches pour la mise en œuvre des opérations de requête.</span><span class="sxs-lookup"><span data-stu-id="6e54b-121">There are a number of approaches for implementing query operations.</span></span>

### <a name="requestresponse-messaging"></a><span data-ttu-id="6e54b-122">Demande/messagerie d’intervention</span><span class="sxs-lookup"><span data-stu-id="6e54b-122">Request/Response Messaging</span></span>

<span data-ttu-id="6e54b-123">Une option pour la mise en œuvre de ce scénario est que le microservice de retour à appel fasse des demandes directes de HTTP aux microservices qu’il doit interroger, indiqué dans la figure 4-8.</span><span class="sxs-lookup"><span data-stu-id="6e54b-123">One option for implementing this scenario is for the calling back-end microservice to make direct HTTP requests to the microservices it needs to query, shown in Figure 4-8.</span></span>

![Communication directe HTTP](./media/direct-http-communication.png)

<span data-ttu-id="6e54b-125">**Figure 4-8**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-125">**Figure 4-8**.</span></span> <span data-ttu-id="6e54b-126">Communication directe HTTP</span><span class="sxs-lookup"><span data-stu-id="6e54b-126">Direct HTTP communication</span></span>

<span data-ttu-id="6e54b-127">Bien que les appels directs de HTTP entre les microservices soient relativement simples à mettre en œuvre, il faut faire attention à minimiser cette pratique.</span><span class="sxs-lookup"><span data-stu-id="6e54b-127">While direct HTTP calls between microservices are relatively simple to implement, care should be taken to minimize this practice.</span></span> <span data-ttu-id="6e54b-128">Pour commencer, ces appels sont toujours *synchrones* et bloqueront l’opération jusqu’à ce qu’un résultat soit retourné ou que les délais de demande soient dépassés.</span><span class="sxs-lookup"><span data-stu-id="6e54b-128">To start, these calls are always *synchronous* and will block the operation until a result is returned or the request times outs.</span></span> <span data-ttu-id="6e54b-129">Ce qui était autrefois autonome, des services indépendants, capables d’évoluer indépendamment et de se déployer fréquemment, deviennent maintenant couplés les uns aux autres.</span><span class="sxs-lookup"><span data-stu-id="6e54b-129">What were once self-contained, independent services, able to evolve independently and deploy frequently, now become coupled to each other.</span></span> <span data-ttu-id="6e54b-130">À mesure que le couplage entre les microservices augmente, leurs avantages architecturaux diminuent.</span><span class="sxs-lookup"><span data-stu-id="6e54b-130">As coupling among microservices increase, their architectural benefits diminish.</span></span>

<span data-ttu-id="6e54b-131">L’exécution d’une demande peu fréquente qui fait un seul appel direct HTTP à un autre microservice pourrait être acceptable pour certains systèmes.</span><span class="sxs-lookup"><span data-stu-id="6e54b-131">Executing an infrequent request that makes a single direct HTTP call to another microservice might be acceptable for some systems.</span></span> <span data-ttu-id="6e54b-132">Cependant, les appels à volume élevé qui invoquent des appels HTTP directs vers plusieurs microservices ne sont pas recommandés.</span><span class="sxs-lookup"><span data-stu-id="6e54b-132">However, high-volume calls that invoke direct HTTP calls to multiple microservices aren't advisable.</span></span> <span data-ttu-id="6e54b-133">Ils peuvent augmenter la latence et avoir un impact négatif sur les performances, l’évolutivité et la disponibilité de votre système.</span><span class="sxs-lookup"><span data-stu-id="6e54b-133">They can increase latency and negatively impact the performance, scalability, and availability of your system.</span></span> <span data-ttu-id="6e54b-134">Pire encore, une longue série de communications directes http://HTTP peut mener à des chaînes profondes et complexes d’appels synchrones de microservices, indiqués dans la figure 4-9 :</span><span class="sxs-lookup"><span data-stu-id="6e54b-134">Even worse, a long series of direct HTTP communication can lead to deep and complex chains of synchronous microservices calls, shown in Figure 4-9:</span></span>

![Enchaîner les requêtes HTTP](./media/chaining-http-queries.png)

<span data-ttu-id="6e54b-136">**Figure 4-9**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-136">**Figure 4-9**.</span></span> <span data-ttu-id="6e54b-137">Enchaîner les requêtes HTTP</span><span class="sxs-lookup"><span data-stu-id="6e54b-137">Chaining HTTP queries</span></span>

<span data-ttu-id="6e54b-138">Vous pouvez certainement imaginer le risque dans la conception montrée dans l’image précédente.</span><span class="sxs-lookup"><span data-stu-id="6e54b-138">You can certainly imagine the risk in the design shown in the previous image.</span></span> <span data-ttu-id="6e54b-139">Que se \#passe-t-il si l’étape 3 échoue ?</span><span class="sxs-lookup"><span data-stu-id="6e54b-139">What happens if Step \#3 fails?</span></span> <span data-ttu-id="6e54b-140">Ou \#l’étape 8 échoue?</span><span class="sxs-lookup"><span data-stu-id="6e54b-140">Or Step \#8 fails?</span></span> <span data-ttu-id="6e54b-141">Comment vous rétablissez-vous?</span><span class="sxs-lookup"><span data-stu-id="6e54b-141">How do you recover?</span></span> <span data-ttu-id="6e54b-142">Que se \#passe-t-il si l’étape 6 est lente parce que le service sous-jacent est occupé?</span><span class="sxs-lookup"><span data-stu-id="6e54b-142">What if Step \#6 is slow because the underlying service is busy?</span></span> <span data-ttu-id="6e54b-143">Comment continuez-vous?</span><span class="sxs-lookup"><span data-stu-id="6e54b-143">How do you continue?</span></span> <span data-ttu-id="6e54b-144">Même si tout fonctionne correctement, pensez à la latence que cet appel encourrait, qui est la somme de la latence de chaque étape.</span><span class="sxs-lookup"><span data-stu-id="6e54b-144">Even if all works correctly, think of the latency this call would incur, which is the sum of the latency of each step.</span></span>

<span data-ttu-id="6e54b-145">Le grand degré de couplage dans l’image précédente suggère que les services n’ont pas été modélisé de façon optimale.</span><span class="sxs-lookup"><span data-stu-id="6e54b-145">The large degree of coupling in the previous image suggests the services weren't optimally modeled.</span></span> <span data-ttu-id="6e54b-146">Il incomberait à l’équipe de revoir leur conception.</span><span class="sxs-lookup"><span data-stu-id="6e54b-146">It would behoove the team to revisit their design.</span></span>

### <a name="materialized-view-pattern"></a><span data-ttu-id="6e54b-147">Modèle de vue matérialisée</span><span class="sxs-lookup"><span data-stu-id="6e54b-147">Materialized View pattern</span></span>

<span data-ttu-id="6e54b-148">Une option populaire pour enlever le couplage de microservice est le [modèle de vue matérialisée.](https://docs.microsoft.com/azure/architecture/patterns/materialized-view)</span><span class="sxs-lookup"><span data-stu-id="6e54b-148">A popular option for removing microservice coupling is the [Materialized View pattern](https://docs.microsoft.com/azure/architecture/patterns/materialized-view).</span></span> <span data-ttu-id="6e54b-149">Avec ce modèle, un microservice stocke sa propre copie locale et dénormalisée des données qui appartiennent à d’autres services.</span><span class="sxs-lookup"><span data-stu-id="6e54b-149">With this pattern, a microservice stores its own local, denormalized copy of data that's owned by other services.</span></span> <span data-ttu-id="6e54b-150">Au lieu de la microservice Shopping Basket interrogeant le catalogue de produits et les microservices de tarification, il conserve sa propre copie locale de ces données.</span><span class="sxs-lookup"><span data-stu-id="6e54b-150">Instead of the Shopping Basket microservice querying the Product Catalog and Pricing microservices, it maintains its own local copy of that data.</span></span> <span data-ttu-id="6e54b-151">Ce modèle élimine le couplage inutile et améliore la fiabilité et le temps de réponse.</span><span class="sxs-lookup"><span data-stu-id="6e54b-151">This pattern eliminates unnecessary coupling and improves reliability and response time.</span></span> <span data-ttu-id="6e54b-152">L’ensemble de l’opération s’exécute à l’intérieur d’un seul processus.</span><span class="sxs-lookup"><span data-stu-id="6e54b-152">The entire operation executes inside a single process.</span></span> <span data-ttu-id="6e54b-153">Nous explorons ce modèle et d’autres préoccupations en matière de données au chapitre 5.</span><span class="sxs-lookup"><span data-stu-id="6e54b-153">We explore this pattern and other data concerns in Chapter 5.</span></span>

### <a name="service-aggregator-pattern"></a><span data-ttu-id="6e54b-154">Modèle d’agrégateur de service</span><span class="sxs-lookup"><span data-stu-id="6e54b-154">Service Aggregator Pattern</span></span>

<span data-ttu-id="6e54b-155">Une autre option pour éliminer le couplage microservice-microservice est [un microservice d’agrégateur,](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/)indiqué en violet dans la figure 4-10.</span><span class="sxs-lookup"><span data-stu-id="6e54b-155">Another option for eliminating microservice-to-microservice coupling is an [Aggregator microservice](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), shown in purple in Figure 4-10.</span></span>

![Service d’agrégateur](./media/aggregator-service.png)

<span data-ttu-id="6e54b-157">**Figure 4-10**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-157">**Figure 4-10**.</span></span> <span data-ttu-id="6e54b-158">Microservice d’agrégateur</span><span class="sxs-lookup"><span data-stu-id="6e54b-158">Aggregator microservice</span></span>

<span data-ttu-id="6e54b-159">Le modèle isole une opération qui fait des appels à plusieurs microservices back-end, centralisant sa logique dans un microservice spécialisé.</span><span class="sxs-lookup"><span data-stu-id="6e54b-159">The pattern isolates an operation that makes calls to multiple back-end microservices, centralizing its logic into a specialized microservice.</span></span>  <span data-ttu-id="6e54b-160">Le microservice d’agrégateur de caisse violet dans la figure précédente orchestre le flux de travail pour l’opération de caisse.</span><span class="sxs-lookup"><span data-stu-id="6e54b-160">The purple checkout aggregator microservice in the previous figure orchestrates the workflow for the Checkout operation.</span></span> <span data-ttu-id="6e54b-161">Il comprend des appels vers plusieurs microservices back-end dans un ordre séquent.</span><span class="sxs-lookup"><span data-stu-id="6e54b-161">It includes calls to several back-end microservices in a sequenced order.</span></span> <span data-ttu-id="6e54b-162">Les données du flux de travail sont agrégées et retournées à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="6e54b-162">Data from the workflow is aggregated and returned to the caller.</span></span> <span data-ttu-id="6e54b-163">Bien qu’il implémente toujours des appels HTTP directs, le microservice d’agrégateur réduit les dépendances directes parmi les microservices back-end.</span><span class="sxs-lookup"><span data-stu-id="6e54b-163">While it still implements direct HTTP calls, the aggregator microservice reduces direct dependencies among back-end microservices.</span></span>

### <a name="requestreply-pattern"></a><span data-ttu-id="6e54b-164">Modèle de demande/réponse</span><span class="sxs-lookup"><span data-stu-id="6e54b-164">Request/Reply Pattern</span></span>

<span data-ttu-id="6e54b-165">Une autre approche pour découpler les messages HTTP synchrones est un [modèle de demande-réponse](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), qui utilise la communication en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="6e54b-165">Another approach for decoupling synchronous HTTP messages is a [Request-Reply Pattern](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), which uses queuing communication.</span></span> <span data-ttu-id="6e54b-166">La communication à l’aide d’une file d’attente est toujours un canal à sens unique, avec un producteur qui envoie le message et le consommateur qui le reçoit.</span><span class="sxs-lookup"><span data-stu-id="6e54b-166">Communication using a queue is always a one-way channel, with a producer sending the message and consumer receiving it.</span></span> <span data-ttu-id="6e54b-167">Avec ce modèle, une file d’attente de demande et une file d’attente de réponse sont mises en œuvre, indiquées dans la figure 4-11.</span><span class="sxs-lookup"><span data-stu-id="6e54b-167">With this pattern, both a request queue and response queue are implemented, shown in Figure 4-11.</span></span>

![Modèle de demande-réponse](./media/request-reply-pattern.png)

<span data-ttu-id="6e54b-169">**Figure 4-11**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-169">**Figure 4-11**.</span></span> <span data-ttu-id="6e54b-170">Modèle de demande-réponse</span><span class="sxs-lookup"><span data-stu-id="6e54b-170">Request-reply pattern</span></span>

<span data-ttu-id="6e54b-171">Ici, le producteur de message crée un message basé sur la requête qui contient une pièce d’identité de corrélation unique et le place dans une file d’attente de demande.</span><span class="sxs-lookup"><span data-stu-id="6e54b-171">Here, the message producer creates a query-based message that contains a unique correlation ID and places it into a request queue.</span></span> <span data-ttu-id="6e54b-172">Le service de consommation déqueue les messages, le traite et place la réponse dans la file d’attente de réponse avec le même ID de corrélation.</span><span class="sxs-lookup"><span data-stu-id="6e54b-172">The consuming service dequeues the messages, processes it and places the response into the response queue with the same correlation ID.</span></span> <span data-ttu-id="6e54b-173">Le service de production déqueue le message, l’associe à l’ID de corrélation et continue le traitement.</span><span class="sxs-lookup"><span data-stu-id="6e54b-173">The producer service dequeues the message, matches it with the correlation ID and continues processing.</span></span> <span data-ttu-id="6e54b-174">Nous couvrons les files d’attente en détail dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="6e54b-174">We cover queues in detail in the next section.</span></span>

## <a name="commands"></a><span data-ttu-id="6e54b-175">Commandes</span><span class="sxs-lookup"><span data-stu-id="6e54b-175">Commands</span></span>

<span data-ttu-id="6e54b-176">Un autre type d’interaction de communication est une *commande*.</span><span class="sxs-lookup"><span data-stu-id="6e54b-176">Another type of communication interaction is a *command*.</span></span> <span data-ttu-id="6e54b-177">Un microservice peut avoir besoin d’un autre microservice pour effectuer une action.</span><span class="sxs-lookup"><span data-stu-id="6e54b-177">A microservice may need another microservice to perform an action.</span></span> <span data-ttu-id="6e54b-178">Le microservice de commande peut avoir besoin du microservice d’expédition pour créer un envoi pour une commande approuvée.</span><span class="sxs-lookup"><span data-stu-id="6e54b-178">The Ordering microservice may need the Shipping microservice to create a shipment for an approved order.</span></span> <span data-ttu-id="6e54b-179">Dans la figure 4-12, un microservice, appelé producteur, envoie un message à un autre microservice, le consommateur, lui or commandant de faire quelque chose.</span><span class="sxs-lookup"><span data-stu-id="6e54b-179">In Figure 4-12, one microservice, called a Producer, sends a message to another microservice, the Consumer, commanding it to do something.</span></span>

![Interaction de commande avec une file d’attente](./media/command-interaction-with-queue.png)

<span data-ttu-id="6e54b-181">**Figure 4-12**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-181">**Figure 4-12**.</span></span> <span data-ttu-id="6e54b-182">Interaction de commande avec une file d’attente</span><span class="sxs-lookup"><span data-stu-id="6e54b-182">Command interaction with a queue</span></span>

<span data-ttu-id="6e54b-183">Le plus souvent, le producteur n’a pas besoin d’intervention et peut *allumer et oublier* le message.</span><span class="sxs-lookup"><span data-stu-id="6e54b-183">Most often, the Producer doesn't require a response and can *fire-and-forget* the message.</span></span> <span data-ttu-id="6e54b-184">Si une réponse est nécessaire, le consommateur envoie un message distinct au producteur sur un autre canal.</span><span class="sxs-lookup"><span data-stu-id="6e54b-184">If a reply is needed, the Consumer sends a separate message back to Producer on another channel.</span></span> <span data-ttu-id="6e54b-185">Un message de commande est mieux envoyé asynchrone avec une file d’attente de message.</span><span class="sxs-lookup"><span data-stu-id="6e54b-185">A command message is best sent asynchronously with a message queue.</span></span> <span data-ttu-id="6e54b-186">soutenu par un courtier de messages légers.</span><span class="sxs-lookup"><span data-stu-id="6e54b-186">supported by a lightweight message broker.</span></span> <span data-ttu-id="6e54b-187">Dans le diagramme précédent, notez comment une file d’attente sépare et découple les deux services.</span><span class="sxs-lookup"><span data-stu-id="6e54b-187">In the previous diagram, note how a queue separates and decouples both services.</span></span>

<span data-ttu-id="6e54b-188">Une file d’attente de message est une construction intermédiaire par laquelle un producteur et un consommateur passent un message.</span><span class="sxs-lookup"><span data-stu-id="6e54b-188">A message queue is an intermediary construct through which a producer and consumer pass a message.</span></span> <span data-ttu-id="6e54b-189">Les files d’attente implémentent un modèle de messagerie asynchrone, point à point.</span><span class="sxs-lookup"><span data-stu-id="6e54b-189">Queues implement an asynchronous, point-to-point messaging pattern.</span></span> <span data-ttu-id="6e54b-190">Le producteur sait où une commande doit être envoyée et les itinéraires appropriés.</span><span class="sxs-lookup"><span data-stu-id="6e54b-190">The Producer knows where a command needs to be sent and routes appropriately.</span></span> <span data-ttu-id="6e54b-191">La file d’attente garantit qu’un message est traité par exactement l’un des cas de consommateurs qui lisent à partir du canal.</span><span class="sxs-lookup"><span data-stu-id="6e54b-191">The queue guarantees that a message is processed by exactly one of the consumer instances that are reading from the channel.</span></span> <span data-ttu-id="6e54b-192">Dans ce scénario, le fournisseur ou le service aux consommateurs peut s’étendre sans affecter l’autre.</span><span class="sxs-lookup"><span data-stu-id="6e54b-192">In this scenario, either the producer or consumer service can scale out without affecting the other.</span></span> <span data-ttu-id="6e54b-193">En outre, les technologies peuvent être disparates de chaque côté, ce qui signifie que nous pourrions avoir un microservice Java appelant un microservice [Golang.](https://golang.org)</span><span class="sxs-lookup"><span data-stu-id="6e54b-193">As well, technologies can be disparate on each side, meaning that we might have a Java microservice calling a [Golang](https://golang.org) microservice.</span></span>

<span data-ttu-id="6e54b-194">Dans le chapitre 1, nous avons parlé *de services de soutien*.</span><span class="sxs-lookup"><span data-stu-id="6e54b-194">In chapter 1, we talked about *backing services*.</span></span> <span data-ttu-id="6e54b-195">Les services de soutien sont des ressources accessoires dont dépendent les systèmes cloud-autochtones.</span><span class="sxs-lookup"><span data-stu-id="6e54b-195">Backing services are ancillary resources upon which cloud-native systems depend.</span></span> <span data-ttu-id="6e54b-196">Les files d’attente de messages sont des services de soutien.</span><span class="sxs-lookup"><span data-stu-id="6e54b-196">Message queues are backing services.</span></span> <span data-ttu-id="6e54b-197">Le cloud Azure prend en charge deux types de files d’attente de messages que vos systèmes cloud-native peuvent consommer pour implémenter la messagerie de commande : Azure Storage Queues et Azure Service Bus Queues.</span><span class="sxs-lookup"><span data-stu-id="6e54b-197">The Azure cloud supports two types of message queues that your cloud-native systems can consume to implement command messaging: Azure Storage Queues and Azure Service Bus Queues.</span></span>

### <a name="azure-storage-queues"></a><span data-ttu-id="6e54b-198">Files d’attente Stockage Azure</span><span class="sxs-lookup"><span data-stu-id="6e54b-198">Azure Storage Queues</span></span>

<span data-ttu-id="6e54b-199">Les files d’attente de stockage Azure offrent une infrastructure de file d’attente simple qui est rapide, abordable, et soutenu par des comptes de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="6e54b-199">Azure storage queues offer a simple queueing infrastructure that is fast, affordable, and backed by Azure storage accounts.</span></span>

<span data-ttu-id="6e54b-200">[Azure Storage Queues](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) dispose d’un mécanisme de file d’attente basé sur REST avec messagerie fiable et persistante.</span><span class="sxs-lookup"><span data-stu-id="6e54b-200">[Azure Storage Queues](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) feature a REST-based queuing mechanism with reliable and persistent messaging.</span></span> <span data-ttu-id="6e54b-201">Ils fournissent un ensemble de fonctionnalités minimales, mais sont peu coûteux et stockent des millions de messages.</span><span class="sxs-lookup"><span data-stu-id="6e54b-201">They provide a minimal feature set, but are inexpensive and store millions of messages.</span></span> <span data-ttu-id="6e54b-202">Leur capacité va jusqu’à 500 TB.</span><span class="sxs-lookup"><span data-stu-id="6e54b-202">Their capacity ranges up to 500 TB.</span></span> <span data-ttu-id="6e54b-203">Un seul message peut être jusqu’à 64 KB de taille.</span><span class="sxs-lookup"><span data-stu-id="6e54b-203">A single message can be up to 64 KB in size.</span></span>

<span data-ttu-id="6e54b-204">Vous pouvez accéder à des messages de n’importe où dans le monde via des appels authentifiés à l’aide de HTTP ou HTTPS.</span><span class="sxs-lookup"><span data-stu-id="6e54b-204">You can access messages from anywhere in the world via authenticated calls using HTTP or HTTPS.</span></span> <span data-ttu-id="6e54b-205">Les files d’attente de stockage peuvent s’étendre à un grand nombre de clients simultanés pour gérer les pics de trafic.</span><span class="sxs-lookup"><span data-stu-id="6e54b-205">Storage queues can scale out to large numbers of concurrent clients to handle traffic spikes.</span></span>

<span data-ttu-id="6e54b-206">Cela dit, il y a des limites au service :</span><span class="sxs-lookup"><span data-stu-id="6e54b-206">That said, there are limitations with the service:</span></span>

- <span data-ttu-id="6e54b-207">L’ordre de message n’est pas garanti.</span><span class="sxs-lookup"><span data-stu-id="6e54b-207">Message order isn't guaranteed.</span></span>

- <span data-ttu-id="6e54b-208">Un message ne peut persister que sept jours avant d’être automatiquement supprimé.</span><span class="sxs-lookup"><span data-stu-id="6e54b-208">A message can only persist for seven days before it's automatically removed.</span></span>

- <span data-ttu-id="6e54b-209">Le support pour la gestion de l’État, la détection en double ou les transactions n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="6e54b-209">Support for state management, duplicate detection, or transactions isn't available.</span></span>

<span data-ttu-id="6e54b-210">La figure 4-13 montre la hiérarchie d’une file d’attente de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="6e54b-210">Figure 4-13 shows the hierarchy of an Azure Storage Queue.</span></span>

![Hiérarchie des files d’attente de stockage](./media/storage-queue-hierarchy.png)

<span data-ttu-id="6e54b-212">**Figure 4-13**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-212">**Figure 4-13**.</span></span> <span data-ttu-id="6e54b-213">Hiérarchie des files d’attente de stockage</span><span class="sxs-lookup"><span data-stu-id="6e54b-213">Storage queue hierarchy</span></span>

<span data-ttu-id="6e54b-214">Dans le chiffre précédent, notez comment les files d’attente de stockage stockent leurs messages dans le compte de stockage Azure sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="6e54b-214">In the previous figure, note how storage queues store their messages in the underlying Azure Storage account.</span></span>

<span data-ttu-id="6e54b-215">Pour les développeurs, Microsoft fournit plusieurs bibliothèques client et serveur pour le traitement des files d’attente de stockage.</span><span class="sxs-lookup"><span data-stu-id="6e54b-215">For developers, Microsoft provides several client and server-side libraries for Storage queue processing.</span></span> <span data-ttu-id="6e54b-216">La plupart des principales plates-formes sont prises en charge, y compris .NET, Java, JavaScript, Ruby, Python et Go.</span><span class="sxs-lookup"><span data-stu-id="6e54b-216">Most major platforms are supported including .NET, Java, JavaScript, Ruby, Python, and Go.</span></span> <span data-ttu-id="6e54b-217">Les développeurs ne doivent jamais communiquer directement avec ces bibliothèques.</span><span class="sxs-lookup"><span data-stu-id="6e54b-217">Developers should never communicate directly with these libraries.</span></span> <span data-ttu-id="6e54b-218">Cela permettra de coupler étroitement votre code de microservice au service Azure Storage Queue.</span><span class="sxs-lookup"><span data-stu-id="6e54b-218">Doing so will tightly couple your microservice code to the Azure Storage Queue service.</span></span> <span data-ttu-id="6e54b-219">C’est une meilleure pratique pour isoler les détails de mise en œuvre de l’API.</span><span class="sxs-lookup"><span data-stu-id="6e54b-219">It's a better practice to insulate the implementation details of the API.</span></span> <span data-ttu-id="6e54b-220">Introduire une couche d’intermédiation, ou API intermédiaire, qui expose les opérations génériques et encapsule la bibliothèque en béton.</span><span class="sxs-lookup"><span data-stu-id="6e54b-220">Introduce an intermediation layer, or intermediate API, that exposes generic operations and encapsulates the concrete library.</span></span> <span data-ttu-id="6e54b-221">Ce couplage lâche vous permet d’échanger un service de file d’attente contre un autre sans avoir à apporter des modifications au code de service principal.</span><span class="sxs-lookup"><span data-stu-id="6e54b-221">This loose coupling enables you to swap out one queuing service for another without having to make changes to the mainline service code.</span></span>

<span data-ttu-id="6e54b-222">Les files d’attente Azure Storage sont une option économique pour implémenter la messagerie de commande dans vos applications cloud-native.</span><span class="sxs-lookup"><span data-stu-id="6e54b-222">Azure Storage queues are an economical option to implement command messaging in your cloud-native applications.</span></span> <span data-ttu-id="6e54b-223">Surtout quand une taille de file d’attente dépassera 80 Go, ou un ensemble de fonctionnalité simple est acceptable.</span><span class="sxs-lookup"><span data-stu-id="6e54b-223">Especially when a queue size will exceed 80 GB, or a simple feature set is acceptable.</span></span> <span data-ttu-id="6e54b-224">Vous ne payez que pour le stockage des messages; il n’y a pas de frais horaires fixes.</span><span class="sxs-lookup"><span data-stu-id="6e54b-224">You only pay for the storage of the messages; there are no fixed hourly charges.</span></span>

### <a name="azure-service-bus-queues"></a><span data-ttu-id="6e54b-225">Files d’attente Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="6e54b-225">Azure Service Bus Queues</span></span>

<span data-ttu-id="6e54b-226">Pour des exigences de messagerie plus complexes, envisagez les files d’attente Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="6e54b-226">For more complex messaging requirements, consider Azure Service Bus queues.</span></span>

<span data-ttu-id="6e54b-227">Assis au sommet d’une infrastructure de message robuste, [Azure Service Bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) prend en charge un *modèle de messagerie négocié.*</span><span class="sxs-lookup"><span data-stu-id="6e54b-227">Sitting atop a robust message infrastructure, [Azure Service Bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) supports a *brokered messaging model*.</span></span> <span data-ttu-id="6e54b-228">Les messages sont stockés de façon fiable dans un courtier (la file d’attente) jusqu’à ce qu’ils soient reçus par le consommateur.</span><span class="sxs-lookup"><span data-stu-id="6e54b-228">Messages are reliably stored in a broker (the queue) until received by the consumer.</span></span> <span data-ttu-id="6e54b-229">La file d’attente garantit la livraison de messages First-In/First-Out (FIFO), en respectant l’ordre dans lequel les messages ont été ajoutés à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="6e54b-229">The queue guarantees First-In/First-Out (FIFO) message delivery, respecting the order in which messages were added to the queue.</span></span>

<span data-ttu-id="6e54b-230">La taille d’un message peut être beaucoup plus grande, jusqu’à 256 KB.</span><span class="sxs-lookup"><span data-stu-id="6e54b-230">The size of a message can be much larger, up to 256 KB.</span></span> <span data-ttu-id="6e54b-231">Les messages persistent dans la file d’attente pendant une période illimitée.</span><span class="sxs-lookup"><span data-stu-id="6e54b-231">Messages are persisted in the queue for an unlimited period of time.</span></span> <span data-ttu-id="6e54b-232">Service Bus prend en charge non seulement les appels basés sur HTTP, mais fournit également un soutien complet pour le [protocole AMPQ](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview).</span><span class="sxs-lookup"><span data-stu-id="6e54b-232">Service Bus supports not only HTTP-based calls, but also provides full support for the [AMPQ protocol](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview).</span></span> <span data-ttu-id="6e54b-233">AMPQ est un standard ouvert entre les fournisseurs qui prend en charge un protocole binaire et des degrés de fiabilité plus élevés.</span><span class="sxs-lookup"><span data-stu-id="6e54b-233">AMPQ is an open-standard across vendors that supports a binary protocol and higher degrees of reliability.</span></span>

<span data-ttu-id="6e54b-234">Service Bus fournit un riche ensemble de fonctionnalités, y compris [le support transactionnel](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) et une [fonction de détection en double](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection).</span><span class="sxs-lookup"><span data-stu-id="6e54b-234">Service Bus provides a rich set of features, including [transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) and a [duplicate detection feature](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection).</span></span> <span data-ttu-id="6e54b-235">La file d’attente garantit « tout au plus une fois la livraison » par message.</span><span class="sxs-lookup"><span data-stu-id="6e54b-235">The queue guarantees "at most once delivery" per message.</span></span> <span data-ttu-id="6e54b-236">Il rejette automatiquement un message qui a déjà été envoyé.</span><span class="sxs-lookup"><span data-stu-id="6e54b-236">It automatically discards a message that has already been sent.</span></span> <span data-ttu-id="6e54b-237">Si un producteur est en doute, il peut renvoyer le même message, et Service Bus garantit qu’une seule copie sera traitée.</span><span class="sxs-lookup"><span data-stu-id="6e54b-237">If a producer is in doubt, it can resend the same message, and Service Bus guarantees that only one copy will be processed.</span></span> <span data-ttu-id="6e54b-238">La détection en double vous empêche d’avoir à construire une plomberie d’infrastructure supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="6e54b-238">Duplicate detection frees you from  having to build additional infrastructure plumbing.</span></span>

<span data-ttu-id="6e54b-239">Deux autres fonctionnalités d’entreprise sont le partage et les sessions.</span><span class="sxs-lookup"><span data-stu-id="6e54b-239">Two more enterprise features are partitioning and sessions.</span></span> <span data-ttu-id="6e54b-240">Une file d’attente de service classique est gérée par un seul courtier de messages et stockée dans un seul magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="6e54b-240">A conventional Service Bus queue is handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="6e54b-241">Mais, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) répartit la file d’attente entre plusieurs courtiers de messages et les magasins de messages.</span><span class="sxs-lookup"><span data-stu-id="6e54b-241">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) spreads the queue across multiple message brokers and message stores.</span></span> <span data-ttu-id="6e54b-242">Le débit global n’est plus limité par les performances d’un courtier de messages ou d’un magasin de messagerie unique.</span><span class="sxs-lookup"><span data-stu-id="6e54b-242">The overall throughput is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="6e54b-243">Une panne temporaire d’un magasin de messagerie ne rend pas une file d’attente cloisonnée indisponible.</span><span class="sxs-lookup"><span data-stu-id="6e54b-243">A temporary outage of a messaging store doesn't render a partitioned queue unavailable.</span></span>

<span data-ttu-id="6e54b-244">[Les sessions d’autobus](https://codingcanvas.com/azure-service-bus-sessions/) de service offrent un moyen de messages liés au groupe.</span><span class="sxs-lookup"><span data-stu-id="6e54b-244">[Service Bus Sessions](https://codingcanvas.com/azure-service-bus-sessions/) provide a way to group-related messages.</span></span> <span data-ttu-id="6e54b-245">Imaginez un scénario de flux de travail où les messages doivent être traités ensemble et l’opération terminée à la fin.</span><span class="sxs-lookup"><span data-stu-id="6e54b-245">Imagine a workflow scenario where messages must be processed together and the operation completed at the end.</span></span> <span data-ttu-id="6e54b-246">Pour en profiter, les sessions doivent être explicitement activées pour la file d’attente et chaque message connexe doit contenir la même pièce d’identité de session.</span><span class="sxs-lookup"><span data-stu-id="6e54b-246">To take advantage, sessions must be explicitly enabled for the queue and each related messaged must contain the same session ID.</span></span>

<span data-ttu-id="6e54b-247">Cependant, il ya quelques mises en garde importantes: La taille des files d’attente De bus de service est limitée à 80 Go, ce qui est beaucoup plus petit que ce qui est disponible dans les files d’attente des magasins.</span><span class="sxs-lookup"><span data-stu-id="6e54b-247">However, there are some important caveats: Service Bus queues size is limited to 80 GB, which is much smaller than what's available from store queues.</span></span> <span data-ttu-id="6e54b-248">De plus, les files d’attente d’autobus de service entraînent un coût de base et des frais par opération.</span><span class="sxs-lookup"><span data-stu-id="6e54b-248">Additionally, Service Bus queues incur a base cost and charge per operation.</span></span>

<span data-ttu-id="6e54b-249">La figure 4-14 décrit l’architecture de haut niveau d’une file d’attente d’autobus de service.</span><span class="sxs-lookup"><span data-stu-id="6e54b-249">Figure 4-14 outlines the high-level architecture of a Service Bus queue.</span></span>

![File d’attente Service Bus](./media/service-bus-queue.png)

<span data-ttu-id="6e54b-251">**Figure 4-14**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-251">**Figure 4-14**.</span></span> <span data-ttu-id="6e54b-252">File d’attente Service Bus</span><span class="sxs-lookup"><span data-stu-id="6e54b-252">Service Bus queue</span></span>

<span data-ttu-id="6e54b-253">Dans le chiffre précédent, notez la relation point-à-point.</span><span class="sxs-lookup"><span data-stu-id="6e54b-253">In the previous figure, note the point-to-point relationship.</span></span> <span data-ttu-id="6e54b-254">Deux cas du même fournisseur sont enqueuing messages dans une file d’attente d’autobus de service unique.</span><span class="sxs-lookup"><span data-stu-id="6e54b-254">Two instances of the same provider are enqueuing messages into a single Service Bus queue.</span></span> <span data-ttu-id="6e54b-255">Chaque message est consommé par seulement un des trois cas de consommateurs sur la droite.</span><span class="sxs-lookup"><span data-stu-id="6e54b-255">Each message is consumed by only one of three consumer instances on the right.</span></span> <span data-ttu-id="6e54b-256">Ensuite, nous discutons de la façon de mettre en œuvre la messagerie où différents consommateurs peuvent tous être intéressés par le même message.</span><span class="sxs-lookup"><span data-stu-id="6e54b-256">Next, we discuss how to implement messaging where different consumers may all be interested the same message.</span></span>

## <a name="events"></a><span data-ttu-id="6e54b-257">Événements</span><span class="sxs-lookup"><span data-stu-id="6e54b-257">Events</span></span>

<span data-ttu-id="6e54b-258">La file d’attente de message est un moyen efficace de mettre en œuvre la communication où un producteur peut envoyer asnchronement un message à un consommateur.</span><span class="sxs-lookup"><span data-stu-id="6e54b-258">Message queuing is an effective way to implement communication where a producer can asynchronously send a consumer a message.</span></span> <span data-ttu-id="6e54b-259">Cependant, que se passe-t-il lorsque *de nombreux consommateurs différents* s’intéressent au même message?</span><span class="sxs-lookup"><span data-stu-id="6e54b-259">However, what happens when *many different consumers* are interested in the same message?</span></span> <span data-ttu-id="6e54b-260">Une file d’attente de messages dédiée pour chaque consommateur ne serait pas bien échelle et deviendrait difficile à gérer.</span><span class="sxs-lookup"><span data-stu-id="6e54b-260">A dedicated message queue for each consumer wouldn't scale well and would become difficult to manage.</span></span>

<span data-ttu-id="6e54b-261">Pour résoudre ce scénario, nous passons au troisième type d’interaction de message, *l’événement*.</span><span class="sxs-lookup"><span data-stu-id="6e54b-261">To address this scenario, we move to the third type of message interaction, the *event*.</span></span> <span data-ttu-id="6e54b-262">Un microservice annonce qu’une action a eu lieu.</span><span class="sxs-lookup"><span data-stu-id="6e54b-262">One microservice announces that an action had occurred.</span></span> <span data-ttu-id="6e54b-263">D’autres microservices, s’ils sont intéressés, réagissent à l’action ou à l’événement.</span><span class="sxs-lookup"><span data-stu-id="6e54b-263">Other microservices, if interested, react to the action, or event.</span></span>

<span data-ttu-id="6e54b-264">L’événementiel est un processus en deux étapes.</span><span class="sxs-lookup"><span data-stu-id="6e54b-264">Eventing is a two-step process.</span></span> <span data-ttu-id="6e54b-265">Pour un changement d’état donné, un microservice publie un événement à un courtier de messages, le rendant disponible à tout autre microservice intéressé.</span><span class="sxs-lookup"><span data-stu-id="6e54b-265">For a given state change, a microservice publishes an event to a message broker, making it available to any other interested microservice.</span></span> <span data-ttu-id="6e54b-266">Le microservice intéressé est avisé en s’abonnant à l’événement dans le courtier en messages.</span><span class="sxs-lookup"><span data-stu-id="6e54b-266">The interested microservice is notified by subscribing to the event in the message broker.</span></span> <span data-ttu-id="6e54b-267">Vous utilisez le modèle [Publier/Abonnez-vous](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) pour mettre en œuvre [la communication basée sur l’événement](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span><span class="sxs-lookup"><span data-stu-id="6e54b-267">You use the [Publish/Subscribe](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) pattern to implement [event-based communication](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span></span>

<span data-ttu-id="6e54b-268">La figure 4-15 montre un microservice de panier d’achats publiant un événement avec deux autres microservices qui s’y abonnent.</span><span class="sxs-lookup"><span data-stu-id="6e54b-268">Figure 4-15 shows a shopping basket microservice publishing an event with two other microservices subscribing to it.</span></span>

![Messagerie axée sur l’événement](./media/event-driven-messaging.png)

<span data-ttu-id="6e54b-270">**Figure 4-15**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-270">**Figure 4-15**.</span></span> <span data-ttu-id="6e54b-271">Messagerie axée sur l’événement</span><span class="sxs-lookup"><span data-stu-id="6e54b-271">Event-Driven messaging</span></span>

<span data-ttu-id="6e54b-272">Notez la composante *d’autobus événementiel* qui se trouve au milieu du canal de communication.</span><span class="sxs-lookup"><span data-stu-id="6e54b-272">Note the *event bus* component that sits in the middle of the communication channel.</span></span> <span data-ttu-id="6e54b-273">Il s’agit d’une classe personnalisée qui encapsule le courtier en message et le découple de l’application sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="6e54b-273">It's a custom class that encapsulates the message broker and decouples it from the underlying application.</span></span> <span data-ttu-id="6e54b-274">Les microservices de commande et d’inventaire exploitent indépendamment l’événement sans connaissance les uns des autres, ni le microservice de panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="6e54b-274">The ordering and inventory microservices independently operate the event with no knowledge of each other, nor the shopping basket microservice.</span></span> <span data-ttu-id="6e54b-275">Lorsque l’événement enregistré est publié dans l’autobus de l’événement, ils agissent sur elle.</span><span class="sxs-lookup"><span data-stu-id="6e54b-275">When the registered event is published to the event bus, they act upon it.</span></span>

<span data-ttu-id="6e54b-276">Avec l’événementiel, nous passons de la technologie de file d’attente à *des sujets*.</span><span class="sxs-lookup"><span data-stu-id="6e54b-276">With eventing, we move from queuing technology to *topics*.</span></span> <span data-ttu-id="6e54b-277">Un [sujet](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) est similaire à une file d’attente, mais prend en charge un modèle de messagerie unique à plusieurs.</span><span class="sxs-lookup"><span data-stu-id="6e54b-277">A [topic](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) is similar to a queue, but supports a one-to-many messaging pattern.</span></span> <span data-ttu-id="6e54b-278">Un microservice publie un message.</span><span class="sxs-lookup"><span data-stu-id="6e54b-278">One microservice publishes a message.</span></span> <span data-ttu-id="6e54b-279">Plusieurs microservices abonnés peuvent choisir de recevoir et d’agir sur ce message.</span><span class="sxs-lookup"><span data-stu-id="6e54b-279">Multiple subscribing microservices can choose to receive and act upon that message.</span></span> <span data-ttu-id="6e54b-280">La figure 4-16 montre une architecture de sujet.</span><span class="sxs-lookup"><span data-stu-id="6e54b-280">Figure 4-16 shows a topic architecture.</span></span>

![Architecture thématique](./media/topic-architecture.png)

<span data-ttu-id="6e54b-282">**Figure 4-16**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-282">**Figure 4-16**.</span></span> <span data-ttu-id="6e54b-283">Architecture thématique</span><span class="sxs-lookup"><span data-stu-id="6e54b-283">Topic architecture</span></span>

<span data-ttu-id="6e54b-284">Dans le chiffre précédent, les éditeurs envoient des messages sur le sujet.</span><span class="sxs-lookup"><span data-stu-id="6e54b-284">In the previous figure, publishers send messages to the topic.</span></span> <span data-ttu-id="6e54b-285">À la fin, les abonnés reçoivent des messages d’abonnements.</span><span class="sxs-lookup"><span data-stu-id="6e54b-285">At the end, subscribers receive messages from subscriptions.</span></span> <span data-ttu-id="6e54b-286">Au milieu, le sujet transmet les messages aux abonnements basés sur un ensemble de *règles,* indiquées dans des boîtes bleu foncé.</span><span class="sxs-lookup"><span data-stu-id="6e54b-286">In the middle, the topic forwards messages to subscriptions based on a set of *rules*, shown in dark blue boxes.</span></span> <span data-ttu-id="6e54b-287">Les règles agissent comme un filtre qui transmet des messages spécifiques à un abonnement.</span><span class="sxs-lookup"><span data-stu-id="6e54b-287">Rules act as a filter that forward specific messages to a subscription.</span></span> <span data-ttu-id="6e54b-288">Ici, un événement "CreateOrder" serait \#envoyé à \#l’abonnement 1 \#et l’abonnement 3, mais pas à l’abonnement 2.</span><span class="sxs-lookup"><span data-stu-id="6e54b-288">Here, a "CreateOrder" event would be sent to Subscription \#1 and Subscription \#3, but not to Subscription \#2.</span></span> <span data-ttu-id="6e54b-289">Un événement "OrderCompleted" serait \#envoyé à \#l’abonnement 2 et à l’abonnement 3.</span><span class="sxs-lookup"><span data-stu-id="6e54b-289">An "OrderCompleted" event would be sent to Subscription \#2 and Subscription \#3.</span></span>

<span data-ttu-id="6e54b-290">Le cloud Azure prend en charge deux services thématiques différents : Azure Service Bus Topics et Azure EventGrid.</span><span class="sxs-lookup"><span data-stu-id="6e54b-290">The Azure cloud supports two different topic services: Azure Service Bus Topics and Azure EventGrid.</span></span>

### <a name="azure-service-bus-topics"></a><span data-ttu-id="6e54b-291">Rubriques Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="6e54b-291">Azure Service Bus Topics</span></span>

<span data-ttu-id="6e54b-292">Assis au-dessus du même modèle de message négocié robuste des files d’attente Azure Service Bus sont [Azure Service Bus Topics](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span><span class="sxs-lookup"><span data-stu-id="6e54b-292">Sitting on top of the same robust brokered message model of Azure Service Bus queues are [Azure Service Bus Topics](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span></span> <span data-ttu-id="6e54b-293">Un sujet peut recevoir des messages de plusieurs éditeurs indépendants et envoyer des messages à jusqu’à 2 000 abonnés.</span><span class="sxs-lookup"><span data-stu-id="6e54b-293">A topic can receive messages from multiple independent publishers and send messages to up to 2,000 subscribers.</span></span> <span data-ttu-id="6e54b-294">Les abonnements peuvent être ajoutés ou supprimés dynamiquement au moment de l’exécution sans arrêter le système ou recréer le sujet.</span><span class="sxs-lookup"><span data-stu-id="6e54b-294">Subscriptions can be dynamically added or removed at runtime without stopping the system or recreating the topic.</span></span>

<span data-ttu-id="6e54b-295">De nombreuses fonctionnalités avancées des files d’attente Azure Service Bus sont également disponibles pour des sujets, y compris [la détection du double](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) et le support [transactionnel](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions).</span><span class="sxs-lookup"><span data-stu-id="6e54b-295">Many advanced features from Azure Service Bus queues are also available for topics, including [Duplicate Detection](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) and [Transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions).</span></span> <span data-ttu-id="6e54b-296">Par défaut, les sujets de Service Bus sont traités par un seul courtier de messages et stockés dans un seul magasin de messages.</span><span class="sxs-lookup"><span data-stu-id="6e54b-296">By default, Service Bus topics are handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="6e54b-297">Mais, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) échelles un sujet en le répartissant à travers de nombreux courtiers de messages et les magasins de messages.</span><span class="sxs-lookup"><span data-stu-id="6e54b-297">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) scales a topic by spreading it across many message brokers and message stores.</span></span>

<span data-ttu-id="6e54b-298">[La livraison de messages planifiée](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) identifie un message avec un temps spécifique pour le traitement.</span><span class="sxs-lookup"><span data-stu-id="6e54b-298">[Scheduled Message Delivery](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) tags a message with a specific time for processing.</span></span> <span data-ttu-id="6e54b-299">Le message n’apparaîtra pas dans le sujet avant cette date.</span><span class="sxs-lookup"><span data-stu-id="6e54b-299">The message won't appear in the topic before that time.</span></span> <span data-ttu-id="6e54b-300">[Le report de message](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) vous permet de reporter une récupération d’un message à une date ultérieure.</span><span class="sxs-lookup"><span data-stu-id="6e54b-300">[Message Deferral](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) enables you to defer a retrieval of a message to a later time.</span></span> <span data-ttu-id="6e54b-301">Les deux sont couramment utilisés dans les scénarios de traitement des flux de travail où les opérations sont traitées dans un ordre particulier.</span><span class="sxs-lookup"><span data-stu-id="6e54b-301">Both are commonly used in workflow processing scenarios where operations are processed in a particular order.</span></span> <span data-ttu-id="6e54b-302">Vous pouvez reporter le traitement des messages reçus jusqu’à ce que les travaux antérieurs soient terminés.</span><span class="sxs-lookup"><span data-stu-id="6e54b-302">You can postpone processing of received messages until prior work has been completed.</span></span>

<span data-ttu-id="6e54b-303">Les sujets de Service Bus sont une technologie robuste et éprouvée permettant de publier/s’abonner à la communication dans vos systèmes cloud-natives.</span><span class="sxs-lookup"><span data-stu-id="6e54b-303">Service Bus topics are a robust and proven technology for enabling publish/subscribe communication in your cloud-native systems.</span></span>

### <a name="azure-event-grid"></a><span data-ttu-id="6e54b-304">Azure Event Grid</span><span class="sxs-lookup"><span data-stu-id="6e54b-304">Azure Event Grid</span></span>

<span data-ttu-id="6e54b-305">Alors qu’Azure Service Bus est un courtier de messagerie éprouvé au combat avec un ensemble complet de fonctionnalités d’entreprise, [Azure Event Grid](https://docs.microsoft.com/azure/event-grid/overview) est le nouveau gamin sur le bloc.</span><span class="sxs-lookup"><span data-stu-id="6e54b-305">While Azure Service Bus is a battle-tested messaging broker with a full set of enterprise features, [Azure Event Grid](https://docs.microsoft.com/azure/event-grid/overview) is the new kid on the block.</span></span>

<span data-ttu-id="6e54b-306">À première vue, Event Grid peut ressembler à un autre système de messagerie thématique.</span><span class="sxs-lookup"><span data-stu-id="6e54b-306">At first glance, Event Grid may look like just another topic-based messaging system.</span></span> <span data-ttu-id="6e54b-307">Cependant, c’est différent à bien des égards.</span><span class="sxs-lookup"><span data-stu-id="6e54b-307">However, it's different in many ways.</span></span> <span data-ttu-id="6e54b-308">Axé sur les charges de travail axées sur les événements, il permet le traitement d’événements en temps réel, une intégration Azure profonde et une plate-forme ouverte - le tout sur l’infrastructure sans serveur.</span><span class="sxs-lookup"><span data-stu-id="6e54b-308">Focused on event-driven workloads, it enables real-time event processing, deep Azure integration, and an open-platform - all on serverless infrastructure.</span></span> <span data-ttu-id="6e54b-309">Il est conçu pour les applications contemporaines natives du cloud et sans serveur</span><span class="sxs-lookup"><span data-stu-id="6e54b-309">It's designed for contemporary cloud-native and serverless applications</span></span>

<span data-ttu-id="6e54b-310">En tant *qu’avion de fond*centralisé, ou tuyau, Event Grid réagit aux événements à l’intérieur des ressources Azure et de vos propres services.</span><span class="sxs-lookup"><span data-stu-id="6e54b-310">As a centralized *eventing backplane*, or pipe, Event Grid reacts to events inside Azure resources and from your own services.</span></span>

<span data-ttu-id="6e54b-311">Les notifications d’événements sont publiées sur un sujet de grille d’événements, qui, à son tour, achemine chaque événement vers un abonnement.</span><span class="sxs-lookup"><span data-stu-id="6e54b-311">Event notifications are published to an Event Grid Topic, which, in turn, routes each event to a subscription.</span></span> <span data-ttu-id="6e54b-312">Les abonnés cartographient les abonnements et consomment les événements.</span><span class="sxs-lookup"><span data-stu-id="6e54b-312">Subscribers map to subscriptions and consume the events.</span></span> <span data-ttu-id="6e54b-313">Comme Service Bus, Event Grid prend en charge un *modèle d’abonné filtré* où un abonnement fixe la règle des événements qu’il souhaite recevoir.</span><span class="sxs-lookup"><span data-stu-id="6e54b-313">Like Service Bus, Event Grid supports a *filtered subscriber model* where a subscription sets rule for the events it wishes to receive.</span></span> <span data-ttu-id="6e54b-314">Event Grid offre un débit rapide avec une garantie de 10 millions d’événements par seconde permettant une livraison en temps quasi réel - beaucoup plus que ce que Azure Service Bus peut générer.</span><span class="sxs-lookup"><span data-stu-id="6e54b-314">Event Grid provides fast throughput with a guarantee of 10 million events per second enabling near real-time delivery - far more than what Azure Service Bus can generate.</span></span>

<span data-ttu-id="6e54b-315">Un point faible pour Event Grid est son intégration profonde dans le tissu de l’infrastructure Azure.</span><span class="sxs-lookup"><span data-stu-id="6e54b-315">A sweet spot for Event Grid is its deep integration into the fabric of Azure infrastructure.</span></span> <span data-ttu-id="6e54b-316">Une ressource Azure, comme Cosmos DB, peut publier des événements intégrés directement à d’autres ressources Azure intéressées - sans avoir besoin de code personnalisé.</span><span class="sxs-lookup"><span data-stu-id="6e54b-316">An Azure resource, such as Cosmos DB, can publish built-in events directly to other interested Azure resources - without the need for custom code.</span></span> <span data-ttu-id="6e54b-317">Event Grid peut publier des événements à partir d’un abonnement Azure, d’un groupe de ressources ou d’un service, ce qui donne aux développeurs un contrôle limité sur le cycle de vie des ressources cloud.</span><span class="sxs-lookup"><span data-stu-id="6e54b-317">Event Grid can publish events from an Azure Subscription, Resource Group, or Service, giving developers fine-grained control over the lifecycle of cloud resources.</span></span> <span data-ttu-id="6e54b-318">Cependant, Event Grid ne se limite pas à Azure.</span><span class="sxs-lookup"><span data-stu-id="6e54b-318">However, Event Grid isn't limited to Azure.</span></span> <span data-ttu-id="6e54b-319">Il s’agit d’une plate-forme ouverte qui peut consommer des événements HTTP personnalisés publiés à partir d’applications ou de services tiers et d’itinéraires à des abonnés externes.</span><span class="sxs-lookup"><span data-stu-id="6e54b-319">It's an open platform that can consume custom HTTP events published from applications or third-party services and route events to external subscribers.</span></span>

<span data-ttu-id="6e54b-320">Lors de la publication et de l’abonnement à des événements autochtones à partir de ressources Azure, aucun codage n’est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="6e54b-320">When publishing and subscribing to native events from Azure resources, no coding is required.</span></span> <span data-ttu-id="6e54b-321">Avec une configuration simple, vous pouvez intégrer des événements d’une ressource Azure à une autre en tirant parti de la plomberie intégrée pour les sujets et les abonnements.</span><span class="sxs-lookup"><span data-stu-id="6e54b-321">With simple configuration, you can integrate events from one Azure resource to another leveraging built-in plumbing for Topics and Subscriptions.</span></span> <span data-ttu-id="6e54b-322">La figure 4-17 montre l’anatomie de Event Grid.</span><span class="sxs-lookup"><span data-stu-id="6e54b-322">Figure 4-17 shows the anatomy of Event Grid.</span></span>

![Anatomie de grille d’événements](./media/event-grid-anatomy.png)

<span data-ttu-id="6e54b-324">**Figure 4-17**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-324">**Figure 4-17**.</span></span> <span data-ttu-id="6e54b-325">Anatomie de grille d’événements</span><span class="sxs-lookup"><span data-stu-id="6e54b-325">Event Grid anatomy</span></span>

<span data-ttu-id="6e54b-326">Une différence majeure entre EventGrid et Service Bus est le *modèle d’échange de messages*sous-jacent .</span><span class="sxs-lookup"><span data-stu-id="6e54b-326">A major difference between EventGrid and Service Bus is the underlying *message exchange pattern*.</span></span>

<span data-ttu-id="6e54b-327">Service Bus met en œuvre un modèle de *traction* de style plus ancien dans lequel l’abonné en aval sonde activement l’abonnement au sujet pour de nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="6e54b-327">Service Bus implements an older style *pull model* in which the downstream subscriber actively polls the topic subscription for new messages.</span></span> <span data-ttu-id="6e54b-328">À la hausse, cette approche donne à l’abonné le plein contrôle du rythme auquel il traite les messages.</span><span class="sxs-lookup"><span data-stu-id="6e54b-328">On the upside, this approach gives the subscriber full control of the pace at which it processes messages.</span></span> <span data-ttu-id="6e54b-329">Il contrôle le nombre de messages à traiter à un moment donné.</span><span class="sxs-lookup"><span data-stu-id="6e54b-329">It controls when and how many messages to process at any given time.</span></span> <span data-ttu-id="6e54b-330">Les messages non lus restent dans l’abonnement jusqu’à ce qu’ils soient traités.</span><span class="sxs-lookup"><span data-stu-id="6e54b-330">Unread messages remain in the subscription until processed.</span></span> <span data-ttu-id="6e54b-331">Une lacune importante est la latence entre le moment où l’événement est généré et l’opération de vote qui tire ce message à l’abonné pour le traitement.</span><span class="sxs-lookup"><span data-stu-id="6e54b-331">A significant shortcoming is the latency between the time the event is generated and the polling operation that pulls that message to the subscriber for processing.</span></span> <span data-ttu-id="6e54b-332">En outre, les frais généraux des sondages constants pour le prochain événement consomme des ressources et de l’argent.</span><span class="sxs-lookup"><span data-stu-id="6e54b-332">Also, the overhead of constant polling for the next event consumes resources and money.</span></span>

<span data-ttu-id="6e54b-333">EventGrid, cependant, est différent.</span><span class="sxs-lookup"><span data-stu-id="6e54b-333">EventGrid, however, is different.</span></span> <span data-ttu-id="6e54b-334">Il met en œuvre un *modèle de poussée* dans lequel les événements sont envoyés aux EventHandlers tels qu’ils sont reçus, donnant une livraison d’événements en temps quasi réel.</span><span class="sxs-lookup"><span data-stu-id="6e54b-334">It implements a *push model* in which events are sent to the EventHandlers as received, giving near real-time event delivery.</span></span> <span data-ttu-id="6e54b-335">Il réduit également les coûts que le service est déclenché que lorsqu’il est nécessaire de consommer un événement - pas continuellement comme avec le sondage.</span><span class="sxs-lookup"><span data-stu-id="6e54b-335">It also reduces cost as the service is triggered only when it's needed to consume an event – not continually as with polling.</span></span> <span data-ttu-id="6e54b-336">Cela dit, un gestionnaire d’événements doit gérer la charge entrante et fournir des mécanismes de limitation pour se protéger contre le débordement.</span><span class="sxs-lookup"><span data-stu-id="6e54b-336">That said, an event handler must handle the incoming load and provide throttling mechanisms to protect itself from becoming overwhelmed.</span></span> <span data-ttu-id="6e54b-337">De nombreux services Azure qui consomment ces événements, tels que Azure Functions et Logic Apps fournissent des capacités automatiques d’autoscalage pour gérer des charges accrues.</span><span class="sxs-lookup"><span data-stu-id="6e54b-337">Many Azure services that consume these events, such as Azure Functions and Logic Apps provide automatic autoscaling capabilities to handle increased loads.</span></span>  

<span data-ttu-id="6e54b-338">Event Grid est un service cloud sans serveur entièrement géré.</span><span class="sxs-lookup"><span data-stu-id="6e54b-338">Event Grid is a fully managed serverless cloud service.</span></span> <span data-ttu-id="6e54b-339">Il évolue dynamiquement en fonction de votre trafic et vous facture uniquement pour votre utilisation réelle, et non la capacité pré-achetée.</span><span class="sxs-lookup"><span data-stu-id="6e54b-339">It dynamically scales based on your traffic and charges you only for your actual usage, not pre-purchased capacity.</span></span> <span data-ttu-id="6e54b-340">Les 100 000 premières opérations par mois sont gratuites , les opérations étant définies comme l’entrée d’événements (notifications d’événements entrants), les tentatives de livraison d’abonnement, les appels de gestion et le filtrage par sujet.</span><span class="sxs-lookup"><span data-stu-id="6e54b-340">The first 100,000 operations per month are free – operations being defined as event ingress (incoming event notifications), subscription delivery attempts, management calls, and filtering by subject.</span></span> <span data-ttu-id="6e54b-341">Avec une disponibilité de 99,99 %, EventGrid garantit la livraison d’un événement dans un délai de 24 heures, avec des fonctionnalités intégrées de retentiment pour une livraison infructueuse.</span><span class="sxs-lookup"><span data-stu-id="6e54b-341">With 99.99% availability, EventGrid guarantees the delivery of an event within a 24-hour period, with built-in retry functionality for unsuccessful delivery.</span></span> <span data-ttu-id="6e54b-342">Les messages non livrés peuvent être déplacés vers une file d’attente de « lettre morte » pour être résolus.</span><span class="sxs-lookup"><span data-stu-id="6e54b-342">Undelivered messages can be moved to a "dead-letter" queue for resolution.</span></span>  <span data-ttu-id="6e54b-343">Contrairement à Azure Service Bus, Event Grid est à l’écoute pour des performances rapides et ne prend pas en charge les fonctionnalités comme la messagerie commandée, les transactions et les sessions.</span><span class="sxs-lookup"><span data-stu-id="6e54b-343">Unlike Azure Service Bus, Event Grid is tuned for fast performance and doesn't support features like ordered messaging, transactions, and sessions.</span></span>

### <a name="streaming-messages-in-the-azure-cloud"></a><span data-ttu-id="6e54b-344">Messages en streaming dans le cloud Azure</span><span class="sxs-lookup"><span data-stu-id="6e54b-344">Streaming messages in the Azure cloud</span></span>

<span data-ttu-id="6e54b-345">Azure Service Bus et Event Grid fournissent un excellent soutien pour les applications qui exposent des événements simples et discrets comme un nouveau document a été inséré dans un Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="6e54b-345">Azure Service Bus and Event Grid provide great support for applications that expose single, discrete events like a new document has been inserted into a Cosmos DB.</span></span> <span data-ttu-id="6e54b-346">Mais, que se passe-t-il si votre système cloud-native a besoin de traiter un *flux d’événements connexes*?</span><span class="sxs-lookup"><span data-stu-id="6e54b-346">But, what if your cloud-native system needs to process a *stream of related events*?</span></span> <span data-ttu-id="6e54b-347">[Les flux d’événements](https://docs.microsoft.com/archive/msdn-magazine/2015/february/microsoft-azure-the-rise-of-event-stream-oriented-systems) sont plus complexes.</span><span class="sxs-lookup"><span data-stu-id="6e54b-347">[Event streams](https://docs.microsoft.com/archive/msdn-magazine/2015/february/microsoft-azure-the-rise-of-event-stream-oriented-systems) are more complex.</span></span> <span data-ttu-id="6e54b-348">Ils sont généralement ordonnés dans le temps, interdépendants, et doivent être traités en tant que groupe.</span><span class="sxs-lookup"><span data-stu-id="6e54b-348">They're typically time-ordered, interrelated, and must be processed as a group.</span></span>

<span data-ttu-id="6e54b-349">[Azure Event Hub](https://azure.microsoft.com/services/event-hubs/) est une plateforme de streaming de données et un service d’ingestion d’événements qui collecte, transforme et stocke des événements.</span><span class="sxs-lookup"><span data-stu-id="6e54b-349">[Azure Event Hub](https://azure.microsoft.com/services/event-hubs/) is a data streaming platform and event ingestion service that collects, transforms, and stores events.</span></span> <span data-ttu-id="6e54b-350">Il est affiné pour capturer des données en streaming, telles que les notifications d’événements continus émises par un contexte de télémétrie.</span><span class="sxs-lookup"><span data-stu-id="6e54b-350">It's fine-tuned to capture streaming data, such as continuous event notifications emitted from a telemetry context.</span></span> <span data-ttu-id="6e54b-351">Le service est très évolutif et peut stocker et [traiter des millions d’événements par seconde.](https://docs.microsoft.com/azure/event-hubs/event-hubs-about)</span><span class="sxs-lookup"><span data-stu-id="6e54b-351">The service is highly scalable and can store and [process millions of events per second](https://docs.microsoft.com/azure/event-hubs/event-hubs-about).</span></span> <span data-ttu-id="6e54b-352">Présenté dans la figure 4-18, il s’agit souvent d’une porte d’entrée pour un pipeline d’événements, découplant le flux d’ingérer de la consommation d’événements.</span><span class="sxs-lookup"><span data-stu-id="6e54b-352">Shown in Figure 4-18, it's often a front door for an event pipeline, decoupling ingest stream from event consumption.</span></span>

![Azure Event Hub](./media/azure-event-hub.png)

<span data-ttu-id="6e54b-354">**Figure 4-18**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-354">**Figure 4-18**.</span></span> <span data-ttu-id="6e54b-355">Azure Event Hub</span><span class="sxs-lookup"><span data-stu-id="6e54b-355">Azure Event Hub</span></span>

<span data-ttu-id="6e54b-356">Event Hub prend en charge une faible latence et une rétention de temps configurable.</span><span class="sxs-lookup"><span data-stu-id="6e54b-356">Event Hub supports low latency and configurable time retention.</span></span> <span data-ttu-id="6e54b-357">Contrairement aux files d’attente et aux sujets, Les centres d’événements conservent les données de l’événement après avoir été lues par un consommateur.</span><span class="sxs-lookup"><span data-stu-id="6e54b-357">Unlike queues and topics, Event Hubs keep event data after it's been read by a consumer.</span></span> <span data-ttu-id="6e54b-358">Cette fonctionnalité permet à d’autres services d’analyse de données, internes et externes, de rejouer les données pour une analyse plus approfondie.</span><span class="sxs-lookup"><span data-stu-id="6e54b-358">This feature enables other data analytic services, both internal and external, to replay the data for further analysis.</span></span> <span data-ttu-id="6e54b-359">Les événements stockés dans le hub d’événements ne sont supprimés qu’à l’expiration de la période de rétention, qui est un jour par défaut, mais configurable.</span><span class="sxs-lookup"><span data-stu-id="6e54b-359">Events stored in event hub are only deleted upon expiration of the retention period, which is one day by default, but configurable.</span></span>

<span data-ttu-id="6e54b-360">Event Hub prend en charge les protocoles communs de publication d’événements, y compris HTTPS et AMQP.</span><span class="sxs-lookup"><span data-stu-id="6e54b-360">Event Hub supports common event publishing protocols including HTTPS and AMQP.</span></span> <span data-ttu-id="6e54b-361">Il soutient également Kafka 1.0.</span><span class="sxs-lookup"><span data-stu-id="6e54b-361">It also supports Kafka 1.0.</span></span> <span data-ttu-id="6e54b-362">[Les applications Kafka existantes peuvent communiquer avec Event Hub](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) en utilisant le protocole Kafka offrant une alternative à la gestion de grands clusters Kafka.</span><span class="sxs-lookup"><span data-stu-id="6e54b-362">[Existing Kafka applications can communicate with Event Hub](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) using the Kafka protocol providing an alternative to managing large Kafka clusters.</span></span> <span data-ttu-id="6e54b-363">De nombreux systèmes open-source cloud-natives embrassent Kafka.</span><span class="sxs-lookup"><span data-stu-id="6e54b-363">Many open-source cloud-native systems embrace Kafka.</span></span>

<span data-ttu-id="6e54b-364">Event Hubs implémente le flux de messages à travers un [modèle de consommation divisé](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) dans lequel chaque consommateur ne lit qu’un sous-ensemble spécifique, ou partition, du flux de messages.</span><span class="sxs-lookup"><span data-stu-id="6e54b-364">Event Hubs implements message streaming through a [partitioned consumer model](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) in which each consumer only reads a specific subset, or partition, of the message stream.</span></span> <span data-ttu-id="6e54b-365">Ce modèle permet de disposer d'une échelle horizontale considérable pour le traitement des événements, et offre d'autres fonctionnalités axées sur le flux, qui ne sont pas disponibles dans les rubriques et les files d'attente.</span><span class="sxs-lookup"><span data-stu-id="6e54b-365">This pattern enables tremendous horizontal scale for event processing and provides other stream-focused features that are unavailable in queues and topics.</span></span> <span data-ttu-id="6e54b-366">Une partition est une séquence ordonnée d’événements qui est conservée dans un concentrateur d’événements.</span><span class="sxs-lookup"><span data-stu-id="6e54b-366">A partition is an ordered sequence of events that is held in an event hub.</span></span> <span data-ttu-id="6e54b-367">À mesure que de nouveaux événements arrivent, ils sont ajoutés à la fin de cette séquence.</span><span class="sxs-lookup"><span data-stu-id="6e54b-367">As newer events arrive, they're added to the end of this sequence.</span></span><span data-ttu-id="6e54b-368">La figure 4-19 montre le partage dans un hub d’événements.</span><span class="sxs-lookup"><span data-stu-id="6e54b-368"> Figure 4-19 shows partitioning in an Event Hub.</span></span>

![Partitionnement de Event Hub](./media/event-hub-partitioning.png)

<span data-ttu-id="6e54b-370">**Figure 4-19**.</span><span class="sxs-lookup"><span data-stu-id="6e54b-370">**Figure 4-19**.</span></span> <span data-ttu-id="6e54b-371">Partitionnement de Event Hub</span><span class="sxs-lookup"><span data-stu-id="6e54b-371">Event Hub partitioning</span></span>

<span data-ttu-id="6e54b-372">Au lieu de lire à partir de la même ressource, chaque groupe de consommateurs lit sur un sous-ensemble, ou cloison, du flux de messages.</span><span class="sxs-lookup"><span data-stu-id="6e54b-372">Instead of reading from the same resource, each consumer group reads across a subset, or partition, of the message stream.</span></span>

<span data-ttu-id="6e54b-373">Pour les applications cloud-native qui doivent diffuser un grand nombre d’événements, Azure Event Hub peut être une solution robuste et abordable.</span><span class="sxs-lookup"><span data-stu-id="6e54b-373">For cloud-native applications that must stream large numbers of events, Azure Event Hub can be a robust and affordable solution.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="6e54b-374">[Suivant précédent](front-end-communication.md)
>[Next](grpc.md)</span><span class="sxs-lookup"><span data-stu-id="6e54b-374">[Previous](front-end-communication.md)
[Next](grpc.md)</span></span>

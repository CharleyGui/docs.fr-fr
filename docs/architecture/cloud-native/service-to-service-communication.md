---
title: Communication de service à service
description: Découvrez comment les microservices dorsaux Cloud-natives communiquent avec d’autres microservices back-end.
author: robvet
ms.date: 09/09/2019
ms.openlocfilehash: e9f27309fd6b03830ab3098d0fb08a7ecf5c0eaa
ms.sourcegitcommit: 56f1d1203d0075a461a10a301459d3aa452f4f47
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/24/2019
ms.locfileid: "71214390"
---
# <a name="service-to-service-communication"></a><span data-ttu-id="d1444-103">Communication de service à service</span><span class="sxs-lookup"><span data-stu-id="d1444-103">Service-to-service communication</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="d1444-104">En passant par le client frontal, nous adressons maintenant les microservices back-end à communiquer entre eux.</span><span class="sxs-lookup"><span data-stu-id="d1444-104">Moving from the front-end client, we now address back-end microservices communicate with each other.</span></span>

<span data-ttu-id="d1444-105">Lors de la construction d’une application Cloud native, vous souhaiterez être sensible à la façon dont les services principaux communiquent entre eux.</span><span class="sxs-lookup"><span data-stu-id="d1444-105">When constructing a cloud-native application, you'll want to be sensitive to how back-end services communicate with each other.</span></span> <span data-ttu-id="d1444-106">Dans l’idéal, la communication entre les services est moins efficace.</span><span class="sxs-lookup"><span data-stu-id="d1444-106">Ideally, the less inter-service communication, the better.</span></span> <span data-ttu-id="d1444-107">Toutefois, l’évitement n’est pas toujours possible, car les services principaux s’appuient souvent sur un autre pour effectuer une opération.</span><span class="sxs-lookup"><span data-stu-id="d1444-107">However, avoidance isn't always possible as back-end services often rely on one another to complete an operation.</span></span>

<span data-ttu-id="d1444-108">Il existe plusieurs approches largement acceptées pour implémenter la communication entre les services.</span><span class="sxs-lookup"><span data-stu-id="d1444-108">There are several widely accepted approaches to implementing cross-service communication.</span></span> <span data-ttu-id="d1444-109">Le *type d’interaction de communication* détermine souvent la meilleure approche.</span><span class="sxs-lookup"><span data-stu-id="d1444-109">The *type of communication interaction* will often determine the best approach.</span></span>

<span data-ttu-id="d1444-110">Tenez compte des types d’interaction suivants :</span><span class="sxs-lookup"><span data-stu-id="d1444-110">Consider the following interaction types:</span></span>

- <span data-ttu-id="d1444-111">*Requête* : lorsqu’un microservice appelant requiert une réponse d’un microservice appelé, par exemple « Bonjour, je me donne les informations de l’acheteur pour un ID client donné ».</span><span class="sxs-lookup"><span data-stu-id="d1444-111">*Query* – when a calling microservice requires a response from a called microservice, such as, "Hey, give me the buyer information for a given customer Id."</span></span>

- <span data-ttu-id="d1444-112">*Commande* : lorsque le microservice appelant a besoin d’un autre microservice pour exécuter une action, mais ne nécessite pas de réponse, par exemple « Bonjour, expédiez cette commande ».</span><span class="sxs-lookup"><span data-stu-id="d1444-112">*Command* – when the calling microservice needs another microservice to execute an action but doesn't require a response, such as, "Hey, just ship this order."</span></span>

- <span data-ttu-id="d1444-113">*Événement* : lorsqu’un microservice, appelé serveur de publication, déclenche un événement indiquant que l’État a changé ou qu’une action a eu lieu.</span><span class="sxs-lookup"><span data-stu-id="d1444-113">*Event* – when a microservice, called the publisher, raises an event that state has changed or an action has occurred.</span></span> <span data-ttu-id="d1444-114">D’autres microservices, appelés abonnés, peuvent réagir à l’événement de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="d1444-114">Other microservices, called subscribers, who are interested, can react to the event appropriately.</span></span> <span data-ttu-id="d1444-115">Le serveur de publication et les abonnés ne sont pas conscients l’un de l’autre.</span><span class="sxs-lookup"><span data-stu-id="d1444-115">The publisher and the subscribers aren't aware of each other.</span></span>

<span data-ttu-id="d1444-116">Les systèmes de microservices utilisent généralement une combinaison de ces types d’interaction lors de l’exécution d’opérations nécessitant une interaction entre les services.</span><span class="sxs-lookup"><span data-stu-id="d1444-116">Microservice systems typically use a combination of these interaction types when executing operations that require cross-service interaction.</span></span> <span data-ttu-id="d1444-117">Jetons un coup d’œil à chacun et à la façon dont vous pouvez les implémenter.</span><span class="sxs-lookup"><span data-stu-id="d1444-117">Let's take a close look at each and how you might implement them.</span></span>

## <a name="queries"></a><span data-ttu-id="d1444-118">Requêtes</span><span class="sxs-lookup"><span data-stu-id="d1444-118">Queries</span></span>

<span data-ttu-id="d1444-119">Bien souvent, un microservice peut avoir besoin d' *interroger* un autre, ce qui nécessite une réponse immédiate pour effectuer une opération.</span><span class="sxs-lookup"><span data-stu-id="d1444-119">Many times, one microservice might need to *query* another, requiring an immediate response to complete an operation.</span></span> <span data-ttu-id="d1444-120">Un microservice de panier d’achat peut nécessiter des informations sur le produit et un prix pour ajouter un article à son panier.</span><span class="sxs-lookup"><span data-stu-id="d1444-120">A shopping basket microservice may need product information and a price to add an item to its basket.</span></span> <span data-ttu-id="d1444-121">Il existe plusieurs approches pour implémenter des opérations de requête.</span><span class="sxs-lookup"><span data-stu-id="d1444-121">There are a number of approaches for implementing query operations.</span></span>

### <a name="requestresponse-messaging"></a><span data-ttu-id="d1444-122">Messagerie demande/réponse</span><span class="sxs-lookup"><span data-stu-id="d1444-122">Request/Response Messaging</span></span>

<span data-ttu-id="d1444-123">L’une des options d’implémentation de ce scénario est que le microservice appelant principal effectue des requêtes HTTP directes aux microservices qu’il doit interroger, comme illustré à la figure 4-8.</span><span class="sxs-lookup"><span data-stu-id="d1444-123">One option for implementing this scenario is for the calling back-end microservice to make direct HTTP requests to the microservices it needs to query, shown in Figure 4-8.</span></span>

![Communication HTTP directe](./media/direct-http-communication.png)

<span data-ttu-id="d1444-125">**Figure 4-8**.</span><span class="sxs-lookup"><span data-stu-id="d1444-125">**Figure 4-8**.</span></span> <span data-ttu-id="d1444-126">Communication HTTP directe</span><span class="sxs-lookup"><span data-stu-id="d1444-126">Direct HTTP communication</span></span>

<span data-ttu-id="d1444-127">Bien que les appels HTTP directs entre les microservices soient relativement simples à implémenter, il convient de veiller à réduire cette pratique.</span><span class="sxs-lookup"><span data-stu-id="d1444-127">While direct HTTP calls between microservices are relatively simple to implement, care should be taken to minimize this practice.</span></span> <span data-ttu-id="d1444-128">Pour démarrer, ces appels sont toujours *synchrones* et bloquent l’opération jusqu’à ce qu’un résultat soit retourné ou que la demande arrive à expiration.</span><span class="sxs-lookup"><span data-stu-id="d1444-128">To start, these calls are always *synchronous* and will block the operation until a result is returned or the request times outs.</span></span> <span data-ttu-id="d1444-129">Ce qui était une fois autonome, les services indépendants, capables d’évoluer indépendamment et de le déployer fréquemment, sont désormais couplés entre eux.</span><span class="sxs-lookup"><span data-stu-id="d1444-129">What were once self-contained, independent services, able to evolve independently and deploy frequently, now become coupled to each other.</span></span> <span data-ttu-id="d1444-130">En ce qui concerne l’augmentation des microservices, leurs avantages architecturaux diminuent.</span><span class="sxs-lookup"><span data-stu-id="d1444-130">As coupling among microservices increase, their architectural benefits diminish.</span></span>

<span data-ttu-id="d1444-131">L’exécution d’une requête peu fréquente qui effectue un appel HTTP unique vers un autre microservice peut être acceptable pour certains systèmes.</span><span class="sxs-lookup"><span data-stu-id="d1444-131">Executing an infrequent request that makes a single direct HTTP call to another microservice might be acceptable for some systems.</span></span> <span data-ttu-id="d1444-132">Toutefois, les appels de volume élevé qui appellent des appels HTTP directs à plusieurs microservices ne sont pas conseillés.</span><span class="sxs-lookup"><span data-stu-id="d1444-132">However, high-volume calls that invoke direct HTTP calls to multiple microservices aren't advisable.</span></span> <span data-ttu-id="d1444-133">Ils peuvent augmenter la latence et avoir un impact négatif sur les performances, l’évolutivité et la disponibilité de votre système.</span><span class="sxs-lookup"><span data-stu-id="d1444-133">They can increase latency and negatively impact the performance, scalability, and availability of your system.</span></span> <span data-ttu-id="d1444-134">Pire encore, une longue série de communications HTTP directes peut entraîner des chaînes complexes et complexes d’appels de microservices synchrones, comme illustré à la figure 4-9 :</span><span class="sxs-lookup"><span data-stu-id="d1444-134">Even worse, a long series of direct HTTP communication can lead to deep and complex chains of synchronous microservices calls, shown in Figure 4-9:</span></span>

![Chaînage des requêtes HTTP](./media/chaining-http-queries.png)

<span data-ttu-id="d1444-136">**Figure 4-9**.</span><span class="sxs-lookup"><span data-stu-id="d1444-136">**Figure 4-9**.</span></span> <span data-ttu-id="d1444-137">Chaînage des requêtes HTTP</span><span class="sxs-lookup"><span data-stu-id="d1444-137">Chaining HTTP queries</span></span>

<span data-ttu-id="d1444-138">Vous pouvez certainement imaginer le risque dans la conception présentée dans l’image précédente.</span><span class="sxs-lookup"><span data-stu-id="d1444-138">You can certainly imagine the risk in the design shown in the previous image.</span></span> <span data-ttu-id="d1444-139">Que se passe- \#t-il si l’étape 3 échoue ?</span><span class="sxs-lookup"><span data-stu-id="d1444-139">What happens if Step \#3 fails?</span></span> <span data-ttu-id="d1444-140">Ou l' \#étape 8 échoue-t-elle ?</span><span class="sxs-lookup"><span data-stu-id="d1444-140">Or Step \#8 fails?</span></span> <span data-ttu-id="d1444-141">Comment voulez-vous récupérer ?</span><span class="sxs-lookup"><span data-stu-id="d1444-141">How do you recover?</span></span> <span data-ttu-id="d1444-142">Que se passe \#-t-il si l’étape 6 est lente parce que le service sous-jacent est occupé ?</span><span class="sxs-lookup"><span data-stu-id="d1444-142">What if Step \#6 is slow because the underlying service is busy?</span></span> <span data-ttu-id="d1444-143">Comment continuer ?</span><span class="sxs-lookup"><span data-stu-id="d1444-143">How do you continue?</span></span> <span data-ttu-id="d1444-144">Même si tout fonctionne correctement, pensez à la latence de cet appel, qui correspond à la somme de la latence de chaque étape.</span><span class="sxs-lookup"><span data-stu-id="d1444-144">Even if all works correctly, think of the latency this call would incur, which is the sum of the latency of each step.</span></span>

<span data-ttu-id="d1444-145">Le grand degré de couplage dans l’image précédente suggère que les services n’ont pas été modélisés de manière optimale.</span><span class="sxs-lookup"><span data-stu-id="d1444-145">The large degree of coupling in the previous image suggests the services weren't optimally modeled.</span></span> <span data-ttu-id="d1444-146">Il appartient l’équipe à revisiter sa conception.</span><span class="sxs-lookup"><span data-stu-id="d1444-146">It would behoove the team to revisit their design.</span></span>

### <a name="materialized-view-pattern"></a><span data-ttu-id="d1444-147">Modèle de vue matérialisée</span><span class="sxs-lookup"><span data-stu-id="d1444-147">Materialized View pattern</span></span>

<span data-ttu-id="d1444-148">Une option courante pour supprimer le couplage de microservices est le [modèle de vue matérialisée](https://docs.microsoft.com/azure/architecture/patterns/materialized-view).</span><span class="sxs-lookup"><span data-stu-id="d1444-148">A popular option for removing microservice coupling is the [Materialized View pattern](https://docs.microsoft.com/azure/architecture/patterns/materialized-view).</span></span> <span data-ttu-id="d1444-149">Avec ce modèle, un microservice stocke sa propre copie locale dénormalisée des données détenues par d’autres services.</span><span class="sxs-lookup"><span data-stu-id="d1444-149">With this pattern, a microservice stores its own local, denormalized copy of data that's owned by other services.</span></span> <span data-ttu-id="d1444-150">Au lieu que le microservice du panier d’achat interroge le catalogue de produits et les microservices de tarification, il gère sa propre copie locale de ces données.</span><span class="sxs-lookup"><span data-stu-id="d1444-150">Instead of the Shopping Basket microservice querying the Product Catalog and Pricing microservices, it maintains its own local copy of that data.</span></span> <span data-ttu-id="d1444-151">Ce modèle élimine le couplage inutile et améliore la fiabilité et le temps de réponse.</span><span class="sxs-lookup"><span data-stu-id="d1444-151">This pattern eliminates unnecessary coupling and improves reliability and response time.</span></span> <span data-ttu-id="d1444-152">La totalité de l’opération s’exécute à l’intérieur d’un processus unique.</span><span class="sxs-lookup"><span data-stu-id="d1444-152">The entire operation executes inside a single process.</span></span> <span data-ttu-id="d1444-153">Nous explorons ce modèle et les autres problèmes liés aux données dans le chapitre 5.</span><span class="sxs-lookup"><span data-stu-id="d1444-153">We explore this pattern and other data concerns in Chapter 5.</span></span>

### <a name="service-aggregator-pattern"></a><span data-ttu-id="d1444-154">Modèle d’agrégateur de service</span><span class="sxs-lookup"><span data-stu-id="d1444-154">Service Aggregator Pattern</span></span>

<span data-ttu-id="d1444-155">Une autre option permettant d’éliminer le couplage microservice à microservice est un [microservice d’agrégation](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), illustré en violet dans la figure 4-10.</span><span class="sxs-lookup"><span data-stu-id="d1444-155">Another option for eliminating microservice-to-microservice coupling is an [Aggregator microservice](https://devblogs.microsoft.com/cesardelatorre/designing-and-implementing-api-gateways-with-ocelot-in-a-microservices-and-container-based-architecture/), shown in purple in Figure 4-10.</span></span> 

![Service d’agrégation](./media/aggregator-service.png)

<span data-ttu-id="d1444-157">**Figure 4-10**.</span><span class="sxs-lookup"><span data-stu-id="d1444-157">**Figure 4-10**.</span></span> <span data-ttu-id="d1444-158">Microservice de l’agrégateur</span><span class="sxs-lookup"><span data-stu-id="d1444-158">Aggregator microservice</span></span>

<span data-ttu-id="d1444-159">Le modèle isole une opération qui effectue des appels à plusieurs microservices back-end, en centralisant sa logique dans un microservice spécialisé.</span><span class="sxs-lookup"><span data-stu-id="d1444-159">The pattern isolates an operation that makes calls to multiple back-end microservices, centralizing its logic into a specialized microservice.</span></span>  <span data-ttu-id="d1444-160">Le microservice de l’agrégateur de l’extraction violette dans la figure précédente orchestre le flux de travail pour l’opération d’extraction.</span><span class="sxs-lookup"><span data-stu-id="d1444-160">The purple checkout aggregator microservice in the previous figure orchestrates the workflow for the Checkout operation.</span></span> <span data-ttu-id="d1444-161">Il comprend des appels à plusieurs microservices principaux dans un ordre séquencé.</span><span class="sxs-lookup"><span data-stu-id="d1444-161">It includes calls to several back-end microservices in a sequenced order.</span></span> <span data-ttu-id="d1444-162">Les données du workflow sont agrégées et retournées à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="d1444-162">Data from the workflow is aggregated and returned to the caller.</span></span> <span data-ttu-id="d1444-163">Bien qu’elle implémente toujours des appels HTTP directs, le microservice de l’agrégateur réduit les dépendances directes entre les microservices back-end.</span><span class="sxs-lookup"><span data-stu-id="d1444-163">While it still implements direct HTTP calls, the aggregator microservice reduces direct dependencies among back-end microservices.</span></span> 

### <a name="requestreply-pattern"></a><span data-ttu-id="d1444-164">Modèle de demande/réponse</span><span class="sxs-lookup"><span data-stu-id="d1444-164">Request/Reply Pattern</span></span>

<span data-ttu-id="d1444-165">Une autre approche pour découpler les messages HTTP synchrones est un [modèle demande-réponse](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), qui utilise la communication de la mise en file d’attente.</span><span class="sxs-lookup"><span data-stu-id="d1444-165">Another approach for decoupling synchronous HTTP messages is a [Request-Reply Pattern](https://www.enterpriseintegrationpatterns.com/patterns/messaging/RequestReply.html), which uses queuing communication.</span></span> <span data-ttu-id="d1444-166">La communication à l’aide d’une file d’attente est toujours un canal unidirectionnel, avec un producteur qui envoie le message et le consommateur le recevant.</span><span class="sxs-lookup"><span data-stu-id="d1444-166">Communication using a queue is always a one-way channel, with a producer sending the message and consumer receiving it.</span></span> <span data-ttu-id="d1444-167">Avec ce modèle, une file d’attente de demandes et une file d’attente de réponses sont implémentées, comme illustré dans la figure 4-11.</span><span class="sxs-lookup"><span data-stu-id="d1444-167">With this pattern, both a request queue and response queue are implemented, shown in Figure 4-11.</span></span>

![Modèle demande-réponse](./media/request-reply-pattern.png)

<span data-ttu-id="d1444-169">**Figure 4-11**.</span><span class="sxs-lookup"><span data-stu-id="d1444-169">**Figure 4-11**.</span></span> <span data-ttu-id="d1444-170">Modèle demande-réponse</span><span class="sxs-lookup"><span data-stu-id="d1444-170">Request-reply pattern</span></span>

<span data-ttu-id="d1444-171">Ici, le producteur de message crée un message basé sur une requête qui contient un ID de corrélation unique et le place dans une file d’attente de demandes.</span><span class="sxs-lookup"><span data-stu-id="d1444-171">Here, the message producer creates a query-based message that contains a unique correlation ID and places it into a request queue.</span></span> <span data-ttu-id="d1444-172">Le service consommateur replace les messages dans la file d’attente, les traite et place la réponse dans la file d’attente de réponses avec le même ID de corrélation.</span><span class="sxs-lookup"><span data-stu-id="d1444-172">The consuming service dequeues the messages, processes it and places the response into the response queue with the same correlation ID.</span></span> <span data-ttu-id="d1444-173">Le service de producteur met le message en file d’attente, le met en correspondance avec l’ID de corrélation et continue le traitement.</span><span class="sxs-lookup"><span data-stu-id="d1444-173">The producer service dequeues the message, matches it with the correlation ID and continues processing.</span></span> <span data-ttu-id="d1444-174">Nous abordons les files d’attente en détail dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="d1444-174">We cover queues in detail in the next section.</span></span>

## <a name="commands"></a><span data-ttu-id="d1444-175">Commandes</span><span class="sxs-lookup"><span data-stu-id="d1444-175">Commands</span></span>

<span data-ttu-id="d1444-176">Un autre type d’interaction de communication est une *commande*.</span><span class="sxs-lookup"><span data-stu-id="d1444-176">Another type of communication interaction is a *command*.</span></span> <span data-ttu-id="d1444-177">Un microservice peut avoir besoin d’un autre microservice pour effectuer une action.</span><span class="sxs-lookup"><span data-stu-id="d1444-177">A microservice may need another microservice to perform an action.</span></span> <span data-ttu-id="d1444-178">Le microservice de commande peut avoir besoin du microservice d’expédition pour créer une livraison pour un ordre approuvé.</span><span class="sxs-lookup"><span data-stu-id="d1444-178">The Ordering microservice may need the Shipping microservice to create a shipment for an approved order.</span></span> <span data-ttu-id="d1444-179">Dans la figure 4-12, un microservice, appelé producteur, envoie un message à un autre microservice, le consommateur, en le commandant pour effectuer une opération.</span><span class="sxs-lookup"><span data-stu-id="d1444-179">In Figure 4-12, one microservice, called a Producer, sends a message to another microservice, the Consumer, commanding it to do something.</span></span> 

![Interaction de commande avec une file d’attente](./media/command-interaction-with-queue.png)

<span data-ttu-id="d1444-181">**Figure 4-12**.</span><span class="sxs-lookup"><span data-stu-id="d1444-181">**Figure 4-12**.</span></span> <span data-ttu-id="d1444-182">Interaction de commande avec une file d’attente</span><span class="sxs-lookup"><span data-stu-id="d1444-182">Command interaction with a queue</span></span>

<span data-ttu-id="d1444-183">Le plus souvent, le producteur ne nécessite pas de réponse et peut *déclencher et oublier* le message.</span><span class="sxs-lookup"><span data-stu-id="d1444-183">Most often, the Producer doesn't require a response and can *fire-and-forget* the message.</span></span> <span data-ttu-id="d1444-184">Si une réponse est nécessaire, le consommateur envoie un message séparé au producteur sur un autre canal.</span><span class="sxs-lookup"><span data-stu-id="d1444-184">If a reply is needed, the Consumer sends a separate message back to Producer on another channel.</span></span> <span data-ttu-id="d1444-185">Un message de commande est le mieux envoyé de façon asynchrone avec une file d’attente de messages.</span><span class="sxs-lookup"><span data-stu-id="d1444-185">A command message is best sent asynchronously with a message queue.</span></span> <span data-ttu-id="d1444-186">pris en charge par un courtier de messages léger.</span><span class="sxs-lookup"><span data-stu-id="d1444-186">supported by a lightweight message broker.</span></span> <span data-ttu-id="d1444-187">Dans le diagramme précédent, Notez comment une file d’attente sépare et découple les deux services.</span><span class="sxs-lookup"><span data-stu-id="d1444-187">In the previous diagram, note how a queue separates and decouples both services.</span></span>

<span data-ttu-id="d1444-188">Une file d’attente de messages est une construction intermédiaire par le biais de laquelle un producteur et un consommateur transmettent un message.</span><span class="sxs-lookup"><span data-stu-id="d1444-188">A message queue is an intermediary construct through which a producer and consumer pass a message.</span></span> <span data-ttu-id="d1444-189">Les files d’attente implémentent un modèle de messagerie point à point asynchrone.</span><span class="sxs-lookup"><span data-stu-id="d1444-189">Queues implement an asynchronous, point-to-point messaging pattern.</span></span> <span data-ttu-id="d1444-190">Le producteur sait à quel endroit une commande doit être envoyée et est acheminée de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="d1444-190">The Producer knows where a command needs to be sent and routes appropriately.</span></span> <span data-ttu-id="d1444-191">La file d’attente garantit qu’un message est traité par une seule instance de consommateur qui lit à partir du canal.</span><span class="sxs-lookup"><span data-stu-id="d1444-191">The queue guarantees that a message is processed by exactly one of the consumer instances that are reading from the channel.</span></span> <span data-ttu-id="d1444-192">Dans ce scénario, le service producteur ou le service consommateur peut monter en charge sans affecter l’autre.</span><span class="sxs-lookup"><span data-stu-id="d1444-192">In this scenario, either the producer or consumer service can scale out without affecting the other.</span></span> <span data-ttu-id="d1444-193">De même, les technologies peuvent être disparates de chaque côté, ce qui signifie que le microservice Java peut appeler un microservice [Golang](https://golang.org) .</span><span class="sxs-lookup"><span data-stu-id="d1444-193">As well, technologies can be disparate on each side, meaning that we might have a Java microservice calling a [Golang](https://golang.org) microservice.</span></span> 

<span data-ttu-id="d1444-194">Dans le chapitre 1, nous avons parlé des *services de stockage*.</span><span class="sxs-lookup"><span data-stu-id="d1444-194">In chapter 1, we talked about *backing services*.</span></span> <span data-ttu-id="d1444-195">Les services de stockage sont des ressources auxiliaires dont dépendent les systèmes natifs du Cloud.</span><span class="sxs-lookup"><span data-stu-id="d1444-195">Backing services are ancillary resources upon which cloud-native systems depend.</span></span> <span data-ttu-id="d1444-196">Les files d’attente de messages sont des services de stockage.</span><span class="sxs-lookup"><span data-stu-id="d1444-196">Message queues are backing services.</span></span> <span data-ttu-id="d1444-197">Le Cloud Azure prend en charge deux types de files d’attente de messages que vos systèmes natifs du Cloud peuvent utiliser pour implémenter la messagerie des commandes : Files d’attente de stockage Azure et files d’attente de Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="d1444-197">The Azure cloud supports two types of message queues that your cloud-native systems can consume to implement command messaging: Azure Storage Queues and Azure Service Bus Queues.</span></span>

### <a name="azure-storage-queues"></a><span data-ttu-id="d1444-198">Files d’attente de stockage Azure</span><span class="sxs-lookup"><span data-stu-id="d1444-198">Azure Storage Queues</span></span>

<span data-ttu-id="d1444-199">Les files d’attente de stockage Azure offrent une infrastructure de mise en file d’attente simple, rapide et abordable, avec les comptes de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="d1444-199">Azure storage queues offer a simple queueing infrastructure that is fast, affordable, and backed by Azure storage accounts.</span></span>

<span data-ttu-id="d1444-200">Les [files d’attente de stockage Azure](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) disposent d’un mécanisme de mise en file d’attente Rest avec une messagerie fiable et persistante.</span><span class="sxs-lookup"><span data-stu-id="d1444-200">[Azure Storage Queues](https://docs.microsoft.com/azure/storage/queues/storage-queues-introduction) feature a REST-based queuing mechanism with reliable and persistent messaging.</span></span> <span data-ttu-id="d1444-201">Ils fournissent un ensemble de fonctionnalités minimal, mais sont peu coûteux et stockent des millions de messages.</span><span class="sxs-lookup"><span data-stu-id="d1444-201">They provide a minimal feature set, but are inexpensive and store millions of messages.</span></span> <span data-ttu-id="d1444-202">Leur capacité est allant jusqu’à 500 to.</span><span class="sxs-lookup"><span data-stu-id="d1444-202">Their capacity ranges up to 500 TB.</span></span> <span data-ttu-id="d1444-203">Un message peut avoir une taille maximale de 64 Ko.</span><span class="sxs-lookup"><span data-stu-id="d1444-203">A single message can be up to 64 KB in size.</span></span>

<span data-ttu-id="d1444-204">Vous pouvez accéder aux messages de n’importe où dans le monde via des appels authentifiés à l’aide du protocole HTTP ou HTTPs.</span><span class="sxs-lookup"><span data-stu-id="d1444-204">You can access messages from anywhere in the world via authenticated calls using HTTP or HTTPS.</span></span> <span data-ttu-id="d1444-205">Les files d’attente de stockage peuvent évoluer vers un grand nombre de clients simultanés pour gérer les pics de trafic.</span><span class="sxs-lookup"><span data-stu-id="d1444-205">Storage queues can scale out to large numbers of concurrent clients to handle traffic spikes.</span></span>

<span data-ttu-id="d1444-206">Cela dit, il existe des limitations au service :</span><span class="sxs-lookup"><span data-stu-id="d1444-206">That said, there are limitations with the service:</span></span>

- <span data-ttu-id="d1444-207">L’ordre des messages n’est pas garanti.</span><span class="sxs-lookup"><span data-stu-id="d1444-207">Message order isn't guaranteed.</span></span>

- <span data-ttu-id="d1444-208">Un message peut uniquement être conservé pendant sept jours avant d’être automatiquement supprimé.</span><span class="sxs-lookup"><span data-stu-id="d1444-208">A message can only persist for seven days before it's automatically removed.</span></span>

- <span data-ttu-id="d1444-209">La prise en charge de la gestion d’État, de la détection des doublons ou des transactions n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="d1444-209">Support for state management, duplicate detection, or transactions isn't available.</span></span>

<span data-ttu-id="d1444-210">La figure 4-13 illustre la hiérarchie d’une file d’attente de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="d1444-210">Figure 4-13 shows the hierarchy of an Azure Storage Queue.</span></span>

![Hiérarchie de file d’attente de stockage](./media/storage-queue-hierarchy.png)

<span data-ttu-id="d1444-212">**Figure 4-13**.</span><span class="sxs-lookup"><span data-stu-id="d1444-212">**Figure 4-13**.</span></span> <span data-ttu-id="d1444-213">Hiérarchie de file d’attente de stockage</span><span class="sxs-lookup"><span data-stu-id="d1444-213">Storage queue hierarchy</span></span>

<span data-ttu-id="d1444-214">Dans la figure précédente, notez la manière dont les files d’attente de stockage stockent leurs messages dans le compte de stockage Azure sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="d1444-214">In the previous figure, note how storage queues store their messages in the underlying Azure Storage account.</span></span>

<span data-ttu-id="d1444-215">Pour les développeurs, Microsoft fournit plusieurs bibliothèques côté client et côté serveur pour le traitement de la file d’attente de stockage.</span><span class="sxs-lookup"><span data-stu-id="d1444-215">For developers, Microsoft provides several client and server-side libraries for Storage queue processing.</span></span> <span data-ttu-id="d1444-216">La plupart des principales plateformes sont prises en charge, y compris .NET, Java, JavaScript, Ruby, Python et Go.</span><span class="sxs-lookup"><span data-stu-id="d1444-216">Most major platforms are supported including .NET, Java, JavaScript, Ruby, Python, and Go.</span></span> <span data-ttu-id="d1444-217">Les développeurs ne doivent jamais communiquer directement avec ces bibliothèques.</span><span class="sxs-lookup"><span data-stu-id="d1444-217">Developers should never communicate directly with these libraries.</span></span> <span data-ttu-id="d1444-218">Cela a pour effet de coupler étroitement votre code de microservice à la service de File d’attente de stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="d1444-218">Doing so will tightly couple your microservice code to the Azure Storage Queue service.</span></span> <span data-ttu-id="d1444-219">Il est recommandé d’isoler les détails d’implémentation de l’API.</span><span class="sxs-lookup"><span data-stu-id="d1444-219">It's a better practice to insulate the implementation details of the API.</span></span> <span data-ttu-id="d1444-220">Introduisez une couche d’intermédiation, ou API intermédiaire, qui expose des opérations génériques et encapsule la bibliothèque concrète.</span><span class="sxs-lookup"><span data-stu-id="d1444-220">Introduce an intermediation layer, or intermediate API, that exposes generic operations and encapsulates the concrete library.</span></span> <span data-ttu-id="d1444-221">Ce couplage faible vous permet de permuter un service de mise en file d’attente pour un autre sans avoir à apporter de modifications au code du service de la principale.</span><span class="sxs-lookup"><span data-stu-id="d1444-221">This loose coupling enables you to swap out one queuing service for another without having to make changes to the mainline service code.</span></span> 

<span data-ttu-id="d1444-222">Les files d’attente de stockage Azure sont une option économique pour implémenter la messagerie de commandes dans vos applications Cloud natives.</span><span class="sxs-lookup"><span data-stu-id="d1444-222">Azure Storage queues are an economical option to implement command messaging in your cloud-native applications.</span></span> <span data-ttu-id="d1444-223">En particulier, lorsqu’une taille de file d’attente dépasse 80 Go, ou un ensemble de fonctionnalités simple est acceptable.</span><span class="sxs-lookup"><span data-stu-id="d1444-223">Especially when a queue size will exceed 80 GB, or a simple feature set is acceptable.</span></span> <span data-ttu-id="d1444-224">Vous payez uniquement pour le stockage des messages ; Il n’y a pas de frais fixes à l’heure fixe.</span><span class="sxs-lookup"><span data-stu-id="d1444-224">You only pay for the storage of the messages; there are no fixed hourly charges.</span></span>

### <a name="azure-service-bus-queues"></a><span data-ttu-id="d1444-225">Files d’attente de Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="d1444-225">Azure Service Bus Queues</span></span>

<span data-ttu-id="d1444-226">Pour des exigences de messagerie plus complexes, envisagez Azure Service Bus files d’attente.</span><span class="sxs-lookup"><span data-stu-id="d1444-226">For more complex messaging requirements, consider Azure Service Bus queues.</span></span>

<span data-ttu-id="d1444-227">Au-dessus d’une infrastructure de messages robuste, [Azure Service bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) prend en charge un *modèle de messagerie*répartie.</span><span class="sxs-lookup"><span data-stu-id="d1444-227">Sitting atop a robust message infrastructure, [Azure Service Bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-messaging-overview) supports a *brokered messaging model*.</span></span> <span data-ttu-id="d1444-228">Les messages sont stockés de manière fiable dans un répartiteur (la file d’attente) jusqu’à leur réception par le consommateur.</span><span class="sxs-lookup"><span data-stu-id="d1444-228">Messages are reliably stored in a broker (the queue) until received by the consumer.</span></span> <span data-ttu-id="d1444-229">La file d’attente garantit la remise des messages premier entré/premier sorti (FIFO), en respectant l’ordre dans lequel les messages ont été ajoutés à la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="d1444-229">The queue guarantees First-In/First-Out (FIFO) message delivery, respecting the order in which messages were added to the queue.</span></span>

<span data-ttu-id="d1444-230">La taille d’un message peut être plus importante, jusqu’à 256 Ko.</span><span class="sxs-lookup"><span data-stu-id="d1444-230">The size of a message can be much larger, up to 256 KB.</span></span> <span data-ttu-id="d1444-231">Les messages sont conservés dans la file d’attente pendant une durée illimitée.</span><span class="sxs-lookup"><span data-stu-id="d1444-231">Messages are persisted in the queue for an unlimited period of time.</span></span> <span data-ttu-id="d1444-232">Service Bus prend en charge non seulement les appels basés sur HTTP, mais fournit également une prise en charge complète du [protocole AMPQ](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview).</span><span class="sxs-lookup"><span data-stu-id="d1444-232">Service Bus supports not only HTTP-based calls, but also provides full support for the [AMPQ protocol](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-amqp-overview).</span></span> <span data-ttu-id="d1444-233">AMPQ est une norme ouverte pour les fournisseurs qui prend en charge un protocole binaire et de plus hauts niveaux de fiabilité.</span><span class="sxs-lookup"><span data-stu-id="d1444-233">AMPQ is an open-standard across vendors that supports a binary protocol and higher degrees of reliability.</span></span>

<span data-ttu-id="d1444-234">Service Bus fournit un ensemble complet de fonctionnalités, notamment la [prise en charge des transactions](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) et une [fonctionnalité de détection des doublons](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection).</span><span class="sxs-lookup"><span data-stu-id="d1444-234">Service Bus provides a rich set of features, including [transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions) and a [duplicate detection feature](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection).</span></span> <span data-ttu-id="d1444-235">La file d’attente garantit « au plus une fois la remise » par message.</span><span class="sxs-lookup"><span data-stu-id="d1444-235">The queue guarantees "at most once delivery" per message.</span></span> <span data-ttu-id="d1444-236">Il ignore automatiquement un message qui a déjà été envoyé.</span><span class="sxs-lookup"><span data-stu-id="d1444-236">It automatically discards a message that has already been sent.</span></span> <span data-ttu-id="d1444-237">Si un producteur est incertain, il peut renvoyer le même message et Service Bus garantit qu’une seule copie sera traitée.</span><span class="sxs-lookup"><span data-stu-id="d1444-237">If a producer is in doubt, it can resend the same message, and Service Bus guarantees that only one copy will be processed.</span></span> <span data-ttu-id="d1444-238">La détection des doublons vous évite d’avoir à créer des mécanismes d’infrastructure supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="d1444-238">Duplicate detection frees you from  having to build additional infrastructure plumbing.</span></span>

<span data-ttu-id="d1444-239">Deux autres fonctionnalités d’entreprise sont le partitionnement et les sessions.</span><span class="sxs-lookup"><span data-stu-id="d1444-239">Two more enterprise features are partitioning and sessions.</span></span> <span data-ttu-id="d1444-240">Une file d’attente de Service Bus conventionnelle est gérée par un seul courtier de messages et stockée dans une seule banque de messages.</span><span class="sxs-lookup"><span data-stu-id="d1444-240">A conventional Service Bus queue is handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="d1444-241">Toutefois, le [partitionnement service bus](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) répartit la file d’attente entre plusieurs courtiers de messages et banques de messages.</span><span class="sxs-lookup"><span data-stu-id="d1444-241">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) spreads the queue across multiple message brokers and message stores.</span></span> <span data-ttu-id="d1444-242">Le débit global n’est plus limité par les performances d’un seul courtier de messages ou d’une seule banque de messagerie.</span><span class="sxs-lookup"><span data-stu-id="d1444-242">The overall throughput is no longer limited by the performance of a single message broker or messaging store.</span></span> <span data-ttu-id="d1444-243">Une panne temporaire d’une banque de messagerie ne rend pas une file d’attente partitionnée indisponible.</span><span class="sxs-lookup"><span data-stu-id="d1444-243">A temporary outage of a messaging store doesn't render a partitioned queue unavailable.</span></span>

<span data-ttu-id="d1444-244">Les [Sessions service bus](https://codingcanvas.com/azure-service-bus-sessions/) offrent un moyen de regrouper les messages liés à.</span><span class="sxs-lookup"><span data-stu-id="d1444-244">[Service Bus Sessions](https://codingcanvas.com/azure-service-bus-sessions/) provide a way to group-related messages.</span></span> <span data-ttu-id="d1444-245">Imaginez un scénario de flux de travail dans lequel les messages doivent être traités ensemble et l’opération se termine à la fin.</span><span class="sxs-lookup"><span data-stu-id="d1444-245">Imagine a workflow scenario where messages must be processed together and the operation completed at the end.</span></span> <span data-ttu-id="d1444-246">Pour tirer parti, les sessions doivent être activées explicitement pour la file d’attente et chaque message associé doit contenir le même ID de session.</span><span class="sxs-lookup"><span data-stu-id="d1444-246">To take advantage, sessions must be explicitly enabled for the queue and each related messaged must contain the same session ID.</span></span>

<span data-ttu-id="d1444-247">Toutefois, il existe des inconvénients importants : Service Bus la taille des files d’attente est limitée à 80 Go, ce qui est bien plus petit que ce qui est disponible dans les files d’attente du magasin.</span><span class="sxs-lookup"><span data-stu-id="d1444-247">However, there are some important caveats: Service Bus queues size is limited to 80 GB, which is much smaller than what's available from store queues.</span></span> <span data-ttu-id="d1444-248">En outre, Service Bus files d’attente impliquent un coût de base et une facturation par opération.</span><span class="sxs-lookup"><span data-stu-id="d1444-248">Additionally, Service Bus queues incur a base cost and charge per operation.</span></span>

<span data-ttu-id="d1444-249">La figure 4-14 présente l’architecture de haut niveau d’une file d’attente de Service Bus.</span><span class="sxs-lookup"><span data-stu-id="d1444-249">Figure 4-14 outlines the high-level architecture of a Service Bus queue.</span></span>

![File d’attente Service Bus](./media/service-bus-queue.png)

<span data-ttu-id="d1444-251">**Figure 4-14**.</span><span class="sxs-lookup"><span data-stu-id="d1444-251">**Figure 4-14**.</span></span> <span data-ttu-id="d1444-252">File d’attente Service Bus</span><span class="sxs-lookup"><span data-stu-id="d1444-252">Service Bus queue</span></span>

<span data-ttu-id="d1444-253">Dans l’illustration précédente, notez la relation point à point.</span><span class="sxs-lookup"><span data-stu-id="d1444-253">In the previous figure, note the point-to-point relationship.</span></span> <span data-ttu-id="d1444-254">Deux instances du même fournisseur empilent des messages dans une file d’attente de Service Bus unique.</span><span class="sxs-lookup"><span data-stu-id="d1444-254">Two instances of the same provider are enqueuing messages into a single Service Bus queue.</span></span> <span data-ttu-id="d1444-255">Chaque message est consommé par une seule des trois instances de consommateur à droite.</span><span class="sxs-lookup"><span data-stu-id="d1444-255">Each message is consumed by only one of three consumer instances on the right.</span></span> <span data-ttu-id="d1444-256">Ensuite, nous expliquons comment implémenter la messagerie dans laquelle les différents consommateurs peuvent être intéressés par le même message.</span><span class="sxs-lookup"><span data-stu-id="d1444-256">Next, we discuss how to implement messaging where different consumers may all be interested the same message.</span></span>

## <a name="events"></a><span data-ttu-id="d1444-257">Événements</span><span class="sxs-lookup"><span data-stu-id="d1444-257">Events</span></span>

<span data-ttu-id="d1444-258">Message Queuing est un moyen efficace d’implémenter une communication dans laquelle un producteur peut envoyer un message de manière asynchrone à un consommateur.</span><span class="sxs-lookup"><span data-stu-id="d1444-258">Message queuing is an effective way to implement communication where a producer can asynchronously send a consumer a message.</span></span> <span data-ttu-id="d1444-259">Toutefois, que se passe-t-il lorsque de *nombreux consommateurs* sont intéressés par le même message ?</span><span class="sxs-lookup"><span data-stu-id="d1444-259">However, what happens when *many different consumers* are interested in the same message?</span></span> <span data-ttu-id="d1444-260">Une file d’attente de messages dédiée pour chaque consommateur n’est pas bien adaptée et devient difficile à gérer.</span><span class="sxs-lookup"><span data-stu-id="d1444-260">A dedicated message queue for each consumer wouldn't scale well and would become difficult to manage.</span></span> 

<span data-ttu-id="d1444-261">Pour traiter ce scénario, nous allons passer au troisième type d’interaction de message, l' *événement*.</span><span class="sxs-lookup"><span data-stu-id="d1444-261">To address this scenario, we move to the third type of message interaction, the *event*.</span></span> <span data-ttu-id="d1444-262">Un microservice annonce qu’une action s’est produite.</span><span class="sxs-lookup"><span data-stu-id="d1444-262">One microservice announces that an action had occurred.</span></span> <span data-ttu-id="d1444-263">D’autres microservices, s’ils le souhaitent, réagissent à l’action ou à l’événement.</span><span class="sxs-lookup"><span data-stu-id="d1444-263">Other microservices, if interested, react to the action, or event.</span></span> 

<span data-ttu-id="d1444-264">L’événement est un processus en deux étapes.</span><span class="sxs-lookup"><span data-stu-id="d1444-264">Eventing is a two-step process.</span></span> <span data-ttu-id="d1444-265">Pour un changement d’État donné, un microservice publie un événement dans un courtier de messages, ce qui le rend disponible pour tout autre microservice intéressé.</span><span class="sxs-lookup"><span data-stu-id="d1444-265">For a given state change, a microservice publishes an event to a message broker, making it available to any other interested microservice.</span></span> <span data-ttu-id="d1444-266">Le microservice intéressé est averti en s’abonnant à l’événement dans le courtier de messages.</span><span class="sxs-lookup"><span data-stu-id="d1444-266">The interested microservice is notified by subscribing to the event in the message broker.</span></span> <span data-ttu-id="d1444-267">Vous utilisez le modèle de [publication/abonnement](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) pour implémenter la [communication basée sur les événements](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span><span class="sxs-lookup"><span data-stu-id="d1444-267">You use the [Publish/Subscribe](https://docs.microsoft.com/azure/architecture/patterns/publisher-subscriber) pattern to implement [event-based communication](https://docs.microsoft.com/dotnet/standard/microservices-architecture/multi-container-microservice-net-applications/integration-event-based-microservice-communications).</span></span>

<span data-ttu-id="d1444-268">La figure 4-15 montre un microservice de panier d’achat publiant un événement avec deux autres microservices s’abonnant à ce dernier.</span><span class="sxs-lookup"><span data-stu-id="d1444-268">Figure 4-15 shows a shopping basket microservice publishing an event with two other microservices subscribing to it.</span></span>

![Messagerie pilotée par les événements](./media/event-driven-messaging.png)

<span data-ttu-id="d1444-270">**Figure 4-15**.</span><span class="sxs-lookup"><span data-stu-id="d1444-270">**Figure 4-15**.</span></span> <span data-ttu-id="d1444-271">Messagerie pilotée par les événements</span><span class="sxs-lookup"><span data-stu-id="d1444-271">Event-Driven messaging</span></span>

<span data-ttu-id="d1444-272">Notez le composant *bus d’événements* qui se trouve au milieu du canal de communication.</span><span class="sxs-lookup"><span data-stu-id="d1444-272">Note the *event bus* component that sits in the middle of the communication channel.</span></span> <span data-ttu-id="d1444-273">Il s’agit d’une classe personnalisée qui encapsule le courtier de messages et le dissocie de l’application sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="d1444-273">It's a custom class that encapsulates the message broker and decouples it from the underlying application.</span></span> <span data-ttu-id="d1444-274">Les microservices de classement et d’inventaire opèrent indépendamment l’événement sans aucune connaissance de l’un l’autre, ni le microservice du panier d’achat.</span><span class="sxs-lookup"><span data-stu-id="d1444-274">The ordering and inventory microservices independently operate the event with no knowledge of each other, nor the shopping basket microservice.</span></span> <span data-ttu-id="d1444-275">Lorsque l’événement Registered est publié dans le bus d’événements, il agit sur celui-ci.</span><span class="sxs-lookup"><span data-stu-id="d1444-275">When the registered event is published to the event bus, they act upon it.</span></span>

<span data-ttu-id="d1444-276">Avec l’événement, nous passons de la technologie de mise en file d’attente aux *rubriques*.</span><span class="sxs-lookup"><span data-stu-id="d1444-276">With eventing, we move from queuing technology to *topics*.</span></span> <span data-ttu-id="d1444-277">Une [rubrique](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) est semblable à une file d’attente, mais prend en charge un modèle de messagerie un-à-plusieurs.</span><span class="sxs-lookup"><span data-stu-id="d1444-277">A [topic](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions) is similar to a queue, but supports a one-to-many messaging pattern.</span></span> <span data-ttu-id="d1444-278">Un microservice publie un message.</span><span class="sxs-lookup"><span data-stu-id="d1444-278">One microservice publishes a message.</span></span> <span data-ttu-id="d1444-279">Plusieurs microservices d’abonnement peuvent choisir de recevoir et d’agir sur ce message.</span><span class="sxs-lookup"><span data-stu-id="d1444-279">Multiple subscribing microservices can choose to receive and act upon that message.</span></span> <span data-ttu-id="d1444-280">La figure 4-16 illustre une architecture de rubrique.</span><span class="sxs-lookup"><span data-stu-id="d1444-280">Figure 4-16 shows a topic architecture.</span></span>

![Architecture des rubriques](./media/topic-architecture.png)

<span data-ttu-id="d1444-282">**Figure 4-16**.</span><span class="sxs-lookup"><span data-stu-id="d1444-282">**Figure 4-16**.</span></span> <span data-ttu-id="d1444-283">Architecture des rubriques</span><span class="sxs-lookup"><span data-stu-id="d1444-283">Topic architecture</span></span>

<span data-ttu-id="d1444-284">Dans la figure précédente, les éditeurs envoient des messages à la rubrique.</span><span class="sxs-lookup"><span data-stu-id="d1444-284">In the previous figure, publishers send messages to the topic.</span></span> <span data-ttu-id="d1444-285">À la fin, les abonnés reçoivent des messages des abonnements.</span><span class="sxs-lookup"><span data-stu-id="d1444-285">At the end, subscribers receive messages from subscriptions.</span></span> <span data-ttu-id="d1444-286">Au milieu, la rubrique transfère les messages aux abonnements en fonction d’un ensemble de *règles*, affichées dans des zones bleu foncé.</span><span class="sxs-lookup"><span data-stu-id="d1444-286">In the middle, the topic forwards messages to subscriptions based on a set of *rules*, shown in dark blue boxes.</span></span> <span data-ttu-id="d1444-287">Les règles agissent comme un filtre qui transfère des messages spécifiques à un abonnement.</span><span class="sxs-lookup"><span data-stu-id="d1444-287">Rules act as a filter that forward specific messages to a subscription.</span></span> <span data-ttu-id="d1444-288">Ici, un événement « CreateOrder » est envoyé à l’abonnement \#1 et à \#l’abonnement 3, mais pas \#à l’abonnement 2.</span><span class="sxs-lookup"><span data-stu-id="d1444-288">Here, a "CreateOrder" event would be sent to Subscription \#1 and Subscription \#3, but not to Subscription \#2.</span></span> <span data-ttu-id="d1444-289">Un événement « OrderCompleted » est envoyé à l’abonnement \#2 et à \#l’abonnement 3.</span><span class="sxs-lookup"><span data-stu-id="d1444-289">An "OrderCompleted" event would be sent to Subscription \#2 and Subscription \#3.</span></span>

<span data-ttu-id="d1444-290">Le Cloud Azure prend en charge deux services de rubrique différents : Rubriques Azure Service Bus et Azure EventGrid.</span><span class="sxs-lookup"><span data-stu-id="d1444-290">The Azure cloud supports two different topic services: Azure Service Bus Topics and Azure EventGrid.</span></span>

### <a name="azure-service-bus-topics"></a><span data-ttu-id="d1444-291">Rubriques Azure Service Bus</span><span class="sxs-lookup"><span data-stu-id="d1444-291">Azure Service Bus Topics</span></span>

<span data-ttu-id="d1444-292">Sur le même modèle de message répartie robuste de Azure Service Bus files d’attente se trouvent [Azure Service bus rubriques](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span><span class="sxs-lookup"><span data-stu-id="d1444-292">Sitting on top of the same robust brokered message model of Azure Service Bus queues are [Azure Service Bus Topics](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-dotnet-how-to-use-topics-subscriptions).</span></span> <span data-ttu-id="d1444-293">Une rubrique peut recevoir des messages de plusieurs éditeurs indépendants et envoyer des messages à jusqu’à 2 000 abonnés.</span><span class="sxs-lookup"><span data-stu-id="d1444-293">A topic can receive messages from multiple independent publishers and send messages to up to 2,000 subscribers.</span></span> <span data-ttu-id="d1444-294">Les abonnements peuvent être ajoutés ou supprimés de manière dynamique au moment de l’exécution sans arrêter le système ou recréer la rubrique.</span><span class="sxs-lookup"><span data-stu-id="d1444-294">Subscriptions can be dynamically added or removed at runtime without stopping the system or recreating the topic.</span></span>

<span data-ttu-id="d1444-295">De nombreuses fonctionnalités avancées des files d’attente Azure Service Bus sont également disponibles pour les rubriques, notamment la [détection des doublons](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) et la [prise en charge des transactions](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions).</span><span class="sxs-lookup"><span data-stu-id="d1444-295">Many advanced features from Azure Service Bus queues are also available for topics, including [Duplicate Detection](https://docs.microsoft.com/azure/service-bus-messaging/duplicate-detection) and [Transaction support](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-transactions).</span></span> <span data-ttu-id="d1444-296">Par défaut, les rubriques de Service Bus sont gérées par un seul courtier de messages et stockées dans une seule banque de messages.</span><span class="sxs-lookup"><span data-stu-id="d1444-296">By default, Service Bus topics are handled by a single message broker and stored in a single message store.</span></span> <span data-ttu-id="d1444-297">Toutefois, [service bus le partitionnement](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) met à l’échelle une rubrique en la répartissant entre plusieurs courtiers de messages et banques de messages.</span><span class="sxs-lookup"><span data-stu-id="d1444-297">But, [Service Bus Partitioning](https://docs.microsoft.com/azure/service-bus-messaging/service-bus-partitioning) scales a topic by spreading it across many message brokers and message stores.</span></span>

<span data-ttu-id="d1444-298">La [remise planifiée des messages](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) marque un message avec un temps de traitement spécifique.</span><span class="sxs-lookup"><span data-stu-id="d1444-298">[Scheduled Message Delivery](https://docs.microsoft.com/azure/service-bus-messaging/message-sequencing) tags a message with a specific time for processing.</span></span> <span data-ttu-id="d1444-299">Le message ne s’affiche pas dans la rubrique avant ce moment.</span><span class="sxs-lookup"><span data-stu-id="d1444-299">The message won't appear in the topic before that time.</span></span> <span data-ttu-id="d1444-300">Le [Report de message](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) vous permet de différer une récupération d’un message à un moment ultérieur.</span><span class="sxs-lookup"><span data-stu-id="d1444-300">[Message Deferral](https://docs.microsoft.com/azure/service-bus-messaging/message-deferral) enables you to defer a retrieval of a message to a later time.</span></span> <span data-ttu-id="d1444-301">Les deux sont couramment utilisés dans les scénarios de traitement de workflow où les opérations sont traitées dans un ordre particulier.</span><span class="sxs-lookup"><span data-stu-id="d1444-301">Both are commonly used in workflow processing scenarios where operations are processed in a particular order.</span></span> <span data-ttu-id="d1444-302">Vous pouvez différer le traitement des messages reçus jusqu’à ce que le travail précédent soit terminé.</span><span class="sxs-lookup"><span data-stu-id="d1444-302">You can postpone processing of received messages until prior work has been completed.</span></span>

<span data-ttu-id="d1444-303">Service Bus rubriques sont une technologie robuste et éprouvée permettant d’activer la communication de publication/abonnement dans vos systèmes natifs dans le Cloud.</span><span class="sxs-lookup"><span data-stu-id="d1444-303">Service Bus topics are a robust and proven technology for enabling publish/subscribe communication in your cloud-native systems.</span></span>

### <a name="azure-event-grid"></a><span data-ttu-id="d1444-304">Azure Event Grid</span><span class="sxs-lookup"><span data-stu-id="d1444-304">Azure Event Grid</span></span>

<span data-ttu-id="d1444-305">Bien que Azure Service Bus soit un courtier de messagerie testé avec un ensemble complet de fonctionnalités d’entreprise, [Azure Event Grid](https://docs.microsoft.com/azure/event-grid/overview) est le nouvel enfant du bloc.</span><span class="sxs-lookup"><span data-stu-id="d1444-305">While Azure Service Bus is a battle-tested messaging broker with a full set of enterprise features, [Azure Event Grid](https://docs.microsoft.com/azure/event-grid/overview) is the new kid on the block.</span></span>

<span data-ttu-id="d1444-306">À première vue, Event Grid peut se présenter comme un autre système de messagerie basé sur des rubriques.</span><span class="sxs-lookup"><span data-stu-id="d1444-306">At first glance, Event Grid may look like just another topic-based messaging system.</span></span> <span data-ttu-id="d1444-307">Toutefois, il est différent de nombreuses façons.</span><span class="sxs-lookup"><span data-stu-id="d1444-307">However, it's different in many ways.</span></span> <span data-ttu-id="d1444-308">Axé sur les charges de travail pilotées par les événements, il permet le traitement d’événements en temps réel, l’intégration Azure profonde et une infrastructure ouverte et complète sur une infrastructure sans serveur.</span><span class="sxs-lookup"><span data-stu-id="d1444-308">Focused on event-driven workloads, it enables real-time event processing, deep Azure integration, and an open-platform - all on serverless infrastructure.</span></span> <span data-ttu-id="d1444-309">Il est conçu pour les applications Cloud natives et sans serveur.</span><span class="sxs-lookup"><span data-stu-id="d1444-309">It's designed for contemporary cloud-native and serverless applications</span></span>

<span data-ttu-id="d1444-310">En tant que *fond de panier des événements*centralisés, Event Grid réagit aux événements dans les ressources Azure et à partir de vos propres services.</span><span class="sxs-lookup"><span data-stu-id="d1444-310">As a centralized *eventing backplane*, or pipe, Event Grid reacts to events inside Azure resources and from your own services.</span></span>

<span data-ttu-id="d1444-311">Les notifications d’événements sont publiées dans une rubrique Event Grid qui, à son tour, achemine chaque événement à un abonnement.</span><span class="sxs-lookup"><span data-stu-id="d1444-311">Event notifications are published to an Event Grid Topic, which, in turn, routes each event to a subscription.</span></span> <span data-ttu-id="d1444-312">Les abonnés sont mappés aux abonnements et consomment les événements.</span><span class="sxs-lookup"><span data-stu-id="d1444-312">Subscribers map to subscriptions and consume the events.</span></span> <span data-ttu-id="d1444-313">Comme Service Bus, Event Grid prend en charge un *modèle d’abonné filtré* dans lequel un abonnement définit une règle pour les événements qu’il souhaite recevoir.</span><span class="sxs-lookup"><span data-stu-id="d1444-313">Like Service Bus, Event Grid supports a *filtered subscriber model* where a subscription sets rule for the events it wishes to receive.</span></span> <span data-ttu-id="d1444-314">Event Grid fournit un débit rapide avec une garantie de 10 millions événements par seconde permettant une livraison presque en temps réel, bien plus que ce que Azure Service Bus peut générer.</span><span class="sxs-lookup"><span data-stu-id="d1444-314">Event Grid provides fast throughput with a guarantee of 10 million events per second enabling near real-time delivery - far more than what Azure Service Bus can generate.</span></span>

<span data-ttu-id="d1444-315">Un point idéal pour Event Grid est son intégration profonde dans la structure de l’infrastructure Azure.</span><span class="sxs-lookup"><span data-stu-id="d1444-315">A sweet spot for Event Grid is its deep integration into the fabric of Azure infrastructure.</span></span> <span data-ttu-id="d1444-316">Une ressource Azure, telle que Cosmos DB, peut publier des événements intégrés directement dans d’autres ressources Azure intéressées, sans nécessiter de code personnalisé.</span><span class="sxs-lookup"><span data-stu-id="d1444-316">An Azure resource, such as Cosmos DB, can publish built-in events directly to other interested Azure resources - without the need for custom code.</span></span> <span data-ttu-id="d1444-317">Event Grid pouvez publier des événements à partir d’un abonnement, d’un groupe de ressources ou d’un service Azure, ce qui permet aux développeurs de contrôler précisément le cycle de vie des ressources du Cloud.</span><span class="sxs-lookup"><span data-stu-id="d1444-317">Event Grid can publish events from an Azure Subscription, Resource Group, or Service, giving developers fine-grained control over the lifecycle of cloud resources.</span></span> <span data-ttu-id="d1444-318">Toutefois, Event Grid n’est pas limité à Azure.</span><span class="sxs-lookup"><span data-stu-id="d1444-318">However, Event Grid isn't limited to Azure.</span></span> <span data-ttu-id="d1444-319">Il s’agit d’une plateforme ouverte qui peut consommer des événements HTTP personnalisés publiés à partir d’applications ou de services tiers et acheminer les événements vers des abonnés externes.</span><span class="sxs-lookup"><span data-stu-id="d1444-319">It's an open platform that can consume custom HTTP events published from applications or third-party services and route events to external subscribers.</span></span>

<span data-ttu-id="d1444-320">Lors de la publication et de l’abonnement aux événements natifs à partir des ressources Azure, aucun codage n’est requis.</span><span class="sxs-lookup"><span data-stu-id="d1444-320">When publishing and subscribing to native events from Azure resources, no coding is required.</span></span> <span data-ttu-id="d1444-321">Avec une configuration simple, vous pouvez intégrer des événements d’une ressource Azure à une autre, en tirant parti des fonctionnalités intégrées pour les rubriques et les abonnements.</span><span class="sxs-lookup"><span data-stu-id="d1444-321">With simple configuration, you can integrate events from one Azure resource to another leveraging built-in plumbing for Topics and Subscriptions.</span></span> <span data-ttu-id="d1444-322">La figure 4-17 illustre l’anatomie de Event Grid.</span><span class="sxs-lookup"><span data-stu-id="d1444-322">Figure 4-17 shows the anatomy of Event Grid.</span></span>

![Event Grid anatomie](./media/event-grid-anatomy.png)

<span data-ttu-id="d1444-324">**Figure 4-17**.</span><span class="sxs-lookup"><span data-stu-id="d1444-324">**Figure 4-17**.</span></span> <span data-ttu-id="d1444-325">Event Grid anatomie</span><span class="sxs-lookup"><span data-stu-id="d1444-325">Event Grid anatomy</span></span>

<span data-ttu-id="d1444-326">La principale différence entre EventGrid et Service Bus est le *modèle d’échange de messages*sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="d1444-326">A major difference between EventGrid and Service Bus is the underlying *message exchange pattern*.</span></span>

<span data-ttu-id="d1444-327">Service Bus implémente un modèle d' *extraction* de style plus ancien dans lequel l’abonné en aval interroge activement l’abonnement aux nouveaux messages.</span><span class="sxs-lookup"><span data-stu-id="d1444-327">Service Bus implements an older style *pull model* in which the downstream subscriber actively polls the topic subscription for new messages.</span></span> <span data-ttu-id="d1444-328">À l’envers, cette approche permet à l’abonné d’avoir un contrôle total sur le rythme de traitement des messages.</span><span class="sxs-lookup"><span data-stu-id="d1444-328">On the upside, this approach gives the subscriber full control of the pace at which it processes messages.</span></span> <span data-ttu-id="d1444-329">Il contrôle le moment et le nombre de messages à traiter à un moment donné.</span><span class="sxs-lookup"><span data-stu-id="d1444-329">It controls when and how many messages to process at any given time.</span></span> <span data-ttu-id="d1444-330">Les messages non lus restent dans l’abonnement jusqu’à ce qu’ils soient traités.</span><span class="sxs-lookup"><span data-stu-id="d1444-330">Unread messages remain in the subscription until processed.</span></span> <span data-ttu-id="d1444-331">Une lacune importante est la latence entre le moment où l’événement est généré et l’opération d’interrogation qui extrait ce message à l’abonné pour traitement.</span><span class="sxs-lookup"><span data-stu-id="d1444-331">A significant shortcoming is the latency between the time the event is generated and the polling operation that pulls that message to the subscriber for processing.</span></span> <span data-ttu-id="d1444-332">En outre, la surcharge liée à l’interrogation constante pour l’événement suivant consomme des ressources et de l’argent.</span><span class="sxs-lookup"><span data-stu-id="d1444-332">Also, the overhead of constant polling for the next event consumes resources and money.</span></span>

<span data-ttu-id="d1444-333">EventGrid, toutefois, est différent.</span><span class="sxs-lookup"><span data-stu-id="d1444-333">EventGrid, however, is different.</span></span> <span data-ttu-id="d1444-334">Il implémente un *modèle push* dans lequel les événements sont envoyés aux EventHandlers comme étant reçus, ce qui permet une remise d’événements en temps quasi-réel.</span><span class="sxs-lookup"><span data-stu-id="d1444-334">It implements a *push model* in which events are sent to the EventHandlers as received, giving near real-time event delivery.</span></span> <span data-ttu-id="d1444-335">Cela réduit également les coûts lorsque le service est déclenché uniquement lorsqu’il est nécessaire de consommer un événement, pas en permanence comme avec l’interrogation.</span><span class="sxs-lookup"><span data-stu-id="d1444-335">It also reduces cost as the service is triggered only when it's needed to consume an event – not continually as with polling.</span></span> <span data-ttu-id="d1444-336">Cela dit, un gestionnaire d’événements doit gérer la charge entrante et fournir des mécanismes de limitation afin de se protéger contre le risque de saturation.</span><span class="sxs-lookup"><span data-stu-id="d1444-336">That said, an event handler must handle the incoming load and provide throttling mechanisms to protect itself from becoming overwhelmed.</span></span> <span data-ttu-id="d1444-337">De nombreux services Azure qui consomment ces événements, tels que Azure Functions et Logic Apps fournissent des fonctionnalités de mise à l’échelle automatique pour gérer des charges accrues.</span><span class="sxs-lookup"><span data-stu-id="d1444-337">Many Azure services that consume these events, such as Azure Functions and Logic Apps provide automatic autoscaling capabilities to handle increased loads.</span></span>  

<span data-ttu-id="d1444-338">Event Grid est un service Cloud sans serveur entièrement géré.</span><span class="sxs-lookup"><span data-stu-id="d1444-338">Event Grid is a fully managed serverless cloud service.</span></span> <span data-ttu-id="d1444-339">Elle est mise à l’échelle dynamiquement en fonction de votre trafic et vous facture uniquement pour votre utilisation réelle, et non pour une capacité préachetée.</span><span class="sxs-lookup"><span data-stu-id="d1444-339">It dynamically scales based on your traffic and charges you only for your actual usage, not pre-purchased capacity.</span></span> <span data-ttu-id="d1444-340">Les 100 000 premières opérations par mois sont gratuites : les opérations sont définies comme entrée d’événement (notifications d’événements entrantes), tentatives de remise d’abonnement, appels de gestion et filtrage par objet.</span><span class="sxs-lookup"><span data-stu-id="d1444-340">The first 100,000 operations per month are free – operations being defined as event ingress (incoming event notifications), subscription delivery attempts, management calls, and filtering by subject.</span></span> <span data-ttu-id="d1444-341">Avec une disponibilité de 99,99%, EventGrid garantit la remise d’un événement au cours d’une période de 24 heures, avec la fonctionnalité de nouvelle tentative intégrée pour la remise en échec.</span><span class="sxs-lookup"><span data-stu-id="d1444-341">With 99.99% availability, EventGrid guarantees the delivery of an event within a 24-hour period, with built-in retry functionality for unsuccessful delivery.</span></span> <span data-ttu-id="d1444-342">Les messages non remis peuvent être déplacés vers une file d’attente de lettres mortes pour la résolution.</span><span class="sxs-lookup"><span data-stu-id="d1444-342">Undelivered messages can be moved to a "dead-letter" queue for resolution.</span></span>  <span data-ttu-id="d1444-343">Contrairement à Azure Service Bus, Event Grid est réglé pour des performances rapides et ne prend pas en charge les fonctionnalités telles que la messagerie, les transactions et les sessions ordonnées.</span><span class="sxs-lookup"><span data-stu-id="d1444-343">Unlike Azure Service Bus, Event Grid is tuned for fast performance and doesn't support features like ordered messaging, transactions, and sessions.</span></span>

### <a name="streaming-messages-in-the-azure-cloud"></a><span data-ttu-id="d1444-344">Diffusion en continu de messages dans le Cloud Azure</span><span class="sxs-lookup"><span data-stu-id="d1444-344">Streaming messages in the Azure cloud</span></span>

<span data-ttu-id="d1444-345">Azure Service Bus et Event Grid offrent une excellente prise en charge des applications qui exposent des événements simples et discrets tels qu’un nouveau document inséré dans un Cosmos DB).</span><span class="sxs-lookup"><span data-stu-id="d1444-345">Azure Service Bus and Event Grid provide great support for applications that expose single, discrete events like a new document been inserted into a Cosmos DB).</span></span> <span data-ttu-id="d1444-346">Mais, que se passe-t-il si votre système Cloud natif doit traiter un *flux d’événements connexes*?</span><span class="sxs-lookup"><span data-stu-id="d1444-346">But, what if your cloud-native system needs to process a *stream of related events*?</span></span> <span data-ttu-id="d1444-347">Les [flux d’événements](https://msdn.microsoft.com/magazine/dn904671.aspx?f=255&MSPPError=-2147217396) sont plus complexes.</span><span class="sxs-lookup"><span data-stu-id="d1444-347">[Event streams](https://msdn.microsoft.com/magazine/dn904671.aspx?f=255&MSPPError=-2147217396) are more complex.</span></span> <span data-ttu-id="d1444-348">Ils sont généralement classés dans le temps, liés et doivent être traités en tant que groupe.</span><span class="sxs-lookup"><span data-stu-id="d1444-348">They're typically time-ordered, interrelated and must be processed as a group.</span></span>

<span data-ttu-id="d1444-349">[Azure Event Hub](https://azure.microsoft.com/services/event-hubs/) est une plateforme de diffusion de données et un service d’ingestion d’événements qui collecte, transforme et stocke des événements.</span><span class="sxs-lookup"><span data-stu-id="d1444-349">[Azure Event Hub](https://azure.microsoft.com/services/event-hubs/) is a data streaming platform and event ingestion service that collects, transforms, and stores events.</span></span> <span data-ttu-id="d1444-350">Il est affiné pour capturer les données de streaming, telles que les notifications d’événements continus émises à partir d’un contexte de télémétrie.</span><span class="sxs-lookup"><span data-stu-id="d1444-350">It's fine-tuned to capture streaming data, such as continuous event notifications emitted from a telemetry context.</span></span> <span data-ttu-id="d1444-351">Le service est hautement évolutif et peut stocker et [traiter des millions d’événements par seconde](https://docs.microsoft.com/azure/event-hubs/event-hubs-about).</span><span class="sxs-lookup"><span data-stu-id="d1444-351">The service is highly scalable and can store and [process millions of events per second](https://docs.microsoft.com/azure/event-hubs/event-hubs-about).</span></span> <span data-ttu-id="d1444-352">Comme illustré à la figure 4-18, il s’agit souvent d’une porte d’entrée pour un pipeline d’événements, ce qui permet de découpler le flux de réception de la consommation d’événements.</span><span class="sxs-lookup"><span data-stu-id="d1444-352">Shown in Figure 4-18, it's often a front door for an event pipeline, decoupling ingest stream from event consumption.</span></span>

![Hub d’événements Azure](./media/azure-event-hub.png)

<span data-ttu-id="d1444-354">**Figure 4-18**.</span><span class="sxs-lookup"><span data-stu-id="d1444-354">**Figure 4-18**.</span></span> <span data-ttu-id="d1444-355">Hub d’événements Azure</span><span class="sxs-lookup"><span data-stu-id="d1444-355">Azure Event Hub</span></span>

<span data-ttu-id="d1444-356">Event Hub prend en charge la faible latence et la durée de rétention configurable.</span><span class="sxs-lookup"><span data-stu-id="d1444-356">Event Hub supports low latency and configurable time retention.</span></span> <span data-ttu-id="d1444-357">Contrairement aux files d’attente et aux rubriques, Event Hubs conserver les données d’événement après qu’elles ont été lues par un consommateur.</span><span class="sxs-lookup"><span data-stu-id="d1444-357">Unlike queues and topics, Event Hubs keep event data after it's been read by a consumer.</span></span> <span data-ttu-id="d1444-358">Cette fonctionnalité permet à d’autres services d’analyse de données, internes et externes, de relire les données pour une analyse plus poussée.</span><span class="sxs-lookup"><span data-stu-id="d1444-358">This feature enables other data analytic services, both internal and external, to replay the data for further analysis.</span></span> <span data-ttu-id="d1444-359">Les événements stockés dans Event Hub sont supprimés uniquement à l’expiration de la période de rétention, ce qui correspond à un jour par défaut, mais configurable.</span><span class="sxs-lookup"><span data-stu-id="d1444-359">Events stored in event hub are only deleted upon expiration of the retention period, which is one day by default, but configurable.</span></span>

<span data-ttu-id="d1444-360">Event Hub prend en charge les protocoles de publication d’événements courants, notamment HTTPs et AMQP.</span><span class="sxs-lookup"><span data-stu-id="d1444-360">Event Hub supports common event publishing protocols including HTTPS and AMQP.</span></span> <span data-ttu-id="d1444-361">Il prend également en charge Kafka 1,0.</span><span class="sxs-lookup"><span data-stu-id="d1444-361">It also supports Kafka 1.0.</span></span> <span data-ttu-id="d1444-362">Les [applications Kafka existantes peuvent communiquer avec Event Hub](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) à l’aide du protocole Kafka, qui offre une alternative à la gestion des clusters Kafka volumineux.</span><span class="sxs-lookup"><span data-stu-id="d1444-362">[Existing Kafka applications can communicate with Event Hub](https://docs.microsoft.com/azure/event-hubs/event-hubs-for-kafka-ecosystem-overview) using the Kafka protocol providing an alternative to managing large Kafka clusters.</span></span> <span data-ttu-id="d1444-363">De nombreux systèmes Cloud natifs Open source intègrent Kafka.</span><span class="sxs-lookup"><span data-stu-id="d1444-363">Many open-source cloud-native systems embrace Kafka.</span></span>

<span data-ttu-id="d1444-364">Event Hubs implémente la diffusion de messages via un [modèle de consommateur partitionné](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) dans lequel chaque consommateur lit uniquement un sous-ensemble spécifique, ou partition, du flux de message.</span><span class="sxs-lookup"><span data-stu-id="d1444-364">Event Hubs implements message streaming through a [partitioned consumer model](https://docs.microsoft.com/azure/event-hubs/event-hubs-features) in which each consumer only reads a specific subset, or partition, of the message stream.</span></span> <span data-ttu-id="d1444-365">Ce modèle active une grande échelle horizontale pour le traitement des événements et fournit d’autres fonctionnalités axées sur les flux qui ne sont pas disponibles dans les files d’attente et les rubriques.</span><span class="sxs-lookup"><span data-stu-id="d1444-365">This pattern enables tremendous horizontal scale for event processing and provides other stream-focused features that are unavailable in queues and topics.</span></span> <span data-ttu-id="d1444-366">Une partition est une séquence ordonnée d’événements qui est conservée dans un Event Hub.</span><span class="sxs-lookup"><span data-stu-id="d1444-366">A partition is an ordered sequence of events that is held in an event hub.</span></span> <span data-ttu-id="d1444-367">À mesure que des événements plus récents arrivent, ils sont ajoutés à la fin de cette séquence.</span><span class="sxs-lookup"><span data-stu-id="d1444-367">As newer events arrive, they're added to the end of this sequence.</span></span><span data-ttu-id="d1444-368"> La figure 4-19 illustre le partitionnement dans un hub d’événements.</span><span class="sxs-lookup"><span data-stu-id="d1444-368"> Figure 4-19 shows partitioning in an Event Hub.</span></span>

![Partitionnement de hub d’événements](./media/event-hub-partitioning.png)

<span data-ttu-id="d1444-370">**Figure 4-19**.</span><span class="sxs-lookup"><span data-stu-id="d1444-370">**Figure 4-19**.</span></span> <span data-ttu-id="d1444-371">Partitionnement de hub d’événements</span><span class="sxs-lookup"><span data-stu-id="d1444-371">Event Hub partitioning</span></span>

<span data-ttu-id="d1444-372">Au lieu de lire à partir de la même ressource, chaque groupe de consommateurs lit sur un sous-ensemble, ou sur une partition, du flux de message.</span><span class="sxs-lookup"><span data-stu-id="d1444-372">Instead of reading from the same resource, each consumer group reads across a subset, or partition, of the message stream.</span></span> 

<span data-ttu-id="d1444-373">Pour les applications Cloud natives qui doivent diffuser en continu un grand nombre d’événements, Azure Event Hub peut être une solution robuste et abordable.</span><span class="sxs-lookup"><span data-stu-id="d1444-373">For cloud-native applications that must stream large numbers of events, Azure Event Hub can be a robust and affordable solution.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="d1444-374">[Précédent](front-end-communication.md)
>[Suivant](rest-grpc.md)</span><span class="sxs-lookup"><span data-stu-id="d1444-374">[Previous](front-end-communication.md)
[Next](rest-grpc.md)</span></span>

---
title: Configuration centralisée
description: La configuration centralisée à l’aide de Azure Key Vault peut faciliter la gestion des applications Cloud natives.
ms.date: 06/30/2019
ms.openlocfilehash: f4f495591550abccf2c64ef24cbe7620b039d8ca
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/23/2019
ms.locfileid: "71183517"
---
# <a name="centralized-configuration"></a><span data-ttu-id="8041b-103">Configuration centralisée</span><span class="sxs-lookup"><span data-stu-id="8041b-103">Centralized configuration</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="8041b-104">Les applications Cloud natives impliquent beaucoup plus de services en cours d’exécution que les applications monolithiques à instance unique traditionnelles.</span><span class="sxs-lookup"><span data-stu-id="8041b-104">Cloud-native applications involve many more running services than traditional single-instance monolithic apps.</span></span> <span data-ttu-id="8041b-105">La gestion des paramètres de configuration pour des dizaines de services interdépendants peut être difficile, c’est pourquoi les banques de configuration centralisées sont souvent implémentées pour les applications distribuées.</span><span class="sxs-lookup"><span data-stu-id="8041b-105">Managing configuration settings for dozens of interdependent services can be challenging, which is why centralized configuration stores are often implemented for distributed applications.</span></span>

<span data-ttu-id="8041b-106">Comme indiqué dans le [Chapitre 1](introduction.md), les recommandations relatives aux applications à douze facteurs requièrent une séparation stricte entre le code et la configuration.</span><span class="sxs-lookup"><span data-stu-id="8041b-106">As discussed in [Chapter 1](introduction.md), the Twelve-Factor App recommendations require strict separation between code and configuration.</span></span> <span data-ttu-id="8041b-107">Cela signifie que le stockage des paramètres de configuration en tant que constantes ou valeurs littérales dans le code est une violation.</span><span class="sxs-lookup"><span data-stu-id="8041b-107">This means storing configuration settings as constants or literal values in code is a violation.</span></span> <span data-ttu-id="8041b-108">Cette recommandation existe car le même code doit être utilisé dans plusieurs environnements, y compris le développement, le test, la mise en lots et la production.</span><span class="sxs-lookup"><span data-stu-id="8041b-108">This recommendation exists because the same code should be used across multiple environments, including development, testing, staging, and production.</span></span> <span data-ttu-id="8041b-109">Toutefois, les valeurs de configuration sont susceptibles de varier d’un environnement à l’autre.</span><span class="sxs-lookup"><span data-stu-id="8041b-109">However, configuration values are likely to vary between each of these environments.</span></span> <span data-ttu-id="8041b-110">Par conséquent, les valeurs de configuration doivent être stockées dans l’environnement lui-même, ou l’environnement doit stocker les informations d’identification dans un magasin de configuration centralisé.</span><span class="sxs-lookup"><span data-stu-id="8041b-110">So, configuration values should be stored in the environment itself, or the environment should store the credentials to a centralized configuration store.</span></span>

<span data-ttu-id="8041b-111">L’application eShopOnContainers comprend des fichiers de paramètres d’application locaux avec chaque microservice.</span><span class="sxs-lookup"><span data-stu-id="8041b-111">The eShopOnContainers application includes local application settings files with each microservice.</span></span> <span data-ttu-id="8041b-112">Ces fichiers sont archivés dans le contrôle de code source, mais n’incluent pas les secrets de production tels que les chaînes de connexion ou les clés API.</span><span class="sxs-lookup"><span data-stu-id="8041b-112">These files are checked into source control but don't include production secrets such as connection strings or API keys.</span></span> <span data-ttu-id="8041b-113">En production, des paramètres individuels peuvent être remplacés par des variables d’environnement par service.</span><span class="sxs-lookup"><span data-stu-id="8041b-113">In production, individual settings may be overwritten with per-service environment variables.</span></span> <span data-ttu-id="8041b-114">Il s’agit d’une pratique courante pour les applications hébergées, mais elle ne fournit pas de magasin de configuration centralisé.</span><span class="sxs-lookup"><span data-stu-id="8041b-114">This is a common practice for hosted applications, but doesn't provide a central configuration store.</span></span> <span data-ttu-id="8041b-115">Pour prendre en charge la gestion centralisée des paramètres de configuration, chaque microservice comprend un paramètre permettant de basculer entre l’utilisation des paramètres locaux et des paramètres de Azure Key Vault.</span><span class="sxs-lookup"><span data-stu-id="8041b-115">To support centralized management of configuration settings, each microservice includes a setting to toggle between its use of local settings or Azure Key Vault settings.</span></span>

## <a name="azure-key-vault"></a><span data-ttu-id="8041b-116">Azure Key Vault</span><span class="sxs-lookup"><span data-stu-id="8041b-116">Azure Key Vault</span></span>

<span data-ttu-id="8041b-117">Azure Key Vault fournit un stockage sécurisé des jetons, des mots de passe, des certificats, des clés d’API et d’autres secrets sensibles.</span><span class="sxs-lookup"><span data-stu-id="8041b-117">Azure Key Vault provides secure storage of tokens, passwords, certificates, API keys, and other sensitive secrets.</span></span> <span data-ttu-id="8041b-118">L’accès à Key Vault nécessite une authentification et une autorisation appropriées de l’appelant, ce qui, dans le cas des microservices eShopOnContainers, est l’utilisation d’une combinaison ClientId/ClientSecret.</span><span class="sxs-lookup"><span data-stu-id="8041b-118">Access to Key Vault requires proper caller authentication and authorization, which in the case of the eShopOnContainers microservices means the use of a ClientId/ClientSecret combination.</span></span> <span data-ttu-id="8041b-119">N’archivez pas ces informations d’identification dans le contrôle de code source, mais définissez-les à la place dans l’environnement de l’application.</span><span class="sxs-lookup"><span data-stu-id="8041b-119">Don't check in these credentials into source control, but instead set in the application's environment.</span></span> <span data-ttu-id="8041b-120">L’accès direct aux Key Vault à partir de AKS peut être obtenu à l’aide de [Key Vault FlexVolume](https://github.com/Azure/kubernetes-keyvault-flexvol).</span><span class="sxs-lookup"><span data-stu-id="8041b-120">Direct access to Key Vault from AKS can be achieved using [Key Vault FlexVolume](https://github.com/Azure/kubernetes-keyvault-flexvol).</span></span>

<span data-ttu-id="8041b-121">Avec la configuration centralisée, les paramètres qui s’appliquent à l’ensemble de l’application, tels que le point de terminaison de journalisation centralisée, peuvent être définis une fois et utilisés par chaque partie de l’application distribuée.</span><span class="sxs-lookup"><span data-stu-id="8041b-121">With centralized configuration, settings that apply to the entire application, such as the centralized logging endpoint, can be set once and used by every part of the distributed application.</span></span> <span data-ttu-id="8041b-122">Bien que les microservices doivent être indépendants les uns des autres, il y a généralement des dépendances partagées dont les détails de configuration peuvent tirer parti d’un magasin de configuration centralisé.</span><span class="sxs-lookup"><span data-stu-id="8041b-122">Although microservices should be independent of one another, there will typically still be some shared dependencies whose configuration details can benefit from a centralized configuration store.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="8041b-123">[Précédent](deploy-eshoponcontainers-azure.md)
>[Suivant](scale-applications.md)</span><span class="sxs-lookup"><span data-stu-id="8041b-123">[Previous](deploy-eshoponcontainers-azure.md)
[Next](scale-applications.md)</span></span> <!-- Next Chapter -->

---
title: Communication client et front-end
description: Découvrez comment les clients frontaux communiquent avec les systèmes natifs du Cloud
author: robvet
ms.date: 09/08/2019
ms.openlocfilehash: 89f13ea1c9ecbe92e959ae63a4c21bf7775f8943
ms.sourcegitcommit: 957c49696eaf048c284ef8f9f8ffeb562357ad95
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/07/2020
ms.locfileid: "82895571"
---
# <a name="front-end-client-communication"></a><span data-ttu-id="633be-103">Communication client et front-end</span><span class="sxs-lookup"><span data-stu-id="633be-103">Front-end client communication</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="633be-104">Dans un système Cloud natif, les clients frontaux (applications mobiles, Web et de bureau) requièrent un canal de communication pour interagir avec les microservices back-end indépendants.</span><span class="sxs-lookup"><span data-stu-id="633be-104">In a cloud-native system, front-end clients (mobile, web, and desktop applications) require a communication channel to interact with independent back-end microservices.</span></span>  

<span data-ttu-id="633be-105">Quelles sont les options ?</span><span class="sxs-lookup"><span data-stu-id="633be-105">What are the options?</span></span>

<span data-ttu-id="633be-106">Pour simplifier les choses, un client frontal peut *communiquer directement* avec les microservices back-end, comme illustré à la figure 4-2.</span><span class="sxs-lookup"><span data-stu-id="633be-106">To keep things simple, a front-end client could *directly communicate* with the back-end microservices, shown in Figure 4-2.</span></span>

![Communication directe entre le client et le service](./media/direct-client-to-service-communication.png)

<span data-ttu-id="633be-108">**Figure 4-2.**</span><span class="sxs-lookup"><span data-stu-id="633be-108">**Figure 4-2.**</span></span> <span data-ttu-id="633be-109">Communication directe entre le client et le service</span><span class="sxs-lookup"><span data-stu-id="633be-109">Direct client to service communication</span></span>

<span data-ttu-id="633be-110">Avec cette approche, chaque microservice a un point de terminaison public accessible par les clients frontaux.</span><span class="sxs-lookup"><span data-stu-id="633be-110">With this approach, each microservice has a public endpoint that is accessible by front-end clients.</span></span> <span data-ttu-id="633be-111">Dans un environnement de production, vous devez placer un équilibreur de charge devant les microservices, en routant le trafic proportionnellement.</span><span class="sxs-lookup"><span data-stu-id="633be-111">In a production environment, you'd place a load balancer in front of the microservices, routing traffic proportionately.</span></span>

<span data-ttu-id="633be-112">Bien qu’elles soient simples à implémenter, la communication directe des clients est acceptable uniquement pour les applications de microservice simples.</span><span class="sxs-lookup"><span data-stu-id="633be-112">While simple to implement, direct client communication would be acceptable only for simple microservice applications.</span></span> <span data-ttu-id="633be-113">Ce modèle associe étroitement les clients frontaux aux principaux services principaux, en ouvrant la porte à un certain nombre de problèmes, notamment :</span><span class="sxs-lookup"><span data-stu-id="633be-113">This pattern tightly couples front-end clients to core back-end services, opening the door for a number of problems, including:</span></span>

- <span data-ttu-id="633be-114">Sensibilité du client à la refactorisation du service principal.</span><span class="sxs-lookup"><span data-stu-id="633be-114">Client susceptibility to back-end service refactoring.</span></span>
- <span data-ttu-id="633be-115">Une surface d’attaque plus étendue en tant que services principaux principaux est directement exposée.</span><span class="sxs-lookup"><span data-stu-id="633be-115">A wider attack surface as core back-end services are directly exposed.</span></span>
- <span data-ttu-id="633be-116">Duplication des préoccupations transversales dans chaque microservice.</span><span class="sxs-lookup"><span data-stu-id="633be-116">Duplication of cross-cutting concerns across each microservice.</span></span>
- <span data-ttu-id="633be-117">Code client trop complexe : les clients doivent effectuer le suivi de plusieurs points de terminaison et gérer les défaillances de manière résiliente.</span><span class="sxs-lookup"><span data-stu-id="633be-117">Overly complex client code - clients must keep track of multiple endpoints and handle failures in a resilient way.</span></span>

<span data-ttu-id="633be-118">Au lieu de cela, un modèle de conception de Cloud largement accepté consiste à implémenter un [service de passerelle d’API](../microservices/architect-microservice-container-applications/direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md) entre les applications frontales et les services principaux.</span><span class="sxs-lookup"><span data-stu-id="633be-118">Instead, a widely accepted cloud design pattern is to implement an [API Gateway Service](../microservices/architect-microservice-container-applications/direct-client-to-microservice-communication-versus-the-api-gateway-pattern.md) between the front-end applications and back-end services.</span></span> <span data-ttu-id="633be-119">Le modèle est illustré dans la figure 4-3.</span><span class="sxs-lookup"><span data-stu-id="633be-119">The pattern is shown in Figure 4-3.</span></span>

![Modèle de passerelle d’API](./media/api-gateway-pattern.png)

<span data-ttu-id="633be-121">**Figure 4-3.**</span><span class="sxs-lookup"><span data-stu-id="633be-121">**Figure 4-3.**</span></span> <span data-ttu-id="633be-122">Modèle de passerelle d’API</span><span class="sxs-lookup"><span data-stu-id="633be-122">API gateway pattern</span></span>

<span data-ttu-id="633be-123">Dans la figure précédente, notez la manière dont le service de passerelle d’API soustrait les microservices principaux principaux.</span><span class="sxs-lookup"><span data-stu-id="633be-123">In the previous figure, note how the API Gateway service abstracts the back-end core microservices.</span></span> <span data-ttu-id="633be-124">Implémenté comme une API Web, il agit comme un *proxy inverse*, acheminant le trafic entrant vers les microservices internes.</span><span class="sxs-lookup"><span data-stu-id="633be-124">Implemented as a web API, it acts as a *reverse proxy*, routing incoming traffic to the internal microservices.</span></span>

<span data-ttu-id="633be-125">La passerelle isole le client du partitionnement de service interne et de la refactorisation.</span><span class="sxs-lookup"><span data-stu-id="633be-125">The gateway insulates the client from internal service partitioning and refactoring.</span></span> <span data-ttu-id="633be-126">Si vous modifiez un service principal, vous pouvez l’inclure dans la passerelle sans rompre le client.</span><span class="sxs-lookup"><span data-stu-id="633be-126">If you change a back-end service, you accommodate for it in the gateway without breaking the client.</span></span> <span data-ttu-id="633be-127">C’est également votre première ligne de défense pour les problèmes transversaux, tels que l’identité, la mise en cache, la résilience, le contrôle et la limitation.</span><span class="sxs-lookup"><span data-stu-id="633be-127">It's also your first line of defense for cross-cutting concerns, such as identity, caching, resiliency, metering, and throttling.</span></span> <span data-ttu-id="633be-128">La plupart de ces problèmes de coupe croisée peuvent être déchargés à partir des services principaux de la passerelle, ce qui simplifie les services principaux.</span><span class="sxs-lookup"><span data-stu-id="633be-128">Many of these cross-cutting concerns can be off-loaded from the back-end core services to the gateway, simplifying the back-end services.</span></span>

<span data-ttu-id="633be-129">Vous devez veiller à garder la passerelle d’API simple et rapide.</span><span class="sxs-lookup"><span data-stu-id="633be-129">Care must be taken to keep the API Gateway simple and fast.</span></span> <span data-ttu-id="633be-130">En règle générale, la logique métier est conservée hors de la passerelle.</span><span class="sxs-lookup"><span data-stu-id="633be-130">Typically, business logic is kept out of the gateway.</span></span> <span data-ttu-id="633be-131">Une passerelle complexe risque de devenir un goulot d’étranglement et de finir un monolithique.</span><span class="sxs-lookup"><span data-stu-id="633be-131">A complex gateway risks becoming a bottleneck and eventually a monolith itself.</span></span> <span data-ttu-id="633be-132">Les systèmes plus grands exposent souvent plusieurs passerelles d’API segmentées par type de client (mobile, Web, ordinateur de bureau) ou les fonctionnalités principales.</span><span class="sxs-lookup"><span data-stu-id="633be-132">Larger systems often expose multiple API Gateways segmented by client type (mobile, web, desktop) or back-end functionality.</span></span> <span data-ttu-id="633be-133">Le modèle [backend pour les serveurs frontaux](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) fournit une direction pour l’implémentation de plusieurs passerelles.</span><span class="sxs-lookup"><span data-stu-id="633be-133">The [Backend for Frontends](https://docs.microsoft.com/azure/architecture/patterns/backends-for-frontends) pattern provides direction for implementing multiple gateways.</span></span> <span data-ttu-id="633be-134">Le modèle est illustré dans la figure 4-4.</span><span class="sxs-lookup"><span data-stu-id="633be-134">The pattern is shown in Figure 4-4.</span></span>

![Modèle de passerelle d’API](./media/backend-for-frontend-pattern.png)

<span data-ttu-id="633be-136">**Figure 4-4.**</span><span class="sxs-lookup"><span data-stu-id="633be-136">**Figure 4-4.**</span></span> <span data-ttu-id="633be-137">Backend pour le modèle frontend</span><span class="sxs-lookup"><span data-stu-id="633be-137">Backend for frontend pattern</span></span>

<span data-ttu-id="633be-138">Notez dans la figure précédente Comment le trafic entrant est envoyé à une passerelle d’API spécifique basée sur le type de client : Web, mobile ou application de bureau.</span><span class="sxs-lookup"><span data-stu-id="633be-138">Note in the previous figure how incoming traffic is sent to a specific API gateway - based upon client type: web, mobile, or desktop app.</span></span> <span data-ttu-id="633be-139">Cette approche est logique, car les fonctionnalités de chaque appareil diffèrent considérablement selon les limitations du facteur de forme, des performances et de l’affichage.</span><span class="sxs-lookup"><span data-stu-id="633be-139">This approach makes sense as the capabilities of each device differ significantly across form factor, performance, and display limitations.</span></span> <span data-ttu-id="633be-140">En général, les applications mobiles exposent moins de fonctionnalités qu’une application de bureau ou de navigateur.</span><span class="sxs-lookup"><span data-stu-id="633be-140">Typically mobile applications expose less functionality than a browser or desktop applications.</span></span> <span data-ttu-id="633be-141">Chaque passerelle peut être optimisée pour correspondre aux fonctionnalités et fonctionnalités de l’appareil correspondant.</span><span class="sxs-lookup"><span data-stu-id="633be-141">Each gateway can be optimized to match the capabilities and functionality of the corresponding device.</span></span>

<span data-ttu-id="633be-142">Pour commencer, vous pouvez créer votre propre service de passerelle d’API.</span><span class="sxs-lookup"><span data-stu-id="633be-142">To start, you could build your own API Gateway service.</span></span> <span data-ttu-id="633be-143">Une recherche rapide de GitHub fournit de nombreux exemples.</span><span class="sxs-lookup"><span data-stu-id="633be-143">A quick search of GitHub will provide many examples.</span></span> <span data-ttu-id="633be-144">Toutefois, il existe plusieurs infrastructures et produits de passerelle commerciaux disponibles.</span><span class="sxs-lookup"><span data-stu-id="633be-144">However, there are several frameworks and commercial gateway products available.</span></span>

## <a name="ocelot-gateway"></a><span data-ttu-id="633be-145">Passerelle Ocelot</span><span class="sxs-lookup"><span data-stu-id="633be-145">Ocelot Gateway</span></span>

<span data-ttu-id="633be-146">Pour les applications simples en mode Cloud .NET, vous pouvez envisager la [passerelle Ocelot](https://github.com/ThreeMammals/Ocelot).</span><span class="sxs-lookup"><span data-stu-id="633be-146">For simple .NET cloud-native applications, you might consider the [Ocelot Gateway](https://github.com/ThreeMammals/Ocelot).</span></span> <span data-ttu-id="633be-147">Ocelot est une passerelle d’API Open source créée pour les microservices .NET qui requièrent un point d’entrée unifié dans leur système.</span><span class="sxs-lookup"><span data-stu-id="633be-147">Ocelot is an Open Source API Gateway created for .NET microservices that require a unified point of entry into their system.</span></span> <span data-ttu-id="633be-148">Elle est légère, rapide et évolutive.</span><span class="sxs-lookup"><span data-stu-id="633be-148">It's lightweight, fast, scalable.</span></span>

<span data-ttu-id="633be-149">Comme toute passerelle d’API, ses principales fonctionnalités sont de transférer les requêtes HTTP entrantes vers les services en aval.</span><span class="sxs-lookup"><span data-stu-id="633be-149">Like any API Gateway, its primary functionality is to forward incoming HTTP requests to downstream services.</span></span> <span data-ttu-id="633be-150">En outre, il prend en charge un large éventail de fonctionnalités configurables dans un pipeline d’intergiciel (middleware) .NET Core.</span><span class="sxs-lookup"><span data-stu-id="633be-150">Additionally, it supports a wide variety of capabilities that are configurable in a .NET Core middleware pipeline.</span></span> <span data-ttu-id="633be-151">Son ensemble de fonctionnalités est présenté dans le tableau suivant.</span><span class="sxs-lookup"><span data-stu-id="633be-151">Its feature set is presented in following table.</span></span>

|<span data-ttu-id="633be-152">Fonctionnalités de Ocelot</span><span class="sxs-lookup"><span data-stu-id="633be-152">Ocelot Features</span></span>  | |
| :-------- | :-------- |
| <span data-ttu-id="633be-153">Routage</span><span class="sxs-lookup"><span data-stu-id="633be-153">Routing</span></span> | <span data-ttu-id="633be-154">Authentification</span><span class="sxs-lookup"><span data-stu-id="633be-154">Authentication</span></span> |
| <span data-ttu-id="633be-155">Agrégation des demandes</span><span class="sxs-lookup"><span data-stu-id="633be-155">Request Aggregation</span></span> | <span data-ttu-id="633be-156">Autorisation</span><span class="sxs-lookup"><span data-stu-id="633be-156">Authorization</span></span> |
| <span data-ttu-id="633be-157">Découverte de service (avec consul et Eureka)</span><span class="sxs-lookup"><span data-stu-id="633be-157">Service Discovery (with Consul and Eureka)</span></span> | <span data-ttu-id="633be-158">Limitation</span><span class="sxs-lookup"><span data-stu-id="633be-158">Throttling</span></span> |
| <span data-ttu-id="633be-159">Équilibrage de la charge.</span><span class="sxs-lookup"><span data-stu-id="633be-159">Load Balancing</span></span> | <span data-ttu-id="633be-160">Journalisation, suivi</span><span class="sxs-lookup"><span data-stu-id="633be-160">Logging, Tracing</span></span> |
| <span data-ttu-id="633be-161">Mise en cache</span><span class="sxs-lookup"><span data-stu-id="633be-161">Caching</span></span> | <span data-ttu-id="633be-162">En-têtes/transformation de chaîne de requête</span><span class="sxs-lookup"><span data-stu-id="633be-162">Headers/Query String Transformation</span></span> |
| <span data-ttu-id="633be-163">Transfert de corrélation</span><span class="sxs-lookup"><span data-stu-id="633be-163">Correlation Pass-Through</span></span> | <span data-ttu-id="633be-164">Intergiciel (middleware) personnalisé</span><span class="sxs-lookup"><span data-stu-id="633be-164">Custom Middleware</span></span> |
| <span data-ttu-id="633be-165">Qualité de service</span><span class="sxs-lookup"><span data-stu-id="633be-165">Quality of Service</span></span> | <span data-ttu-id="633be-166">Stratégies de nouvelle tentative</span><span class="sxs-lookup"><span data-stu-id="633be-166">Retry Policies</span></span> |

<span data-ttu-id="633be-167">Chaque passerelle Ocelot spécifie les adresses en amont et en aval et les fonctionnalités configurables dans un fichier de configuration JSON.</span><span class="sxs-lookup"><span data-stu-id="633be-167">Each Ocelot gateway specifies the upstream and downstream addresses and configurable features in a JSON configuration file.</span></span> <span data-ttu-id="633be-168">Le client envoie une requête HTTP à la passerelle ocelot.</span><span class="sxs-lookup"><span data-stu-id="633be-168">The client sends an HTTP request to the Ocelot gateway.</span></span> <span data-ttu-id="633be-169">Une fois reçu, Ocelot passe l’objet HttpRequest via son pipeline en le manipulant dans l’état spécifié par sa configuration.</span><span class="sxs-lookup"><span data-stu-id="633be-169">Once received, Ocelot passes the HttpRequest object through its pipeline manipulating it into the state specified by its configuration.</span></span> <span data-ttu-id="633be-170">À la fin du pipeline, Ocelot crée un nouveau HTTPResponseObject et le transmet au service en aval.</span><span class="sxs-lookup"><span data-stu-id="633be-170">At the end of pipeline, Ocelot creates a new HTTPResponseObject and passes it to the downstream service.</span></span> <span data-ttu-id="633be-171">Pour la réponse, Ocelot inverse le pipeline, en renvoyant la réponse au client.</span><span class="sxs-lookup"><span data-stu-id="633be-171">For the response, Ocelot reverses the pipeline, sending the response back to client.</span></span>

<span data-ttu-id="633be-172">Ocelot est disponible sous forme de package NuGet.</span><span class="sxs-lookup"><span data-stu-id="633be-172">Ocelot is available as a NuGet package.</span></span> <span data-ttu-id="633be-173">Il cible le .NET standard 2,0, ce qui le rend compatible avec les runtimes .NET Core 2.0 + et .NET Framework 4.6.1 +.</span><span class="sxs-lookup"><span data-stu-id="633be-173">It targets the NET Standard 2.0, making it compatible with both .NET Core 2.0+ and .NET Framework 4.6.1+ runtimes.</span></span> <span data-ttu-id="633be-174">Ocelot s’intègre à tout ce qui parle HTTP et s’exécute sur les plateformes prises en charge par .NET Core : Linux, macOS et Windows.</span><span class="sxs-lookup"><span data-stu-id="633be-174">Ocelot integrates with anything that speaks HTTP and runs on the platforms which .NET Core supports: Linux, macOS, and Windows.</span></span> <span data-ttu-id="633be-175">Ocelot est extensible et prend en charge de nombreuses plateformes modernes, y compris les conteneurs d’ancrage, les services Kubernetes Azure ou d’autres clouds publics.</span><span class="sxs-lookup"><span data-stu-id="633be-175">Ocelot is extensible and supports many modern platforms, including Docker containers, Azure Kubernetes Services, or other public clouds.</span></span>  <span data-ttu-id="633be-176">Ocelot s’intègre aux packages Open source, tels que les [Eureka](https://github.com/Netflix/eureka) [consulaire](https://www.consul.io), [GraphQL](https://graphql.org)et Netflix.</span><span class="sxs-lookup"><span data-stu-id="633be-176">Ocelot integrates with open-source packages like [Consul](https://www.consul.io), [GraphQL](https://graphql.org), and Netflix's [Eureka](https://github.com/Netflix/eureka).</span></span>

<span data-ttu-id="633be-177">Envisagez Ocelot pour les applications Cloud natives simples qui ne nécessitent pas l’ensemble complet de fonctionnalités d’une passerelle d’API commerciale.</span><span class="sxs-lookup"><span data-stu-id="633be-177">Consider Ocelot for simple cloud-native applications that don't require the rich feature-set of a commercial API gateway.</span></span>

## <a name="azure-application-gateway"></a><span data-ttu-id="633be-178">Azure Application Gateway</span><span class="sxs-lookup"><span data-stu-id="633be-178">Azure Application Gateway</span></span>

<span data-ttu-id="633be-179">Pour les exigences de passerelle simples, vous pouvez envisager [Azure application passerelle](https://docs.microsoft.com/azure/application-gateway/overview).</span><span class="sxs-lookup"><span data-stu-id="633be-179">For simple gateway requirements, you may consider [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/overview).</span></span> <span data-ttu-id="633be-180">Disponible en tant que [service PaaS](https://azure.microsoft.com/overview/what-is-paas/)Azure, il comprend des fonctionnalités de passerelle de base telles que le routage d’URL, la terminaison SSL et un pare-feu d’applications Web.</span><span class="sxs-lookup"><span data-stu-id="633be-180">Available as an Azure [PaaS service](https://azure.microsoft.com/overview/what-is-paas/), it includes basic gateway features such as URL routing, SSL termination, and a Web Application Firewall.</span></span> <span data-ttu-id="633be-181">Le service prend en charge les fonctionnalités d' [équilibrage de charge de couche 7](https://www.nginx.com/resources/glossary/layer-7-load-balancing/) .</span><span class="sxs-lookup"><span data-stu-id="633be-181">The service supports [Layer-7 load balancing](https://www.nginx.com/resources/glossary/layer-7-load-balancing/) capabilities.</span></span> <span data-ttu-id="633be-182">Avec la couche 7, vous pouvez acheminer les demandes en fonction du contenu réel d’un message HTTP, pas seulement des paquets réseau TCP de bas niveau.</span><span class="sxs-lookup"><span data-stu-id="633be-182">With Layer 7, you can route requests based on the actual content of an HTTP message, not just low-level TCP network packets.</span></span>

<span data-ttu-id="633be-183">Tout au long de ce document, nous nous contribuons à l’hébergement des systèmes Cloud natifs dans [Kubernetes](https://www.infoworld.com/article/3268073/what-is-kubernetes-your-next-application-platform.html).</span><span class="sxs-lookup"><span data-stu-id="633be-183">Throughout this book, we evangelize hosting cloud-native systems in [Kubernetes](https://www.infoworld.com/article/3268073/what-is-kubernetes-your-next-application-platform.html).</span></span> <span data-ttu-id="633be-184">Un Orchestrator de conteneur, Kubernetes automatise le déploiement, la mise à l’échelle et les problèmes opérationnels des charges de travail en conteneur.</span><span class="sxs-lookup"><span data-stu-id="633be-184">A container orchestrator, Kubernetes automates the deployment, scaling, and operational concerns of containerized workloads.</span></span> <span data-ttu-id="633be-185">Azure Application passerelle peut être configurée en tant que passerelle d’API pour le cluster de [service Azure Kubernetes](https://azure.microsoft.com/services/kubernetes-service/) .</span><span class="sxs-lookup"><span data-stu-id="633be-185">Azure Application Gateway can be configured as an API gateway for [Azure Kubernetes Service](https://azure.microsoft.com/services/kubernetes-service/) cluster.</span></span>

<span data-ttu-id="633be-186">Le [contrôleur](https://azure.github.io/application-gateway-kubernetes-ingress/) d’entrée Application Gateway permet à Azure application passerelle de travailler directement avec le [service Azure Kubernetes](https://azure.microsoft.com/services/kubernetes-service/).</span><span class="sxs-lookup"><span data-stu-id="633be-186">The [Application Gateway Ingress Controller](https://azure.github.io/application-gateway-kubernetes-ingress/) enables Azure Application Gateway to work directly with [Azure Kubernetes Service](https://azure.microsoft.com/services/kubernetes-service/).</span></span> <span data-ttu-id="633be-187">La figure 4,5 illustre l’architecture.</span><span class="sxs-lookup"><span data-stu-id="633be-187">Figure 4.5 shows the architecture.</span></span>

![Contrôleur d’entrée Application Gateway](./media/application-gateway-ingress-controller.png)

<span data-ttu-id="633be-189">**Figure 4-5.**</span><span class="sxs-lookup"><span data-stu-id="633be-189">**Figure 4-5.**</span></span> <span data-ttu-id="633be-190">Contrôleur d’entrée Application Gateway</span><span class="sxs-lookup"><span data-stu-id="633be-190">Application Gateway Ingress Controller</span></span>

<span data-ttu-id="633be-191">Kubernetes comprend une fonctionnalité intégrée qui prend en charge l’équilibrage de charge HTTP (niveau 7) [, appelé entrée](https://kubernetes.io/docs/concepts/services-networking/ingress/).</span><span class="sxs-lookup"><span data-stu-id="633be-191">Kubernetes includes a built-in feature that supports HTTP (Level 7) load balancing, called [Ingress](https://kubernetes.io/docs/concepts/services-networking/ingress/).</span></span> <span data-ttu-id="633be-192">Entrée définit un ensemble de règles sur la façon dont les instances de microservice dans AKS peuvent être exposées au monde extérieur.</span><span class="sxs-lookup"><span data-stu-id="633be-192">Ingress defines a set of rules for how microservice instances inside AKS can be exposed to the outside world.</span></span> <span data-ttu-id="633be-193">Dans l’image précédente, le contrôleur d’entrée interprète les règles d’entrée configurées pour le cluster et configure automatiquement la passerelle Azure Application.</span><span class="sxs-lookup"><span data-stu-id="633be-193">In the previous image, the ingress controller interprets the ingress rules configured for the cluster and automatically configures the Azure Application Gateway.</span></span> <span data-ttu-id="633be-194">Sur la base de ces règles, le Application Gateway achemine le trafic vers les microservices exécutés dans AKS.</span><span class="sxs-lookup"><span data-stu-id="633be-194">Based on those rules, the Application Gateway routes traffic to microservices running inside AKS.</span></span> <span data-ttu-id="633be-195">Le contrôleur d’entrée écoute les modifications apportées aux règles d’entrée et apporte les modifications appropriées à la passerelle Azure Application.</span><span class="sxs-lookup"><span data-stu-id="633be-195">The ingress controller listens for changes to ingress rules and makes the appropriate changes to the Azure Application Gateway.</span></span>

## <a name="azure-api-management"></a><span data-ttu-id="633be-196">Gestion des API Azure</span><span class="sxs-lookup"><span data-stu-id="633be-196">Azure API Management</span></span>

<span data-ttu-id="633be-197">Pour les systèmes Cloud natifs modérés à grande échelle, vous pouvez envisager la [gestion des API Azure](https://azure.microsoft.com/services/api-management/).</span><span class="sxs-lookup"><span data-stu-id="633be-197">For moderate to large-scale cloud-native systems, you may consider [Azure API Management](https://azure.microsoft.com/services/api-management/).</span></span> <span data-ttu-id="633be-198">Il s’agit d’un service basé sur le Cloud qui ne résout pas uniquement vos besoins en matière de passerelle d’API, mais fournit un environnement de développement et d’administration complet.</span><span class="sxs-lookup"><span data-stu-id="633be-198">It's a cloud-based service that not only solves your API Gateway needs, but provides a full-featured developer and administrative experience.</span></span> <span data-ttu-id="633be-199">La gestion des API est illustrée dans la figure 4-6.</span><span class="sxs-lookup"><span data-stu-id="633be-199">API Management is shown in Figure 4-6.</span></span>

![Gestion des API Azure](./media/azure-api-management.png)

<span data-ttu-id="633be-201">**Figure 4-6.**</span><span class="sxs-lookup"><span data-stu-id="633be-201">**Figure 4-6.**</span></span> <span data-ttu-id="633be-202">Gestion des API Azure</span><span class="sxs-lookup"><span data-stu-id="633be-202">Azure API Management</span></span>

<span data-ttu-id="633be-203">Pour commencer, la gestion des API expose un serveur de passerelle qui permet un accès contrôlé aux services principaux en fonction de règles et de stratégies configurables.</span><span class="sxs-lookup"><span data-stu-id="633be-203">To start, API Management exposes a gateway server that allows controlled access to back-end services based upon configurable rules and policies.</span></span> <span data-ttu-id="633be-204">Ces services peuvent se trouver dans le Cloud Azure, dans votre centre de données local ou dans d’autres clouds publics.</span><span class="sxs-lookup"><span data-stu-id="633be-204">These services can be in the Azure cloud, your on-prem data center, or other public clouds.</span></span> <span data-ttu-id="633be-205">Les clés API et les jetons JWT déterminent qui peut faire quoi.</span><span class="sxs-lookup"><span data-stu-id="633be-205">API keys and JWT tokens determine who can do what.</span></span> <span data-ttu-id="633be-206">Tout le trafic est journalisé à des fins analytiques.</span><span class="sxs-lookup"><span data-stu-id="633be-206">All traffic is logged for analytical purposes.</span></span>

<span data-ttu-id="633be-207">Pour les développeurs, la gestion des API offre un portail des développeurs qui permet d’accéder aux services, à la documentation et à des exemples de code pour les appeler.</span><span class="sxs-lookup"><span data-stu-id="633be-207">For developers, API Management offers a developer portal that provides access to services, documentation, and sample code for invoking them.</span></span> <span data-ttu-id="633be-208">Les développeurs peuvent utiliser l’API Swagger/Open pour inspecter les points de terminaison de service et analyser leur utilisation.</span><span class="sxs-lookup"><span data-stu-id="633be-208">Developers can use Swagger/Open API to inspect service endpoints and analyze their usage.</span></span> <span data-ttu-id="633be-209">Le service fonctionne sur les principales plateformes de développement : .NET, Java, Golang et bien plus encore.</span><span class="sxs-lookup"><span data-stu-id="633be-209">The service works across the major development platforms: .NET, Java, Golang, and more.</span></span>

<span data-ttu-id="633be-210">Le portail des éditeurs expose un tableau de bord de gestion dans lequel les administrateurs exposent les API et gèrent leur comportement.</span><span class="sxs-lookup"><span data-stu-id="633be-210">The publisher portal exposes a management dashboard where administrators expose APIs and manage their behavior.</span></span> <span data-ttu-id="633be-211">L’accès au service peut être accordé, surveillé par l’intégrité du service et les télémétries de service collectées.</span><span class="sxs-lookup"><span data-stu-id="633be-211">Service access can be granted, service health monitored, and service telemetry gathered.</span></span> <span data-ttu-id="633be-212">Les administrateurs appliquent des *stratégies* à chaque point de terminaison pour affecter le comportement.</span><span class="sxs-lookup"><span data-stu-id="633be-212">Administrators apply *policies* to each endpoint to affect behavior.</span></span> <span data-ttu-id="633be-213">Les [stratégies](https://docs.microsoft.com/azure/api-management/api-management-howto-policies) sont des instructions prégénérées qui s’exécutent de façon séquentielle pour chaque appel de service.</span><span class="sxs-lookup"><span data-stu-id="633be-213">[Policies](https://docs.microsoft.com/azure/api-management/api-management-howto-policies) are pre-built statements that execute sequentially for each service call.</span></span>  <span data-ttu-id="633be-214">Les stratégies sont configurées pour un appel entrant, sortant, ou appelées en cas d’erreur.</span><span class="sxs-lookup"><span data-stu-id="633be-214">Policies are configured for an inbound call, outbound call, or invoked upon an error.</span></span> <span data-ttu-id="633be-215">Les stratégies peuvent être appliquées à différentes étendues de service pour activer l’ordonnancement déterministe lors de la combinaison de stratégies.</span><span class="sxs-lookup"><span data-stu-id="633be-215">Policies can be applied at different service scopes as to enable deterministic ordering when combining policies.</span></span> <span data-ttu-id="633be-216">Le produit est fourni avec un grand nombre de [stratégies](https://docs.microsoft.com/azure/api-management/api-management-policies)prédéfinies.</span><span class="sxs-lookup"><span data-stu-id="633be-216">The product ships with a large number of prebuilt [policies](https://docs.microsoft.com/azure/api-management/api-management-policies).</span></span>

<span data-ttu-id="633be-217">Voici des exemples de la façon dont les stratégies peuvent affecter le comportement de vos services Cloud natifs :</span><span class="sxs-lookup"><span data-stu-id="633be-217">Here are examples of how policies can affect the behavior of your cloud-native services:</span></span>  

- <span data-ttu-id="633be-218">Limitez l’accès au service.</span><span class="sxs-lookup"><span data-stu-id="633be-218">Restrict service access.</span></span>
- <span data-ttu-id="633be-219">Appliquer l’authentification.</span><span class="sxs-lookup"><span data-stu-id="633be-219">Enforce authentication.</span></span>  
- <span data-ttu-id="633be-220">Limiter les appels à partir d’une seule source, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="633be-220">Throttle calls from a single source, if necessary.</span></span>
- <span data-ttu-id="633be-221"> Activation de la mise en cache.</span><span class="sxs-lookup"><span data-stu-id="633be-221">Enable caching.</span></span>
- <span data-ttu-id="633be-222">Bloquer les appels à partir d’adresses IP spécifiques.</span><span class="sxs-lookup"><span data-stu-id="633be-222">Block calls from specific IP addresses.</span></span>
- <span data-ttu-id="633be-223">Contrôler le déroulement du service.</span><span class="sxs-lookup"><span data-stu-id="633be-223">Control the flow of the service.</span></span>
- <span data-ttu-id="633be-224">Convertissez les demandes de SOAP à REST ou entre des formats de données différents, par exemple de XML à JSON.</span><span class="sxs-lookup"><span data-stu-id="633be-224">Convert requests from SOAP to REST or between different data formats, such as from XML to JSON.</span></span>

<span data-ttu-id="633be-225">La gestion des API Azure peut exposer des services principaux qui sont hébergés n’importe où, dans le Cloud ou dans votre centre de données.</span><span class="sxs-lookup"><span data-stu-id="633be-225">Azure API Management can expose back-end services that are hosted anywhere – in the cloud or your data center.</span></span> <span data-ttu-id="633be-226">Pour les services hérités que vous pouvez exposer dans vos systèmes Cloud natifs, il prend en charge les API REST et SOAP.</span><span class="sxs-lookup"><span data-stu-id="633be-226">For legacy services that you may expose in your cloud-native systems, it supports both REST and SOAP APIs.</span></span> <span data-ttu-id="633be-227">Même les autres services Azure peuvent être exposés via la gestion des API.</span><span class="sxs-lookup"><span data-stu-id="633be-227">Even other Azure services can be exposed through API Management.</span></span> <span data-ttu-id="633be-228">Vous pouvez placer une API gérée sur un service de sauvegarde Azure comme [Azure Service bus](https://azure.microsoft.com/services/service-bus/) ou [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/).</span><span class="sxs-lookup"><span data-stu-id="633be-228">You could place a managed API on top of an Azure backing service like [Azure Service Bus](https://azure.microsoft.com/services/service-bus/) or [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/).</span></span> <span data-ttu-id="633be-229">La gestion des API Azure n’inclut pas la prise en charge de l’équilibrage de charge intégré et doit être utilisée conjointement avec un service d’équilibrage de charge.</span><span class="sxs-lookup"><span data-stu-id="633be-229">Azure API Management doesn't include built-in load-balancing support and should be used in conjunction with a load-balancing service.</span></span>

<span data-ttu-id="633be-230">La gestion des API Azure est disponible sur [quatre niveaux différents](https://azure.microsoft.com/pricing/details/api-management/):</span><span class="sxs-lookup"><span data-stu-id="633be-230">Azure API Management is available across [four different tiers](https://azure.microsoft.com/pricing/details/api-management/):</span></span>

- <span data-ttu-id="633be-231">Développeur</span><span class="sxs-lookup"><span data-stu-id="633be-231">Developer</span></span>
- <span data-ttu-id="633be-232">De base</span><span class="sxs-lookup"><span data-stu-id="633be-232">Basic</span></span>
- <span data-ttu-id="633be-233">standard</span><span class="sxs-lookup"><span data-stu-id="633be-233">Standard</span></span>
- <span data-ttu-id="633be-234">Premium</span><span class="sxs-lookup"><span data-stu-id="633be-234">Premium</span></span>

<span data-ttu-id="633be-235">Le niveau développeur est conçu pour les charges de travail de non-production et l’évaluation.</span><span class="sxs-lookup"><span data-stu-id="633be-235">The Developer tier is meant for non-production workloads and evaluation.</span></span> <span data-ttu-id="633be-236">Les autres niveaux offrent progressivement plus de puissance, de fonctionnalités et de contrats de niveau de service (SLA) plus élevés.</span><span class="sxs-lookup"><span data-stu-id="633be-236">The other tiers offer progressively more power, features, and higher service level agreements (SLAs).</span></span> <span data-ttu-id="633be-237">Le niveau Premium offre une [prise en charge de plusieurs régions](https://docs.microsoft.com/azure/api-management/api-management-howto-deploy-multi-region)et d’un [réseau virtuel Azure](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview) .</span><span class="sxs-lookup"><span data-stu-id="633be-237">The Premium tier provides [Azure Virtual Network](https://docs.microsoft.com/azure/virtual-network/virtual-networks-overview) and [multi-region support](https://docs.microsoft.com/azure/api-management/api-management-howto-deploy-multi-region).</span></span> <span data-ttu-id="633be-238">Tous les niveaux ont un prix fixe par heure.</span><span class="sxs-lookup"><span data-stu-id="633be-238">All tiers have a fixed price per hour.</span></span>

<span data-ttu-id="633be-239">Le Cloud Azure offre également un [niveau sans serveur](https://azure.microsoft.com/blog/announcing-azure-api-management-for-serverless-architectures/) pour la gestion des API Azure.</span><span class="sxs-lookup"><span data-stu-id="633be-239">The Azure cloud also offers a [serverless tier](https://azure.microsoft.com/blog/announcing-azure-api-management-for-serverless-architectures/) for Azure API Management.</span></span> <span data-ttu-id="633be-240">Appelé « niveau de *tarification*de la consommation », le service est une variante de la gestion des API conçue autour du modèle de calcul sans serveur.</span><span class="sxs-lookup"><span data-stu-id="633be-240">Referred to as the *consumption pricing tier*, the service is a variant of API Management designed around the serverless computing model.</span></span> <span data-ttu-id="633be-241">Contrairement aux niveaux tarifaires « pré-alloués » précédemment affichés, le niveau de consommation fournit un approvisionnement instantané et une tarification par action.</span><span class="sxs-lookup"><span data-stu-id="633be-241">Unlike the "pre-allocated" pricing tiers previously shown, the consumption tier provides  instant provisioning and pay-per-action pricing.</span></span>

<span data-ttu-id="633be-242">Il active les fonctionnalités de la passerelle API pour les cas d’utilisation suivants :</span><span class="sxs-lookup"><span data-stu-id="633be-242">It enables API Gateway features for the following use cases:</span></span>

- <span data-ttu-id="633be-243">Microservices implémentés à l’aide de technologies sans serveur telles que [Azure Functions](https://docs.microsoft.com/azure/azure-functions/functions-overview) et [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/).</span><span class="sxs-lookup"><span data-stu-id="633be-243">Microservices implemented using serverless technologies such as [Azure Functions](https://docs.microsoft.com/azure/azure-functions/functions-overview) and [Azure Logic Apps](https://azure.microsoft.com/services/logic-apps/).</span></span>
- <span data-ttu-id="633be-244">Les ressources du service de sauvegarde Azure, telles que les Service Bus files d’attente et les rubriques, le stockage Azure et d’autres.</span><span class="sxs-lookup"><span data-stu-id="633be-244">Azure backing service resources such as Service Bus queues and topics, Azure storage, and others.</span></span>
- <span data-ttu-id="633be-245">Les microservices où le trafic a des pics de grande ampleur, mais qui reste peu la plupart du temps.</span><span class="sxs-lookup"><span data-stu-id="633be-245">Microservices where traffic has occasional large spikes but remains low the majority of the time.</span></span>

<span data-ttu-id="633be-246">Le niveau de consommation utilise les mêmes composants de gestion des API de service sous-jacents, mais utilise une architecture entièrement différente basée sur des ressources allouées dynamiquement.</span><span class="sxs-lookup"><span data-stu-id="633be-246">The consumption tier uses the same underlying service API Management components, but employs an entirely different architecture based on dynamically allocated resources.</span></span> <span data-ttu-id="633be-247">Il s’aligne parfaitement avec le modèle de calcul sans serveur :</span><span class="sxs-lookup"><span data-stu-id="633be-247">It aligns perfectly with the serverless computing model:</span></span>

- <span data-ttu-id="633be-248">Aucune infrastructure à gérer.</span><span class="sxs-lookup"><span data-stu-id="633be-248">No infrastructure to manage.</span></span>
- <span data-ttu-id="633be-249">Aucune capacité inactive.</span><span class="sxs-lookup"><span data-stu-id="633be-249">No idle capacity.</span></span>
- <span data-ttu-id="633be-250">Haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="633be-250">High-availability.</span></span>
- <span data-ttu-id="633be-251">Mise à l’échelle automatique.</span><span class="sxs-lookup"><span data-stu-id="633be-251">Automatic scaling.</span></span>
- <span data-ttu-id="633be-252">Le coût est basé sur l’utilisation réelle.</span><span class="sxs-lookup"><span data-stu-id="633be-252">Cost is based on actual usage.</span></span>
  
<span data-ttu-id="633be-253">Le nouveau niveau de consommation est un bon choix pour les systèmes Cloud natifs qui exposent des ressources sans serveur en tant qu’API.</span><span class="sxs-lookup"><span data-stu-id="633be-253">The new consumption tier is a great choice for cloud-native systems that expose serverless resources as APIs.</span></span>

## <a name="real-time-communication"></a><span data-ttu-id="633be-254">Communication en temps réel</span><span class="sxs-lookup"><span data-stu-id="633be-254">Real-time communication</span></span>

<span data-ttu-id="633be-255">La communication en temps réel, ou Push, est une autre option pour les applications frontales qui communiquent avec les systèmes back-end Cloud natifs via HTTP.</span><span class="sxs-lookup"><span data-stu-id="633be-255">Real-time, or push, communication is another option for front-end applications that communicate with back-end cloud-native systems over HTTP.</span></span> <span data-ttu-id="633be-256">Les applications, telles que les cotations financières, les formations en ligne, les jeux et les mises à jour de la progression des travaux, requièrent des réponses instantanées et en temps réel du serveur principal.</span><span class="sxs-lookup"><span data-stu-id="633be-256">Applications, such as financial-tickers, online education, gaming, and job-progress updates, require instantaneous, real-time responses from the back-end.</span></span> <span data-ttu-id="633be-257">Avec la communication HTTP normale, le client n’a aucun moyen de savoir quand de nouvelles données sont disponibles.</span><span class="sxs-lookup"><span data-stu-id="633be-257">With normal HTTP communication, there's no way for the client to know when new data is available.</span></span> <span data-ttu-id="633be-258">Le client doit continuellement *interroger* ou envoyer des demandes au serveur.</span><span class="sxs-lookup"><span data-stu-id="633be-258">The client must continually *poll* or send requests to the server.</span></span> <span data-ttu-id="633be-259">Avec la communication *en temps réel* , le serveur peut envoyer de nouvelles données au client à tout moment.</span><span class="sxs-lookup"><span data-stu-id="633be-259">With *real-time* communication, the server can push new data to the client at any time.</span></span>

<span data-ttu-id="633be-260">Les systèmes en temps réel sont souvent caractérisés par des flux de données à fréquence élevée et un grand nombre de connexions clientes simultanées.</span><span class="sxs-lookup"><span data-stu-id="633be-260">Real-time systems are often characterized by high-frequency data flows and large numbers of concurrent client connections.</span></span> <span data-ttu-id="633be-261">La mise en œuvre manuelle de la connectivité en temps réel peut rapidement devenir complexe, nécessitant une infrastructure non triviale pour garantir l’évolutivité et la fiabilité de la messagerie aux clients connectés.</span><span class="sxs-lookup"><span data-stu-id="633be-261">Manually implementing real-time connectivity can quickly become complex, requiring non-trivial infrastructure to ensure scalability and reliable messaging to connected clients.</span></span> <span data-ttu-id="633be-262">Vous pouvez gérer une instance du cache Redims Azure et un ensemble d’équilibrages de charge configurés avec des sessions rémanentes pour l’affinité du client.</span><span class="sxs-lookup"><span data-stu-id="633be-262">You could find yourself managing an  instance of Azure Redis Cache and a set of load balancers configured with sticky sessions for client affinity.</span></span>

<span data-ttu-id="633be-263">Le [service Azure signalr](https://azure.microsoft.com/services/signalr-service/) est un service Azure entièrement géré qui simplifie la communication en temps réel pour vos applications Cloud natives.</span><span class="sxs-lookup"><span data-stu-id="633be-263">[Azure SignalR Service](https://azure.microsoft.com/services/signalr-service/) is a fully managed Azure service that simplifies real-time communication for your cloud-native applications.</span></span> <span data-ttu-id="633be-264">Les détails de l’implémentation technique, tels que la configuration de la capacité, la mise à l’échelle et les connexions persistantes, sont extraits.</span><span class="sxs-lookup"><span data-stu-id="633be-264">Technical implementation details like capacity provisioning, scaling, and persistent connections are abstracted away.</span></span> <span data-ttu-id="633be-265">Ils sont gérés pour vous avec un contrat de niveau de service de 99,9%.</span><span class="sxs-lookup"><span data-stu-id="633be-265">They're handled for you with a 99.9% service-level agreement.</span></span> <span data-ttu-id="633be-266">Vous vous concentrez sur les fonctionnalités de l’application, et non sur l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="633be-266">You focus on application features, not infrastructure plumbing.</span></span>

<span data-ttu-id="633be-267">Une fois activé, un service HTTP basé sur le Cloud peut envoyer des mises à jour de contenu directement à des clients connectés, y compris des applications de navigateur, mobiles et de bureau.</span><span class="sxs-lookup"><span data-stu-id="633be-267">Once enabled, a cloud-based HTTP service can push content updates directly to connected clients, including browser, mobile and desktop applications.</span></span> <span data-ttu-id="633be-268">Les clients sont mis à jour sans qu’il soit nécessaire d’interroger le serveur.</span><span class="sxs-lookup"><span data-stu-id="633be-268">Clients are updated without the need to poll the server.</span></span> <span data-ttu-id="633be-269">Azure Signalr extrait les technologies de transport qui créent une connectivité en temps réel, notamment les WebSockets, les événements côté serveur et l’interrogation longue.</span><span class="sxs-lookup"><span data-stu-id="633be-269">Azure SignalR abstracts the transport technologies that create real-time connectivity, including WebSockets, Server-Side Events, and Long Polling.</span></span> <span data-ttu-id="633be-270">Les développeurs se concentrent sur l’envoi de messages à tous ou à des sous-ensembles spécifiques de clients connectés.</span><span class="sxs-lookup"><span data-stu-id="633be-270">Developers focus on sending messages to all or specific subsets of connected clients.</span></span>

<span data-ttu-id="633be-271">La figure 4-7 illustre un ensemble de clients HTTP qui se connectent à une application Cloud native avec Azure Signalr activé.</span><span class="sxs-lookup"><span data-stu-id="633be-271">Figure 4-7 shows a set of HTTP Clients connecting to a Cloud-native application with Azure SignalR enabled.</span></span>

![Azure SignalR](./media/azure-signalr-service.png)

<span data-ttu-id="633be-273">**Figure 4-7.**</span><span class="sxs-lookup"><span data-stu-id="633be-273">**Figure 4-7.**</span></span> <span data-ttu-id="633be-274">Azure SignalR</span><span class="sxs-lookup"><span data-stu-id="633be-274">Azure SignalR</span></span>

<span data-ttu-id="633be-275">Un autre avantage du service Azure Signalr est de mettre en œuvre des services Cloud natifs sans serveur.</span><span class="sxs-lookup"><span data-stu-id="633be-275">Another advantage of Azure SignalR Service comes with implementing Serverless cloud-native services.</span></span> <span data-ttu-id="633be-276">Votre code est peut-être exécuté à la demande avec des déclencheurs Azure Functions.</span><span class="sxs-lookup"><span data-stu-id="633be-276">Perhaps your code is executed on demand with Azure Functions triggers.</span></span> <span data-ttu-id="633be-277">Ce scénario peut être délicat, car votre code ne gère pas de longues connexions avec les clients.</span><span class="sxs-lookup"><span data-stu-id="633be-277">This scenario can be tricky because your code doesn't maintain long connections with clients.</span></span> <span data-ttu-id="633be-278">Le service Azure SignalR est en mesure de gérer cette situation, car il gère déjà les connexions à votre place.</span><span class="sxs-lookup"><span data-stu-id="633be-278">Azure SignalR Service can handle this situation since the service already manages connections for you.</span></span>

<span data-ttu-id="633be-279">Le service Azure Signalr s’intègre étroitement avec d’autres services Azure, tels que Azure SQL Database, Service Bus ou le cache ReDim, en ouvrant de nombreuses possibilités pour vos applications Cloud natives.</span><span class="sxs-lookup"><span data-stu-id="633be-279">Azure SignalR Service closely integrates with other Azure services, such as Azure SQL Database, Service Bus, or Redis Cache, opening up many possibilities for your cloud-native applications.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="633be-280">[Précédent](communication-patterns.md)
>[suivant](service-to-service-communication.md)</span><span class="sxs-lookup"><span data-stu-id="633be-280">[Previous](communication-patterns.md)
[Next](service-to-service-communication.md)</span></span>

---
title: Résilience de la plateforme Azure
description: Architecture des applications .NET natives Cloud pour Azure | Résilience de l’infrastructure cloud avec Azure
author: robvet
ms.date: 05/13/2020
ms.openlocfilehash: 752f1320d9dfa18e52b078763d221a787da15e8e
ms.sourcegitcommit: 27db07ffb26f76912feefba7b884313547410db5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/19/2020
ms.locfileid: "83613978"
---
# <a name="azure-platform-resiliency"></a><span data-ttu-id="def42-103">Résilience de la plateforme Azure</span><span class="sxs-lookup"><span data-stu-id="def42-103">Azure platform resiliency</span></span>

<span data-ttu-id="def42-104">La création d’une application fiable dans le Cloud est différente du développement d’applications locales traditionnelles.</span><span class="sxs-lookup"><span data-stu-id="def42-104">Building a reliable application in the cloud is different from traditional on-premises application development.</span></span> <span data-ttu-id="def42-105">Bien que vous ayez acheté un matériel de haut niveau pour monter en puissance, dans un environnement Cloud, vous augmentez l’échelle. Au lieu de tenter d’éviter les défaillances, l’objectif est de réduire leurs effets et de maintenir la stabilité du système.</span><span class="sxs-lookup"><span data-stu-id="def42-105">While historically you purchased higher-end hardware to scale up, in a cloud environment you scale out. Instead of trying to prevent failures, the goal is to minimize their effects and keep the system stable.</span></span>

<span data-ttu-id="def42-106">Cela dit, les applications Cloud fiables affichent des caractéristiques distinctes :</span><span class="sxs-lookup"><span data-stu-id="def42-106">That said, reliable cloud applications display distinct characteristics:</span></span>

- <span data-ttu-id="def42-107">Ils sont résilients, récupèrent correctement des problèmes et continuent de fonctionner.</span><span class="sxs-lookup"><span data-stu-id="def42-107">They're resilient, recover gracefully from problems, and continue to function.</span></span>
- <span data-ttu-id="def42-108">Ils sont hautement disponibles et s’exécutent comme étant conçus dans un état sain, sans temps d’arrêt significatif.</span><span class="sxs-lookup"><span data-stu-id="def42-108">They're highly available (HA) and run as designed in a healthy state with no significant downtime.</span></span>

<span data-ttu-id="def42-109">Comprendre comment ces caractéristiques fonctionnent ensemble et comment elles ont une incidence sur le coût est essentiel à la création d’une application fiable Cloud-native.</span><span class="sxs-lookup"><span data-stu-id="def42-109">Understanding how these characteristics work together - and how they affect cost - is essential to building a reliable cloud-native application.</span></span> <span data-ttu-id="def42-110">Nous allons ensuite étudier les différentes façons dont vous pouvez créer la résilience et la disponibilité dans vos applications Cloud natives en tirant parti des fonctionnalités du Cloud Azure.</span><span class="sxs-lookup"><span data-stu-id="def42-110">We'll next look at ways that you can build resiliency and availability into your cloud-native applications leveraging features from the Azure cloud.</span></span>

## <a name="design-with-resiliency"></a><span data-ttu-id="def42-111">Conception avec résilience</span><span class="sxs-lookup"><span data-stu-id="def42-111">Design with resiliency</span></span>

<span data-ttu-id="def42-112">Nous avons dit que la résilience permet à votre application de réagir à une défaillance tout en restant fonctionnelle.</span><span class="sxs-lookup"><span data-stu-id="def42-112">We've said resiliency enables your application to react to failure and still remain functional.</span></span> <span data-ttu-id="def42-113">Le livre blanc, [résilience dans le livre blanc Azure](https://azure.microsoft.com/mediahandler/files/resourcefiles/resilience-in-azure-whitepaper/Resilience%20in%20Azure.pdf), fournit des conseils pour obtenir une résilience dans la plateforme Azure.</span><span class="sxs-lookup"><span data-stu-id="def42-113">The whitepaper, [Resilience in Azure whitepaper](https://azure.microsoft.com/mediahandler/files/resourcefiles/resilience-in-azure-whitepaper/Resilience%20in%20Azure.pdf), provides guidance for achieving resilience in the Azure platform.</span></span> <span data-ttu-id="def42-114">Voici quelques recommandations clés :</span><span class="sxs-lookup"><span data-stu-id="def42-114">Here are some key recommendations:</span></span>

- <span data-ttu-id="def42-115">*Défaillance matérielle.*</span><span class="sxs-lookup"><span data-stu-id="def42-115">*Hardware failure.*</span></span> <span data-ttu-id="def42-116">Intégrez la redondance dans l’application en déployant des composants dans différents domaines d’erreur.</span><span class="sxs-lookup"><span data-stu-id="def42-116">Build redundancy into the application by deploying components across different fault domains.</span></span> <span data-ttu-id="def42-117">Par exemple, assurez-vous que les machines virtuelles Azure sont placées dans des racks différents à l’aide de groupes à haute disponibilité.</span><span class="sxs-lookup"><span data-stu-id="def42-117">For example, ensure that Azure VMs are placed in different racks by using Availability Sets.</span></span>

- <span data-ttu-id="def42-118">*Échec du centre de.*</span><span class="sxs-lookup"><span data-stu-id="def42-118">*Datacenter failure.*</span></span> <span data-ttu-id="def42-119">Intégrez la redondance à l’application avec des zones d’isolation des erreurs dans les centres de centres.</span><span class="sxs-lookup"><span data-stu-id="def42-119">Build redundancy into the application with fault isolation zones across datacenters.</span></span> <span data-ttu-id="def42-120">Par exemple, assurez-vous que les machines virtuelles Azure sont placées dans différents centres de centres d’erreur isolés à l’aide de Zones de disponibilité Azure.</span><span class="sxs-lookup"><span data-stu-id="def42-120">For example, ensure that Azure VMs are placed in different fault-isolated datacenters by using Azure Availability Zones.</span></span>

- <span data-ttu-id="def42-121">*Défaillance régionale.*</span><span class="sxs-lookup"><span data-stu-id="def42-121">*Regional failure.*</span></span> <span data-ttu-id="def42-122">Répliquez les données et les composants dans une autre région afin que les applications puissent être récupérées rapidement.</span><span class="sxs-lookup"><span data-stu-id="def42-122">Replicate the data and components into another region so that applications can be quickly recovered.</span></span> <span data-ttu-id="def42-123">Par exemple, utilisez Azure Site Recovery pour répliquer des machines virtuelles Azure vers une autre région Azure.</span><span class="sxs-lookup"><span data-stu-id="def42-123">For example, use Azure Site Recovery to replicate Azure VMs to another Azure region.</span></span>

- <span data-ttu-id="def42-124">*Charge lourde.*</span><span class="sxs-lookup"><span data-stu-id="def42-124">*Heavy load.*</span></span> <span data-ttu-id="def42-125">Équilibrer la charge entre les instances pour gérer les pics d’utilisation.</span><span class="sxs-lookup"><span data-stu-id="def42-125">Load balance across instances to handle spikes in usage.</span></span> <span data-ttu-id="def42-126">Par exemple, placez au moins deux machines virtuelles Azure derrière un équilibreur de charge pour répartir le trafic vers toutes les machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="def42-126">For example, put two or more Azure VMs behind a load balancer to distribute traffic to all VMs.</span></span>

- <span data-ttu-id="def42-127">*Suppression accidentelle ou altération des données.*</span><span class="sxs-lookup"><span data-stu-id="def42-127">*Accidental data deletion or corruption.*</span></span> <span data-ttu-id="def42-128">Sauvegardez les données afin qu’elles puissent être restaurées en cas de suppression ou d’endommagement.</span><span class="sxs-lookup"><span data-stu-id="def42-128">Back up data so it can be restored if there’s any deletion or corruption.</span></span> <span data-ttu-id="def42-129">Par exemple, utilisez Azure Backup pour sauvegarder périodiquement vos machines virtuelles Azure.</span><span class="sxs-lookup"><span data-stu-id="def42-129">For example, use Azure Backup to periodically back up your Azure VMs.</span></span>

## <a name="design-with-redundancy"></a><span data-ttu-id="def42-130">Conception avec redondance</span><span class="sxs-lookup"><span data-stu-id="def42-130">Design with redundancy</span></span>

<span data-ttu-id="def42-131">Les échecs varient selon l’étendue de l’impact.</span><span class="sxs-lookup"><span data-stu-id="def42-131">Failures vary in scope of impact.</span></span> <span data-ttu-id="def42-132">Une défaillance matérielle, telle qu’un disque défaillant, peut affecter un nœud unique dans un cluster.</span><span class="sxs-lookup"><span data-stu-id="def42-132">A hardware failure, such as a failed disk, can affect a single node in a cluster.</span></span> <span data-ttu-id="def42-133">Un commutateur réseau défaillant peut affecter un rack de serveurs entier.</span><span class="sxs-lookup"><span data-stu-id="def42-133">A failed network switch could affect an entire server rack.</span></span> <span data-ttu-id="def42-134">Les défaillances moins courantes, telles que la perte de puissance, peuvent perturber l’ensemble d’un centre de donné.</span><span class="sxs-lookup"><span data-stu-id="def42-134">Less common failures, such as loss of power, could disrupt a whole datacenter.</span></span> <span data-ttu-id="def42-135">Rarement, toute une région n’est plus disponible.</span><span class="sxs-lookup"><span data-stu-id="def42-135">Rarely, an entire region becomes unavailable.</span></span>

<span data-ttu-id="def42-136">La [redondance](https://docs.microsoft.com/azure/architecture/guide/design-principles/redundancy) est un moyen d’assurer la résilience des applications.</span><span class="sxs-lookup"><span data-stu-id="def42-136">[Redundancy](https://docs.microsoft.com/azure/architecture/guide/design-principles/redundancy) is one way to provide application resilience.</span></span> <span data-ttu-id="def42-137">Le niveau exact de redondance nécessaire dépend des besoins de votre entreprise et a un impact sur le coût et la complexité de votre système.</span><span class="sxs-lookup"><span data-stu-id="def42-137">The exact level of redundancy needed depends upon your business requirements and will affect both the cost and complexity of your system.</span></span> <span data-ttu-id="def42-138">Par exemple, un déploiement sur plusieurs régions est plus onéreux et plus complexe à gérer qu’un déploiement sur une seule région.</span><span class="sxs-lookup"><span data-stu-id="def42-138">For example, a multi-region deployment is more expensive and more complex to manage than a single-region deployment.</span></span> <span data-ttu-id="def42-139">Vous aurez besoin de procédures opérationnelles pour gérer le basculement et la restauration automatique.</span><span class="sxs-lookup"><span data-stu-id="def42-139">You'll need operational procedures to manage failover and failback.</span></span> <span data-ttu-id="def42-140">Les coûts et la complexité supplémentaires peuvent être justifiés pour certains scénarios d’entreprise, mais pas pour d’autres.</span><span class="sxs-lookup"><span data-stu-id="def42-140">The additional cost and complexity might be justified for some business scenarios, but not others.</span></span>

<span data-ttu-id="def42-141">Pour concevoir la redondance, vous devez identifier les chemins critiques dans votre application, puis déterminer s’il existe une redondance à chaque point du chemin d’accès ?</span><span class="sxs-lookup"><span data-stu-id="def42-141">To architect redundancy, you need to identify the critical paths in your application, and then determine if there's redundancy at each point in the path?</span></span> <span data-ttu-id="def42-142">En cas d’échec d’un sous-système, l’application bascule-t-elle vers autre chose ?</span><span class="sxs-lookup"><span data-stu-id="def42-142">If a subsystem should fail, will the application fail over to something else?</span></span> <span data-ttu-id="def42-143">Enfin, vous avez besoin d’une compréhension claire des fonctionnalités intégrées à la plateforme Cloud Azure que vous pouvez exploiter pour répondre à vos besoins en matière de redondance.</span><span class="sxs-lookup"><span data-stu-id="def42-143">Finally, you need a clear understanding of those features built into the Azure cloud platform that you can leverage to meet your redundancy requirements.</span></span> <span data-ttu-id="def42-144">Voici des recommandations pour l’architecture de la redondance :</span><span class="sxs-lookup"><span data-stu-id="def42-144">Here are recommendations for architecting redundancy:</span></span>

- <span data-ttu-id="def42-145">*Déployez plusieurs instances des services.*</span><span class="sxs-lookup"><span data-stu-id="def42-145">*Deploy multiple instances of services.*</span></span> <span data-ttu-id="def42-146">Si votre application repose sur une seule instance unique d’un service, cela crée un point de défaillance unique.</span><span class="sxs-lookup"><span data-stu-id="def42-146">If your application depends on a single instance of a service, it creates a single point of failure.</span></span> <span data-ttu-id="def42-147">L’approvisionnement de plusieurs instances améliore à la fois la résilience et l’extensibilité.</span><span class="sxs-lookup"><span data-stu-id="def42-147">Provisioning multiple instances improves both resiliency and scalability.</span></span> <span data-ttu-id="def42-148">Lors de l’hébergement dans le service Azure Kubernetes, vous pouvez configurer de manière déclarative des instances redondantes (jeux de réplicas) dans le fichier manifeste Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="def42-148">When hosting in Azure Kubernetes Service, you can declaratively configure redundant instances (replica sets) in the Kubernetes manifest file.</span></span> <span data-ttu-id="def42-149">La valeur du nombre de réplicas peut être gérée par programme, dans le portail ou à l’aide des fonctionnalités de mise à l’échelle automatique.</span><span class="sxs-lookup"><span data-stu-id="def42-149">The replica count value can be managed programmatically, in the portal, or through autoscaling features.</span></span>

- <span data-ttu-id="def42-150">*Utilisation d’un équilibreur de charge.*</span><span class="sxs-lookup"><span data-stu-id="def42-150">*Leveraging a load balancer.*</span></span> <span data-ttu-id="def42-151">L’équilibrage de charge distribue les demandes de votre application à des instances de service saines et supprime automatiquement les instances défectueuses de la rotation.</span><span class="sxs-lookup"><span data-stu-id="def42-151">Load-balancing distributes your application's requests to healthy service instances and automatically removes unhealthy instances from rotation.</span></span> <span data-ttu-id="def42-152">Lors du déploiement sur Kubernetes, l’équilibrage de charge peut être spécifié dans le fichier manifeste Kubernetes de la section services.</span><span class="sxs-lookup"><span data-stu-id="def42-152">When deploying to Kubernetes, load balancing can be specified in the Kubernetes manifest file in the Services section.</span></span>

- <span data-ttu-id="def42-153">*Planifier un déploiement à régions.*</span><span class="sxs-lookup"><span data-stu-id="def42-153">*Plan for multiregion deployment.*</span></span> <span data-ttu-id="def42-154">Si vous déployez votre application dans une seule région et que cette région n’est plus disponible, votre application devient également indisponible.</span><span class="sxs-lookup"><span data-stu-id="def42-154">If you deploy your application to a single region, and that region becomes unavailable, your application will also become unavailable.</span></span> <span data-ttu-id="def42-155">Cela peut être inacceptable selon les termes des contrats de niveau de service de votre application.</span><span class="sxs-lookup"><span data-stu-id="def42-155">This may be unacceptable under the terms of your application's service level agreements.</span></span> <span data-ttu-id="def42-156">Au lieu de cela, envisagez de déployer votre application et ses services dans plusieurs régions.</span><span class="sxs-lookup"><span data-stu-id="def42-156">Instead, consider deploying your application and its services across multiple regions.</span></span> <span data-ttu-id="def42-157">Par exemple, un cluster Azure Kubernetes service (AKS) est déployé dans une seule région.</span><span class="sxs-lookup"><span data-stu-id="def42-157">For example, an Azure Kubernetes Service (AKS) cluster is deployed to a single region.</span></span> <span data-ttu-id="def42-158">Pour protéger votre système contre les défaillances régionales, vous pouvez déployer votre application sur plusieurs clusters AKS dans différentes régions et utiliser la fonctionnalité de [régions jumelées](https://buildazure.com/2017/01/06/azure-region-pairs-explained/) pour coordonner les mises à jour de plateforme et hiérarchiser les efforts de récupération.</span><span class="sxs-lookup"><span data-stu-id="def42-158">To protect your system from a regional failure, you might deploy your application to multiple AKS clusters across different regions and use the [Paired Regions](https://buildazure.com/2017/01/06/azure-region-pairs-explained/) feature to coordinate platform updates and prioritize recovery efforts.</span></span>

- <span data-ttu-id="def42-159">*Activez [la géo-réplication](https://docs.microsoft.com/azure/sql-database/sql-database-active-geo-replication).*</span><span class="sxs-lookup"><span data-stu-id="def42-159">*Enable [geo-replication](https://docs.microsoft.com/azure/sql-database/sql-database-active-geo-replication).*</span></span> <span data-ttu-id="def42-160">La géo-réplication pour des services tels que Azure SQL Database et Cosmos DB créera des réplicas secondaires de vos données dans plusieurs régions.</span><span class="sxs-lookup"><span data-stu-id="def42-160">Geo-replication for services such as Azure SQL Database and Cosmos DB will create secondary replicas of your data across multiple regions.</span></span> <span data-ttu-id="def42-161">Alors que les deux services répliquent automatiquement les données dans la même région, la géo-réplication vous protège contre une panne régionale en vous permettant de basculer vers une région secondaire.</span><span class="sxs-lookup"><span data-stu-id="def42-161">While both services will automatically replicate data within the same region, geo-replication protects you against a regional outage by enabling you to fail over to a secondary region.</span></span> <span data-ttu-id="def42-162">Une autre pratique recommandée pour la géo-réplication consiste à stocker des images de conteneur.</span><span class="sxs-lookup"><span data-stu-id="def42-162">Another best practice for geo-replication centers around storing container images.</span></span> <span data-ttu-id="def42-163">Pour déployer un service dans AKS, vous devez stocker et extraire l’image à partir d’un référentiel.</span><span class="sxs-lookup"><span data-stu-id="def42-163">To deploy a service in AKS, you need to store and pull the image from a repository.</span></span> <span data-ttu-id="def42-164">Azure Container Registry s’intègre à AKS et peut stocker des images de conteneur en toute sécurité.</span><span class="sxs-lookup"><span data-stu-id="def42-164">Azure Container Registry integrates with AKS and can securely store container images.</span></span> <span data-ttu-id="def42-165">Pour améliorer les performances et la disponibilité, envisagez de géo-répliquer vos images dans un registre dans chaque région où vous disposez d’un cluster AKS.</span><span class="sxs-lookup"><span data-stu-id="def42-165">To improve performance and availability, consider geo-replicating your images to a registry in each region where you have an AKS cluster.</span></span> <span data-ttu-id="def42-166">Chaque cluster AKS extrait ensuite les images de conteneur à partir du registre de conteneurs local dans sa région, comme le montre la figure 6-4 :</span><span class="sxs-lookup"><span data-stu-id="def42-166">Each AKS cluster then pulls container images from the local container registry in its region as shown in Figure 6-4:</span></span>

![Ressources répliquées dans les régions](./media/replicated-resources.png)

<span data-ttu-id="def42-168">**Figure 6-4**.</span><span class="sxs-lookup"><span data-stu-id="def42-168">**Figure 6-4**.</span></span> <span data-ttu-id="def42-169">Ressources répliquées dans les régions</span><span class="sxs-lookup"><span data-stu-id="def42-169">Replicated resources across regions</span></span>

- <span data-ttu-id="def42-170">*Implémentez un équilibreur de charge du trafic DNS.*</span><span class="sxs-lookup"><span data-stu-id="def42-170">*Implement a DNS traffic load balancer.*</span></span> <span data-ttu-id="def42-171">[Azure Traffic Manager](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview) fournit une haute disponibilité pour les applications critiques en équilibrant la charge au niveau du DNS.</span><span class="sxs-lookup"><span data-stu-id="def42-171">[Azure Traffic Manager](https://docs.microsoft.com/azure/traffic-manager/traffic-manager-overview) provides high-availability for critical applications by load-balancing at the DNS level.</span></span> <span data-ttu-id="def42-172">Il peut acheminer le trafic vers différentes régions en fonction de la géographie, du temps de réponse du cluster et même de l’intégrité du point de terminaison d’application.</span><span class="sxs-lookup"><span data-stu-id="def42-172">It can route traffic to different regions based on geography, cluster response time, and even application endpoint health.</span></span> <span data-ttu-id="def42-173">Par exemple, Azure Traffic Manager peut diriger les clients vers l’instance d’application et le cluster AKS le plus proche.</span><span class="sxs-lookup"><span data-stu-id="def42-173">For example, Azure Traffic Manager can direct customers to the closest AKS cluster and application instance.</span></span> <span data-ttu-id="def42-174">Si vous possédez plusieurs clusters AKS dans différentes régions, utilisez Traffic Manager pour contrôler la façon dont le trafic afflue vers les applications qui s’exécutent dans chaque cluster.</span><span class="sxs-lookup"><span data-stu-id="def42-174">If you have multiple AKS clusters in different regions, use Traffic Manager to control how traffic flows to the applications that run in each cluster.</span></span> <span data-ttu-id="def42-175">La figure 6-5 illustre ce scénario.</span><span class="sxs-lookup"><span data-stu-id="def42-175">Figure 6-5 shows this scenario.</span></span>

![AKS et Azure Traffic Manager](./media/aks-traffic-manager.png)

<span data-ttu-id="def42-177">**Figure 6-5.**</span><span class="sxs-lookup"><span data-stu-id="def42-177">**Figure 6-5**.</span></span> <span data-ttu-id="def42-178">AKS et Azure Traffic Manager</span><span class="sxs-lookup"><span data-stu-id="def42-178">AKS and Azure Traffic Manager</span></span>

## <a name="design-for-scalability"></a><span data-ttu-id="def42-179">Conception dans l’optique de la scalabilité</span><span class="sxs-lookup"><span data-stu-id="def42-179">Design for scalability</span></span>

<span data-ttu-id="def42-180">Le Cloud est très prospère en matière de mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="def42-180">The cloud thrives on scaling.</span></span> <span data-ttu-id="def42-181">La possibilité d’augmenter ou de diminuer les ressources système pour résoudre la charge système en hausse/en baisse est un principe essentiel du Cloud Azure.</span><span class="sxs-lookup"><span data-stu-id="def42-181">The ability to increase/decrease system resources to address increasing/decreasing system load is a key tenet of the Azure cloud.</span></span> <span data-ttu-id="def42-182">Toutefois, pour mettre à l’échelle efficacement une application, vous devez comprendre les fonctionnalités de mise à l’échelle de chaque service Azure que vous incluez dans votre application.</span><span class="sxs-lookup"><span data-stu-id="def42-182">But, to effectively scale an application, you need an understanding of the scaling features of each Azure service that you include in your application.</span></span>  <span data-ttu-id="def42-183">Voici des recommandations pour implémenter efficacement la mise à l’échelle dans votre système.</span><span class="sxs-lookup"><span data-stu-id="def42-183">Here are recommendations for effectively implementing scaling in your system.</span></span>

- <span data-ttu-id="def42-184">*Conception pour la mise à l’échelle.*</span><span class="sxs-lookup"><span data-stu-id="def42-184">*Design for scaling.*</span></span> <span data-ttu-id="def42-185">Une application doit être conçue pour la mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="def42-185">An application must be designed for scaling.</span></span> <span data-ttu-id="def42-186">Pour commencer, les services doivent être sans État afin que les demandes puissent être routées vers n’importe quelle instance.</span><span class="sxs-lookup"><span data-stu-id="def42-186">To start, services should be stateless so that requests can be routed to any instance.</span></span> <span data-ttu-id="def42-187">L’utilisation de services sans état signifie également que l’ajout ou la suppression d’une instance n’a pas d’impact négatif sur les utilisateurs actuels.</span><span class="sxs-lookup"><span data-stu-id="def42-187">Having stateless services also means that adding or removing an instance doesn't adversely impact current users.</span></span>

- <span data-ttu-id="def42-188">*Partitionner les charges de travail*.</span><span class="sxs-lookup"><span data-stu-id="def42-188">*Partition workloads*.</span></span> <span data-ttu-id="def42-189">La décomposition de domaines en microservices indépendants et autonomes permet à chaque service de se mettre à l’échelle indépendamment des autres.</span><span class="sxs-lookup"><span data-stu-id="def42-189">Decomposing domains into independent, self-contained microservices enable each service to scale independently of others.</span></span> <span data-ttu-id="def42-190">En règle générale, les services ont des besoins et des exigences d’évolutivité différents.</span><span class="sxs-lookup"><span data-stu-id="def42-190">Typically, services will have different scalability needs and requirements.</span></span> <span data-ttu-id="def42-191">Le partitionnement vous permet de mettre à l’échelle uniquement ce qui doit être mis à l’échelle sans le coût inutile de mise à l’échelle d’une application entière.</span><span class="sxs-lookup"><span data-stu-id="def42-191">Partitioning enables you to scale only what needs to be scaled without the unnecessary cost of scaling an entire application.</span></span>

- <span data-ttu-id="def42-192">*Privilégiez la montée en* puissance parallèle. Les applications basées sur le Cloud favorisent la montée en charge des ressources par opposition à la montée en puissance.</span><span class="sxs-lookup"><span data-stu-id="def42-192">*Favor scale-out.* Cloud-based applications favor scaling out resources as opposed to scaling up.</span></span> <span data-ttu-id="def42-193">La montée en charge (également appelée mise à l’échelle horizontale) implique l’ajout de ressources de service supplémentaires à un système existant pour atteindre et partager un niveau de performances souhaité.</span><span class="sxs-lookup"><span data-stu-id="def42-193">Scaling out (also known as horizontal scaling) involves adding more service resources to an existing system to meet and share a desired level of performance.</span></span> <span data-ttu-id="def42-194">La montée en puissance (également appelée mise à l’échelle verticale) implique de remplacer les ressources existantes par du matériel plus puissant (plus de disques, de mémoire et de cœurs de traitement).</span><span class="sxs-lookup"><span data-stu-id="def42-194">Scaling up (also known as vertical scaling) involves replacing existing resources with more powerful hardware (more disk, memory, and processing cores).</span></span> <span data-ttu-id="def42-195">La montée en charge peut être automatiquement appelée avec les fonctionnalités de mise à l’échelle automatique disponibles dans certaines ressources de Cloud Azure.</span><span class="sxs-lookup"><span data-stu-id="def42-195">Scaling out can be invoked automatically with the autoscaling features available in some Azure cloud resources.</span></span> <span data-ttu-id="def42-196">La montée en charge sur plusieurs ressources ajoute également une redondance à l’ensemble du système.</span><span class="sxs-lookup"><span data-stu-id="def42-196">Scaling out across multiple resources also adds redundancy to the overall system.</span></span> <span data-ttu-id="def42-197">Enfin, la mise à l’échelle d’une ressource unique est généralement plus coûteuse que la montée en charge sur de nombreuses ressources plus petites.</span><span class="sxs-lookup"><span data-stu-id="def42-197">Finally scaling up a single resource is typically more expensive than scaling out across many smaller resources.</span></span> <span data-ttu-id="def42-198">La figure 6-6 illustre les deux approches :</span><span class="sxs-lookup"><span data-stu-id="def42-198">Figure 6-6 shows the two approaches:</span></span>

![Évolution verticale et montée en puissance parallèle](./media/scale-up-scale-out.png)

<span data-ttu-id="def42-200">**Figure 6-6.**</span><span class="sxs-lookup"><span data-stu-id="def42-200">**Figure 6-6.**</span></span> <span data-ttu-id="def42-201">Évolution verticale et montée en puissance parallèle</span><span class="sxs-lookup"><span data-stu-id="def42-201">Scale up versus scale out</span></span>

- <span data-ttu-id="def42-202">*Mettre à l’échelle proportionnellement.*</span><span class="sxs-lookup"><span data-stu-id="def42-202">*Scale proportionally.*</span></span> <span data-ttu-id="def42-203">Lors de la mise à l’échelle d’un service, pensez aux *jeux de ressources*.</span><span class="sxs-lookup"><span data-stu-id="def42-203">When scaling a service, think in terms of *resource sets*.</span></span> <span data-ttu-id="def42-204">Si vous deviez augmenter considérablement la capacité d’un service spécifique, quel impact aurait-il sur les magasins de données principaux, les caches et les services dépendants ?</span><span class="sxs-lookup"><span data-stu-id="def42-204">If you were to dramatically scale out a specific service, what impact would that have on back-end data stores, caches and dependent services?</span></span> <span data-ttu-id="def42-205">Certaines ressources, telles que Cosmos DB, peuvent être mises à l’échelle proportionnellement, tandis que beaucoup d’autres ne le sont pas.</span><span class="sxs-lookup"><span data-stu-id="def42-205">Some resources such as Cosmos DB can scale out proportionally, while many others can't.</span></span> <span data-ttu-id="def42-206">Vous souhaitez vous assurer que vous n’augmentez pas la mise à l’échelle d’une ressource à un point où elle épuise les autres ressources associées.</span><span class="sxs-lookup"><span data-stu-id="def42-206">You want to ensure that you don't scale out a resource to a point where it will exhaust other associated resources.</span></span>

- <span data-ttu-id="def42-207">*Évitez les affinités.*</span><span class="sxs-lookup"><span data-stu-id="def42-207">*Avoid affinity.*</span></span> <span data-ttu-id="def42-208">Une meilleure pratique consiste à s’assurer qu’un nœud ne nécessite pas d’affinité locale, souvent appelée *session rémanente*.</span><span class="sxs-lookup"><span data-stu-id="def42-208">A best practice is to ensure a node doesn't require local affinity, often referred to as a *sticky session*.</span></span> <span data-ttu-id="def42-209">Une demande doit pouvoir être acheminée vers n’importe quelle instance.</span><span class="sxs-lookup"><span data-stu-id="def42-209">A request should be able to route to any instance.</span></span> <span data-ttu-id="def42-210">Si vous devez conserver l’État, il doit être enregistré dans un cache distribué, tel que le [cache redims Azure](https://azure.microsoft.com/services/cache/).</span><span class="sxs-lookup"><span data-stu-id="def42-210">If you need to persist state, it should be saved to a distributed cache, such as [Azure Redis cache](https://azure.microsoft.com/services/cache/).</span></span>

- <span data-ttu-id="def42-211">*Tirez parti des fonctionnalités de mise à l’échelle automatique de la plateforme.*</span><span class="sxs-lookup"><span data-stu-id="def42-211">*Take advantage of platform autoscaling features.*</span></span> <span data-ttu-id="def42-212">Utilisez les fonctionnalités de mise à l’échelle automatique dans la mesure du possible, au lieu de mécanismes personnalisés ou tiers.</span><span class="sxs-lookup"><span data-stu-id="def42-212">Use built-in autoscaling features whenever possible, rather than custom or third-party mechanisms.</span></span> <span data-ttu-id="def42-213">Dans la mesure du possible, utilisez des règles de mise à l’échelle planifiées pour vous assurer que les ressources sont disponibles sans délai de démarrage, mais ajoutez la mise à l’échelle automatique réactive aux règles, le cas échéant, afin de faire face aux modifications inattendues de la demande.</span><span class="sxs-lookup"><span data-stu-id="def42-213">Where possible, use scheduled scaling rules to ensure that resources are available without a startup delay, but add reactive autoscaling to the rules as appropriate, to cope with unexpected changes in demand.</span></span> <span data-ttu-id="def42-214">Pour plus d’informations, consultez [Guide de mise à l’échelle](https://docs.microsoft.com/azure/architecture/best-practices/auto-scaling)automatique.</span><span class="sxs-lookup"><span data-stu-id="def42-214">For more information, see [Autoscaling guidance](https://docs.microsoft.com/azure/architecture/best-practices/auto-scaling).</span></span>

- <span data-ttu-id="def42-215">*Montée en charge de manière agressive.*</span><span class="sxs-lookup"><span data-stu-id="def42-215">*Scale out aggressively.*</span></span> <span data-ttu-id="def42-216">Une dernière pratique serait de monter en puissance de façon agressive afin que vous puissiez répondre rapidement aux pics immédiats du trafic sans perdre votre activité.</span><span class="sxs-lookup"><span data-stu-id="def42-216">A final practice would be to scale out aggressively so that you can quickly meet immediate spikes in traffic without losing business.</span></span> <span data-ttu-id="def42-217">Et, puis mettre à l’échelle dans (autrement dit, supprimer les instances inutiles) de manière conservatrice pour garantir la stabilité du système.</span><span class="sxs-lookup"><span data-stu-id="def42-217">And, then scale in (that is, remove unneeded instances) conservatively to keep the system stable.</span></span> <span data-ttu-id="def42-218">Un moyen simple d’implémenter cela consiste à définir la période de refroidissement, qui est le temps d’attente entre les opérations de mise à l’échelle, à cinq minutes pour l’ajout de ressources et jusqu’à 15 minutes pour la suppression des instances.</span><span class="sxs-lookup"><span data-stu-id="def42-218">A simple way to implement this is to set the cool down period, which is the time to wait between scaling operations, to five minutes for adding resources and up to 15 minutes for removing instances.</span></span>

## <a name="built-in-retry-in-services"></a><span data-ttu-id="def42-219">Nouvelle tentative intégrée dans les services</span><span class="sxs-lookup"><span data-stu-id="def42-219">Built-in retry in services</span></span>

<span data-ttu-id="def42-220">Nous avons encouragé la meilleure pratique qui consiste à implémenter des opérations de nouvelle tentative par programmation dans une section précédente.</span><span class="sxs-lookup"><span data-stu-id="def42-220">We encouraged the best practice of implementing programmatic retry operations in an earlier section.</span></span> <span data-ttu-id="def42-221">Gardez à l’esprit que de nombreux services Azure et leurs kits de développement logiciel (SDK) clients correspondants incluent également des mécanismes de nouvelle tentative.</span><span class="sxs-lookup"><span data-stu-id="def42-221">Keep in mind that many Azure services and their corresponding client SDKs also include retry mechanisms.</span></span> <span data-ttu-id="def42-222">La liste suivante récapitule les fonctionnalités des nouvelles tentatives dans les nombreux services Azure qui sont abordés dans ce document :</span><span class="sxs-lookup"><span data-stu-id="def42-222">The following list summarizes retry features in the many of the Azure services that are discussed in this book:</span></span>

- <span data-ttu-id="def42-223">*Azure Cosmos DB.*</span><span class="sxs-lookup"><span data-stu-id="def42-223">*Azure Cosmos DB.*</span></span> <span data-ttu-id="def42-224">La <xref:Microsoft.Azure.Documents.Client.DocumentClient> classe de l’API client retire automatiquement les tentatives ayant échoué.</span><span class="sxs-lookup"><span data-stu-id="def42-224">The <xref:Microsoft.Azure.Documents.Client.DocumentClient> class from the client API automatically retires failed attempts.</span></span> <span data-ttu-id="def42-225">Le nombre de nouvelles tentatives et le délai d’attente maximal peuvent être configurés.</span><span class="sxs-lookup"><span data-stu-id="def42-225">The number of retries and maximum wait time are configurable.</span></span> <span data-ttu-id="def42-226">Les exceptions levées par l’API client sont soit des demandes qui dépassent la stratégie de nouvelle tentative, soit des erreurs non temporaires.</span><span class="sxs-lookup"><span data-stu-id="def42-226">Exceptions thrown by the client API are either requests that exceed the retry policy or non-transient errors.</span></span>

- <span data-ttu-id="def42-227">*Cache Redims Azure.*</span><span class="sxs-lookup"><span data-stu-id="def42-227">*Azure Redis Cache.*</span></span> <span data-ttu-id="def42-228">Le client StackExchanges ReDim utilise une classe de gestionnaire de connexions qui comprend les nouvelles tentatives en cas d’échec.</span><span class="sxs-lookup"><span data-stu-id="def42-228">The Redis StackExchange client uses a connection manager class that includes retries on failed attempts.</span></span> <span data-ttu-id="def42-229">Le nombre de nouvelles tentatives, la stratégie de nouvelle tentative spécifique et le temps d’attente sont tous configurables.</span><span class="sxs-lookup"><span data-stu-id="def42-229">The number of retries, specific retry policy and wait time are all configurable.</span></span>

- <span data-ttu-id="def42-230">*Azure Service Bus.*</span><span class="sxs-lookup"><span data-stu-id="def42-230">*Azure Service Bus.*</span></span> <span data-ttu-id="def42-231">Le client Service Bus expose une [classe RetryPolicy](xref:Microsoft.ServiceBus.RetryPolicy) qui peut être configurée avec un intervalle d’interruption, le nombre de tentatives, et <xref:Microsoft.ServiceBus.RetryExponential.TerminationTimeBuffer%2A> , qui spécifie la durée maximale qu’une opération peut prendre.</span><span class="sxs-lookup"><span data-stu-id="def42-231">The Service Bus client exposes a [RetryPolicy class](xref:Microsoft.ServiceBus.RetryPolicy) that can be configured with a back-off interval, retry count, and <xref:Microsoft.ServiceBus.RetryExponential.TerminationTimeBuffer%2A>, which specifies the maximum time an operation can take.</span></span> <span data-ttu-id="def42-232">La stratégie par défaut est de neuf tentatives de nouvelle tentative au maximum, avec une période d’interruption de 30 secondes entre chaque tentative.</span><span class="sxs-lookup"><span data-stu-id="def42-232">The default policy is nine maximum retry attempts with a 30-second backoff period between attempts.</span></span>

- <span data-ttu-id="def42-233">*Azure SQL Database.*</span><span class="sxs-lookup"><span data-stu-id="def42-233">*Azure SQL Database.*</span></span> <span data-ttu-id="def42-234">La prise en charge des nouvelles tentatives est fournie lors de l’utilisation de la bibliothèque de [Entity Framework Core](https://docs.microsoft.com/ef/core/miscellaneous/connection-resiliency) .</span><span class="sxs-lookup"><span data-stu-id="def42-234">Retry support is provided when using the [Entity Framework Core](https://docs.microsoft.com/ef/core/miscellaneous/connection-resiliency) library.</span></span>

- <span data-ttu-id="def42-235">*Stockage Azure.*</span><span class="sxs-lookup"><span data-stu-id="def42-235">*Azure Storage.*</span></span> <span data-ttu-id="def42-236">La bibliothèque cliente de stockage prend en charge les opérations de nouvelle tentative.</span><span class="sxs-lookup"><span data-stu-id="def42-236">The storage client library support retry operations.</span></span> <span data-ttu-id="def42-237">Les stratégies varient selon les tables, les objets BLOB et les files d’attente Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="def42-237">The strategies vary across Azure storage tables, blobs, and queues.</span></span> <span data-ttu-id="def42-238">De même, les autres tentatives basculent entre les emplacements des services de stockage principaux et secondaires lorsque la fonctionnalité de géoredondance est activée.</span><span class="sxs-lookup"><span data-stu-id="def42-238">As well, alternate retries switch between primary and secondary storage services locations when the geo-redundancy feature is enabled.</span></span>

- <span data-ttu-id="def42-239">*Event Hubs Azure.*</span><span class="sxs-lookup"><span data-stu-id="def42-239">*Azure Event Hubs.*</span></span> <span data-ttu-id="def42-240">La bibliothèque cliente Event Hub comporte une propriété RetryPolicy, qui comprend une fonctionnalité d’interruption exponentielle configurable.</span><span class="sxs-lookup"><span data-stu-id="def42-240">The Event Hub client library features a RetryPolicy property, which includes a configurable exponential backoff feature.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="def42-241">[Précédent](application-resiliency-patterns.md) 
> [Suivant](resilient-communications.md)</span><span class="sxs-lookup"><span data-stu-id="def42-241">[Previous](application-resiliency-patterns.md)
[Next](resilient-communications.md)</span></span>

---
title: Exploitation des conteneurs et des orchestrateurs
description: Tirer parti des conteneurs et orchestrateurs Kubernetes dans Azure
ms.date: 04/13/2020
ms.openlocfilehash: 64c6c0666398d9ccbc87efad18017bf278568fc4
ms.sourcegitcommit: 957c49696eaf048c284ef8f9f8ffeb562357ad95
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/07/2020
ms.locfileid: "82895553"
---
# <a name="leveraging-containers-and-orchestrators"></a><span data-ttu-id="d6d57-103">Exploitation des conteneurs et des orchestrateurs</span><span class="sxs-lookup"><span data-stu-id="d6d57-103">Leveraging containers and orchestrators</span></span>

[!INCLUDE [book-preview](../../../includes/book-preview.md)]

<span data-ttu-id="d6d57-104">Les conteneurs et orchestrateurs sont conçus pour résoudre les problèmes communs aux approches de déploiement monolithiques.</span><span class="sxs-lookup"><span data-stu-id="d6d57-104">Containers and orchestrators are designed to solve problems common to monolithic deployment approaches.</span></span>

## <a name="challenges-with-monolithic-deployments"></a><span data-ttu-id="d6d57-105">Défis liés aux déploiements monolithiques</span><span class="sxs-lookup"><span data-stu-id="d6d57-105">Challenges with monolithic deployments</span></span>

<span data-ttu-id="d6d57-106">Traditionnellement, la plupart des applications ont été déployées en tant qu’unité unique.</span><span class="sxs-lookup"><span data-stu-id="d6d57-106">Traditionally, most applications have been deployed as a single unit.</span></span> <span data-ttu-id="d6d57-107">Ces applications sont appelées monolithiques.</span><span class="sxs-lookup"><span data-stu-id="d6d57-107">Such applications are referred to as a monolith.</span></span> <span data-ttu-id="d6d57-108">Cette approche générale du déploiement d’applications en tant qu’unités uniques, même si elles sont composées de plusieurs modules ou assemblys, est connue sous le nom d’architecture monolithique, comme le montre la figure 3-1.</span><span class="sxs-lookup"><span data-stu-id="d6d57-108">This general approach of deploying applications as single units even if they're composed of multiple modules or assemblies is known as monolithic architecture, as shown in Figure 3-1.</span></span>

![Architecture monolithique.](./media/monolithic-architecture.png)

<span data-ttu-id="d6d57-110">**Figure 3-1**.</span><span class="sxs-lookup"><span data-stu-id="d6d57-110">**Figure 3-1**.</span></span> <span data-ttu-id="d6d57-111">Architecture monolithique.</span><span class="sxs-lookup"><span data-stu-id="d6d57-111">Monolithic architecture.</span></span>

<span data-ttu-id="d6d57-112">Bien qu’ils aient l’avantage de simplifier, les architectures monolithiques font face à un certain nombre de défis :</span><span class="sxs-lookup"><span data-stu-id="d6d57-112">Although they have the benefit of simplicity, monolithic architectures face a number of challenges:</span></span>

### <a name="deployment"></a><span data-ttu-id="d6d57-113">Déploiement</span><span class="sxs-lookup"><span data-stu-id="d6d57-113">Deployment</span></span>

<span data-ttu-id="d6d57-114">Les applications monolithiques requièrent un déploiement complet de l’ensemble de l’application, même si une petite modification a été apportée.</span><span class="sxs-lookup"><span data-stu-id="d6d57-114">Monolithic applications require a full deployment of the entire application, even if only a small change has been made.</span></span> <span data-ttu-id="d6d57-115">Les déploiements complets peuvent être coûteux et sujets aux erreurs.</span><span class="sxs-lookup"><span data-stu-id="d6d57-115">Full deployments can be expensive and error prone.</span></span> <span data-ttu-id="d6d57-116">En outre, ils nécessitent un redémarrage de l’application, ce qui affecte temporairement l’indisponibilité.</span><span class="sxs-lookup"><span data-stu-id="d6d57-116">Additionally, they require a restart of the application, which temporarily impacts unavailability.</span></span>

### <a name="scaling"></a><span data-ttu-id="d6d57-117">Mise à l'échelle</span><span class="sxs-lookup"><span data-stu-id="d6d57-117">Scaling</span></span>

<span data-ttu-id="d6d57-118">Une application monolithique est hébergée entièrement sur une seule instance de machine, ce qui nécessite souvent du matériel à capacité élevée.</span><span class="sxs-lookup"><span data-stu-id="d6d57-118">A monolithic application is hosted entirely on a single machine instance, often requiring high-capability hardware.</span></span> <span data-ttu-id="d6d57-119">Si une partie du monolithe requiert une mise à l’échelle, une autre copie de l’application entière doit être déployée sur un autre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="d6d57-119">If any part of the monolith requires scaling, another copy of the entire application must be deployed to another machine.</span></span> <span data-ttu-id="d6d57-120">Avec un monolithique, vous ne pouvez pas mettre à l’échelle des composants d’application individuellement. c’est tout ou rien.</span><span class="sxs-lookup"><span data-stu-id="d6d57-120">With a monolith, you can't scale application components individually - it's all or nothing.</span></span> <span data-ttu-id="d6d57-121">La mise à l’échelle des composants qui ne nécessitent pas de mise à l’échelle entraîne une utilisation inefficace et coûteuse des ressources.</span><span class="sxs-lookup"><span data-stu-id="d6d57-121">Scaling components that don't require scaling results in inefficient and costly resource usage.</span></span>

### <a name="environment"></a><span data-ttu-id="d6d57-122">Environnement</span><span class="sxs-lookup"><span data-stu-id="d6d57-122">Environment</span></span>

<span data-ttu-id="d6d57-123">Les applications monolithiques sont généralement déployées dans un environnement d’hébergement avec un système d’exploitation, un Runtime et des dépendances de bibliothèque préinstallés.</span><span class="sxs-lookup"><span data-stu-id="d6d57-123">Monolithic applications are typically deployed to a hosting environment with a pre-installed operating system, runtime, and library dependencies.</span></span> <span data-ttu-id="d6d57-124">Cet environnement peut ne pas correspondre à celui sur lequel l’application a été développée ou testée.</span><span class="sxs-lookup"><span data-stu-id="d6d57-124">This environment may not match that upon which the application was developed or tested.</span></span> <span data-ttu-id="d6d57-125">Les incohérences entre les environnements d’application constituent une source commune de problèmes pour les déploiements monolithiques.</span><span class="sxs-lookup"><span data-stu-id="d6d57-125">Inconsistencies across application environments are a common source of problems for monolithic deployments.</span></span>

### <a name="coupling"></a><span data-ttu-id="d6d57-126">Couplage</span><span class="sxs-lookup"><span data-stu-id="d6d57-126">Coupling</span></span>

<span data-ttu-id="d6d57-127">Une application monolithique est susceptible d’avoir un couplage élevé sur ses composants fonctionnels.</span><span class="sxs-lookup"><span data-stu-id="d6d57-127">A monolithic application is likely to experience high coupling across its functional components.</span></span> <span data-ttu-id="d6d57-128">Sans limites physiques, les modifications du système entraînent souvent des effets secondaires inattendus et coûteux.</span><span class="sxs-lookup"><span data-stu-id="d6d57-128">Without hard boundaries, system changes often result in unintended and costly side effects.</span></span> <span data-ttu-id="d6d57-129">Les nouvelles fonctionnalités et correctifs deviennent délicats, fastidieux et coûteux à implémenter.</span><span class="sxs-lookup"><span data-stu-id="d6d57-129">New features/fixes become tricky, time-consuming, and expensive to implement.</span></span> <span data-ttu-id="d6d57-130">Les mises à jour nécessitent un test approfondi.</span><span class="sxs-lookup"><span data-stu-id="d6d57-130">Updates require extensive testing.</span></span> <span data-ttu-id="d6d57-131">Le couplage complique également la refactorisation des composants ou l’échange dans d’autres implémentations.</span><span class="sxs-lookup"><span data-stu-id="d6d57-131">Coupling also makes it difficult to refactor components or swap in alternative implementations.</span></span> <span data-ttu-id="d6d57-132">Même s’ils sont construits avec une séparation stricte des préoccupations, les ensembles d’érosions de l’architecture dans comme la base de code monolithique se détériorent avec des « cas spéciaux » jamais terminés.</span><span class="sxs-lookup"><span data-stu-id="d6d57-132">Even when constructed with a strict separation of concerns, architectural erosion sets in as the monolithic code base deteriorates with never-ending "special cases."</span></span>

### <a name="platform-lock-in"></a><span data-ttu-id="d6d57-133">Verrouillage de la plateforme</span><span class="sxs-lookup"><span data-stu-id="d6d57-133">Platform lock-in</span></span>

<span data-ttu-id="d6d57-134">Une application monolithique est construite avec une seule pile technologique.</span><span class="sxs-lookup"><span data-stu-id="d6d57-134">A monolithic application is constructed with a single technology stack.</span></span> <span data-ttu-id="d6d57-135">Tout en offrant une uniformité, cet engagement peut devenir un obstacle à l’innovation.</span><span class="sxs-lookup"><span data-stu-id="d6d57-135">While offering uniformity, this commitment can become a barrier to innovation.</span></span> <span data-ttu-id="d6d57-136">De nouveaux composants et fonctionnalités seront créés à l’aide de la pile actuelle de l’application, même si des technologies plus modernes peuvent être un meilleur choix.</span><span class="sxs-lookup"><span data-stu-id="d6d57-136">New features and components will be built using the application's current stack - even when more modern technologies may be a better choice.</span></span> <span data-ttu-id="d6d57-137">Un risque à plus long terme est que votre pile de technologies devient obsolète et obsolète.</span><span class="sxs-lookup"><span data-stu-id="d6d57-137">A longer-term risk is your technology stack becoming outdated and obsolete.</span></span> <span data-ttu-id="d6d57-138">La réorganisation d’une application entière vers une nouvelle plateforme plus moderne est au mieux coûteuse et risquée.</span><span class="sxs-lookup"><span data-stu-id="d6d57-138">Rearchitecting an entire application to a new, more modern platform is at best expensive and risky.</span></span>

## <a name="what-are-the-benefits-of-containers-and-orchestrators"></a><span data-ttu-id="d6d57-139">Quels sont les avantages des conteneurs et des orchestrateurs ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-139">What are the benefits of containers and orchestrators?</span></span>

<span data-ttu-id="d6d57-140">Nous avons introduit les conteneurs dans le chapitre 1.</span><span class="sxs-lookup"><span data-stu-id="d6d57-140">We introduced containers in Chapter 1.</span></span> <span data-ttu-id="d6d57-141">Nous avons mis en évidence comment la CNCF (Cloud Native Computing Foundation) classe le conteneur comme la première étape de leur [carte de piste Cloud Native](https://raw.githubusercontent.com/cncf/trailmap/master/CNCF_TrailMap_latest.png) pour les entreprises qui commencent leur parcours Cloud-native.</span><span class="sxs-lookup"><span data-stu-id="d6d57-141">We highlighted how the Cloud Native Computing Foundation (CNCF) ranks containerization as the first step in their [Cloud-Native Trail Map](https://raw.githubusercontent.com/cncf/trailmap/master/CNCF_TrailMap_latest.png) - guidance for enterprises beginning their cloud-native journey.</span></span> <span data-ttu-id="d6d57-142">Dans cette section, nous aborderons les avantages des conteneurs.</span><span class="sxs-lookup"><span data-stu-id="d6d57-142">In this section, we discuss the benefits of containers.</span></span>

<span data-ttu-id="d6d57-143">L’arrimeur est la plateforme de gestion des conteneurs la plus populaire.</span><span class="sxs-lookup"><span data-stu-id="d6d57-143">Docker is the most popular container management platform.</span></span> <span data-ttu-id="d6d57-144">Il fonctionne avec les conteneurs sur Linux ou Windows.</span><span class="sxs-lookup"><span data-stu-id="d6d57-144">It works with containers on both Linux or Windows.</span></span> <span data-ttu-id="d6d57-145">Les conteneurs fournissent des environnements d’application distincts mais reproductibles qui s’exécutent de la même façon sur tous les systèmes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-145">Containers provide separate but reproducible application environments that run the same way on any system.</span></span> <span data-ttu-id="d6d57-146">Cet aspect les rend parfaitement adaptés au développement et à l’hébergement des services Cloud natifs.</span><span class="sxs-lookup"><span data-stu-id="d6d57-146">This aspect makes them perfect for developing and hosting cloud-native services.</span></span> <span data-ttu-id="d6d57-147">Les conteneurs sont isolés les uns des autres.</span><span class="sxs-lookup"><span data-stu-id="d6d57-147">Containers are isolated from one another.</span></span> <span data-ttu-id="d6d57-148">Deux conteneurs sur le même matériel hôte peuvent avoir différentes versions de logiciels, sans provoquer de conflits.</span><span class="sxs-lookup"><span data-stu-id="d6d57-148">Two containers on the same host hardware can have different versions of software, without causing conflicts.</span></span>

<span data-ttu-id="d6d57-149">Les conteneurs sont définis par des fichiers texte simples qui deviennent des artefacts de projet et sont archivés dans le contrôle de code source.</span><span class="sxs-lookup"><span data-stu-id="d6d57-149">Containers are defined by simple text-based files that become project artifacts and are checked into source control.</span></span> <span data-ttu-id="d6d57-150">Bien que les serveurs complets et les machines virtuelles requièrent un effort manuel pour la mise à jour, les conteneurs sont facilement contrôlés par contrôle de version.</span><span class="sxs-lookup"><span data-stu-id="d6d57-150">While full servers and virtual machines require manual effort to update, containers are easily version-controlled.</span></span> <span data-ttu-id="d6d57-151">Les applications générées pour s’exécuter dans des conteneurs peuvent être développées, testées et déployées à l’aide d’outils automatisés dans le cadre d’un pipeline de génération.</span><span class="sxs-lookup"><span data-stu-id="d6d57-151">Apps built to run in containers can be developed, tested, and deployed using automated tools as part of a build pipeline.</span></span>

<span data-ttu-id="d6d57-152">Les conteneurs sont immuables.</span><span class="sxs-lookup"><span data-stu-id="d6d57-152">Containers are immutable.</span></span> <span data-ttu-id="d6d57-153">Une fois que vous avez défini un conteneur, vous pouvez le recréer et l’exécuter exactement de la même façon.</span><span class="sxs-lookup"><span data-stu-id="d6d57-153">Once you define a container, you can recreate and run it exactly the same way.</span></span> <span data-ttu-id="d6d57-154">Cette immuabilité se prête à la conception basée sur les composants.</span><span class="sxs-lookup"><span data-stu-id="d6d57-154">This immutability lends itself to component-based design.</span></span> <span data-ttu-id="d6d57-155">Si certaines parties d’une application évoluent différemment des autres, pourquoi redéployer l’application entière quand vous pouvez simplement déployer les parties qui changent le plus fréquemment ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-155">If some parts of an application evolve differently than others, why redeploy the entire app when you can just deploy the parts that change most frequently?</span></span> <span data-ttu-id="d6d57-156">Des fonctionnalités différentes et des problèmes de coupe croisée d’une application peuvent être divisées en unités distinctes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-156">Different features and cross-cutting concerns of an app can be broken up into separate units.</span></span> <span data-ttu-id="d6d57-157">La figure 3-2 montre comment une application monolithique peut tirer parti des conteneurs et des microservices en déléguant certaines fonctionnalités ou fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="d6d57-157">Figure 3-2 shows how a monolithic app can take advantage of containers and microservices by delegating certain features or functionality.</span></span> <span data-ttu-id="d6d57-158">Les fonctionnalités restantes de l’application elle-même ont également été en conteneur.</span><span class="sxs-lookup"><span data-stu-id="d6d57-158">The remaining functionality in the app itself has also been containerized.</span></span>

<span data-ttu-id="d6d57-159">Les conteneurs sont immuables.</span><span class="sxs-lookup"><span data-stu-id="d6d57-159">Containers are immutable.</span></span> <span data-ttu-id="d6d57-160">Une fois que vous avez défini un conteneur, vous pouvez le recréer et l’exécuter exactement de la même façon.</span><span class="sxs-lookup"><span data-stu-id="d6d57-160">Once you define a container, you can recreate and run it exactly the same way.</span></span> <span data-ttu-id="d6d57-161">Cette immuabilité se prête à la conception basée sur les composants.</span><span class="sxs-lookup"><span data-stu-id="d6d57-161">This immutability lends itself to component-based design.</span></span> <span data-ttu-id="d6d57-162">Si certaines parties d’une application évoluent différemment des autres, pourquoi redéployer l’application entière quand vous pouvez simplement déployer les parties qui changent le plus fréquemment ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-162">If some parts of an application evolve differently than others, why redeploy the entire app when you can just deploy the parts that change most frequently?</span></span> <span data-ttu-id="d6d57-163">Des fonctionnalités différentes et des problèmes de coupe croisée d’une application peuvent être divisées en unités distinctes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-163">Different features and cross-cutting concerns of an app can be broken up into separate units.</span></span> <span data-ttu-id="d6d57-164">La figure 3-2 montre comment une application monolithique peut tirer parti des conteneurs et des microservices en déléguant certaines fonctionnalités ou fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="d6d57-164">Figure 3-2 shows how a monolithic app can take advantage of containers and microservices by delegating certain features or functionality.</span></span> <span data-ttu-id="d6d57-165">Les fonctionnalités restantes de l’application elle-même ont également été en conteneur.</span><span class="sxs-lookup"><span data-stu-id="d6d57-165">The remaining functionality in the app itself has also been containerized.</span></span>

<span data-ttu-id="d6d57-166">![Division d’une application monolithique pour utiliser des microservices dans le back end. ](./media/breaking-up-monolith-with-backend-microservices.png)
 **Figure 3-2**.</span><span class="sxs-lookup"><span data-stu-id="d6d57-166">![Breaking up a monolithic app to use microservices in the back end.](./media/breaking-up-monolith-with-backend-microservices.png)
**Figure 3-2**.</span></span> <span data-ttu-id="d6d57-167">Division d’une application monolithique pour utiliser des microservices dans le back end.</span><span class="sxs-lookup"><span data-stu-id="d6d57-167">Breaking up a monolithic app to use microservices in the back end.</span></span>

<span data-ttu-id="d6d57-168">Chaque service Cloud natif est généré et déployé dans un conteneur distinct.</span><span class="sxs-lookup"><span data-stu-id="d6d57-168">Each cloud-native service is built and deployed in a separate container.</span></span> <span data-ttu-id="d6d57-169">Chaque peut être mis à jour en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="d6d57-169">Each can update as needed.</span></span> <span data-ttu-id="d6d57-170">Les services individuels peuvent être hébergés sur des nœuds avec des ressources appropriées pour chaque service.</span><span class="sxs-lookup"><span data-stu-id="d6d57-170">Individual services can be hosted on nodes with resources appropriate to each service.</span></span> <span data-ttu-id="d6d57-171">L’environnement dans lequel chaque service s’exécute est immuable, partagé entre les environnements de développement, de test et de production, et facilement géré par un contrôle de version.</span><span class="sxs-lookup"><span data-stu-id="d6d57-171">The environment each service runs in is immutable, shared across dev, test, and production environments, and easily versioned.</span></span> <span data-ttu-id="d6d57-172">Le couplage entre les différentes zones de l’application se produit explicitement comme des appels ou des messages entre les services, et non pour les dépendances au moment de la compilation dans le monolithe.</span><span class="sxs-lookup"><span data-stu-id="d6d57-172">Coupling between different areas of the application occurs explicitly as calls or messages between services, not compile-time dependencies within the monolith.</span></span> <span data-ttu-id="d6d57-173">Vous pouvez également choisir la technologie qui correspond le mieux à une fonctionnalité donnée sans avoir à modifier le reste de l’application.</span><span class="sxs-lookup"><span data-stu-id="d6d57-173">You can also choose the technology that best suites a given capability without requiring changes to the rest of the app.</span></span>

<span data-ttu-id="d6d57-174">Les services en conteneur requièrent une gestion automatisée.</span><span class="sxs-lookup"><span data-stu-id="d6d57-174">Containerized services require automated management.</span></span> <span data-ttu-id="d6d57-175">Il n’est pas possible d’administrer manuellement un grand ensemble de conteneurs déployés de manière indépendante.</span><span class="sxs-lookup"><span data-stu-id="d6d57-175">It wouldn't be feasible to manually administer a large set of independently deployed containers.</span></span> <span data-ttu-id="d6d57-176">Par exemple, considérez les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="d6d57-176">For example, consider the following tasks:</span></span>

- <span data-ttu-id="d6d57-177">Comment les instances de conteneur seront-elles approvisionnées sur un cluster de plusieurs ordinateurs ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-177">How will container instances be provisioned across a cluster of many machines?</span></span>
- <span data-ttu-id="d6d57-178">Une fois le déploiement terminé, comment les conteneurs découvrent et communiquent les uns avec les autres ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-178">Once deployed, how will containers discover and communicate with each other?</span></span>
- <span data-ttu-id="d6d57-179">Comment les conteneurs peuvent-ils être mis à l’échelle ou sortants à la demande ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-179">How can containers scale in or out on-demand?</span></span>
- <span data-ttu-id="d6d57-180">Comment surveiller l’intégrité de chaque conteneur ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-180">How do you monitor the health of each container?</span></span>
- <span data-ttu-id="d6d57-181">Comment protéger un conteneur contre les défaillances matérielles et logicielles ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-181">How do you protect a container against hardware and software failures?</span></span>
- <span data-ttu-id="d6d57-182">Comment mettre à niveau des conteneurs pour une application active sans temps d’arrêt ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-182">How do upgrade containers for a live application with zero downtime?</span></span>

<span data-ttu-id="d6d57-183">Les orchestrateurs de conteneurs adressent et automatisent ces problèmes et d’autres.</span><span class="sxs-lookup"><span data-stu-id="d6d57-183">Container orchestrators address and automate these and other concerns.</span></span>

<span data-ttu-id="d6d57-184">Dans le système Eco Cloud-native, Kubernetes est devenu le conteneur de facto Orchestrator.</span><span class="sxs-lookup"><span data-stu-id="d6d57-184">In the cloud-native eco-system, Kubernetes has become the de facto container orchestrator.</span></span> <span data-ttu-id="d6d57-185">Il s’agit d’une plateforme open source gérée par Cloud Native Computing Foundation (CNCF).</span><span class="sxs-lookup"><span data-stu-id="d6d57-185">It's an open-source platform managed by the Cloud Native Computing Foundation (CNCF).</span></span> <span data-ttu-id="d6d57-186">Kubernetes automatise le déploiement, la mise à l’échelle et les problèmes opérationnels des charges de travail en conteneur sur un cluster d’ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="d6d57-186">Kubernetes automates the deployment, scaling, and operational concerns of containerized workloads across a machine cluster.</span></span> <span data-ttu-id="d6d57-187">Toutefois, l’installation et la gestion de Kubernetes sont notoirement complexes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-187">However, installing and managing Kubernetes is notoriously complex.</span></span>

<span data-ttu-id="d6d57-188">Une meilleure approche consiste à tirer parti de Kubernetes en tant que service géré à partir d’un fournisseur de Cloud.</span><span class="sxs-lookup"><span data-stu-id="d6d57-188">A much better approach is to leverage Kubernetes as a managed service from a cloud vendor.</span></span> <span data-ttu-id="d6d57-189">Le Cloud Azure est doté d’une plateforme Kubernetes entièrement gérée [, intitulée Azure Kubernetes service (AKS)](https://azure.microsoft.com/services/kubernetes-service/).</span><span class="sxs-lookup"><span data-stu-id="d6d57-189">The Azure cloud features a fully managed Kubernetes platform entitled [Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/).</span></span> <span data-ttu-id="d6d57-190">AKS fait abstraction de la complexité et de la surcharge opérationnelle de la gestion des Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-190">AKS abstracts the complexity and operational overhead of managing Kubernetes.</span></span> <span data-ttu-id="d6d57-191">Vous consommez Kubernetes en tant que service Cloud. Microsoft est responsable de la gestion et de la prise en charge.</span><span class="sxs-lookup"><span data-stu-id="d6d57-191">You consume Kubernetes as a cloud service; Microsoft takes responsibility for managing and supporting it.</span></span> <span data-ttu-id="d6d57-192">AKS s’intègre également étroitement avec d’autres services Azure et des outils de développement.</span><span class="sxs-lookup"><span data-stu-id="d6d57-192">AKS also tightly integrates with other Azure services and dev tools.</span></span>

<span data-ttu-id="d6d57-193">AKS est une technologie basée sur les clusters.</span><span class="sxs-lookup"><span data-stu-id="d6d57-193">AKS is a cluster-based technology.</span></span> <span data-ttu-id="d6d57-194">Un pool de machines virtuelles fédérées, ou nœuds, est déployé dans le Cloud Azure.</span><span class="sxs-lookup"><span data-stu-id="d6d57-194">A pool of federated virtual machines, or nodes, is deployed to the Azure cloud.</span></span> <span data-ttu-id="d6d57-195">Ensemble, ils forment un environnement hautement disponible ou un cluster.</span><span class="sxs-lookup"><span data-stu-id="d6d57-195">Together they form a highly available environment, or cluster.</span></span> <span data-ttu-id="d6d57-196">Le cluster apparaît comme une entité unique et transparente pour votre application Cloud-native.</span><span class="sxs-lookup"><span data-stu-id="d6d57-196">The cluster appears as a seamless, single entity to your cloud-native application.</span></span> <span data-ttu-id="d6d57-197">En coulisse, AKS déploie vos services en conteneur sur ces nœuds en suivant une stratégie prédéfinie qui répartit équitablement la charge.</span><span class="sxs-lookup"><span data-stu-id="d6d57-197">Under the hood, AKS deploys your containerized services across these nodes following a predefined strategy that evenly distributes the load.</span></span>

<span data-ttu-id="d6d57-198">Les services en conteneur requièrent une gestion automatisée.</span><span class="sxs-lookup"><span data-stu-id="d6d57-198">Containerized services require automated management.</span></span> <span data-ttu-id="d6d57-199">Il n’est pas possible d’administrer manuellement un grand ensemble de conteneurs déployés de manière indépendante.</span><span class="sxs-lookup"><span data-stu-id="d6d57-199">It wouldn't be feasible to manually administer a large set of independently deployed containers.</span></span> <span data-ttu-id="d6d57-200">Par exemple, considérez les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="d6d57-200">For example, consider the following tasks:</span></span>

- <span data-ttu-id="d6d57-201">Comment les instances de conteneur seront-elles approvisionnées sur un cluster de plusieurs ordinateurs ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-201">How will container instances be provisioned across a cluster of many machines?</span></span>
- <span data-ttu-id="d6d57-202">Une fois le déploiement terminé, comment les conteneurs découvrent et communiquent les uns avec les autres ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-202">Once deployed, how will containers discover and communicate with each other?</span></span>
- <span data-ttu-id="d6d57-203">Comment les conteneurs peuvent-ils être mis à l’échelle ou sortants à la demande ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-203">How can containers scale in or out on-demand?</span></span>
- <span data-ttu-id="d6d57-204">Comment surveiller l’intégrité de chaque conteneur ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-204">How do you monitor the health of each container?</span></span>
- <span data-ttu-id="d6d57-205">Comment protéger un conteneur contre les défaillances matérielles et logicielles ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-205">How do you protect a container against hardware and software failures?</span></span>
- <span data-ttu-id="d6d57-206">Comment mettre à niveau des conteneurs pour une application active sans temps d’arrêt ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-206">How do upgrade containers for a live application with zero downtime?</span></span>

<span data-ttu-id="d6d57-207">Les orchestrateurs de conteneurs adressent et automatisent ces problèmes et d’autres.</span><span class="sxs-lookup"><span data-stu-id="d6d57-207">Container orchestrators address and automate these and other concerns.</span></span>

<span data-ttu-id="d6d57-208">Dans le système Eco Cloud-native, Kubernetes est devenu le conteneur de facto Orchestrator.</span><span class="sxs-lookup"><span data-stu-id="d6d57-208">In the cloud-native eco-system, Kubernetes has become the de facto container orchestrator.</span></span> <span data-ttu-id="d6d57-209">Il s’agit d’une plateforme open source gérée par Cloud Native Computing Foundation (CNCF).</span><span class="sxs-lookup"><span data-stu-id="d6d57-209">It's an open-source platform managed by the Cloud Native Computing Foundation (CNCF).</span></span> <span data-ttu-id="d6d57-210">Kubernetes automatise le déploiement, la mise à l’échelle et les problèmes opérationnels des charges de travail en conteneur sur un cluster d’ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="d6d57-210">Kubernetes automates the deployment, scaling, and operational concerns of containerized workloads across a machine cluster.</span></span> <span data-ttu-id="d6d57-211">Toutefois, l’installation et la gestion de Kubernetes sont notoirement complexes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-211">However, installing and managing Kubernetes is notoriously complex.</span></span>

<span data-ttu-id="d6d57-212">Une meilleure approche consiste à tirer parti de Kubernetes en tant que service géré à partir d’un fournisseur de Cloud.</span><span class="sxs-lookup"><span data-stu-id="d6d57-212">A much better approach is to leverage Kubernetes as a managed service from a cloud vendor.</span></span> <span data-ttu-id="d6d57-213">Le Cloud Azure est doté d’une plateforme Kubernetes entièrement gérée [, intitulée Azure Kubernetes service (AKS)](https://azure.microsoft.com/services/kubernetes-service/).</span><span class="sxs-lookup"><span data-stu-id="d6d57-213">The Azure cloud features a fully managed Kubernetes platform entitled [Azure Kubernetes Service (AKS)](https://azure.microsoft.com/services/kubernetes-service/).</span></span> <span data-ttu-id="d6d57-214">AKS fait abstraction de la complexité et de la surcharge opérationnelle de la gestion des Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-214">AKS abstracts the complexity and operational overhead of managing Kubernetes.</span></span> <span data-ttu-id="d6d57-215">Vous consommez Kubernetes en tant que service Cloud. Microsoft est responsable de la gestion et de la prise en charge.</span><span class="sxs-lookup"><span data-stu-id="d6d57-215">You consume Kubernetes as a cloud service; Microsoft takes responsibility for managing and supporting it.</span></span> <span data-ttu-id="d6d57-216">AKS s’intègre également étroitement avec d’autres services Azure et des outils de développement.</span><span class="sxs-lookup"><span data-stu-id="d6d57-216">AKS also tightly integrates with other Azure services and dev tools.</span></span>

<span data-ttu-id="d6d57-217">AKS est une technologie basée sur les clusters.</span><span class="sxs-lookup"><span data-stu-id="d6d57-217">AKS is a cluster-based technology.</span></span> <span data-ttu-id="d6d57-218">Un pool de machines virtuelles fédérées, ou nœuds, est déployé dans le Cloud Azure.</span><span class="sxs-lookup"><span data-stu-id="d6d57-218">A pool of federated virtual machines, or nodes, is deployed to the Azure cloud.</span></span> <span data-ttu-id="d6d57-219">Ensemble, ils forment un environnement hautement disponible ou un cluster.</span><span class="sxs-lookup"><span data-stu-id="d6d57-219">Together they form a highly available environment, or cluster.</span></span> <span data-ttu-id="d6d57-220">Le cluster apparaît comme une entité unique et transparente pour votre application Cloud-native.</span><span class="sxs-lookup"><span data-stu-id="d6d57-220">The cluster appears as a seamless, single entity to your cloud-native application.</span></span> <span data-ttu-id="d6d57-221">En coulisse, AKS déploie vos services en conteneur sur ces nœuds en suivant une stratégie prédéfinie qui répartit équitablement la charge.</span><span class="sxs-lookup"><span data-stu-id="d6d57-221">Under the hood, AKS deploys your containerized services across these nodes following a predefined strategy that evenly distributes the load.</span></span>

## <a name="what-are-the-scaling-benefits"></a><span data-ttu-id="d6d57-222">Quels sont les avantages de la mise à l’échelle ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-222">What are the scaling benefits?</span></span>

<span data-ttu-id="d6d57-223">Les services basés sur des conteneurs peuvent tirer parti des avantages de la mise à l’échelle proposés par les outils d’orchestration tels que Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-223">Services built on containers can leverage scaling benefits provided by orchestration tools like Kubernetes.</span></span> <span data-ttu-id="d6d57-224">Par conception, les conteneurs ne savent qu’eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-224">By design containers only know about themselves.</span></span> <span data-ttu-id="d6d57-225">Une fois que vous avez plusieurs conteneurs qui doivent fonctionner ensemble, vous devez les organiser à un niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="d6d57-225">Once you have multiple containers that need to work together, you should organize them at a higher level.</span></span> <span data-ttu-id="d6d57-226">L’organisation d’un grand nombre de conteneurs et de leurs dépendances partagées, telles que la configuration du réseau, est l’endroit où les outils d’orchestration entrent pour gagner le jour.</span><span class="sxs-lookup"><span data-stu-id="d6d57-226">Organizing large numbers of containers and their shared dependencies, such as network configuration, is where orchestration tools come in to save the day!</span></span> <span data-ttu-id="d6d57-227">Kubernetes crée une couche d’abstraction sur des groupes de conteneurs et les organise en *Pod*.</span><span class="sxs-lookup"><span data-stu-id="d6d57-227">Kubernetes creates an abstraction layer over groups of containers and organizes them into *pods*.</span></span> <span data-ttu-id="d6d57-228">Les POD s’exécutent sur des ordinateurs de travail désignés sous le terme de *nœuds*.</span><span class="sxs-lookup"><span data-stu-id="d6d57-228">Pods run on worker machines referred to as *nodes*.</span></span> <span data-ttu-id="d6d57-229">Cette structure organisée est appelée *cluster*.</span><span class="sxs-lookup"><span data-stu-id="d6d57-229">This organized structure is referred to as a *cluster*.</span></span> <span data-ttu-id="d6d57-230">La figure 3-3 montre les différents composants d’un cluster Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-230">Figure 3-3 shows the different components of a Kubernetes cluster.</span></span>

<span data-ttu-id="d6d57-231">![Composants de cluster Kubernetes. ](./media/kubernetes-cluster-components.png)
 **Figure 3-3**.</span><span class="sxs-lookup"><span data-stu-id="d6d57-231">![Kubernetes cluster components.](./media/kubernetes-cluster-components.png)
**Figure 3-3**.</span></span> <span data-ttu-id="d6d57-232">Composants de cluster Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-232">Kubernetes cluster components.</span></span>

<span data-ttu-id="d6d57-233">La mise à l’échelle des charges de travail en conteneur est une fonctionnalité clé des orchestrateurs de conteneurs.</span><span class="sxs-lookup"><span data-stu-id="d6d57-233">Scaling containerized workloads is a key feature of container orchestrators.</span></span> <span data-ttu-id="d6d57-234">AKS prend en charge la mise à l’échelle automatique sur deux dimensions : les instances de conteneur et les nœuds de calcul.</span><span class="sxs-lookup"><span data-stu-id="d6d57-234">AKS supports automatic scaling across two dimensions: Container instances and compute nodes.</span></span> <span data-ttu-id="d6d57-235">Ensemble, ils offrent à AKS la possibilité de répondre rapidement et efficacement aux pics de demande et d’ajouter des ressources supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="d6d57-235">Together they give AKS the ability to quickly and efficiently respond to spikes in demand and add additional resources.</span></span> <span data-ttu-id="d6d57-236">Nous aborderons la mise à l’échelle dans AKS plus loin dans ce chapitre.</span><span class="sxs-lookup"><span data-stu-id="d6d57-236">We discuss scaling in AKS later in this chapter.</span></span>

### <a name="declarative-versus-imperative"></a><span data-ttu-id="d6d57-237">Déclaratifs et impératifs</span><span class="sxs-lookup"><span data-stu-id="d6d57-237">Declarative versus imperative</span></span>

<span data-ttu-id="d6d57-238">Kubernetes prend en charge les configurations déclaratives et impératives.</span><span class="sxs-lookup"><span data-stu-id="d6d57-238">Kubernetes supports both declarative and imperative configuration.</span></span> <span data-ttu-id="d6d57-239">L’approche impérative implique l’exécution de diverses commandes qui indiquent à Kubernetes ce qu’il faut faire chaque étape.</span><span class="sxs-lookup"><span data-stu-id="d6d57-239">The imperative approach involves running various commands that tell Kubernetes what to do each step of the way.</span></span> <span data-ttu-id="d6d57-240">Exécutez cette image.</span><span class="sxs-lookup"><span data-stu-id="d6d57-240">Run this image.</span></span> <span data-ttu-id="d6d57-241">Supprimer ce pod.</span><span class="sxs-lookup"><span data-stu-id="d6d57-241">Delete this pod.</span></span> <span data-ttu-id="d6d57-242">Exposez ce port.</span><span class="sxs-lookup"><span data-stu-id="d6d57-242">Expose this port.</span></span> <span data-ttu-id="d6d57-243">Avec l’approche déclarative, vous créez un fichier de configuration, appelé manifeste, pour décrire ce que vous souhaitez.</span><span class="sxs-lookup"><span data-stu-id="d6d57-243">With the declarative approach, you create a configuration file, called a manifest, to describe what you want instead of what to do.</span></span> <span data-ttu-id="d6d57-244">Kubernetes lit le manifeste et transforme l’état final souhaité en état final réel.</span><span class="sxs-lookup"><span data-stu-id="d6d57-244">Kubernetes reads the manifest and transforms your desired end state into actual end state.</span></span>

<span data-ttu-id="d6d57-245">Les commandes impératives sont très utiles pour l’apprentissage et l’expérimentation interactive.</span><span class="sxs-lookup"><span data-stu-id="d6d57-245">Imperative commands are great for learning and interactive experimentation.</span></span> <span data-ttu-id="d6d57-246">Toutefois, vous souhaiterez créer de manière déclarative des fichiers manifestes Kubernetes pour adopter une infrastructure en tant qu’approche de code, en fournissant des déploiements fiables et reproductibles.</span><span class="sxs-lookup"><span data-stu-id="d6d57-246">However, you'll want to declaratively create Kubernetes manifest files to embrace an infrastructure as code approach, providing for reliable and repeatable deployments.</span></span> <span data-ttu-id="d6d57-247">Le fichier manifeste devient un artefact de projet et est utilisé dans votre pipeline CI/CD pour automatiser les déploiements de Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-247">The manifest file becomes a project artifact and is used in your CI/CD pipeline for automating Kubernetes deployments.</span></span>

<span data-ttu-id="d6d57-248">Si vous avez déjà configuré votre cluster à l’aide de commandes impératives, vous pouvez exporter un manifeste `kubectl get svc SERVICENAME -o yaml > service.yaml`déclaratif à l’aide de.</span><span class="sxs-lookup"><span data-stu-id="d6d57-248">If you've already configured your cluster using imperative commands, you can export a declarative manifest by using `kubectl get svc SERVICENAME -o yaml > service.yaml`.</span></span> <span data-ttu-id="d6d57-249">Cette commande génère un manifeste similaire à celui illustré ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="d6d57-249">This command produces a manifest similar to one shown below:</span></span>

```yaml
apiVersion: v1
kind: Service
metadata:
  creationTimestamp: "2019-09-13T13:58:47Z"
  labels:
    component: apiserver
    provider: kubernetes
  name: kubernetes
  namespace: default
  resourceVersion: "153"
  selfLink: /api/v1/namespaces/default/services/kubernetes
  uid: 9b1fac62-d62e-11e9-8968-00155d38010d
spec:
  clusterIP: 10.96.0.1
  ports:
  - name: https
    port: 443
    protocol: TCP
    targetPort: 6443
  sessionAffinity: None
  type: ClusterIP
status:
  loadBalancer: {}
```

<span data-ttu-id="d6d57-250">Lorsque vous utilisez la configuration déclarative, vous pouvez afficher un aperçu des modifications qui seront apportées avant de `kubectl diff -f FOLDERNAME` les valider à l’aide de sur le dossier où se trouvent vos fichiers de configuration.</span><span class="sxs-lookup"><span data-stu-id="d6d57-250">When using declarative configuration, you can preview the changes that will be made before committing them by using `kubectl diff -f FOLDERNAME` against the folder where your configuration files are located.</span></span> <span data-ttu-id="d6d57-251">Une fois que vous êtes sûr de vouloir appliquer les modifications, `kubectl apply -f FOLDERNAME`exécutez.</span><span class="sxs-lookup"><span data-stu-id="d6d57-251">Once you're sure you want to apply the changes, run `kubectl apply -f FOLDERNAME`.</span></span> <span data-ttu-id="d6d57-252">Ajoutez `-R` pour traiter de manière récursive une hiérarchie de dossiers.</span><span class="sxs-lookup"><span data-stu-id="d6d57-252">Add `-R` to recursively process a folder hierarchy.</span></span>

<span data-ttu-id="d6d57-253">Vous pouvez également utiliser la configuration déclarative avec d’autres fonctionnalités Kubernetes, dont l’un est un déploiement.</span><span class="sxs-lookup"><span data-stu-id="d6d57-253">You can also use declarative configuration with other Kubernetes features, one of which being deployments.</span></span> <span data-ttu-id="d6d57-254">Les déploiements déclaratifs aident à gérer les mises à jour, les mises à jour et la mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="d6d57-254">Declarative deployments help manage releases, updates, and scaling.</span></span> <span data-ttu-id="d6d57-255">Ils indiquent au contrôleur de déploiement Kubernetes comment déployer de nouvelles modifications, monter en charge la charge ou revenir à une révision précédente.</span><span class="sxs-lookup"><span data-stu-id="d6d57-255">They instruct the Kubernetes deployment controller on how to deploy new changes, scale out load, or roll back to a previous revision.</span></span> <span data-ttu-id="d6d57-256">Si un cluster est instable, un déploiement déclaratif rétablit automatiquement le cluster à un état souhaité.</span><span class="sxs-lookup"><span data-stu-id="d6d57-256">If a cluster is unstable, a declarative deployment will automatically return the cluster back to a desired state.</span></span> <span data-ttu-id="d6d57-257">Par exemple, si un nœud doit se bloquer, le mécanisme de déploiement redéploiera un remplacement pour atteindre l’état souhaité.</span><span class="sxs-lookup"><span data-stu-id="d6d57-257">For example, if a node should crash, the deployment mechanism will redeploy a replacement to achieve your desired state</span></span>

<span data-ttu-id="d6d57-258">L’utilisation de la configuration déclarative permet à l’infrastructure d’être représentée en tant que code qui peut être archivé et géré avec le code d’application.</span><span class="sxs-lookup"><span data-stu-id="d6d57-258">Using declarative configuration allows infrastructure to be represented as code that can be checked in and versioned alongside the application code.</span></span> <span data-ttu-id="d6d57-259">Il offre un contrôle amélioré des modifications et une meilleure prise en charge du déploiement continu à l’aide d’un pipeline de build et de déploiement.</span><span class="sxs-lookup"><span data-stu-id="d6d57-259">It provides improved change control and better support for continuous deployment using a build and deploy pipeline.</span></span>

## <a name="what-scenarios-are-ideal-for-containers-and-orchestrators"></a><span data-ttu-id="d6d57-260">Quels sont les scénarios idéaux pour les conteneurs et orchestrateurs ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-260">What scenarios are ideal for containers and orchestrators?</span></span>

<span data-ttu-id="d6d57-261">Les scénarios suivants sont idéaux pour l’utilisation des conteneurs et des orchestrateurs.</span><span class="sxs-lookup"><span data-stu-id="d6d57-261">The following scenarios are ideal for using containers and orchestrators.</span></span>

### <a name="applications-requiring-high-uptime-and-scalability"></a><span data-ttu-id="d6d57-262">Applications nécessitant une disponibilité et une évolutivité élevées</span><span class="sxs-lookup"><span data-stu-id="d6d57-262">Applications requiring high uptime and scalability</span></span>

<span data-ttu-id="d6d57-263">Les applications individuelles qui ont des exigences élevées en termes de temps de fonctionnement et d’évolutivité sont des candidats idéaux pour les architectures natives du Cloud utilisant des microservices, des conteneurs et des orchestrateurs.</span><span class="sxs-lookup"><span data-stu-id="d6d57-263">Individual applications that have high uptime and scalability requirements are ideal candidates for cloud-native architectures using microservices, containers, and orchestrators.</span></span> <span data-ttu-id="d6d57-264">Elles peuvent être développées dans des conteneurs, testées sur des environnements avec version et déployées en production sans temps d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="d6d57-264">They can be developed in containers, tested across versioned environments, and deployed into production with zero downtime.</span></span> <span data-ttu-id="d6d57-265">L’utilisation de clusters Kubernetes garantit que ces applications peuvent également être mises à l’échelle à la demande et récupérées automatiquement à partir des défaillances de nœud.</span><span class="sxs-lookup"><span data-stu-id="d6d57-265">The use of Kubernetes clusters ensures such apps can also scale on demand and recover automatically from node failures.</span></span>

### <a name="large-numbers-of-applications"></a><span data-ttu-id="d6d57-266">Grand nombre d’applications</span><span class="sxs-lookup"><span data-stu-id="d6d57-266">Large numbers of applications</span></span>

<span data-ttu-id="d6d57-267">Les organisations qui déploient et maintiennent un grand nombre d’applications bénéficient des conteneurs et des orchestrateurs.</span><span class="sxs-lookup"><span data-stu-id="d6d57-267">Organizations that deploy and maintain large numbers of applications benefit from containers and orchestrators.</span></span> <span data-ttu-id="d6d57-268">L’effort initial de la configuration des environnements en conteneur et des clusters Kubernetes est essentiellement un coût fixe.</span><span class="sxs-lookup"><span data-stu-id="d6d57-268">The up front effort of setting up containerized environments and Kubernetes clusters is primarily a fixed cost.</span></span> <span data-ttu-id="d6d57-269">Le déploiement, la maintenance et la mise à jour d’applications individuelles ont un coût qui varie selon le nombre d’applications.</span><span class="sxs-lookup"><span data-stu-id="d6d57-269">Deploying, maintaining, and updating individual applications has a cost that varies with the number of applications.</span></span> <span data-ttu-id="d6d57-270">Au-delà d’un petit nombre d’applications, la complexité de la gestion manuelle des applications personnalisées dépasse le coût d’implémentation d’une solution à l’aide de conteneurs et d’orchestrateurs.</span><span class="sxs-lookup"><span data-stu-id="d6d57-270">Beyond a small number of applications, the complexity of maintaining custom applications manually exceeds the cost of implementing a solution using containers and orchestrators.</span></span>

## <a name="when-should-you-avoid-using-containers-and-orchestrators"></a><span data-ttu-id="d6d57-271">Quand devez-vous éviter d’utiliser des conteneurs et des orchestrateurs ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-271">When should you avoid using containers and orchestrators?</span></span>

<span data-ttu-id="d6d57-272">Si vous ne parvenez pas à créer votre application en suivant les principes de l’application à douze facteurs, vous devez envisager d’éviter les conteneurs et les orchestrateurs.</span><span class="sxs-lookup"><span data-stu-id="d6d57-272">If you're unable to build your application following the Twelve-Factor App principles, you should consider avoiding containers and orchestrators.</span></span> <span data-ttu-id="d6d57-273">Dans ce cas, envisagez une plateforme d’hébergement basée sur une machine virtuelle, voire un système hybride.</span><span class="sxs-lookup"><span data-stu-id="d6d57-273">In these cases, consider a VM-based hosting platform, or possibly some hybrid system.</span></span> <span data-ttu-id="d6d57-274">Avec elle, vous pouvez toujours faire tourner certains fragments de fonctionnalités dans des conteneurs distincts ou même des fonctions sans serveur.</span><span class="sxs-lookup"><span data-stu-id="d6d57-274">With it, you can always spin off certain pieces of functionality into separate containers or even serverless functions.</span></span>

## <a name="development-resources"></a><span data-ttu-id="d6d57-275">Ressources de développement</span><span class="sxs-lookup"><span data-stu-id="d6d57-275">Development resources</span></span>

<span data-ttu-id="d6d57-276">Cette section présente une liste succincte de ressources de développement qui peuvent vous aider à commencer à utiliser des conteneurs et orchestrateurs pour votre prochaine application.</span><span class="sxs-lookup"><span data-stu-id="d6d57-276">This section shows a short list of development resources that may help you get started using containers and orchestrators for your next application.</span></span> <span data-ttu-id="d6d57-277">Si vous recherchez des conseils sur la façon de concevoir votre application d’architecture de microservices Native Cloud, lisez le Guide de ce manuel, [microservices .net : architecture pour les applications .net en conteneur](https://dotnet.microsoft.com/download/thank-you/microservices-architecture-ebook).</span><span class="sxs-lookup"><span data-stu-id="d6d57-277">If you're looking for guidance on how to design your cloud-native microservices architecture app, read this book's companion, [.NET Microservices: Architecture for Containerized .NET Applications](https://dotnet.microsoft.com/download/thank-you/microservices-architecture-ebook).</span></span>

### <a name="local-kubernetes-development"></a><span data-ttu-id="d6d57-278">Développement Kubernetes local</span><span class="sxs-lookup"><span data-stu-id="d6d57-278">Local Kubernetes Development</span></span>

<span data-ttu-id="d6d57-279">Les déploiements Kubernetes fournissent une valeur ajoutée dans les environnements de production, mais peuvent également être exécutés localement sur votre ordinateur de développement.</span><span class="sxs-lookup"><span data-stu-id="d6d57-279">Kubernetes deployments provide great value in production environments, but can also run locally on your development machine.</span></span> <span data-ttu-id="d6d57-280">Si vous pouvez travailler sur des microservices individuels, il peut arriver que vous deviez exécuter le système tout entier localement, exactement comme s’il s’exécutait en production.</span><span class="sxs-lookup"><span data-stu-id="d6d57-280">While you may work on individual microservices independently, there may be times when you'll need to run the entire system locally - just as it will run when deployed to production.</span></span> <span data-ttu-id="d6d57-281">Il existe plusieurs outils qui peuvent vous aider : Minikube et docker Desktop.</span><span class="sxs-lookup"><span data-stu-id="d6d57-281">There are several tools that can help: Minikube and Docker Desktop.</span></span> <span data-ttu-id="d6d57-282">Visual Studio fournit également des outils pour le développement de l’ancrage.</span><span class="sxs-lookup"><span data-stu-id="d6d57-282">Visual Studio also provides tooling for Docker development.</span></span>

### <a name="minikube"></a><span data-ttu-id="d6d57-283">Minikube</span><span class="sxs-lookup"><span data-stu-id="d6d57-283">Minikube</span></span>

<span data-ttu-id="d6d57-284">Qu’est-ce que Minikube ?</span><span class="sxs-lookup"><span data-stu-id="d6d57-284">What is Minikube?</span></span> <span data-ttu-id="d6d57-285">Le projet Minikube indique « Minikube implémente un cluster Kubernetes local sur macOS, Linux et Windows ».</span><span class="sxs-lookup"><span data-stu-id="d6d57-285">The Minikube project says "Minikube implements a local Kubernetes cluster on macOS, Linux, and Windows."</span></span> <span data-ttu-id="d6d57-286">Ses principaux objectifs sont les meilleurs outils pour le développement d’applications Kubernetes locales et pour la prise en charge de toutes les fonctionnalités Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="d6d57-286">Its primary goals are "to be the best tool for local Kubernetes application development and to support all Kubernetes features that fit."</span></span> <span data-ttu-id="d6d57-287">L’installation de Minikube est distincte de Dockr, mais Minikube prend en charge d’autres hyperviseurs que le Bureau de l’arrimeur prend en charge.</span><span class="sxs-lookup"><span data-stu-id="d6d57-287">Installing Minikube is separate from Docker, but Minikube supports different hypervisors than Docker Desktop supports.</span></span> <span data-ttu-id="d6d57-288">Les fonctionnalités Kubernetes suivantes sont actuellement prises en charge par Minikube :</span><span class="sxs-lookup"><span data-stu-id="d6d57-288">The following Kubernetes features are currently supported by Minikube:</span></span>

- <span data-ttu-id="d6d57-289">DNS</span><span class="sxs-lookup"><span data-stu-id="d6d57-289">DNS</span></span>
- <span data-ttu-id="d6d57-290">Noexclusions</span><span class="sxs-lookup"><span data-stu-id="d6d57-290">NodePorts</span></span>
- <span data-ttu-id="d6d57-291">ConfigMaps et secrets</span><span class="sxs-lookup"><span data-stu-id="d6d57-291">ConfigMaps and secrets</span></span>
- <span data-ttu-id="d6d57-292">Tableaux de bord</span><span class="sxs-lookup"><span data-stu-id="d6d57-292">Dashboards</span></span>
- <span data-ttu-id="d6d57-293">Runtimes de conteneur : docker, RKT, élément de rapport personnalisé-O et conteneur</span><span class="sxs-lookup"><span data-stu-id="d6d57-293">Container runtimes: Docker, rkt, CRI-O, and containerd</span></span>
- <span data-ttu-id="d6d57-294">Activation de l’interface réseau du conteneur (CNI)</span><span class="sxs-lookup"><span data-stu-id="d6d57-294">Enabling Container Network Interface (CNI)</span></span>
- <span data-ttu-id="d6d57-295">Entrée</span><span class="sxs-lookup"><span data-stu-id="d6d57-295">Ingress</span></span>

<span data-ttu-id="d6d57-296">Après avoir installé Minikube, vous pouvez commencer rapidement à l’utiliser en `minikube start` exécutant la commande, qui télécharge une image et démarre le cluster Kubernetes local.</span><span class="sxs-lookup"><span data-stu-id="d6d57-296">After installing Minikube, you can quickly start using it by running the `minikube start` command, which downloads an image and start the local Kubernetes cluster.</span></span> <span data-ttu-id="d6d57-297">Une fois le cluster démarré, vous interagissez avec lui à l' `kubectl` aide des commandes Kubernetes standard.</span><span class="sxs-lookup"><span data-stu-id="d6d57-297">Once the cluster is started, you interact with it using the standard Kubernetes `kubectl` commands.</span></span>

### <a name="docker-desktop"></a><span data-ttu-id="d6d57-298">Docker Desktop</span><span class="sxs-lookup"><span data-stu-id="d6d57-298">Docker Desktop</span></span>

<span data-ttu-id="d6d57-299">Vous pouvez également utiliser Kubernetes directement à partir du Bureau de l’ancrage sur Windows.</span><span class="sxs-lookup"><span data-stu-id="d6d57-299">You can also work with Kubernetes directly from Docker Desktop on Windows.</span></span> <span data-ttu-id="d6d57-300">C’est votre seule option si vous utilisez des conteneurs Windows et est un excellent choix pour les conteneurs non Windows.</span><span class="sxs-lookup"><span data-stu-id="d6d57-300">It is your only option if you're using Windows Containers, and is a great choice for non-Windows containers as well.</span></span> <span data-ttu-id="d6d57-301">La figure 3-4 montre comment activer la prise en charge des Kubernetes locaux lors de l’exécution de l’ordinateur de bureau de station d’accueil.</span><span class="sxs-lookup"><span data-stu-id="d6d57-301">Figure 3-4 shows how to enable local Kubernetes support when running Docker Desktop.</span></span>

![Configuration de Kubernetes dans le Bureau de l’arrimeur](./media/docker-desktop-kubernetes.png)

<span data-ttu-id="d6d57-303">**Figure 3-4**.</span><span class="sxs-lookup"><span data-stu-id="d6d57-303">**Figure 3-4**.</span></span> <span data-ttu-id="d6d57-304">Configuration de Kubernetes dans le Bureau de l’ancrage.</span><span class="sxs-lookup"><span data-stu-id="d6d57-304">Configuring Kubernetes in Docker Desktop.</span></span>

<span data-ttu-id="d6d57-305">Le Bureau de l’arrimeur est l’outil le plus populaire pour configurer et exécuter des applications en conteneur localement.</span><span class="sxs-lookup"><span data-stu-id="d6d57-305">Docker Desktop is the most popular tool for configuring and running containerized apps locally.</span></span> <span data-ttu-id="d6d57-306">Lorsque vous travaillez avec le Bureau de l’Ancreur, vous pouvez développer localement sur le même ensemble d’images de conteneur d’ancrage que vous allez déployer en production.</span><span class="sxs-lookup"><span data-stu-id="d6d57-306">When you work with Docker Desktop, you can develop locally against the exact same set of Docker container images that you'll deploy to production.</span></span> <span data-ttu-id="d6d57-307">Le Bureau de l’arrimeur est conçu pour créer, tester et expédier des applications en conteneur localement.</span><span class="sxs-lookup"><span data-stu-id="d6d57-307">Docker Desktop is designed to "build, test, and ship" containerized apps locally.</span></span> <span data-ttu-id="d6d57-308">Il prend en charge les conteneurs Linux et Windows.</span><span class="sxs-lookup"><span data-stu-id="d6d57-308">It supports both Linux and Windows containers.</span></span> <span data-ttu-id="d6d57-309">Une fois que vous avez envoyé vos images vers un registre d’images, comme Azure Container Registry ou Hub Dockr, AKS peut les extraire et les déployer en production.</span><span class="sxs-lookup"><span data-stu-id="d6d57-309">Once you push your images to an image registry, like Azure Container Registry or Docker Hub, AKS can pull and deploy them to production.</span></span>

### <a name="visual-studio-docker-tooling"></a><span data-ttu-id="d6d57-310">Outils de l’ancrage de Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d6d57-310">Visual Studio Docker Tooling</span></span>

<span data-ttu-id="d6d57-311">Visual Studio prend en charge le développement de l’ancrage pour les applications Web.</span><span class="sxs-lookup"><span data-stu-id="d6d57-311">Visual Studio supports Docker development for web-based applications.</span></span> <span data-ttu-id="d6d57-312">Lorsque vous créez une application de ASP.NET Core, vous avez la possibilité de la configurer avec la prise en charge de l’ancrage, comme illustré dans la figure 3-5.</span><span class="sxs-lookup"><span data-stu-id="d6d57-312">When you create a new ASP.NET Core application, you have an option to configure it with Docker support, as shown in Figure 3-5.</span></span>

![Visual Studio permet la prise en charge de l’ancrage](./media/visual-studio-enable-docker-support.png)

<span data-ttu-id="d6d57-314">**Figure 3-5**.</span><span class="sxs-lookup"><span data-stu-id="d6d57-314">**Figure 3-5**.</span></span> <span data-ttu-id="d6d57-315">Visual Studio permet la prise en charge de l’ancrage</span><span class="sxs-lookup"><span data-stu-id="d6d57-315">Visual Studio Enable Docker Support</span></span>

<span data-ttu-id="d6d57-316">Lorsque cette option est sélectionnée, le projet est créé avec un `Dockerfile` à sa racine, qui peut être utilisé pour générer et héberger l’application dans un conteneur d’ancrage.</span><span class="sxs-lookup"><span data-stu-id="d6d57-316">When this option is selected, the project is created with a `Dockerfile` in its root, which can be used to build and host the app in a Docker container.</span></span> <span data-ttu-id="d6d57-317">Un exemple de fichier dockerfile est illustré à la figure 3 -6. git.</span><span class="sxs-lookup"><span data-stu-id="d6d57-317">An example Dockerfile is shown in Figure 3-6.git</span></span>

```docker
FROM mcr.microsoft.com/dotnet/core/aspnet:3.0-stretch-slim AS base
WORKDIR /app
EXPOSE 80
EXPOSE 443

FROM mcr.microsoft.com/dotnet/core/sdk:3.0-stretch AS build
WORKDIR /src
COPY ["WebApplication3/WebApplication3.csproj", "WebApplication3/"]
RUN dotnet restore "WebApplication3/WebApplication3.csproj"
COPY . .
WORKDIR "/src/WebApplication3"
RUN dotnet build "WebApplication3.csproj" -c Release -o /app

FROM build AS publish
RUN dotnet publish "WebApplication3.csproj" -c Release -o /app

FROM base AS final
WORKDIR /app
COPY --from=publish /app .
ENTRYPOINT ["dotnet", "WebApplication3.dll"]
```

<span data-ttu-id="d6d57-318">**Figure 3-6**.</span><span class="sxs-lookup"><span data-stu-id="d6d57-318">**Figure 3-6**.</span></span> <span data-ttu-id="d6d57-319">Fichier dockerfile généré par Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d6d57-319">Visual Studio generated Dockerfile</span></span>

<span data-ttu-id="d6d57-320">Le comportement par défaut lors de l’exécution de l’application est également configuré pour utiliser l’Ancreur.</span><span class="sxs-lookup"><span data-stu-id="d6d57-320">The default behavior when the app runs is configured to use Docker as well.</span></span> <span data-ttu-id="d6d57-321">La figure 3-7 montre les différentes options d’exécution disponibles à partir d’un nouveau projet de ASP.NET Core créé avec la prise en charge de l’ancrage ajouté.</span><span class="sxs-lookup"><span data-stu-id="d6d57-321">Figure 3-7 shows the different run options available from a new ASP.NET Core project created with Docker support added.</span></span>

![Options d’exécution de l’Ancreur Visual Studio](./media/visual-studio-docker-run-options.png)

<span data-ttu-id="d6d57-323">**Figure 3-7**.</span><span class="sxs-lookup"><span data-stu-id="d6d57-323">**Figure 3-7**.</span></span> <span data-ttu-id="d6d57-324">Options d’exécution de l’Ancreur Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d6d57-324">Visual Studio Docker Run Options</span></span>

<span data-ttu-id="d6d57-325">En plus du développement local, [Azure dev Spaces](https://docs.microsoft.com/azure/dev-spaces/) offre un moyen pratique à plusieurs développeurs de travailler avec leurs propres configurations Kubernetes dans Azure.</span><span class="sxs-lookup"><span data-stu-id="d6d57-325">In addition to local development, [Azure Dev Spaces](https://docs.microsoft.com/azure/dev-spaces/) provides a convenient way for multiple developers to work with their own Kubernetes configurations within Azure.</span></span> <span data-ttu-id="d6d57-326">Comme vous pouvez le voir dans la figure 3-7, vous pouvez également exécuter l’application dans Azure Dev Spaces.</span><span class="sxs-lookup"><span data-stu-id="d6d57-326">As you can see in Figure 3-7, you can also run the application in Azure Dev Spaces.</span></span>

<span data-ttu-id="d6d57-327">En outre, à tout moment, vous pouvez ajouter la prise en charge de l’ancrage à une application de ASP.NET Core existante.</span><span class="sxs-lookup"><span data-stu-id="d6d57-327">Also, at any time you can add Docker support to an existing ASP.NET Core application.</span></span> <span data-ttu-id="d6d57-328">À partir de l’Explorateur de solutions Visual Studio, cliquez avec le bouton droit sur le projet et **Ajoutez** > la**prise en charge**de l’ancrage, comme illustré à la figure 3-8.</span><span class="sxs-lookup"><span data-stu-id="d6d57-328">From the Visual Studio Solution Explorer, right click on the project and **Add** > **Docker Support**, as shown in Figure 3-8.</span></span>

<span data-ttu-id="d6d57-329">**Figure 3-8**.</span><span class="sxs-lookup"><span data-stu-id="d6d57-329">**Figure 3-8**.</span></span> <span data-ttu-id="d6d57-330">Ajout de la prise en charge de l’ancrage à Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d6d57-330">Adding Docker support to Visual Studio</span></span>

<span data-ttu-id="d6d57-331">Vous pouvez également ajouter la prise en charge de l’orchestration de conteneur, également illustrée dans la figure 3-8.</span><span class="sxs-lookup"><span data-stu-id="d6d57-331">You can also add Container Orchestration Support, also shown in Figure 3-8.</span></span> <span data-ttu-id="d6d57-332">Par défaut, l’orchestrateur utilise Kubernetes et Helm.</span><span class="sxs-lookup"><span data-stu-id="d6d57-332">By default, the orchestrator uses Kubernetes and Helm.</span></span> <span data-ttu-id="d6d57-333">Une fois que vous avez choisi l’orchestrateur, un `azds.yaml` fichier est ajouté à la racine `charts` du projet et un dossier contenant les graphiques Helm utilisés pour configurer et déployer l’application sur Kubernetes est ajouté.</span><span class="sxs-lookup"><span data-stu-id="d6d57-333">Once you've chosen the orchestrator, a `azds.yaml` file is added to the project root and a `charts` folder is added containing the Helm charts used to configure and deploy the application to Kubernetes.</span></span> <span data-ttu-id="d6d57-334">La figure 3-9 montre les fichiers résultants dans un nouveau projet.</span><span class="sxs-lookup"><span data-stu-id="d6d57-334">Figure 3-9 shows the resulting files in a new project.</span></span>

<span data-ttu-id="d6d57-335">Vous pouvez également ajouter la prise en charge de l’orchestration de conteneur, également illustrée dans la figure 3-8.</span><span class="sxs-lookup"><span data-stu-id="d6d57-335">You can also add Container Orchestration Support, also shown in Figure 3-8.</span></span> <span data-ttu-id="d6d57-336">Par défaut, l’orchestrateur utilise Kubernetes et Helm.</span><span class="sxs-lookup"><span data-stu-id="d6d57-336">By default, the orchestrator uses Kubernetes and Helm.</span></span> <span data-ttu-id="d6d57-337">Une fois que vous avez choisi l’orchestrateur, un `azds.yaml` fichier est ajouté à la racine `charts` du projet et un dossier contenant les graphiques Helm utilisés pour configurer et déployer l’application sur Kubernetes est ajouté.</span><span class="sxs-lookup"><span data-stu-id="d6d57-337">Once you've chosen the orchestrator, a `azds.yaml` file is added to the project root and a `charts` folder is added containing the Helm charts used to configure and deploy the application to Kubernetes.</span></span> <span data-ttu-id="d6d57-338">La figure 3-9 montre les fichiers résultants dans un nouveau projet.</span><span class="sxs-lookup"><span data-stu-id="d6d57-338">Figure 3-9 shows the resulting files in a new project.</span></span>

<span data-ttu-id="d6d57-339">**Figure 3-9**.</span><span class="sxs-lookup"><span data-stu-id="d6d57-339">**Figure 3-9**.</span></span> <span data-ttu-id="d6d57-340">Ajout de la prise en charge de l’orchestration à Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d6d57-340">Adding orchestration support to Visual Studio</span></span>

### <a name="visual-studio-code-docker-tooling"></a><span data-ttu-id="d6d57-341">Outils de l’ancrage Visual Studio Code</span><span class="sxs-lookup"><span data-stu-id="d6d57-341">Visual Studio Code Docker Tooling</span></span>

<span data-ttu-id="d6d57-342">Un certain nombre d’extensions sont disponibles pour Visual Studio Code qui prennent en charge le développement de l’ancrage.</span><span class="sxs-lookup"><span data-stu-id="d6d57-342">There are a number of extensions available for Visual Studio Code that support Docker development.</span></span>

<span data-ttu-id="d6d57-343">Microsoft fournit la [station d’accueil pour l’extension de Visual Studio code](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker).</span><span class="sxs-lookup"><span data-stu-id="d6d57-343">Microsoft provides the [Docker for Visual Studio Code extension](https://marketplace.visualstudio.com/items?itemName=ms-azuretools.vscode-docker).</span></span> <span data-ttu-id="d6d57-344">Cette extension simplifie le processus d’ajout de la prise en charge des conteneurs aux applications.</span><span class="sxs-lookup"><span data-stu-id="d6d57-344">This extension simplifies the process of adding container support to applications.</span></span> <span data-ttu-id="d6d57-345">Il élabore les fichiers requis, génère des images de l’ancrage et vous permet de déboguer votre application à l’intérieur d’un conteneur.</span><span class="sxs-lookup"><span data-stu-id="d6d57-345">It scaffolds required files, builds Docker images, and enables you to debug your app inside a container.</span></span> <span data-ttu-id="d6d57-346">L’extension présente un explorateur visuel qui permet d’effectuer facilement des actions sur des conteneurs et des images tels que Démarrer, arrêter, inspecter, supprimer, etc.</span><span class="sxs-lookup"><span data-stu-id="d6d57-346">The extension features a visual explorer that makes it easy to take actions on containers and images such as start, stop, inspect, remove, and more.</span></span> <span data-ttu-id="d6d57-347">L’extension prend également en charge les Docker Compose vous permettant de gérer plusieurs conteneurs en cours d’exécution en tant qu’unité unique.</span><span class="sxs-lookup"><span data-stu-id="d6d57-347">The extension also supports Docker Compose enabling you to manage multiple running containers as a single unit.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="d6d57-348">[Précédent](scale-applications.md)
>[suivant](leverage-serverless-functions.md)</span><span class="sxs-lookup"><span data-stu-id="d6d57-348">[Previous](scale-applications.md)
[Next](leverage-serverless-functions.md)</span></span>

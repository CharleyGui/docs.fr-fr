---
title: Annexe-gRPC pour les développeurs WCF
description: Présentation des transactions distribuées et de leur implémentation dans les architectures de microservices modernes.
ms.date: 09/02/2019
ms.openlocfilehash: f60899463a13e9f740f6ae63150d18eab3069124
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/24/2020
ms.locfileid: "91165856"
---
# <a name="appendix-a---transactions"></a><span data-ttu-id="96baf-103">Annexe A-transactions</span><span class="sxs-lookup"><span data-stu-id="96baf-103">Appendix A - Transactions</span></span>

<span data-ttu-id="96baf-104">Windows Communication Foundation (WCF) prend en charge les transactions distribuées, ce qui vous permet d’effectuer des opérations atomiques sur plusieurs services.</span><span class="sxs-lookup"><span data-stu-id="96baf-104">Windows Communication Foundation (WCF) supports distributed transactions, allowing you to perform atomic operations across multiple services.</span></span> <span data-ttu-id="96baf-105">Cette fonctionnalité est basée sur le [Distributed Transaction Coordinator Microsoft](/previous-versions/windows/desktop/ms684146(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="96baf-105">This functionality is based on the [Microsoft Distributed Transaction Coordinator](/previous-versions/windows/desktop/ms684146(v=vs.85)).</span></span>

<span data-ttu-id="96baf-106">Dans le paysage des microservices plus récents, ce type de traitement automatisé des transactions distribuées n’est pas possible.</span><span class="sxs-lookup"><span data-stu-id="96baf-106">In the newer microservices landscape, this type of automated distributed transaction processing isn't possible.</span></span> <span data-ttu-id="96baf-107">Le nombre de technologies impliquées est trop important, notamment les bases de données relationnelles, les magasins de données NoSQL et les systèmes de messagerie.</span><span class="sxs-lookup"><span data-stu-id="96baf-107">There are too many different technologies involved, including relational databases, NoSQL data stores, and messaging systems.</span></span> <span data-ttu-id="96baf-108">Il peut également y avoir une combinaison de systèmes d’exploitation, de langages de programmation et d’infrastructures en cours d’utilisation dans un environnement unique.</span><span class="sxs-lookup"><span data-stu-id="96baf-108">There might also be a mix of operating systems, programming languages, and frameworks in use in a single environment.</span></span>

<span data-ttu-id="96baf-109">La transaction distribuée WCF est une implémentation de ce qu’on appelle une [validation en deux phases (2PC)](https://en.wikipedia.org/wiki/Two-phase_commit_protocol).</span><span class="sxs-lookup"><span data-stu-id="96baf-109">WCF distributed transaction is an implementation of what is known as a [two-phase commit (2PC)](https://en.wikipedia.org/wiki/Two-phase_commit_protocol).</span></span> <span data-ttu-id="96baf-110">Vous pouvez implémenter des transactions 2PC manuellement en coordonnant les messages entre les services, en créant des transactions ouvertes au sein de chaque service et en envoyant des messages de validation ou de restauration, en fonction de la réussite ou de l’échec.</span><span class="sxs-lookup"><span data-stu-id="96baf-110">You can implement 2PC transactions manually by coordinating messages across services, creating open transactions within each service, and sending commit or rollback messages, depending upon success or failure.</span></span> <span data-ttu-id="96baf-111">Toutefois, la complexité impliquée dans la gestion de 2PC peut augmenter de façon exponentielle à mesure que les systèmes évoluent.</span><span class="sxs-lookup"><span data-stu-id="96baf-111">However, the complexity involved in managing 2PC can increase exponentially as systems evolve.</span></span> <span data-ttu-id="96baf-112">Les transactions ouvertes contiennent des verrous de base de données qui peuvent avoir un impact négatif sur les performances, ou pire, provoquer des interblocages entre les services.</span><span class="sxs-lookup"><span data-stu-id="96baf-112">Open transactions hold database locks that can negatively affect performance, or, worse, cause cross-service deadlocks.</span></span>

<span data-ttu-id="96baf-113">Si possible, il est préférable d’éviter totalement les transactions distribuées.</span><span class="sxs-lookup"><span data-stu-id="96baf-113">If possible, it's best to avoid distributed transactions altogether.</span></span> <span data-ttu-id="96baf-114">Si deux éléments de données sont liés comme pour exiger des mises à jour atomiques, envisagez de les gérer à la fois avec le même service.</span><span class="sxs-lookup"><span data-stu-id="96baf-114">If two items of data are so linked as to require atomic updates, consider handling them both with the same service.</span></span> <span data-ttu-id="96baf-115">Appliquez ces modifications atomiques à l’aide d’une requête ou d’un message unique à ce service.</span><span class="sxs-lookup"><span data-stu-id="96baf-115">Apply those atomic changes by using a single request or message to that service.</span></span>

<span data-ttu-id="96baf-116">Si ce n’est pas possible, une alternative consiste à utiliser le [modèle saga](https://microservices.io/patterns/data/saga.html).</span><span class="sxs-lookup"><span data-stu-id="96baf-116">If that isn't possible, then one alternative is to use the [Saga pattern](https://microservices.io/patterns/data/saga.html).</span></span> <span data-ttu-id="96baf-117">Dans un saga, les mises à jour sont traitées de manière séquentielle. à mesure que chaque mise à jour est réussie, le suivant est déclenché.</span><span class="sxs-lookup"><span data-stu-id="96baf-117">In a saga, updates are processed sequentially; as each update succeeds, the next one is triggered.</span></span> <span data-ttu-id="96baf-118">Ces déclencheurs peuvent être propagés du service au service, ou gérés par un coordinateur saga ou Orchestrator.</span><span class="sxs-lookup"><span data-stu-id="96baf-118">These triggers can be propagated from service to service, or managed by a saga coordinator or orchestrator.</span></span> <span data-ttu-id="96baf-119">Si une mise à jour échoue à tout moment pendant le processus, les services qui ont déjà effectué leurs mises à jour appliquent une logique spécifique pour les inverser.</span><span class="sxs-lookup"><span data-stu-id="96baf-119">If an update fails at any point during the process, the services that have already completed their updates apply specific logic to reverse them.</span></span>

<span data-ttu-id="96baf-120">Une autre option consiste à utiliser la conception pilotée par domaine (DDD) et la séparation des responsabilités de commande/requête (CQRS), comme décrit dans le [livre électronique sur les microservices .net](../microservices/microservice-ddd-cqrs-patterns/index.md).</span><span class="sxs-lookup"><span data-stu-id="96baf-120">Another option is to use Domain Driven Design (DDD) and Command/Query Responsibility Segregation (CQRS), as described in the [.NET Microservices e-book](../microservices/microservice-ddd-cqrs-patterns/index.md).</span></span> <span data-ttu-id="96baf-121">En particulier, l’utilisation d’événements de domaine ou d’une [source d’événements](https://martinfowler.com/eaaDev/EventSourcing.html) peut aider à garantir que les mises à jour sont cohérentes, si elles ne sont pas appliquées immédiatement.</span><span class="sxs-lookup"><span data-stu-id="96baf-121">In particular, using domain events or [event sourcing](https://martinfowler.com/eaaDev/EventSourcing.html) can help to ensure that updates are consistently, if not immediately, applied.</span></span>

>[!div class="step-by-step"]
>[<span data-ttu-id="96baf-122">Précédent</span><span class="sxs-lookup"><span data-stu-id="96baf-122">Previous</span></span>](application-performance-management.md)

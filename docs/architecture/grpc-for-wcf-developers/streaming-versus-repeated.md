---
title: Services de streaming vs champs répétés - gRPC pour les développeurs WCF
description: Comparez les champs répétés aux services de streaming comme moyens de transmettre des collections de données en utilisant gRPC.
ms.date: 09/02/2019
ms.openlocfilehash: 542ebc393f9c9c1ad717d02d01fab33d85c18917
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/12/2020
ms.locfileid: "79147748"
---
# <a name="grpc-streaming-services-vs-repeated-fields"></a><span data-ttu-id="9e43e-103">Services de streaming gRPC et champs répétés</span><span class="sxs-lookup"><span data-stu-id="9e43e-103">gRPC streaming services vs. repeated fields</span></span>

<span data-ttu-id="9e43e-104">les services gRPC fournissent deux façons de retourner des jeux de données, ou des listes d’objets.</span><span class="sxs-lookup"><span data-stu-id="9e43e-104">gRPC services provide two ways of returning datasets, or lists of objects.</span></span> <span data-ttu-id="9e43e-105">La spécification du message Protocol `repeated` Buffers utilise le mot clé pour déclarer des listes ou des pansements de messages dans un autre message.</span><span class="sxs-lookup"><span data-stu-id="9e43e-105">The Protocol Buffers message specification uses the `repeated` keyword for declaring lists or arrays of messages within another message.</span></span> <span data-ttu-id="9e43e-106">La spécification de service gRPC utilise le `stream` mot clé pour déclarer une connexion persistante de longue durée.</span><span class="sxs-lookup"><span data-stu-id="9e43e-106">The gRPC service specification uses the `stream` keyword to declare a long-running persistent connection.</span></span> <span data-ttu-id="9e43e-107">Au-dessus de cette connexion, plusieurs messages sont envoyés et peuvent être traités individuellement.</span><span class="sxs-lookup"><span data-stu-id="9e43e-107">Over that connection, multiple messages are sent, and can be processed, individually.</span></span>

<span data-ttu-id="9e43e-108">Vous pouvez également `stream` utiliser la fonctionnalité pour des données temporelles de longue durée telles que des notifications ou des messages journalaux.</span><span class="sxs-lookup"><span data-stu-id="9e43e-108">You can also use the `stream` feature for long-running temporal data such as notifications or log messages.</span></span> <span data-ttu-id="9e43e-109">Mais ce chapitre examinera son utilisation pour le retour d’un ensemble de données unique.</span><span class="sxs-lookup"><span data-stu-id="9e43e-109">But this chapter will consider its use for returning a single dataset.</span></span>

<span data-ttu-id="9e43e-110">Ce que vous devez utiliser dépend de facteurs tels que :</span><span class="sxs-lookup"><span data-stu-id="9e43e-110">Which you should use depends on factors such as:</span></span>

- <span data-ttu-id="9e43e-111">La taille globale de l’ensemble de données.</span><span class="sxs-lookup"><span data-stu-id="9e43e-111">The overall size of the dataset.</span></span>
- <span data-ttu-id="9e43e-112">Le temps qu’il a fallu pour créer le jeu de données à l’extrémité du client ou du serveur.</span><span class="sxs-lookup"><span data-stu-id="9e43e-112">The time it took to create the dataset at either the client or server end.</span></span>
- <span data-ttu-id="9e43e-113">Si le consommateur de l’ensemble de données peut commencer à agir sur elle dès que le premier élément est disponible, ou a besoin de l’ensemble de données complet pour faire quelque chose d’utile.</span><span class="sxs-lookup"><span data-stu-id="9e43e-113">Whether the consumer of the dataset can start acting on it as soon as the first item is available, or needs the complete dataset to do anything useful.</span></span>

## <a name="when-to-use-repeated-fields"></a><span data-ttu-id="9e43e-114">Quand utiliser `repeated` les champs</span><span class="sxs-lookup"><span data-stu-id="9e43e-114">When to use `repeated` fields</span></span>

<span data-ttu-id="9e43e-115">Pour tout jeu de données qui est limité dans la taille et qui peut être généré dans son `repeated` intégralité dans un court laps de temps- disons, moins d’une seconde, vous devriez utiliser un champ dans un message Protobuf régulier.</span><span class="sxs-lookup"><span data-stu-id="9e43e-115">For any dataset that's constrained in size and that can be generated in its entirety in a short time—say, under one second—you should use a `repeated` field in a regular Protobuf message.</span></span> <span data-ttu-id="9e43e-116">Par exemple, dans un système de commerce électronique, construire une liste d’éléments dans une commande est probablement rapide et la liste ne sera pas très grande.</span><span class="sxs-lookup"><span data-stu-id="9e43e-116">For example, in an e-commerce system, to build a list of items within an order is probably quick and the list won't be very large.</span></span> <span data-ttu-id="9e43e-117">Le retour d’un seul message avec `repeated` un `stream` champ est un ordre de grandeur plus rapide que l’utilisation et engage moins de frais généraux réseau.</span><span class="sxs-lookup"><span data-stu-id="9e43e-117">Returning a single message with a `repeated` field is an order of magnitude faster than using `stream` and incurs less network overhead.</span></span>

<span data-ttu-id="9e43e-118">Si le client a besoin de toutes les données avant de commencer à les `repeated` traiter et que le jeu de données est assez petit pour être construit en mémoire, alors envisagez d’utiliser un champ.</span><span class="sxs-lookup"><span data-stu-id="9e43e-118">If the client needs all the data before starting to process it and the dataset is small enough to construct in memory, then consider using a `repeated` field.</span></span> <span data-ttu-id="9e43e-119">Considérez-le même si la création de l’ensemble de données dans la mémoire sur le serveur est plus lente.</span><span class="sxs-lookup"><span data-stu-id="9e43e-119">Consider it even if the creation of the dataset in memory on the server is slower.</span></span>

## <a name="when-to-use-stream-methods"></a><span data-ttu-id="9e43e-120">Quand utiliser `stream` des méthodes</span><span class="sxs-lookup"><span data-stu-id="9e43e-120">When to use `stream` methods</span></span>

<span data-ttu-id="9e43e-121">Lorsque les objets de message dans vos jeux de données sont potentiellement très volumineux, il est préférable pour vous de les transférer en utilisant des demandes ou des réponses en streaming.</span><span class="sxs-lookup"><span data-stu-id="9e43e-121">When the message objects in your datasets are potentially very large, it's best for you transfer them by using streaming requests or responses.</span></span> <span data-ttu-id="9e43e-122">Il est plus efficace de construire un grand objet dans la mémoire, l’écrire au réseau, puis libérer les ressources.</span><span class="sxs-lookup"><span data-stu-id="9e43e-122">It's more efficient to construct a large object in memory, write it to the network, and then free up the resources.</span></span> <span data-ttu-id="9e43e-123">Cette approche améliorera l’évolutivité de votre service.</span><span class="sxs-lookup"><span data-stu-id="9e43e-123">This approach will improve the scalability of your service.</span></span>

<span data-ttu-id="9e43e-124">De même, vous devez envoyer des jeux de données de taille sans contrainte sur les flux pour éviter de manquer de mémoire tout en les construisant.</span><span class="sxs-lookup"><span data-stu-id="9e43e-124">Similarly, you should send datasets of unconstrained size over streams to avoid running out of memory while constructing them.</span></span>

<span data-ttu-id="9e43e-125">Pour les ensembles de données où le consommateur peut traiter séparément chaque élément, vous devriez envisager d’utiliser un flux si cela signifie que les progrès peuvent être indiqués à l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9e43e-125">For datasets where the consumer can separately process each item, you should consider using a stream if it means that progress can be indicated to the user.</span></span> <span data-ttu-id="9e43e-126">L’utilisation d’un flux peut améliorer la réactivité d’une application, mais vous devez l’équilibrer par rapport aux performances globales de l’application.</span><span class="sxs-lookup"><span data-stu-id="9e43e-126">Using a stream can improve the responsiveness of an application, but you should balance it against the overall performance of the application.</span></span>

<span data-ttu-id="9e43e-127">Un autre scénario où les flux peuvent être utiles est l’endroit où un message est traité sur plusieurs services.</span><span class="sxs-lookup"><span data-stu-id="9e43e-127">Another scenario where streams can be useful is where a message is being processed across multiple services.</span></span> <span data-ttu-id="9e43e-128">Si chaque service d’une chaîne renvoie un flux, le service terminal (c’est-à-dire le dernier de la chaîne) peut commencer à retourner des messages.</span><span class="sxs-lookup"><span data-stu-id="9e43e-128">If each service in a chain returns a stream, then the terminal service (that is, the last one in the chain) can start returning messages.</span></span> <span data-ttu-id="9e43e-129">Ces messages peuvent être traités et transmis le long de la chaîne au demandeur d’origine.</span><span class="sxs-lookup"><span data-stu-id="9e43e-129">These messages can be processed and passed back along the chain to the original requestor.</span></span> <span data-ttu-id="9e43e-130">Le demandeur peut soit retourner un flux, soit agréger les résultats en un seul message de réponse.</span><span class="sxs-lookup"><span data-stu-id="9e43e-130">The requestor can either return a stream or aggregate the results into a single response message.</span></span> <span data-ttu-id="9e43e-131">Cette approche se prête bien à des modèles comme MapReduce.</span><span class="sxs-lookup"><span data-stu-id="9e43e-131">This approach lends itself well to patterns like MapReduce.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="9e43e-132">[Suivant précédent](migrate-duplex-services.md)
>[Next](client-libraries.md)</span><span class="sxs-lookup"><span data-stu-id="9e43e-132">[Previous](migrate-duplex-services.md)
[Next](client-libraries.md)</span></span>

---
title: Comment effectuer un cast en toute sécurité à l’aide de critères spéciaux et des opérateurs is et As
description: Découvrez les techniques relatives aux critères spéciaux pour caster de manière sécurisée des variables vers un autre type. Vous pouvez utiliser les critères spéciaux, ainsi que les opérateurs is et as pour convertir des types de manière sécurisée.
ms.date: 09/05/2018
helpviewer_keywords:
- cast operators [C#], as and is operators
- as operator [C#]
- is operator [C#]
ms.openlocfilehash: f10ce837057cc61b84130f237a13af708849dfc5
ms.sourcegitcommit: 7137e12f54c4e83a94ae43ec320f8cf59c1772ea
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/10/2020
ms.locfileid: "84662964"
---
# <a name="how-to-safely-cast-by-using-pattern-matching-and-the-is-and-as-operators"></a><span data-ttu-id="d9cc4-104">Comment effectuer un cast en toute sécurité à l’aide de critères spéciaux et des opérateurs is et As</span><span class="sxs-lookup"><span data-stu-id="d9cc4-104">How to safely cast by using pattern matching and the is and as operators</span></span>

<span data-ttu-id="d9cc4-105">Dans la mesure où les objets sont polymorphes, une variable d’un type de classe de base peut contenir un [type](../programming-guide/types/index.md) dérivé.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-105">Because objects are polymorphic, it's possible for a variable of a base class type to hold a derived [type](../programming-guide/types/index.md).</span></span> <span data-ttu-id="d9cc4-106">Pour accéder aux membres d’instance du type dérivé, il est nécessaire de réeffectuer un [cast](../programming-guide/types/casting-and-type-conversions.md) de la valeur vers le type dérivé.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-106">To access the derived type's instance members, it's necessary to [cast](../programming-guide/types/casting-and-type-conversions.md) the value back to the derived type.</span></span> <span data-ttu-id="d9cc4-107">Toutefois, un cast risque de lever <xref:System.InvalidCastException>.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-107">However, a cast creates the risk of throwing an <xref:System.InvalidCastException>.</span></span> <span data-ttu-id="d9cc4-108">C# fournit des instructions relatives aux [critères spéciaux](../pattern-matching.md), qui effectuent un cast de manière conditionnelle, uniquement en cas de réussite.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-108">C# provides [pattern matching](../pattern-matching.md) statements that perform a cast conditionally only when it will succeed.</span></span> <span data-ttu-id="d9cc4-109">C# fournit également les opérateurs [is](../language-reference/operators/type-testing-and-cast.md#is-operator) et [as](../language-reference/operators/type-testing-and-cast.md#as-operator) pour tester l’appartenance d’une valeur à un certain type.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-109">C# also provides the [is](../language-reference/operators/type-testing-and-cast.md#is-operator) and [as](../language-reference/operators/type-testing-and-cast.md#as-operator) operators to test if a value is of a certain type.</span></span>

<span data-ttu-id="d9cc4-110">L’exemple suivant montre comment utiliser l’instruction de critères spéciaux `is` :</span><span class="sxs-lookup"><span data-stu-id="d9cc4-110">The following example shows how to use the pattern matching `is` statement:</span></span>

:::code language="csharp" source="../../../samples/snippets/csharp/how-to/safelycast/patternmatching/Program.cs" id="PatternMatchingIs":::

<span data-ttu-id="d9cc4-111">L’exemple précédent illustre quelques fonctionnalités de la syntaxe relative aux critères spéciaux.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-111">The preceding sample demonstrates a few features of pattern matching syntax.</span></span> <span data-ttu-id="d9cc4-112">L' `if (a is Mammal m)` instruction associe le test à une assignation d’initialisation.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-112">The `if (a is Mammal m)` statement combines the test with an initialization assignment.</span></span> <span data-ttu-id="d9cc4-113">L’assignation n’a lieu qu’en cas de réussite du test.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-113">The assignment occurs only when the test succeeds.</span></span> <span data-ttu-id="d9cc4-114">La variable `m` se trouve uniquement dans l’étendue de l’instruction `if` incorporée, à laquelle elle a été assignée.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-114">The variable `m` is only in scope in the embedded `if` statement where it has been assigned.</span></span> <span data-ttu-id="d9cc4-115">Vous ne pouvez pas accéder à `m` plus tard dans la même méthode.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-115">You cannot access `m` later in the same method.</span></span> <span data-ttu-id="d9cc4-116">L’exemple précédent montre également comment utiliser l' [ `as` opérateur](../language-reference/operators/type-testing-and-cast.md#as-operator) pour convertir un objet en un type spécifié.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-116">The preceding example also shows how to use the [`as` operator](../language-reference/operators/type-testing-and-cast.md#as-operator) to convert an object to a specified type.</span></span>

<span data-ttu-id="d9cc4-117">Vous pouvez également utiliser la même syntaxe pour le test si un [type valeur Nullable](../language-reference/builtin-types/nullable-value-types.md) a une valeur, comme illustré dans l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="d9cc4-117">You can also use the same syntax for testing if a [nullable value type](../language-reference/builtin-types/nullable-value-types.md) has a value, as shown in the following example:</span></span>

:::code language="csharp" source="../../../samples/snippets/csharp/how-to/safelycast/nullablepatternmatching/Program.cs" id="PatternMatchingNullable":::

<span data-ttu-id="d9cc4-118">L’exemple précédent illustre d’autres fonctionnalités relatives aux critères spéciaux pour les conversions.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-118">The preceding sample demonstrates other features of pattern matching to use with conversions.</span></span> <span data-ttu-id="d9cc4-119">Vous pouvez tester le modèle null d’une variable en vérifiant spécifiquement la valeur `null`.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-119">You can test a variable for the null pattern by checking specifically for the `null` value.</span></span> <span data-ttu-id="d9cc4-120">Quand la valeur runtime de la variable est `null`, une instruction `is` de vérification de type retourne toujours `false`.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-120">When the runtime value of the variable is `null`, an `is` statement checking for a type always returns `false`.</span></span> <span data-ttu-id="d9cc4-121">L’instruction `is` relative aux critères spéciaux n’autorise aucun type valeur Nullable, par exemple `int?` ou `Nullable<int>`. Toutefois, vous pouvez tester un autre type valeur.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-121">The pattern matching `is` statement doesn't allow a nullable value type, such as `int?` or `Nullable<int>`, but you can test for any other value type.</span></span> <span data-ttu-id="d9cc4-122">Les `is` modèles de l’exemple précédent ne sont pas limités aux types valeur Nullable.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-122">The `is` patterns from the preceding example are not limited to the nullable value types.</span></span> <span data-ttu-id="d9cc4-123">Vous pouvez également utiliser ces modèles pour tester si une variable d’un type référence a une valeur ou s’il s’agit de `null` .</span><span class="sxs-lookup"><span data-stu-id="d9cc4-123">You can also use those patterns to test if a variable of a reference type has a value or it's `null`.</span></span>

<span data-ttu-id="d9cc4-124">L’exemple précédent montre également comment utiliser le modèle de type dans une `switch` instruction où la variable peut être l’un des nombreux types différents.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-124">The preceding sample also shows how you use the type pattern in a `switch` statement where the variable may be one of many different types.</span></span>

<span data-ttu-id="d9cc4-125">Si vous souhaitez tester si une variable est un type donné, mais ne pas l’assigner à une nouvelle variable, vous pouvez utiliser les `is` opérateurs et pour les types `as` référence et les types valeur Nullable.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-125">If you want to test if a variable is a given type, but not assign it to a new variable, you can use the `is` and `as` operators for reference types and nullable value types.</span></span> <span data-ttu-id="d9cc4-126">Le code suivant montre comment utiliser les instructions `is` et `as`, qui faisaient partie du langage C# avant l’introduction des critères spéciaux permettant de déterminer l’existence ou non d’un type donné pour une variable :</span><span class="sxs-lookup"><span data-stu-id="d9cc4-126">The following code shows how to use the `is` and `as` statements that were part of the C# language before pattern matching was introduced to test if a variable is of a given type:</span></span>

:::code language="csharp" source="../../../samples/snippets/csharp/how-to/safelycast/asandis/Program.cs" id="IsAndAs":::

<span data-ttu-id="d9cc4-127">Comme vous pouvez le constater en comparant ce code avec le code utilisant les critères spéciaux, la syntaxe des critères spéciaux fournit des fonctionnalités plus robustes, car elle combine le test et l’assignation dans une seule instruction.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-127">As you can see by comparing this code with the pattern matching code, the pattern matching syntax provides more robust features by combining the test and the assignment in a single statement.</span></span> <span data-ttu-id="d9cc4-128">Utilisez la syntaxe des critères spéciaux autant que possible.</span><span class="sxs-lookup"><span data-stu-id="d9cc4-128">Use the pattern matching syntax whenever possible.</span></span>

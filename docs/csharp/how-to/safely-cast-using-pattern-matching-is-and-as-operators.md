---
title: Comment lancer en toute sécurité en utilisant l’appariement des motifs et l’est et en tant qu’opérateurs
description: Découvrez les techniques relatives aux critères spéciaux pour caster de manière sécurisée des variables vers un autre type. Vous pouvez utiliser les critères spéciaux, ainsi que les opérateurs is et as pour convertir des types de manière sécurisée.
ms.date: 09/05/2018
helpviewer_keywords:
- cast operators [C#], as and is operators
- as operator [C#]
- is operator [C#]
ms.openlocfilehash: 34c34865a2feece5fe037daeb035292aafd015b9
ms.sourcegitcommit: 99b153b93bf94d0fecf7c7bcecb58ac424dfa47c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/25/2020
ms.locfileid: "80249355"
---
# <a name="how-to-safely-cast-by-using-pattern-matching-and-the-is-and-as-operators"></a><span data-ttu-id="da5ae-104">Comment lancer en toute sécurité en utilisant l’appariement des motifs et l’est et en tant qu’opérateurs</span><span class="sxs-lookup"><span data-stu-id="da5ae-104">How to safely cast by using pattern matching and the is and as operators</span></span>

<span data-ttu-id="da5ae-105">Dans la mesure où les objets sont polymorphes, une variable d’un type de classe de base peut contenir un [type](../programming-guide/types/index.md) dérivé.</span><span class="sxs-lookup"><span data-stu-id="da5ae-105">Because objects are polymorphic, it's possible for a variable of a base class type to hold a derived [type](../programming-guide/types/index.md).</span></span> <span data-ttu-id="da5ae-106">Pour accéder aux membres d’instance du type dérivé, il est nécessaire de réeffectuer un [cast](../programming-guide/types/casting-and-type-conversions.md) de la valeur vers le type dérivé.</span><span class="sxs-lookup"><span data-stu-id="da5ae-106">To access the derived type's instance members, it's necessary to [cast](../programming-guide/types/casting-and-type-conversions.md) the value back to the derived type.</span></span> <span data-ttu-id="da5ae-107">Toutefois, un cast risque de lever <xref:System.InvalidCastException>.</span><span class="sxs-lookup"><span data-stu-id="da5ae-107">However, a cast creates the risk of throwing an <xref:System.InvalidCastException>.</span></span> <span data-ttu-id="da5ae-108">C# fournit des instructions relatives aux [critères spéciaux](../pattern-matching.md), qui effectuent un cast de manière conditionnelle, uniquement en cas de réussite.</span><span class="sxs-lookup"><span data-stu-id="da5ae-108">C# provides [pattern matching](../pattern-matching.md) statements that perform a cast conditionally only when it will succeed.</span></span> <span data-ttu-id="da5ae-109">C# fournit également les opérateurs [is](../language-reference/operators/type-testing-and-cast.md#is-operator) et [as](../language-reference/operators/type-testing-and-cast.md#as-operator) pour tester l’appartenance d’une valeur à un certain type.</span><span class="sxs-lookup"><span data-stu-id="da5ae-109">C# also provides the [is](../language-reference/operators/type-testing-and-cast.md#is-operator) and [as](../language-reference/operators/type-testing-and-cast.md#as-operator) operators to test if a value is of a certain type.</span></span>

<span data-ttu-id="da5ae-110">L’exemple suivant montre comment `is` utiliser l’instruction de correspondance des modèles :</span><span class="sxs-lookup"><span data-stu-id="da5ae-110">The following example shows how to use the pattern matching `is` statement:</span></span>

[!code-csharp[Pattern matching is statement](../../../samples/snippets/csharp/how-to/safelycast/patternmatching/Program.cs#PatternMatchingIs)]

<span data-ttu-id="da5ae-111">L’exemple précédent illustre quelques fonctionnalités de la syntaxe relative aux critères spéciaux.</span><span class="sxs-lookup"><span data-stu-id="da5ae-111">The preceding sample demonstrates a few features of pattern matching syntax.</span></span> <span data-ttu-id="da5ae-112">L’instruction `if (a is Mammal m)` combine le test avec une affectation d’initialisation.</span><span class="sxs-lookup"><span data-stu-id="da5ae-112">The `if (a is Mammal m)` statement combines the test with an initialization assignment.</span></span> <span data-ttu-id="da5ae-113">L’assignation n’a lieu qu’en cas de réussite du test.</span><span class="sxs-lookup"><span data-stu-id="da5ae-113">The assignment occurs only when the test succeeds.</span></span> <span data-ttu-id="da5ae-114">La variable `m` se trouve uniquement dans l’étendue de l’instruction `if` incorporée, à laquelle elle a été assignée.</span><span class="sxs-lookup"><span data-stu-id="da5ae-114">The variable `m` is only in scope in the embedded `if` statement where it has been assigned.</span></span> <span data-ttu-id="da5ae-115">Vous ne pouvez pas accéder à `m` plus tard dans la même méthode.</span><span class="sxs-lookup"><span data-stu-id="da5ae-115">You cannot access `m` later in the same method.</span></span> <span data-ttu-id="da5ae-116">L’exemple précédent montre également comment utiliser [ `as` l’opérateur](../language-reference/operators/type-testing-and-cast.md#as-operator) pour convertir un objet en un type spécifié.</span><span class="sxs-lookup"><span data-stu-id="da5ae-116">The preceding example also shows how to use the [`as` operator](../language-reference/operators/type-testing-and-cast.md#as-operator) to convert an object to a specified type.</span></span>

<span data-ttu-id="da5ae-117">Vous pouvez également utiliser la même syntaxe pour tester si un [type de valeur nul a](../language-reference/builtin-types/nullable-value-types.md) une valeur, comme le montre l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="da5ae-117">You can also use the same syntax for testing if a [nullable value type](../language-reference/builtin-types/nullable-value-types.md) has a value, as shown in the following example:</span></span>

[!code-csharp[Pattern matching with nullable types](../../../samples/snippets/csharp/how-to/safelycast/nullablepatternmatching/Program.cs#PatternMatchingNullable)]

<span data-ttu-id="da5ae-118">L’exemple précédent illustre d’autres fonctionnalités relatives aux critères spéciaux pour les conversions.</span><span class="sxs-lookup"><span data-stu-id="da5ae-118">The preceding sample demonstrates other features of pattern matching to use with conversions.</span></span> <span data-ttu-id="da5ae-119">Vous pouvez tester le modèle null d’une variable en vérifiant spécifiquement la valeur `null`.</span><span class="sxs-lookup"><span data-stu-id="da5ae-119">You can test a variable for the null pattern by checking specifically for the `null` value.</span></span> <span data-ttu-id="da5ae-120">Quand la valeur runtime de la variable est `null`, une instruction `is` de vérification de type retourne toujours `false`.</span><span class="sxs-lookup"><span data-stu-id="da5ae-120">When the runtime value of the variable is `null`, an `is` statement checking for a type always returns `false`.</span></span> <span data-ttu-id="da5ae-121">L’instruction `is` relative aux critères spéciaux n’autorise aucun type valeur Nullable, par exemple `int?` ou `Nullable<int>`. Toutefois, vous pouvez tester un autre type valeur.</span><span class="sxs-lookup"><span data-stu-id="da5ae-121">The pattern matching `is` statement doesn't allow a nullable value type, such as `int?` or `Nullable<int>`, but you can test for any other value type.</span></span> <span data-ttu-id="da5ae-122">Les `is` modèles de l’exemple précédent ne se limitent pas aux types de valeur nuls.</span><span class="sxs-lookup"><span data-stu-id="da5ae-122">The `is` patterns from the preceding example are not limited to the nullable value types.</span></span> <span data-ttu-id="da5ae-123">Vous pouvez également utiliser ces modèles pour tester si une variable `null`d’un type de référence a une valeur ou c’est .</span><span class="sxs-lookup"><span data-stu-id="da5ae-123">You also can use those patterns to test if a variable of a reference type has a value or it's `null`.</span></span>

<span data-ttu-id="da5ae-124">L’échantillon précédent montre également comment vous `switch` utilisez le modèle de type dans une déclaration où la variable peut être l’un des nombreux types différents.</span><span class="sxs-lookup"><span data-stu-id="da5ae-124">The preceding sample also shows how you use the type pattern in a `switch` statement where the variable may be one of many different types.</span></span>

<span data-ttu-id="da5ae-125">Si vous souhaitez tester si une variable est un type donné, mais ne `is` `as` pas l’attribuer à une nouvelle variable, vous pouvez utiliser les et les opérateurs pour les types de référence et les types de valeur nuls.</span><span class="sxs-lookup"><span data-stu-id="da5ae-125">If you want to test if a variable is a given type, but not assign it to a new variable, you can use the `is` and `as` operators for reference types and nullable value types.</span></span> <span data-ttu-id="da5ae-126">Le code suivant montre comment utiliser les instructions `is` et `as`, qui faisaient partie du langage C# avant l’introduction des critères spéciaux permettant de déterminer l’existence ou non d’un type donné pour une variable :</span><span class="sxs-lookup"><span data-stu-id="da5ae-126">The following code shows how to use the `is` and `as` statements that were part of the C# language before pattern matching was introduced to test if a variable is of a given type:</span></span>

[!code-csharp[testing variable types with the is and as statements](../../../samples/snippets/csharp/how-to/safelycast/asandis/Program.cs#IsAndAs)]

<span data-ttu-id="da5ae-127">Comme vous pouvez le constater en comparant ce code avec le code utilisant les critères spéciaux, la syntaxe des critères spéciaux fournit des fonctionnalités plus robustes, car elle combine le test et l’assignation dans une seule instruction.</span><span class="sxs-lookup"><span data-stu-id="da5ae-127">As you can see by comparing this code with the pattern matching code, the pattern matching syntax provides more robust features by combining the test and the assignment in a single statement.</span></span> <span data-ttu-id="da5ae-128">Utilisez la syntaxe des critères spéciaux autant que possible.</span><span class="sxs-lookup"><span data-stu-id="da5ae-128">Use the pattern matching syntax whenever possible.</span></span>

<span data-ttu-id="da5ae-129">Vous pouvez essayer ces échantillons en regardant le code dans notre [référentiel GitHub](https://github.com/dotnet/samples/tree/master/snippets/csharp/how-to/safelycast).</span><span class="sxs-lookup"><span data-stu-id="da5ae-129">You can try these samples by looking at the code in our [GitHub repository](https://github.com/dotnet/samples/tree/master/snippets/csharp/how-to/safelycast).</span></span> <span data-ttu-id="da5ae-130">Vous pouvez aussi télécharger les exemples [sous forme de fichier zip](https://github.com/dotnet/samples/raw/master/snippets/csharp/how-to/safelycast.zip).</span><span class="sxs-lookup"><span data-stu-id="da5ae-130">Or you can download the samples [as a zip file](https://github.com/dotnet/samples/raw/master/snippets/csharp/how-to/safelycast.zip).</span></span>

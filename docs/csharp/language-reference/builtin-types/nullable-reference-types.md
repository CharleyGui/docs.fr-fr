---
title: Types de référence nuls - Référence C
description: Renseignez-vous sur les types de référence nuls et sur la façon de les utiliser
ms.date: 04/06/2020
ms.openlocfilehash: cbc7397ac76b43b79a4168f4c61fe2c631b4a46b
ms.sourcegitcommit: 2b3b2d684259463ddfc76ad680e5e09fdc1984d2
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/08/2020
ms.locfileid: "80888315"
---
# <a name="nullable-reference-types-c-reference"></a><span data-ttu-id="0dc95-103">Types de référence nuls (référence C)</span><span class="sxs-lookup"><span data-stu-id="0dc95-103">Nullable reference types (C# reference)</span></span>

> [!NOTE]
> <span data-ttu-id="0dc95-104">Cet article couvre les types de référence in annulables.</span><span class="sxs-lookup"><span data-stu-id="0dc95-104">This article covers nullable reference types.</span></span> <span data-ttu-id="0dc95-105">Vous pouvez également déclarer [les types de valeur nuls](nullable-value-types.md).</span><span class="sxs-lookup"><span data-stu-id="0dc95-105">You can also declare [nullable value types](nullable-value-types.md).</span></span>

<span data-ttu-id="0dc95-106">Les types de référence nuls sont disponibles à partir de C 8.0, dans le code qui a opté dans un *contexte de conscience nulle*.</span><span class="sxs-lookup"><span data-stu-id="0dc95-106">Nullable reference types are available beginning with C# 8.0, in code that has opted in to a *nullable aware context*.</span></span> <span data-ttu-id="0dc95-107">Les types de référence nuls, les avertissements d’analyse statique nul et [l’opérateur null-indulgent](../operators/null-forgiving.md) sont des caractéristiques linguistiques facultatives.</span><span class="sxs-lookup"><span data-stu-id="0dc95-107">Nullable reference types, the null static analysis warnings, and the [null-forgiving operator](../operators/null-forgiving.md) are optional language features.</span></span> <span data-ttu-id="0dc95-108">Tous sont désactivés par défaut.</span><span class="sxs-lookup"><span data-stu-id="0dc95-108">All are turned off by default.</span></span> <span data-ttu-id="0dc95-109">Un *contexte inquérable* est contrôlé au niveau du projet à l’aide de paramètres de construction ou de code à l’aide de pragmas.</span><span class="sxs-lookup"><span data-stu-id="0dc95-109">A *nullable context* is controlled at the project level using build settings, or in code using pragmas.</span></span>

 <span data-ttu-id="0dc95-110">Dans un contexte de connaissance nulle :</span><span class="sxs-lookup"><span data-stu-id="0dc95-110">In a nullable aware context:</span></span>

- <span data-ttu-id="0dc95-111">Une variable d’un type `T` de référence doit être parasitée avec `null`non-null, et ne peut jamais être attribué une valeur qui peut être .</span><span class="sxs-lookup"><span data-stu-id="0dc95-111">A variable of a reference type `T` must be initialized with non-null, and may never be assigned a value that may be `null`.</span></span>
- <span data-ttu-id="0dc95-112">Une variable d’un `T?` type de `null` référence `null`peut être parasiffée ou assignée, mais doit être vérifiée `null` avant de procéder au démosation.</span><span class="sxs-lookup"><span data-stu-id="0dc95-112">A variable of a reference type `T?` may be initialized with `null` or assigned `null`, but is required to be checked against `null` before de-referencing.</span></span>
- <span data-ttu-id="0dc95-113">Une `m` variable `T?` de type est considérée comme non nulle lorsque vous appliquez `m!`l’opérateur null-indulgent, comme dans .</span><span class="sxs-lookup"><span data-stu-id="0dc95-113">A variable `m` of type `T?` is considered to be non-null when you apply the null-forgiving operator, as in `m!`.</span></span>

<span data-ttu-id="0dc95-114">Les distinctions entre un type `T` de référence non `T?` annulable et un type de référence nul sont appliquées par l’interprétation par le compilateur des règles précédentes.</span><span class="sxs-lookup"><span data-stu-id="0dc95-114">The distinctions between a non-nullable reference type `T` and a nullable reference type `T?` are enforced by the compiler's interpretation of the preceding rules.</span></span> <span data-ttu-id="0dc95-115">Une variable `T` de type et `T?` une variable de type sont représentées par le même type .NET.</span><span class="sxs-lookup"><span data-stu-id="0dc95-115">A variable of type `T` and a variable of type `T?` are represented by the same .NET type.</span></span> <span data-ttu-id="0dc95-116">L’exemple suivant déclare une corde non annulable et une clause annulable, puis utilise l’opérateur qui pardonne l’annulation pour attribuer une valeur à une chaîne non annulable :</span><span class="sxs-lookup"><span data-stu-id="0dc95-116">The following example declares a non-nullable string and a nullable string, and then uses the null-forgiving operator to assign a value to a non-nullable string:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetCoreSyntax":::

<span data-ttu-id="0dc95-117">Les `notNull` variables `nullable` et sont toutes <xref:System.String> deux représentées par le type.</span><span class="sxs-lookup"><span data-stu-id="0dc95-117">The variables `notNull` and `nullable` are both represented by the <xref:System.String> type.</span></span> <span data-ttu-id="0dc95-118">Étant donné que les types non annulables et in nullables sont tous deux stockés comme le même type, il y a plusieurs endroits où l’utilisation d’un type de référence nul n’est pas autorisée.</span><span class="sxs-lookup"><span data-stu-id="0dc95-118">Because the non-nullable and nullable types are both stored as the same type, there are several locations where using a nullable reference type isn't allowed.</span></span> <span data-ttu-id="0dc95-119">En général, un type de référence nul ne peut pas être utilisé comme classe de base ou interface implémentée.</span><span class="sxs-lookup"><span data-stu-id="0dc95-119">In general, a nullable reference type can't be used as a base class or implemented interface.</span></span> <span data-ttu-id="0dc95-120">Un type de référence in nullable ne peut pas être utilisé dans une création d’objet ou une expression de test de type.</span><span class="sxs-lookup"><span data-stu-id="0dc95-120">A nullable reference type can't be used in any object creation or type testing expression.</span></span> <span data-ttu-id="0dc95-121">Un type de référence in nullable ne peut pas être le type d’expression d’accès d’un membre.</span><span class="sxs-lookup"><span data-stu-id="0dc95-121">A nullable reference type can't be the type of a member access expression.</span></span> <span data-ttu-id="0dc95-122">Les exemples suivants montrent ces constructions :</span><span class="sxs-lookup"><span data-stu-id="0dc95-122">The following examples show these constructs:</span></span>

```csharp
public MyClass : System.Object? // not allowed
{
}

var nullEmpty = System.String?.Empty; // Not allowed
var maybeObject = new object?(); // Not allowed
try
{
    if (thing is string? nullableString) // not allowed
        Console.WriteLine(nullableString);
} catch (Exception? e) // Not Allowed
{
    Console.WriteLine("error");
}
```

## <a name="nullable-references-and-static-analysis"></a><span data-ttu-id="0dc95-123">Références et analyses statiques insédables</span><span class="sxs-lookup"><span data-stu-id="0dc95-123">Nullable references and static analysis</span></span>

<span data-ttu-id="0dc95-124">Les exemples de la section précédente illustrent la nature des types de références nuls.</span><span class="sxs-lookup"><span data-stu-id="0dc95-124">The examples in the previous section illustrate the nature of nullable reference types.</span></span> <span data-ttu-id="0dc95-125">Les types de référence nuls ne sont pas de nouveaux types de classe, mais plutôt des annotations sur les types de référence existants.</span><span class="sxs-lookup"><span data-stu-id="0dc95-125">Nullable reference types aren't new class types, but rather annotations on existing reference types.</span></span> <span data-ttu-id="0dc95-126">Le compilateur utilise ces annotations pour vous aider à trouver des erreurs de référence nulles potentielles dans votre code.</span><span class="sxs-lookup"><span data-stu-id="0dc95-126">The compiler uses those annotations to help you find potential null reference errors in your code.</span></span> <span data-ttu-id="0dc95-127">Il n’y a pas de différence de temps d’exécution entre un type de référence non annulable et un type de référence nul.</span><span class="sxs-lookup"><span data-stu-id="0dc95-127">There's no runtime difference between a non-nullable reference type and a nullable reference type.</span></span> <span data-ttu-id="0dc95-128">Le compilateur n’ajoute aucune vérification du temps d’exécution pour les types de référence non annulables.</span><span class="sxs-lookup"><span data-stu-id="0dc95-128">The compiler doesn't add any runtime checking for non-nullable reference types.</span></span> <span data-ttu-id="0dc95-129">Les avantages sont dans l’analyse de temps de compilation.</span><span class="sxs-lookup"><span data-stu-id="0dc95-129">The benefits are in the compile-time analysis.</span></span> <span data-ttu-id="0dc95-130">Le compilateur génère des avertissements qui vous aident à trouver et à corriger les erreurs nulles potentielles dans votre code.</span><span class="sxs-lookup"><span data-stu-id="0dc95-130">The compiler generates warnings that help you find and fix potential null errors in your code.</span></span> <span data-ttu-id="0dc95-131">Vous déclarez votre intention, et le compilateur vous avertit lorsque votre code viole cette intention.</span><span class="sxs-lookup"><span data-stu-id="0dc95-131">You declare your intent, and the compiler warns you when your code violates that intent.</span></span>

<span data-ttu-id="0dc95-132">Dans un contexte in annulable, le compilateur effectue une analyse statique sur des variables de tout type de référence, à la fois in nullables et non annulables.</span><span class="sxs-lookup"><span data-stu-id="0dc95-132">In a nullable enabled context, the compiler performs static analysis on variables of any reference type, both nullable and non-nullable.</span></span> <span data-ttu-id="0dc95-133">Le compilateur suit l’état nul de chaque variable de référence comme *non nul* ou *peut-être nul*.</span><span class="sxs-lookup"><span data-stu-id="0dc95-133">The compiler tracks the null state of each reference variable as either *not null* or *maybe null*.</span></span> <span data-ttu-id="0dc95-134">L’état par défaut d’une référence non annulable *n’est pas nul*.</span><span class="sxs-lookup"><span data-stu-id="0dc95-134">The default state of a non-nullable reference is *not null*.</span></span> <span data-ttu-id="0dc95-135">L’état par défaut d’une référence annulée est *peut-être nul*.</span><span class="sxs-lookup"><span data-stu-id="0dc95-135">The default state of a nullable reference is *maybe null*.</span></span>

<span data-ttu-id="0dc95-136">Les types de référence non annulables devraient toujours être sûrs de la déreférence parce que leur état nul *n’est pas nul*.</span><span class="sxs-lookup"><span data-stu-id="0dc95-136">Non-nullable reference types should always be safe to dereference because their null state is *not null*.</span></span> <span data-ttu-id="0dc95-137">Pour faire respecter cette règle, le compilateur émet des avertissements si un type de référence non annulable n’est pas paradé à une valeur non nulle.</span><span class="sxs-lookup"><span data-stu-id="0dc95-137">To enforce that rule, the compiler issues warnings if a non-nullable reference type isn't initialized to a non-null value.</span></span> <span data-ttu-id="0dc95-138">Les variables locales doivent être assignées là où elles sont déclarées.</span><span class="sxs-lookup"><span data-stu-id="0dc95-138">Local variables must be assigned where they're declared.</span></span> <span data-ttu-id="0dc95-139">Chaque constructeur doit attribuer chaque champ, soit dans son corps, un constructeur appelé, ou en utilisant un initialisateur de champ.</span><span class="sxs-lookup"><span data-stu-id="0dc95-139">Every constructor must assign every field, either in its body, a called constructor, or using a field initializer.</span></span> <span data-ttu-id="0dc95-140">Le compilateur émet des avertissements si une référence non annulable est attribuée à une référence dont l’état est *peut-être nul*.</span><span class="sxs-lookup"><span data-stu-id="0dc95-140">The compiler issues warnings if a non-nullable reference is assigned to a reference whose state is *maybe null*.</span></span> <span data-ttu-id="0dc95-141">Toutefois, comme une référence non annulable *n’est pas nulle,* aucun avertissement n’est émis lorsque ces variables sont dé-référencées.</span><span class="sxs-lookup"><span data-stu-id="0dc95-141">However, because a non-nullable reference is *not null*, no warnings are issued when those variables are de-referenced.</span></span>

<span data-ttu-id="0dc95-142">Les types de référence nuls `null`peuvent être parasités ou attribués à .</span><span class="sxs-lookup"><span data-stu-id="0dc95-142">Nullable reference types may be initialized or assigned to `null`.</span></span> <span data-ttu-id="0dc95-143">Par conséquent, l’analyse statique doit déterminer qu’une variable *n’est pas nulle* avant qu’elle ne soit déreférée.</span><span class="sxs-lookup"><span data-stu-id="0dc95-143">Therefore, static analysis must determine that a variable is *not null* before it's dereferenced.</span></span> <span data-ttu-id="0dc95-144">Si une référence annulée est déterminée à *être peut-être nulle,* elle ne peut pas être attribuée à une variable de référence non-nullable.</span><span class="sxs-lookup"><span data-stu-id="0dc95-144">If a nullable reference is determined to be *maybe null*, it can't be assigned to a non-nullable reference variable.</span></span> <span data-ttu-id="0dc95-145">La classe suivante montre des exemples de ces avertissements :</span><span class="sxs-lookup"><span data-stu-id="0dc95-145">The following class shows examples of these warnings:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetClassWithNullable":::

<span data-ttu-id="0dc95-146">L’extrait suivant montre où le compilateur émet des avertissements lors de l’utilisation de cette classe:</span><span class="sxs-lookup"><span data-stu-id="0dc95-146">The following snippet shows where the compiler emits warnings when using this class:</span></span>

:::code language="csharp" source="snippets/NullableReferenceTypes.cs" id="SnippetLocalWarnings":::

<span data-ttu-id="0dc95-147">Les exemples précédents démontrent l’analyse statique du compilateur pour déterminer l’état nul des variables de référence.</span><span class="sxs-lookup"><span data-stu-id="0dc95-147">The preceding examples demonstrate the compiler's static analysis to determine the null state of reference variables.</span></span> <span data-ttu-id="0dc95-148">Le compilateur applique des règles linguistiques pour les vérifications et les affectations nulles pour éclairer son analyse.</span><span class="sxs-lookup"><span data-stu-id="0dc95-148">The compiler applies language rules for null checks and assignments to inform its analysis.</span></span>  <span data-ttu-id="0dc95-149">Le compilateur ne peut pas faire d’hypothèses sur la sémantique des méthodes ou des propriétés.</span><span class="sxs-lookup"><span data-stu-id="0dc95-149">The compiler can't make assumptions about the semantics of methods or properties.</span></span> <span data-ttu-id="0dc95-150">Si vous appelez des méthodes qui effectuent des contrôles nuls, le compilateur ne peut pas savoir que ces méthodes affectent l’état nul d’une variable.</span><span class="sxs-lookup"><span data-stu-id="0dc95-150">If you call methods that perform null checks, the compiler can't know those methods affect a variable's null state.</span></span> <span data-ttu-id="0dc95-151">Il existe un certain nombre d’attributs que vous pouvez ajouter à vos API pour informer le compilateur sur la sémantique des arguments et des valeurs de retour.</span><span class="sxs-lookup"><span data-stu-id="0dc95-151">There are a number of attributes you can add to your APIs to inform the compiler about the semantics of arguments and return values.</span></span> <span data-ttu-id="0dc95-152">Ces attributs ont été appliqués à de nombreuses API communes dans les bibliothèques de base .NET.</span><span class="sxs-lookup"><span data-stu-id="0dc95-152">These attributes have been applied to many common APIs in the .NET Core libraries.</span></span> <span data-ttu-id="0dc95-153">Par exemple, <xref:System.String.IsNullOrEmpty%2A> a été mis à jour, et le compilateur interprète correctement cette méthode comme une vérification nulle.</span><span class="sxs-lookup"><span data-stu-id="0dc95-153">For example, <xref:System.String.IsNullOrEmpty%2A> has been updated, and the compiler correctly interprets that method as a null check.</span></span> <span data-ttu-id="0dc95-154">Pour plus d’informations sur les attributs qui s’appliquent à l’analyse statique de l’état nul, voir l’article sur [les attributs Nullable](../../nullable-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="0dc95-154">For more information about the attributes that apply to null state static analysis, see the article on [Nullable attributes](../../nullable-attributes.md).</span></span>

## <a name="setting-the-nullable-context"></a><span data-ttu-id="0dc95-155">Définir le contexte in nullable</span><span class="sxs-lookup"><span data-stu-id="0dc95-155">Setting the nullable context</span></span>

<span data-ttu-id="0dc95-156">Il y a deux façons de contrôler le contexte nul.</span><span class="sxs-lookup"><span data-stu-id="0dc95-156">There are two ways to control the nullable context.</span></span> <span data-ttu-id="0dc95-157">Au niveau du projet, `<Nullable>enable</Nullable>` vous pouvez ajouter le paramètre du projet.</span><span class="sxs-lookup"><span data-stu-id="0dc95-157">At the project level, you can add the `<Nullable>enable</Nullable>` project setting.</span></span> <span data-ttu-id="0dc95-158">Dans un seul fichier source C, `#nullable enable` vous pouvez ajouter le pragma pour activer le contexte nul.</span><span class="sxs-lookup"><span data-stu-id="0dc95-158">In a single C# source file, you can add the `#nullable enable` pragma to enable the nullable context.</span></span> <span data-ttu-id="0dc95-159">Voir l’article sur [la mise en place d’une stratégie annulée](../../nullable-attributes.md).</span><span class="sxs-lookup"><span data-stu-id="0dc95-159">See the article on [setting a nullable strategy](../../nullable-attributes.md).</span></span>

## <a name="c-language-specification"></a><span data-ttu-id="0dc95-160">spécification du langage C#</span><span class="sxs-lookup"><span data-stu-id="0dc95-160">C# language specification</span></span>

<span data-ttu-id="0dc95-161">Pour plus d’informations, voir les propositions suivantes pour la [spécification linguistique CMD](~/_csharplang/spec/introduction.md):</span><span class="sxs-lookup"><span data-stu-id="0dc95-161">For more information, see the following proposals for the [C# language specification](~/_csharplang/spec/introduction.md):</span></span>

- [<span data-ttu-id="0dc95-162">Types références Nullables</span><span class="sxs-lookup"><span data-stu-id="0dc95-162">Nullable reference types</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types.md)
- [<span data-ttu-id="0dc95-163">Spécifications de types de référence nuls</span><span class="sxs-lookup"><span data-stu-id="0dc95-163">Draft nullable reference types specification</span></span>](~/_csharplang/proposals/csharp-8.0/nullable-reference-types-specification.md)

## <a name="see-also"></a><span data-ttu-id="0dc95-164">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="0dc95-164">See also</span></span>

- [<span data-ttu-id="0dc95-165">Référence C#</span><span class="sxs-lookup"><span data-stu-id="0dc95-165">C# reference</span></span>](../index.md)
- [<span data-ttu-id="0dc95-166">Types valeur Nullable</span><span class="sxs-lookup"><span data-stu-id="0dc95-166">Nullable value types</span></span>](nullable-value-types.md)

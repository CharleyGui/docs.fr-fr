---
title: 'Attributs réservés C : Analyse statique nulle'
ms.date: 04/14/2020
description: Ces attributs sont interprétés par le compilateur pour fournir une meilleure analyse statique pour les types de référence nuls et non annulables.
ms.openlocfilehash: 0315d78db7517541efe578d8675c0f2fe45f5aea
ms.sourcegitcommit: c91110ef6ee3fedb591f3d628dc17739c4a7071e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/15/2020
ms.locfileid: "81389862"
---
# <a name="reserved-attributes-contribute-to-the-compilers-null-state-static-analysis"></a><span data-ttu-id="17dc5-103">Les attributs réservés contribuent à l’analyse statique de l’état nul du compilateur</span><span class="sxs-lookup"><span data-stu-id="17dc5-103">Reserved attributes contribute to the compiler's null state static analysis</span></span>

<span data-ttu-id="17dc5-104">Dans un contexte in annulable, le compilateur effectue une analyse statique du code pour déterminer l’état nul de toutes les variables de type de référence :</span><span class="sxs-lookup"><span data-stu-id="17dc5-104">In a nullable context, the compiler performs static analysis of code to determine the null state of all reference type variables:</span></span>

- <span data-ttu-id="17dc5-105">*non nulle*: Analyse statique a permis de déterminer que la variable est attribuée à une valeur non nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-105">*not null*: Static analysis determined that the variable is assigned to a non-null value.</span></span>
- <span data-ttu-id="17dc5-106">*peut-être nulle*: L’analyse statique ne peut pas déterminer qu’une variable se voit attribuer une valeur non nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-106">*maybe null*: Static analysis cannot determine that a variable is assigned a non-null value.</span></span>

<span data-ttu-id="17dc5-107">Vous pouvez appliquer un certain nombre d’attributs qui fournissent des informations au compilateur sur la sémantique de vos API.</span><span class="sxs-lookup"><span data-stu-id="17dc5-107">You can apply a number of attributes that provide information to the compiler about the semantics of your APIs.</span></span> <span data-ttu-id="17dc5-108">Cette information aide le compilateur à effectuer une analyse statique et à déterminer quand une variable n’est pas nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-108">That information helps the compiler perform static analysis and determine when a variable is not null.</span></span> <span data-ttu-id="17dc5-109">Cet article fournit une brève description de chacun de ces attributs et comment les utiliser.</span><span class="sxs-lookup"><span data-stu-id="17dc5-109">This article provides a brief description of each of those attributes and how to use them.</span></span> <span data-ttu-id="17dc5-110">Tous les exemples supposent C 8.0 ou plus récent, et le code est dans un contexte nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-110">All the examples assume C# 8.0 or newer, and the code is in a nullable context.</span></span>

<span data-ttu-id="17dc5-111">Commençons par un exemple familier.</span><span class="sxs-lookup"><span data-stu-id="17dc5-111">Let's start with a familiar example.</span></span> <span data-ttu-id="17dc5-112">Imaginez que votre bibliothèque dispose de l’API suivante pour récupérer une chaîne de ressources :</span><span class="sxs-lookup"><span data-stu-id="17dc5-112">Imagine your library has the following API to retrieve a resource string:</span></span>

```csharp
bool TryGetMessage(string key, out string message)
```

<span data-ttu-id="17dc5-113">L’exemple précédent `Try*` suit le modèle familier en .NET.</span><span class="sxs-lookup"><span data-stu-id="17dc5-113">The preceding example follows the familiar `Try*` pattern in .NET.</span></span> <span data-ttu-id="17dc5-114">Il existe deux arguments de référence `key` pour `message` cette API : le et le paramètre.</span><span class="sxs-lookup"><span data-stu-id="17dc5-114">There are two reference arguments for this API: the `key` and the `message` parameter.</span></span> <span data-ttu-id="17dc5-115">Cette API a les règles suivantes relatives à l’annulation de ces arguments :</span><span class="sxs-lookup"><span data-stu-id="17dc5-115">This API has the following rules relating to the nullness of these arguments:</span></span>

- <span data-ttu-id="17dc5-116">Les appelants `null` ne devraient pas `key`passer comme l’argument pour .</span><span class="sxs-lookup"><span data-stu-id="17dc5-116">Callers shouldn't pass `null` as the argument for `key`.</span></span>
- <span data-ttu-id="17dc5-117">Les appelants peuvent passer une `null` variable dont `message`la valeur est comme l’argument pour .</span><span class="sxs-lookup"><span data-stu-id="17dc5-117">Callers can pass a variable whose value is `null` as the argument for `message`.</span></span>
- <span data-ttu-id="17dc5-118">Si `TryGetMessage` la `true`méthode revient, la valeur de `message` n’est pas nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-118">If the `TryGetMessage` method returns `true`, the value of `message` isn't null.</span></span> <span data-ttu-id="17dc5-119">Si la valeur `false,` de `message` rendement est la valeur de (et son état nul) est nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-119">If the return value is `false,` the value of `message` (and its null state) is null.</span></span>

<span data-ttu-id="17dc5-120">La règle `key` pour peut être exprimée `key` par le type variable: devrait être un type de référence non-nullable.</span><span class="sxs-lookup"><span data-stu-id="17dc5-120">The rule for `key` can be expressed by the variable type: `key` should be a non-nullable reference type.</span></span> <span data-ttu-id="17dc5-121">Le `message` paramètre est plus complexe.</span><span class="sxs-lookup"><span data-stu-id="17dc5-121">The `message` parameter is more complex.</span></span> <span data-ttu-id="17dc5-122">Il `null` permet comme argument, mais garantit que, sur le succès, cet `out` argument n’est pas nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-122">It allows `null` as the argument, but guarantees that, on success, that `out` argument isn't null.</span></span> <span data-ttu-id="17dc5-123">Pour ces scénarios, vous avez besoin d’un vocabulaire plus riche pour décrire les attentes.</span><span class="sxs-lookup"><span data-stu-id="17dc5-123">For these scenarios, you need a richer vocabulary to describe the expectations.</span></span>

<span data-ttu-id="17dc5-124">Plusieurs attributs ont été ajoutés pour exprimer des informations supplémentaires sur l’état nul des variables.</span><span class="sxs-lookup"><span data-stu-id="17dc5-124">Several attributes have been added to express additional information about the null state of variables.</span></span> <span data-ttu-id="17dc5-125">Tout le code que vous avez écrit avant que le C 8 n’introduise des types de référence nuls *était nul inconscient.*</span><span class="sxs-lookup"><span data-stu-id="17dc5-125">All code you wrote before C# 8 introduced nullable reference types was *null oblivious*.</span></span> <span data-ttu-id="17dc5-126">Cela signifie que toute variable de type de référence peut être nulle, mais les contrôles nuls ne sont pas nécessaires.</span><span class="sxs-lookup"><span data-stu-id="17dc5-126">That means any reference type variable may be null, but null checks aren't required.</span></span> <span data-ttu-id="17dc5-127">Une fois que votre code est *infirampable au courant,* ces règles changent.</span><span class="sxs-lookup"><span data-stu-id="17dc5-127">Once your code is *nullable aware*, those rules change.</span></span> <span data-ttu-id="17dc5-128">Les types de `null` référence ne doivent jamais être la `null` valeur, et les types de référence nuls doivent être vérifiés avant d’être déreférés.</span><span class="sxs-lookup"><span data-stu-id="17dc5-128">Reference types should never be the `null` value, and nullable reference types must be checked against `null` before being dereferenced.</span></span>

<span data-ttu-id="17dc5-129">Les règles de vos API sont probablement plus `TryGetValue` compliquées, comme vous l’avez vu avec le scénario API.</span><span class="sxs-lookup"><span data-stu-id="17dc5-129">The rules for your APIs are likely more complicated, as you saw with the `TryGetValue` API scenario.</span></span> <span data-ttu-id="17dc5-130">Beaucoup de vos API ont des règles plus complexes pour quand les variables peuvent ou ne peuvent pas être `null`.</span><span class="sxs-lookup"><span data-stu-id="17dc5-130">Many of your APIs have more complex rules for when variables can or can't be `null`.</span></span> <span data-ttu-id="17dc5-131">Dans ces cas, vous utiliserez l’un des attributs suivants pour exprimer ces règles :</span><span class="sxs-lookup"><span data-stu-id="17dc5-131">In these cases, you'll use one of the following attributes to express those rules:</span></span>

- <span data-ttu-id="17dc5-132">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): Un argument d’entrée non annulable peut être nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-132">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="17dc5-133">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): Un argument d’entrée nul ne devrait jamais être nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-133">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>
- <span data-ttu-id="17dc5-134">[Peut-êtreNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): Une valeur de retour non annulable peut être nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-134">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="17dc5-135">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): Une valeur de retour annulée ne sera jamais nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-135">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>
- <span data-ttu-id="17dc5-136">[Peut-êtreNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): Un argument d’entrée non annulable `bool` peut être nul lorsque la méthode renvoie la valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-136">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="17dc5-137">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): Un argument d’entrée nul ne sera `bool` pas nul lorsque la méthode retourne la valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-137">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument will not be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="17dc5-138">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): Une valeur de retour n’est pas nulle si l’argument du paramètre spécifié n’est pas nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-138">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the argument for the specified parameter isn't null.</span></span>
- <span data-ttu-id="17dc5-139">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): Une méthode ne revient jamais.</span><span class="sxs-lookup"><span data-stu-id="17dc5-139">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): A method never returns.</span></span> <span data-ttu-id="17dc5-140">En d’autres termes, il jette toujours une exception.</span><span class="sxs-lookup"><span data-stu-id="17dc5-140">In other words, it always throws an exception.</span></span>
- <span data-ttu-id="17dc5-141">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): Cette méthode ne `bool` revient jamais si le paramètre associé a la valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-141">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): This method never returns if the associated `bool` parameter has the specified value.</span></span>

<span data-ttu-id="17dc5-142">Les descriptions précédentes sont une référence rapide à ce que chaque attribut fait.</span><span class="sxs-lookup"><span data-stu-id="17dc5-142">The preceding descriptions are a quick reference to what each attribute does.</span></span> <span data-ttu-id="17dc5-143">Chaque section suivante décrit le comportement et le sens plus en profondeur.</span><span class="sxs-lookup"><span data-stu-id="17dc5-143">Each following section describes the behavior and meaning more thoroughly.</span></span>

<span data-ttu-id="17dc5-144">L’ajout de ces attributs donne au compilateur plus d’informations sur les règles de votre API.</span><span class="sxs-lookup"><span data-stu-id="17dc5-144">Adding these attributes gives the compiler more information about the rules for your API.</span></span> <span data-ttu-id="17dc5-145">Lorsque le code d’appel est compilé dans un contexte activé nul, le compilateur avertit les appelants lorsqu’ils violent ces règles.</span><span class="sxs-lookup"><span data-stu-id="17dc5-145">When calling code is compiled in a nullable enabled context, the compiler will warn callers when they violate those rules.</span></span> <span data-ttu-id="17dc5-146">Ces attributs n’activent pas de contrôles supplémentaires sur votre implémentation.</span><span class="sxs-lookup"><span data-stu-id="17dc5-146">These attributes don't enable additional checks on your implementation.</span></span>

## <a name="specify-preconditions-allownull-and-disallownull"></a><span data-ttu-id="17dc5-147">Spécifier `AllowNull` les conditions préalables: et`DisallowNull`</span><span class="sxs-lookup"><span data-stu-id="17dc5-147">Specify preconditions: `AllowNull` and `DisallowNull`</span></span>

<span data-ttu-id="17dc5-148">Considérez une propriété de `null` lecture/écriture qui ne revient jamais parce qu’elle a une valeur raisonnable par défaut.</span><span class="sxs-lookup"><span data-stu-id="17dc5-148">Consider a read/write property that never returns `null` because it has a reasonable default value.</span></span> <span data-ttu-id="17dc5-149">Les appelants `null` passent à l’accesseur de configuration lors de la définition de cette valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="17dc5-149">Callers pass `null` to the set accessor when setting it to that default value.</span></span> <span data-ttu-id="17dc5-150">Par exemple, considérez un système de messagerie qui demande un nom d’écran dans une salle de chat.</span><span class="sxs-lookup"><span data-stu-id="17dc5-150">For example, consider a messaging system that asks for a screen name in a chat room.</span></span> <span data-ttu-id="17dc5-151">Si aucun n’est fourni, le système génère un nom aléatoire :</span><span class="sxs-lookup"><span data-stu-id="17dc5-151">If none is provided, the system generates a random name:</span></span>

```csharp
public string ScreenName
{
   get => screenName;
   set => screenName = value ?? GenerateRandomScreenName();
}
private string screenName;
```

<span data-ttu-id="17dc5-152">Lorsque vous compilez le code précédent dans un contexte oubliable, tout va bien.</span><span class="sxs-lookup"><span data-stu-id="17dc5-152">When you compile the preceding code in a nullable oblivious context, everything is fine.</span></span> <span data-ttu-id="17dc5-153">Une fois que vous activez les types de référence annulés, la `ScreenName` propriété devient une référence non annulable.</span><span class="sxs-lookup"><span data-stu-id="17dc5-153">Once you enable nullable reference types, the `ScreenName` property becomes a non-nullable reference.</span></span> <span data-ttu-id="17dc5-154">C’est correct `get` pour l’accesseur: il ne revient `null`jamais .</span><span class="sxs-lookup"><span data-stu-id="17dc5-154">That's correct for the `get` accessor: it never returns `null`.</span></span> <span data-ttu-id="17dc5-155">Les appelants n’ont pas besoin `null`de vérifier la propriété retournée pour .</span><span class="sxs-lookup"><span data-stu-id="17dc5-155">Callers don't need to check the returned property for `null`.</span></span> <span data-ttu-id="17dc5-156">Mais maintenant la `null` mise de la propriété pour génère un avertissement.</span><span class="sxs-lookup"><span data-stu-id="17dc5-156">But now setting the property to `null` generates a warning.</span></span> <span data-ttu-id="17dc5-157">Afin de continuer à prendre en charge <xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute?displayProperty=nameWithType> ce type de code, vous ajoutez l’attribut à la propriété, comme indiqué dans le code suivant:</span><span class="sxs-lookup"><span data-stu-id="17dc5-157">In order to continue to support this type of code, you add the <xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute?displayProperty=nameWithType> attribute to the property, as shown in the following code:</span></span>

```csharp
[AllowNull]
public string ScreenName
{
   get => screenName;
   set => screenName = value ?? GenerateRandomScreenName();
}
private string screenName = GenerateRandomScreenName();
```

<span data-ttu-id="17dc5-158">Vous devrez peut-être ajouter une `using` directive pour <xref:System.Diagnostics.CodeAnalysis> utiliser ceci et d’autres attributs discutés dans cet article.</span><span class="sxs-lookup"><span data-stu-id="17dc5-158">You may need to add a `using` directive for <xref:System.Diagnostics.CodeAnalysis> to use this and other attributes discussed in this article.</span></span> <span data-ttu-id="17dc5-159">L’attribut est appliqué à `set` la propriété, et non à l’accesseur.</span><span class="sxs-lookup"><span data-stu-id="17dc5-159">The attribute is applied to the property, not the `set` accessor.</span></span> <span data-ttu-id="17dc5-160">L’attribut `AllowNull` spécifie *les conditions préalables*et ne s’applique qu’aux entrées.</span><span class="sxs-lookup"><span data-stu-id="17dc5-160">The `AllowNull` attribute specifies *pre-conditions*, and only applies to inputs.</span></span> <span data-ttu-id="17dc5-161">L’accesseur `get` a une valeur de retour, mais pas d’arguments d’entrée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-161">The `get` accessor has a return value, but no input arguments.</span></span> <span data-ttu-id="17dc5-162">Par conséquent, `AllowNull` l’attribut `set` ne s’applique qu’à l’accesseur.</span><span class="sxs-lookup"><span data-stu-id="17dc5-162">Therefore, the `AllowNull` attribute only applies to the `set` accessor.</span></span>

<span data-ttu-id="17dc5-163">L’exemple précédent montre ce qu’il faut rechercher lors de l’ajout de l’attribut `AllowNull` sur un argument :</span><span class="sxs-lookup"><span data-stu-id="17dc5-163">The preceding example demonstrates what to look for when adding the `AllowNull` attribute on an argument:</span></span>

1. <span data-ttu-id="17dc5-164">Le contrat général pour cette variable est `null`qu’il ne devrait pas être , de sorte que vous voulez un type de référence non-nullable.</span><span class="sxs-lookup"><span data-stu-id="17dc5-164">The general contract for that variable is that it shouldn't be `null`, so you want a non-nullable reference type.</span></span>
1. <span data-ttu-id="17dc5-165">Il existe des scénarios pour `null`la variable d’entrée d’être, mais ils ne sont pas l’utilisation la plus courante.</span><span class="sxs-lookup"><span data-stu-id="17dc5-165">There are scenarios for the input variable to be `null`, though they aren't the most common usage.</span></span>

<span data-ttu-id="17dc5-166">Le plus souvent, vous aurez besoin `in` `out`de `ref` cet attribut pour les propriétés, ou , et les arguments.</span><span class="sxs-lookup"><span data-stu-id="17dc5-166">Most often you'll need this attribute for properties, or `in`, `out`, and `ref` arguments.</span></span> <span data-ttu-id="17dc5-167">L’attribut `AllowNull` est le meilleur choix lorsqu’une variable n’est généralement pas nulle, mais vous devez le permettre `null` comme condition préalable.</span><span class="sxs-lookup"><span data-stu-id="17dc5-167">The `AllowNull` attribute is the best choice when a variable is typically non-null, but you need to allow `null` as a precondition.</span></span>

<span data-ttu-id="17dc5-168">Comparez cela avec `DisallowNull`les scénarios pour l’utilisation : Vous utilisez cet attribut pour `null`spécifier qu’une variable d’entrée d’un type de référence nul ne devrait pas être .</span><span class="sxs-lookup"><span data-stu-id="17dc5-168">Contrast that with scenarios for using `DisallowNull`: You use this attribute to specify that an input variable of a nullable reference type shouldn't be `null`.</span></span> <span data-ttu-id="17dc5-169">Considérez une `null` propriété où est la valeur par défaut, mais les clients ne peuvent la définir qu’à une valeur non nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-169">Consider a property where `null` is the default value, but clients can only set it to a non-null value.</span></span> <span data-ttu-id="17dc5-170">Examinons le code ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="17dc5-170">Consider the following code:</span></span>

```csharp
public string ReviewComment
{
    get => _comment;
    set => _comment = value ?? throw new ArgumentNullException(nameof(value), "Cannot set to null");
}
string _comment;
```

<span data-ttu-id="17dc5-171">Le code précédent est la meilleure façon `ReviewComment` d’exprimer votre conception que le pourrait être `null`, mais ne peut pas être réglé à `null`.</span><span class="sxs-lookup"><span data-stu-id="17dc5-171">The preceding code is the best way to express your design that the `ReviewComment` could be `null`, but can't be set to `null`.</span></span> <span data-ttu-id="17dc5-172">Une fois que ce code est in nullable conscient, <xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute?displayProperty=nameWithType>vous pouvez exprimer ce concept plus clairement aux appelants en utilisant le :</span><span class="sxs-lookup"><span data-stu-id="17dc5-172">Once this code is nullable aware, you can express this concept more clearly to callers using the <xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute?displayProperty=nameWithType>:</span></span>

```csharp
[DisallowNull]
public string? ReviewComment
{
    get => _comment;
    set => _comment = value ?? throw new ArgumentNullException(nameof(value), "Cannot set to null");
}
string? _comment;
```

<span data-ttu-id="17dc5-173">Dans un contexte in `ReviewComment` `get` annulable, l’accesseur peut retourner la valeur par défaut de `null`.</span><span class="sxs-lookup"><span data-stu-id="17dc5-173">In a nullable context, the `ReviewComment` `get` accessor could return the default value of `null`.</span></span> <span data-ttu-id="17dc5-174">Le compilateur prévient qu’il doit être vérifié avant l’accès.</span><span class="sxs-lookup"><span data-stu-id="17dc5-174">The compiler warns that it must be checked before access.</span></span> <span data-ttu-id="17dc5-175">En outre, il avertit les appelants que, même si elle pourrait être `null`, les appelants ne devraient pas explicitement le définir à `null`.</span><span class="sxs-lookup"><span data-stu-id="17dc5-175">Furthermore, it warns callers that, even though it could be `null`, callers shouldn't explicitly set it to `null`.</span></span> <span data-ttu-id="17dc5-176">L’attribut `DisallowNull` spécifie également une condition `get` *préalable,* il n’affecte pas l’accesseur.</span><span class="sxs-lookup"><span data-stu-id="17dc5-176">The `DisallowNull` attribute also specifies a *pre-condition*, it does not affect the `get` accessor.</span></span> <span data-ttu-id="17dc5-177">Vous utilisez `DisallowNull` l’attribut lorsque vous observez ces caractéristiques sur :</span><span class="sxs-lookup"><span data-stu-id="17dc5-177">You use the `DisallowNull` attribute when you observe these characteristics about:</span></span>

1. <span data-ttu-id="17dc5-178">La variable `null` peut être dans les scénarios de base, souvent lors de la première instantané.</span><span class="sxs-lookup"><span data-stu-id="17dc5-178">The variable could be `null` in core scenarios, often when first instantiated.</span></span>
1. <span data-ttu-id="17dc5-179">La variable ne devrait pas `null`être explicitement définie à .</span><span class="sxs-lookup"><span data-stu-id="17dc5-179">The variable shouldn't be explicitly set to `null`.</span></span>

<span data-ttu-id="17dc5-180">Ces situations sont courantes dans le code qui était à l’origine *nulle inconscient*.</span><span class="sxs-lookup"><span data-stu-id="17dc5-180">These situations are common in code that was originally *null oblivious*.</span></span> <span data-ttu-id="17dc5-181">Il se peut que les propriétés d’objets soient définies dans deux opérations distinctes de initialisation.</span><span class="sxs-lookup"><span data-stu-id="17dc5-181">It may be that object properties are set in two distinct initialization operations.</span></span> <span data-ttu-id="17dc5-182">Il se peut que certaines propriétés ne soient définies qu’après la fin de certains travaux asynchrones.</span><span class="sxs-lookup"><span data-stu-id="17dc5-182">It may be that some properties are set only after some asynchronous work has completed.</span></span>

<span data-ttu-id="17dc5-183">Les `AllowNull` `DisallowNull` et les attributs vous permettent de spécifier que les conditions préalables sur les variables peuvent ne pas correspondre aux annotations annulables sur ces variables.</span><span class="sxs-lookup"><span data-stu-id="17dc5-183">The `AllowNull` and `DisallowNull` attributes enable you to specify that preconditions on variables may not match the nullable annotations on those variables.</span></span> <span data-ttu-id="17dc5-184">Ceux-ci fournissent plus de détails sur les caractéristiques de votre API.</span><span class="sxs-lookup"><span data-stu-id="17dc5-184">These provide more detail about the characteristics of your API.</span></span> <span data-ttu-id="17dc5-185">Ces informations supplémentaires aident les appelants à utiliser correctement votre API.</span><span class="sxs-lookup"><span data-stu-id="17dc5-185">This additional information helps callers use your API correctly.</span></span> <span data-ttu-id="17dc5-186">N’oubliez pas que vous spécifiez les conditions préalables à l’aide des attributs suivants :</span><span class="sxs-lookup"><span data-stu-id="17dc5-186">Remember you specify preconditions using the following attributes:</span></span>

- <span data-ttu-id="17dc5-187">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): Un argument d’entrée non annulable peut être nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-187">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="17dc5-188">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): Un argument d’entrée nul ne devrait jamais être nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-188">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>

## <a name="specify-post-conditions-maybenull-and-notnull"></a><span data-ttu-id="17dc5-189">Spécifier `MaybeNull` les conditions postérieures et`NotNull`</span><span class="sxs-lookup"><span data-stu-id="17dc5-189">Specify post-conditions: `MaybeNull` and `NotNull`</span></span>

<span data-ttu-id="17dc5-190">Supposons que vous avez une méthode avec la signature suivante:</span><span class="sxs-lookup"><span data-stu-id="17dc5-190">Suppose you have a method with the following signature:</span></span>

```csharp
public Customer FindCustomer(string lastName, string firstName)
```

<span data-ttu-id="17dc5-191">Vous avez probablement écrit une méthode `null` comme celle-ci pour revenir lorsque le nom recherché n’a pas été trouvé.</span><span class="sxs-lookup"><span data-stu-id="17dc5-191">You've likely written a method like this to return `null` when the name sought wasn't found.</span></span> <span data-ttu-id="17dc5-192">Le `null` indique clairement que le dossier n’a pas été trouvé.</span><span class="sxs-lookup"><span data-stu-id="17dc5-192">The `null` clearly indicates that the record wasn't found.</span></span> <span data-ttu-id="17dc5-193">Dans cet exemple, vous changeriez probablement `Customer` `Customer?`le type de retour de .</span><span class="sxs-lookup"><span data-stu-id="17dc5-193">In this example, you'd likely change the return type from `Customer` to `Customer?`.</span></span> <span data-ttu-id="17dc5-194">Déclarer la valeur de déclaration comme un type de référence nul précise clairement l’intention de cette API.</span><span class="sxs-lookup"><span data-stu-id="17dc5-194">Declaring the return value as a nullable reference type specifies the intent of this API clearly.</span></span>

<span data-ttu-id="17dc5-195">Pour des raisons couvertes par [des définitions génériques et l’annulation,](../../nullable-attributes.md#generic-definitions-and-nullability) cette technique ne fonctionne pas avec des méthodes génériques.</span><span class="sxs-lookup"><span data-stu-id="17dc5-195">For reasons covered under [Generic definitions and nullability](../../nullable-attributes.md#generic-definitions-and-nullability) that technique does not work with generic methods.</span></span> <span data-ttu-id="17dc5-196">Vous pouvez avoir une méthode générique qui suit un modèle similaire:</span><span class="sxs-lookup"><span data-stu-id="17dc5-196">You may have a generic method that follows a similar pattern:</span></span>

```csharp
public T Find<T>(IEnumerable<T> sequence, Func<T, bool> match)
```

<span data-ttu-id="17dc5-197">Vous ne pouvez pas spécifier que la valeur de retour est `T?`.</span><span class="sxs-lookup"><span data-stu-id="17dc5-197">You can't specify that the return value is `T?`.</span></span> <span data-ttu-id="17dc5-198">La méthode `null` revient lorsque l’article recherché n’est pas trouvé.</span><span class="sxs-lookup"><span data-stu-id="17dc5-198">The method returns `null` when the sought item isn't found.</span></span> <span data-ttu-id="17dc5-199">Puisque vous ne pouvez `T?` pas déclarer un `MaybeNull` type de retour, vous ajoutez l’annotation au retour de méthode :</span><span class="sxs-lookup"><span data-stu-id="17dc5-199">Since you can't declare a `T?` return type, you add the `MaybeNull` annotation to the method return:</span></span>

```csharp
[return: MaybeNull]
public T Find<T>(IEnumerable<T> sequence, Func<T, bool> match)
```

<span data-ttu-id="17dc5-200">Le code précédent informe les appelants que le contrat implique un type non annulable, mais la valeur de déclaration *peut* en fait être nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-200">The preceding code informs callers that the contract implies a non-nullable type, but the return value *may* actually be null.</span></span>  <span data-ttu-id="17dc5-201">Utilisez `MaybeNull` l’attribut lorsque votre API devrait être un type non-nullable, généralement `null` un paramètre de type générique, mais il peut y avoir des cas où serait retourné.</span><span class="sxs-lookup"><span data-stu-id="17dc5-201">Use the `MaybeNull` attribute when your API should be a non-nullable type, typically a generic type parameter, but there may be instances where `null` would be returned.</span></span>

<span data-ttu-id="17dc5-202">Vous pouvez également spécifier `out` `ref` qu’une valeur de retour ou un ou un argument n’est pas nul, même si le type est un type de référence nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-202">You can also specify that a return value or an `out` or `ref` argument isn't null even though the type is a nullable reference type.</span></span> <span data-ttu-id="17dc5-203">Considérez une méthode qui garantit qu’un tableau est assez grand pour contenir un certain nombre d’éléments.</span><span class="sxs-lookup"><span data-stu-id="17dc5-203">Consider a method that ensures an array is large enough to hold a number of elements.</span></span> <span data-ttu-id="17dc5-204">Si l’argument de l’entrée n’a pas de capacité, la routine allouerait un nouveau tableau et copierait tous les éléments existants.</span><span class="sxs-lookup"><span data-stu-id="17dc5-204">If the input argument doesn't have capacity, the routine would allocate a new array and copy all the existing elements into it.</span></span> <span data-ttu-id="17dc5-205">Si l’argument `null`de l’entrée est, la routine allouerait un nouveau stockage.</span><span class="sxs-lookup"><span data-stu-id="17dc5-205">If the input argument is `null`, the routine would allocate new storage.</span></span> <span data-ttu-id="17dc5-206">S’il y a une capacité suffisante, la routine ne fait rien :</span><span class="sxs-lookup"><span data-stu-id="17dc5-206">If there's sufficient capacity, the routine does nothing:</span></span>

```csharp
public void EnsureCapacity<T>(ref T[] storage, int size)
```

<span data-ttu-id="17dc5-207">Vous pourriez appeler cette routine comme suit:</span><span class="sxs-lookup"><span data-stu-id="17dc5-207">You could call this routine as follows:</span></span>

```csharp
// messages has the default value (null) when EnsureCapacity is called:
EnsureCapacity<string>(ref messages, 10);
// messages is not null.
EnsureCapacity<string>(messages, 50);
```

<span data-ttu-id="17dc5-208">Après avoir permis des types de référence nuls, vous souhaitez vous assurer que le code précédent se compile sans avertissements.</span><span class="sxs-lookup"><span data-stu-id="17dc5-208">After enabling null reference types, you want to ensure that the preceding code compiles without warnings.</span></span> <span data-ttu-id="17dc5-209">Lorsque la méthode `storage` revient, l’argument est garanti pour ne pas être nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-209">When the method returns, the `storage` argument is guaranteed to be not null.</span></span> <span data-ttu-id="17dc5-210">Cependant, il est acceptable `EnsureCapacity` d’appeler avec une référence nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-210">However, it's acceptable to call `EnsureCapacity` with a null reference.</span></span> <span data-ttu-id="17dc5-211">Vous pouvez `storage` faire un type de `NotNull` référence annulé et ajouter la post-condition à la déclaration de paramètres :</span><span class="sxs-lookup"><span data-stu-id="17dc5-211">You can make `storage` a nullable reference type, and add the `NotNull` post-condition to the parameter declaration:</span></span>

```csharp
public void EnsureCapacity<T>([NotNull]ref T[]? storage, int size)
```

<span data-ttu-id="17dc5-212">Le code précédent exprime clairement le contrat existant : `null` les appelants peuvent passer une variable avec la valeur, mais la valeur de rendement est garantie de ne jamais être nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-212">The preceding code expresses the existing contract clearly: Callers can pass a variable with the `null` value, but the return value is guaranteed to never be null.</span></span> <span data-ttu-id="17dc5-213">`NotNull` L’attribut est `ref` le `out` plus `null` utile et les arguments où peut être adopté comme un argument, mais cet argument est garanti d’être pas nul lorsque la méthode revient.</span><span class="sxs-lookup"><span data-stu-id="17dc5-213">The `NotNull` attribute is most useful for `ref` and `out` arguments where `null` may be passed as an argument, but that argument is guaranteed to be not null when the method returns.</span></span>

<span data-ttu-id="17dc5-214">Vous spécifiez les conditions post-conditions inconditionnelles à l’aide des attributs suivants :</span><span class="sxs-lookup"><span data-stu-id="17dc5-214">You specify unconditional postconditions using the following attributes:</span></span>

- <span data-ttu-id="17dc5-215">[Peut-êtreNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): Une valeur de retour non annulable peut être nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-215">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="17dc5-216">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): Une valeur de retour annulée ne sera jamais nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-216">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>

## <a name="specify-conditional-post-conditions-notnullwhen-maybenullwhen-and-notnullifnotnull"></a><span data-ttu-id="17dc5-217">Spécifier les `NotNullWhen` `MaybeNullWhen`conditions post-conditions conditionnelles: , et`NotNullIfNotNull`</span><span class="sxs-lookup"><span data-stu-id="17dc5-217">Specify conditional post-conditions: `NotNullWhen`, `MaybeNullWhen`, and `NotNullIfNotNull`</span></span>

<span data-ttu-id="17dc5-218">Vous êtes probablement familier `string` <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType>avec la méthode .</span><span class="sxs-lookup"><span data-stu-id="17dc5-218">You're likely familiar with the `string` method <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType>.</span></span> <span data-ttu-id="17dc5-219">Cette méthode `true` revient lorsque l’argument est nul ou une chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="17dc5-219">This method returns `true` when the argument is null or an empty string.</span></span> <span data-ttu-id="17dc5-220">C’est une forme de null-check: Les appelants n’ont pas `false`besoin de vérifier l’argument si la méthode revient .</span><span class="sxs-lookup"><span data-stu-id="17dc5-220">It's a form of null-check: Callers don't need to null-check the argument if the method returns `false`.</span></span> <span data-ttu-id="17dc5-221">Pour faire prendre conscience à une méthode comme celle-ci, vous définissez `NotNullWhen` l’argument à un type de référence nul et ajoutez l’attribut :</span><span class="sxs-lookup"><span data-stu-id="17dc5-221">To make a method like this nullable aware, you'd set the argument to a nullable reference type, and add the `NotNullWhen` attribute:</span></span>

```csharp
bool IsNullOrEmpty([NotNullWhen(false)]string? value);
```

<span data-ttu-id="17dc5-222">Cela informe le compilateur que tout `false` code où la valeur de retour est n’a pas besoin d’être vérifié non vérifié.</span><span class="sxs-lookup"><span data-stu-id="17dc5-222">That informs the compiler that any code where the return value is `false` need not be null-checked.</span></span> <span data-ttu-id="17dc5-223">L’ajout de l’attribut informe l’analyse `IsNullOrEmpty` statique du compilateur qui `false`effectue la vérification `null`nulle nécessaire : lorsqu’il revient, l’argument de l’entrée n’est pas .</span><span class="sxs-lookup"><span data-stu-id="17dc5-223">The addition of the attribute informs the compiler's static analysis that `IsNullOrEmpty` performs the necessary null check: when it returns `false`, the input argument is not `null`.</span></span>

```csharp
string? userInput = GetUserInput();
if (!string.IsNullOrEmpty(userInput))
{
   int messageLength = userInput.Length; // no null check needed.
}
// null check needed on userInput here.
```

<span data-ttu-id="17dc5-224">La <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType> méthode sera annotée comme indiqué ci-dessus pour .NET Core 3.0.</span><span class="sxs-lookup"><span data-stu-id="17dc5-224">The <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType> method will be annotated as shown above for .NET Core 3.0.</span></span> <span data-ttu-id="17dc5-225">Vous pouvez avoir des méthodes similaires dans votre base de code qui vérifient l’état des objets pour les valeurs nulles.</span><span class="sxs-lookup"><span data-stu-id="17dc5-225">You may have similar methods in your codebase that check the state of objects for null values.</span></span> <span data-ttu-id="17dc5-226">Le compilateur ne reconnaîtra pas les méthodes de vérification nulles personnalisées, et vous devrez ajouter les annotations vous-même.</span><span class="sxs-lookup"><span data-stu-id="17dc5-226">The compiler won't recognize custom null check methods, and you'll need to add the annotations yourself.</span></span> <span data-ttu-id="17dc5-227">Lorsque vous ajoutez l’attribut, l’analyse statique du compilateur sait quand la variable testée a été vérifiée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-227">When you add the attribute, the compiler's static analysis knows when the tested variable has been null checked.</span></span>

<span data-ttu-id="17dc5-228">Une autre utilisation pour `Try*` ces attributs est le modèle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-228">Another use for these attributes is the `Try*` pattern.</span></span> <span data-ttu-id="17dc5-229">Les conditions post-conditions `ref` et `out` les variables sont communiquées par la valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="17dc5-229">The postconditions for `ref` and `out` variables are communicated through the return value.</span></span> <span data-ttu-id="17dc5-230">Considérez cette méthode indiquée plus tôt :</span><span class="sxs-lookup"><span data-stu-id="17dc5-230">Consider this method shown earlier:</span></span>

```csharp
bool TryGetMessage(string key, out string message)
```

<span data-ttu-id="17dc5-231">La méthode précédente suit un idiome .NET `message` typique : la valeur de rendement indique si elle a été réglée à la valeur trouvée ou, si aucun message n’est trouvé, à la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="17dc5-231">The preceding method follows a typical .NET idiom: the return value indicates if `message` was set to the found value or, if no message is found, to the default value.</span></span> <span data-ttu-id="17dc5-232">Si la `true`méthode revient, la valeur de `message` n’est pas nulle; sinon, la `message` méthode s’établit à annuler.</span><span class="sxs-lookup"><span data-stu-id="17dc5-232">If the method returns `true`, the value of `message` isn't null; otherwise, the method sets `message` to null.</span></span>

<span data-ttu-id="17dc5-233">Vous pouvez communiquer cet idiome en utilisant l’attribut. `NotNullWhen`</span><span class="sxs-lookup"><span data-stu-id="17dc5-233">You can communicate that idiom using the `NotNullWhen` attribute.</span></span> <span data-ttu-id="17dc5-234">Lorsque vous mettez à jour la `message` signature `string?` pour les types de référence nuls, faites un attribut et ajoutez un attribut :</span><span class="sxs-lookup"><span data-stu-id="17dc5-234">When you update the signature for nullable reference types, make `message` a `string?` and add an attribute:</span></span>

```csharp
bool TryGetMessage(string key, [NotNullWhen(true)] out string? message)
```

<span data-ttu-id="17dc5-235">Dans l’exemple précédent, `message` la valeur de `TryGetMessage` est `true`connu pour ne pas être nul lors des déclarations .</span><span class="sxs-lookup"><span data-stu-id="17dc5-235">In the preceding example, the value of `message` is known to be not null when `TryGetMessage` returns `true`.</span></span> <span data-ttu-id="17dc5-236">Vous devez annoter des méthodes similaires dans votre base `null`de code de la même manière: `true`les arguments pourraient être , et sont connus pour ne pas être nul lorsque la méthode revient .</span><span class="sxs-lookup"><span data-stu-id="17dc5-236">You should annotate similar methods in your codebase in the same way: the arguments could be `null`, and are known to be not null when the method returns `true`.</span></span>

<span data-ttu-id="17dc5-237">Il ya un attribut final dont vous pouvez également avoir besoin.</span><span class="sxs-lookup"><span data-stu-id="17dc5-237">There's one final attribute you may also need.</span></span> <span data-ttu-id="17dc5-238">Parfois, l’état nul d’une valeur de retour dépend de l’état nul d’un ou plusieurs arguments d’entrée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-238">Sometimes the null state of a return value depends on the null state of one or more input arguments.</span></span> <span data-ttu-id="17dc5-239">Ces méthodes retourneront une valeur non nulle chaque `null`fois que certains arguments d’entrée ne sont pas .</span><span class="sxs-lookup"><span data-stu-id="17dc5-239">These methods will return a non-null value whenever certain input arguments aren't `null`.</span></span> <span data-ttu-id="17dc5-240">Pour annoter correctement ces méthodes, vous utilisez l’attribut. `NotNullIfNotNull`</span><span class="sxs-lookup"><span data-stu-id="17dc5-240">To correctly annotate these methods, you use the `NotNullIfNotNull` attribute.</span></span> <span data-ttu-id="17dc5-241">Considérez la méthode suivante :</span><span class="sxs-lookup"><span data-stu-id="17dc5-241">Consider the following method:</span></span>

```csharp
string GetTopLevelDomainFromFullUrl(string url);
```

<span data-ttu-id="17dc5-242">Si `url` l’argument n’est pas nul, la sortie n’est pas `null`.</span><span class="sxs-lookup"><span data-stu-id="17dc5-242">If the `url` argument isn't null, the output isn't `null`.</span></span> <span data-ttu-id="17dc5-243">Une fois que les références annulées sont activées, cette signature fonctionne correctement, à condition que votre API n’accepte jamais une entrée nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-243">Once nullable references are enabled, that signature works correctly, provided your API never accepts a null input.</span></span> <span data-ttu-id="17dc5-244">Toutefois, si l’entrée pouvait être nulle, la valeur de retour pourrait également être nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-244">However, if the input could be null, then return value could also be null.</span></span> <span data-ttu-id="17dc5-245">Par conséquent, vous pouvez modifier la signature au code suivant :</span><span class="sxs-lookup"><span data-stu-id="17dc5-245">Therefore, you could change the signature to the following code:</span></span>

```csharp
string? GetTopLevelDomainFromFullUrl(string? url);
```

<span data-ttu-id="17dc5-246">Cela fonctionne également, mais forcera souvent `null` les appelants à mettre en œuvre des contrôles supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="17dc5-246">That also works, but will often force callers to implement extra `null` checks.</span></span> <span data-ttu-id="17dc5-247">Le contrat est que la `null` valeur de `url` rendement `null`ne serait que lorsque l’argument de l’entrée est .</span><span class="sxs-lookup"><span data-stu-id="17dc5-247">The contract is that the return value would be `null` only when the input argument `url` is `null`.</span></span> <span data-ttu-id="17dc5-248">Pour exprimer ce contrat, vous annoteriez cette méthode comme indiqué dans le code suivant :</span><span class="sxs-lookup"><span data-stu-id="17dc5-248">To express that contract, you would annotate this method as shown in the following code:</span></span>

```csharp
[return: NotNullIfNotNull("url")]
string? GetTopLevelDomainFromFullUrl(string? url);
```

<span data-ttu-id="17dc5-249">La valeur de rendement et l’argument `?` ont tous deux `null`été annotés avec l’indication que l’un ou l’autre pourrait être .</span><span class="sxs-lookup"><span data-stu-id="17dc5-249">The return value and the argument have both been annotated with the `?` indicating that either could be `null`.</span></span> <span data-ttu-id="17dc5-250">L’attribut précise en outre que la valeur `url` de rendement `null`ne sera pas nulle lorsque l’argument n’est pas .</span><span class="sxs-lookup"><span data-stu-id="17dc5-250">The attribute further clarifies that the return value won't be null when the `url` argument isn't `null`.</span></span>

<span data-ttu-id="17dc5-251">Vous spécifiez des conditions post-conditions conditionnelles à l’aide de ces attributs :</span><span class="sxs-lookup"><span data-stu-id="17dc5-251">You specify conditional postconditions using these attributes:</span></span>

- <span data-ttu-id="17dc5-252">[Peut-êtreNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): Un argument d’entrée non annulable `bool` peut être nul lorsque la méthode renvoie la valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-252">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="17dc5-253">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): Un argument d’entrée nul ne sera `bool` pas nul lorsque la méthode retourne la valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-253">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument will not be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="17dc5-254">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): Une valeur de retour n’est pas nulle si l’argument de l’entrée pour le paramètre spécifié n’est pas nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-254">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the input argument for the specified parameter isn't null.</span></span>

## <a name="verify-unreachable-code"></a><span data-ttu-id="17dc5-255">Vérifier le code inaccessible</span><span class="sxs-lookup"><span data-stu-id="17dc5-255">Verify unreachable code</span></span>

<span data-ttu-id="17dc5-256">Certaines méthodes, généralement exception aides ou autres méthodes d’utilité, toujours sortir en jetant une exception.</span><span class="sxs-lookup"><span data-stu-id="17dc5-256">Some methods, typically exception helpers or other utility methods, always exit by throwing an exception.</span></span> <span data-ttu-id="17dc5-257">Ou, un aide peut jeter une exception basée sur la valeur d’un argument Boolean.</span><span class="sxs-lookup"><span data-stu-id="17dc5-257">Or, a helper may throw an exception based on the value of a Boolean argument.</span></span>

<span data-ttu-id="17dc5-258">Dans le premier cas, `DoesNotReturn` vous pouvez ajouter l’attribut à la déclaration de méthode.</span><span class="sxs-lookup"><span data-stu-id="17dc5-258">In the first case, you can add the `DoesNotReturn` attribute to the method declaration.</span></span> <span data-ttu-id="17dc5-259">Le compilateur vous aide de trois façons.</span><span class="sxs-lookup"><span data-stu-id="17dc5-259">The compiler helps you in three ways.</span></span> <span data-ttu-id="17dc5-260">Tout d’abord, le compilateur émet un avertissement s’il ya un chemin où la méthode peut sortir sans jeter une exception.</span><span class="sxs-lookup"><span data-stu-id="17dc5-260">First, the compiler issues a warning if there is a path where the method can exit without throwing an exception.</span></span> <span data-ttu-id="17dc5-261">Deuxièmement, le compilateur marque n’importe quel code après un `catch` appel à cette méthode comme *inaccessible,* jusqu’à ce qu’une clause appropriée soit rencontrée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-261">Second, the compiler marks any code after a call to that method as *unreachable*, until an appropriate `catch` clause is encountered.</span></span> <span data-ttu-id="17dc5-262">Troisièmement, le code inaccessible n’affectera aucun état nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-262">Third, the unreachable code won't affect any null states.</span></span> <span data-ttu-id="17dc5-263">Prenons la méthode suivante :</span><span class="sxs-lookup"><span data-stu-id="17dc5-263">Consider this method:</span></span>

```csharp
[DoesNotReturn]
private void FailFast()
{
   throw new InvalidOperationException();
}

public void SetState(object containedField)
{
   if (!isInitialized)
      FailFast();

   // unreachable code:
   this.field = containedField;
}
```

<span data-ttu-id="17dc5-264">Dans le deuxième cas, `DoesNotReturnIf` vous ajoutez l’attribut à un paramètre Boolean de la méthode.</span><span class="sxs-lookup"><span data-stu-id="17dc5-264">In the second case, you add the `DoesNotReturnIf` attribute to a Boolean parameter of the method.</span></span> <span data-ttu-id="17dc5-265">Vous pouvez modifier l’exemple précédent comme suit :</span><span class="sxs-lookup"><span data-stu-id="17dc5-265">You can modify the previous example as follows:</span></span>

```csharp
private void FailFast([DoesNotReturnIf(false)]bool isValid)
{
   if (!isValid)
       throw new InvalidOperationException();
}

public void SetState(object containedField)
{
   FailFast(isInitialized);

   // unreachable code when "isInitialized" is false:
   this.field = containedField;
}
```

## <a name="summary"></a><span data-ttu-id="17dc5-266">Résumé</span><span class="sxs-lookup"><span data-stu-id="17dc5-266">Summary</span></span>

<span data-ttu-id="17dc5-267">L’ajout de types de référence in annulables fournit `null`un vocabulaire initial pour décrire vos attentes d’API pour les variables qui pourraient être .</span><span class="sxs-lookup"><span data-stu-id="17dc5-267">Adding nullable reference types provides an initial vocabulary to describe your APIs expectations for variables that could be `null`.</span></span> <span data-ttu-id="17dc5-268">Les attributs supplémentaires fournissent un vocabulaire plus riche pour décrire l’état nul des variables comme conditions préalables et conditions post.</span><span class="sxs-lookup"><span data-stu-id="17dc5-268">The additional attributes provide a richer vocabulary to describe the null state of variables as preconditions and postconditions.</span></span> <span data-ttu-id="17dc5-269">Ces attributs décrivent plus clairement vos attentes et offrent une meilleure expérience pour les développeurs utilisant vos API.</span><span class="sxs-lookup"><span data-stu-id="17dc5-269">These attributes more clearly describe your expectations and provide a better experience for the developers using your APIs.</span></span>

<span data-ttu-id="17dc5-270">Lorsque vous mettez à jour les bibliothèques pour un contexte nul, ajoutez ces attributs pour guider les utilisateurs de vos API à l’utilisation correcte.</span><span class="sxs-lookup"><span data-stu-id="17dc5-270">As you update libraries for a nullable context, add these attributes to guide users of your APIs to the correct usage.</span></span> <span data-ttu-id="17dc5-271">Ces attributs vous aident à décrire pleinement l’état nul des arguments d’entrée et des valeurs de rendement :</span><span class="sxs-lookup"><span data-stu-id="17dc5-271">These attributes help you fully describe the null-state of input arguments and return values:</span></span>

- <span data-ttu-id="17dc5-272">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): Un argument d’entrée non annulable peut être nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-272">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="17dc5-273">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): Un argument d’entrée nul ne devrait jamais être nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-273">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>
- <span data-ttu-id="17dc5-274">[Peut-êtreNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): Une valeur de retour non annulable peut être nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-274">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="17dc5-275">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): Une valeur de retour annulée ne sera jamais nulle.</span><span class="sxs-lookup"><span data-stu-id="17dc5-275">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>
- <span data-ttu-id="17dc5-276">[Peut-êtreNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): Un argument d’entrée non annulable `bool` peut être nul lorsque la méthode renvoie la valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-276">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="17dc5-277">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): Un argument d’entrée nul ne sera `bool` pas nul lorsque la méthode retourne la valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-277">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument will not be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="17dc5-278">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): Une valeur de retour n’est pas nulle si l’argument de l’entrée pour le paramètre spécifié n’est pas nul.</span><span class="sxs-lookup"><span data-stu-id="17dc5-278">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the input argument for the specified parameter isn't null.</span></span>
- <span data-ttu-id="17dc5-279">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): Une méthode ne revient jamais.</span><span class="sxs-lookup"><span data-stu-id="17dc5-279">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): A method never returns.</span></span> <span data-ttu-id="17dc5-280">En d’autres termes, il jette toujours une exception.</span><span class="sxs-lookup"><span data-stu-id="17dc5-280">In other words, it always throws an exception.</span></span>
- <span data-ttu-id="17dc5-281">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): Cette méthode ne `bool` revient jamais si le paramètre associé a la valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="17dc5-281">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): This method never returns if the associated `bool` parameter has the specified value.</span></span>

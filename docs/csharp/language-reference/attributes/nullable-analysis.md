---
title: 'Attributs réservés C# : analyse statique Nullable'
ms.date: 02/02/2021
description: Ces attributs sont interprétés par le compilateur pour fournir une meilleure analyse statique pour les types de référence Nullable et non Nullable.
ms.openlocfilehash: c1c3e0a0fe1ee9000e0a1a85ee08e6e966200be5
ms.sourcegitcommit: 4df8e005c074ceb1f978f007b222fe253be2baf3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/04/2021
ms.locfileid: "99548355"
---
# <a name="reserved-attributes-contribute-to-the-compilers-null-state-static-analysis"></a><span data-ttu-id="bc891-103">Les attributs réservés contribuent à l’analyse statique d’État null du compilateur</span><span class="sxs-lookup"><span data-stu-id="bc891-103">Reserved attributes contribute to the compiler's null state static analysis</span></span>

<span data-ttu-id="bc891-104">Dans un contexte Nullable, le compilateur effectue une analyse statique du code pour déterminer l’État null de toutes les variables de type référence :</span><span class="sxs-lookup"><span data-stu-id="bc891-104">In a nullable context, the compiler performs static analysis of code to determine the null state of all reference type variables:</span></span>

- <span data-ttu-id="bc891-105">*not null*: l’analyse statique détermine qu’une valeur non null est assignée à une variable.</span><span class="sxs-lookup"><span data-stu-id="bc891-105">*not null*: Static analysis determines that a variable is assigned a non-null value.</span></span>
- <span data-ttu-id="bc891-106">*peut-être null*: l’analyse statique ne peut pas déterminer qu’une valeur non null est assignée à une variable.</span><span class="sxs-lookup"><span data-stu-id="bc891-106">*maybe null*: Static analysis can't determine that a variable is assigned a non-null value.</span></span>

<span data-ttu-id="bc891-107">Vous pouvez appliquer des attributs qui fournissent des informations au compilateur sur la sémantique de vos API.</span><span class="sxs-lookup"><span data-stu-id="bc891-107">You can apply attributes that provide information to the compiler about the semantics of your APIs.</span></span> <span data-ttu-id="bc891-108">Ces informations permettent au compilateur d’effectuer une analyse statique et de déterminer quand une variable n’a pas la valeur null.</span><span class="sxs-lookup"><span data-stu-id="bc891-108">That information helps the compiler perform static analysis and determine when a variable isn't null.</span></span> <span data-ttu-id="bc891-109">Cet article fournit une brève description de chacun de ces attributs et explique comment les utiliser.</span><span class="sxs-lookup"><span data-stu-id="bc891-109">This article provides a brief description of each of those attributes and how to use them.</span></span> <span data-ttu-id="bc891-110">Tous les exemples supposent C# 8,0 ou une version plus récente et le code se trouve dans un contexte Nullable.</span><span class="sxs-lookup"><span data-stu-id="bc891-110">All the examples assume C# 8.0 or newer, and the code is in a nullable context.</span></span>

<span data-ttu-id="bc891-111">Commençons par un exemple familier.</span><span class="sxs-lookup"><span data-stu-id="bc891-111">Let's start with a familiar example.</span></span> <span data-ttu-id="bc891-112">Imaginez que votre bibliothèque possède l’API suivante pour récupérer une chaîne de ressource :</span><span class="sxs-lookup"><span data-stu-id="bc891-112">Imagine your library has the following API to retrieve a resource string:</span></span>

```csharp
bool TryGetMessage(string key, out string message)
```

<span data-ttu-id="bc891-113">L’exemple précédent suit le `Try*` modèle familier dans .net.</span><span class="sxs-lookup"><span data-stu-id="bc891-113">The preceding example follows the familiar `Try*` pattern in .NET.</span></span> <span data-ttu-id="bc891-114">Il existe deux arguments de référence pour cette API : `key` et le `message` paramètre.</span><span class="sxs-lookup"><span data-stu-id="bc891-114">There are two reference arguments for this API: the `key` and the `message` parameter.</span></span> <span data-ttu-id="bc891-115">Cette API comporte les règles suivantes relatives à la valeur null de ces arguments :</span><span class="sxs-lookup"><span data-stu-id="bc891-115">This API has the following rules relating to the nullness of these arguments:</span></span>

- <span data-ttu-id="bc891-116">Les appelants ne doivent pas passer `null` comme argument pour `key` .</span><span class="sxs-lookup"><span data-stu-id="bc891-116">Callers shouldn't pass `null` as the argument for `key`.</span></span>
- <span data-ttu-id="bc891-117">Les appelants peuvent passer une variable dont la valeur est `null` l’argument pour `message` .</span><span class="sxs-lookup"><span data-stu-id="bc891-117">Callers can pass a variable whose value is `null` as the argument for `message`.</span></span>
- <span data-ttu-id="bc891-118">Si la `TryGetMessage` méthode retourne `true` , la valeur de `message` n’est pas null.</span><span class="sxs-lookup"><span data-stu-id="bc891-118">If the `TryGetMessage` method returns `true`, the value of `message` isn't null.</span></span> <span data-ttu-id="bc891-119">Si la valeur de retour est `false,` la valeur de `message` (et son état null) est null.</span><span class="sxs-lookup"><span data-stu-id="bc891-119">If the return value is `false,` the value of `message` (and its null state) is null.</span></span>

<span data-ttu-id="bc891-120">La règle pour `key` peut être exprimée par le type de variable : `key` doit être un type référence qui n’accepte pas les valeurs NULL.</span><span class="sxs-lookup"><span data-stu-id="bc891-120">The rule for `key` can be expressed by the variable type: `key` should be a non-nullable reference type.</span></span> <span data-ttu-id="bc891-121">Le `message` paramètre est plus complexe.</span><span class="sxs-lookup"><span data-stu-id="bc891-121">The `message` parameter is more complex.</span></span> <span data-ttu-id="bc891-122">Elle autorise `null` comme argument, mais garantit que, en cas de réussite, cet `out` argument n’est pas null.</span><span class="sxs-lookup"><span data-stu-id="bc891-122">It allows `null` as the argument, but guarantees that, on success, that `out` argument isn't null.</span></span> <span data-ttu-id="bc891-123">Pour ces scénarios, vous avez besoin d’un vocabulaire plus riche pour décrire les attentes.</span><span class="sxs-lookup"><span data-stu-id="bc891-123">For these scenarios, you need a richer vocabulary to describe the expectations.</span></span>

<span data-ttu-id="bc891-124">Plusieurs attributs ont été ajoutés pour exprimer des informations supplémentaires sur l’État null des variables.</span><span class="sxs-lookup"><span data-stu-id="bc891-124">Several attributes have been added to express additional information about the null state of variables.</span></span> <span data-ttu-id="bc891-125">Tout le code que vous avez écrit avant C# 8 a introduit des types de référence Nullable était *null oublie*.</span><span class="sxs-lookup"><span data-stu-id="bc891-125">All code you wrote before C# 8 introduced nullable reference types was *null oblivious*.</span></span> <span data-ttu-id="bc891-126">Cela signifie que toute variable de type référence peut avoir la valeur null, mais que les vérifications de valeur NULL ne sont pas requises.</span><span class="sxs-lookup"><span data-stu-id="bc891-126">That means any reference type variable may be null, but null checks aren't required.</span></span> <span data-ttu-id="bc891-127">Une fois que votre code prend en *charge les valeurs NULL*, ces règles changent.</span><span class="sxs-lookup"><span data-stu-id="bc891-127">Once your code is *nullable aware*, those rules change.</span></span> <span data-ttu-id="bc891-128">Les types référence ne doivent jamais être la `null` valeur, et les types référence Nullable doivent être vérifiés `null` avant d’être déréférencés.</span><span class="sxs-lookup"><span data-stu-id="bc891-128">Reference types should never be the `null` value, and nullable reference types must be checked against `null` before being dereferenced.</span></span>

<span data-ttu-id="bc891-129">Les règles de vos API sont probablement plus compliquées, comme vous l’avez vu dans le `TryGetValue` scénario d’API.</span><span class="sxs-lookup"><span data-stu-id="bc891-129">The rules for your APIs are likely more complicated, as you saw with the `TryGetValue` API scenario.</span></span> <span data-ttu-id="bc891-130">La plupart de vos API ont des règles plus complexes pour le moment où les variables peuvent ou ne peuvent pas être `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-130">Many of your APIs have more complex rules for when variables can or can't be `null`.</span></span> <span data-ttu-id="bc891-131">Dans ce cas, vous allez utiliser l’un des attributs suivants pour exprimer ces règles :</span><span class="sxs-lookup"><span data-stu-id="bc891-131">In these cases, you'll use one of the following attributes to express those rules:</span></span>

- <span data-ttu-id="bc891-132">[AllowNull a](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): un argument d’entrée qui n’accepte pas les valeurs NULL peut être null.</span><span class="sxs-lookup"><span data-stu-id="bc891-132">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="bc891-133">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): un argument d’entrée Nullable ne doit jamais avoir la valeur null.</span><span class="sxs-lookup"><span data-stu-id="bc891-133">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>
- <span data-ttu-id="bc891-134">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): une valeur de retour qui n’accepte pas les valeurs NULL peut être null.</span><span class="sxs-lookup"><span data-stu-id="bc891-134">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="bc891-135">[NOTNULL](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): une valeur de retour Nullable ne sera jamais null.</span><span class="sxs-lookup"><span data-stu-id="bc891-135">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>
- <span data-ttu-id="bc891-136">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): un argument d’entrée qui n’accepte pas les valeurs NULL peut être NULL lorsque la méthode retourne la `bool` valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="bc891-136">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="bc891-137">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): un argument d’entrée Nullable ne sera pas NULL lorsque la méthode retourne la `bool` valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="bc891-137">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument won't be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="bc891-138">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): une valeur de retour n’est pas null si l’argument pour le paramètre spécifié n’est pas null.</span><span class="sxs-lookup"><span data-stu-id="bc891-138">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the argument for the specified parameter isn't null.</span></span>
- <span data-ttu-id="bc891-139">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): une méthode ne retourne jamais.</span><span class="sxs-lookup"><span data-stu-id="bc891-139">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): A method never returns.</span></span> <span data-ttu-id="bc891-140">En d’autres termes, elle lève toujours une exception.</span><span class="sxs-lookup"><span data-stu-id="bc891-140">In other words, it always throws an exception.</span></span>
- <span data-ttu-id="bc891-141">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): cette méthode ne retourne jamais si le `bool` paramètre associé a la valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="bc891-141">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): This method never returns if the associated `bool` parameter has the specified value.</span></span>
- <span data-ttu-id="bc891-142">[MemberNotNull](xref:System.Diagnostics.CodeAnalysis.MemberNotNullAttribute): le membre indiqué n’a pas la valeur NULL lorsque la méthode est retournée.</span><span class="sxs-lookup"><span data-stu-id="bc891-142">[MemberNotNull](xref:System.Diagnostics.CodeAnalysis.MemberNotNullAttribute): The listed member won't be null when the method returns.</span></span>
- <span data-ttu-id="bc891-143">[MemberNotNullWhen](xref:System.Diagnostics.CodeAnalysis.MemberNotNullWhenAttribute): le membre indiqué n’est pas NULL lorsque la méthode retourne la `bool` valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="bc891-143">[MemberNotNullWhen](xref:System.Diagnostics.CodeAnalysis.MemberNotNullWhenAttribute): The listed member won't be null when the method returns the specified `bool` value.</span></span>

<span data-ttu-id="bc891-144">Les descriptions précédentes sont une référence rapide à ce que fait chaque attribut.</span><span class="sxs-lookup"><span data-stu-id="bc891-144">The preceding descriptions are a quick reference to what each attribute does.</span></span> <span data-ttu-id="bc891-145">Chaque section suivante décrit le comportement et la signification de manière plus approfondie.</span><span class="sxs-lookup"><span data-stu-id="bc891-145">Each following section describes the behavior and meaning more thoroughly.</span></span>

<span data-ttu-id="bc891-146">L’ajout de ces attributs donne au compilateur plus d’informations sur les règles de votre API.</span><span class="sxs-lookup"><span data-stu-id="bc891-146">Adding these attributes gives the compiler more information about the rules for your API.</span></span> <span data-ttu-id="bc891-147">Quand le code appelant est compilé dans un contexte compatible avec la valeur null, le compilateur avertit les appelants lorsqu’ils enfreignent ces règles.</span><span class="sxs-lookup"><span data-stu-id="bc891-147">When calling code is compiled in a nullable enabled context, the compiler will warn callers when they violate those rules.</span></span> <span data-ttu-id="bc891-148">Ces attributs n’autorisent pas de vérifications supplémentaires sur votre implémentation.</span><span class="sxs-lookup"><span data-stu-id="bc891-148">These attributes don't enable more checks on your implementation.</span></span>

## <a name="specify-preconditions-allownull-and-disallownull"></a><span data-ttu-id="bc891-149">Spécifier les conditions préalables : `AllowNull` et `DisallowNull`</span><span class="sxs-lookup"><span data-stu-id="bc891-149">Specify preconditions: `AllowNull` and `DisallowNull`</span></span>

<span data-ttu-id="bc891-150">Prenons l’exemple d’une propriété en lecture/écriture qui n’est jamais retournée `null` , car elle a une valeur par défaut raisonnable.</span><span class="sxs-lookup"><span data-stu-id="bc891-150">Consider a read/write property that never returns `null` because it has a reasonable default value.</span></span> <span data-ttu-id="bc891-151">Les appelants passent `null` à l’accesseur Set lors de la définition de cette valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="bc891-151">Callers pass `null` to the set accessor when setting it to that default value.</span></span> <span data-ttu-id="bc891-152">Par exemple, imaginez un système de messagerie qui demande un nom d’écran dans une salle de conversation.</span><span class="sxs-lookup"><span data-stu-id="bc891-152">For example, consider a messaging system that asks for a screen name in a chat room.</span></span> <span data-ttu-id="bc891-153">Si aucune valeur n’est fournie, le système génère un nom aléatoire :</span><span class="sxs-lookup"><span data-stu-id="bc891-153">If none is provided, the system generates a random name:</span></span>

```csharp
public string ScreenName
{
   get => _screenName;
   set => _screenName = value ?? GenerateRandomScreenName();
}
private string _screenName;
```

<span data-ttu-id="bc891-154">Quand vous compilez le code précédent dans un contexte oublie Nullable, tout est parfait.</span><span class="sxs-lookup"><span data-stu-id="bc891-154">When you compile the preceding code in a nullable oblivious context, everything is fine.</span></span> <span data-ttu-id="bc891-155">Une fois que vous activez les types référence Nullable, la `ScreenName` propriété devient une référence qui n’accepte pas les valeurs NULL.</span><span class="sxs-lookup"><span data-stu-id="bc891-155">Once you enable nullable reference types, the `ScreenName` property becomes a non-nullable reference.</span></span> <span data-ttu-id="bc891-156">C’est correct pour l' `get` accesseur : il ne retourne jamais `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-156">That's correct for the `get` accessor: it never returns `null`.</span></span> <span data-ttu-id="bc891-157">Les appelants n’ont pas besoin de vérifier la propriété retournée pour `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-157">Callers don't need to check the returned property for `null`.</span></span> <span data-ttu-id="bc891-158">Mais maintenant, le paramétrage de la propriété pour `null` générer un avertissement.</span><span class="sxs-lookup"><span data-stu-id="bc891-158">But now setting the property to `null` generates a warning.</span></span> <span data-ttu-id="bc891-159">Pour prendre en charge ce type de code, vous ajoutez l' <xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute?displayProperty=nameWithType> attribut à la propriété, comme illustré dans le code suivant :</span><span class="sxs-lookup"><span data-stu-id="bc891-159">To support this type of code, you add the <xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute?displayProperty=nameWithType> attribute to the property, as shown in the following code:</span></span>

```csharp
[AllowNull]
public string ScreenName
{
   get => _screenName;
   set => _screenName = value ?? GenerateRandomScreenName();
}
private string _screenName = GenerateRandomScreenName();
```

<span data-ttu-id="bc891-160">Vous devrez peut-être ajouter une `using` directive pour <xref:System.Diagnostics.CodeAnalysis> utiliser ce et d’autres attributs abordés dans cet article.</span><span class="sxs-lookup"><span data-stu-id="bc891-160">You may need to add a `using` directive for <xref:System.Diagnostics.CodeAnalysis> to use this and other attributes discussed in this article.</span></span> <span data-ttu-id="bc891-161">L’attribut est appliqué à la propriété, et non à l' `set` accesseur.</span><span class="sxs-lookup"><span data-stu-id="bc891-161">The attribute is applied to the property, not the `set` accessor.</span></span> <span data-ttu-id="bc891-162">L' `AllowNull` attribut spécifie des *conditions préalables* et s’applique uniquement aux entrées.</span><span class="sxs-lookup"><span data-stu-id="bc891-162">The `AllowNull` attribute specifies *pre-conditions*, and only applies to inputs.</span></span> <span data-ttu-id="bc891-163">L' `get` accesseur a une valeur de retour, mais aucun argument d’entrée.</span><span class="sxs-lookup"><span data-stu-id="bc891-163">The `get` accessor has a return value, but no input arguments.</span></span> <span data-ttu-id="bc891-164">Par conséquent, l' `AllowNull` attribut s’applique uniquement à l' `set` accesseur.</span><span class="sxs-lookup"><span data-stu-id="bc891-164">Therefore, the `AllowNull` attribute only applies to the `set` accessor.</span></span>

<span data-ttu-id="bc891-165">L’exemple précédent montre ce qu’il faut rechercher lors de l’ajout `AllowNull` de l’attribut à un argument :</span><span class="sxs-lookup"><span data-stu-id="bc891-165">The preceding example demonstrates what to look for when adding the `AllowNull` attribute on an argument:</span></span>

1. <span data-ttu-id="bc891-166">Le contrat général pour cette variable est qu’elle ne doit pas l’être `null` , donc vous souhaitez un type de référence non Nullable.</span><span class="sxs-lookup"><span data-stu-id="bc891-166">The general contract for that variable is that it shouldn't be `null`, so you want a non-nullable reference type.</span></span>
1. <span data-ttu-id="bc891-167">Il existe des scénarios pour la variable d’entrée `null` , bien qu’il ne s’agisse pas de l’utilisation la plus courante.</span><span class="sxs-lookup"><span data-stu-id="bc891-167">There are scenarios for the input variable to be `null`, though they aren't the most common usage.</span></span>

<span data-ttu-id="bc891-168">La plupart du temps, vous aurez besoin de cet attribut pour les propriétés, ou `in` , `out` et les `ref` arguments.</span><span class="sxs-lookup"><span data-stu-id="bc891-168">Most often you'll need this attribute for properties, or `in`, `out`, and `ref` arguments.</span></span> <span data-ttu-id="bc891-169">L' `AllowNull` attribut est le meilleur choix lorsqu’une variable est généralement non null, mais que vous devez autoriser `null` comme condition préalable.</span><span class="sxs-lookup"><span data-stu-id="bc891-169">The `AllowNull` attribute is the best choice when a variable is typically non-null, but you need to allow `null` as a precondition.</span></span>

<span data-ttu-id="bc891-170">À l’inverse, avec les scénarios d’utilisation de `DisallowNull` :, vous utilisez cet attribut pour spécifier qu’une variable d’entrée d’un type de référence Nullable ne doit pas être `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-170">Contrast that with scenarios for using `DisallowNull`: You use this attribute to specify that an input variable of a nullable reference type shouldn't be `null`.</span></span> <span data-ttu-id="bc891-171">Considérez une propriété où `null` est la valeur par défaut, mais les clients peuvent uniquement la définir sur une valeur non null.</span><span class="sxs-lookup"><span data-stu-id="bc891-171">Consider a property where `null` is the default value, but clients can only set it to a non-null value.</span></span> <span data-ttu-id="bc891-172">Considérez le code suivant :</span><span class="sxs-lookup"><span data-stu-id="bc891-172">Consider the following code:</span></span>

```csharp
public string ReviewComment
{
    get => _comment;
    set => _comment = value ?? throw new ArgumentNullException(nameof(value), "Cannot set to null");
}
string _comment;
```

<span data-ttu-id="bc891-173">Le code précédent est la meilleure façon d’exprimer votre conception de `ReviewComment` `null` , mais ne peut pas avoir la valeur `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-173">The preceding code is the best way to express your design that the `ReviewComment` could be `null`, but can't be set to `null`.</span></span> <span data-ttu-id="bc891-174">Une fois que ce code prend en charge les valeurs NULL, vous pouvez exprimer ce concept plus clairement aux appelants à l’aide du <xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute?displayProperty=nameWithType> :</span><span class="sxs-lookup"><span data-stu-id="bc891-174">Once this code is nullable aware, you can express this concept more clearly to callers using the <xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute?displayProperty=nameWithType>:</span></span>

```csharp
[DisallowNull]
public string? ReviewComment
{
    get => _comment;
    set => _comment = value ?? throw new ArgumentNullException(nameof(value), "Cannot set to null");
}
string? _comment;
```

<span data-ttu-id="bc891-175">Dans un contexte Nullable, l' `ReviewComment` `get` accesseur peut retourner la valeur par défaut de `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-175">In a nullable context, the `ReviewComment` `get` accessor could return the default value of `null`.</span></span> <span data-ttu-id="bc891-176">Le compilateur vous avertit qu’il doit être vérifié avant l’accès.</span><span class="sxs-lookup"><span data-stu-id="bc891-176">The compiler warns that it must be checked before access.</span></span> <span data-ttu-id="bc891-177">En outre, il avertit les appelants que, même s’ils peuvent l’être `null` , les appelants ne doivent pas lui affecter explicitement la valeur `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-177">Furthermore, it warns callers that, even though it could be `null`, callers shouldn't explicitly set it to `null`.</span></span> <span data-ttu-id="bc891-178">L' `DisallowNull` attribut spécifie également une *condition préalable*, il n’affecte pas l' `get` accesseur.</span><span class="sxs-lookup"><span data-stu-id="bc891-178">The `DisallowNull` attribute also specifies a *pre-condition*, it doesn't affect the `get` accessor.</span></span> <span data-ttu-id="bc891-179">Vous utilisez l' `DisallowNull` attribut lorsque vous observez les caractéristiques suivantes :</span><span class="sxs-lookup"><span data-stu-id="bc891-179">You use the `DisallowNull` attribute when you observe these characteristics about:</span></span>

1. <span data-ttu-id="bc891-180">La variable peut être `null` dans des scénarios de base, souvent lors de la première instanciation.</span><span class="sxs-lookup"><span data-stu-id="bc891-180">The variable could be `null` in core scenarios, often when first instantiated.</span></span>
1. <span data-ttu-id="bc891-181">La variable ne doit pas avoir explicitement la valeur `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-181">The variable shouldn't be explicitly set to `null`.</span></span>

<span data-ttu-id="bc891-182">Ces situations sont courantes dans le code qui a été initialement *null oublie*.</span><span class="sxs-lookup"><span data-stu-id="bc891-182">These situations are common in code that was originally *null oblivious*.</span></span> <span data-ttu-id="bc891-183">Les propriétés de l’objet sont peut-être définies dans deux opérations d’initialisation distinctes.</span><span class="sxs-lookup"><span data-stu-id="bc891-183">It may be that object properties are set in two distinct initialization operations.</span></span> <span data-ttu-id="bc891-184">Il se peut que certaines propriétés soient définies uniquement après la fin d’un travail asynchrone.</span><span class="sxs-lookup"><span data-stu-id="bc891-184">It may be that some properties are set only after some asynchronous work has completed.</span></span>

<span data-ttu-id="bc891-185">Les `AllowNull` `DisallowNull` attributs et vous permettent de spécifier que les conditions préalables sur les variables peuvent ne pas correspondre aux annotations Nullable sur ces variables.</span><span class="sxs-lookup"><span data-stu-id="bc891-185">The `AllowNull` and `DisallowNull` attributes enable you to specify that preconditions on variables may not match the nullable annotations on those variables.</span></span> <span data-ttu-id="bc891-186">Celles-ci fournissent des informations plus détaillées sur les caractéristiques de votre API.</span><span class="sxs-lookup"><span data-stu-id="bc891-186">These provide more detail about the characteristics of your API.</span></span> <span data-ttu-id="bc891-187">Ces informations supplémentaires permettent aux appelants d’utiliser correctement votre API.</span><span class="sxs-lookup"><span data-stu-id="bc891-187">This additional information helps callers use your API correctly.</span></span> <span data-ttu-id="bc891-188">N’oubliez pas de spécifier des conditions préalables à l’aide des attributs suivants :</span><span class="sxs-lookup"><span data-stu-id="bc891-188">Remember you specify preconditions using the following attributes:</span></span>

- <span data-ttu-id="bc891-189">[AllowNull a](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): un argument d’entrée qui n’accepte pas les valeurs NULL peut être null.</span><span class="sxs-lookup"><span data-stu-id="bc891-189">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="bc891-190">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): un argument d’entrée Nullable ne doit jamais avoir la valeur null.</span><span class="sxs-lookup"><span data-stu-id="bc891-190">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>

## <a name="specify-post-conditions-maybenull-and-notnull"></a><span data-ttu-id="bc891-191">Spécifier les conditions postérieures : `MaybeNull` et `NotNull`</span><span class="sxs-lookup"><span data-stu-id="bc891-191">Specify post-conditions: `MaybeNull` and `NotNull`</span></span>

<span data-ttu-id="bc891-192">Supposons que vous avez une méthode avec la signature suivante :</span><span class="sxs-lookup"><span data-stu-id="bc891-192">Suppose you have a method with the following signature:</span></span>

```csharp
public Customer FindCustomer(string lastName, string firstName)
```

<span data-ttu-id="bc891-193">Vous avez probablement écrit une méthode comme celle-ci pour retourner `null` lorsque le nom recherché n’a pas été trouvé.</span><span class="sxs-lookup"><span data-stu-id="bc891-193">You've likely written a method like this to return `null` when the name sought wasn't found.</span></span> <span data-ttu-id="bc891-194">`null`Indique clairement que l’enregistrement n’a pas été trouvé.</span><span class="sxs-lookup"><span data-stu-id="bc891-194">The `null` clearly indicates that the record wasn't found.</span></span> <span data-ttu-id="bc891-195">Dans cet exemple, vous allez probablement modifier le type de retour de `Customer` en `Customer?` .</span><span class="sxs-lookup"><span data-stu-id="bc891-195">In this example, you'd likely change the return type from `Customer` to `Customer?`.</span></span> <span data-ttu-id="bc891-196">La déclaration de la valeur de retour en tant que type référence Nullable spécifie clairement l’objectif de cette API.</span><span class="sxs-lookup"><span data-stu-id="bc891-196">Declaring the return value as a nullable reference type specifies the intent of this API clearly.</span></span>

<span data-ttu-id="bc891-197">Pour les raisons couvertes par les [définitions génériques et la possibilité de valeur null](../../nullable-migration-strategies.md#generic-definitions-and-nullability) , cette technique ne fonctionne pas avec les méthodes génériques.</span><span class="sxs-lookup"><span data-stu-id="bc891-197">For reasons covered under [Generic definitions and nullability](../../nullable-migration-strategies.md#generic-definitions-and-nullability) that technique doesn't work with generic methods.</span></span> <span data-ttu-id="bc891-198">Vous pouvez avoir une méthode générique qui suit un modèle similaire :</span><span class="sxs-lookup"><span data-stu-id="bc891-198">You may have a generic method that follows a similar pattern:</span></span>

```csharp
public T Find<T>(IEnumerable<T> sequence, Func<T, bool> predicate)
```

<span data-ttu-id="bc891-199">Vous ne pouvez pas spécifier que la valeur de retour est `T?` .</span><span class="sxs-lookup"><span data-stu-id="bc891-199">You can't specify that the return value is `T?`.</span></span> <span data-ttu-id="bc891-200">La méthode retourne `null` lorsque l’élément recherché est introuvable.</span><span class="sxs-lookup"><span data-stu-id="bc891-200">The method returns `null` when the sought item isn't found.</span></span> <span data-ttu-id="bc891-201">Étant donné que vous ne pouvez pas déclarer un `T?` type de retour, vous ajoutez l' `MaybeNull` annotation à la méthode Return :</span><span class="sxs-lookup"><span data-stu-id="bc891-201">Since you can't declare a `T?` return type, you add the `MaybeNull` annotation to the method return:</span></span>

```csharp
[return: MaybeNull]
public T Find<T>(IEnumerable<T> sequence, Func<T, bool> predicate)
```

<span data-ttu-id="bc891-202">Le code précédent informe les appelants que le contrat implique un type non Nullable, mais la valeur de retour *peut* en fait être null.</span><span class="sxs-lookup"><span data-stu-id="bc891-202">The preceding code informs callers that the contract implies a non-nullable type, but the return value *may* actually be null.</span></span>  <span data-ttu-id="bc891-203">Utilisez l' `MaybeNull` attribut lorsque votre API doit être un type non Nullable, en général un paramètre de type générique, mais il peut y avoir des instances où `null` serait retourné.</span><span class="sxs-lookup"><span data-stu-id="bc891-203">Use the `MaybeNull` attribute when your API should be a non-nullable type, typically a generic type parameter, but there may be instances where `null` would be returned.</span></span>

<span data-ttu-id="bc891-204">Vous pouvez également spécifier qu’une valeur de retour ou `out` un `ref` argument ou n’est pas null bien que le type soit un type référence Nullable.</span><span class="sxs-lookup"><span data-stu-id="bc891-204">You can also specify that a return value or an `out` or `ref` argument isn't null even though the type is a nullable reference type.</span></span> <span data-ttu-id="bc891-205">Prenons l’exemple d’une méthode qui garantit qu’un tableau est suffisamment grand pour contenir un certain nombre d’éléments.</span><span class="sxs-lookup"><span data-stu-id="bc891-205">Consider a method that ensures an array is large enough to hold a number of elements.</span></span> <span data-ttu-id="bc891-206">Si l’argument d’entrée n’a pas de capacité, la routine alloue un nouveau tableau et copie tous les éléments existants dans celui-ci.</span><span class="sxs-lookup"><span data-stu-id="bc891-206">If the input argument doesn't have capacity, the routine would allocate a new array and copy all the existing elements into it.</span></span> <span data-ttu-id="bc891-207">Si l’argument d’entrée est `null` , la routine allouera un nouveau stockage.</span><span class="sxs-lookup"><span data-stu-id="bc891-207">If the input argument is `null`, the routine would allocate new storage.</span></span> <span data-ttu-id="bc891-208">Si la capacité est suffisante, la routine ne fait rien :</span><span class="sxs-lookup"><span data-stu-id="bc891-208">If there's sufficient capacity, the routine does nothing:</span></span>

```csharp
public void EnsureCapacity<T>(ref T[] storage, int size)
```

<span data-ttu-id="bc891-209">Vous pouvez appeler cette routine comme suit :</span><span class="sxs-lookup"><span data-stu-id="bc891-209">You could call this routine as follows:</span></span>

```csharp
// messages has the default value (null) when EnsureCapacity is called:
EnsureCapacity<string>(ref messages, 10);
// messages is not null.
EnsureCapacity<string>(messages, 50);
```

<span data-ttu-id="bc891-210">Après avoir activé les types référence null, vous souhaitez vous assurer que le code précédent se compile sans avertissements.</span><span class="sxs-lookup"><span data-stu-id="bc891-210">After enabling null reference types, you want to ensure that the preceding code compiles without warnings.</span></span> <span data-ttu-id="bc891-211">Lorsque la méthode retourne, l' `storage` argument est garanti comme non null.</span><span class="sxs-lookup"><span data-stu-id="bc891-211">When the method returns, the `storage` argument is guaranteed to be not null.</span></span> <span data-ttu-id="bc891-212">Toutefois, il est acceptable d’appeler `EnsureCapacity` avec une référence null.</span><span class="sxs-lookup"><span data-stu-id="bc891-212">However, it's acceptable to call `EnsureCapacity` with a null reference.</span></span> <span data-ttu-id="bc891-213">Vous pouvez créer `storage` un type référence Nullable et ajouter la `NotNull` condition postérieure à la déclaration du paramètre :</span><span class="sxs-lookup"><span data-stu-id="bc891-213">You can make `storage` a nullable reference type, and add the `NotNull` post-condition to the parameter declaration:</span></span>

```csharp
public void EnsureCapacity<T>([NotNull] ref T[]? storage, int size)
```

<span data-ttu-id="bc891-214">Le code précédent exprime clairement le contrat existant : les appelants peuvent passer une variable avec la `null` valeur, mais la valeur de retour est garantie pour ne jamais avoir la valeur null.</span><span class="sxs-lookup"><span data-stu-id="bc891-214">The preceding code expresses the existing contract clearly: Callers can pass a variable with the `null` value, but the return value is guaranteed to never be null.</span></span> <span data-ttu-id="bc891-215">L' `NotNull` attribut est particulièrement utile pour `ref` les `out` arguments et `null` , où peut être passé comme argument, mais que cet argument est garanti comme non NULL lorsque la méthode est retournée.</span><span class="sxs-lookup"><span data-stu-id="bc891-215">The `NotNull` attribute is most useful for `ref` and `out` arguments where `null` may be passed as an argument, but that argument is guaranteed to be not null when the method returns.</span></span>

<span data-ttu-id="bc891-216">Vous spécifiez des post-conditions inconditionnelles à l’aide des attributs suivants :</span><span class="sxs-lookup"><span data-stu-id="bc891-216">You specify unconditional postconditions using the following attributes:</span></span>

- <span data-ttu-id="bc891-217">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): une valeur de retour qui n’accepte pas les valeurs NULL peut être null.</span><span class="sxs-lookup"><span data-stu-id="bc891-217">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="bc891-218">[NOTNULL](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): une valeur de retour Nullable ne sera jamais null.</span><span class="sxs-lookup"><span data-stu-id="bc891-218">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>

## <a name="specify-conditional-post-conditions-notnullwhen-maybenullwhen-and-notnullifnotnull"></a><span data-ttu-id="bc891-219">Spécifier les conditions de publication conditionnelles : `NotNullWhen` , `MaybeNullWhen` et `NotNullIfNotNull`</span><span class="sxs-lookup"><span data-stu-id="bc891-219">Specify conditional post-conditions: `NotNullWhen`, `MaybeNullWhen`, and `NotNullIfNotNull`</span></span>

<span data-ttu-id="bc891-220">Vous êtes probablement familiarisé avec la `string` méthode <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="bc891-220">You're likely familiar with the `string` method <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType>.</span></span> <span data-ttu-id="bc891-221">Cette méthode retourne `true` lorsque l’argument a la valeur null ou est une chaîne vide.</span><span class="sxs-lookup"><span data-stu-id="bc891-221">This method returns `true` when the argument is null or an empty string.</span></span> <span data-ttu-id="bc891-222">Il s’agit d’une forme de contrôle de valeur NULL : les appelants n’ont pas besoin de vérifier la valeur null si la méthode retourne `false` .</span><span class="sxs-lookup"><span data-stu-id="bc891-222">It's a form of null-check: Callers don't need to null-check the argument if the method returns `false`.</span></span> <span data-ttu-id="bc891-223">Pour rendre une méthode comme cette prise en charge de Nullable, vous devez définir l’argument sur un type de référence Nullable et ajouter l' `NotNullWhen` attribut :</span><span class="sxs-lookup"><span data-stu-id="bc891-223">To make a method like this nullable aware, you'd set the argument to a nullable reference type, and add the `NotNullWhen` attribute:</span></span>

```csharp
bool IsNullOrEmpty([NotNullWhen(false)] string? value);
```

<span data-ttu-id="bc891-224">Cela indique au compilateur que tout code pour lequel la valeur de retour n’a `false` pas besoin de vérifications de valeur null.</span><span class="sxs-lookup"><span data-stu-id="bc891-224">That informs the compiler that any code where the return value is `false` doesn't need null checks.</span></span> <span data-ttu-id="bc891-225">L’ajout de l’attribut informe l’analyse statique du compilateur qui `IsNullOrEmpty` effectue la vérification de la valeur null nécessaire : lorsqu’il retourne `false` , l’argument d’entrée n’est pas `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-225">The addition of the attribute informs the compiler's static analysis that `IsNullOrEmpty` performs the necessary null check: when it returns `false`, the input argument isn't `null`.</span></span>

```csharp
string? userInput = GetUserInput();
if (!string.IsNullOrEmpty(userInput))
{
   int messageLength = userInput.Length; // no null check needed.
}
// null check needed on userInput here.
```

<span data-ttu-id="bc891-226">La <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType> méthode sera annotée comme indiqué ci-dessus pour .net Core 3,0.</span><span class="sxs-lookup"><span data-stu-id="bc891-226">The <xref:System.String.IsNullOrEmpty(System.String)?DisplayProperty=nameWithType> method will be annotated as shown above for .NET Core 3.0.</span></span> <span data-ttu-id="bc891-227">Vous pouvez avoir des méthodes similaires dans votre code base, qui vérifient l’état des objets pour les valeurs NULL.</span><span class="sxs-lookup"><span data-stu-id="bc891-227">You may have similar methods in your codebase that check the state of objects for null values.</span></span> <span data-ttu-id="bc891-228">Le compilateur ne reconnaîtra pas les méthodes de vérification null personnalisées, et vous devrez ajouter vous-même les annotations.</span><span class="sxs-lookup"><span data-stu-id="bc891-228">The compiler won't recognize custom null check methods, and you'll need to add the annotations yourself.</span></span> <span data-ttu-id="bc891-229">Lorsque vous ajoutez l’attribut, l’analyse statique du compilateur sait quand la variable testée a été vérifiée avec la valeur null.</span><span class="sxs-lookup"><span data-stu-id="bc891-229">When you add the attribute, the compiler's static analysis knows when the tested variable has been null checked.</span></span>

<span data-ttu-id="bc891-230">Une autre utilisation de ces attributs est le `Try*` modèle.</span><span class="sxs-lookup"><span data-stu-id="bc891-230">Another use for these attributes is the `Try*` pattern.</span></span> <span data-ttu-id="bc891-231">Les post-conditions pour les `ref` `out` variables et sont communiquées par le biais de la valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="bc891-231">The postconditions for `ref` and `out` variables are communicated through the return value.</span></span> <span data-ttu-id="bc891-232">Prenons l’exemple de cette méthode ci-dessus :</span><span class="sxs-lookup"><span data-stu-id="bc891-232">Consider this method shown earlier:</span></span>

```csharp
bool TryGetMessage(string key, out string message)
```

<span data-ttu-id="bc891-233">La méthode précédente suit un idiome .NET typique : la valeur de retour indique si `message` a été défini sur la valeur trouvée ou, si aucun message n’est trouvé, à la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="bc891-233">The preceding method follows a typical .NET idiom: the return value indicates if `message` was set to the found value or, if no message is found, to the default value.</span></span> <span data-ttu-id="bc891-234">Si la méthode retourne `true` , la valeur de `message` n’est pas NULL ; sinon, la méthode affecte la valeur `message` null.</span><span class="sxs-lookup"><span data-stu-id="bc891-234">If the method returns `true`, the value of `message` isn't null; otherwise, the method sets `message` to null.</span></span>

<span data-ttu-id="bc891-235">Vous pouvez communiquer cet idiome à l’aide de l' `NotNullWhen` attribut.</span><span class="sxs-lookup"><span data-stu-id="bc891-235">You can communicate that idiom using the `NotNullWhen` attribute.</span></span> <span data-ttu-id="bc891-236">Quand vous mettez à jour la signature pour les types de référence Nullable, créez `message` un `string?` et ajoutez un attribut :</span><span class="sxs-lookup"><span data-stu-id="bc891-236">When you update the signature for nullable reference types, make `message` a `string?` and add an attribute:</span></span>

```csharp
bool TryGetMessage(string key, [NotNullWhen(true)] out string? message)
```

<span data-ttu-id="bc891-237">Dans l’exemple précédent, la valeur de `message` est dite NOT NULL lorsque `TryGetMessage` retourne `true` .</span><span class="sxs-lookup"><span data-stu-id="bc891-237">In the preceding example, the value of `message` is known to be not null when `TryGetMessage` returns `true`.</span></span> <span data-ttu-id="bc891-238">Vous devez annoter des méthodes similaires dans votre code base de la même façon : les arguments peuvent être `null` , et sont connus pour ne pas avoir la valeur NULL lorsque la méthode est retournée `true` .</span><span class="sxs-lookup"><span data-stu-id="bc891-238">You should annotate similar methods in your codebase in the same way: the arguments could be `null`, and are known to be not null when the method returns `true`.</span></span>

<span data-ttu-id="bc891-239">Vous pouvez également avoir un attribut final.</span><span class="sxs-lookup"><span data-stu-id="bc891-239">There's one final attribute you may also need.</span></span> <span data-ttu-id="bc891-240">Parfois, l’État null d’une valeur de retour dépend de l’État null d’un ou plusieurs arguments d’entrée.</span><span class="sxs-lookup"><span data-stu-id="bc891-240">Sometimes the null state of a return value depends on the null state of one or more input arguments.</span></span> <span data-ttu-id="bc891-241">Ces méthodes retournent une valeur non null chaque fois que certains arguments d’entrée ne sont pas `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-241">These methods will return a non-null value whenever certain input arguments aren't `null`.</span></span> <span data-ttu-id="bc891-242">Pour annoter correctement ces méthodes, vous utilisez l' `NotNullIfNotNull` attribut.</span><span class="sxs-lookup"><span data-stu-id="bc891-242">To correctly annotate these methods, you use the `NotNullIfNotNull` attribute.</span></span> <span data-ttu-id="bc891-243">Considérez la méthode suivante :</span><span class="sxs-lookup"><span data-stu-id="bc891-243">Consider the following method:</span></span>

```csharp
string GetTopLevelDomainFromFullUrl(string url);
```

<span data-ttu-id="bc891-244">Si l' `url` argument n’est pas null, la sortie n’est pas `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-244">If the `url` argument isn't null, the output isn't `null`.</span></span> <span data-ttu-id="bc891-245">Une fois que les références Nullable sont activées, cette signature fonctionne correctement, à condition que votre API n’accepte jamais une entrée null.</span><span class="sxs-lookup"><span data-stu-id="bc891-245">Once nullable references are enabled, that signature works correctly, provided your API never accepts a null input.</span></span> <span data-ttu-id="bc891-246">Toutefois, si l’entrée peut être null, la valeur de retour peut également être null.</span><span class="sxs-lookup"><span data-stu-id="bc891-246">However, if the input could be null, then return value could also be null.</span></span> <span data-ttu-id="bc891-247">Vous pouvez remplacer la signature par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="bc891-247">You could change the signature to the following code:</span></span>

```csharp
string? GetTopLevelDomainFromFullUrl(string? url);
```

<span data-ttu-id="bc891-248">Cela fonctionne également, mais obligent souvent les appelants à implémenter des `null` vérifications supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="bc891-248">That also works, but will often force callers to implement extra `null` checks.</span></span> <span data-ttu-id="bc891-249">Le contrat est que la valeur de retour serait `null` uniquement lorsque l’argument d’entrée `url` est `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-249">The contract is that the return value would be `null` only when the input argument `url` is `null`.</span></span> <span data-ttu-id="bc891-250">Pour exprimer ce contrat, vous devez annoter cette méthode comme indiqué dans le code suivant :</span><span class="sxs-lookup"><span data-stu-id="bc891-250">To express that contract, you would annotate this method as shown in the following code:</span></span>

```csharp
[return: NotNullIfNotNull("url")]
string? GetTopLevelDomainFromFullUrl(string? url);
```

<span data-ttu-id="bc891-251">La valeur de retour et l’argument ont tous deux été annotés avec le `?` qui indique que peut être `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-251">The return value and the argument have both been annotated with the `?` indicating that either could be `null`.</span></span> <span data-ttu-id="bc891-252">L’attribut clarifie davantage que la valeur de retour n’est pas NULL lorsque l' `url` argument n’est pas `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-252">The attribute further clarifies that the return value won't be null when the `url` argument isn't `null`.</span></span>

<span data-ttu-id="bc891-253">Vous spécifiez des post-conditions conditionnelles à l’aide des attributs suivants :</span><span class="sxs-lookup"><span data-stu-id="bc891-253">You specify conditional postconditions using these attributes:</span></span>

- <span data-ttu-id="bc891-254">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): un argument d’entrée qui n’accepte pas les valeurs NULL peut être NULL lorsque la méthode retourne la `bool` valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="bc891-254">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="bc891-255">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): un argument d’entrée Nullable ne sera pas NULL lorsque la méthode retourne la `bool` valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="bc891-255">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument won't be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="bc891-256">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): une valeur de retour n’est pas null si l’argument d’entrée pour le paramètre spécifié n’est pas null.</span><span class="sxs-lookup"><span data-stu-id="bc891-256">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the input argument for the specified parameter isn't null.</span></span>

## <a name="constructor-helper-methods-membernotnull-and-membernotnullwhen"></a><span data-ttu-id="bc891-257">Méthodes d’assistance du constructeur : `MemberNotNull` et `MemberNotNullWhen`</span><span class="sxs-lookup"><span data-stu-id="bc891-257">Constructor helper methods: `MemberNotNull` and `MemberNotNullWhen`</span></span>

<span data-ttu-id="bc891-258">Ces attributs spécifient votre intention lorsque vous avez refactorisé du code commun à partir de constructeurs dans des méthodes d’assistance.</span><span class="sxs-lookup"><span data-stu-id="bc891-258">These attributes specify your intent when you've refactored common code from constructors into helper methods.</span></span> <span data-ttu-id="bc891-259">Le compilateur C# analyse les constructeurs et les initialiseurs de champ pour s’assurer que tous les champs de référence non Nullable ont été initialisés avant le retour de chaque constructeur.</span><span class="sxs-lookup"><span data-stu-id="bc891-259">The C# compiler analyzes constructors and field initializers to make sure that all non-nullable reference fields have been initialized before each constructor returns.</span></span> <span data-ttu-id="bc891-260">Toutefois, le compilateur C# n’effectue pas le suivi des assignations de champs par toutes les méthodes d’assistance.</span><span class="sxs-lookup"><span data-stu-id="bc891-260">However, the C# compiler doesn't track field assignments through all helper methods.</span></span> <span data-ttu-id="bc891-261">Le compilateur émet `CS8618` un avertissement lorsque les champs ne sont pas initialisés directement dans le constructeur, mais plutôt dans une méthode d’assistance.</span><span class="sxs-lookup"><span data-stu-id="bc891-261">The compiler issues warning `CS8618` when fields aren't initialized directly in the constructor, but rather in a helper method.</span></span> <span data-ttu-id="bc891-262">Vous ajoutez <xref:System.Diagnostics.CodeAnalysis.MemberNotNullAttribute> à une déclaration de méthode aux champs qui sont initialisés à une valeur non null dans la méthode.</span><span class="sxs-lookup"><span data-stu-id="bc891-262">You add the <xref:System.Diagnostics.CodeAnalysis.MemberNotNullAttribute> to a method declaration to fields that are initialized to a non-null value in the method.</span></span> <span data-ttu-id="bc891-263">Considérez l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="bc891-263">For example, consider the following example:</span></span>

:::code language="csharp" source="snippets/InitializeMembers.cs" ID="MemberNotNullExample":::

<span data-ttu-id="bc891-264">Vous pouvez spécifier plusieurs noms de champs comme arguments pour le `MemberNotNull` constructeur d’attribut.</span><span class="sxs-lookup"><span data-stu-id="bc891-264">You can specify multiple field names as arguments to the `MemberNotNull` attribute constructor.</span></span>

<span data-ttu-id="bc891-265"><xref:System.Diagnostics.CodeAnalysis.MemberNotNullWhenAttribute>A un `bool` argument.</span><span class="sxs-lookup"><span data-stu-id="bc891-265">The <xref:System.Diagnostics.CodeAnalysis.MemberNotNullWhenAttribute> has a `bool` argument.</span></span> <span data-ttu-id="bc891-266">Vous utilisez `MemberNotNullWhen` dans les cas où votre méthode d’assistance retourne un `bool` qui indique si votre méthode d’assistance a initialisé des champs.</span><span class="sxs-lookup"><span data-stu-id="bc891-266">You use `MemberNotNullWhen` in situations where your helper method returns a `bool` indicating whether your helper method initialized fields.</span></span>

## <a name="verify-unreachable-code"></a><span data-ttu-id="bc891-267">Vérifier le code inaccessible</span><span class="sxs-lookup"><span data-stu-id="bc891-267">Verify unreachable code</span></span>

<span data-ttu-id="bc891-268">Certaines méthodes, généralement des applications d’assistance d’exception ou d’autres méthodes utilitaires, se ferment toujours en levant une exception.</span><span class="sxs-lookup"><span data-stu-id="bc891-268">Some methods, typically exception helpers or other utility methods, always exit by throwing an exception.</span></span> <span data-ttu-id="bc891-269">Ou bien, une application d’assistance peut lever une exception en fonction de la valeur d’un argument booléen.</span><span class="sxs-lookup"><span data-stu-id="bc891-269">Or, a helper may throw an exception based on the value of a Boolean argument.</span></span>

<span data-ttu-id="bc891-270">Dans le premier cas, vous pouvez ajouter l' `DoesNotReturn` attribut à la déclaration de méthode.</span><span class="sxs-lookup"><span data-stu-id="bc891-270">In the first case, you can add the `DoesNotReturn` attribute to the method declaration.</span></span> <span data-ttu-id="bc891-271">Le compilateur vous aide de trois façons.</span><span class="sxs-lookup"><span data-stu-id="bc891-271">The compiler helps you in three ways.</span></span> <span data-ttu-id="bc891-272">Tout d’abord, le compilateur émet un avertissement s’il y a un chemin d’accès où la méthode peut se fermer sans lever d’exception.</span><span class="sxs-lookup"><span data-stu-id="bc891-272">First, the compiler issues a warning if there's a path where the method can exit without throwing an exception.</span></span> <span data-ttu-id="bc891-273">Deuxièmement, le compilateur marque tout code après un appel à cette méthode comme étant *inaccessible*, jusqu’à ce qu’une `catch` clause appropriée soit trouvée.</span><span class="sxs-lookup"><span data-stu-id="bc891-273">Second, the compiler marks any code after a call to that method as *unreachable*, until an appropriate `catch` clause is found.</span></span> <span data-ttu-id="bc891-274">Troisièmement, le code inaccessible n’affecte pas les États null.</span><span class="sxs-lookup"><span data-stu-id="bc891-274">Third, the unreachable code won't affect any null states.</span></span> <span data-ttu-id="bc891-275">Prenons la méthode suivante :</span><span class="sxs-lookup"><span data-stu-id="bc891-275">Consider this method:</span></span>

```csharp
[DoesNotReturn]
private void FailFast()
{
    throw new InvalidOperationException();
}

public void SetState(object containedField)
{
    if (!isInitialized)
    {
        FailFast();
    }

    // unreachable code:
    _field = containedField;
}
```

<span data-ttu-id="bc891-276">Dans le deuxième cas, vous ajoutez l' `DoesNotReturnIf` attribut à un paramètre booléen de la méthode.</span><span class="sxs-lookup"><span data-stu-id="bc891-276">In the second case, you add the `DoesNotReturnIf` attribute to a Boolean parameter of the method.</span></span> <span data-ttu-id="bc891-277">Vous pouvez modifier l’exemple précédent comme suit :</span><span class="sxs-lookup"><span data-stu-id="bc891-277">You can modify the previous example as follows:</span></span>

```csharp
private void FailFast([DoesNotReturnIf(false)] bool isValid)
{
    if (!isValid)
    {
        throw new InvalidOperationException();
    }
}

public void SetState(object containedField)
{
    FailFast(isInitialized);

    // unreachable code when "isInitialized" is false:
    _field = containedField;
}
```

## <a name="summary"></a><span data-ttu-id="bc891-278">Résumé</span><span class="sxs-lookup"><span data-stu-id="bc891-278">Summary</span></span>

[!INCLUDE [C# version alert](../../includes/csharp-version-alert.md)]

<span data-ttu-id="bc891-279">L’ajout de types de référence Nullable fournit un vocabulaire initial pour décrire les attentes des API pour les variables qui pourraient être `null` .</span><span class="sxs-lookup"><span data-stu-id="bc891-279">Adding nullable reference types provides an initial vocabulary to describe your APIs expectations for variables that could be `null`.</span></span> <span data-ttu-id="bc891-280">Les attributs fournissent un vocabulaire plus riche pour décrire l’État null des variables en tant que conditions préalables et post-conditions.</span><span class="sxs-lookup"><span data-stu-id="bc891-280">The attributes provide a richer vocabulary to describe the null state of variables as preconditions and postconditions.</span></span> <span data-ttu-id="bc891-281">Ces attributs décrivent plus clairement vos attentes et offrent une meilleure expérience aux développeurs qui utilisent vos API.</span><span class="sxs-lookup"><span data-stu-id="bc891-281">These attributes more clearly describe your expectations and provide a better experience for the developers using your APIs.</span></span>

<span data-ttu-id="bc891-282">Lorsque vous mettez à jour des bibliothèques pour un contexte Nullable, ajoutez ces attributs pour guider les utilisateurs de vos API vers l’utilisation correcte.</span><span class="sxs-lookup"><span data-stu-id="bc891-282">As you update libraries for a nullable context, add these attributes to guide users of your APIs to the correct usage.</span></span> <span data-ttu-id="bc891-283">Ces attributs vous aident à décrire complètement l’État null des arguments d’entrée et les valeurs de retour :</span><span class="sxs-lookup"><span data-stu-id="bc891-283">These attributes help you fully describe the null-state of input arguments and return values:</span></span>

- <span data-ttu-id="bc891-284">[AllowNull a](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): un argument d’entrée qui n’accepte pas les valeurs NULL peut être null.</span><span class="sxs-lookup"><span data-stu-id="bc891-284">[AllowNull](xref:System.Diagnostics.CodeAnalysis.AllowNullAttribute): A non-nullable input argument may be null.</span></span>
- <span data-ttu-id="bc891-285">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): un argument d’entrée Nullable ne doit jamais avoir la valeur null.</span><span class="sxs-lookup"><span data-stu-id="bc891-285">[DisallowNull](xref:System.Diagnostics.CodeAnalysis.DisallowNullAttribute): A nullable input argument should never be null.</span></span>
- <span data-ttu-id="bc891-286">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): une valeur de retour qui n’accepte pas les valeurs NULL peut être null.</span><span class="sxs-lookup"><span data-stu-id="bc891-286">[MaybeNull](xref:System.Diagnostics.CodeAnalysis.MaybeNullAttribute): A non-nullable return value may be null.</span></span>
- <span data-ttu-id="bc891-287">[NOTNULL](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): une valeur de retour Nullable ne sera jamais null.</span><span class="sxs-lookup"><span data-stu-id="bc891-287">[NotNull](xref:System.Diagnostics.CodeAnalysis.NotNullAttribute): A nullable return value will never be null.</span></span>
- <span data-ttu-id="bc891-288">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): un argument d’entrée qui n’accepte pas les valeurs NULL peut être NULL lorsque la méthode retourne la `bool` valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="bc891-288">[MaybeNullWhen](xref:System.Diagnostics.CodeAnalysis.MaybeNullWhenAttribute): A non-nullable input argument may be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="bc891-289">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): un argument d’entrée Nullable ne sera pas NULL lorsque la méthode retourne la `bool` valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="bc891-289">[NotNullWhen](xref:System.Diagnostics.CodeAnalysis.NotNullWhenAttribute): A nullable input argument won't be null when the method returns the specified `bool` value.</span></span>
- <span data-ttu-id="bc891-290">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): une valeur de retour n’est pas null si l’argument d’entrée pour le paramètre spécifié n’est pas null.</span><span class="sxs-lookup"><span data-stu-id="bc891-290">[NotNullIfNotNull](xref:System.Diagnostics.CodeAnalysis.NotNullIfNotNullAttribute): A return value isn't null if the input argument for the specified parameter isn't null.</span></span>
- <span data-ttu-id="bc891-291">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): une méthode ne retourne jamais.</span><span class="sxs-lookup"><span data-stu-id="bc891-291">[DoesNotReturn](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnAttribute): A method never returns.</span></span> <span data-ttu-id="bc891-292">En d’autres termes, elle lève toujours une exception.</span><span class="sxs-lookup"><span data-stu-id="bc891-292">In other words, it always throws an exception.</span></span>
- <span data-ttu-id="bc891-293">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): cette méthode ne retourne jamais si le `bool` paramètre associé a la valeur spécifiée.</span><span class="sxs-lookup"><span data-stu-id="bc891-293">[DoesNotReturnIf](xref:System.Diagnostics.CodeAnalysis.DoesNotReturnIfAttribute): This method never returns if the associated `bool` parameter has the specified value.</span></span>

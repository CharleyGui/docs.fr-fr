---
title: Programmation orientée objet (C#)
description: C# fournit une prise en charge complète de la programmation orientée objet, notamment l’abstraction, l’encapsulation, l’héritage et le polymorphisme.
ms.date: 09/30/2020
ms.openlocfilehash: 6e0155621be544b01453b8c107debb3a9b6c38f9
ms.sourcegitcommit: e078b7540a8293ca1b604c9c0da1ff1506f0170b
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/13/2020
ms.locfileid: "91997663"
---
# <a name="object-oriented-programming-c"></a><span data-ttu-id="eea0c-103">Programmation Object-Oriented (C#)</span><span class="sxs-lookup"><span data-stu-id="eea0c-103">Object-Oriented programming (C#)</span></span>

<span data-ttu-id="eea0c-104">C# est un langage orienté objet.</span><span class="sxs-lookup"><span data-stu-id="eea0c-104">C# is an object-oriented language.</span></span> <span data-ttu-id="eea0c-105">Quatre des techniques clés utilisées dans la programmation orientée objet sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="eea0c-105">Four of the key techniques used in object-oriented programming are:</span></span>

- <span data-ttu-id="eea0c-106">L' *abstraction* signifie masquer les détails inutiles des consommateurs de type.</span><span class="sxs-lookup"><span data-stu-id="eea0c-106">*Abstraction* means hiding the unnecessary details from type consumers.</span></span>
- <span data-ttu-id="eea0c-107">L’*encapsulation* signifie qu’un groupe de propriétés, méthodes et autres membres corrélés est traité comme une unité ou un objet unique.</span><span class="sxs-lookup"><span data-stu-id="eea0c-107">*Encapsulation* means that a group of related properties, methods, and other members are treated as a single unit or object.</span></span>
- <span data-ttu-id="eea0c-108">L’*héritage* décrit la possibilité de créer des classes à partir d’une classe existante.</span><span class="sxs-lookup"><span data-stu-id="eea0c-108">*Inheritance* describes the ability to create new classes based on an existing class.</span></span>
- <span data-ttu-id="eea0c-109">Le *polymorphisme* signifie que plusieurs classes peuvent être utilisées de manière interchangeable, même si chacune des classes implémente les mêmes propriétés ou méthodes de manière différente.</span><span class="sxs-lookup"><span data-stu-id="eea0c-109">*Polymorphism* means that you can have multiple classes that can be used interchangeably, even though each class implements the same properties or methods in different ways.</span></span>

<span data-ttu-id="eea0c-110">Dans le didacticiel précédent, [Introduction aux classes](introduction-to-classes.md) , vous avez vu l' *abstraction* et l' *encapsulation*.</span><span class="sxs-lookup"><span data-stu-id="eea0c-110">In the preceding tutorial, [introduction to classes](introduction-to-classes.md) you saw both *abstraction* and *encapsulation*.</span></span> <span data-ttu-id="eea0c-111">La `BankAccount` classe a fourni une abstraction pour le concept d’un compte bancaire.</span><span class="sxs-lookup"><span data-stu-id="eea0c-111">The `BankAccount` class provided an abstraction for the concept of a bank account.</span></span> <span data-ttu-id="eea0c-112">Vous pouvez modifier son implémentation sans affecter le code qui a utilisé la `BankAccount` classe.</span><span class="sxs-lookup"><span data-stu-id="eea0c-112">You could modify its implementation without affecting any of the code that used the `BankAccount` class.</span></span> <span data-ttu-id="eea0c-113">Les `BankAccount` classes et `Transaction` fournissent toutes deux l’encapsulation des composants nécessaires à la description de ces concepts dans le code.</span><span class="sxs-lookup"><span data-stu-id="eea0c-113">Both the `BankAccount` and `Transaction` classes provide encapsulation of the components needed to describe those concepts in code.</span></span>

<span data-ttu-id="eea0c-114">Dans ce didacticiel, vous allez étendre cette application pour utiliser *l’héritage* et le *polymorphisme* pour ajouter de nouvelles fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="eea0c-114">In this tutorial, you'll extend that application to make use of *inheritance* and *polymorphism* to add new features.</span></span> <span data-ttu-id="eea0c-115">Vous ajouterez également des fonctionnalités à la `BankAccount` classe, en tirant parti des techniques d' *abstraction* et d' *encapsulation* que vous avez apprises dans le didacticiel précédent.</span><span class="sxs-lookup"><span data-stu-id="eea0c-115">You'll also add features to the `BankAccount` class, taking advantage of the *abstraction* and *encapsulation* techniques you learned in the preceding tutorial.</span></span>

## <a name="create-different-types-of-accounts"></a><span data-ttu-id="eea0c-116">Créer différents types de comptes</span><span class="sxs-lookup"><span data-stu-id="eea0c-116">Create different types of accounts</span></span>

<span data-ttu-id="eea0c-117">Une fois ce programme créé, vous recevez des demandes d’ajout de fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="eea0c-117">After building this program, you get requests to add features to it.</span></span> <span data-ttu-id="eea0c-118">Il fonctionne très bien dans le cas où il n’existe qu’un seul type de compte bancaire.</span><span class="sxs-lookup"><span data-stu-id="eea0c-118">It works great in the situation where there is only one bank account type.</span></span> <span data-ttu-id="eea0c-119">Au fil du temps, des besoins changent et des types de compte associés sont demandés :</span><span class="sxs-lookup"><span data-stu-id="eea0c-119">Over time, needs change, and related account types are requested:</span></span>

- <span data-ttu-id="eea0c-120">Un compte d’intérêt qui accumule des intérêts à la fin de chaque mois.</span><span class="sxs-lookup"><span data-stu-id="eea0c-120">An interest earning account that accrues interest at the end of each month.</span></span>
- <span data-ttu-id="eea0c-121">Une ligne de crédit qui peut avoir un solde négatif, mais lorsqu’il y a un solde, des frais sont facturés chaque mois.</span><span class="sxs-lookup"><span data-stu-id="eea0c-121">A line of credit that can have a negative balance, but when there's a balance, there's an interest charge each month.</span></span>
- <span data-ttu-id="eea0c-122">Un compte de carte cadeau prépayé qui commence par un dépôt unique et qui ne peut être payé.</span><span class="sxs-lookup"><span data-stu-id="eea0c-122">A pre-paid gift card account that starts with a single deposit, and only can be paid off.</span></span> <span data-ttu-id="eea0c-123">Il peut être rerempli une fois au début de chaque mois.</span><span class="sxs-lookup"><span data-stu-id="eea0c-123">It can be refilled once at the start of each month.</span></span>

<span data-ttu-id="eea0c-124">Tous ces comptes différents sont similaires à ceux de `BankAccount` la classe définie dans le didacticiel précédent.</span><span class="sxs-lookup"><span data-stu-id="eea0c-124">All of these different accounts are similar to `BankAccount` class defined in the earlier tutorial.</span></span> <span data-ttu-id="eea0c-125">Vous pouvez copier ce code, renommer les classes et apporter des modifications.</span><span class="sxs-lookup"><span data-stu-id="eea0c-125">You could copy that code, rename the classes, and make modifications.</span></span> <span data-ttu-id="eea0c-126">Cette technique peut fonctionner à long terme, mais elle serait plus de travail au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="eea0c-126">That technique would work in the short term, but it would be more work over time.</span></span> <span data-ttu-id="eea0c-127">Toutes les modifications sont copiées dans toutes les classes affectées.</span><span class="sxs-lookup"><span data-stu-id="eea0c-127">Any changes would be copied across all the affected classes.</span></span>

<span data-ttu-id="eea0c-128">Au lieu de cela, vous pouvez créer des types de comptes bancaires qui héritent des méthodes et des données de la `BankAccount` classe créée dans le didacticiel précédent.</span><span class="sxs-lookup"><span data-stu-id="eea0c-128">Instead, you can create new bank account types that inherit methods and data from the `BankAccount` class created in the preceding tutorial.</span></span> <span data-ttu-id="eea0c-129">Ces nouvelles classes peuvent étendre la `BankAccount` classe avec le comportement spécifique requis pour chaque type :</span><span class="sxs-lookup"><span data-stu-id="eea0c-129">These new classes can extend the `BankAccount` class with the specific behavior needed for each type:</span></span>

```csharp
public class InterestEarningAccount : BankAccount
{
}

public class LineOfCreditAccount : BankAccount
{
}

public class GiftCardAccount : BankAccount
{
}
```

<span data-ttu-id="eea0c-130">Chacune de ces classes *hérite* du comportement partagé de sa *classe de base*partagée, la `BankAccount` classe.</span><span class="sxs-lookup"><span data-stu-id="eea0c-130">Each of these classes *inherits* the shared behavior from their shared *base class*, the `BankAccount` class.</span></span> <span data-ttu-id="eea0c-131">Écrivez les implémentations pour les fonctionnalités nouvelles et différentes dans chacune des *classes dérivées*.</span><span class="sxs-lookup"><span data-stu-id="eea0c-131">Write the implementations for new and different functionality in each of the *derived classes*.</span></span>  <span data-ttu-id="eea0c-132">Ces classes dérivées ont déjà tout le comportement défini dans la `BankAccount` classe.</span><span class="sxs-lookup"><span data-stu-id="eea0c-132">These derived classes already have all the behavior defined in the `BankAccount` class.</span></span>

<span data-ttu-id="eea0c-133">Il est recommandé de créer chaque nouvelle classe dans un fichier source différent.</span><span class="sxs-lookup"><span data-stu-id="eea0c-133">It's a good practice to create each new class in a different source file.</span></span> <span data-ttu-id="eea0c-134">Dans [Visual Studio](https://visualstudio.com), vous pouvez cliquer avec le bouton droit sur le projet, puis sélectionner *Ajouter une classe* pour ajouter une nouvelle classe dans un nouveau fichier.</span><span class="sxs-lookup"><span data-stu-id="eea0c-134">In [Visual Studio](https://visualstudio.com), you can right-click on the project, and select *add class* to add a new class in a new file.</span></span> <span data-ttu-id="eea0c-135">Dans [Visual Studio code](https://code.visualstudio.com), sélectionnez *fichier* , puis *nouveau* pour créer un nouveau fichier source.</span><span class="sxs-lookup"><span data-stu-id="eea0c-135">In [Visual Studio Code](https://code.visualstudio.com), select *File* then *New* to create a new source file.</span></span> <span data-ttu-id="eea0c-136">Dans l’un ou l’autre des outils, nommez le fichier pour qu’il corresponde à la classe : *InterestEarningAccount.cs*, *LineOfCreditAccount.cs*et *GiftCardAccount.cs*.</span><span class="sxs-lookup"><span data-stu-id="eea0c-136">In either tool, name the file to match the class: *InterestEarningAccount.cs*, *LineOfCreditAccount.cs*, and *GiftCardAccount.cs*.</span></span>

<span data-ttu-id="eea0c-137">Lorsque vous créez les classes comme indiqué dans l’exemple précédent, vous découvrirez qu’aucune de vos classes dérivées n’est compilée.</span><span class="sxs-lookup"><span data-stu-id="eea0c-137">When you create the classes as shown in the preceding sample, you'll find that none of your derived classes compile.</span></span> <span data-ttu-id="eea0c-138">Un constructeur est chargé d’initialiser un objet.</span><span class="sxs-lookup"><span data-stu-id="eea0c-138">A constructor is responsible for initializing an object.</span></span> <span data-ttu-id="eea0c-139">Un constructeur de classe dérivée doit initialiser la classe dérivée et fournir des instructions sur la façon d’initialiser l’objet de classe de base inclus dans la classe dérivée.</span><span class="sxs-lookup"><span data-stu-id="eea0c-139">A derived class constructor must initialize the derived class, and provide instructions on how to initialize the base class object included in the derived class.</span></span> <span data-ttu-id="eea0c-140">L’initialisation appropriée se produit normalement sans code supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="eea0c-140">The proper initialization normally happens without any extra code.</span></span> <span data-ttu-id="eea0c-141">La `BankAccount` classe déclare un constructeur public avec la signature suivante :</span><span class="sxs-lookup"><span data-stu-id="eea0c-141">The `BankAccount` class declares one public constructor with the following signature:</span></span>

```csharp
public BankAccount(string name, decimal initialBalance)
```

<span data-ttu-id="eea0c-142">Le compilateur ne génère pas de constructeur par défaut lorsque vous définissez un constructeur vous-même.</span><span class="sxs-lookup"><span data-stu-id="eea0c-142">The compiler doesn't generate a default constructor when you define a constructor yourself.</span></span> <span data-ttu-id="eea0c-143">Cela signifie que chaque classe dérivée doit appeler explicitement ce constructeur.</span><span class="sxs-lookup"><span data-stu-id="eea0c-143">That means each derived class must explicitly call this constructor.</span></span> <span data-ttu-id="eea0c-144">Vous déclarez un constructeur qui peut passer des arguments au constructeur de classe de base.</span><span class="sxs-lookup"><span data-stu-id="eea0c-144">You declare a constructor that can pass arguments to the base class constructor.</span></span>  <span data-ttu-id="eea0c-145">Le code suivant illustre le constructeur pour `InterestEarningAccount` :</span><span class="sxs-lookup"><span data-stu-id="eea0c-145">The following code shows the constructor for the `InterestEarningAccount`:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/InterestEarningAccount.cs" ID="DerivedConstructor":::

<span data-ttu-id="eea0c-146">Les paramètres de ce nouveau constructeur correspondent au type de paramètre et aux noms du constructeur de classe de base.</span><span class="sxs-lookup"><span data-stu-id="eea0c-146">The parameters to this new constructor match the parameter type and names of the base class constructor.</span></span> <span data-ttu-id="eea0c-147">Vous utilisez la `: base()` syntaxe pour indiquer un appel à un constructeur de classe de base.</span><span class="sxs-lookup"><span data-stu-id="eea0c-147">You use the `: base()` syntax to indicate a call to a base class constructor.</span></span> <span data-ttu-id="eea0c-148">Certaines classes définissent plusieurs constructeurs, et cette syntaxe vous permet de choisir le constructeur de classe de base que vous appelez.</span><span class="sxs-lookup"><span data-stu-id="eea0c-148">Some classes define multiple constructors, and this syntax enables you to pick which base class constructor you call.</span></span> <span data-ttu-id="eea0c-149">Une fois que vous avez mis à jour les constructeurs, vous pouvez développer le code de chacune des classes dérivées.</span><span class="sxs-lookup"><span data-stu-id="eea0c-149">Once you've updated the constructors, you can develop the code for each of the derived classes.</span></span> <span data-ttu-id="eea0c-150">La configuration requise pour les nouvelles classes peut être indiquée comme suit :</span><span class="sxs-lookup"><span data-stu-id="eea0c-150">The requirements for the new classes can be stated as follows:</span></span>

- <span data-ttu-id="eea0c-151">Compte de bénéfices intéressants :</span><span class="sxs-lookup"><span data-stu-id="eea0c-151">An interest earning account:</span></span>
  - <span data-ttu-id="eea0c-152">Obtient un crédit de 2% du solde de fin de mois.</span><span class="sxs-lookup"><span data-stu-id="eea0c-152">Will get a credit of 2% of the month-ending-balance.</span></span>
- <span data-ttu-id="eea0c-153">Une ligne de crédit :</span><span class="sxs-lookup"><span data-stu-id="eea0c-153">A line of credit:</span></span>
  - <span data-ttu-id="eea0c-154">Peut avoir un solde négatif, mais pas une valeur absolue supérieure à la limite de crédit.</span><span class="sxs-lookup"><span data-stu-id="eea0c-154">Can have a negative balance, but not be greater in absolute value than the credit limit.</span></span>
  - <span data-ttu-id="eea0c-155">Entraînera un montant de frais pour les intérêts chaque mois où le solde de fin de mois n’est pas égal à 0.</span><span class="sxs-lookup"><span data-stu-id="eea0c-155">Will incur an interest charge each month where the end of month balance isn't 0.</span></span>
  - <span data-ttu-id="eea0c-156">Est facturé pour chaque retrait qui dépasse la limite de crédit.</span><span class="sxs-lookup"><span data-stu-id="eea0c-156">Will incur a fee on each withdrawal that goes over the credit limit.</span></span>
- <span data-ttu-id="eea0c-157">Un compte de carte cadeau :</span><span class="sxs-lookup"><span data-stu-id="eea0c-157">A gift card account:</span></span>
  - <span data-ttu-id="eea0c-158">Peut être rerempli avec un montant spécifié une fois par mois, le dernier jour du mois.</span><span class="sxs-lookup"><span data-stu-id="eea0c-158">Can be refilled with a specified amount once each month, on the last day of the month.</span></span>

<span data-ttu-id="eea0c-159">Vous pouvez voir que ces trois types de compte ont une action qui a lieu à la fin de chaque mois.</span><span class="sxs-lookup"><span data-stu-id="eea0c-159">You can see that all three of these account types have an action that takes places at the end of each month.</span></span> <span data-ttu-id="eea0c-160">Toutefois, chaque type de compte effectue des tâches différentes.</span><span class="sxs-lookup"><span data-stu-id="eea0c-160">However, each account type does different tasks.</span></span> <span data-ttu-id="eea0c-161">Vous utilisez le *polymorphisme* pour implémenter ce code.</span><span class="sxs-lookup"><span data-stu-id="eea0c-161">You use *polymorphism* to implement this code.</span></span> <span data-ttu-id="eea0c-162">Créez une `virtual` méthode unique dans la `BankAccount` classe :</span><span class="sxs-lookup"><span data-stu-id="eea0c-162">Create a single `virtual` method in the `BankAccount` class:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/BankAccount.cs" ID="DeclareMonthEndTransactions":::

<span data-ttu-id="eea0c-163">Le code précédent montre comment utiliser le `virtual` mot clé pour déclarer une méthode dans la classe de base qu’une classe dérivée peut fournir une implémentation différente pour.</span><span class="sxs-lookup"><span data-stu-id="eea0c-163">The preceding code shows how you use the `virtual` keyword to declare a method in the base class that a derived class may provide a different implementation for.</span></span> <span data-ttu-id="eea0c-164">Une `virtual` méthode est une méthode dans laquelle toute classe dérivée peut choisir de réimplémenter.</span><span class="sxs-lookup"><span data-stu-id="eea0c-164">A `virtual` method is a method where any derived class may choose to reimplement.</span></span> <span data-ttu-id="eea0c-165">Les classes dérivées utilisent le `override` mot clé pour définir la nouvelle implémentation.</span><span class="sxs-lookup"><span data-stu-id="eea0c-165">The derived classes use the `override` keyword to define the new implementation.</span></span> <span data-ttu-id="eea0c-166">En général, vous faites référence à ceci comme « substitution de l’implémentation de la classe de base ».</span><span class="sxs-lookup"><span data-stu-id="eea0c-166">Typically you refer to this as "overriding the base class implementation".</span></span> <span data-ttu-id="eea0c-167">Le `virtual` mot clé spécifie que les classes dérivées peuvent substituer le comportement.</span><span class="sxs-lookup"><span data-stu-id="eea0c-167">The `virtual` keyword specifies that derived classes may override the behavior.</span></span> <span data-ttu-id="eea0c-168">Vous pouvez également déclarer `abstract` des méthodes dans lesquelles les classes dérivées doivent remplacer le comportement.</span><span class="sxs-lookup"><span data-stu-id="eea0c-168">You can also declare `abstract` methods where derived classes must override the behavior.</span></span> <span data-ttu-id="eea0c-169">La classe de base ne fournit pas d’implémentation pour une `abstract` méthode.</span><span class="sxs-lookup"><span data-stu-id="eea0c-169">The base class does not provide an implementation for an `abstract` method.</span></span> <span data-ttu-id="eea0c-170">Ensuite, vous devez définir l’implémentation de deux des nouvelles classes que vous avez créées.</span><span class="sxs-lookup"><span data-stu-id="eea0c-170">Next, you need to define the implementation for two of the new classes you've created.</span></span> <span data-ttu-id="eea0c-171">Commencez par le `InterestEarningAccount` :</span><span class="sxs-lookup"><span data-stu-id="eea0c-171">Start with the `InterestEarningAccount`:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/InterestEarningAccount.cs" ID="ApplyMonthendInterest":::

<span data-ttu-id="eea0c-172">Ajoutez le code suivant au `LineOfCreditAccount` .</span><span class="sxs-lookup"><span data-stu-id="eea0c-172">Add the following code to the `LineOfCreditAccount`.</span></span> <span data-ttu-id="eea0c-173">Le code inverse le solde pour calculer un montant positif qui est retiré du compte :</span><span class="sxs-lookup"><span data-stu-id="eea0c-173">The code negates the balance to compute a positive interest charge that is withdrawn from the account:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/LineOfCreditAccount.cs" ID="ApplyMonthendInterest":::

<span data-ttu-id="eea0c-174">La `GiftCardAccount` classe a besoin de deux modifications pour implémenter ses fonctionnalités de fin de mois.</span><span class="sxs-lookup"><span data-stu-id="eea0c-174">The `GiftCardAccount` class needs two changes to implement its month-end functionality.</span></span> <span data-ttu-id="eea0c-175">Tout d’abord, modifiez le constructeur pour inclure une quantité facultative à ajouter chaque mois :</span><span class="sxs-lookup"><span data-stu-id="eea0c-175">First, modify the constructor to include an optional amount to add each month:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/GiftCardAccount.cs" ID="GiftCardAccountConstruction":::

<span data-ttu-id="eea0c-176">Le constructeur fournit une valeur par défaut pour la `monthlyDeposit` valeur. ainsi, les appelants peuvent omettre un `0` pour aucun dépôt mensuel.</span><span class="sxs-lookup"><span data-stu-id="eea0c-176">The constructor provides a default value for the `monthlyDeposit` value so callers can omit a `0` for no monthly deposit.</span></span> <span data-ttu-id="eea0c-177">Ensuite, remplacez la `PerformMonthEndTransactions` méthode pour ajouter le dépôt mensuel, s’il a été défini sur une valeur différente de zéro dans le constructeur :</span><span class="sxs-lookup"><span data-stu-id="eea0c-177">Next, override the `PerformMonthEndTransactions` method to add the monthly deposit, if it was set to a non-zero value in the constructor:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/GiftCardAccount.cs" ID="AddMonthlyDeposit":::

<span data-ttu-id="eea0c-178">Le remplacement applique l’ensemble de dépôts mensuels dans le constructeur.</span><span class="sxs-lookup"><span data-stu-id="eea0c-178">The override applies the monthly deposit set in the constructor.</span></span> <span data-ttu-id="eea0c-179">Ajoutez le code suivant à la `Main` méthode pour tester ces modifications pour le `GiftCardAccount` et le `InterestEarningAccount` :</span><span class="sxs-lookup"><span data-stu-id="eea0c-179">Add the following code to the `Main` method to test these changes for the `GiftCardAccount` and the `InterestEarningAccount`:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/Program.cs" ID="FirstTests":::

<span data-ttu-id="eea0c-180">Vérifiez les résultats.</span><span class="sxs-lookup"><span data-stu-id="eea0c-180">Verify the results.</span></span> <span data-ttu-id="eea0c-181">Ajoutez maintenant un ensemble similaire de code de test pour le `LineOfCreditAccount` :</span><span class="sxs-lookup"><span data-stu-id="eea0c-181">Now, add a similar set of test code for the `LineOfCreditAccount`:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/Program.cs" ID="TestLineOfCredit":::

<span data-ttu-id="eea0c-182">Lorsque vous ajoutez le code précédent et exécutez le programme, un message semblable à l’erreur suivante s’affiche :</span><span class="sxs-lookup"><span data-stu-id="eea0c-182">When you add the preceding code and run the program, you'll see something like the following error:</span></span>

```console
Unhandled exception. System.ArgumentOutOfRangeException: Amount of deposit must be positive (Parameter 'amount')
   at OOProgramming.BankAccount.MakeDeposit(Decimal amount, DateTime date, String note) in BankAccount.cs:line 42
   at OOProgramming.BankAccount..ctor(String name, Decimal initialBalance) in BankAccount.cs:line 31
   at OOProgramming.LineOfCreditAccount..ctor(String name, Decimal initialBalance) in LineOfCreditAccount.cs:line 9
   at OOProgramming.Program.Main(String[] args) in Program.cs:line 29
```

> [!NOTE]
> <span data-ttu-id="eea0c-183">La sortie réelle comprend le chemin d’accès complet au dossier contenant le projet.</span><span class="sxs-lookup"><span data-stu-id="eea0c-183">The actual output includes the full path to the folder with the project.</span></span> <span data-ttu-id="eea0c-184">Les noms de dossiers ont été omis par souci de concision.</span><span class="sxs-lookup"><span data-stu-id="eea0c-184">The folder names were omitted for brevity.</span></span> <span data-ttu-id="eea0c-185">En outre, selon le format de votre code, les numéros de ligne peuvent être légèrement différents.</span><span class="sxs-lookup"><span data-stu-id="eea0c-185">Also, depending on your code format, the line numbers may be slightly different.</span></span>

<span data-ttu-id="eea0c-186">Ce code échoue car le `BankAccount` suppose que le solde initial doit être supérieur à 0.</span><span class="sxs-lookup"><span data-stu-id="eea0c-186">This code fails because the `BankAccount` assumes that the initial balance must be greater than 0.</span></span> <span data-ttu-id="eea0c-187">Une autre hypothèse intégrée à la `BankAccount` classe est que le solde ne peut pas être négatif.</span><span class="sxs-lookup"><span data-stu-id="eea0c-187">Another assumption baked into the `BankAccount` class is that the balance can't go negative.</span></span> <span data-ttu-id="eea0c-188">Au lieu de cela, tout retrait qui dédessine le compte est rejeté.</span><span class="sxs-lookup"><span data-stu-id="eea0c-188">Instead, any withdrawal that overdraws the account is rejected.</span></span> <span data-ttu-id="eea0c-189">Ces deux hypothèses doivent être modifiées.</span><span class="sxs-lookup"><span data-stu-id="eea0c-189">Both of those assumptions need to change.</span></span> <span data-ttu-id="eea0c-190">Le compte de la ligne de crédit commence à 0 et est généralement un solde négatif.</span><span class="sxs-lookup"><span data-stu-id="eea0c-190">The line of credit account starts at 0, and generally will have a negative balance.</span></span> <span data-ttu-id="eea0c-191">En outre, si un client emprunte trop d’argent, il est facturé.</span><span class="sxs-lookup"><span data-stu-id="eea0c-191">Also, if a customer borrows too much money, they incur a fee.</span></span> <span data-ttu-id="eea0c-192">La transaction est acceptée, mais elle coûte juste plus cher.</span><span class="sxs-lookup"><span data-stu-id="eea0c-192">The transaction is accepted, it just costs more.</span></span> <span data-ttu-id="eea0c-193">La première règle peut être implémentée en ajoutant un argument facultatif au `BankAccount` constructeur qui spécifie le solde minimal.</span><span class="sxs-lookup"><span data-stu-id="eea0c-193">The first rule can be implemented by adding an optional argument to the `BankAccount` constructor that specifies the minimum balance.</span></span> <span data-ttu-id="eea0c-194">La valeur par défaut est `0`.</span><span class="sxs-lookup"><span data-stu-id="eea0c-194">The default is `0`.</span></span> <span data-ttu-id="eea0c-195">La deuxième règle requiert un mécanisme qui permet aux classes dérivées de modifier l’algorithme par défaut.</span><span class="sxs-lookup"><span data-stu-id="eea0c-195">The second rule requires a mechanism that enables derived classes to modify the default algorithm.</span></span> <span data-ttu-id="eea0c-196">Dans un sens, la classe de base « demande » le type dérivé qui doit se produire lorsqu’il y a un surplus.</span><span class="sxs-lookup"><span data-stu-id="eea0c-196">In a sense, the base class "asks" the derived type what should happen when there's an overdraft.</span></span> <span data-ttu-id="eea0c-197">Le comportement par défaut consiste à rejeter la transaction en levant une exception.</span><span class="sxs-lookup"><span data-stu-id="eea0c-197">The default behavior is to reject the transaction by throwing an exception.</span></span>

<span data-ttu-id="eea0c-198">Commençons par ajouter un deuxième constructeur qui comprend un paramètre facultatif `minimumBalance` .</span><span class="sxs-lookup"><span data-stu-id="eea0c-198">Let's start by adding a second constructor that includes an optional `minimumBalance` parameter.</span></span> <span data-ttu-id="eea0c-199">Ce nouveau constructeur effectue toutes les actions effectuées par le constructeur existant.</span><span class="sxs-lookup"><span data-stu-id="eea0c-199">This new constructor does all the actions done by the existing constructor.</span></span> <span data-ttu-id="eea0c-200">En outre, il définit la propriété solde minimal.</span><span class="sxs-lookup"><span data-stu-id="eea0c-200">Also, it sets the minimum balance property.</span></span> <span data-ttu-id="eea0c-201">Vous pouvez copier le corps du constructeur existant.</span><span class="sxs-lookup"><span data-stu-id="eea0c-201">You could copy the body of the existing constructor.</span></span> <span data-ttu-id="eea0c-202">mais cela signifie que deux emplacements doivent être modifiés à l’avenir.</span><span class="sxs-lookup"><span data-stu-id="eea0c-202">but that means two locations to change in the future.</span></span> <span data-ttu-id="eea0c-203">Au lieu de cela, vous pouvez utiliser le *chaînage de constructeur* pour qu’un constructeur en appelle un autre.</span><span class="sxs-lookup"><span data-stu-id="eea0c-203">Instead, you can use *constructor chaining* to have one constructor call another.</span></span> <span data-ttu-id="eea0c-204">Le code suivant montre les deux constructeurs et le nouveau champ supplémentaire :</span><span class="sxs-lookup"><span data-stu-id="eea0c-204">The following code shows the two constructors and the new additional field:</span></span>

 :::code language="csharp" source="./snippets/object-oriented-programming/BankAccount.cs" ID="ConstructorModifications":::

<span data-ttu-id="eea0c-205">Le code précédent illustre deux nouvelles techniques.</span><span class="sxs-lookup"><span data-stu-id="eea0c-205">The preceding code shows two new techniques.</span></span> <span data-ttu-id="eea0c-206">Tout d’abord, le `minimumBalance` champ est marqué comme `readonly` .</span><span class="sxs-lookup"><span data-stu-id="eea0c-206">First, the `minimumBalance` field is marked as `readonly`.</span></span> <span data-ttu-id="eea0c-207">Cela signifie que la valeur ne peut pas être modifiée après la construction de l’objet.</span><span class="sxs-lookup"><span data-stu-id="eea0c-207">That means the value cannot be changed after the object is constructed.</span></span> <span data-ttu-id="eea0c-208">Une fois `BankAccount` créé, le `minimumBalance` ne peut pas changer.</span><span class="sxs-lookup"><span data-stu-id="eea0c-208">Once a `BankAccount` is created, the `minimumBalance` can't change.</span></span> <span data-ttu-id="eea0c-209">Deuxièmement, le constructeur qui accepte deux paramètres utilise `: this(name, initialBalance, 0) { }` comme implémentation.</span><span class="sxs-lookup"><span data-stu-id="eea0c-209">Second, the constructor that takes two parameters uses `: this(name, initialBalance, 0) { }` as its implementation.</span></span> <span data-ttu-id="eea0c-210">L' `: this()` expression appelle l’autre constructeur, celle avec trois paramètres.</span><span class="sxs-lookup"><span data-stu-id="eea0c-210">The `: this()` expression calls the other constructor, the one with three parameters.</span></span> <span data-ttu-id="eea0c-211">Cette technique vous permet d’avoir une seule implémentation pour l’initialisation d’un objet même si le code client peut choisir l’un des nombreux constructeurs.</span><span class="sxs-lookup"><span data-stu-id="eea0c-211">This technique allows you to have a single implementation for initializing an object even though client code can choose one of many constructors.</span></span>

<span data-ttu-id="eea0c-212">Cette implémentation appelle `MakeDeposit` uniquement si le solde initial est supérieur à `0` .</span><span class="sxs-lookup"><span data-stu-id="eea0c-212">This implementation calls `MakeDeposit` only if the initial balance is greater than `0`.</span></span> <span data-ttu-id="eea0c-213">Cela préserve la règle selon laquelle les dépôts doivent être positifs, tout en permettant au compte de crédit de s’ouvrir avec un `0` solde.</span><span class="sxs-lookup"><span data-stu-id="eea0c-213">That preserves the rule that deposits must be positive, yet lets the credit account open with a `0` balance.</span></span>

<span data-ttu-id="eea0c-214">Maintenant que la `BankAccount` classe a un champ en lecture seule pour le solde minimal, la modification finale consiste à remplacer le code en dur par `0` `minimumBalance` dans la `MakeWithdrawal` méthode :</span><span class="sxs-lookup"><span data-stu-id="eea0c-214">Now that the `BankAccount` class has a read-only field for the minimum balance, the final change is to change the hard code `0` to `minimumBalance` in the `MakeWithdrawal` method:</span></span>

```csharp
if (Balance - amount < minimumBalance)
```

<span data-ttu-id="eea0c-215">Après l’extension de la `BankAccount` classe, vous pouvez modifier le `LineOfCreditAccount` constructeur pour appeler le nouveau constructeur de base, comme indiqué dans le code suivant :</span><span class="sxs-lookup"><span data-stu-id="eea0c-215">After extending the `BankAccount` class, you can modify the `LineOfCreditAccount` constructor to call the new base constructor, as shown in the following code:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/LineOfCreditAccount.cs" ID="ConstructLineOfCredit":::

<span data-ttu-id="eea0c-216">Notez que le `LineOfCreditAccount` constructeur modifie le signe du `creditLimit` paramètre afin qu’il corresponde à la signification du `minimumBalance` paramètre.</span><span class="sxs-lookup"><span data-stu-id="eea0c-216">Notice that the `LineOfCreditAccount` constructor changes the sign of the `creditLimit` parameter so it matches the meaning of the `minimumBalance` parameter.</span></span>

## <a name="different-overdraft-rules"></a><span data-ttu-id="eea0c-217">Autres règles de prébrouillon</span><span class="sxs-lookup"><span data-stu-id="eea0c-217">Different overdraft rules</span></span>

<span data-ttu-id="eea0c-218">La dernière fonctionnalité à ajouter permet au `LineOfCreditAccount` de payer une taxe pour dépasser la limite de crédit au lieu de refuser la transaction.</span><span class="sxs-lookup"><span data-stu-id="eea0c-218">The last feature to add enables the `LineOfCreditAccount` to charge a fee for going over the credit limit instead of refusing the transaction.</span></span>

<span data-ttu-id="eea0c-219">Une technique consiste à définir une fonction virtuelle où vous implémentez le comportement requis.</span><span class="sxs-lookup"><span data-stu-id="eea0c-219">One technique is to define a virtual function where you implement the required behavior.</span></span> <span data-ttu-id="eea0c-220">La `Bank Account` classe refactorise la `MakeWithdrawal` méthode en deux méthodes.</span><span class="sxs-lookup"><span data-stu-id="eea0c-220">The `Bank Account` class refactors the `MakeWithdrawal` method into two methods.</span></span> <span data-ttu-id="eea0c-221">La nouvelle méthode effectue l’action spécifiée lorsque le retrait prend le solde inférieur au minimum.</span><span class="sxs-lookup"><span data-stu-id="eea0c-221">The new method does the specified action when the withdrawal takes the balance below the minimum.</span></span> <span data-ttu-id="eea0c-222">La `MakeWithdrawal` méthode existante a le code suivant :</span><span class="sxs-lookup"><span data-stu-id="eea0c-222">The existing `MakeWithdrawal` method has the following code:</span></span>

```csharp
public void MakeWithdrawal(decimal amount, DateTime date, string note)
{
    if (amount <= 0)
    {
        throw new ArgumentOutOfRangeException(nameof(amount), "Amount of withdrawal must be positive");
    }
    if (Balance - amount < minimumBalance)
    {
        throw new InvalidOperationException("Not sufficient funds for this withdrawal");
    }
    var withdrawal = new Transaction(-amount, date, note);
    allTransactions.Add(withdrawal);
}
```

<span data-ttu-id="eea0c-223">Remplacez-le par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="eea0c-223">Replace it with the following code:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/BankAccount.cs" ID="RefactoredMakeWithdrawal":::

<span data-ttu-id="eea0c-224">La méthode ajoutée est `protected` , ce qui signifie qu’elle ne peut être appelée qu’à partir de classes dérivées.</span><span class="sxs-lookup"><span data-stu-id="eea0c-224">The added method is `protected`, which means that it can be called only from derived classes.</span></span> <span data-ttu-id="eea0c-225">Cette déclaration empêche d’autres clients d’appeler la méthode.</span><span class="sxs-lookup"><span data-stu-id="eea0c-225">That declaration prevents other clients from calling the method.</span></span> <span data-ttu-id="eea0c-226">Cela permet également `virtual` aux classes dérivées de modifier le comportement.</span><span class="sxs-lookup"><span data-stu-id="eea0c-226">It's also `virtual` so that derived classes can change the behavior.</span></span> <span data-ttu-id="eea0c-227">Le type de retour est `Transaction?` .</span><span class="sxs-lookup"><span data-stu-id="eea0c-227">The return type is a `Transaction?`.</span></span> <span data-ttu-id="eea0c-228">L' `?` annotation indique que la méthode peut retourner `null` .</span><span class="sxs-lookup"><span data-stu-id="eea0c-228">The `?` annotation indicates that the method may return `null`.</span></span> <span data-ttu-id="eea0c-229">Ajoutez l’implémentation suivante dans le `LineOfCreditAccount` pour payer des frais lorsque la limite de retrait est dépassée :</span><span class="sxs-lookup"><span data-stu-id="eea0c-229">Add the following implementation in the `LineOfCreditAccount` to charge a fee when the withdrawal limit is exceeded:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/LineOfCreditAccount.cs" ID="AddOverdraftFee":::

<span data-ttu-id="eea0c-230">Le remplacement retourne une transaction de frais lorsque le compte est redessiné.</span><span class="sxs-lookup"><span data-stu-id="eea0c-230">The override returns a fee transaction when the account is overdrawn.</span></span> <span data-ttu-id="eea0c-231">Si le retrait n’excède pas la limite, la méthode retourne une `null` transaction.</span><span class="sxs-lookup"><span data-stu-id="eea0c-231">If the withdrawal doesn't go over the limit, the method returns a `null` transaction.</span></span> <span data-ttu-id="eea0c-232">Cela indique qu’il n’y a aucun frais.</span><span class="sxs-lookup"><span data-stu-id="eea0c-232">That indicates there's no fee.</span></span> <span data-ttu-id="eea0c-233">Testez ces modifications en ajoutant le code suivant à votre `Main` méthode dans la `Program` classe :</span><span class="sxs-lookup"><span data-stu-id="eea0c-233">Test these changes by adding the following code to your `Main` method in the `Program` class:</span></span>

:::code language="csharp" source="./snippets/object-oriented-programming/Program.cs" ID="TestLineOfCredit":::

<span data-ttu-id="eea0c-234">Exécutez le programme et vérifiez les résultats.</span><span class="sxs-lookup"><span data-stu-id="eea0c-234">Run the program, and check the results.</span></span>

## <a name="summary"></a><span data-ttu-id="eea0c-235">Résumé</span><span class="sxs-lookup"><span data-stu-id="eea0c-235">Summary</span></span>

<span data-ttu-id="eea0c-236">Ce didacticiel a démontré de nombreuses techniques utilisées dans la programmation de Object-Oriented :</span><span class="sxs-lookup"><span data-stu-id="eea0c-236">This tutorial demonstrated many of the techniques used in Object-Oriented programming:</span></span>

- <span data-ttu-id="eea0c-237">Vous avez utilisé l' *abstraction* quand vous avez conservé de nombreux détails `private` dans chaque classe.</span><span class="sxs-lookup"><span data-stu-id="eea0c-237">You used *Abstraction* when you kept many details `private` in each class.</span></span>
- <span data-ttu-id="eea0c-238">Vous avez utilisé l' *encapsulation* lorsque vous avez défini des classes pour chacun des différents types de compte.</span><span class="sxs-lookup"><span data-stu-id="eea0c-238">You used *Encapsulation* when you defined classes for each of the different account types.</span></span> <span data-ttu-id="eea0c-239">Ces classes décrivent le comportement de ce type de compte.</span><span class="sxs-lookup"><span data-stu-id="eea0c-239">Those classes described the behavior for that type of account.</span></span>
- <span data-ttu-id="eea0c-240">Vous avez utilisé l' *héritage* lorsque vous tirez parti de l’implémentation déjà créée dans la `BankAccount` classe pour enregistrer le code.</span><span class="sxs-lookup"><span data-stu-id="eea0c-240">You used *Inheritance* when you leveraged the implementation already created in the `BankAccount` class to save code.</span></span>
- <span data-ttu-id="eea0c-241">Vous avez utilisé le *polymorphisme* quand vous avez créé `virtual` des méthodes que les classes dérivées peuvent substituer pour créer un comportement spécifique pour ce type de compte.</span><span class="sxs-lookup"><span data-stu-id="eea0c-241">You used *Polymorphism* when you created `virtual` methods that derived classes could override to create specific behavior for that account type.</span></span>

<span data-ttu-id="eea0c-242">Félicitations, vous avez terminé tout notre introduction aux didacticiels C#.</span><span class="sxs-lookup"><span data-stu-id="eea0c-242">Congratulations, you've finished all of our introduction to C# tutorials.</span></span> <span data-ttu-id="eea0c-243">Pour en savoir plus, consultez les [didacticiels](../index.md)suivants.</span><span class="sxs-lookup"><span data-stu-id="eea0c-243">To learn more, try more of our [tutorials](../index.md).</span></span>

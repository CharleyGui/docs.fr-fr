---
title: Modèle de programmation asynchrone des tâches avec async et await (C#)
ms.date: 05/22/2017
ms.assetid: 9bcf896a-5826-4189-8c1a-3e35fa08243a
ms.openlocfilehash: 2700f5bfaa2746c1ea6f4862bee3af60cf83d693
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/14/2020
ms.locfileid: "78848970"
---
# <a name="task-asynchronous-programming-model"></a><span data-ttu-id="53a2e-102">Modèle de programmation asynchrone des tâches</span><span class="sxs-lookup"><span data-stu-id="53a2e-102">Task asynchronous programming model</span></span>

<span data-ttu-id="53a2e-103">Vous pouvez éviter des goulots d'étranglement de performance et améliorer la réactivité globale de votre application à l'aide de la programmation asynchrone.</span><span class="sxs-lookup"><span data-stu-id="53a2e-103">You can avoid performance bottlenecks and enhance the overall responsiveness of your application by using asynchronous programming.</span></span> <span data-ttu-id="53a2e-104">Toutefois, les techniques traditionnelles pour écrire des applications asynchrones peuvent être complexes et rendre ces applications difficiles à écrire, déboguer et mettre à jour.</span><span class="sxs-lookup"><span data-stu-id="53a2e-104">However, traditional techniques for writing asynchronous applications can be complicated, making them difficult to write, debug, and maintain.</span></span>

<span data-ttu-id="53a2e-105">[C# 5](../../../whats-new/csharp-version-history.md#c-version-50) a introduit une approche simplifiée, la programmation asynchrone, qui tire parti de la prise en charge asynchrone de .NET Framework 4.5 et des versions ultérieures, de .NET Core, ainsi que de Windows Runtime.</span><span class="sxs-lookup"><span data-stu-id="53a2e-105">[C# 5](../../../whats-new/csharp-version-history.md#c-version-50) introduced a simplified approach, async programming, that leverages asynchronous support in the .NET Framework 4.5 and higher, .NET Core, and the Windows Runtime.</span></span> <span data-ttu-id="53a2e-106">Le compilateur effectue le travail difficile dont se chargeait le développeur jusqu’à maintenant. En outre, votre application conserve une structure logique qui ressemble à du code synchrone.</span><span class="sxs-lookup"><span data-stu-id="53a2e-106">The compiler does the difficult work that the developer used to do, and your application retains a logical structure that resembles synchronous code.</span></span> <span data-ttu-id="53a2e-107">Par conséquent, vous obtenez tous les avantages de la programmation asynchrone avec peu d'effort.</span><span class="sxs-lookup"><span data-stu-id="53a2e-107">As a result, you get all the advantages of asynchronous programming with a fraction of the effort.</span></span>

<span data-ttu-id="53a2e-108">Cette rubrique fournit une vue d'ensemble sur quand et comment utiliser la programmation asynchrone, et inclut des liens vers des rubriques du support, qui contiennent des informations et des exemples.</span><span class="sxs-lookup"><span data-stu-id="53a2e-108">This topic provides an overview of when and how to use async programming and includes links to support topics that contain details and examples.</span></span>

## <a name="BKMK_WhentoUseAsynchrony"></a><span data-ttu-id="53a2e-109">Async améliore la réactivité</span><span class="sxs-lookup"><span data-stu-id="53a2e-109">Async improves responsiveness</span></span>

<span data-ttu-id="53a2e-110">Le comportement asynchrone est essentiel pour les activités qui sont potentiellement bloquantes, par exemple l’accès au web.</span><span class="sxs-lookup"><span data-stu-id="53a2e-110">Asynchrony is essential for activities that are potentially blocking, such as web access.</span></span> <span data-ttu-id="53a2e-111">L'accès à une ressource Web est parfois lent ou différé.</span><span class="sxs-lookup"><span data-stu-id="53a2e-111">Access to a web resource sometimes is slow or delayed.</span></span> <span data-ttu-id="53a2e-112">Si cette activité est bloquée dans un processus synchrone, toute l’application doit attendre.</span><span class="sxs-lookup"><span data-stu-id="53a2e-112">If such an activity is blocked in a synchronous process, the entire application must wait.</span></span> <span data-ttu-id="53a2e-113">Dans un processus asynchrone, l'application peut poursuivre une autre tâche qui ne dépend pas de la ressource Web jusqu'à ce que la tâche potentiellement bloquante soit terminée.</span><span class="sxs-lookup"><span data-stu-id="53a2e-113">In an asynchronous process, the application can continue with other work that doesn't depend on the web resource until the potentially blocking task finishes.</span></span>

<span data-ttu-id="53a2e-114">Le tableau suivant indique les zones classiques où la programmation asynchrone améliore la réactivité.</span><span class="sxs-lookup"><span data-stu-id="53a2e-114">The following table shows typical areas where asynchronous programming improves responsiveness.</span></span> <span data-ttu-id="53a2e-115">Les API répertoriées de .NET et de Windows Runtime contiennent des méthodes qui prennent en charge la programmation asynchrone.</span><span class="sxs-lookup"><span data-stu-id="53a2e-115">The listed APIs from .NET and the Windows Runtime contain methods that support async programming.</span></span>

| <span data-ttu-id="53a2e-116">Domaine d'application</span><span class="sxs-lookup"><span data-stu-id="53a2e-116">Application area</span></span>    | <span data-ttu-id="53a2e-117">Types .NET avec les méthodes async</span><span class="sxs-lookup"><span data-stu-id="53a2e-117">.NET types with async methods</span></span>     | <span data-ttu-id="53a2e-118">Types Windows Runtime avec les méthodes async</span><span class="sxs-lookup"><span data-stu-id="53a2e-118">Windows Runtime types with async methods</span></span>  |
|---------------------|-----------------------------------|-------------------------------------------|
|<span data-ttu-id="53a2e-119">Accès Web</span><span class="sxs-lookup"><span data-stu-id="53a2e-119">Web access</span></span>|<xref:System.Net.Http.HttpClient>|<xref:Windows.Web.Syndication.SyndicationClient>|
|<span data-ttu-id="53a2e-120">Utilisation de fichiers</span><span class="sxs-lookup"><span data-stu-id="53a2e-120">Working with files</span></span>|<span data-ttu-id="53a2e-121"><xref:System.IO.StreamWriter>, <xref:System.IO.StreamReader>, <xref:System.Xml.XmlReader></span><span class="sxs-lookup"><span data-stu-id="53a2e-121"><xref:System.IO.StreamWriter>, <xref:System.IO.StreamReader>, <xref:System.Xml.XmlReader></span></span>|<xref:Windows.Storage.StorageFile>|
|<span data-ttu-id="53a2e-122">Utilisation des images</span><span class="sxs-lookup"><span data-stu-id="53a2e-122">Working with images</span></span>||<span data-ttu-id="53a2e-123"><xref:Windows.Media.Capture.MediaCapture>, <xref:Windows.Graphics.Imaging.BitmapEncoder>, <xref:Windows.Graphics.Imaging.BitmapDecoder></span><span class="sxs-lookup"><span data-stu-id="53a2e-123"><xref:Windows.Media.Capture.MediaCapture>, <xref:Windows.Graphics.Imaging.BitmapEncoder>, <xref:Windows.Graphics.Imaging.BitmapDecoder></span></span>|
|<span data-ttu-id="53a2e-124">Programmation WCF</span><span class="sxs-lookup"><span data-stu-id="53a2e-124">WCF programming</span></span>|[<span data-ttu-id="53a2e-125">Opérations synchrones et asynchrones</span><span class="sxs-lookup"><span data-stu-id="53a2e-125">Synchronous and Asynchronous Operations</span></span>](../../../../framework/wcf/synchronous-and-asynchronous-operations.md)||

<span data-ttu-id="53a2e-126">Le comportement asynchrone est particulièrement utile pour les applications qui accèdent au thread d'interface utilisateur, car toute activité liée à l'interface utilisateur partage généralement un thread.</span><span class="sxs-lookup"><span data-stu-id="53a2e-126">Asynchrony proves especially valuable for applications that access the UI thread because all UI-related activity usually shares one thread.</span></span> <span data-ttu-id="53a2e-127">Si un processus est bloqué dans une application synchrone, tous les processus sont bloqués.</span><span class="sxs-lookup"><span data-stu-id="53a2e-127">If any process is blocked in a synchronous application, all are blocked.</span></span> <span data-ttu-id="53a2e-128">Votre application ne répond plus et vous pouvez conclure qu'elle a rencontré une défaillance, alors qu'elle attend simplement.</span><span class="sxs-lookup"><span data-stu-id="53a2e-128">Your application stops responding, and you might conclude that it has failed when instead it's just waiting.</span></span>

<span data-ttu-id="53a2e-129">Lorsque vous utilisez des méthodes asynchrones, l'application continue à répondre à l'interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="53a2e-129">When you use asynchronous methods, the application continues to respond to the UI.</span></span> <span data-ttu-id="53a2e-130">Vous pouvez redimensionner ou réduire une fenêtre, par exemple, ou vous pouvez fermer l'application si vous ne souhaitez pas attendre qu'elle se termine.</span><span class="sxs-lookup"><span data-stu-id="53a2e-130">You can resize or minimize a window, for example, or you can close the application if you don't want to wait for it to finish.</span></span>

<span data-ttu-id="53a2e-131">L'approche basée sur async ajoute l'équivalent d'une transmission automatique à la liste d'options dont vous disposez pour concevoir des opérations asynchrones.</span><span class="sxs-lookup"><span data-stu-id="53a2e-131">The async-based approach adds the equivalent of an automatic transmission to the list of options that you can choose from when designing asynchronous operations.</span></span> <span data-ttu-id="53a2e-132">En d'autres termes, vous obtenez tous les avantages de la programmation asynchrone classique mais avec beaucoup moins d'efforts du point de vue du développeur.</span><span class="sxs-lookup"><span data-stu-id="53a2e-132">That is, you get all the benefits of traditional asynchronous programming but with much less effort from the developer.</span></span>

## <a name="BKMK_HowtoWriteanAsyncMethod"></a><span data-ttu-id="53a2e-133">Les méthodes Async sont plus faciles à écrire</span><span class="sxs-lookup"><span data-stu-id="53a2e-133">Async methods are easier to write</span></span>

<span data-ttu-id="53a2e-134">Les mots clés [async](../../../language-reference/keywords/async.md) et [await](../../../language-reference/operators/await.md) en C# sont au cœur de la programmation async.</span><span class="sxs-lookup"><span data-stu-id="53a2e-134">The [async](../../../language-reference/keywords/async.md) and [await](../../../language-reference/operators/await.md) keywords in C# are the heart of async programming.</span></span> <span data-ttu-id="53a2e-135">Avec ces deux mots clés, vous pouvez utiliser des ressources dans .NET Framework, .NET Core ou Windows Runtime pour créer une méthode asynchrone presque aussi facilement qu’une méthode synchrone.</span><span class="sxs-lookup"><span data-stu-id="53a2e-135">By using those two keywords, you can use resources in the .NET Framework, .NET Core, or the Windows Runtime to create an asynchronous method almost as easily as you create a synchronous method.</span></span> <span data-ttu-id="53a2e-136">Les méthodes asynchrones définies avec mot clé `async` sont appelées *méthodes asynchrones*.</span><span class="sxs-lookup"><span data-stu-id="53a2e-136">Asynchronous methods that you define by using the `async` keyword are referred to as *async methods*.</span></span>

<span data-ttu-id="53a2e-137">L'exemple suivant illustre une méthode async.</span><span class="sxs-lookup"><span data-stu-id="53a2e-137">The following example shows an async method.</span></span> <span data-ttu-id="53a2e-138">Presque tous les éléments du code doivent vous sembler familiers.</span><span class="sxs-lookup"><span data-stu-id="53a2e-138">Almost everything in the code should look completely familiar to you.</span></span>

<span data-ttu-id="53a2e-139">Le fichier d’exemple complet Windows Presentation Foundation (WPF) se trouve à la fin de cette rubrique. Vous pouvez télécharger l’exemple sur [Exemple async : exemple de « programmation asynchrone avec async et await »](https://docs.microsoft.com/samples/dotnet/samples/async-and-await-cs/).</span><span class="sxs-lookup"><span data-stu-id="53a2e-139">You can find a complete Windows Presentation Foundation (WPF) example file at the end of this topic, and you can download the sample from [Async Sample: Example from "Asynchronous Programming with Async and Await"](https://docs.microsoft.com/samples/dotnet/samples/async-and-await-cs/).</span></span>

```csharp
async Task<int> AccessTheWebAsync()
{
    // You need to add a reference to System.Net.Http to declare client.
    var client = new HttpClient();

    // GetStringAsync returns a Task<string>. That means that when you await the
    // task you'll get a string (urlContents).
    Task<string> getStringTask = client.GetStringAsync("https://docs.microsoft.com/dotnet");

    // You can do work here that doesn't rely on the string from GetStringAsync.
    DoIndependentWork();

    // The await operator suspends AccessTheWebAsync.
    //  - AccessTheWebAsync can't continue until getStringTask is complete.
    //  - Meanwhile, control returns to the caller of AccessTheWebAsync.
    //  - Control resumes here when getStringTask is complete.
    //  - The await operator then retrieves the string result from getStringTask.
    string urlContents = await getStringTask;

    // The return statement specifies an integer result.
    // Any methods that are awaiting AccessTheWebAsync retrieve the length value.
    return urlContents.Length;
}
```

<span data-ttu-id="53a2e-140">Vous pouvez tirer plusieurs enseignements à partir de l’exemple précédent.</span><span class="sxs-lookup"><span data-stu-id="53a2e-140">You can learn several practices from the preceding sample.</span></span> <span data-ttu-id="53a2e-141">Démarrez par la signature de la méthode.</span><span class="sxs-lookup"><span data-stu-id="53a2e-141">Start with the method signature.</span></span> <span data-ttu-id="53a2e-142">Elle inclut le modificateur `async`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-142">It includes the `async` modifier.</span></span> <span data-ttu-id="53a2e-143">Le type de retour est `Task<int>` (consultez la section « Types de retour » pour découvrir d’autres options).</span><span class="sxs-lookup"><span data-stu-id="53a2e-143">The return type is `Task<int>` (See "Return Types" section for more options).</span></span> <span data-ttu-id="53a2e-144">Le nom de la méthode se termine dans `Async`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-144">The method name ends in `Async`.</span></span> <span data-ttu-id="53a2e-145">Dans le corps de la méthode, `GetStringAsync` retourne un `Task<string>`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-145">In the body of the method, `GetStringAsync` returns a `Task<string>`.</span></span> <span data-ttu-id="53a2e-146">Cela signifie que quand vous attendez (`await`) la tâche, vous obtenez un `string` (`urlContents`).</span><span class="sxs-lookup"><span data-stu-id="53a2e-146">That means that when you `await` the task you'll get a `string` (`urlContents`).</span></span>  <span data-ttu-id="53a2e-147">Avant d’attendre la tâche, vous pouvez effectuer tout travail qui ne repose pas sur le `string` de `GetStringAsync`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-147">Before awaiting the task, you can do work that doesn't rely on the `string` from `GetStringAsync`.</span></span>

<span data-ttu-id="53a2e-148">Faites particulièrement attention à l’opérateur `await`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-148">Pay close attention to the `await` operator.</span></span> <span data-ttu-id="53a2e-149">Il suspend `AccessTheWebAsync`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-149">It suspends `AccessTheWebAsync`;</span></span>

- <span data-ttu-id="53a2e-150">`AccessTheWebAsync` ne peut pas continuer tant que `getStringTask` n’est pas terminé.</span><span class="sxs-lookup"><span data-stu-id="53a2e-150">`AccessTheWebAsync` can't continue until `getStringTask` is complete.</span></span>
- <span data-ttu-id="53a2e-151">Pendant ce temps, le contrôle retourne à l’appelant de `AccessTheWebAsync`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-151">Meanwhile, control returns to the caller of `AccessTheWebAsync`.</span></span>
- <span data-ttu-id="53a2e-152">Le contrôle reprend ici quand `getStringTask` est terminé.</span><span class="sxs-lookup"><span data-stu-id="53a2e-152">Control resumes here when `getStringTask` is complete.</span></span>
- <span data-ttu-id="53a2e-153">L’opérateur `await` récupère alors le résultat `string` auprès de `getStringTask`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-153">The `await` operator then retrieves the `string` result from `getStringTask`.</span></span>

<span data-ttu-id="53a2e-154">L’instruction return spécifie un résultat entier.</span><span class="sxs-lookup"><span data-stu-id="53a2e-154">The return statement specifies an integer result.</span></span> <span data-ttu-id="53a2e-155">Toutes les méthodes qui attendent `AccessTheWebAsync` récupèrent la valeur de longueur.</span><span class="sxs-lookup"><span data-stu-id="53a2e-155">Any methods that are awaiting `AccessTheWebAsync` retrieve the length value.</span></span>

<span data-ttu-id="53a2e-156">Si `AccessTheWebAsync` n'a aucun travail qu'il peut effectuer entre l'appel de `GetStringAsync` et l'attente de son achèvement, vous pouvez simplifier votre code en appelant et attendant dans l'instruction unique suivante.</span><span class="sxs-lookup"><span data-stu-id="53a2e-156">If `AccessTheWebAsync` doesn't have any work that it can do between calling `GetStringAsync` and awaiting its completion, you can simplify your code by calling and awaiting in the following single statement.</span></span>

```csharp
string urlContents = await client.GetStringAsync("https://docs.microsoft.com/dotnet");
```

<span data-ttu-id="53a2e-157">Les caractéristiques suivantes résument ce qui fait de l’exemple précédent une méthode async :</span><span class="sxs-lookup"><span data-stu-id="53a2e-157">The following characteristics summarize what makes the previous example an async method:</span></span>

- <span data-ttu-id="53a2e-158">La signature de la méthode inclut un modificateur `async`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-158">The method signature includes an `async` modifier.</span></span>
- <span data-ttu-id="53a2e-159">Le nom d'une méthode async, par convention, se termine par un suffixe « Async ».</span><span class="sxs-lookup"><span data-stu-id="53a2e-159">The name of an async method, by convention, ends with an "Async" suffix.</span></span>
- <span data-ttu-id="53a2e-160">Le type de retour est l’un des types suivants :</span><span class="sxs-lookup"><span data-stu-id="53a2e-160">The return type is one of the following types:</span></span>

  - <span data-ttu-id="53a2e-161"><xref:System.Threading.Tasks.Task%601> si votre méthode a une instruction return dans laquelle l'opérande est de type `TResult`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-161"><xref:System.Threading.Tasks.Task%601> if your method has a return statement in which the operand has type `TResult`.</span></span>
  - <span data-ttu-id="53a2e-162"><xref:System.Threading.Tasks.Task> si votre méthode n'a aucune instruction de retour, ou si elle a une instruction de retour sans opérande.</span><span class="sxs-lookup"><span data-stu-id="53a2e-162"><xref:System.Threading.Tasks.Task> if your method has no return statement or has a return statement with no operand.</span></span>
  - <span data-ttu-id="53a2e-163">`void` si vous écrivez un gestionnaire d’événements async.</span><span class="sxs-lookup"><span data-stu-id="53a2e-163">`void` if you're writing an async event handler.</span></span>
  - <span data-ttu-id="53a2e-164">Tous les autres types ayant une méthode `GetAwaiter` (à compter de C# 7.0).</span><span class="sxs-lookup"><span data-stu-id="53a2e-164">Any other type that has a `GetAwaiter` method (starting with C# 7.0).</span></span>

  <span data-ttu-id="53a2e-165">Pour plus d’informations, consultez la section [Types et paramètres de retour](#BKMK_ReturnTypesandParameters).</span><span class="sxs-lookup"><span data-stu-id="53a2e-165">For more information, see the [Return Types and Parameters](#BKMK_ReturnTypesandParameters) section.</span></span>

- <span data-ttu-id="53a2e-166">La méthode inclut généralement au moins une expression `await`, qui marque le point au-delà duquel la méthode ne peut pas poursuivre son exécution tant que l’opération asynchrone attendue n’est pas terminée.</span><span class="sxs-lookup"><span data-stu-id="53a2e-166">The method usually includes at least one `await` expression, which marks a point where the method can't continue until the awaited asynchronous operation is complete.</span></span> <span data-ttu-id="53a2e-167">Dans le même temps, la méthode est interrompue, et le contrôle retourne à l'appelant de la méthode.</span><span class="sxs-lookup"><span data-stu-id="53a2e-167">In the meantime, the method is suspended, and control returns to the method's caller.</span></span> <span data-ttu-id="53a2e-168">La section suivante de cette rubrique illustre ce qui se produit au point d'interruption.</span><span class="sxs-lookup"><span data-stu-id="53a2e-168">The next section of this topic illustrates what happens at the suspension point.</span></span>

<span data-ttu-id="53a2e-169">Dans les méthodes async, vous utilisez les mots clés et les types fournis pour indiquer ce que vous souhaitez faire, et le compilateur effectue le reste, notamment le suivi de ce qui doit se produire lorsque le contrôle retourne à un point d'attente dans une méthode interrompue.</span><span class="sxs-lookup"><span data-stu-id="53a2e-169">In async methods, you use the provided keywords and types to indicate what you want to do, and the compiler does the rest, including keeping track of what must happen when control returns to an await point in a suspended method.</span></span> <span data-ttu-id="53a2e-170">Il peut être difficile de gérer des processus de routine, tels que les boucles et la gestion des exceptions, dans le code asynchrone traditionnel.</span><span class="sxs-lookup"><span data-stu-id="53a2e-170">Some routine processes, such as loops and exception handling, can be difficult to handle in traditional asynchronous code.</span></span> <span data-ttu-id="53a2e-171">Dans une méthode async, vous écrivez ces éléments comme vous l’auriez fait dans une solution synchrone, et le problème est résolu.</span><span class="sxs-lookup"><span data-stu-id="53a2e-171">In an async method, you write these elements much as you would in a synchronous solution, and the problem is solved.</span></span>

<span data-ttu-id="53a2e-172">Pour plus d’informations sur le comportement asynchrone dans les versions antérieures de .NET Framework, consultez la page [Programmation asynchrone .NET Framework traditionnelle et TPL](../../../../standard/parallel-programming/tpl-and-traditional-async-programming.md).</span><span class="sxs-lookup"><span data-stu-id="53a2e-172">For more information about asynchrony in previous versions of the .NET Framework, see [TPL and Traditional .NET Framework Asynchronous Programming](../../../../standard/parallel-programming/tpl-and-traditional-async-programming.md).</span></span>

## <a name="BKMK_WhatHappensUnderstandinganAsyncMethod"></a><span data-ttu-id="53a2e-173">Que se passe-t-il dans une méthode async</span><span class="sxs-lookup"><span data-stu-id="53a2e-173">What happens in an async method</span></span>

<span data-ttu-id="53a2e-174">La chose la plus importante à comprendre en programmation asynchrone est le déplacement du flux de contrôle d'une méthode à l'autre.</span><span class="sxs-lookup"><span data-stu-id="53a2e-174">The most important thing to understand in asynchronous programming is how the control flow moves from method to method.</span></span> <span data-ttu-id="53a2e-175">Le diagramme suivant présente le processus :</span><span class="sxs-lookup"><span data-stu-id="53a2e-175">The following diagram leads you through the process:</span></span>

<span data-ttu-id="53a2e-176">![Suivre un programme async](./media/task-asynchronous-programming-model/navigation-trace-async-program.png "NavigationTrace (En)")</span><span class="sxs-lookup"><span data-stu-id="53a2e-176">![Trace an async program](./media/task-asynchronous-programming-model/navigation-trace-async-program.png "NavigationTrace")</span></span>

<span data-ttu-id="53a2e-177">Les numéros du diagramme correspondent aux étapes suivantes, lancées quand l’utilisateur clique sur le bouton « Démarrer ».</span><span class="sxs-lookup"><span data-stu-id="53a2e-177">The numbers in the diagram correspond to the following steps, initiated when the user clicks the "start" button.</span></span>

1. <span data-ttu-id="53a2e-178">Un gestionnaire d’événements `AccessTheWebAsync` appelle et attend la méthode async.</span><span class="sxs-lookup"><span data-stu-id="53a2e-178">An event handler calls and awaits the `AccessTheWebAsync` async method.</span></span>

2. <span data-ttu-id="53a2e-179">`AccessTheWebAsync` crée une instance <xref:System.Net.Http.HttpClient> et appelle la méthode asynchrone <xref:System.Net.Http.HttpClient.GetStringAsync%2A> pour télécharger le contenu d'un site Web comme une chaîne.</span><span class="sxs-lookup"><span data-stu-id="53a2e-179">`AccessTheWebAsync` creates an <xref:System.Net.Http.HttpClient> instance and calls the <xref:System.Net.Http.HttpClient.GetStringAsync%2A> asynchronous method to download the contents of a website as a string.</span></span>

3. <span data-ttu-id="53a2e-180">Quelque chose se produit dans `GetStringAsync` et suspend sa progression.</span><span class="sxs-lookup"><span data-stu-id="53a2e-180">Something happens in `GetStringAsync` that suspends its progress.</span></span> <span data-ttu-id="53a2e-181">Elle peut être obligée d'attendre la fin d'un téléchargement sur un site Web ou de toute autre activité bloquante.</span><span class="sxs-lookup"><span data-stu-id="53a2e-181">Perhaps it must wait for a website to download or some other blocking activity.</span></span> <span data-ttu-id="53a2e-182">Pour éviter de bloquer les ressources, `GetStringAsync` cède le contrôle à son appelant, `AccessTheWebAsync`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-182">To avoid blocking resources, `GetStringAsync` yields control to its caller, `AccessTheWebAsync`.</span></span>

     <span data-ttu-id="53a2e-183">`GetStringAsync` retourne un <xref:System.Threading.Tasks.Task%601>, où `TResult` est une chaîne, et `AccessTheWebAsync` assigne la tâche à la variable `getStringTask`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-183">`GetStringAsync` returns a <xref:System.Threading.Tasks.Task%601>, where `TResult` is a string, and `AccessTheWebAsync` assigns the task to the `getStringTask` variable.</span></span> <span data-ttu-id="53a2e-184">La tâche représente le processus en cours de l'appel de `GetStringAsync`, avec l'engagement de produire une valeur de chaîne réelle lorsque le travail est terminé.</span><span class="sxs-lookup"><span data-stu-id="53a2e-184">The task represents the ongoing process for the call to `GetStringAsync`, with a commitment to produce an actual string value when the work is complete.</span></span>

4. <span data-ttu-id="53a2e-185">Étant donné que `getStringTask` n'a pas encore été attendu, `AccessTheWebAsync` peut continuer avec un autre travail qui ne dépend pas du résultat final issu de `GetStringAsync`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-185">Because `getStringTask` hasn't been awaited yet, `AccessTheWebAsync` can continue with other work that doesn't depend on the final result from `GetStringAsync`.</span></span> <span data-ttu-id="53a2e-186">Cette opération est représentée par un appel à la méthode synchrone `DoIndependentWork`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-186">That work is represented by a call to the synchronous method `DoIndependentWork`.</span></span>

5. <span data-ttu-id="53a2e-187">`DoIndependentWork` est une méthode synchrone qui effectue son travail et retourne à son appelant.</span><span class="sxs-lookup"><span data-stu-id="53a2e-187">`DoIndependentWork` is a synchronous method that does its work and returns to its caller.</span></span>

6. <span data-ttu-id="53a2e-188">`AccessTheWebAsync` n'a plus de travail à exécuter sans un résultat de `getStringTask`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-188">`AccessTheWebAsync` has run out of work that it can do without a result from `getStringTask`.</span></span> <span data-ttu-id="53a2e-189">`AccessTheWebAsync` veut ensuite calculer et retourner la longueur de la chaîne téléchargée, mais la méthode ne peut pas calculer cette valeur avant d'avoir la chaîne.</span><span class="sxs-lookup"><span data-stu-id="53a2e-189">`AccessTheWebAsync` next wants to calculate and return the length of the downloaded string, but the method can't calculate that value until the method has the string.</span></span>

     <span data-ttu-id="53a2e-190">Par conséquent, `AccessTheWebAsync` utilise un opérateur await pour interrompre sa progression et pour céder le contrôle à la méthode ayant appelé `AccessTheWebAsync`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-190">Therefore, `AccessTheWebAsync` uses an await operator to suspend its progress and to yield control to the method that called `AccessTheWebAsync`.</span></span> <span data-ttu-id="53a2e-191">`AccessTheWebAsync` retourne un `Task<int>` à l’appelant.</span><span class="sxs-lookup"><span data-stu-id="53a2e-191">`AccessTheWebAsync` returns a `Task<int>` to the caller.</span></span> <span data-ttu-id="53a2e-192">La tâche représente la promesse de produire un résultat entier qui est la longueur de la chaîne téléchargée.</span><span class="sxs-lookup"><span data-stu-id="53a2e-192">The task represents a promise to produce an integer result that's the length of the downloaded string.</span></span>

    > [!NOTE]
    > <span data-ttu-id="53a2e-193">Si `GetStringAsync` (et donc `getStringTask`) se termine avant que `AccessTheWebAsync` ne l’attende, le contrôle reste dans `AccessTheWebAsync`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-193">If `GetStringAsync` (and therefore `getStringTask`) completes before `AccessTheWebAsync` awaits it, control remains in `AccessTheWebAsync`.</span></span> <span data-ttu-id="53a2e-194">Le fait de suspendre, puis de retourner à `AccessTheWebAsync` ne sert à rien si le processus asynchrone appelé (`getStringTask`) s'est déjà effectué et si `AccessTheWebAsync` n'a pas à attendre le résultat final.</span><span class="sxs-lookup"><span data-stu-id="53a2e-194">The expense of suspending and then returning to `AccessTheWebAsync` would be wasted if the called asynchronous process (`getStringTask`) has already completed and `AccessTheWebAsync` doesn't have to wait for the final result.</span></span>

     <span data-ttu-id="53a2e-195">Dans l'appelant (le gestionnaire d'événements dans cet exemple), le modèle de traitement continue.</span><span class="sxs-lookup"><span data-stu-id="53a2e-195">Inside the caller (the event handler in this example), the processing pattern continues.</span></span> <span data-ttu-id="53a2e-196">L'appelant peut effectuer d'autres tâches qui ne dépendent pas du résultat de `AccessTheWebAsync` avant d'attendre ce résultat, ou l'appelant peut attendre immédiatement.</span><span class="sxs-lookup"><span data-stu-id="53a2e-196">The caller might do other work that doesn't depend on the result from `AccessTheWebAsync` before awaiting that result, or the caller might await immediately.</span></span>   <span data-ttu-id="53a2e-197">Le gestionnaire d'événements attend `AccessTheWebAsync`, et `AccessTheWebAsync` attend `GetStringAsync`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-197">The event handler is waiting for `AccessTheWebAsync`, and `AccessTheWebAsync` is waiting for `GetStringAsync`.</span></span>

7. <span data-ttu-id="53a2e-198">`GetStringAsync` se termine et génère un résultat de chaîne.</span><span class="sxs-lookup"><span data-stu-id="53a2e-198">`GetStringAsync` completes and produces a string result.</span></span> <span data-ttu-id="53a2e-199">Le résultat de chaîne n'est pas retourné par l'appel de `GetStringAsync` de la façon à laquelle vous pourriez vous attendre.</span><span class="sxs-lookup"><span data-stu-id="53a2e-199">The string result isn't returned by the call to `GetStringAsync` in the way that you might expect.</span></span> <span data-ttu-id="53a2e-200">(N'oubliez pas que la méthode a déjà retourné une tâche à l'étape 3.) Au lieu de cela, le résultat chaîne est stocké dans la tâche qui représente l'achèvement de la méthode, `getStringTask`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-200">(Remember that the method already returned a task in step 3.) Instead, the string result is stored in the task that represents the completion of the method, `getStringTask`.</span></span> <span data-ttu-id="53a2e-201">L'opérateur await récupère le résultat de `getStringTask`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-201">The await operator retrieves the result from `getStringTask`.</span></span> <span data-ttu-id="53a2e-202">L'instruction d'assignation assigne le résultat récupéré à `urlContents`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-202">The assignment statement assigns the retrieved result to `urlContents`.</span></span>

8. <span data-ttu-id="53a2e-203">Lorsque `AccessTheWebAsync` a le résultat de chaîne, la méthode peut calculer la longueur de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="53a2e-203">When `AccessTheWebAsync` has the string result, the method can calculate the length of the string.</span></span> <span data-ttu-id="53a2e-204">Puis, le travail d'`AccessTheWebAsync` est également interrompu, et le gestionnaire d'événements en attente peut reprendre.</span><span class="sxs-lookup"><span data-stu-id="53a2e-204">Then the work of `AccessTheWebAsync` is also complete, and the waiting event handler can resume.</span></span> <span data-ttu-id="53a2e-205">Dans l'exemple complet à la fin de la rubrique, vous pouvez vérifier que le gestionnaire d'événements récupère et imprime la valeur du résultat de la longueur.</span><span class="sxs-lookup"><span data-stu-id="53a2e-205">In the full example at the end of the topic, you can confirm that the event handler retrieves and prints the value of the length result.</span></span>
<span data-ttu-id="53a2e-206">Si vous débutez en programmation asynchrone, prenez une minute pour déterminer la différence entre le comportement synchrone et le comportement asynchrone.</span><span class="sxs-lookup"><span data-stu-id="53a2e-206">If you are new to asynchronous programming, take a minute to consider the difference between synchronous and asynchronous behavior.</span></span> <span data-ttu-id="53a2e-207">Une méthode synchrone retourne une fois son travail terminé (étape 5), mais une méthode asynchrone retourne une valeur de tâche lorsque son travail est interrompu (étapes 3 et 6).</span><span class="sxs-lookup"><span data-stu-id="53a2e-207">A synchronous method returns when its work is complete (step 5), but an async method returns a task value when its work is suspended (steps 3 and 6).</span></span> <span data-ttu-id="53a2e-208">Lorsque la méthode async termine finalement son travail, la tâche est marquée comme terminée et le résultat, le cas échéant, est stocké dans la tâche.</span><span class="sxs-lookup"><span data-stu-id="53a2e-208">When the async method eventually completes its work, the task is marked as completed and the result, if any, is stored in the task.</span></span>

<span data-ttu-id="53a2e-209">Pour plus d’informations sur le flux de contrôle, consultez la page [Flux de contrôle dans les programmes async (C#)](control-flow-in-async-programs.md).</span><span class="sxs-lookup"><span data-stu-id="53a2e-209">For more information about control flow, see [Control Flow in Async Programs (C#)](control-flow-in-async-programs.md).</span></span>

## <a name="BKMK_APIAsyncMethods"></a><span data-ttu-id="53a2e-210">Méthodes async API</span><span class="sxs-lookup"><span data-stu-id="53a2e-210">API async methods</span></span>

<span data-ttu-id="53a2e-211">Vous pouvez vous demander où rechercher les méthodes telles que `GetStringAsync` qui prennent en charge la programmation async.</span><span class="sxs-lookup"><span data-stu-id="53a2e-211">You might be wondering where to find methods such as `GetStringAsync` that support async programming.</span></span> <span data-ttu-id="53a2e-212">.NET Framework 4.5 ou version ultérieure et .NET Core contiennent de nombreux membres qui fonctionnent avec `async` et `await`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-212">The  .NET Framework 4.5 or higher and .NET Core contain many members that work with `async` and `await`.</span></span> <span data-ttu-id="53a2e-213">Vous pouvez les reconnaître par le suffixe "Async" qui est annexé au <xref:System.Threading.Tasks.Task> nom <xref:System.Threading.Tasks.Task%601>du membre, et par leur type de retour ou .</span><span class="sxs-lookup"><span data-stu-id="53a2e-213">You can recognize them by the "Async" suffix that's appended to the member name, and by their return type of <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601>.</span></span> <span data-ttu-id="53a2e-214">Par exemple, la classe `System.IO.Stream` contient des méthodes telles que <xref:System.IO.Stream.CopyToAsync%2A>, <xref:System.IO.Stream.ReadAsync%2A> et <xref:System.IO.Stream.WriteAsync%2A> en même temps que les méthodes synchrones <xref:System.IO.Stream.CopyTo%2A>, <xref:System.IO.Stream.Read%2A> et <xref:System.IO.Stream.Write%2A>.</span><span class="sxs-lookup"><span data-stu-id="53a2e-214">For example, the `System.IO.Stream` class contains methods such as <xref:System.IO.Stream.CopyToAsync%2A>, <xref:System.IO.Stream.ReadAsync%2A>, and <xref:System.IO.Stream.WriteAsync%2A> alongside the synchronous methods <xref:System.IO.Stream.CopyTo%2A>, <xref:System.IO.Stream.Read%2A>, and <xref:System.IO.Stream.Write%2A>.</span></span>

<span data-ttu-id="53a2e-215">Windows Runtime contient également de nombreuses méthodes utilisables avec `async` et `await` dans les applications Windows.</span><span class="sxs-lookup"><span data-stu-id="53a2e-215">The Windows Runtime also contains many methods that you can use with `async` and `await` in Windows apps.</span></span> <span data-ttu-id="53a2e-216">Pour plus d’informations, consultez [Programmation thread et asynchrone](/windows/uwp/threading-async/) pour le développement UWP, et [Programmation asynchrone (applications Windows Store)](https://docs.microsoft.com/previous-versions/windows/apps/hh464924(v=win.10)) et [Démarrage rapide : appel d’API asynchrones en C# ou Visual Basic](https://docs.microsoft.com/previous-versions/windows/apps/hh452713(v=win.10)) si vous utilisez des versions antérieures de Windows Runtime.</span><span class="sxs-lookup"><span data-stu-id="53a2e-216">For more information, see [Threading and async programming](/windows/uwp/threading-async/) for UWP development, and [Asynchronous programming (Windows Store apps)](https://docs.microsoft.com/previous-versions/windows/apps/hh464924(v=win.10)) and [Quickstart: Calling asynchronous APIs in C# or Visual Basic](https://docs.microsoft.com/previous-versions/windows/apps/hh452713(v=win.10)) if you use earlier versions of the Windows Runtime.</span></span>

## <a name="BKMK_Threads"></a><span data-ttu-id="53a2e-217">Fils</span><span class="sxs-lookup"><span data-stu-id="53a2e-217">Threads</span></span>

<span data-ttu-id="53a2e-218">Les méthodes Async sont conçues pour être des opérations non bloquantes.</span><span class="sxs-lookup"><span data-stu-id="53a2e-218">Async methods are intended to be non-blocking operations.</span></span> <span data-ttu-id="53a2e-219">Une `await` expression dans une méthode async ne bloque pas le fil actuel pendant que la tâche attendue est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="53a2e-219">An `await` expression in an async method doesn't block the current thread while the awaited task is running.</span></span> <span data-ttu-id="53a2e-220">Au lieu de cela, l'expression inscrit le reste de la méthode comme continuation et retourne le contrôle à l'appelant de la méthode async.</span><span class="sxs-lookup"><span data-stu-id="53a2e-220">Instead, the expression signs up the rest of the method as a continuation and returns control to the caller of the async method.</span></span>

<span data-ttu-id="53a2e-221">Les mots clés `async` et `await` n’entraînent pas la création de threads supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="53a2e-221">The `async` and `await` keywords don't cause additional threads to be created.</span></span> <span data-ttu-id="53a2e-222">Les méthodes Async ne requièrent pas de multithreading, car une méthode async ne fonctionne pas sur son propre thread.</span><span class="sxs-lookup"><span data-stu-id="53a2e-222">Async methods don't require multithreading because an async method doesn't run on its own thread.</span></span> <span data-ttu-id="53a2e-223">La méthode s'exécute sur le contexte de synchronisation actuel et utilise du temps sur le thread uniquement lorsqu'elle est active.</span><span class="sxs-lookup"><span data-stu-id="53a2e-223">The method runs on the current synchronization context and uses time on the thread only when the method is active.</span></span> <span data-ttu-id="53a2e-224">Vous pouvez utiliser <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> pour déplacer le travail lié au processeur vers un thread d'arrière-plan, mais un thread d'arrière-plan ne permet pas à un processus qui attend simplement les résultats de devenir disponible.</span><span class="sxs-lookup"><span data-stu-id="53a2e-224">You can use <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> to move CPU-bound work to a background thread, but a background thread doesn't help with a process that's just waiting for results to become available.</span></span>

<span data-ttu-id="53a2e-225">L’approche basée sur async en matière de programmation asynchrone est préférable aux approches existantes, dans presque tous les cas.</span><span class="sxs-lookup"><span data-stu-id="53a2e-225">The async-based approach to asynchronous programming is preferable to existing approaches in almost every case.</span></span> <span data-ttu-id="53a2e-226">En particulier, cette approche est préférable à la classe <xref:System.ComponentModel.BackgroundWorker> pour les opérations utilisant de nombreuses E/S, car le code est plus simple et il est inutile de vous protéger contre des conditions de concurrence.</span><span class="sxs-lookup"><span data-stu-id="53a2e-226">In particular, this approach is better than the <xref:System.ComponentModel.BackgroundWorker> class for I/O-bound operations because the code is simpler and you don't have to guard against race conditions.</span></span> <span data-ttu-id="53a2e-227">Combinée à la méthode <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType>, la programmation asynchrone est plus appropriée que <xref:System.ComponentModel.BackgroundWorker> pour les opérations utilisant le processeur de manière intensive, car la programmation asynchrone sépare les détails de coordination de l’exécution de votre code à partir du travail que `Task.Run` transfère au pool de threads.</span><span class="sxs-lookup"><span data-stu-id="53a2e-227">In combination with the <xref:System.Threading.Tasks.Task.Run%2A?displayProperty=nameWithType> method, async programming is better than <xref:System.ComponentModel.BackgroundWorker> for CPU-bound operations because async programming separates the coordination details of running your code from the work that `Task.Run` transfers to the threadpool.</span></span>

## <a name="BKMK_AsyncandAwait"></a> <span data-ttu-id="53a2e-228">async and await</span><span class="sxs-lookup"><span data-stu-id="53a2e-228">async and await</span></span>

<span data-ttu-id="53a2e-229">Si vous spécifiez qu’une méthode est une méthode async en utilisant le modificateur [async](../../../language-reference/keywords/async.md), vous activez les deux fonctionnalités suivantes.</span><span class="sxs-lookup"><span data-stu-id="53a2e-229">If you specify that a method is an async method by using the [async](../../../language-reference/keywords/async.md) modifier, you enable the following two capabilities.</span></span>

- <span data-ttu-id="53a2e-230">La méthode async marquée peut utiliser [await](../../../language-reference/operators/await.md) pour indiquer des points d’interruption.</span><span class="sxs-lookup"><span data-stu-id="53a2e-230">The marked async method can use [await](../../../language-reference/operators/await.md) to designate suspension points.</span></span> <span data-ttu-id="53a2e-231">L'opérateur`await` indique au compilateur que la méthode asynchrone ne peut pas continuer au-delà de ce point, tant que le processus asynchrone attendu n'est pas terminé.</span><span class="sxs-lookup"><span data-stu-id="53a2e-231">The `await` operator tells the compiler that the async method can't continue past that point until the awaited asynchronous process is complete.</span></span> <span data-ttu-id="53a2e-232">Entre-temps, le contrôle retourne à l'appelant de la méthode async.</span><span class="sxs-lookup"><span data-stu-id="53a2e-232">In the meantime, control returns to the caller of the async method.</span></span>

     <span data-ttu-id="53a2e-233">La suspension d’une méthode `await` async à une expression ne `finally` constitue pas une sortie de la méthode, et les blocs ne s’exécutent pas.</span><span class="sxs-lookup"><span data-stu-id="53a2e-233">The suspension of an async method at an `await` expression doesn't constitute an exit from the method, and `finally` blocks don't run.</span></span>

- <span data-ttu-id="53a2e-234">La méthode async marquée peut elle-même être attendue par les méthodes qui l'appellent.</span><span class="sxs-lookup"><span data-stu-id="53a2e-234">The marked async method can itself be awaited by methods that call it.</span></span>

<span data-ttu-id="53a2e-235">Une méthode async contient généralement un `await` ou plusieurs événements `await` d’un opérateur, mais l’absence d’expressions ne provoque pas une erreur de compilateur.</span><span class="sxs-lookup"><span data-stu-id="53a2e-235">An async method typically contains one or more occurrences of an `await` operator, but the absence of `await` expressions doesn't cause a compiler error.</span></span> <span data-ttu-id="53a2e-236">Si une méthode async n’utilise pas un `await` opérateur pour marquer un point de suspension, `async` la méthode s’exécute comme une méthode synchrone, malgré le modificateur.</span><span class="sxs-lookup"><span data-stu-id="53a2e-236">If an async method doesn't use an `await` operator to mark a suspension point, the method executes as a synchronous method does, despite the `async` modifier.</span></span> <span data-ttu-id="53a2e-237">Le compilateur émet un avertissement pour ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="53a2e-237">The compiler issues a warning for such methods.</span></span>

<span data-ttu-id="53a2e-238">`async` et `await` sont des mots clés contextuels.</span><span class="sxs-lookup"><span data-stu-id="53a2e-238">`async` and `await` are contextual keywords.</span></span> <span data-ttu-id="53a2e-239">Pour plus d'informations et pour obtenir des exemples, consultez les rubriques suivantes :</span><span class="sxs-lookup"><span data-stu-id="53a2e-239">For more information and examples, see the following topics:</span></span>

- [<span data-ttu-id="53a2e-240">Async</span><span class="sxs-lookup"><span data-stu-id="53a2e-240">async</span></span>](../../../language-reference/keywords/async.md)
- [<span data-ttu-id="53a2e-241">Attendent</span><span class="sxs-lookup"><span data-stu-id="53a2e-241">await</span></span>](../../../language-reference/operators/await.md)

## <a name="BKMK_ReturnTypesandParameters"></a><span data-ttu-id="53a2e-242">Types et paramètres de retour</span><span class="sxs-lookup"><span data-stu-id="53a2e-242">Return types and parameters</span></span>

<span data-ttu-id="53a2e-243">Une méthode async retourne généralement un <xref:System.Threading.Tasks.Task> ou un <xref:System.Threading.Tasks.Task%601>.</span><span class="sxs-lookup"><span data-stu-id="53a2e-243">An async method typically returns a <xref:System.Threading.Tasks.Task> or a <xref:System.Threading.Tasks.Task%601>.</span></span> <span data-ttu-id="53a2e-244">Dans une méthode async, un opérateur `await` est appliqué à une tâche retournée à partir d’un appel à une autre méthode async.</span><span class="sxs-lookup"><span data-stu-id="53a2e-244">Inside an async method, an `await` operator is applied to a task that's returned from a call to another async method.</span></span>

<span data-ttu-id="53a2e-245">Vous <xref:System.Threading.Tasks.Task%601> spécifiez comme type [`return`](../../../language-reference/keywords/return.md) de retour si la méthode `TResult`contient une déclaration qui spécifie un opérande de type .</span><span class="sxs-lookup"><span data-stu-id="53a2e-245">You specify <xref:System.Threading.Tasks.Task%601> as the return type if the method contains a [`return`](../../../language-reference/keywords/return.md) statement that specifies an operand of type `TResult`.</span></span>

<span data-ttu-id="53a2e-246">Vous utilisez <xref:System.Threading.Tasks.Task> comme type de retour si la méthode n’a aucune instruction return ou une instruction return qui ne retourne pas d’opérande.</span><span class="sxs-lookup"><span data-stu-id="53a2e-246">You use <xref:System.Threading.Tasks.Task>  as the return type if the method has no return statement or has a return statement that doesn't return an operand.</span></span>

<span data-ttu-id="53a2e-247">À compter de C# 7.0, vous pouvez également spécifier n’importe quel autre type de retour, sous réserve que ce type inclue une méthode `GetAwaiter`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-247">Starting with C# 7.0, you can also specify any other return type, provided that the type includes a `GetAwaiter` method.</span></span> <span data-ttu-id="53a2e-248"><xref:System.Threading.Tasks.ValueTask%601> est un exemple d’un tel type.</span><span class="sxs-lookup"><span data-stu-id="53a2e-248"><xref:System.Threading.Tasks.ValueTask%601> is an example of such a type.</span></span> <span data-ttu-id="53a2e-249">Il est disponible dans le package NuGet [System.Threading.Tasks.Extension](https://www.nuget.org/packages/System.Threading.Tasks.Extensions/).</span><span class="sxs-lookup"><span data-stu-id="53a2e-249">It is available in the [System.Threading.Tasks.Extension](https://www.nuget.org/packages/System.Threading.Tasks.Extensions/) NuGet package.</span></span>

<span data-ttu-id="53a2e-250">L’exemple suivant montre comment vous déclarez <xref:System.Threading.Tasks.Task%601> et <xref:System.Threading.Tasks.Task>appelez une méthode qui renvoie un ou un :</span><span class="sxs-lookup"><span data-stu-id="53a2e-250">The following example shows how you declare and call a method that returns a <xref:System.Threading.Tasks.Task%601> or a <xref:System.Threading.Tasks.Task>:</span></span>

```csharp
// Signature specifies Task<TResult>
async Task<int> GetTaskOfTResultAsync()
{
    int hours = 0;
    await Task.Delay(0);
    // Return statement specifies an integer result.
    return hours;
}

// Calls to GetTaskOfTResultAsync
Task<int> returnedTaskTResult = GetTaskOfTResultAsync();
int intResult = await returnedTaskTResult;
// or, in a single statement
int intResult = await GetTaskOfTResultAsync();

// Signature specifies Task
async Task GetTaskAsync()
{
    await Task.Delay(0);
    // The method has no return statement.
}

// Calls to GetTaskAsync
Task returnedTask = GetTaskAsync();
await returnedTask;
// or, in a single statement
await GetTaskAsync();
```

<span data-ttu-id="53a2e-251">Chaque tâche retournée représente le travail en cours.</span><span class="sxs-lookup"><span data-stu-id="53a2e-251">Each returned task represents ongoing work.</span></span> <span data-ttu-id="53a2e-252">Une tâche encapsule des informations sur l’état du processus asynchrone et, éventuellement, le résultat final du processus ou l’exception que le processus déclenche s’il ne réussit pas.</span><span class="sxs-lookup"><span data-stu-id="53a2e-252">A task encapsulates information about the state of the asynchronous process and, eventually, either the final result from the process or the exception that the process raises if it doesn't succeed.</span></span>

<span data-ttu-id="53a2e-253">Une méthode async peut également avoir un type de retour `void`.</span><span class="sxs-lookup"><span data-stu-id="53a2e-253">An async method can also have a `void` return type.</span></span> <span data-ttu-id="53a2e-254">Ce type de retour est essentiellement utilisé pour définir les gestionnaires d'événements, où un type de retour `void` est obligatoire.</span><span class="sxs-lookup"><span data-stu-id="53a2e-254">This return type is used primarily to define event handlers, where a `void` return type is required.</span></span> <span data-ttu-id="53a2e-255">Les gestionnaires d'événements asynchrones servent souvent de point de départ aux programmes asynchrones.</span><span class="sxs-lookup"><span data-stu-id="53a2e-255">Async event handlers often serve as the starting point for async programs.</span></span>

<span data-ttu-id="53a2e-256">Une méthode async `void` qui a un type de retour ne peut pas être attendue, et l’appelant d’une méthode de retour vide ne peut pas attraper les exceptions que la méthode jette.</span><span class="sxs-lookup"><span data-stu-id="53a2e-256">An async method that has a `void` return type can't be awaited, and the caller of a void-returning method can't catch any exceptions that the method throws.</span></span>

<span data-ttu-id="53a2e-257">Une méthode async ne peut pas déclarer de paramètres [in](../../../language-reference/keywords/in-parameter-modifier.md), [ref](../../../language-reference/keywords/ref.md) ou [out](../../../language-reference/keywords/out-parameter-modifier.md), mais elle peut appeler des méthodes qui ont ces paramètres.</span><span class="sxs-lookup"><span data-stu-id="53a2e-257">An async method can't declare [in](../../../language-reference/keywords/in-parameter-modifier.md), [ref](../../../language-reference/keywords/ref.md) or [out](../../../language-reference/keywords/out-parameter-modifier.md) parameters, but the method can call methods that have such parameters.</span></span> <span data-ttu-id="53a2e-258">De même, une méthode async ne peut pas retourner une valeur par référence, bien qu’elle puisse appeler des méthodes avec des valeurs de retour de référence.</span><span class="sxs-lookup"><span data-stu-id="53a2e-258">Similarly, an async method can't return a value by reference, although it can call methods with ref return values.</span></span>

<span data-ttu-id="53a2e-259">Pour plus d’informations ainsi que des exemples, consultez la page [Types de retour Async (C#)](./async-return-types.md).</span><span class="sxs-lookup"><span data-stu-id="53a2e-259">For more information and examples, see [Async Return Types (C#)](./async-return-types.md).</span></span> <span data-ttu-id="53a2e-260">Pour plus d’informations sur l’interception des exceptions dans les méthodes async, consultez la page [try-catch](../../../language-reference/keywords/try-catch.md).</span><span class="sxs-lookup"><span data-stu-id="53a2e-260">For more information about how to catch exceptions in async methods, see [try-catch](../../../language-reference/keywords/try-catch.md).</span></span>

<span data-ttu-id="53a2e-261">Les API asynchrones dans la programmation Windows Runtime ont l’un des types de retour suivants, qui sont semblables aux tâches :</span><span class="sxs-lookup"><span data-stu-id="53a2e-261">Asynchronous APIs in Windows Runtime programming have one of the following return types, which are similar to tasks:</span></span>

- <span data-ttu-id="53a2e-262"><xref:Windows.Foundation.IAsyncOperation%601>, qui correspond à <xref:System.Threading.Tasks.Task%601></span><span class="sxs-lookup"><span data-stu-id="53a2e-262"><xref:Windows.Foundation.IAsyncOperation%601>, which corresponds to <xref:System.Threading.Tasks.Task%601></span></span>
- <span data-ttu-id="53a2e-263"><xref:Windows.Foundation.IAsyncAction>, qui correspond à <xref:System.Threading.Tasks.Task></span><span class="sxs-lookup"><span data-stu-id="53a2e-263"><xref:Windows.Foundation.IAsyncAction>, which corresponds to <xref:System.Threading.Tasks.Task></span></span>
- <xref:Windows.Foundation.IAsyncActionWithProgress%601>
- <xref:Windows.Foundation.IAsyncOperationWithProgress%602>

## <a name="BKMK_NamingConvention"></a><span data-ttu-id="53a2e-264">Convention de nommage</span><span class="sxs-lookup"><span data-stu-id="53a2e-264">Naming convention</span></span>

<span data-ttu-id="53a2e-265">Par convention, les méthodes qui retournent généralement des types awaitable (par exemple, `Task`, `Task<T>`, `ValueTask`, `ValueTask<T>`) doivent avoir des noms qui se terminent par « Async ».</span><span class="sxs-lookup"><span data-stu-id="53a2e-265">By convention, methods that return commonly awaitable types (e.g. `Task`, `Task<T>`, `ValueTask`, `ValueTask<T>`) should have names that end with "Async".</span></span> <span data-ttu-id="53a2e-266">Les méthodes qui démarrent une opération asynchrone, mais qui ne retournent pas un type awaitable ne doivent pas avoir un nom qui se termine par « Async ». Cependant, leur nom peut commencer par « Begin », « Start » ou un autre mot suggérant que cette méthode ne retourne pas ou ne lève pas le résultat de l’opération.</span><span class="sxs-lookup"><span data-stu-id="53a2e-266">Methods that start an asynchronous operation but do not return an awaitable type should not have names that end with "Async", but may start with "Begin", "Start", or some other verb to suggest this method does not return or throw the result of the operation.</span></span>

<span data-ttu-id="53a2e-267">Vous pouvez ignorer la convention où un événement, une classe de base, ou un contrat d'interface suggère un nom différent.</span><span class="sxs-lookup"><span data-stu-id="53a2e-267">You can ignore the convention where an event, base class, or interface contract suggests a different name.</span></span> <span data-ttu-id="53a2e-268">Par exemple, vous ne devriez pas renommer les `Button1_Click`gestionnaires d’événements communs, tels que .</span><span class="sxs-lookup"><span data-stu-id="53a2e-268">For example, you shouldn't rename common event handlers, such as `Button1_Click`.</span></span>

## <a name="BKMK_RelatedTopics"></a><span data-ttu-id="53a2e-269">Sujets et échantillons connexes (Visual Studio)</span><span class="sxs-lookup"><span data-stu-id="53a2e-269">Related topics and samples (Visual Studio)</span></span>

|<span data-ttu-id="53a2e-270">Intitulé</span><span class="sxs-lookup"><span data-stu-id="53a2e-270">Title</span></span>|<span data-ttu-id="53a2e-271">Description</span><span class="sxs-lookup"><span data-stu-id="53a2e-271">Description</span></span>|<span data-ttu-id="53a2e-272">Exemple</span><span class="sxs-lookup"><span data-stu-id="53a2e-272">Sample</span></span>|
|-----------|-----------------|------------|
|[<span data-ttu-id="53a2e-273">Procédure pas à pas : accès au web avec async et await (C#)</span><span class="sxs-lookup"><span data-stu-id="53a2e-273">Walkthrough: Accessing the Web by Using async and await (C#)</span></span>](./walkthrough-accessing-the-web-by-using-async-and-await.md)|<span data-ttu-id="53a2e-274">Montre comment convertir une solution WPF synchrone en une solution WPF asynchrone.</span><span class="sxs-lookup"><span data-stu-id="53a2e-274">Shows how to convert a synchronous WPF solution to an asynchronous WPF solution.</span></span> <span data-ttu-id="53a2e-275">L’application télécharge une série de sites web.</span><span class="sxs-lookup"><span data-stu-id="53a2e-275">The application downloads a series of websites.</span></span>|[<span data-ttu-id="53a2e-276">Exemple Async : Accès à la procédure web</span><span class="sxs-lookup"><span data-stu-id="53a2e-276">Async Sample: Accessing the Web Walkthrough</span></span>](https://code.msdn.microsoft.com/Async-Sample-Accessing-the-9c10497f)|
|[<span data-ttu-id="53a2e-277">Comment étendre la procédure pas à pas async en utilisant Task.WhenAll (C)</span><span class="sxs-lookup"><span data-stu-id="53a2e-277">How to extend the async walkthrough by using Task.WhenAll (C#)</span></span>](./how-to-extend-the-async-walkthrough-by-using-task-whenall.md)|<span data-ttu-id="53a2e-278">Ajoute <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> à la procédure précédente.</span><span class="sxs-lookup"><span data-stu-id="53a2e-278">Adds <xref:System.Threading.Tasks.Task.WhenAll%2A?displayProperty=nameWithType> to the previous walkthrough.</span></span> <span data-ttu-id="53a2e-279">L'utilisation de `WhenAll` démarre tous les téléchargements en même temps.</span><span class="sxs-lookup"><span data-stu-id="53a2e-279">The use of `WhenAll` starts all the downloads at the same time.</span></span>||
|[<span data-ttu-id="53a2e-280">Comment faire plusieurs demandes web en parallèle en utilisant async et attendre (C)</span><span class="sxs-lookup"><span data-stu-id="53a2e-280">How to make multiple web requests in parallel by using async and await (C#)</span></span>](./how-to-make-multiple-web-requests-in-parallel-by-using-async-and-await.md)|<span data-ttu-id="53a2e-281">Explique comment démarrer plusieurs tâches en même temps.</span><span class="sxs-lookup"><span data-stu-id="53a2e-281">Demonstrates how to start several tasks at the same time.</span></span>|[<span data-ttu-id="53a2e-282">Exemple Async : effectuer plusieurs requêtes web en parallèle</span><span class="sxs-lookup"><span data-stu-id="53a2e-282">Async Sample: Make Multiple Web Requests in Parallel</span></span>](https://code.msdn.microsoft.com/Async-Make-Multiple-Web-49adb82e)|
|[<span data-ttu-id="53a2e-283">Types de retour async (C#)</span><span class="sxs-lookup"><span data-stu-id="53a2e-283">Async Return Types (C#)</span></span>](./async-return-types.md)|<span data-ttu-id="53a2e-284">Décrit les types que les méthodes async peuvent retourner et explique quand chaque type est approprié.</span><span class="sxs-lookup"><span data-stu-id="53a2e-284">Illustrates the types that async methods can return and explains when each type is appropriate.</span></span>||
|[<span data-ttu-id="53a2e-285">Flux de contrôle dans les programmes Async (C)</span><span class="sxs-lookup"><span data-stu-id="53a2e-285">Control Flow in Async Programs (C#)</span></span>](./control-flow-in-async-programs.md)|<span data-ttu-id="53a2e-286">Effectue le suivi en détail du flux de contrôle via une série d'expressions await dans un programme asynchrone.</span><span class="sxs-lookup"><span data-stu-id="53a2e-286">Traces in detail the flow of control through a succession of await expressions in an asynchronous program.</span></span>|[<span data-ttu-id="53a2e-287">Exemple Async : flux de contrôle dans les programmes Async</span><span class="sxs-lookup"><span data-stu-id="53a2e-287">Async Sample: Control Flow in Async Programs</span></span>](https://code.msdn.microsoft.com/Async-Sample-Control-Flow-5c804fc0)|
|[<span data-ttu-id="53a2e-288">Réglage de votre application asynchrone (C#)</span><span class="sxs-lookup"><span data-stu-id="53a2e-288">Fine-Tuning Your Async Application (C#)</span></span>](./fine-tuning-your-async-application.md)|<span data-ttu-id="53a2e-289">Indique comment ajouter les fonctionnalités suivantes à votre solution async :</span><span class="sxs-lookup"><span data-stu-id="53a2e-289">Shows how to add the following functionality to your async solution:</span></span><br /><br /> <span data-ttu-id="53a2e-290">- [Annuler une tâche Async ou une liste de tâches (C)](./cancel-an-async-task-or-a-list-of-tasks.md)</span><span class="sxs-lookup"><span data-stu-id="53a2e-290">- [Cancel an Async Task or a List of Tasks (C#)](./cancel-an-async-task-or-a-list-of-tasks.md)</span></span><br /><span data-ttu-id="53a2e-291">- [Annuler les tâches Async après une période de temps (C)](./cancel-async-tasks-after-a-period-of-time.md)</span><span class="sxs-lookup"><span data-stu-id="53a2e-291">- [Cancel Async Tasks after a Period of Time (C#)](./cancel-async-tasks-after-a-period-of-time.md)</span></span><br /><span data-ttu-id="53a2e-292">- [Annuler les tâches Async restantes après qu’une tâche soit terminée (C)](./cancel-remaining-async-tasks-after-one-is-complete.md)</span><span class="sxs-lookup"><span data-stu-id="53a2e-292">- [Cancel Remaining Async Tasks after One Is Complete (C#)](./cancel-remaining-async-tasks-after-one-is-complete.md)</span></span><br /><span data-ttu-id="53a2e-293">- [Démarrer plusieurs tâches Async et les traiter au fur et à mesure qu’elles complètent (C)](./start-multiple-async-tasks-and-process-them-as-they-complete.md)</span><span class="sxs-lookup"><span data-stu-id="53a2e-293">- [Start Multiple Async Tasks and Process Them As They Complete (C#)](./start-multiple-async-tasks-and-process-them-as-they-complete.md)</span></span>|[<span data-ttu-id="53a2e-294">Exemple Async : ajuster une application</span><span class="sxs-lookup"><span data-stu-id="53a2e-294">Async Sample: Fine Tuning Your Application</span></span>](https://code.msdn.microsoft.com/Async-Fine-Tuning-Your-a676abea)|
|[<span data-ttu-id="53a2e-295">Gestion de la réentrance dans Async Apps (C#)</span><span class="sxs-lookup"><span data-stu-id="53a2e-295">Handling Reentrancy in Async Apps (C#)</span></span>](./handling-reentrancy-in-async-apps.md)|<span data-ttu-id="53a2e-296">Montre comment gérer les cas dans lesquels une opération asynchrone active est redémarrée pendant qu’elle est en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="53a2e-296">Shows how to handle cases in which an active asynchronous operation is restarted while it's running.</span></span>||
|<span data-ttu-id="53a2e-297">[WhenAny : transition entre .NET Framework et Windows Runtime](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/jj635140(v=vs.120))</span><span class="sxs-lookup"><span data-stu-id="53a2e-297">[WhenAny: Bridging between the .NET Framework and the Windows Runtime](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/jj635140(v=vs.120))</span></span>|<span data-ttu-id="53a2e-298">Montre comment établir un pont entre les types de tâches du .NET Framework et IAsyncOperations dans Windows Runtime pour pouvoir utiliser <xref:System.Threading.Tasks.Task.WhenAny%2A> avec une méthode Windows Runtime.</span><span class="sxs-lookup"><span data-stu-id="53a2e-298">Shows how to bridge between Task types in the .NET Framework and IAsyncOperations in the Windows Runtime so that you can use <xref:System.Threading.Tasks.Task.WhenAny%2A> with a Windows Runtime method.</span></span>|[<span data-ttu-id="53a2e-299">Exemple Async : transition entre .NET et Windows Runtime (AsTask et WhenAny)</span><span class="sxs-lookup"><span data-stu-id="53a2e-299">Async Sample: Bridging between .NET and Windows Runtime (AsTask and WhenAny)</span></span>](https://code.msdn.microsoft.com/Async-Sample-Bridging-d6a2f739)|
|<span data-ttu-id="53a2e-300">Annulation Asynch : combler l'écart entre .NET Framework et Windows Runtime</span><span class="sxs-lookup"><span data-stu-id="53a2e-300">Async Cancellation: Bridging between the .NET Framework and the Windows Runtime</span></span>|<span data-ttu-id="53a2e-301">Montre comment établir un pont entre les types de tâches du .NET Framework et IAsyncOperations dans Windows Runtime pour pouvoir utiliser <xref:System.Threading.CancellationTokenSource> avec une méthode Windows Runtime.</span><span class="sxs-lookup"><span data-stu-id="53a2e-301">Shows how to bridge between Task types in the .NET Framework and IAsyncOperations in the Windows Runtime so that you can use <xref:System.Threading.CancellationTokenSource> with a Windows Runtime method.</span></span>|[<span data-ttu-id="53a2e-302">Exemple Async : transition entre .NET et Windows Runtime (AsTask & Annulation)</span><span class="sxs-lookup"><span data-stu-id="53a2e-302">Async Sample: Bridging between .NET and Windows Runtime (AsTask & Cancellation)</span></span>](https://code.msdn.microsoft.com/Async-Sample-Bridging-9479eca3)|
|[<span data-ttu-id="53a2e-303">Utiliser async pour l’accès aux fichiers (C#)</span><span class="sxs-lookup"><span data-stu-id="53a2e-303">Using Async for File Access (C#)</span></span>](./using-async-for-file-access.md)|<span data-ttu-id="53a2e-304">Répertorie et explique les avantages de l'utilisation d'async et d'await pour accéder aux fichiers.</span><span class="sxs-lookup"><span data-stu-id="53a2e-304">Lists and demonstrates the benefits of using async and await to access files.</span></span>||
|[<span data-ttu-id="53a2e-305">Modèle asynchrone basé sur les tâches (TAP, Task-based Asynchronous Pattern)</span><span class="sxs-lookup"><span data-stu-id="53a2e-305">Task-based Asynchronous Pattern (TAP)</span></span>](../../../../standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md)|<span data-ttu-id="53a2e-306">Décrit un nouveau modèle pour le comportement asynchrone dans le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="53a2e-306">Describes a new pattern for asynchrony in the .NET Framework.</span></span> <span data-ttu-id="53a2e-307">Le modèle est basé sur les types <xref:System.Threading.Tasks.Task> et <xref:System.Threading.Tasks.Task%601>.</span><span class="sxs-lookup"><span data-stu-id="53a2e-307">The pattern is based on the <xref:System.Threading.Tasks.Task> and <xref:System.Threading.Tasks.Task%601> types.</span></span>||
|[<span data-ttu-id="53a2e-308">Vidéos Async sur Channel 9</span><span class="sxs-lookup"><span data-stu-id="53a2e-308">Async Videos on Channel 9</span></span>](https://channel9.msdn.com/search?term=async%20&type=All#pubDate=year&ch9Search&lang-en=en)|<span data-ttu-id="53a2e-309">Fournit des liens vers diverses vidéos sur la programmation asynchrone.</span><span class="sxs-lookup"><span data-stu-id="53a2e-309">Provides links to a variety of videos about async programming.</span></span>||

## <a name="BKMK_CompleteExample"></a><span data-ttu-id="53a2e-310">Exemple complet</span><span class="sxs-lookup"><span data-stu-id="53a2e-310">Complete example</span></span>

<span data-ttu-id="53a2e-311">Le code suivant est le *fichier MainWindow.xaml.cs* de l’application WPF dont cet article traite.</span><span class="sxs-lookup"><span data-stu-id="53a2e-311">The following code is the *MainWindow.xaml.cs* file from the WPF application that this article discusses.</span></span> <span data-ttu-id="53a2e-312">Vous pouvez télécharger l’exemple sur [Exemple async : exemple de « programmation asynchrone avec async et await »](https://docs.microsoft.com/samples/dotnet/samples/async-and-await-cs/).</span><span class="sxs-lookup"><span data-stu-id="53a2e-312">You can download the sample from [Async Sample: Example from "Asynchronous Programming with Async and Await"](https://docs.microsoft.com/samples/dotnet/samples/async-and-await-cs/).</span></span>

[!code-csharp[async](~/samples/snippets/standard/async/async-and-await/cs/MainWindow.xaml.cs)]

## <a name="see-also"></a><span data-ttu-id="53a2e-313">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="53a2e-313">See also</span></span>

- [<span data-ttu-id="53a2e-314">Async</span><span class="sxs-lookup"><span data-stu-id="53a2e-314">async</span></span>](../../../language-reference/keywords/async.md)
- [<span data-ttu-id="53a2e-315">Attendent</span><span class="sxs-lookup"><span data-stu-id="53a2e-315">await</span></span>](../../../language-reference/operators/await.md)
- [<span data-ttu-id="53a2e-316">Programmation asynchrone</span><span class="sxs-lookup"><span data-stu-id="53a2e-316">Asynchronous programming</span></span>](../../../async.md)
- [<span data-ttu-id="53a2e-317">Aperçu Async</span><span class="sxs-lookup"><span data-stu-id="53a2e-317">Async overview</span></span>](../../../../standard/async.md)

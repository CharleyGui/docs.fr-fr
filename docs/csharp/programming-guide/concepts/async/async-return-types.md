---
title: Types de retour Async (C#)
description: Découvrez les types de retour que les méthodes Async peuvent avoir en C# avec des exemples de code pour chaque type et des ressources supplémentaires.
ms.date: 08/19/2020
ms.assetid: ddb2539c-c898-48c1-ad92-245e4a996df8
ms.openlocfilehash: 71e560ed8ee0cae14da396e5ea2f3ab29611ebab
ms.sourcegitcommit: 9c45035b781caebc63ec8ecf912dc83fb6723b1f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/25/2020
ms.locfileid: "88811494"
---
# <a name="async-return-types-c"></a><span data-ttu-id="6c82b-103">Types de retour Async (C#)</span><span class="sxs-lookup"><span data-stu-id="6c82b-103">Async return types (C#)</span></span>

<span data-ttu-id="6c82b-104">Les méthodes async peuvent avoir les types de retour suivants :</span><span class="sxs-lookup"><span data-stu-id="6c82b-104">Async methods can have the following return types:</span></span>

- <span data-ttu-id="6c82b-105"><xref:System.Threading.Tasks.Task>, pour une méthode async qui effectue une opération mais ne retourne aucune valeur.</span><span class="sxs-lookup"><span data-stu-id="6c82b-105"><xref:System.Threading.Tasks.Task>, for an async method that performs an operation but returns no value.</span></span>
- <span data-ttu-id="6c82b-106"><xref:System.Threading.Tasks.Task%601>, pour une méthode async qui retourne une valeur.</span><span class="sxs-lookup"><span data-stu-id="6c82b-106"><xref:System.Threading.Tasks.Task%601>, for an async method that returns a value.</span></span>
- <span data-ttu-id="6c82b-107">`void`, pour un gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="6c82b-107">`void`, for an event handler.</span></span>
- <span data-ttu-id="6c82b-108">À compter de C# 7.0, tout type ayant une méthode `GetAwaiter` accessible.</span><span class="sxs-lookup"><span data-stu-id="6c82b-108">Starting with C# 7.0, any type that has an accessible `GetAwaiter` method.</span></span> <span data-ttu-id="6c82b-109">L’objet retourné par la méthode `GetAwaiter` doit implémenter l’interface <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6c82b-109">The object returned by the `GetAwaiter` method must implement the <xref:System.Runtime.CompilerServices.ICriticalNotifyCompletion?displayProperty=nameWithType> interface.</span></span>
- <span data-ttu-id="6c82b-110">À compter de C# 8,0, <xref:System.Collections.Generic.IAsyncEnumerable%601> , pour une méthode Async qui retourne un *flux asynchrone*.</span><span class="sxs-lookup"><span data-stu-id="6c82b-110">Starting with C# 8.0, <xref:System.Collections.Generic.IAsyncEnumerable%601>, for an async method that returns an *async stream*.</span></span>

<span data-ttu-id="6c82b-111">Pour plus d’informations sur les méthodes Async, consultez [programmation asynchrone avec Async et await (C#)](./index.md).</span><span class="sxs-lookup"><span data-stu-id="6c82b-111">For more information about async methods, see [Asynchronous programming with async and await (C#)](./index.md).</span></span>

<span data-ttu-id="6c82b-112">Il existe également plusieurs autres types spécifiques aux charges de travail Windows :</span><span class="sxs-lookup"><span data-stu-id="6c82b-112">Several other types also exist that are specific to Windows workloads:</span></span>

- <span data-ttu-id="6c82b-113"><xref:System.Windows.Threading.DispatcherOperation>, pour les opérations asynchrones limitées à Windows.</span><span class="sxs-lookup"><span data-stu-id="6c82b-113"><xref:System.Windows.Threading.DispatcherOperation>, for async operations limited to Windows.</span></span>
- <span data-ttu-id="6c82b-114"><xref:Windows.Foundation.IAsyncAction>, pour les actions asynchrones dans UWP qui ne retournent pas de valeur.</span><span class="sxs-lookup"><span data-stu-id="6c82b-114"><xref:Windows.Foundation.IAsyncAction>, for async actions in UWP that do not return a value.</span></span>
- <span data-ttu-id="6c82b-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601>, pour les actions asynchrones dans UWP qui signalent la progression mais ne retournent pas de valeur.</span><span class="sxs-lookup"><span data-stu-id="6c82b-115"><xref:Windows.Foundation.IAsyncActionWithProgress%601>, for async actions in UWP that report progress but do not return a value.</span></span>
- <span data-ttu-id="6c82b-116"><xref:Windows.Foundation.IAsyncOperation%601>, pour les opérations asynchrones dans UWP qui retournent une valeur.</span><span class="sxs-lookup"><span data-stu-id="6c82b-116"><xref:Windows.Foundation.IAsyncOperation%601>, for async operations in UWP that return a value.</span></span>
- <span data-ttu-id="6c82b-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602>, pour les opérations asynchrones dans UWP qui signalent la progression et retournent une valeur.</span><span class="sxs-lookup"><span data-stu-id="6c82b-117"><xref:Windows.Foundation.IAsyncOperationWithProgress%602>, for async operations in UWP that report progress and return a value.</span></span>

## <a name="task-return-type"></a><span data-ttu-id="6c82b-118">Type de retour de la tâche</span><span class="sxs-lookup"><span data-stu-id="6c82b-118">Task return type</span></span>

<span data-ttu-id="6c82b-119">Les méthodes async qui ne contiennent pas d’instruction `return` ou qui contiennent une instruction `return` ne retournant pas d’opérande ont généralement un type de retour <xref:System.Threading.Tasks.Task>.</span><span class="sxs-lookup"><span data-stu-id="6c82b-119">Async methods that don't contain a `return` statement or that contain a `return` statement that doesn't return an operand usually have a return type of <xref:System.Threading.Tasks.Task>.</span></span> <span data-ttu-id="6c82b-120">De telles méthodes retournent `void` si elles s’exécutent de façon synchrone.</span><span class="sxs-lookup"><span data-stu-id="6c82b-120">Such methods return `void` if they run synchronously.</span></span> <span data-ttu-id="6c82b-121">Si vous utilisez un type de retour <xref:System.Threading.Tasks.Task> pour une méthode async, une méthode d’appel peut utiliser un opérateur `await` pour suspendre l’achèvement de l’appelant jusqu’à ce que la méthode async soit terminée.</span><span class="sxs-lookup"><span data-stu-id="6c82b-121">If you use a <xref:System.Threading.Tasks.Task> return type for an async method, a calling method can use an `await` operator to suspend the caller's completion until the called async method has finished.</span></span>

<span data-ttu-id="6c82b-122">Dans l’exemple suivant, la `WaitAndApologizeAsync` méthode ne contient pas d' `return` instruction, donc la méthode retourne un <xref:System.Threading.Tasks.Task> objet.</span><span class="sxs-lookup"><span data-stu-id="6c82b-122">In the following example, the `WaitAndApologizeAsync` method doesn't contain a `return` statement, so the method returns a <xref:System.Threading.Tasks.Task> object.</span></span> <span data-ttu-id="6c82b-123">Le retour `Task` d’un permet `WaitAndApologizeAsync` à d’être attendu.</span><span class="sxs-lookup"><span data-stu-id="6c82b-123">Returning a `Task` enables `WaitAndApologizeAsync` to be awaited.</span></span> <span data-ttu-id="6c82b-124">Le <xref:System.Threading.Tasks.Task> type n’inclut `Result` pas de propriété, car il n’a pas de valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="6c82b-124">The <xref:System.Threading.Tasks.Task> type doesn't include a `Result` property because it has no return value.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2.cs" id="TaskReturn":::

<span data-ttu-id="6c82b-125">`WaitAndApologizeAsync` est attendue avec une instruction await au lieu d’une expression await, comme pour l’instruction d’appel d’une méthode synchrone retournant un type void.</span><span class="sxs-lookup"><span data-stu-id="6c82b-125">`WaitAndApologizeAsync` is awaited by using an await statement instead of an await expression, similar to the calling statement for a synchronous void-returning method.</span></span> <span data-ttu-id="6c82b-126">Dans ce cas, l’application d’un opérateur await ne génère pas de valeur.</span><span class="sxs-lookup"><span data-stu-id="6c82b-126">The application of an await operator in this case doesn't produce a value.</span></span> <span data-ttu-id="6c82b-127">Pour clarifier les termes instruction et expression, reportez-vous au tableau ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="6c82b-127">To clarify the terms statement and expression, refer to the table below:</span></span>

| <span data-ttu-id="6c82b-128">Type await</span><span class="sxs-lookup"><span data-stu-id="6c82b-128">Await kind</span></span> | <span data-ttu-id="6c82b-129">Exemple</span><span class="sxs-lookup"><span data-stu-id="6c82b-129">Example</span></span>                                      | <span data-ttu-id="6c82b-130">Type</span><span class="sxs-lookup"><span data-stu-id="6c82b-130">Type</span></span>                                   |
|------------|----------------------------------------------|----------------------------------------|
| <span data-ttu-id="6c82b-131">.</span><span class="sxs-lookup"><span data-stu-id="6c82b-131">Statement</span></span>  | `await SomeTaskMethodAsync()`                | <xref:System.Threading.Tasks.Task>     |
| <span data-ttu-id="6c82b-132">Expression</span><span class="sxs-lookup"><span data-stu-id="6c82b-132">Expression</span></span> | `T result = await SomeTaskMethodAsync<T>();` | <xref:System.Threading.Tasks.Task%601> |

<span data-ttu-id="6c82b-133">Vous pouvez séparer l’appel à `WaitAndApologizeAsync` de l’application d’un opérateur await, comme le montre le code suivant.</span><span class="sxs-lookup"><span data-stu-id="6c82b-133">You can separate the call to `WaitAndApologizeAsync` from the application of an await operator, as the following code shows.</span></span> <span data-ttu-id="6c82b-134">Cependant, n’oubliez pas qu’un type `Task` n’a pas de propriété `Result` et qu’aucune valeur n’est générée quand un opérateur await est appliqué à un type `Task`.</span><span class="sxs-lookup"><span data-stu-id="6c82b-134">However, remember that a `Task` doesn't have a `Result` property, and that no value is produced when an await operator is applied to a `Task`.</span></span>

<span data-ttu-id="6c82b-135">Le code suivant sépare l’appel à la méthode `WaitAndApologizeAsync` de l’attente de la tâche que retourne la méthode.</span><span class="sxs-lookup"><span data-stu-id="6c82b-135">The following code separates calling the `WaitAndApologizeAsync` method from awaiting the task that the method returns.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns2a.cs" id="AwaitTask":::

## <a name="tasktresult-return-type"></a><span data-ttu-id="6c82b-136">Type de retour de la tâche \<TResult\></span><span class="sxs-lookup"><span data-stu-id="6c82b-136">Task\<TResult\> return type</span></span>

<span data-ttu-id="6c82b-137">Le <xref:System.Threading.Tasks.Task%601> type de retour est utilisé pour une méthode Async qui contient une instruction [Return](../../../language-reference/keywords/return.md) dans laquelle l’opérande est `TResult` .</span><span class="sxs-lookup"><span data-stu-id="6c82b-137">The <xref:System.Threading.Tasks.Task%601> return type is used for an async method that contains a [return](../../../language-reference/keywords/return.md) statement in which the operand is `TResult`.</span></span>

<span data-ttu-id="6c82b-138">Dans l’exemple suivant, la `GetLeisureHoursAsync` méthode contient une `return` instruction qui retourne un entier.</span><span class="sxs-lookup"><span data-stu-id="6c82b-138">In the following example, the `GetLeisureHoursAsync` method contains a `return` statement that returns an integer.</span></span> <span data-ttu-id="6c82b-139">La déclaration de méthode doit donc spécifier un type de retour `Task<int>`.</span><span class="sxs-lookup"><span data-stu-id="6c82b-139">Therefore, the method declaration must specify a return type of `Task<int>`.</span></span> <span data-ttu-id="6c82b-140">La <xref:System.Threading.Tasks.Task.FromResult%2A> méthode Async est un espace réservé pour une opération qui retourne un <xref:System.DateTime.DayOfWeek> .</span><span class="sxs-lookup"><span data-stu-id="6c82b-140">The <xref:System.Threading.Tasks.Task.FromResult%2A> async method is a placeholder for an operation that returns a <xref:System.DateTime.DayOfWeek>.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1.cs" id="LeisureHours":::

<span data-ttu-id="6c82b-141">Quand la méthode `GetLeisureHoursAsync` est appelée à partir d’une expression await dans la méthode `ShowTodaysInfo`, cette expression récupère la valeur entière (la valeur de `leisureHours`) qui est stockée dans la tâche retournée par la méthode `GetLeisureHours`.</span><span class="sxs-lookup"><span data-stu-id="6c82b-141">When `GetLeisureHoursAsync` is called from within an await expression in the `ShowTodaysInfo` method, the await expression retrieves the integer value (the value of `leisureHours`) that's stored in the task returned by the `GetLeisureHours` method.</span></span> <span data-ttu-id="6c82b-142">Pour plus d’informations sur les expressions await, consultez [await](../../../language-reference/operators/await.md).</span><span class="sxs-lookup"><span data-stu-id="6c82b-142">For more information about await expressions, see [await](../../../language-reference/operators/await.md).</span></span>

<span data-ttu-id="6c82b-143">Vous pouvez mieux comprendre comment `await` récupère le résultat d’un `Task<T>` en séparant l’appel à `GetLeisureHoursAsync` de l’application de `await` , comme le montre le code suivant.</span><span class="sxs-lookup"><span data-stu-id="6c82b-143">You can better understand how `await` retrieves the result from a `Task<T>` by separating the call to `GetLeisureHoursAsync` from the application of `await`, as the following code shows.</span></span> <span data-ttu-id="6c82b-144">Un appel à la méthode `GetLeisureHoursAsync` qui n’est pas immédiatement attendue retourne un type `Task<int>`, comme vous pourriez l’attendre de la déclaration de la méthode.</span><span class="sxs-lookup"><span data-stu-id="6c82b-144">A call to method `GetLeisureHoursAsync` that isn't immediately awaited returns a `Task<int>`, as you would expect from the declaration of the method.</span></span> <span data-ttu-id="6c82b-145">La tâche est assignée à la variable `getLeisureHoursTask` dans l’exemple.</span><span class="sxs-lookup"><span data-stu-id="6c82b-145">The task is assigned to the `getLeisureHoursTask` variable in the example.</span></span> <span data-ttu-id="6c82b-146">Comme `getLeisureHoursTask` est un <xref:System.Threading.Tasks.Task%601>, il contient une propriété <xref:System.Threading.Tasks.Task%601.Result> de type `TResult`.</span><span class="sxs-lookup"><span data-stu-id="6c82b-146">Because `getLeisureHoursTask` is a <xref:System.Threading.Tasks.Task%601>, it contains a <xref:System.Threading.Tasks.Task%601.Result> property of type `TResult`.</span></span> <span data-ttu-id="6c82b-147">Dans ce cas, `TResult` représente un type entier.</span><span class="sxs-lookup"><span data-stu-id="6c82b-147">In this case, `TResult` represents an integer type.</span></span> <span data-ttu-id="6c82b-148">Quand `await` est appliqué à `getLeisureHoursTask`, l’expression await prend pour la valeur le contenu de la propriété <xref:System.Threading.Tasks.Task%601.Result%2A> de `getLeisureHoursTask`.</span><span class="sxs-lookup"><span data-stu-id="6c82b-148">When `await` is applied to `getLeisureHoursTask`, the await expression evaluates to the contents of the <xref:System.Threading.Tasks.Task%601.Result%2A> property of `getLeisureHoursTask`.</span></span> <span data-ttu-id="6c82b-149">La valeur est assignée à la variable `ret`.</span><span class="sxs-lookup"><span data-stu-id="6c82b-149">The value is assigned to the `ret` variable.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="6c82b-150"><xref:System.Threading.Tasks.Task%601.Result%2A> est une propriété bloquante.</span><span class="sxs-lookup"><span data-stu-id="6c82b-150">The <xref:System.Threading.Tasks.Task%601.Result%2A> property is a blocking property.</span></span> <span data-ttu-id="6c82b-151">Si vous essayez d’y accéder avant la fin de sa tâche, le thread actif est bloqué tant que la tâche n’est pas terminée et que la valeur n’est pas disponible.</span><span class="sxs-lookup"><span data-stu-id="6c82b-151">If you try to access it before its task is finished, the thread that's currently active is blocked until the task completes and the value is available.</span></span> <span data-ttu-id="6c82b-152">Dans la plupart des cas, vous devez accéder à la valeur avec `await` au lieu d’accéder directement à la propriété.</span><span class="sxs-lookup"><span data-stu-id="6c82b-152">In most cases, you should access the value by using `await` instead of accessing the property directly.</span></span>
>
> <span data-ttu-id="6c82b-153">L’exemple précédent a récupéré la valeur de la <xref:System.Threading.Tasks.Task%601.Result%2A> propriété pour bloquer le thread principal afin que la `Main` méthode puisse imprimer `message` dans la console avant la fin de l’application.</span><span class="sxs-lookup"><span data-stu-id="6c82b-153">The previous example retrieved the value of the <xref:System.Threading.Tasks.Task%601.Result%2A> property to block the main thread so that the `Main` method could print the `message` to the console before the application ended.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns1a.cs" id="StoreTask":::

## <a name="void-return-type"></a><span data-ttu-id="6c82b-154"> Type de retour void</span><span class="sxs-lookup"><span data-stu-id="6c82b-154">Void return type</span></span>

<span data-ttu-id="6c82b-155">Vous utilisez le type de retour `void` dans les gestionnaires d’événements asynchrones, lesquels exigent un type de retour `void`.</span><span class="sxs-lookup"><span data-stu-id="6c82b-155">You use the `void` return type in asynchronous event handlers, which require a `void` return type.</span></span> <span data-ttu-id="6c82b-156">Pour les méthodes autres que les gestionnaires d’événements qui ne retournent pas de valeur, vous devez retourner <xref:System.Threading.Tasks.Task> à la place, car une méthode async qui retourne `void` ne peut pas être attendue.</span><span class="sxs-lookup"><span data-stu-id="6c82b-156">For methods other than event handlers that don't return a value, you should return a <xref:System.Threading.Tasks.Task> instead, because an async method that returns `void` can't be awaited.</span></span> <span data-ttu-id="6c82b-157">Tout appelant d’une telle méthode doit continuer à se terminer sans attendre la fin de la méthode Async appelée.</span><span class="sxs-lookup"><span data-stu-id="6c82b-157">Any caller of such a method must continue to completion without waiting for the called async method to finish.</span></span> <span data-ttu-id="6c82b-158">L’appelant doit être indépendant des valeurs ou des exceptions générées par la méthode Async.</span><span class="sxs-lookup"><span data-stu-id="6c82b-158">The caller must be independent of any values or exceptions that the async method generates.</span></span>

<span data-ttu-id="6c82b-159">L’appelant d’une méthode Async qui retourne void ne peut pas intercepter les exceptions levées à partir de la méthode, et ces exceptions non gérées sont susceptibles de provoquer l’échec de votre application.</span><span class="sxs-lookup"><span data-stu-id="6c82b-159">The caller of a void-returning async method can't catch exceptions thrown from the method, and such unhandled exceptions are likely to cause your application to fail.</span></span> <span data-ttu-id="6c82b-160">Si une méthode qui retourne un <xref:System.Threading.Tasks.Task> ou <xref:System.Threading.Tasks.Task%601> lève une exception, l’exception est stockée dans la tâche retournée.</span><span class="sxs-lookup"><span data-stu-id="6c82b-160">If a method that returns a <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> throws an exception, the exception is stored in the returned task.</span></span> <span data-ttu-id="6c82b-161">L’exception est levée une nouvelle fois lorsque la tâche est attendue.</span><span class="sxs-lookup"><span data-stu-id="6c82b-161">The exception is rethrown when the task is awaited.</span></span> <span data-ttu-id="6c82b-162">Par conséquent, veillez à ce qu’une méthode async capable de générer une exception ait le type de retour <xref:System.Threading.Tasks.Task> ou <xref:System.Threading.Tasks.Task%601> et que les appels à la méthode soient attendus.</span><span class="sxs-lookup"><span data-stu-id="6c82b-162">Therefore, make sure that any async method that can produce an exception has a return type of <xref:System.Threading.Tasks.Task> or <xref:System.Threading.Tasks.Task%601> and that calls to the method are awaited.</span></span>

<span data-ttu-id="6c82b-163">Pour plus d’informations sur la façon d’intercepter des exceptions dans les méthodes Async, consultez la section [exceptions dans les méthodes Async](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) de l’article [try-catch](../../../language-reference/keywords/try-catch.md) .</span><span class="sxs-lookup"><span data-stu-id="6c82b-163">For more information about how to catch exceptions in async methods, see the [Exceptions in async methods](../../../language-reference/keywords/try-catch.md#exceptions-in-async-methods) section of the [try-catch](../../../language-reference/keywords/try-catch.md) article.</span></span>

<span data-ttu-id="6c82b-164">L’exemple suivant illustre le comportement d’un gestionnaire d’événements asynchrones.</span><span class="sxs-lookup"><span data-stu-id="6c82b-164">The following example shows the behavior of an async event handler.</span></span> <span data-ttu-id="6c82b-165">Dans l’exemple de code, un gestionnaire d’événements asynchrones doit permettre au thread principal de savoir quand il se termine.</span><span class="sxs-lookup"><span data-stu-id="6c82b-165">In the example code, an async event handler must let the main thread know when it finishes.</span></span> <span data-ttu-id="6c82b-166">Le thread principal peut donc attendre la fin d’un gestionnaire d’événements asynchrones avant de quitter le programme.</span><span class="sxs-lookup"><span data-stu-id="6c82b-166">Then the main thread can wait for an async event handler to complete before exiting the program.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-returns3.cs":::

## <a name="generalized-async-return-types-and-valuetasktresult"></a><span data-ttu-id="6c82b-167">Types de retour async généralisés et ValueTask\<TResult\></span><span class="sxs-lookup"><span data-stu-id="6c82b-167">Generalized async return types and ValueTask\<TResult\></span></span>

<span data-ttu-id="6c82b-168">À compter de C# 7.0, une méthode async peut retourner tout type ayant une méthode `GetAwaiter` accessible.</span><span class="sxs-lookup"><span data-stu-id="6c82b-168">Starting with C# 7.0, an async method can return any type that has an accessible `GetAwaiter` method.</span></span>

<span data-ttu-id="6c82b-169">Étant donné que <xref:System.Threading.Tasks.Task> et <xref:System.Threading.Tasks.Task%601> sont des types référence, l’allocation de mémoire dans des chemins critiques pour les performances, en particulier quand les allocations se produisent dans des boucles serrées, peuvent nuire aux performances.</span><span class="sxs-lookup"><span data-stu-id="6c82b-169">Because <xref:System.Threading.Tasks.Task> and <xref:System.Threading.Tasks.Task%601> are reference types, memory allocation in performance-critical paths, particularly when allocations occur in tight loops, can adversely affect performance.</span></span> <span data-ttu-id="6c82b-170">La prise en charge de types de retour généralisés signifie que vous pouvez retourner un type valeur léger au lieu d’un type référence pour éviter des allocations de mémoire supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="6c82b-170">Support for generalized return types means that you can return a lightweight value type instead of a reference type to avoid additional memory allocations.</span></span>

<span data-ttu-id="6c82b-171">Le .NET fournit la structure <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> comme implémentation légère d’une valeur retournant des tâches généralisées.</span><span class="sxs-lookup"><span data-stu-id="6c82b-171">.NET provides the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> structure as a lightweight implementation of a generalized task-returning value.</span></span> <span data-ttu-id="6c82b-172">Pour utiliser le type <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType>, vous devez ajouter le package NuGet `System.Threading.Tasks.Extensions` à votre projet.</span><span class="sxs-lookup"><span data-stu-id="6c82b-172">To use the <xref:System.Threading.Tasks.ValueTask%601?displayProperty=nameWithType> type, you must add the `System.Threading.Tasks.Extensions` NuGet package to your project.</span></span> <span data-ttu-id="6c82b-173">L’exemple suivant utilise la structure <xref:System.Threading.Tasks.ValueTask%601> pour récupérer la valeur de deux dés.</span><span class="sxs-lookup"><span data-stu-id="6c82b-173">The following example uses the <xref:System.Threading.Tasks.ValueTask%601> structure to retrieve the value of two dice rolls.</span></span>

:::code language="csharp" source="snippets/async-return-types/async-valuetask.cs":::

## <a name="async-streams-with-iasyncenumerablet"></a><span data-ttu-id="6c82b-174">Flux asynchrones avec IAsyncEnumerable\<T\></span><span class="sxs-lookup"><span data-stu-id="6c82b-174">Async streams with IAsyncEnumerable\<T\></span></span>

<span data-ttu-id="6c82b-175">À compter de C# 8,0, une méthode Async peut retourner un *flux asynchrone*, représenté par <xref:System.Collections.Generic.IAsyncEnumerable%601> .</span><span class="sxs-lookup"><span data-stu-id="6c82b-175">Starting with C# 8.0, an async method may return an *async stream*, represented by <xref:System.Collections.Generic.IAsyncEnumerable%601>.</span></span> <span data-ttu-id="6c82b-176">Un flux asynchrone fournit un moyen d’énumérer les éléments lus à partir d’un flux lorsque des éléments sont générés dans des segments avec des appels asynchrones répétés.</span><span class="sxs-lookup"><span data-stu-id="6c82b-176">An async stream provides a way to enumerate items read from a stream when elements are generated in chunks with repeated asynchronous calls.</span></span> <span data-ttu-id="6c82b-177">L’exemple suivant montre une méthode Async qui génère un flux asynchrone :</span><span class="sxs-lookup"><span data-stu-id="6c82b-177">The following example shows an async method that generates an async stream:</span></span>

:::code language="csharp" source="snippets/async-return-types/AsyncStreams.cs" id="GenerateAsyncStream":::

<span data-ttu-id="6c82b-178">L’exemple précédent lit les lignes d’une chaîne de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="6c82b-178">The preceding example reads lines from a string asynchronously.</span></span> <span data-ttu-id="6c82b-179">Une fois chaque ligne lue, le code énumère chaque mot de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="6c82b-179">Once each line is read, the code enumerates each word in the string.</span></span> <span data-ttu-id="6c82b-180">Les appelants énumèrent chaque mot à l’aide de l' `await foreach` instruction.</span><span class="sxs-lookup"><span data-stu-id="6c82b-180">Callers would enumerate each word using the `await foreach` statement.</span></span> <span data-ttu-id="6c82b-181">La méthode attend quand elle doit lire de façon asynchrone la ligne suivante à partir de la chaîne source.</span><span class="sxs-lookup"><span data-stu-id="6c82b-181">The method awaits when it needs to asynchronously read the next line from the source string.</span></span>

## <a name="see-also"></a><span data-ttu-id="6c82b-182">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6c82b-182">See also</span></span>

- <xref:System.Threading.Tasks.Task.FromResult%2A>
- [<span data-ttu-id="6c82b-183">Traiter les tâches asynchrones terminées</span><span class="sxs-lookup"><span data-stu-id="6c82b-183">Process asynchronous tasks as they complete</span></span>](start-multiple-async-tasks-and-process-them-as-they-complete.md)
- [<span data-ttu-id="6c82b-184">Programmation asynchrone avec Async et await (C#)</span><span class="sxs-lookup"><span data-stu-id="6c82b-184">Asynchronous programming with async and await (C#)</span></span>](index.md)
- [<span data-ttu-id="6c82b-185">async</span><span class="sxs-lookup"><span data-stu-id="6c82b-185">async</span></span>](../../../language-reference/keywords/async.md)
- [<span data-ttu-id="6c82b-186">await</span><span class="sxs-lookup"><span data-stu-id="6c82b-186">await</span></span>](../../../language-reference/operators/await.md)

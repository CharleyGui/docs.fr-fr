---
title: LINQ (Language-Integrated Query) (C#)
description: En savoir plus sur les requêtes LINQ (Language-Integrated Queries) et consulter un exemple de l’opération de requête complète.
ms.date: 02/02/2017
ms.assetid: 19dd1782-905b-4a9d-a3e9-618453037fa2
ms.openlocfilehash: 967f69e94b0424e208fb675a312ab306d5e11842
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/15/2020
ms.locfileid: "90556731"
---
# <a name="language-integrated-query-linq"></a><span data-ttu-id="3a8ae-103">LINQ (Language-Integrated Query)</span><span class="sxs-lookup"><span data-stu-id="3a8ae-103">Language Integrated Query (LINQ)</span></span>

<span data-ttu-id="3a8ae-104">LINQ (Language-Integrated Query) est le nom d’un ensemble de technologies basé sur l’intégration de fonctions de requête directement dans le langage C#.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-104">Language-Integrated Query (LINQ) is the name for a set of technologies based on the integration of query capabilities directly into the C# language.</span></span> <span data-ttu-id="3a8ae-105">En règle générale, les requêtes de données sont exprimées comme de simples chaînes, sans vérification de type au moment de l’exécution, ni prise en charge IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-105">Traditionally, queries against data are expressed as simple strings without type checking at compile time or IntelliSense support.</span></span> <span data-ttu-id="3a8ae-106">En outre, vous devez apprendre un langage de requête différent pour chaque type de source de données : bases de données SQL, documents XML, services web, etc.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-106">Furthermore, you have to learn a different query language for each type of data source: SQL databases, XML documents, various Web services, and so on.</span></span> <span data-ttu-id="3a8ae-107">Avec LINQ, une requête est une construction de langage de premier ordre, comme les classes, les méthodes et les événements.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-107">With LINQ, a query is a first-class language construct, just like classes, methods, events.</span></span> <span data-ttu-id="3a8ae-108">Vous pouvez écrire des requêtes pour des collections d’objets fortement typées à l’aide de mots clés de langage et d’opérateurs familiers.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-108">You write queries against strongly typed collections of objects by using language keywords and familiar operators.</span></span> <span data-ttu-id="3a8ae-109">La famille de technologies LINQ fournit une expérience de requête cohérente pour les objets (LINQ to Objects), pour les bases de données relationnelles (LINQ to SQL) et pour le code XML (LINQ to XML).</span><span class="sxs-lookup"><span data-stu-id="3a8ae-109">The LINQ family of technologies provides a consistent query experience for objects (LINQ to Objects), relational databases (LINQ to SQL), and XML (LINQ to XML).</span></span>

<span data-ttu-id="3a8ae-110">Pour un développeur qui écrit des requêtes, la partie « intégrée au langage » la plus visible de LINQ est l’expression de requête.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-110">For a developer who writes queries, the most visible "language-integrated" part of LINQ is the query expression.</span></span> <span data-ttu-id="3a8ae-111">Les expressions de requête sont écrites selon une *syntaxe de requête* déclarative.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-111">Query expressions are written in a declarative *query syntax*.</span></span> <span data-ttu-id="3a8ae-112">En utilisant la syntaxe de requête, vous pouvez effectuer des opérations de filtrage, de classement et de regroupement sur des sources de données avec un minimum de code.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-112">By using query syntax, you can perform filtering, ordering, and grouping operations on data sources with a minimum of code.</span></span> <span data-ttu-id="3a8ae-113">Vous utilisez les mêmes modèles d’expression de requête de base pour interroger et transformer des données dans des bases de données SQL, des jeux de données ADO.NET, des documents et des flux XML et des collections .NET.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-113">You use the same basic query expression patterns to query and transform data in SQL databases, ADO.NET Datasets, XML documents and streams, and .NET collections.</span></span>

<span data-ttu-id="3a8ae-114">Vous pouvez écrire des requêtes LINQ en C# pour des bases de données SQL Server, des documents XML, des jeux de données ADO.NET et toute collection d’objets prenant en charge <xref:System.Collections.IEnumerable> ou l’interface générique <xref:System.Collections.Generic.IEnumerable%601>.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-114">You can write LINQ queries in C# for SQL Server databases, XML documents, ADO.NET Datasets, and any collection of objects that supports <xref:System.Collections.IEnumerable> or the generic <xref:System.Collections.Generic.IEnumerable%601> interface.</span></span> <span data-ttu-id="3a8ae-115">La prise en charge LINQ est également fournie par des tierces parties pour de nombreux services web et autres implémentations de base de données.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-115">LINQ support is also provided by third parties for many Web services and other database implementations.</span></span>

<span data-ttu-id="3a8ae-116">L’exemple suivant montre l’opération de requête complète.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-116">The following example shows the complete query operation.</span></span> <span data-ttu-id="3a8ae-117">L’opération complète comprend la création d’une source de données, la définition de l’expression de requête et l’exécution de la requête dans une instruction `foreach`.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-117">The complete operation includes creating a data source, defining the query expression, and executing the query in a `foreach` statement.</span></span>

[!code-csharp[csProgGuideLINQ#11](~/samples/snippets/csharp/concepts/linq/index_1.cs)]

<span data-ttu-id="3a8ae-118">L’illustration suivante de Visual Studio montre une requête LINQ partiellement terminée, exécutée sur une base de données SQL Server, en C# et en Visual Basic, avec un contrôle de type complet et une prise en charge IntelliSense :</span><span class="sxs-lookup"><span data-stu-id="3a8ae-118">The following illustration from Visual Studio shows a partially-completed LINQ query against a SQL Server database in both C# and Visual Basic with full type checking and IntelliSense support:</span></span>

![Diagramme qui montre une requête LINQ avec Intellisense.](./media/introduction-to-linq/linq-query-intellisense.png)

## <a name="query-expression-overview"></a><span data-ttu-id="3a8ae-120">Vue d’ensemble des expressions de requête</span><span class="sxs-lookup"><span data-stu-id="3a8ae-120">Query expression overview</span></span>

- <span data-ttu-id="3a8ae-121">Les expressions de requête peuvent être utilisées pour interroger et transformer des données à partir de n’importe quelle source de données compatible LINQ.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-121">Query expressions can be used to query and to transform data from any LINQ-enabled data source.</span></span> <span data-ttu-id="3a8ae-122">Par exemple, une même requête peut récupérer des données d’une base de données SQL et générer un flux XML en sortie.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-122">For example, a single query can retrieve data from a SQL database, and produce an XML stream as output.</span></span>
- <span data-ttu-id="3a8ae-123">Les expressions de requête sont faciles à maîtriser, car elles utilisent de nombreuses constructions familières du langage C#.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-123">Query expressions are easy to master because they use many familiar C# language constructs.</span></span>
- <span data-ttu-id="3a8ae-124">Les variables d’une expression de requête sont toutes fortement typées, même si, dans de nombreux cas, il n’est pas nécessaire de fournir le type explicitement, car le compilateur peut le déduire.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-124">The variables in a query expression are all strongly typed, although in many cases you do not have to provide the type explicitly because the compiler can infer it.</span></span> <span data-ttu-id="3a8ae-125">Pour plus d’informations, consultez la page [Relations entre les types dans les opérations de requête LINQ](type-relationships-in-linq-query-operations.md).</span><span class="sxs-lookup"><span data-stu-id="3a8ae-125">For more information, see [Type relationships in LINQ query operations](type-relationships-in-linq-query-operations.md).</span></span>
- <span data-ttu-id="3a8ae-126">Une requête ne s’exécute pas tant que vous n’avez pas itéré la variable de requête, par exemple dans une instruction `foreach`.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-126">A query is not executed until you iterate over the query variable, for example, in a `foreach` statement.</span></span> <span data-ttu-id="3a8ae-127">Pour plus d’informations, consultez [Introduction aux requêtes LINQ](introduction-to-linq-queries.md).</span><span class="sxs-lookup"><span data-stu-id="3a8ae-127">For more information, see [Introduction to LINQ queries](introduction-to-linq-queries.md).</span></span>
- <span data-ttu-id="3a8ae-128">Lors de la compilation, les expressions de requête sont converties en appels de méthode d’opérateur de requête standard en fonction des règles définies dans la spécification du langage C#.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-128">At compile time, query expressions are converted to Standard Query Operator method calls according to the rules set forth in the C# specification.</span></span> <span data-ttu-id="3a8ae-129">Toute requête exprimable avec la syntaxe de requête peut également être exprimée avec la syntaxe de méthode.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-129">Any query that can be expressed by using query syntax can also be expressed by using method syntax.</span></span> <span data-ttu-id="3a8ae-130">Toutefois, dans la plupart des cas, la syntaxe de requête est plus lisible et plus concise.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-130">However, in most cases query syntax is more readable and concise.</span></span> <span data-ttu-id="3a8ae-131">Pour plus d’informations, consultez les pages [Spécification du langage C#](~/_csharplang/spec/expressions.md#query-expressions) et [Vue d’ensemble des opérateurs de requête standard](standard-query-operators-overview.md).</span><span class="sxs-lookup"><span data-stu-id="3a8ae-131">For more information, see [C# language specification](~/_csharplang/spec/expressions.md#query-expressions) and [Standard query operators overview](standard-query-operators-overview.md).</span></span>
- <span data-ttu-id="3a8ae-132">En règle générale, lorsque vous écrivez des requêtes LINQ, nous vous recommandons d’utiliser la syntaxe de requête dans la mesure du possible et la syntaxe de méthode si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-132">As a rule when you write LINQ queries, we recommend that you use query syntax whenever possible and method syntax whenever necessary.</span></span> <span data-ttu-id="3a8ae-133">Il n’y a aucune différence de sémantique ou de performances entre les deux formats.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-133">There is no semantic or performance difference between the two different forms.</span></span> <span data-ttu-id="3a8ae-134">Les expressions de requête sont souvent plus lisibles que les expressions équivalentes écrites avec la syntaxe de méthode.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-134">Query expressions are often more readable than equivalent expressions written in method syntax.</span></span>
- <span data-ttu-id="3a8ae-135">Certaines opérations de requête, comme <xref:System.Linq.Enumerable.Count%2A> ou <xref:System.Linq.Enumerable.Max%2A>, n’ont pas d’expression de requête équivalente et doivent par conséquent être exprimées sous la forme d’un appel de méthode.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-135">Some query operations, such as <xref:System.Linq.Enumerable.Count%2A> or <xref:System.Linq.Enumerable.Max%2A>, have no equivalent query expression clause and must therefore be expressed as a method call.</span></span> <span data-ttu-id="3a8ae-136">La syntaxe de méthode peut être combinée avec la syntaxe de requête de différentes manières.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-136">Method syntax can be combined with query syntax in various ways.</span></span> <span data-ttu-id="3a8ae-137">Pour plus d’informations, consultez [syntaxe de requête et syntaxe de méthode dans LINQ](query-syntax-and-method-syntax-in-linq.md).</span><span class="sxs-lookup"><span data-stu-id="3a8ae-137">For more information, see [Query syntax and method syntax in LINQ](query-syntax-and-method-syntax-in-linq.md).</span></span>
- <span data-ttu-id="3a8ae-138">Les expressions de requête peuvent être compilées dans des arborescences d’expressions ou des délégués, selon le type auquel la requête est appliquée.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-138">Query expressions can be compiled to expression trees or to delegates, depending on the type that the query is applied to.</span></span> <span data-ttu-id="3a8ae-139">Les requêtes <xref:System.Collections.Generic.IEnumerable%601> sont compilées en délégués.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-139"><xref:System.Collections.Generic.IEnumerable%601> queries are compiled to delegates.</span></span> <span data-ttu-id="3a8ae-140">Les requêtes <xref:System.Linq.IQueryable> et <xref:System.Linq.IQueryable%601> sont compilées en arborescences d’expression.</span><span class="sxs-lookup"><span data-stu-id="3a8ae-140"><xref:System.Linq.IQueryable> and <xref:System.Linq.IQueryable%601> queries are compiled to expression trees.</span></span> <span data-ttu-id="3a8ae-141">Pour plus d’informations, consultez la page [Arborescences d’expressions](../../../expression-trees.md).</span><span class="sxs-lookup"><span data-stu-id="3a8ae-141">For more information, see [Expression trees](../../../expression-trees.md).</span></span>

## <a name="next-steps"></a><span data-ttu-id="3a8ae-142">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="3a8ae-142">Next steps</span></span>

<span data-ttu-id="3a8ae-143">Pour approfondir votre connaissance de LINQ, commencez par vous familiariser avec certains concepts de base expliqués sur la page [Principes de base des expressions de requête](../../../linq/query-expression-basics.md), puis lisez la documentation relative à la technologie LINQ qui vous intéresse :</span><span class="sxs-lookup"><span data-stu-id="3a8ae-143">To learn more details about LINQ, start by becoming familiar with some basic concepts in [Query expression basics](../../../linq/query-expression-basics.md), and then read the documentation for the LINQ technology in which you are interested:</span></span>

- <span data-ttu-id="3a8ae-144">Documents XML : [LINQ to XML](../../../../standard/linq/linq-xml-overview.md)</span><span class="sxs-lookup"><span data-stu-id="3a8ae-144">XML documents: [LINQ to XML](../../../../standard/linq/linq-xml-overview.md)</span></span>  
- <span data-ttu-id="3a8ae-145">ADO.NET Entity Framework : [LINQ to Entities](../../../../framework/data/adonet/ef/language-reference/linq-to-entities.md)</span><span class="sxs-lookup"><span data-stu-id="3a8ae-145">ADO.NET Entity Framework: [LINQ to entities](../../../../framework/data/adonet/ef/language-reference/linq-to-entities.md)</span></span>
- <span data-ttu-id="3a8ae-146">Collections, fichiers, chaînes, etc. .NET : [LINQ to Objects](linq-to-objects.md)</span><span class="sxs-lookup"><span data-stu-id="3a8ae-146">.NET collections, files, strings and so on: [LINQ to objects](linq-to-objects.md)</span></span>

<span data-ttu-id="3a8ae-147">Pour approfondir votre compréhension de LINQ en général, consultez la page [LINQ en C#](../../../linq/linq-in-csharp.md).</span><span class="sxs-lookup"><span data-stu-id="3a8ae-147">To gain a deeper understanding of LINQ in general, see [LINQ in C#](../../../linq/linq-in-csharp.md).</span></span>

<span data-ttu-id="3a8ae-148">Pour commencer à travailler avec LINQ en C#, consultez le didacticiel [Travailler avec LINQ](../../../tutorials/working-with-linq.md).</span><span class="sxs-lookup"><span data-stu-id="3a8ae-148">To start working with LINQ in C#, see the tutorial [Working with LINQ](../../../tutorials/working-with-linq.md).</span></span>

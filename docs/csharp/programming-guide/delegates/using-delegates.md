---
title: Utilisation de délégués - Guide de programmation C#
ms.date: 07/20/2015
helpviewer_keywords:
- delegates [C#], how to use
ms.assetid: 99a2fc27-a32e-4a34-921c-e65497520eec
ms.openlocfilehash: dcc73aba738d6296a44c48aad8b66cd6fc7f4a7b
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/14/2020
ms.locfileid: "77448437"
---
# <a name="using-delegates-c-programming-guide"></a><span data-ttu-id="2446e-102">Utilisation de délégués (guide de programmation C#)</span><span class="sxs-lookup"><span data-stu-id="2446e-102">Using Delegates (C# Programming Guide)</span></span>

<span data-ttu-id="2446e-103">Un [délégué](../../language-reference/builtin-types/reference-types.md) est un type qui encapsule sans risque une méthode ; il est similaire à un pointeur de fonction en C et C++.</span><span class="sxs-lookup"><span data-stu-id="2446e-103">A [delegate](../../language-reference/builtin-types/reference-types.md) is a type that safely encapsulates a method, similar to a function pointer in C and C++.</span></span> <span data-ttu-id="2446e-104">Toutefois, à la différence des pointeurs de fonction C, les délégués sont orientés objet, de type sécurisé et sûrs.</span><span class="sxs-lookup"><span data-stu-id="2446e-104">Unlike C function pointers, delegates are object-oriented, type safe, and secure.</span></span> <span data-ttu-id="2446e-105">Le type d'un délégué est défini par le nom du délégué.</span><span class="sxs-lookup"><span data-stu-id="2446e-105">The type of a delegate is defined by the name of the delegate.</span></span> <span data-ttu-id="2446e-106">L’exemple suivant déclare un délégué nommé `Del` qui peut encapsuler une méthode acceptant une chaîne ([string](../../language-reference/builtin-types/reference-types.md)) comme argument et qui retourne [void](../../language-reference/builtin-types/void.md) :</span><span class="sxs-lookup"><span data-stu-id="2446e-106">The following example declares a delegate named `Del` that can encapsulate a method that takes a [string](../../language-reference/builtin-types/reference-types.md) as an argument and returns [void](../../language-reference/builtin-types/void.md):</span></span>

[!code-csharp[csProgGuideDelegates#21](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#21)]

<span data-ttu-id="2446e-107">Un objet de délégué est normalement construit en fournissant le nom de la méthode que le délégué encapsule, ou avec une [fonction anonyme](../statements-expressions-operators/anonymous-functions.md).</span><span class="sxs-lookup"><span data-stu-id="2446e-107">A delegate object is normally constructed by providing the name of the method the delegate will wrap, or with an [anonymous function](../statements-expressions-operators/anonymous-functions.md).</span></span> <span data-ttu-id="2446e-108">Une fois qu'un délégué est instancié, un appel de méthode fait au délégué est transmis par le délégué à cette méthode.</span><span class="sxs-lookup"><span data-stu-id="2446e-108">Once a delegate is instantiated, a method call made to the delegate will be passed by the delegate to that method.</span></span> <span data-ttu-id="2446e-109">Les paramètres passés au délégué par l'appelant sont passés à la méthode et la valeur de retour de la méthode, le cas échéant, est retournée à l'appelant par le délégué.</span><span class="sxs-lookup"><span data-stu-id="2446e-109">The parameters passed to the delegate by the caller are passed to the method, and the return value, if any, from the method is returned to the caller by the delegate.</span></span> <span data-ttu-id="2446e-110">Cette opération est connue sous le nom d'appel du délégué.</span><span class="sxs-lookup"><span data-stu-id="2446e-110">This is known as invoking the delegate.</span></span> <span data-ttu-id="2446e-111">Un délégué instancié peut être appelé comme s'il s'agissait de la méthode encapsulée elle-même.</span><span class="sxs-lookup"><span data-stu-id="2446e-111">An instantiated delegate can be invoked as if it were the wrapped method itself.</span></span> <span data-ttu-id="2446e-112">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2446e-112">For example:</span></span>

[!code-csharp[csProgGuideDelegates#22](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#22)]  

[!code-csharp[csProgGuideDelegates#23](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#23)]

<span data-ttu-id="2446e-113">Les types délégués sont dérivés de la classe <xref:System.Delegate> du .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2446e-113">Delegate types are derived from the <xref:System.Delegate> class in the .NET Framework.</span></span> <span data-ttu-id="2446e-114">Les types délégués sont scellés ([sealed](../../language-reference/keywords/sealed.md)), c’est-à-dire qu’ils ne peuvent pas être faire l’objet d’une dérivation, et il n’est pas possible de dériver des classes personnalisées à partir de <xref:System.Delegate>.</span><span class="sxs-lookup"><span data-stu-id="2446e-114">Delegate types are [sealed](../../language-reference/keywords/sealed.md)—they cannot be derived from— and it is not possible to derive custom classes from <xref:System.Delegate>.</span></span> <span data-ttu-id="2446e-115">Étant donné que le délégué instancié est un objet, il peut être passé comme paramètre ou assigné à une propriété.</span><span class="sxs-lookup"><span data-stu-id="2446e-115">Because the instantiated delegate is an object, it can be passed as a parameter, or assigned to a property.</span></span> <span data-ttu-id="2446e-116">Cela permet à une méthode d'accepter un délégué comme paramètre et d'appeler le délégué ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="2446e-116">This allows a method to accept a delegate as a parameter, and call the delegate at some later time.</span></span> <span data-ttu-id="2446e-117">Cette opération est connue sous le nom de rappel asynchrone et constitue une méthode courante pour notifier un appelant quand un long processus s'est achevé.</span><span class="sxs-lookup"><span data-stu-id="2446e-117">This is known as an asynchronous callback, and is a common method of notifying a caller when a long process has completed.</span></span> <span data-ttu-id="2446e-118">Lorsqu'un délégué est ainsi utilisé, le code qui utilise le délégué n'a pas besoin de connaître l'implémentation de la méthode utilisée.</span><span class="sxs-lookup"><span data-stu-id="2446e-118">When a delegate is used in this fashion, the code using the delegate does not need any knowledge of the implementation of the method being used.</span></span> <span data-ttu-id="2446e-119">La fonctionnalité est semblable à l'encapsulation que fournissent les interfaces.</span><span class="sxs-lookup"><span data-stu-id="2446e-119">The functionality is similar to the encapsulation interfaces provide.</span></span>

<span data-ttu-id="2446e-120">Une autre utilisation courante des rappels consiste à définir une méthode de comparaison personnalisée et à passer ce délégué à une méthode de tri.</span><span class="sxs-lookup"><span data-stu-id="2446e-120">Another common use of callbacks is defining a custom comparison method and passing that delegate to a sort method.</span></span> <span data-ttu-id="2446e-121">Le code de l'appelant peut ainsi faire partie de l'algorithme de tri.</span><span class="sxs-lookup"><span data-stu-id="2446e-121">It allows the caller's code to become part of the sort algorithm.</span></span> <span data-ttu-id="2446e-122">L'exemple de méthode suivant utilise le type `Del` comme paramètre :</span><span class="sxs-lookup"><span data-stu-id="2446e-122">The following example method uses the `Del` type as a parameter:</span></span>

[!code-csharp[csProgGuideDelegates#24](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#24)]

<span data-ttu-id="2446e-123">Vous pouvez ensuite passer le délégué créé ci-dessus à cette méthode :</span><span class="sxs-lookup"><span data-stu-id="2446e-123">You can then pass the delegate created above to that method:</span></span>

[!code-csharp[csProgGuideDelegates#25](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#25)]

<span data-ttu-id="2446e-124">et vous recevez le résultat suivant sur la console :</span><span class="sxs-lookup"><span data-stu-id="2446e-124">and receive the following output to the console:</span></span>

```console
The number is: 3
```

<span data-ttu-id="2446e-125">En utilisant le délégué comme abstraction, `MethodWithCallback` n'a pas besoin d'appeler la console directement. La méthode n'a pas à être conçue en l'associant obligatoirement à une console.</span><span class="sxs-lookup"><span data-stu-id="2446e-125">Using the delegate as an abstraction, `MethodWithCallback` does not need to call the console directly—it does not have to be designed with a console in mind.</span></span> <span data-ttu-id="2446e-126">En effet, `MethodWithCallback` se contente de préparer une chaîne et de la passer à une autre méthode.</span><span class="sxs-lookup"><span data-stu-id="2446e-126">What `MethodWithCallback` does is simply prepare a string and pass the string to another method.</span></span> <span data-ttu-id="2446e-127">Cela est particulièrement efficace, car une méthode déléguée peut utiliser n'importe quel nombre de paramètres.</span><span class="sxs-lookup"><span data-stu-id="2446e-127">This is especially powerful since a delegated method can use any number of parameters.</span></span>

<span data-ttu-id="2446e-128">Quand un délégué est construit pour encapsuler une méthode d'instance, le délégué fait référence à l'instance et à la méthode.</span><span class="sxs-lookup"><span data-stu-id="2446e-128">When a delegate is constructed to wrap an instance method, the delegate references both the instance and the method.</span></span> <span data-ttu-id="2446e-129">Un délégué n'ayant aucune connaissance du type d'instance hormis la méthode qu'il encapsule, un délégué peut faire référence à n'importe quel type d'objet tant qu'il existe une méthode sur l'objet correspondant à la signature du délégué.</span><span class="sxs-lookup"><span data-stu-id="2446e-129">A delegate has no knowledge of the instance type aside from the method it wraps, so a delegate can refer to any type of object as long as there is a method on that object that matches the delegate signature.</span></span> <span data-ttu-id="2446e-130">Quand un délégué est construit pour encapsuler une méthode statique, il fait uniquement référence à la méthode.</span><span class="sxs-lookup"><span data-stu-id="2446e-130">When a delegate is constructed to wrap a static method, it only references the method.</span></span> <span data-ttu-id="2446e-131">Prenons les déclarations suivantes :</span><span class="sxs-lookup"><span data-stu-id="2446e-131">Consider the following declarations:</span></span>

[!code-csharp[csProgGuideDelegates#26](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#26)]

<span data-ttu-id="2446e-132">Avec la méthode statique `DelegateMethod` montrée précédemment, nous avons désormais trois méthodes pouvant être encapsulées par une instance `Del`.</span><span class="sxs-lookup"><span data-stu-id="2446e-132">Along with the static `DelegateMethod` shown previously, we now have three methods that can be wrapped by a `Del` instance.</span></span>

<span data-ttu-id="2446e-133">Un délégué peut appeler plusieurs méthodes quand il est appelé.</span><span class="sxs-lookup"><span data-stu-id="2446e-133">A delegate can call more than one method when invoked.</span></span> <span data-ttu-id="2446e-134">Cette opération se nomme multidiffusion.</span><span class="sxs-lookup"><span data-stu-id="2446e-134">This is referred to as multicasting.</span></span> <span data-ttu-id="2446e-135">L'ajout d'une méthode supplémentaire à la liste des méthodes du délégué – la liste d'invocation – nécessite simplement l'ajout de deux délégués à l'aide des opérateurs d'addition ou d'assignation d'addition (« + » ou « += »).</span><span class="sxs-lookup"><span data-stu-id="2446e-135">To add an extra method to the delegate's list of methods—the invocation list—simply requires adding two delegates using the addition or addition assignment operators ('+' or '+=').</span></span> <span data-ttu-id="2446e-136">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2446e-136">For example:</span></span>

[!code-csharp[csProgGuideDelegates#27](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#27)]

<span data-ttu-id="2446e-137">À ce stade, `allMethodsDelegate` contient trois méthodes dans sa liste d'invocation : `Method1`, `Method2` et `DelegateMethod`.</span><span class="sxs-lookup"><span data-stu-id="2446e-137">At this point `allMethodsDelegate` contains three methods in its invocation list—`Method1`, `Method2`, and `DelegateMethod`.</span></span> <span data-ttu-id="2446e-138">Les trois délégués initiaux, `d1`, `d2` et `d3`, restent inchangés.</span><span class="sxs-lookup"><span data-stu-id="2446e-138">The original three delegates, `d1`, `d2`, and `d3`, remain unchanged.</span></span> <span data-ttu-id="2446e-139">Lors de l'appel de `allMethodsDelegate`, les trois méthodes sont appelées dans l'ordre.</span><span class="sxs-lookup"><span data-stu-id="2446e-139">When `allMethodsDelegate` is invoked, all three methods are called in order.</span></span> <span data-ttu-id="2446e-140">Si le délégué utilise des paramètres de référence, la référence est passée séquentiellement à chacune des trois méthodes et toute modification apportée par une méthode est visible dans la méthode suivante.</span><span class="sxs-lookup"><span data-stu-id="2446e-140">If the delegate uses reference parameters, the reference is passed sequentially to each of the three methods in turn, and any changes by one method are visible to the next method.</span></span> <span data-ttu-id="2446e-141">Quand l'une des méthodes lève une exception qui n'est pas interceptée dans la méthode, cette exception est passée à l'appelant du délégué et aucune des méthodes suivantes dans la liste d'invocation n'est appelée.</span><span class="sxs-lookup"><span data-stu-id="2446e-141">When any of the methods throws an exception that is not caught within the method, that exception is passed to the caller of the delegate and no subsequent methods in the invocation list are called.</span></span> <span data-ttu-id="2446e-142">Si le délégué a une valeur de retour et/ou des paramètres out, il retourne la valeur de retour et les paramètres de la dernière méthode appelée.</span><span class="sxs-lookup"><span data-stu-id="2446e-142">If the delegate has a return value and/or out parameters, it returns the return value and parameters of the last method invoked.</span></span> <span data-ttu-id="2446e-143">Pour supprimer une méthode de la liste d’invocation, utilisez`-` les `-=` [opérateurs d’affectation de soustraction ou de soustraction](../../language-reference/operators/subtraction-operator.md) (ou ).</span><span class="sxs-lookup"><span data-stu-id="2446e-143">To remove a method from the invocation list, use the [subtraction or subtraction assignment operators](../../language-reference/operators/subtraction-operator.md) (`-` or `-=`).</span></span> <span data-ttu-id="2446e-144">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2446e-144">For example:</span></span>

[!code-csharp[csProgGuideDelegates#28](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#28)]

<span data-ttu-id="2446e-145">Étant donné que les types délégués sont dérivés de `System.Delegate`, les méthodes et les propriétés définies par cette classe peuvent être appelées sur le délégué.</span><span class="sxs-lookup"><span data-stu-id="2446e-145">Because delegate types are derived from `System.Delegate`, the methods and properties defined by that class can be called on the delegate.</span></span> <span data-ttu-id="2446e-146">Par exemple, pour rechercher le nombre de méthodes dans la liste d'invocation d'un délégué, vous pouvez écrire :</span><span class="sxs-lookup"><span data-stu-id="2446e-146">For example, to find the number of methods in a delegate's invocation list, you may write:</span></span>

[!code-csharp[csProgGuideDelegates#29](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#29)]

<span data-ttu-id="2446e-147">Les délégués ayant plusieurs méthodes dans leur liste d'invocation dérivent de <xref:System.MulticastDelegate>, qui est une sous-classe de `System.Delegate`.</span><span class="sxs-lookup"><span data-stu-id="2446e-147">Delegates with more than one method in their invocation list derive from <xref:System.MulticastDelegate>, which is a subclass of `System.Delegate`.</span></span> <span data-ttu-id="2446e-148">Le code ci-dessus fonctionne dans les deux cas, car les deux classes prennent en charge `GetInvocationList`.</span><span class="sxs-lookup"><span data-stu-id="2446e-148">The above code works in either case because both classes support `GetInvocationList`.</span></span>

<span data-ttu-id="2446e-149">Les délégués multicast sont largement utilisés dans la gestion des événements.</span><span class="sxs-lookup"><span data-stu-id="2446e-149">Multicast delegates are used extensively in event handling.</span></span> <span data-ttu-id="2446e-150">Les objets sources d'événements envoient des notifications d'événement aux objets destinataires qui se sont inscrits pour recevoir cet événement.</span><span class="sxs-lookup"><span data-stu-id="2446e-150">Event source objects send event notifications to recipient objects that have registered to receive that event.</span></span> <span data-ttu-id="2446e-151">Pour s'inscrire à un événement, le destinataire crée une méthode conçue pour gérer l'événement, puis crée un délégué pour cette méthode et passe le délégué à la source d'événements.</span><span class="sxs-lookup"><span data-stu-id="2446e-151">To register for an event, the recipient creates a method designed to handle the event, then creates a delegate for that method and passes the delegate to the event source.</span></span> <span data-ttu-id="2446e-152">La source appelle le délégué quand l'événement se produit.</span><span class="sxs-lookup"><span data-stu-id="2446e-152">The source calls the delegate when the event occurs.</span></span> <span data-ttu-id="2446e-153">Le délégué appelle ensuite la méthode de gestion d'événement sur le destinataire, en fournissant les données d'événement.</span><span class="sxs-lookup"><span data-stu-id="2446e-153">The delegate then calls the event handling method on the recipient, delivering the event data.</span></span> <span data-ttu-id="2446e-154">Le type délégué d'un événement donné est défini par la source de l'événement.</span><span class="sxs-lookup"><span data-stu-id="2446e-154">The delegate type for a given event is defined by the event source.</span></span> <span data-ttu-id="2446e-155">Pour plus d’informations, consultez [Événements](../events/index.md).</span><span class="sxs-lookup"><span data-stu-id="2446e-155">For more, see [Events](../events/index.md).</span></span>

<span data-ttu-id="2446e-156">La comparaison de délégués de deux types différents assignés au moment de la compilation provoque une erreur de compilation.</span><span class="sxs-lookup"><span data-stu-id="2446e-156">Comparing delegates of two different types assigned at compile-time will result in a compilation error.</span></span> <span data-ttu-id="2446e-157">Si les instances de délégué sont statiquement du type `System.Delegate`, la comparaison est alors autorisée, mais retourne la valeur false à l'exécution.</span><span class="sxs-lookup"><span data-stu-id="2446e-157">If the delegate instances are statically of the type `System.Delegate`, then the comparison is allowed, but will return false at run time.</span></span> <span data-ttu-id="2446e-158">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="2446e-158">For example:</span></span>

[!code-csharp[csProgGuideDelegates#30](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideDelegates/CS/Delegates.cs#30)]

## <a name="see-also"></a><span data-ttu-id="2446e-159">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2446e-159">See also</span></span>

- [<span data-ttu-id="2446e-160">Guide de programmation C#</span><span class="sxs-lookup"><span data-stu-id="2446e-160">C# Programming Guide</span></span>](../index.md)
- [<span data-ttu-id="2446e-161">Délégués</span><span class="sxs-lookup"><span data-stu-id="2446e-161">Delegates</span></span>](./index.md)
- [<span data-ttu-id="2446e-162">Utilisation de la variance dans les délégués</span><span class="sxs-lookup"><span data-stu-id="2446e-162">Using Variance in Delegates</span></span>](../concepts/covariance-contravariance/using-variance-in-delegates.md)
- [<span data-ttu-id="2446e-163">Variance dans les délégués</span><span class="sxs-lookup"><span data-stu-id="2446e-163">Variance in Delegates</span></span>](../concepts/covariance-contravariance/variance-in-delegates.md)
- [<span data-ttu-id="2446e-164">Utilisation de la variance pour les délégués génériques Func et Action</span><span class="sxs-lookup"><span data-stu-id="2446e-164">Using Variance for Func and Action Generic Delegates</span></span>](../concepts/covariance-contravariance/using-variance-for-func-and-action-generic-delegates.md)
- [<span data-ttu-id="2446e-165">Événements</span><span class="sxs-lookup"><span data-stu-id="2446e-165">Events</span></span>](../events/index.md)

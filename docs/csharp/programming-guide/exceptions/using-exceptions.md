---
title: Utilisation d'exceptions - Guide de programmation C#
description: Découvrez comment utiliser des exceptions. Les exceptions sont levées par du code qui rencontre une erreur et interceptées par du code qui corrige l’erreur.
ms.date: 12/09/2020
helpviewer_keywords:
- exception handling [C#], about exception handling
- exceptions [C#], about exceptions
ms.assetid: 71472c62-320a-470a-97d2-67995180389d
ms.openlocfilehash: 30a7c3eecb599493dfa74d664c4899836c1b9276
ms.sourcegitcommit: 9b877e160c326577e8aa5ead22a937110d80fa44
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/11/2020
ms.locfileid: "97110219"
---
# <a name="use-exceptions-c-programming-guide"></a><span data-ttu-id="6a346-104">Utiliser des exceptions (Guide de programmation C#)</span><span class="sxs-lookup"><span data-stu-id="6a346-104">Use exceptions (C# programming guide)</span></span>

<span data-ttu-id="6a346-105">En C#, les erreurs qui se produisent dans le programme au moment de l’exécution sont propagées à travers le programme à l’aide du mécanisme des exceptions.</span><span class="sxs-lookup"><span data-stu-id="6a346-105">In C#, errors in the program at run time are propagated through the program by using a mechanism called exceptions.</span></span> <span data-ttu-id="6a346-106">Les exceptions sont levées par le code qui rencontre une erreur et interceptées par le code qui peut corriger l’erreur.</span><span class="sxs-lookup"><span data-stu-id="6a346-106">Exceptions are thrown by code that encounters an error and caught by code that can correct the error.</span></span> <span data-ttu-id="6a346-107">Les exceptions peuvent être levées par le Runtime .NET ou par le code d’un programme.</span><span class="sxs-lookup"><span data-stu-id="6a346-107">Exceptions can be thrown by the .NET runtime or by code in a program.</span></span> <span data-ttu-id="6a346-108">Une fois qu’une exception est levée, elle se propage jusqu’en haut de la pile des appels, jusqu’à ce qu’une instruction `catch` soit trouvée pour l’exception.</span><span class="sxs-lookup"><span data-stu-id="6a346-108">Once an exception is thrown, it propagates up the call stack until a `catch` statement for the exception is found.</span></span> <span data-ttu-id="6a346-109">Les exceptions non interceptées sont gérées par un gestionnaire d’exceptions génériques fourni par le système qui affiche une boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="6a346-109">Uncaught exceptions are handled by a generic exception handler provided by the system that displays a dialog box.</span></span>

<span data-ttu-id="6a346-110">Les exceptions sont représentées par des classes dérivées de <xref:System.Exception>.</span><span class="sxs-lookup"><span data-stu-id="6a346-110">Exceptions are represented by classes derived from <xref:System.Exception>.</span></span> <span data-ttu-id="6a346-111">Cette classe identifie le type d’exception et contient des propriétés comportant des détails sur l’exception.</span><span class="sxs-lookup"><span data-stu-id="6a346-111">This class identifies the type of exception and contains properties that have details about the exception.</span></span> <span data-ttu-id="6a346-112">Lever une exception implique de créer une instance d’une classe dérivée d’une exception, de configurer éventuellement les propriétés de l’exception, puis de lever l’objet à l’aide du mot clé `throw`.</span><span class="sxs-lookup"><span data-stu-id="6a346-112">Throwing an exception involves creating an instance of an exception-derived class, optionally configuring properties of the exception, and then throwing the object by using the `throw` keyword.</span></span> <span data-ttu-id="6a346-113">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="6a346-113">For example:</span></span>

:::code language="csharp" source="snippets/exceptions/Program.cs" id="ThrowException":::

<span data-ttu-id="6a346-114">Après la levée d’une exception, le runtime vérifie l’instruction actuelle pour voir si elle se trouve dans un bloc `try`.</span><span class="sxs-lookup"><span data-stu-id="6a346-114">After an exception is thrown, the runtime checks the current statement to see whether it is within a `try` block.</span></span> <span data-ttu-id="6a346-115">Si tel est le cas, tous les blocs `catch` associés au bloc `try` font l’objet d’un contrôle permettant de déterminer s’ils peuvent intercepter l’exception.</span><span class="sxs-lookup"><span data-stu-id="6a346-115">If it is, any `catch` blocks associated with the `try` block are checked to see whether they can catch the exception.</span></span> <span data-ttu-id="6a346-116">Les blocs `Catch` spécifient généralement des types d’exception ; si le type du bloc `catch` est identique à celui de l’exception ou d’une classe de base de l’exception, le bloc `catch` peut gérer la méthode.</span><span class="sxs-lookup"><span data-stu-id="6a346-116">`Catch` blocks typically specify exception types; if the type of the `catch` block is the same type as the exception, or a base class of the exception, the `catch` block can handle the method.</span></span> <span data-ttu-id="6a346-117">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="6a346-117">For example:</span></span>

:::code language="csharp" source="snippets/exceptions/Program.cs" id="CatchException":::

<span data-ttu-id="6a346-118">Si l’instruction qui lève une exception ne se trouve pas dans un `try` bloc ou si le `try` bloc qui l’englobe n’a pas de `catch` bloc correspondant, le runtime vérifie la méthode d’appel pour obtenir une `try` instruction et des `catch` blocs.</span><span class="sxs-lookup"><span data-stu-id="6a346-118">If the statement that throws an exception isn't within a `try` block or if the `try` block that encloses it has no matching `catch` block, the runtime checks the calling method for a `try` statement and `catch` blocks.</span></span> <span data-ttu-id="6a346-119">Le runtime continue jusqu’à la pile appelante, à la recherche d’un bloc `catch` compatible.</span><span class="sxs-lookup"><span data-stu-id="6a346-119">The runtime continues up the calling stack, searching for a compatible `catch` block.</span></span> <span data-ttu-id="6a346-120">Une fois le bloc `catch` trouvé et exécuté, le contrôle est passé à l’instruction suivante après le bloc `catch`.</span><span class="sxs-lookup"><span data-stu-id="6a346-120">After the `catch` block is found and executed, control is passed to the next statement after that `catch` block.</span></span>

<span data-ttu-id="6a346-121">Une instruction `try` peut contenir plusieurs blocs `catch`.</span><span class="sxs-lookup"><span data-stu-id="6a346-121">A `try` statement can contain more than one `catch` block.</span></span> <span data-ttu-id="6a346-122">La première `catch` instruction qui peut gérer l’exception est exécutée ; toutes les `catch` instructions suivantes, même si elles sont compatibles, sont ignorées.</span><span class="sxs-lookup"><span data-stu-id="6a346-122">The first `catch` statement that can handle the exception is executed; any following `catch` statements, even if they're compatible, are ignored.</span></span> <span data-ttu-id="6a346-123">Les blocs catch doivent toujours être classés du plus spécifique (ou le plus dérivé) au moins spécifique.</span><span class="sxs-lookup"><span data-stu-id="6a346-123">Catch blocks should always be ordered from most specific (or most-derived) to least specific.</span></span> <span data-ttu-id="6a346-124">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="6a346-124">For example:</span></span>

:::code language="csharp" source="snippets/exceptions/CatchOrder.cs":::

<span data-ttu-id="6a346-125">Avant que le bloc `catch` ne soit exécuté, le runtime vérifie la présence de blocs `finally`.</span><span class="sxs-lookup"><span data-stu-id="6a346-125">Before the `catch` block is executed, the runtime checks for `finally` blocks.</span></span> <span data-ttu-id="6a346-126">`Finally` les blocs permettent au programmeur de nettoyer tout état ambigu qui peut être laissé à partir d’un `try` bloc abandonné, ou de libérer des ressources externes (telles que des handles graphiques, des connexions de base de données ou des flux de fichiers) sans attendre que le garbage collector dans le runtime finalise les objets.</span><span class="sxs-lookup"><span data-stu-id="6a346-126">`Finally` blocks enable the programmer to clean up any ambiguous state that could be left over from an aborted `try` block, or to release any external resources (such as graphics handles, database connections, or file streams) without waiting for the garbage collector in the runtime to finalize the objects.</span></span> <span data-ttu-id="6a346-127">Par exemple :</span><span class="sxs-lookup"><span data-stu-id="6a346-127">For example:</span></span>

:::code language="csharp" source="snippets/exceptions/Program.cs" id="TestFinally":::

<span data-ttu-id="6a346-128">En cas de `WriteByte()` levée d’une exception, le code du deuxième `try` bloc qui tente de rouvrir le fichier échoue si `file.Close()` n’est pas appelé, et le fichier reste verrouillé.</span><span class="sxs-lookup"><span data-stu-id="6a346-128">If `WriteByte()` threw an exception, the code in the second `try` block that tries to reopen the file would fail if `file.Close()` isn't called, and the file would remain locked.</span></span> <span data-ttu-id="6a346-129">Étant donné que les blocs `finally` sont exécutés même si une exception est levée, le bloc `finally` de l’exemple précédent autorise la fermeture correcte du fichier et permet d’éviter une erreur.</span><span class="sxs-lookup"><span data-stu-id="6a346-129">Because `finally` blocks are executed even if an exception is thrown, the `finally` block in the previous example allows for the file to be closed correctly and helps avoid an error.</span></span>

<span data-ttu-id="6a346-130">Si aucun bloc `catch` compatible n’est trouvé sur la pile des appels après la levée d’une exception, l’une des trois situations suivantes se produit :</span><span class="sxs-lookup"><span data-stu-id="6a346-130">If no compatible `catch` block is found on the call stack after an exception is thrown, one of three things occurs:</span></span>

- <span data-ttu-id="6a346-131">Si l’exception se trouve dans un finaliseur, le finaliseur est abandonné et le finaliseur de base, le cas échéant, est appelé.</span><span class="sxs-lookup"><span data-stu-id="6a346-131">If the exception is within a finalizer, the finalizer is aborted and the base finalizer, if any, is called.</span></span>
- <span data-ttu-id="6a346-132">Si la pile des appels contient un constructeur statique ou un initialiseur de champ statique, une <xref:System.TypeInitializationException> est levée, avec l’exception d’origine assignée à la propriété <xref:System.Exception.InnerException%2A> de la nouvelle exception.</span><span class="sxs-lookup"><span data-stu-id="6a346-132">If the call stack contains a static constructor, or a static field initializer, a <xref:System.TypeInitializationException> is thrown, with the original exception assigned to the <xref:System.Exception.InnerException%2A> property of the new exception.</span></span>
- <span data-ttu-id="6a346-133">Si le début du thread est atteint, le thread est terminé.</span><span class="sxs-lookup"><span data-stu-id="6a346-133">If the start of the thread is reached, the thread is terminated.</span></span>

---
title: Constructeurs statiques - Guide de programmation C#
description: Un constructeur statique en C# initialise des données statiques ou effectue une action une seule fois avant la création de la première instance ou lorsque des membres statiques sont référencés.
ms.date: 07/20/2015
helpviewer_keywords:
- static constructors [C#]
- constructors [C#], static
ms.assetid: 151ec95e-3c4d-4ed7-885d-95b7a3be2e7d
ms.openlocfilehash: 1bb494ded34065bb76b72db40375555ca1eb6953
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/15/2020
ms.locfileid: "90541849"
---
# <a name="static-constructors-c-programming-guide"></a><span data-ttu-id="0ad5c-103">Constructeurs statiques (Guide de programmation C#)</span><span class="sxs-lookup"><span data-stu-id="0ad5c-103">Static Constructors (C# Programming Guide)</span></span>
<span data-ttu-id="0ad5c-104">Un constructeur statique est utilisé pour initialiser des données [statiques](../../language-reference/keywords/static.md) ou pour effectuer une action particulière qui ne doit être effectuée qu’une seule fois.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-104">A static constructor is used to initialize any [static](../../language-reference/keywords/static.md) data, or to perform a particular action that needs to be performed once only.</span></span> <span data-ttu-id="0ad5c-105">Il est automatiquement appelé avant la création de la première instance ou le référencement d’un membre statique.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-105">It is called automatically before the first instance is created or any static members are referenced.</span></span>  
  
 [!code-csharp[csProgGuideObjects#14](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideObjects/CS/Objects.cs#14)]  

## <a name="remarks"></a><span data-ttu-id="0ad5c-106">Notes</span><span class="sxs-lookup"><span data-stu-id="0ad5c-106">Remarks</span></span>
<span data-ttu-id="0ad5c-107">Les constructeurs statiques ont les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="0ad5c-107">Static constructors have the following properties:</span></span>  
  
- <span data-ttu-id="0ad5c-108">Un constructeur statique n’accepte pas de modificateur d’accès et n’a pas de paramètre.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-108">A static constructor does not take access modifiers or have parameters.</span></span>  

- <span data-ttu-id="0ad5c-109">Une classe ou struct ne peut pas avoir de constructeur statique.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-109">A class or struct can only have one static constructor.</span></span>

- <span data-ttu-id="0ad5c-110">Les constructeurs statiques ne peuvent pas être hérités ou surchargés.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-110">Static constructors cannot be inherited or overloaded.</span></span>

- <span data-ttu-id="0ad5c-111">Un constructeur statique ne peut pas être appelé directement et est uniquement destiné à être appelé par le Common Language Runtime (CLR).</span><span class="sxs-lookup"><span data-stu-id="0ad5c-111">A static constructor cannot be called directly and is only meant to be called by the common language runtime (CLR).</span></span> <span data-ttu-id="0ad5c-112">Il est appelé automatiquement.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-112">It is invoked automatically.</span></span>

- <span data-ttu-id="0ad5c-113">L’utilisateur n’a aucun contrôle sur le moment d’exécution du constructeur statique dans le programme.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-113">The user has no control on when the static constructor is executed in the program.</span></span>
  
- <span data-ttu-id="0ad5c-114">Un constructeur statique est automatiquement appelé pour initialiser la [classe](../../language-reference/keywords/class.md) avant la création de la première instance ou le référencement d’un membre statique.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-114">A static constructor is called automatically to initialize the [class](../../language-reference/keywords/class.md) before the first instance is created or any static members are referenced.</span></span> <span data-ttu-id="0ad5c-115">Un constructeur statique s’exécute avant le constructeur d’instance.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-115">A static constructor will run before an instance constructor.</span></span> <span data-ttu-id="0ad5c-116">Le constructeur statique d’un type est appelé lorsqu’une méthode statique assignée à un événement ou à un délégué est appelée, et non quand elle est assignée.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-116">A type's static constructor is called when a static method assigned to an event or a delegate is invoked and not when it is assigned.</span></span> <span data-ttu-id="0ad5c-117">Si des initialiseurs de variable de champ statique sont présents dans la classe du constructeur statique, ils seront exécutés dans l’ordre textuel dans lequel ils apparaissent dans la déclaration de classe, immédiatement avant l’exécution du constructeur statique.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-117">If static field variable initializers are present in the class of the static constructor, they will be executed in the textual order in which they appear in the class declaration immediately prior to the execution of the static constructor.</span></span>

- <span data-ttu-id="0ad5c-118">Si vous ne fournissez pas de constructeur statique pour initialiser les champs statiques, tous les champs statiques sont initialisés à leur valeur par défaut, comme indiqué dans les [valeurs par défaut des types C#](../../language-reference/builtin-types/default-values.md).</span><span class="sxs-lookup"><span data-stu-id="0ad5c-118">If you don't provide a static constructor to initialize static fields, all static fields are initialized to their default value as listed in [Default values of C# types](../../language-reference/builtin-types/default-values.md).</span></span>
  
- <span data-ttu-id="0ad5c-119">Si un constructeur statique lève une exception, le runtime ne l’appelle pas une deuxième fois et le type reste non initialisé pour la durée de vie du domaine d’application dans lequel votre programme s’exécute.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-119">If a static constructor throws an exception, the runtime will not invoke it a second time, and the type will remain uninitialized for the lifetime of the application domain in which your program is running.</span></span> <span data-ttu-id="0ad5c-120">En règle générale, une exception <xref:System.TypeInitializationException> est levée lorsqu’un constructeur statique ne parvient pas à instancier un type ou quand une exception non gérée se produit dans un constructeur statique.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-120">Most commonly, a <xref:System.TypeInitializationException> exception is thrown when a static constructor is unable to instantiate a type or for an unhandled exception occurring within a static constructor.</span></span> <span data-ttu-id="0ad5c-121">Pour les constructeurs statiques implicites qui ne sont pas définis explicitement dans le code source, la résolution des problèmes peut nécessiter l’inspection du code en langage intermédiaire (IL).</span><span class="sxs-lookup"><span data-stu-id="0ad5c-121">For implicit static constructors that are not explicitly defined in source code, troubleshooting may require inspection of the intermediate language (IL) code.</span></span>

- <span data-ttu-id="0ad5c-122">La présence d’un constructeur statique empêche l’ajout de l’attribut de type <xref:System.Reflection.TypeAttributes.BeforeFieldInit>.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-122">The presence of a static constructor prevents the addition of the <xref:System.Reflection.TypeAttributes.BeforeFieldInit> type attribute.</span></span> <span data-ttu-id="0ad5c-123">Cela limite l’optimisation du runtime.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-123">This limits runtime optimization.</span></span>

- <span data-ttu-id="0ad5c-124">Un champ déclaré en tant que `static readonly` ne peut être attribué que dans le cadre de sa déclaration ou dans un constructeur statique.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-124">A field declared as `static readonly` may only be assigned as part of its declaration or in a static constructor.</span></span> <span data-ttu-id="0ad5c-125">Si un constructeur statique explicite n’est pas obligatoire, initialisez les champs statiques lors de la déclaration plutôt que via un constructeur statique pour une meilleure optimisation du runtime.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-125">When an explicit static constructor is not required, initialize static fields at declaration, rather than through a static constructor for better runtime optimization.</span></span>

> [!Note]
> <span data-ttu-id="0ad5c-126">S’il n’est pas directement accessible, la présence d’un constructeur statique explicite doit être documentée pour faciliter la résolution des exceptions de l’initialisation.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-126">Though not directly accessible, the presence of an explicit static constructor should be documented to assist with troubleshooting initialization exceptions.</span></span>

### <a name="usage"></a><span data-ttu-id="0ad5c-127">Utilisation</span><span class="sxs-lookup"><span data-stu-id="0ad5c-127">Usage</span></span>

- <span data-ttu-id="0ad5c-128">Généralement, on utilise des constructeurs statiques quand la classe utilise un fichier journal et que le constructeur sert à écrire des entrées dans ce fichier.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-128">A typical use of static constructors is when the class is using a log file and the constructor is used to write entries to this file.</span></span>  
- <span data-ttu-id="0ad5c-129">Les constructeurs statiques sont également utiles pour la création de classes wrapper pour du code non managé, quand le constructeur peut appeler la méthode `LoadLibrary`.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-129">Static constructors are also useful when creating wrapper classes for unmanaged code, when the constructor can call the `LoadLibrary` method.</span></span>  

- <span data-ttu-id="0ad5c-130">Les constructeurs statiques sont également un emplacement pratique pour appliquer des contrôles au moment de l’exécution sur le paramètre de type qui ne peuvent pas être vérifiés au moment de la compilation via des contraintes (contraintes de paramètre de type).</span><span class="sxs-lookup"><span data-stu-id="0ad5c-130">Static constructors are also a convenient place to enforce run-time checks on the type parameter that cannot be checked at compile time via constraints (Type parameter constraints).</span></span>

## <a name="example"></a><span data-ttu-id="0ad5c-131"> Exemple</span><span class="sxs-lookup"><span data-stu-id="0ad5c-131">Example</span></span>
 <span data-ttu-id="0ad5c-132">Dans cet exemple, la classe `Bus` possède un constructeur statique.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-132">In this example, class `Bus` has a static constructor.</span></span> <span data-ttu-id="0ad5c-133">Quand la première instance de `Bus` est créée (`bus1`), le constructeur statique est appelé pour initialiser la classe.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-133">When the first instance of `Bus` is created (`bus1`), the static constructor is invoked to initialize the class.</span></span> <span data-ttu-id="0ad5c-134">L’exemple de sortie vérifie que le constructeur statique s’exécute une seule fois, même si deux instances de `Bus` sont créées, et qu’il s’exécute avant le constructeur d’instance.</span><span class="sxs-lookup"><span data-stu-id="0ad5c-134">The sample output verifies that the static constructor runs only one time, even though two instances of `Bus` are created, and that it runs before the instance constructor runs.</span></span>  
  
 [!code-csharp[csProgGuideObjects#15](~/samples/snippets/csharp/VS_Snippets_VBCSharp/csProgGuideObjects/CS/Objects.cs#15)]

## <a name="c-language-specification"></a><span data-ttu-id="0ad5c-135">spécification du langage C#</span><span class="sxs-lookup"><span data-stu-id="0ad5c-135">C# language specification</span></span>
<span data-ttu-id="0ad5c-136">Pour plus d’informations, voir la section [Constructeurs statiques](~/_csharplang/spec/classes.md#static-constructors) de la [spécification du langage C#](~/_csharplang/spec/introduction.md).</span><span class="sxs-lookup"><span data-stu-id="0ad5c-136">For more information, see the [Static constructors](~/_csharplang/spec/classes.md#static-constructors) section of the [C# language specification](~/_csharplang/spec/introduction.md).</span></span>
  
## <a name="see-also"></a><span data-ttu-id="0ad5c-137">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="0ad5c-137">See also</span></span>

- [<span data-ttu-id="0ad5c-138">Guide de programmation C#</span><span class="sxs-lookup"><span data-stu-id="0ad5c-138">C# Programming Guide</span></span>](../index.md)
- [<span data-ttu-id="0ad5c-139">Classes et structs</span><span class="sxs-lookup"><span data-stu-id="0ad5c-139">Classes and Structs</span></span>](./index.md)
- [<span data-ttu-id="0ad5c-140">Constructeurs</span><span class="sxs-lookup"><span data-stu-id="0ad5c-140">Constructors</span></span>](./constructors.md)
- [<span data-ttu-id="0ad5c-141">Classes statiques et membres de classe statique</span><span class="sxs-lookup"><span data-stu-id="0ad5c-141">Static Classes and Static Class Members</span></span>](./static-classes-and-static-class-members.md)
- [<span data-ttu-id="0ad5c-142">Finaliseurs</span><span class="sxs-lookup"><span data-stu-id="0ad5c-142">Finalizers</span></span>](./destructors.md)
- [<span data-ttu-id="0ad5c-143">Instructions de conception des constructeurs</span><span class="sxs-lookup"><span data-stu-id="0ad5c-143">Constructor Design Guidelines</span></span>](../../../standard/design-guidelines/constructor.md#type-constructor-guidelines)
- [<span data-ttu-id="0ad5c-144">Avertissement de sécurité-CA2121 : les constructeurs statiques doivent être privés</span><span class="sxs-lookup"><span data-stu-id="0ad5c-144">Security Warning - CA2121: Static constructors should be private</span></span>](/visualstudio/code-quality/ca2121-static-constructors-should-be-private)

---
title: 'Procédure pas à pas : Création et utilisation d’objets dynamiques (C# et Visual Basic)'
description: Découvrez comment créer et utiliser des objets dynamiques dans cette procédure pas à pas. Créez un objet dynamique personnalisé et un projet qui utilise une bibliothèque « IronPython ».
ms.date: 07/20/2015
dev_langs:
- csharp
- vb
helpviewer_keywords:
- dynamic objects [Visual Basic]
- dynamic objects
- dynamic objects [C#]
ms.assetid: 568f1645-1305-4906-8625-5d77af81e04f
ms.openlocfilehash: 8da8ba964a9f0721602b10a6258a4e85341a617f
ms.sourcegitcommit: d8020797a6657d0fbbdff362b80300815f682f94
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/24/2020
ms.locfileid: "95716133"
---
# <a name="walkthrough-creating-and-using-dynamic-objects-c-and-visual-basic"></a><span data-ttu-id="669b2-104">Procédure pas à pas : Création et utilisation d’objets dynamiques (C# et Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="669b2-104">Walkthrough: Creating and Using Dynamic Objects (C# and Visual Basic)</span></span>

<span data-ttu-id="669b2-105">Les objets dynamiques exposent des membres tels que les propriétés et les méthodes au moment de l’exécution et non lors de la compilation.</span><span class="sxs-lookup"><span data-stu-id="669b2-105">Dynamic objects expose members such as properties and methods at run time, instead of at compile time.</span></span> <span data-ttu-id="669b2-106">Cela vous permet de créer des objets utilisables avec des structures qui ne correspondent pas à un type ou un format statique.</span><span class="sxs-lookup"><span data-stu-id="669b2-106">This enables you to create objects to work with structures that do not match a static type or format.</span></span> <span data-ttu-id="669b2-107">Par exemple, vous pouvez utiliser un objet dynamique pour référencer le modèle DOM (Document Object Model) HTML, qui peut contenir n’importe quelle combinaison d’attributs et d’éléments de balisage HTML valides.</span><span class="sxs-lookup"><span data-stu-id="669b2-107">For example, you can use a dynamic object to reference the HTML Document Object Model (DOM), which can contain any combination of valid HTML markup elements and attributes.</span></span> <span data-ttu-id="669b2-108">Étant donné que chaque document HTML est unique, les membres d’un document HTML particulier sont déterminés au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="669b2-108">Because each HTML document is unique, the members for a particular HTML document are determined at run time.</span></span> <span data-ttu-id="669b2-109">L’une des méthodes courantes pour référencer un attribut d’un élément HTML consiste à passer le nom de l’attribut à la méthode `GetProperty` de l’élément.</span><span class="sxs-lookup"><span data-stu-id="669b2-109">A common method to reference an attribute of an HTML element is to pass the name of the attribute to the `GetProperty` method of the element.</span></span> <span data-ttu-id="669b2-110">Pour référencer l’attribut `id` de l’élément HTML `<div id="Div1">`, vous obtenez d’abord une référence à l’élément `<div>`, puis utilisez `divElement.GetProperty("id")`.</span><span class="sxs-lookup"><span data-stu-id="669b2-110">To reference the `id` attribute of the HTML element `<div id="Div1">`, you first obtain a reference to the `<div>` element, and then use `divElement.GetProperty("id")`.</span></span> <span data-ttu-id="669b2-111">Si vous utilisez un objet dynamique, vous pouvez référencer l’attribut `id` comme `divElement.id`.</span><span class="sxs-lookup"><span data-stu-id="669b2-111">If you use a dynamic object, you can reference the `id` attribute as `divElement.id`.</span></span>

 <span data-ttu-id="669b2-112">Les objets dynamiques permettent également d’accéder facilement aux langages dynamiques comme IronPython et IronRuby.</span><span class="sxs-lookup"><span data-stu-id="669b2-112">Dynamic objects also provide convenient access to dynamic languages such as IronPython and IronRuby.</span></span> <span data-ttu-id="669b2-113">Vous pouvez utiliser un objet dynamique pour faire référence à un script dynamique qui est interprété au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="669b2-113">You can use a dynamic object to refer to a dynamic script that is interpreted at run time.</span></span>

 <span data-ttu-id="669b2-114">Vous référencez un objet dynamique à l’aide de la liaison tardive.</span><span class="sxs-lookup"><span data-stu-id="669b2-114">You reference a dynamic object by using late binding.</span></span> <span data-ttu-id="669b2-115">En C#, vous spécifiez le type d’un objet à liaison tardive comme `dynamic`.</span><span class="sxs-lookup"><span data-stu-id="669b2-115">In C#, you specify the type of a late-bound object as `dynamic`.</span></span> <span data-ttu-id="669b2-116">En Visual Basic, vous spécifiez le type d’un objet à liaison tardive comme `Object`.</span><span class="sxs-lookup"><span data-stu-id="669b2-116">In Visual Basic, you specify the type of a late-bound object as `Object`.</span></span> <span data-ttu-id="669b2-117">Pour plus d’informations, consultez [dynamic](../../language-reference/builtin-types/reference-types.md) et [Liaison anticipée et liaison tardive](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span><span class="sxs-lookup"><span data-stu-id="669b2-117">For more information, see [dynamic](../../language-reference/builtin-types/reference-types.md) and [Early and Late Binding](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md).</span></span>

 <span data-ttu-id="669b2-118">Vous pouvez créer des objets dynamiques personnalisés en utilisant les classes contenues dans l’espace de noms <xref:System.Dynamic?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="669b2-118">You can create custom dynamic objects by using the classes in the <xref:System.Dynamic?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="669b2-119">Par exemple, vous pouvez créer un <xref:System.Dynamic.ExpandoObject> et spécifier les membres de cet objet au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="669b2-119">For example, you can create an <xref:System.Dynamic.ExpandoObject> and specify the members of that object at run time.</span></span> <span data-ttu-id="669b2-120">Vous pouvez aussi créer votre propre type qui hérite de la classe <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="669b2-120">You can also create your own type that inherits the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="669b2-121">Vous pouvez ensuite substituer les membres de la classe <xref:System.Dynamic.DynamicObject> pour fournir des fonctionnalités dynamiques au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="669b2-121">You can then override the members of the <xref:System.Dynamic.DynamicObject> class to provide run-time dynamic functionality.</span></span>

 <span data-ttu-id="669b2-122">Dans cette procédure pas à pas, vous exécuterez les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="669b2-122">In this walkthrough you will perform the following tasks:</span></span>

- <span data-ttu-id="669b2-123">Créer un objet personnalisé qui expose dynamiquement le contenu d’un fichier texte comme propriétés d’un objet.</span><span class="sxs-lookup"><span data-stu-id="669b2-123">Create a custom object that dynamically exposes the contents of a text file as properties of an object.</span></span>

- <span data-ttu-id="669b2-124">Créer un projet qui utilise une bibliothèque `IronPython`.</span><span class="sxs-lookup"><span data-stu-id="669b2-124">Create a project that uses an `IronPython` library.</span></span>

## <a name="prerequisites"></a><span data-ttu-id="669b2-125">Prérequis</span><span class="sxs-lookup"><span data-stu-id="669b2-125">Prerequisites</span></span>

<span data-ttu-id="669b2-126">Pour effectuer cette procédure pas à pas, vous devez utiliser [IronPython](https://ironpython.net/) pour .NET.</span><span class="sxs-lookup"><span data-stu-id="669b2-126">You need [IronPython](https://ironpython.net/) for .NET to complete this walkthrough.</span></span> <span data-ttu-id="669b2-127">Accédez à la [page de téléchargement](https://ironpython.net/download/) pour obtenir la version la plus récente.</span><span class="sxs-lookup"><span data-stu-id="669b2-127">Go to their [Download page](https://ironpython.net/download/) to obtain the latest version.</span></span>

[!INCLUDE[note_settings_general](~/includes/note-settings-general-md.md)]

## <a name="creating-a-custom-dynamic-object"></a><span data-ttu-id="669b2-128">Création d’un objet dynamique personnalisé</span><span class="sxs-lookup"><span data-stu-id="669b2-128">Creating a Custom Dynamic Object</span></span>

<span data-ttu-id="669b2-129">Le premier projet que vous créez dans cette procédure pas à pas définit un objet dynamique personnalisé qui recherche dans le contenu d’un fichier texte.</span><span class="sxs-lookup"><span data-stu-id="669b2-129">The first project that you create in this walkthrough defines a custom dynamic object that searches the contents of a text file.</span></span> <span data-ttu-id="669b2-130">Le texte à rechercher est spécifié par le nom d’une propriété dynamique.</span><span class="sxs-lookup"><span data-stu-id="669b2-130">Text to search for is specified by the name of a dynamic property.</span></span> <span data-ttu-id="669b2-131">Par exemple, si le code appelant spécifie `dynamicFile.Sample`, la classe dynamique retourne une liste générique de chaînes qui contient toutes les lignes du fichier qui commencent par « Sample ».</span><span class="sxs-lookup"><span data-stu-id="669b2-131">For example, if calling code specifies `dynamicFile.Sample`, the dynamic class returns a generic list of strings that contains all of the lines from the file that begin with "Sample".</span></span> <span data-ttu-id="669b2-132">La recherche respecte la casse.</span><span class="sxs-lookup"><span data-stu-id="669b2-132">The search is case-insensitive.</span></span> <span data-ttu-id="669b2-133">La classe dynamique prend également en charge deux arguments facultatifs.</span><span class="sxs-lookup"><span data-stu-id="669b2-133">The dynamic class also supports two optional arguments.</span></span> <span data-ttu-id="669b2-134">Le premier argument est une valeur enum de l’option de recherche qui spécifie que la classe dynamique doit rechercher des correspondances en début de ligne, en fin de ligne, ou n’importe où dans la ligne.</span><span class="sxs-lookup"><span data-stu-id="669b2-134">The first argument is a search option enum value that specifies that the dynamic class should search for matches at the start of the line, the end of the line, or anywhere in the line.</span></span> <span data-ttu-id="669b2-135">Le deuxième argument spécifie que la classe dynamique doit supprimer des espaces à gauche et à droite dans chaque ligne avant d’effectuer la recherche.</span><span class="sxs-lookup"><span data-stu-id="669b2-135">The second argument specifies that the dynamic class should trim leading and trailing spaces from each line before searching.</span></span> <span data-ttu-id="669b2-136">Par exemple, si le code appelant spécifie `dynamicFile.Sample(StringSearchOption.Contains)`, la classe dynamique recherche le terme « Sample » n’importe où dans une ligne.</span><span class="sxs-lookup"><span data-stu-id="669b2-136">For example, if calling code specifies `dynamicFile.Sample(StringSearchOption.Contains)`, the dynamic class searches for "Sample" anywhere in a line.</span></span> <span data-ttu-id="669b2-137">Si le code appelant spécifie `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, la classe dynamique recherche le terme « Sample » au début de chaque ligne et ne supprime ni les espaces à droite, ni les espaces à gauche.</span><span class="sxs-lookup"><span data-stu-id="669b2-137">If calling code specifies `dynamicFile.Sample(StringSearchOption.StartsWith, false)`, the dynamic class searches for "Sample" at the start of each line, and does not remove leading and trailing spaces.</span></span> <span data-ttu-id="669b2-138">Le comportement par défaut de la classe dynamique consiste à rechercher une correspondance au début de chaque ligne et à supprimer les espaces à gauche et à droite.</span><span class="sxs-lookup"><span data-stu-id="669b2-138">The default behavior of the dynamic class is to search for a match at the start of each line and to remove leading and trailing spaces.</span></span>

### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="669b2-139">Pour créer une classe dynamique personnalisée</span><span class="sxs-lookup"><span data-stu-id="669b2-139">To create a custom dynamic class</span></span>

1. <span data-ttu-id="669b2-140">Démarrez Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="669b2-140">Start Visual Studio.</span></span>

2. <span data-ttu-id="669b2-141">Dans le menu **fichier** , pointez sur **nouveau** , puis cliquez sur **projet**.</span><span class="sxs-lookup"><span data-stu-id="669b2-141">On the **File** menu, point to **New** and then click **Project**.</span></span>

3. <span data-ttu-id="669b2-142">Dans la boîte de dialogue **Nouveau projet**, dans le volet **Types de projets**, vérifiez que **Windows** est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="669b2-142">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="669b2-143">Sélectionnez **Application console** dans le volet **Modèles**.</span><span class="sxs-lookup"><span data-stu-id="669b2-143">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="669b2-144">Dans la zone **Nom**, tapez `DynamicSample`, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="669b2-144">In the **Name** box, type `DynamicSample`, and then click **OK**.</span></span> <span data-ttu-id="669b2-145">Le nouveau projet est créé.</span><span class="sxs-lookup"><span data-stu-id="669b2-145">The new project is created.</span></span>

4. <span data-ttu-id="669b2-146">Cliquez avec le bouton droit sur le projet DynamicSample, pointez sur **Ajouter**, puis cliquez sur **Classe**.</span><span class="sxs-lookup"><span data-stu-id="669b2-146">Right-click the DynamicSample project and point to **Add**, and then click **Class**.</span></span> <span data-ttu-id="669b2-147">Dans la zone **Nom**, tapez `ReadOnlyFile`, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="669b2-147">In the **Name** box, type `ReadOnlyFile`, and then click **OK**.</span></span> <span data-ttu-id="669b2-148">Un nouveau fichier contenant la classe ReadOnlyFile est ajouté.</span><span class="sxs-lookup"><span data-stu-id="669b2-148">A new file is added that contains the ReadOnlyFile class.</span></span>

5. <span data-ttu-id="669b2-149">En haut du fichier ReadOnlyFile.cs ou ReadOnlyFile.vb, ajoutez le code suivant pour importer les espaces de noms <xref:System.IO?displayProperty=nameWithType> et <xref:System.Dynamic?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="669b2-149">At the top of the ReadOnlyFile.cs or ReadOnlyFile.vb file, add the following code to import the <xref:System.IO?displayProperty=nameWithType> and <xref:System.Dynamic?displayProperty=nameWithType> namespaces.</span></span>

    [!code-csharp[VbDynamicWalkthrough#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#1)]
    [!code-vb[VbDynamicWalkthrough#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#1)]

6. <span data-ttu-id="669b2-150">L’objet dynamique personnalisé utilise un enum pour déterminer les critères de recherche.</span><span class="sxs-lookup"><span data-stu-id="669b2-150">The custom dynamic object uses an enum to determine the search criteria.</span></span> <span data-ttu-id="669b2-151">Avant l’instruction de classe, ajoutez la définition d’enum suivante.</span><span class="sxs-lookup"><span data-stu-id="669b2-151">Before the class statement, add the following enum definition.</span></span>

    [!code-csharp[VbDynamicWalkthrough#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#2)]
    [!code-vb[VbDynamicWalkthrough#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#2)]

7. <span data-ttu-id="669b2-152">Mettez à jour l’instruction de classe de façon à hériter de la classe `DynamicObject`, comme indiqué dans l’exemple de code suivant.</span><span class="sxs-lookup"><span data-stu-id="669b2-152">Update the class statement to inherit the `DynamicObject` class, as shown in the following code example.</span></span>

    [!code-csharp[VbDynamicWalkthrough#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#3)]
    [!code-vb[VbDynamicWalkthrough#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#3)]

8. <span data-ttu-id="669b2-153">Ajoutez le code suivant à la classe `ReadOnlyFile` afin de définir un champ privé pour le chemin du fichier et un constructeur pour la classe `ReadOnlyFile`.</span><span class="sxs-lookup"><span data-stu-id="669b2-153">Add the following code to the `ReadOnlyFile` class to define a private field for the file path and a constructor for the `ReadOnlyFile` class.</span></span>

    [!code-csharp[VbDynamicWalkthrough#4](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#4)]
    [!code-vb[VbDynamicWalkthrough#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#4)]

9. <span data-ttu-id="669b2-154">Ajoutez la méthode `GetPropertyValue` suivante à la classe `ReadOnlyFile`.</span><span class="sxs-lookup"><span data-stu-id="669b2-154">Add the following `GetPropertyValue` method to the `ReadOnlyFile` class.</span></span> <span data-ttu-id="669b2-155">La méthode `GetPropertyValue` prend les critères de recherche comme paramètre d’entrée et retourne les lignes d’un fichier texte qui correspondent aux critères de recherche.</span><span class="sxs-lookup"><span data-stu-id="669b2-155">The `GetPropertyValue` method takes, as input, search criteria and returns the lines from a text file that match that search criteria.</span></span> <span data-ttu-id="669b2-156">Les méthodes dynamiques fournies par la classe `ReadOnlyFile` appellent la méthode `GetPropertyValue` pour récupérer leurs résultats respectifs.</span><span class="sxs-lookup"><span data-stu-id="669b2-156">The dynamic methods provided by the `ReadOnlyFile` class call the `GetPropertyValue` method to retrieve their respective results.</span></span>

    [!code-csharp[VbDynamicWalkthrough#5](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#5)]
    [!code-vb[VbDynamicWalkthrough#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#5)]

10. <span data-ttu-id="669b2-157">Après la méthode `GetPropertyValue`, ajoutez le code suivant pour substituer la méthode <xref:System.Dynamic.DynamicObject.TryGetMember%2A> de la classe <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="669b2-157">After the `GetPropertyValue` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="669b2-158">La méthode <xref:System.Dynamic.DynamicObject.TryGetMember%2A> est appelée quand un membre d’une classe dynamique est demandé et qu’aucun argument n’est spécifié.</span><span class="sxs-lookup"><span data-stu-id="669b2-158">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method is called when a member of a dynamic class is requested and no arguments are specified.</span></span> <span data-ttu-id="669b2-159">L’argument `binder` contient les informations relatives au membre référencé et l’argument `result` référence le résultat retourné pour le membre spécifié.</span><span class="sxs-lookup"><span data-stu-id="669b2-159">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="669b2-160">La méthode <xref:System.Dynamic.DynamicObject.TryGetMember%2A> retourne une valeur booléenne qui retourne `true` si le membre demandé existe ; sinon, elle retourne la valeur `false`.</span><span class="sxs-lookup"><span data-stu-id="669b2-160">The <xref:System.Dynamic.DynamicObject.TryGetMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>

    [!code-csharp[VbDynamicWalkthrough#6](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#6)]
    [!code-vb[VbDynamicWalkthrough#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#6)]

11. <span data-ttu-id="669b2-161">Après la méthode `TryGetMember`, ajoutez le code suivant pour substituer la méthode <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> de la classe <xref:System.Dynamic.DynamicObject>.</span><span class="sxs-lookup"><span data-stu-id="669b2-161">After the `TryGetMember` method, add the following code to override the <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method of the <xref:System.Dynamic.DynamicObject> class.</span></span> <span data-ttu-id="669b2-162">La méthode <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> est appelée quand un membre d’une classe dynamique est demandé avec des arguments.</span><span class="sxs-lookup"><span data-stu-id="669b2-162">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method is called when a member of a dynamic class is requested with arguments.</span></span> <span data-ttu-id="669b2-163">L’argument `binder` contient les informations relatives au membre référencé et l’argument `result` référence le résultat retourné pour le membre spécifié.</span><span class="sxs-lookup"><span data-stu-id="669b2-163">The `binder` argument contains information about the referenced member, and the `result` argument references the result returned for the specified member.</span></span> <span data-ttu-id="669b2-164">L’argument `args` contient un tableau des arguments passés au membre.</span><span class="sxs-lookup"><span data-stu-id="669b2-164">The `args` argument contains an array of the arguments that are passed to the member.</span></span> <span data-ttu-id="669b2-165">La méthode <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> retourne une valeur booléenne qui retourne `true` si le membre demandé existe ; sinon, elle retourne la valeur `false`.</span><span class="sxs-lookup"><span data-stu-id="669b2-165">The <xref:System.Dynamic.DynamicObject.TryInvokeMember%2A> method returns a Boolean value that returns `true` if the requested member exists; otherwise it returns `false`.</span></span>

    <span data-ttu-id="669b2-166">La version personnalisée de la méthode `TryInvokeMember` s’attend à ce que le premier argument soit une valeur de l’enum `StringSearchOption` que vous avez défini dans une étape précédente.</span><span class="sxs-lookup"><span data-stu-id="669b2-166">The custom version of the `TryInvokeMember` method expects the first argument to be a value from the `StringSearchOption` enum that you defined in a previous step.</span></span> <span data-ttu-id="669b2-167">La méthode `TryInvokeMember` s’attend à ce que le deuxième argument soit une valeur booléenne.</span><span class="sxs-lookup"><span data-stu-id="669b2-167">The `TryInvokeMember` method expects the second argument to be a Boolean value.</span></span> <span data-ttu-id="669b2-168">Si l’un des arguments ou les deux arguments sont des valeurs valides, ils sont passés à la méthode `GetPropertyValue` pour récupérer les résultats.</span><span class="sxs-lookup"><span data-stu-id="669b2-168">If one or both arguments are valid values, they are passed to the `GetPropertyValue` method to retrieve the results.</span></span>

    [!code-csharp[VbDynamicWalkthrough#7](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/readonlyfile.cs#7)]
    [!code-vb[VbDynamicWalkthrough#7](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/readonlyfile.vb#7)]

12. <span data-ttu-id="669b2-169">Enregistrez et fermez le fichier.</span><span class="sxs-lookup"><span data-stu-id="669b2-169">Save and close the file.</span></span>

#### <a name="to-create-a-sample-text-file"></a><span data-ttu-id="669b2-170">Pour créer un exemple de fichier texte</span><span class="sxs-lookup"><span data-stu-id="669b2-170">To create a sample text file</span></span>

1. <span data-ttu-id="669b2-171">Cliquez avec le bouton droit sur le projet DynamicSample, pointez sur **Ajouter**, puis cliquez sur **Nouvel élément**.</span><span class="sxs-lookup"><span data-stu-id="669b2-171">Right-click the DynamicSample project and point to **Add**, and then click **New Item**.</span></span> <span data-ttu-id="669b2-172">Dans le volet **Modèles installés**, sélectionnez **Général**, puis sélectionnez le modèle **Fichier texte**.</span><span class="sxs-lookup"><span data-stu-id="669b2-172">In the **Installed Templates** pane, select **General**, and then select the **Text File** template.</span></span> <span data-ttu-id="669b2-173">Laissez le nom par défaut TextFile1.txt dans la zone **Nom**, puis cliquez sur **Ajouter**.</span><span class="sxs-lookup"><span data-stu-id="669b2-173">Leave the default name of TextFile1.txt in the **Name** box, and then click **Add**.</span></span> <span data-ttu-id="669b2-174">Un nouveau fichier texte est ajouté au projet.</span><span class="sxs-lookup"><span data-stu-id="669b2-174">A new text file is added to the project.</span></span>

2. <span data-ttu-id="669b2-175">Copiez le texte suivant dans le fichier TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="669b2-175">Copy the following text to the TextFile1.txt file.</span></span>

    ```text
    List of customers and suppliers

    Supplier: Lucerne Publishing (https://www.lucernepublishing.com/)
    Customer: Preston, Chris
    Customer: Hines, Patrick
    Customer: Cameron, Maria
    Supplier: Graphic Design Institute (https://www.graphicdesigninstitute.com/)
    Supplier: Fabrikam, Inc. (https://www.fabrikam.com/)
    Customer: Seubert, Roxanne
    Supplier: Proseware, Inc. (http://www.proseware.com/)
    Customer: Adolphi, Stephan
    Customer: Koch, Paul
    ```

3. <span data-ttu-id="669b2-176">Enregistrez et fermez le fichier.</span><span class="sxs-lookup"><span data-stu-id="669b2-176">Save and close the file.</span></span>

#### <a name="to-create-a-sample-application-that-uses-the-custom-dynamic-object"></a><span data-ttu-id="669b2-177">Pour créer un exemple d’application qui utilise l’objet dynamique personnalisé</span><span class="sxs-lookup"><span data-stu-id="669b2-177">To create a sample application that uses the custom dynamic object</span></span>

1. <span data-ttu-id="669b2-178">Dans **l’Explorateur de solutions**, double-cliquez sur le fichier Module1.vb si vous utilisez Visual Basic ou sur le fichier Program.cs si vous utilisez Visual C#.</span><span class="sxs-lookup"><span data-stu-id="669b2-178">In **Solution Explorer**, double-click the Module1.vb file if you are using Visual Basic or the Program.cs file if you are using Visual C#.</span></span>

2. <span data-ttu-id="669b2-179">Ajoutez le code suivant à la procédure Main pour créer une instance de la classe `ReadOnlyFile` pour le fichier TextFile1.txt.</span><span class="sxs-lookup"><span data-stu-id="669b2-179">Add the following code to the Main procedure to create an instance of the `ReadOnlyFile` class for the TextFile1.txt file.</span></span> <span data-ttu-id="669b2-180">Le code utilise la liaison tardive pour appeler des membres dynamiques et récupérer des lignes de texte qui contiennent la chaîne « Customer ».</span><span class="sxs-lookup"><span data-stu-id="669b2-180">The code uses late binding to call dynamic members and retrieve lines of text that contain the string "Customer".</span></span>

     [!code-csharp[VbDynamicWalkthrough#8](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthrough/cs/program.cs#8)]
     [!code-vb[VbDynamicWalkthrough#8](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthrough/vb/module1.vb#8)]

3. <span data-ttu-id="669b2-181">Enregistrez le fichier et appuyez sur CTRL+F5 pour générer et exécuter l’application.</span><span class="sxs-lookup"><span data-stu-id="669b2-181">Save the file and press CTRL+F5 to build and run the application.</span></span>

## <a name="calling-a-dynamic-language-library"></a><span data-ttu-id="669b2-182">Appel d’une bibliothèque dynamique de langage</span><span class="sxs-lookup"><span data-stu-id="669b2-182">Calling a Dynamic Language Library</span></span>

<span data-ttu-id="669b2-183">Le projet suivant que vous créez dans cette procédure pas à pas permet d’accéder à une bibliothèque qui est écrite dans le langage dynamique IronPython.</span><span class="sxs-lookup"><span data-stu-id="669b2-183">The next project that you create in this walkthrough accesses a library that is written in the dynamic language IronPython.</span></span>

### <a name="to-create-a-custom-dynamic-class"></a><span data-ttu-id="669b2-184">Pour créer une classe dynamique personnalisée</span><span class="sxs-lookup"><span data-stu-id="669b2-184">To create a custom dynamic class</span></span>

1. <span data-ttu-id="669b2-185">Dans Visual Studio, dans le menu **fichier** , pointez sur **nouveau** , puis cliquez sur **projet**.</span><span class="sxs-lookup"><span data-stu-id="669b2-185">In Visual Studio, on the **File** menu, point to **New** and then click **Project**.</span></span>

2. <span data-ttu-id="669b2-186">Dans la boîte de dialogue **Nouveau projet**, dans le volet **Types de projets**, vérifiez que **Windows** est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="669b2-186">In the **New Project** dialog box, in the **Project Types** pane, make sure that **Windows** is selected.</span></span> <span data-ttu-id="669b2-187">Sélectionnez **Application console** dans le volet **Modèles**.</span><span class="sxs-lookup"><span data-stu-id="669b2-187">Select **Console Application** in the **Templates** pane.</span></span> <span data-ttu-id="669b2-188">Dans la zone **Nom**, tapez `DynamicIronPythonSample`, puis cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="669b2-188">In the **Name** box, type `DynamicIronPythonSample`, and then click **OK**.</span></span> <span data-ttu-id="669b2-189">Le nouveau projet est créé.</span><span class="sxs-lookup"><span data-stu-id="669b2-189">The new project is created.</span></span>

3. <span data-ttu-id="669b2-190">Si vous utilisez Visual Basic, cliquez avec le bouton droit sur le projet DynamicIronPythonSample, puis cliquez sur **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="669b2-190">If you are using Visual Basic, right-click the DynamicIronPythonSample project and then click **Properties**.</span></span> <span data-ttu-id="669b2-191">Cliquez sur l’onglet **références** . Cliquez sur le bouton **Ajouter** .</span><span class="sxs-lookup"><span data-stu-id="669b2-191">Click the **References** tab. Click the **Add** button.</span></span> <span data-ttu-id="669b2-192">Si vous utilisez Visual C#, dans l’**Explorateur de solutions**, cliquez avec le bouton droit sur le dossier **Références**, puis cliquez sur **Ajouter une référence**.</span><span class="sxs-lookup"><span data-stu-id="669b2-192">If you are using Visual C#, in **Solution Explorer**, right-click the **References** folder and then click **Add Reference**.</span></span>

4. <span data-ttu-id="669b2-193">Sous l’onglet **Parcourir**, naviguez jusqu’au dossier dans lequel sont installées les bibliothèques IronPython.</span><span class="sxs-lookup"><span data-stu-id="669b2-193">On the **Browse** tab, browse to the folder where the IronPython libraries are installed.</span></span> <span data-ttu-id="669b2-194">Par exemple, C:\Program Files\IronPython 2,6 pour .NET Framework 4,0.</span><span class="sxs-lookup"><span data-stu-id="669b2-194">For example, C:\Program Files\IronPython 2.6 for .NET Framework 4.0.</span></span> <span data-ttu-id="669b2-195">Sélectionnez les bibliothèques **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll** et **Microsoft.Dynamic.dll**.</span><span class="sxs-lookup"><span data-stu-id="669b2-195">Select the **IronPython.dll**, **IronPython.Modules.dll**, **Microsoft.Scripting.dll**, and **Microsoft.Dynamic.dll** libraries.</span></span> <span data-ttu-id="669b2-196">Cliquez sur **OK**.</span><span class="sxs-lookup"><span data-stu-id="669b2-196">Click **OK**.</span></span>

5. <span data-ttu-id="669b2-197">Si vous utilisez Visual Basic, modifiez le fichier Module1.vb.</span><span class="sxs-lookup"><span data-stu-id="669b2-197">If you are using Visual Basic, edit the Module1.vb file.</span></span> <span data-ttu-id="669b2-198">Si vous utilisez Visual C#, modifiez le fichier Program.cs.</span><span class="sxs-lookup"><span data-stu-id="669b2-198">If you are using Visual C#, edit the Program.cs file.</span></span>

6. <span data-ttu-id="669b2-199">En haut du fichier, ajoutez le code suivant pour importer les espaces de noms `Microsoft.Scripting.Hosting` et `IronPython.Hosting` depuis les bibliothèques IronPython.</span><span class="sxs-lookup"><span data-stu-id="669b2-199">At the top of the file, add the following code to import the `Microsoft.Scripting.Hosting` and `IronPython.Hosting` namespaces from the IronPython libraries.</span></span>

    [!code-csharp[VbDynamicWalkthroughIronPython#1](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#1)]
    [!code-vb[VbDynamicWalkthroughIronPython#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#1)]

7. <span data-ttu-id="669b2-200">Dans la méthode Main, ajoutez le code suivant pour créer un objet `Microsoft.Scripting.Hosting.ScriptRuntime` pour héberger les bibliothèques IronPython.</span><span class="sxs-lookup"><span data-stu-id="669b2-200">In the Main method, add the following code to create a new `Microsoft.Scripting.Hosting.ScriptRuntime` object to host the IronPython libraries.</span></span> <span data-ttu-id="669b2-201">L’objet `ScriptRuntime` charge le module de bibliothèque IronPython random.py.</span><span class="sxs-lookup"><span data-stu-id="669b2-201">The `ScriptRuntime` object loads the IronPython library module random.py.</span></span>

     [!code-csharp[VbDynamicWalkthroughIronPython#2](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#2)]
     [!code-vb[VbDynamicWalkthroughIronPython#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#2)]

8. <span data-ttu-id="669b2-202">Une fois que le code a chargé le module random.py, ajoutez le code suivant pour créer un tableau d’entiers.</span><span class="sxs-lookup"><span data-stu-id="669b2-202">After the code to load the random.py module, add the following code to create an array of integers.</span></span> <span data-ttu-id="669b2-203">Le tableau est passé à la méthode `shuffle` du module random.py, qui trie aléatoirement les valeurs dans le tableau.</span><span class="sxs-lookup"><span data-stu-id="669b2-203">The array is passed to the `shuffle` method of the random.py module, which randomly sorts the values in the array.</span></span>

     [!code-csharp[VbDynamicWalkthroughIronPython#3](~/samples/snippets/csharp/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/cs/program.cs#3)]
     [!code-vb[VbDynamicWalkthroughIronPython#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/vbdynamicwalkthroughironpython/vb/module1.vb#3)]

9. <span data-ttu-id="669b2-204">Enregistrez le fichier et appuyez sur CTRL+F5 pour générer et exécuter l’application.</span><span class="sxs-lookup"><span data-stu-id="669b2-204">Save the file and press CTRL+F5 to build and run the application.</span></span>

## <a name="see-also"></a><span data-ttu-id="669b2-205">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="669b2-205">See also</span></span>

- <xref:System.Dynamic?displayProperty=nameWithType>
- <xref:System.Dynamic.DynamicObject?displayProperty=nameWithType>
- [<span data-ttu-id="669b2-206">Utilisation du type dynamic</span><span class="sxs-lookup"><span data-stu-id="669b2-206">Using Type dynamic</span></span>](./using-type-dynamic.md)
- [<span data-ttu-id="669b2-207">Liaison précoce et tardive</span><span class="sxs-lookup"><span data-stu-id="669b2-207">Early and Late Binding</span></span>](../../../visual-basic/programming-guide/language-features/early-late-binding/index.md)
- [<span data-ttu-id="669b2-208">dynamic</span><span class="sxs-lookup"><span data-stu-id="669b2-208">dynamic</span></span>](../../language-reference/builtin-types/reference-types.md)
- [<span data-ttu-id="669b2-209">Implémenter des interfaces dynamiques (PDF téléchargeable sur Microsoft TechNet)</span><span class="sxs-lookup"><span data-stu-id="669b2-209">Implementing Dynamic Interfaces (downloadable PDF from Microsoft TechNet)</span></span>](https://download.microsoft.com/download/5/4/B/54B83DFE-D7AA-4155-9687-B0CF58FF65D7/implementing-dynamic-interfaces.pdf)

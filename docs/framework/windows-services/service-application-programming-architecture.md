---
title: Architecture de programmation d'une application de service
description: Comprendre l’architecture de programmation des applications de service. Les applications de service Windows sont basées sur une classe qui hérite de System. ServiceProcess. ServiceBase.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- ServiceController components, programming architecture
- ServiceBase class, service states
- Windows Service applications, code model
- services, programming architecture
- ServiceController class
- services, states
- ServiceProcessInstaller class, service application code model
- Windows Service applications, states
ms.assetid: 83230026-d068-4174-97ff-e264c896eb2f
author: ghogen
ms.openlocfilehash: c59ccc5a8b2f11fda9c4734487092c1aabb74908
ms.sourcegitcommit: 40de8df14289e1e05b40d6e5c1daabd3c286d70c
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/22/2020
ms.locfileid: "86925577"
---
# <a name="service-application-programming-architecture"></a><span data-ttu-id="dc92a-104">Architecture de programmation d'une application de service</span><span class="sxs-lookup"><span data-stu-id="dc92a-104">Service Application Programming Architecture</span></span>
<span data-ttu-id="dc92a-105">Les applications de service Windows sont basées sur une classe qui hérite de la classe <xref:System.ServiceProcess.ServiceBase?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="dc92a-105">Windows Service applications are based on a class that inherits from the <xref:System.ServiceProcess.ServiceBase?displayProperty=nameWithType> class.</span></span> <span data-ttu-id="dc92a-106">Substituez les méthodes de cette classe et définissez des fonctionnalités pour qu’elles déterminent le comportement de votre service.</span><span class="sxs-lookup"><span data-stu-id="dc92a-106">You override methods from this class and define functionality for them to determine how your service behaves.</span></span>  
  
 <span data-ttu-id="dc92a-107">Les principales classes impliquées dans la création du service sont les suivantes :</span><span class="sxs-lookup"><span data-stu-id="dc92a-107">The main classes involved in service creation are:</span></span>  
  
- <span data-ttu-id="dc92a-108"><xref:System.ServiceProcess.ServiceBase?displayProperty=nameWithType> : substituez les méthodes de la classe <xref:System.ServiceProcess.ServiceBase> au moment de la création d’un service et définissez le code pour déterminer le fonctionnement de votre service dans cette classe héritée.</span><span class="sxs-lookup"><span data-stu-id="dc92a-108"><xref:System.ServiceProcess.ServiceBase?displayProperty=nameWithType> — You override methods from the <xref:System.ServiceProcess.ServiceBase> class when creating a service and define the code to determine how your service functions in this inherited class.</span></span>  
  
- <span data-ttu-id="dc92a-109"><xref:System.ServiceProcess.ServiceProcessInstaller?displayProperty=nameWithType> et <xref:System.ServiceProcess.ServiceInstaller?displayProperty=nameWithType> : utilisez ces classes pour installer et désinstaller votre service.</span><span class="sxs-lookup"><span data-stu-id="dc92a-109"><xref:System.ServiceProcess.ServiceProcessInstaller?displayProperty=nameWithType> and <xref:System.ServiceProcess.ServiceInstaller?displayProperty=nameWithType> —You use these classes to install and uninstall your service.</span></span>  
  
 <span data-ttu-id="dc92a-110">Par ailleurs, vous pouvez utiliser une classe nommée <xref:System.ServiceProcess.ServiceController> pour manipuler le service.</span><span class="sxs-lookup"><span data-stu-id="dc92a-110">In addition, a class named <xref:System.ServiceProcess.ServiceController> can be used to manipulate the service itself.</span></span> <span data-ttu-id="dc92a-111">Cette classe n’est pas impliquée dans la création d’un service, mais vous pouvez vous en servir pour démarrer et arrêter le service, lui passer des commandes et retourner une série d’énumérations.</span><span class="sxs-lookup"><span data-stu-id="dc92a-111">This class is not involved in the creation of a service, but can be used to start and stop the service, pass commands to it, and return a series of enumerations.</span></span>  
  
## <a name="defining-your-services-behavior"></a><span data-ttu-id="dc92a-112">Définition du comportement de votre service</span><span class="sxs-lookup"><span data-stu-id="dc92a-112">Defining Your Service's Behavior</span></span>  
 <span data-ttu-id="dc92a-113">Dans votre classe de service, substituez les fonctions de classe de base qui déterminent ce qui se passe en cas de changement de l’état de votre service dans le Gestionnaire de contrôle des services.</span><span class="sxs-lookup"><span data-stu-id="dc92a-113">In your service class, you override base class functions that determine what happens when the state of your service is changed in the Services Control Manager.</span></span> <span data-ttu-id="dc92a-114">La classe <xref:System.ServiceProcess.ServiceBase> expose les méthodes suivantes, que vous pouvez substituer pour ajouter un comportement personnalisé.</span><span class="sxs-lookup"><span data-stu-id="dc92a-114">The <xref:System.ServiceProcess.ServiceBase> class exposes the following methods, which you can override to add custom behavior.</span></span>  
  
|<span data-ttu-id="dc92a-115">Méthode</span><span class="sxs-lookup"><span data-stu-id="dc92a-115">Method</span></span>|<span data-ttu-id="dc92a-116">Substituer pour</span><span class="sxs-lookup"><span data-stu-id="dc92a-116">Override to</span></span>|  
|------------|-----------------|  
|<xref:System.ServiceProcess.ServiceBase.OnStart%2A>|<span data-ttu-id="dc92a-117">Indiquer les actions à effectuer quand votre service commence à s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="dc92a-117">Indicate what actions should be taken when your service starts running.</span></span> <span data-ttu-id="dc92a-118">Vous devez écrire du code dans cette procédure pour que votre service effectue des tâches utiles.</span><span class="sxs-lookup"><span data-stu-id="dc92a-118">You must write code in this procedure for your service to perform useful work.</span></span>|  
|<xref:System.ServiceProcess.ServiceBase.OnPause%2A>|<span data-ttu-id="dc92a-119">Indiquer ce qui doit se passer quand votre service est suspendu.</span><span class="sxs-lookup"><span data-stu-id="dc92a-119">Indicate what should happen when your service is paused.</span></span>|  
|<xref:System.ServiceProcess.ServiceBase.OnStop%2A>|<span data-ttu-id="dc92a-120">Indiquer ce qui doit se passer quand votre service arrête de s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="dc92a-120">Indicate what should happen when your service stops running.</span></span>|  
|<xref:System.ServiceProcess.ServiceBase.OnContinue%2A>|<span data-ttu-id="dc92a-121">Indiquer ce qui doit se passer quand votre service revient à son fonctionnement normal après avoir été suspendu.</span><span class="sxs-lookup"><span data-stu-id="dc92a-121">Indicate what should happen when your service resumes normal functioning after being paused.</span></span>|  
|<xref:System.ServiceProcess.ServiceBase.OnShutdown%2A>|<span data-ttu-id="dc92a-122">Indiquer ce qui doit se passer juste avant l’arrêt de votre système si votre service est en cours d’exécution à ce moment-là.</span><span class="sxs-lookup"><span data-stu-id="dc92a-122">Indicate what should happen just prior to your system shutting down, if your service is running at that time.</span></span>|  
|<xref:System.ServiceProcess.ServiceBase.OnCustomCommand%2A>|<span data-ttu-id="dc92a-123">Indiquer ce qui doit se passer quand votre service reçoit une commande personnalisée.</span><span class="sxs-lookup"><span data-stu-id="dc92a-123">Indicate what should happen when your service receives a custom command.</span></span> <span data-ttu-id="dc92a-124">Pour plus d’informations sur les commandes personnalisées, consultez MSDN Online.</span><span class="sxs-lookup"><span data-stu-id="dc92a-124">For more information on custom commands, see MSDN online.</span></span>|  
|<xref:System.ServiceProcess.ServiceBase.OnPowerEvent%2A>|<span data-ttu-id="dc92a-125">Indiquer comment le service doit répondre à la suite d’un événement de gestion de l’alimentation (batterie faible, opération suspendue, etc.).</span><span class="sxs-lookup"><span data-stu-id="dc92a-125">Indicate how the service should respond when a power management event is received, such as a low battery or suspended operation.</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="dc92a-126">Ces méthodes représentent les états par lesquels passe le service au cours de sa vie (le service passe d’un état à l’autre).</span><span class="sxs-lookup"><span data-stu-id="dc92a-126">These methods represent states that the service moves through in its lifetime; the service transitions from one state to the next.</span></span> <span data-ttu-id="dc92a-127">Par exemple, le service ne répond jamais à une commande <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> avant un appel à <xref:System.ServiceProcess.ServiceBase.OnStart%2A>.</span><span class="sxs-lookup"><span data-stu-id="dc92a-127">For example, you will never get the service to respond to an <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> command before <xref:System.ServiceProcess.ServiceBase.OnStart%2A> has been called.</span></span>  
  
 <span data-ttu-id="dc92a-128">D’autres propriétés et méthodes présentent un intérêt.</span><span class="sxs-lookup"><span data-stu-id="dc92a-128">There are several other properties and methods that are of interest.</span></span> <span data-ttu-id="dc92a-129">notamment :</span><span class="sxs-lookup"><span data-stu-id="dc92a-129">These include:</span></span>  
  
- <span data-ttu-id="dc92a-130">La méthode <xref:System.ServiceProcess.ServiceBase.Run%2A> sur la classe <xref:System.ServiceProcess.ServiceBase>.</span><span class="sxs-lookup"><span data-stu-id="dc92a-130">The <xref:System.ServiceProcess.ServiceBase.Run%2A> method on the <xref:System.ServiceProcess.ServiceBase> class.</span></span> <span data-ttu-id="dc92a-131">Il s’agit du point d’entrée principal du service.</span><span class="sxs-lookup"><span data-stu-id="dc92a-131">This is the main entry point for the service.</span></span> <span data-ttu-id="dc92a-132">Quand vous créez un service à l’aide du modèle de service Windows, le code est inséré dans la méthode `Main` de votre application pour exécuter le service.</span><span class="sxs-lookup"><span data-stu-id="dc92a-132">When you create a service using the Windows Service template, code is inserted in your application's `Main` method to run the service.</span></span> <span data-ttu-id="dc92a-133">Ce code ressemble à ceci :</span><span class="sxs-lookup"><span data-stu-id="dc92a-133">This code looks like this:</span></span>  
  
     [!code-csharp[VbRadconService#6](../../../samples/snippets/csharp/VS_Snippets_VBCSharp/VbRadconService/CS/MyNewService.cs#6)]
     [!code-vb[VbRadconService#6](../../../samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbRadconService/VB/MyNewService.vb#6)]  
  
    > [!NOTE]
    > <span data-ttu-id="dc92a-134">Ces exemples utilisent un tableau de type <xref:System.ServiceProcess.ServiceBase>, dans lequel chaque service contenu dans votre application peut être ajouté. Tous les services peuvent ensuite être exécutés ensemble.</span><span class="sxs-lookup"><span data-stu-id="dc92a-134">These examples use an array of type <xref:System.ServiceProcess.ServiceBase>, into which each service your application contains can be added, and then all of the services can be run together.</span></span> <span data-ttu-id="dc92a-135">Toutefois, si vous ne créez qu’un seul service, vous pouvez choisir de ne pas utiliser le tableau. Dans ce cas, déclarez simplement un nouvel objet héritant de <xref:System.ServiceProcess.ServiceBase> et exécutez-le.</span><span class="sxs-lookup"><span data-stu-id="dc92a-135">If you are only creating a single service, however, you might choose not to use the array and simply declare a new object inheriting from <xref:System.ServiceProcess.ServiceBase> and then run it.</span></span> <span data-ttu-id="dc92a-136">Pour obtenir un exemple, consultez [Guide pratique pour écrire des services par programmation](how-to-write-services-programmatically.md).</span><span class="sxs-lookup"><span data-stu-id="dc92a-136">For an example, see [How to: Write Services Programmatically](how-to-write-services-programmatically.md).</span></span>  
  
- <span data-ttu-id="dc92a-137">Une série de propriétés sur la classe <xref:System.ServiceProcess.ServiceBase>.</span><span class="sxs-lookup"><span data-stu-id="dc92a-137">A series of properties on the <xref:System.ServiceProcess.ServiceBase> class.</span></span> <span data-ttu-id="dc92a-138">Celles-ci déterminent les méthodes qui peuvent être appelées sur votre service.</span><span class="sxs-lookup"><span data-stu-id="dc92a-138">These determine what methods can be called on your service.</span></span> <span data-ttu-id="dc92a-139">Par exemple, quand la propriété <xref:System.ServiceProcess.ServiceBase.CanStop%2A> a la valeur `true`, la méthode <xref:System.ServiceProcess.ServiceBase.OnStop%2A> sur votre service peut être appelée.</span><span class="sxs-lookup"><span data-stu-id="dc92a-139">For example, when the <xref:System.ServiceProcess.ServiceBase.CanStop%2A> property is set to `true`, the <xref:System.ServiceProcess.ServiceBase.OnStop%2A> method on your service can be called.</span></span> <span data-ttu-id="dc92a-140">Quand la propriété <xref:System.ServiceProcess.ServiceBase.CanPauseAndContinue%2A> a la valeur `true`, les méthodes <xref:System.ServiceProcess.ServiceBase.OnPause%2A> et <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> peuvent être appelées.</span><span class="sxs-lookup"><span data-stu-id="dc92a-140">When the <xref:System.ServiceProcess.ServiceBase.CanPauseAndContinue%2A> property is set to `true`, the <xref:System.ServiceProcess.ServiceBase.OnPause%2A> and <xref:System.ServiceProcess.ServiceBase.OnContinue%2A> methods can be called.</span></span> <span data-ttu-id="dc92a-141">Si vous définissez l’une de ces propriétés avec la valeur `true`, vous devez ensuite remplacer et définir le traitement des méthodes associées.</span><span class="sxs-lookup"><span data-stu-id="dc92a-141">When you set one of these properties to `true`, you should then override and define processing for the associated methods.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="dc92a-142">Pour être utile, votre service doit substituer au moins <xref:System.ServiceProcess.ServiceBase.OnStart%2A> et <xref:System.ServiceProcess.ServiceBase.OnStop%2A>.</span><span class="sxs-lookup"><span data-stu-id="dc92a-142">Your service must override at least <xref:System.ServiceProcess.ServiceBase.OnStart%2A> and <xref:System.ServiceProcess.ServiceBase.OnStop%2A> to be useful.</span></span>  
  
 <span data-ttu-id="dc92a-143">Vous pouvez également utiliser un composant appelé <xref:System.ServiceProcess.ServiceController> pour communiquer avec un service existant et contrôler son comportement.</span><span class="sxs-lookup"><span data-stu-id="dc92a-143">You can also use a component called the <xref:System.ServiceProcess.ServiceController> to communicate with and control the behavior of an existing service.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dc92a-144">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="dc92a-144">See also</span></span>

- [<span data-ttu-id="dc92a-145">Introduction aux applications de service Windows</span><span class="sxs-lookup"><span data-stu-id="dc92a-145">Introduction to Windows Service Applications</span></span>](introduction-to-windows-service-applications.md)
- [<span data-ttu-id="dc92a-146">Procédure : créer des services Windows</span><span class="sxs-lookup"><span data-stu-id="dc92a-146">How to: Create Windows Services</span></span>](how-to-create-windows-services.md)

---
title: Rendu des contrôles avec les styles visuels
ms.date: 03/30/2017
helpviewer_keywords:
- professional appearance [Windows Forms], rendering Windows Forms controls
- themes [Windows Forms], XP visual styles in Window Forms
- custom controls [Windows Forms], rendering
- custom controls [Windows Forms], painting
- visual themes [Windows Forms], rendering Windows Forms controls
- user controls [Windows Forms], painting
- visual styles [Windows Forms], rendering Windows Forms controls
ms.assetid: a5b178ba-610e-46c4-a6c0-509c0886a744
ms.openlocfilehash: 32bcbab585c39be4a72150bf49820d4a16f1691f
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/22/2019
ms.locfileid: "69968251"
---
# <a name="rendering-controls-with-visual-styles"></a><span data-ttu-id="e5137-102">Rendu des contrôles avec les styles visuels</span><span class="sxs-lookup"><span data-stu-id="e5137-102">Rendering Controls with Visual Styles</span></span>
<span data-ttu-id="e5137-103">Le .NET Framework prend en charge le rendu des contrôles et d’autres éléments de l’interface utilisateur Windows à l’aide de styles visuels dans les systèmes d’exploitation qui les prennent en charge.</span><span class="sxs-lookup"><span data-stu-id="e5137-103">The .NET Framework provides support for rendering controls and other Windows user interface (UI) elements using visual styles in operating systems that support them.</span></span> <span data-ttu-id="e5137-104">Cette rubrique décrit les différents niveaux de prise en charge dans le .NET Framework pour le rendu des contrôles et d’autres éléments d’interface utilisateur avec le style visuel actuel du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="e5137-104">This topic discusses the several levels of support in the .NET Framework for rendering controls and other UI elements with the current visual style of the operating system.</span></span>  
  
## <a name="rendering-classes-for-common-controls"></a><span data-ttu-id="e5137-105">Classes de rendu pour les contrôles courants</span><span class="sxs-lookup"><span data-stu-id="e5137-105">Rendering Classes for Common Controls</span></span>  
 <span data-ttu-id="e5137-106">Le rendu d’un contrôle fait référence au dessin de l’interface utilisateur d’un contrôle.</span><span class="sxs-lookup"><span data-stu-id="e5137-106">Rendering a control refers to drawing the user interface of a control.</span></span> <span data-ttu-id="e5137-107">L’espace de noms <xref:System.Windows.Forms?displayProperty=nameWithType> fournit la classe <xref:System.Windows.Forms.ControlPaint> pour le rendu de certains contrôles Windows Forms courants.</span><span class="sxs-lookup"><span data-stu-id="e5137-107">The <xref:System.Windows.Forms?displayProperty=nameWithType> namespace provides the <xref:System.Windows.Forms.ControlPaint> class for rendering some common Windows Forms controls.</span></span> <span data-ttu-id="e5137-108">Cependant, cette classe dessine des contrôles dans le style Windows classique, ce qui peut rendre difficile de maintenir cohérente une expérience de l’interface utilisateur quand des contrôles personnalisés sont dessinés dans des applications où les styles visuels sont activés.</span><span class="sxs-lookup"><span data-stu-id="e5137-108">However, this class draws controls in the classic Windows style, which can make it difficult to maintain a consistent UI experience when drawing custom controls in applications with visual styles enabled.</span></span>  
  
 <span data-ttu-id="e5137-109">Le .NET Framework 2,0 comprend des classes dans <xref:System.Windows.Forms?displayProperty=nameWithType> l’espace de noms qui restituent les parties et les États des contrôles communs avec les styles visuels.</span><span class="sxs-lookup"><span data-stu-id="e5137-109">The .NET Framework 2.0 includes classes in the <xref:System.Windows.Forms?displayProperty=nameWithType> namespace that render the parts and states of common controls with visual styles.</span></span> <span data-ttu-id="e5137-110">Chacune de ces classes inclut des méthodes `static` permettant de dessiner le contrôle ou des parties du contrôle dans un état particulier avec le style visuel actuel du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="e5137-110">Each of these classes includes `static` methods for drawing the control or parts of the control in a particular state with the current visual style of the operating system.</span></span>  
  
 <span data-ttu-id="e5137-111">Certaines de ces classes sont conçues pour dessiner le contrôle concerné, que les styles visuels soient ou non disponibles.</span><span class="sxs-lookup"><span data-stu-id="e5137-111">Some of these classes are designed to draw the related control regardless of whether visual styles are available.</span></span> <span data-ttu-id="e5137-112">Si les styles visuels sont activés, les membres de la classe dessinent le contrôle concerné avec des styles visuels ; si les styles visuels sont désactivés, les membres de la classe dessinent le contrôle dans le style Windows classique.</span><span class="sxs-lookup"><span data-stu-id="e5137-112">If visual styles are enabled, then the class members will draw the related control with visual styles; if visual styles are disabled, then the class members will draw the control in the classic Windows style.</span></span> <span data-ttu-id="e5137-113">Ces classes incluent :</span><span class="sxs-lookup"><span data-stu-id="e5137-113">These classes include:</span></span>  
  
- <xref:System.Windows.Forms.ButtonRenderer>  
  
- <xref:System.Windows.Forms.CheckBoxRenderer>  
  
- <xref:System.Windows.Forms.GroupBoxRenderer>  
  
- <xref:System.Windows.Forms.RadioButtonRenderer>  
  
 <span data-ttu-id="e5137-114">Les autres classes peuvent dessiner seulement le contrôle concerné quand des styles visuels sont disponibles, et leurs membres génèrent une exception si les styles visuels sont désactivés.</span><span class="sxs-lookup"><span data-stu-id="e5137-114">Other classes can only draw the related control when visual styles are available, and their members will throw an exception if visual styles are disabled.</span></span> <span data-ttu-id="e5137-115">Ces classes incluent :</span><span class="sxs-lookup"><span data-stu-id="e5137-115">These classes include:</span></span>  
  
- <xref:System.Windows.Forms.ComboBoxRenderer>  
  
- <xref:System.Windows.Forms.ProgressBarRenderer>  
  
- <xref:System.Windows.Forms.ScrollBarRenderer>  
  
- <xref:System.Windows.Forms.TabRenderer>  
  
- <xref:System.Windows.Forms.TextBoxRenderer>  
  
- <xref:System.Windows.Forms.TrackBarRenderer>  
  
 <span data-ttu-id="e5137-116">Pour plus d’informations sur l’utilisation de ces classes pour dessiner un [contrôle, consultez Procédure: Utilisez une classe](how-to-use-a-control-rendering-class.md)de rendu de contrôle.</span><span class="sxs-lookup"><span data-stu-id="e5137-116">For more information on using these classes to draw a control, see [How to: Use a Control Rendering Class](how-to-use-a-control-rendering-class.md).</span></span>  
  
## <a name="visual-style-element-and-rendering-classes"></a><span data-ttu-id="e5137-117">Élément de style visuel et classes de rendu</span><span class="sxs-lookup"><span data-stu-id="e5137-117">Visual Style Element and Rendering Classes</span></span>  
 <span data-ttu-id="e5137-118">L’espace de noms <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> inclut des classes qui peuvent être utilisées pour dessiner et obtenir des informations sur un contrôle ou un élément d’interface utilisateur qui est pris en charge par les styles visuels.</span><span class="sxs-lookup"><span data-stu-id="e5137-118">The <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> namespace includes classes that can be used to draw and get information about any control or UI element that is supported by visual styles.</span></span> <span data-ttu-id="e5137-119">Les contrôles pris en charge incluent des contrôles courants qui ont une classe de rendu dans l’espace de noms <xref:System.Windows.Forms?displayProperty=nameWithType> (voir la section précédente), ainsi que d’autres contrôles, comme des contrôles d’onglet et des contrôles rebar.</span><span class="sxs-lookup"><span data-stu-id="e5137-119">Supported controls include common controls that have a rendering class in the <xref:System.Windows.Forms?displayProperty=nameWithType> namespace (see the previous section), as well as other controls, such as tab controls and rebar controls.</span></span> <span data-ttu-id="e5137-120">Les autres éléments d’interface utilisateur pris en charge incluent les parties du menu **Démarrer** , la barre des tâches et la zone non cliente des fenêtres.</span><span class="sxs-lookup"><span data-stu-id="e5137-120">Other supported UI elements include the parts of the **Start** menu, the taskbar, and the nonclient area of windows.</span></span>  
  
 <span data-ttu-id="e5137-121">Les classes principales de l’espace de noms <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> sont <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> et <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer>.</span><span class="sxs-lookup"><span data-stu-id="e5137-121">The main classes of the <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> namespace are <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> and <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer>.</span></span> <span data-ttu-id="e5137-122"><xref:System.Windows.Forms.VisualStyles.VisualStyleElement> est une classe de base pour identifier tout contrôle ou élément d’interface utilisateur pris en charge par les styles visuels.</span><span class="sxs-lookup"><span data-stu-id="e5137-122"><xref:System.Windows.Forms.VisualStyles.VisualStyleElement> is a foundation class for identifying any control or user interface element supported by visual styles.</span></span> <span data-ttu-id="e5137-123">En plus de <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> lui-même, l’espace de noms <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> inclut de nombreuses classes imbriquées de <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> avec des propriétés `static` qui retournent un <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> pour chaque état d’un contrôle, partie de contrôle ou autre élément d’interface pris en charge par des styles visuels.</span><span class="sxs-lookup"><span data-stu-id="e5137-123">In addition to <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> itself, the <xref:System.Windows.Forms.VisualStyles?displayProperty=nameWithType> namespace includes many nested classes of <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> with `static` properties that return a <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> for every state of a control, control part, or other UI element supported by visual styles.</span></span>  
  
 <span data-ttu-id="e5137-124"><xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> fournit les méthodes qui dessinent et obtiennent des informations sur chaque <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> défini par le style visuel actuel du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="e5137-124"><xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> provides the methods that draw and get information about each <xref:System.Windows.Forms.VisualStyles.VisualStyleElement> defined by the current visual style of the operating system.</span></span> <span data-ttu-id="e5137-125">Les informations qui peuvent être récupérées sur un élément sont sa taille par défaut, son type d’arrière-plan et ses définitions de couleur.</span><span class="sxs-lookup"><span data-stu-id="e5137-125">Information that can be retrieved about an element includes its default size, background type, and color definitions.</span></span> <span data-ttu-id="e5137-126"><xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> encapsule les fonctionnalités de l’API des styles visuels (UxTheme) de la partie Windows Shell du Kit de développement Windows Platform SDK.</span><span class="sxs-lookup"><span data-stu-id="e5137-126"><xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> wraps the functionality of the visual styles (UxTheme) API from the Windows Shell portion of the Windows Platform SDK.</span></span> <span data-ttu-id="e5137-127">Pour plus d’informations, consultez [activation des styles visuels](/windows/desktop/controls/cookbook-overview).</span><span class="sxs-lookup"><span data-stu-id="e5137-127">For more information, see [Enabling Visual Styles](/windows/desktop/controls/cookbook-overview).</span></span>  
  
 <span data-ttu-id="e5137-128">Pour plus d’informations sur <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> l' <xref:System.Windows.Forms.VisualStyles.VisualStyleElement>utilisation de [et de, consultez Procédure: Restituer un élément](how-to-render-a-visual-style-element.md)de style visuel.</span><span class="sxs-lookup"><span data-stu-id="e5137-128">For more information about using <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> and <xref:System.Windows.Forms.VisualStyles.VisualStyleElement>, see [How to: Render a Visual Style Element](how-to-render-a-visual-style-element.md).</span></span>  
  
## <a name="enabling-visual-styles"></a><span data-ttu-id="e5137-129">Activation des styles visuels</span><span class="sxs-lookup"><span data-stu-id="e5137-129">Enabling Visual Styles</span></span>  
 <span data-ttu-id="e5137-130">Pour activer les styles visuels pour une application écrite pour le .NET Framework version 1,0, les programmeurs doivent inclure un manifeste d’application qui spécifie que ComCtl32. dll version 6 ou ultérieure sera utilisé pour dessiner les contrôles.</span><span class="sxs-lookup"><span data-stu-id="e5137-130">To enable visual styles for an application written for the .NET Framework version 1.0, programmers must include an application manifest that specifies that ComCtl32.dll version 6 or later will be used to draw controls.</span></span> <span data-ttu-id="e5137-131">Les applications générées avec le .NET Framework version 1,1 ou ultérieure peuvent <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> utiliser la méthode <xref:System.Windows.Forms.Application> de la classe.</span><span class="sxs-lookup"><span data-stu-id="e5137-131">Applications built with the .NET Framework version 1.1 or later can use the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> method of the <xref:System.Windows.Forms.Application> class.</span></span>  
  
## <a name="checking-for-visual-styles-support"></a><span data-ttu-id="e5137-132">Vérification de la prise en charge des styles visuels</span><span class="sxs-lookup"><span data-stu-id="e5137-132">Checking for Visual Styles Support</span></span>  
 <span data-ttu-id="e5137-133">La propriété <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> de la classe <xref:System.Windows.Forms.Application> indique si l’application actuelle dessine des contrôles avec les styles visuels.</span><span class="sxs-lookup"><span data-stu-id="e5137-133">The <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> property of the <xref:System.Windows.Forms.Application> class indicates whether the current application is drawing controls with visual styles.</span></span> <span data-ttu-id="e5137-134">Quand vous dessinez un contrôle personnalisé, vous pouvez vérifier la valeur de <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> pour déterminer si vous devez rendre votre contrôle avec ou sans styles visuels.</span><span class="sxs-lookup"><span data-stu-id="e5137-134">When painting a custom control, you can check the value of <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> to determine whether you should render your control with or without visual styles.</span></span> <span data-ttu-id="e5137-135">Le tableau suivant répertorie les quatre conditions qui doivent exister pour que <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> retourne `true`.</span><span class="sxs-lookup"><span data-stu-id="e5137-135">The following table lists the four conditions that must exist for <xref:System.Windows.Forms.Application.RenderWithVisualStyles%2A> to return `true`.</span></span>  
  
|<span data-ttu-id="e5137-136">Condition</span><span class="sxs-lookup"><span data-stu-id="e5137-136">Condition</span></span>|<span data-ttu-id="e5137-137">Notes</span><span class="sxs-lookup"><span data-stu-id="e5137-137">Notes</span></span>|  
|---------------|-----------|  
|<span data-ttu-id="e5137-138">Le système d’exploitation prend en charge les styles visuels.</span><span class="sxs-lookup"><span data-stu-id="e5137-138">The operating system supports visual styles.</span></span>|<span data-ttu-id="e5137-139">Pour vérifier cette condition séparément, utilisez la propriété <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation.IsSupportedByOS%2A> de la classe <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation> .</span><span class="sxs-lookup"><span data-stu-id="e5137-139">To verify this condition separately, use the <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation.IsSupportedByOS%2A> property of the <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation> class.</span></span>|  
|<span data-ttu-id="e5137-140">L’utilisateur a activé des styles visuels dans le système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="e5137-140">The user has enabled visual styles in the operating system.</span></span>|<span data-ttu-id="e5137-141">Pour vérifier cette condition séparément, utilisez la propriété <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation.IsEnabledByUser%2A> de la classe <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation> .</span><span class="sxs-lookup"><span data-stu-id="e5137-141">To verify this condition separately, use the <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation.IsEnabledByUser%2A> property of the <xref:System.Windows.Forms.VisualStyles.VisualStyleInformation> class.</span></span>|  
|<span data-ttu-id="e5137-142">Les styles visuels sont activés dans l’application.</span><span class="sxs-lookup"><span data-stu-id="e5137-142">Visual styles are enabled in the application.</span></span>|<span data-ttu-id="e5137-143">Les styles visuels peuvent être activés dans une application en appelant la méthode <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> ou un utilisant un manifeste d’application qui spécifie que ComCtl32.dll version 6 ou ultérieure doit être utilisé pour dessiner les contrôles.</span><span class="sxs-lookup"><span data-stu-id="e5137-143">Visual styles can be enabled in an application by calling the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> method or by using an application manifest that specifies that ComCtl32.dll version 6 or later will be used to draw controls.</span></span>|  
|<span data-ttu-id="e5137-144">Les styles visuels sont utilisés pour dessiner la zone cliente des fenêtres d’application.</span><span class="sxs-lookup"><span data-stu-id="e5137-144">Visual styles are being used to draw the client area of application windows.</span></span>|<span data-ttu-id="e5137-145">Pour vérifier cette condition séparément, utilisez la propriété <xref:System.Windows.Forms.Application.VisualStyleState%2A> de la classe <xref:System.Windows.Forms.Application>, et vérifiez qu’elle a la valeur <xref:System.Windows.Forms.VisualStyles.VisualStyleState.ClientAreaEnabled?displayProperty=nameWithType><xref:System.Windows.Forms.VisualStyles.VisualStyleState.ClientAndNonClientAreasEnabled?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="e5137-145">To verify this condition separately, use the <xref:System.Windows.Forms.Application.VisualStyleState%2A> property of the <xref:System.Windows.Forms.Application> class and verify that it has the value <xref:System.Windows.Forms.VisualStyles.VisualStyleState.ClientAreaEnabled?displayProperty=nameWithType> or <xref:System.Windows.Forms.VisualStyles.VisualStyleState.ClientAndNonClientAreasEnabled?displayProperty=nameWithType>.</span></span>|  
  
 <span data-ttu-id="e5137-146">Pour déterminer quand un utilisateur active ou désactive les styles visuels ou bascule d’un style visuel à un autre, recherchez la valeur de <xref:Microsoft.Win32.UserPreferenceCategory.VisualStyle?displayProperty=nameWithType> dans les gestionnaires pour les événements <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging?displayProperty=nameWithType> ou <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="e5137-146">To determine when a user enables or disables visual styles, or switches from one visual style to another, check for the <xref:Microsoft.Win32.UserPreferenceCategory.VisualStyle?displayProperty=nameWithType> value in the handlers for the <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging?displayProperty=nameWithType> or <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged?displayProperty=nameWithType> events.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="e5137-147">Si vous voulez utiliser <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> pour restituer un contrôle ou un élément d’interface utilisateur quand l’utilisateur active ou change les styles visuels, faites cela lors du traitement de l’événement <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged> et non pas de l’événement <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging> .</span><span class="sxs-lookup"><span data-stu-id="e5137-147">If you want to use <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> to render a control or UI element when the user enables or switches visual styles, make sure that you do this when handling the <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanged> event instead of the <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging> event.</span></span> <span data-ttu-id="e5137-148">Une exception est générée si vous utilisez la classe <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> lors du traitement de <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging>.</span><span class="sxs-lookup"><span data-stu-id="e5137-148">An exception will be thrown if you use the <xref:System.Windows.Forms.VisualStyles.VisualStyleRenderer> class when handling <xref:Microsoft.Win32.SystemEvents.UserPreferenceChanging>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e5137-149">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="e5137-149">See also</span></span>

- [<span data-ttu-id="e5137-150">Dessin et rendu personnalisés des contrôles</span><span class="sxs-lookup"><span data-stu-id="e5137-150">Custom Control Painting and Rendering</span></span>](custom-control-painting-and-rendering.md)

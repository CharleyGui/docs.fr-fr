---
title: Utilisation de la ligne pour les nouveaux enregistrements dans le contrôle DataGridView
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], adding rows for new records
- rows [Windows Forms], new records
- DataGridView control [Windows Forms], data entry
ms.assetid: 6110f1ea-9794-442c-a98a-f104a1feeaf4
ms.openlocfilehash: 2fcd35f8c4d04909cdbc26f6a4293fdd570385b8
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/24/2020
ms.locfileid: "76728334"
---
# <a name="using-the-row-for-new-records-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="89aa1-102">Utilisation de la ligne pour les nouveaux enregistrements dans le contrôle DataGridView Windows Forms</span><span class="sxs-lookup"><span data-stu-id="89aa1-102">Using the Row for New Records in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="89aa1-103">Lorsque vous utilisez une <xref:System.Windows.Forms.DataGridView> pour modifier des données dans votre application, vous souhaiterez souvent offrir à vos utilisateurs la possibilité d’ajouter de nouvelles lignes de données au magasin de données.</span><span class="sxs-lookup"><span data-stu-id="89aa1-103">When you use a <xref:System.Windows.Forms.DataGridView> for editing data in your application, you will often want to give your users the ability to add new rows of data to the data store.</span></span> <span data-ttu-id="89aa1-104">Le contrôle <xref:System.Windows.Forms.DataGridView> prend en charge cette fonctionnalité en fournissant une ligne pour les nouveaux enregistrements, qui est toujours indiqué comme dernière ligne.</span><span class="sxs-lookup"><span data-stu-id="89aa1-104">The <xref:System.Windows.Forms.DataGridView> control supports this functionality by providing a row for new records, which is always shown as the last row.</span></span> <span data-ttu-id="89aa1-105">Elle est marquée avec un symbole astérisque (\*) dans son en-tête de ligne.</span><span class="sxs-lookup"><span data-stu-id="89aa1-105">It is marked with an asterisk (\*) symbol in its row header.</span></span> <span data-ttu-id="89aa1-106">Les sections suivantes décrivent certaines des choses que vous devez prendre en compte lorsque vous programmez avec la ligne pour les nouveaux enregistrements activés.</span><span class="sxs-lookup"><span data-stu-id="89aa1-106">The following sections discuss some of the things you should consider when you program with the row for new records enabled.</span></span>  
  
## <a name="displaying-the-row-for-new-records"></a><span data-ttu-id="89aa1-107">Affichage de la ligne pour les nouveaux enregistrements</span><span class="sxs-lookup"><span data-stu-id="89aa1-107">Displaying the Row for New Records</span></span>  
 <span data-ttu-id="89aa1-108">Utilisez la propriété <xref:System.Windows.Forms.DataGridView.AllowUserToAddRows%2A> pour indiquer si la ligne des nouveaux enregistrements est affichée.</span><span class="sxs-lookup"><span data-stu-id="89aa1-108">Use the <xref:System.Windows.Forms.DataGridView.AllowUserToAddRows%2A> property to indicate whether the row for new records is displayed.</span></span> <span data-ttu-id="89aa1-109">La valeur par défaut de cette propriété est `true`.</span><span class="sxs-lookup"><span data-stu-id="89aa1-109">The default value of this property is `true`.</span></span>  
  
 <span data-ttu-id="89aa1-110">Pour le cas lié aux données, la ligne des nouveaux enregistrements sera affichée si la propriété <xref:System.Windows.Forms.DataGridView.AllowUserToAddRows%2A> du contrôle et la propriété <xref:System.ComponentModel.IBindingList.AllowNew%2A?displayProperty=nameWithType> de la source de données sont toutes les deux `true`.</span><span class="sxs-lookup"><span data-stu-id="89aa1-110">For the data bound case, the row for new records will be shown if the <xref:System.Windows.Forms.DataGridView.AllowUserToAddRows%2A> property of the control and the <xref:System.ComponentModel.IBindingList.AllowNew%2A?displayProperty=nameWithType> property of the data source are both `true`.</span></span> <span data-ttu-id="89aa1-111">Si l’un ou l’autre est `false`, la ligne n’est pas affichée.</span><span class="sxs-lookup"><span data-stu-id="89aa1-111">If either is `false` then the row will not be shown.</span></span>  
  
## <a name="populating-the-row-for-new-records-with-default-data"></a><span data-ttu-id="89aa1-112">Remplissage de la ligne pour les nouveaux enregistrements avec les données par défaut</span><span class="sxs-lookup"><span data-stu-id="89aa1-112">Populating the Row for New Records with Default Data</span></span>  
 <span data-ttu-id="89aa1-113">Lorsque l’utilisateur sélectionne la ligne pour les nouveaux enregistrements comme ligne actuelle, le contrôle de <xref:System.Windows.Forms.DataGridView> déclenche l’événement <xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded>.</span><span class="sxs-lookup"><span data-stu-id="89aa1-113">When the user selects the row for new records as the current row, the <xref:System.Windows.Forms.DataGridView> control raises the <xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded> event.</span></span>  
  
 <span data-ttu-id="89aa1-114">Cet événement donne accès au nouvel <xref:System.Windows.Forms.DataGridViewRow> et vous permet de remplir la nouvelle ligne avec les données par défaut.</span><span class="sxs-lookup"><span data-stu-id="89aa1-114">This event provides access to the new <xref:System.Windows.Forms.DataGridViewRow> and enables you to populate the new row with default data.</span></span> <span data-ttu-id="89aa1-115">Pour plus d’informations, consultez [Comment : spécifier des valeurs par défaut pour les nouvelles lignes dans le contrôle DataGridView Windows Forms](specify-default-values-for-new-rows-in-the-datagrid.md)</span><span class="sxs-lookup"><span data-stu-id="89aa1-115">For more information, see [How to: Specify Default Values for New Rows in the Windows Forms DataGridView Control](specify-default-values-for-new-rows-in-the-datagrid.md)</span></span>  
  
## <a name="the-rows-collection"></a><span data-ttu-id="89aa1-116">Collection Rows</span><span class="sxs-lookup"><span data-stu-id="89aa1-116">The Rows Collection</span></span>  
 <span data-ttu-id="89aa1-117">La ligne des nouveaux enregistrements est contenue dans la collection de <xref:System.Windows.Forms.DataGridView.Rows%2A> du contrôle <xref:System.Windows.Forms.DataGridView>, mais se comporte différemment à deux égards :</span><span class="sxs-lookup"><span data-stu-id="89aa1-117">The row for new records is contained in the <xref:System.Windows.Forms.DataGridView> control's <xref:System.Windows.Forms.DataGridView.Rows%2A> collection but behaves differently in two respects:</span></span>  
  
- <span data-ttu-id="89aa1-118">La ligne des nouveaux enregistrements ne peut pas être supprimée de la collection <xref:System.Windows.Forms.DataGridView.Rows%2A> par programmation.</span><span class="sxs-lookup"><span data-stu-id="89aa1-118">The row for new records cannot be removed from the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection programmatically.</span></span> <span data-ttu-id="89aa1-119">Une <xref:System.InvalidOperationException> est levée si cette tentative est effectuée.</span><span class="sxs-lookup"><span data-stu-id="89aa1-119">An <xref:System.InvalidOperationException> is thrown if this is attempted.</span></span> <span data-ttu-id="89aa1-120">L’utilisateur ne peut pas non plus supprimer la ligne pour les nouveaux enregistrements.</span><span class="sxs-lookup"><span data-stu-id="89aa1-120">The user also cannot delete the row for new records.</span></span> <span data-ttu-id="89aa1-121">La méthode <xref:System.Windows.Forms.DataGridViewRowCollection.Clear%2A?displayProperty=nameWithType> ne supprime pas cette ligne de la collection <xref:System.Windows.Forms.DataGridView.Rows%2A>.</span><span class="sxs-lookup"><span data-stu-id="89aa1-121">The <xref:System.Windows.Forms.DataGridViewRowCollection.Clear%2A?displayProperty=nameWithType> method does not remove this row from the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection.</span></span>  
  
- <span data-ttu-id="89aa1-122">Aucune ligne ne peut être ajoutée après la ligne pour les nouveaux enregistrements.</span><span class="sxs-lookup"><span data-stu-id="89aa1-122">No row can be added after the row for new records.</span></span> <span data-ttu-id="89aa1-123">Une <xref:System.InvalidOperationException> est déclenchée si cette tentative est effectuée.</span><span class="sxs-lookup"><span data-stu-id="89aa1-123">An <xref:System.InvalidOperationException> is raised if this is attempted.</span></span> <span data-ttu-id="89aa1-124">Par conséquent, la ligne des nouveaux enregistrements est toujours la dernière ligne dans le contrôle <xref:System.Windows.Forms.DataGridView>.</span><span class="sxs-lookup"><span data-stu-id="89aa1-124">As a result, the row for new records is always the last row in the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="89aa1-125">Les méthodes sur <xref:System.Windows.Forms.DataGridViewRowCollection> qui ajoutent des lignes (<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>et <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>) appellent toutes les méthodes d’insertion en interne lorsque la ligne pour les nouveaux enregistrements est présente.</span><span class="sxs-lookup"><span data-stu-id="89aa1-125">The methods on <xref:System.Windows.Forms.DataGridViewRowCollection> that add rows—<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, and <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>—all call insertion methods internally when the row for new records is present.</span></span>  
  
## <a name="visual-customization-of-the-row-for-new-records"></a><span data-ttu-id="89aa1-126">Personnalisation visuelle de la ligne pour les nouveaux enregistrements</span><span class="sxs-lookup"><span data-stu-id="89aa1-126">Visual Customization of the Row for New Records</span></span>  
 <span data-ttu-id="89aa1-127">Lorsque la ligne des nouveaux enregistrements est créée, elle est basée sur la ligne spécifiée par la propriété <xref:System.Windows.Forms.DataGridView.RowTemplate%2A>.</span><span class="sxs-lookup"><span data-stu-id="89aa1-127">When the row for new records is created, it is based on the row specified by the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> property.</span></span> <span data-ttu-id="89aa1-128">Les styles de cellule qui ne sont pas spécifiés pour cette ligne sont hérités d’autres propriétés.</span><span class="sxs-lookup"><span data-stu-id="89aa1-128">Any cell styles that are not specified for this row are inherited from other properties.</span></span> <span data-ttu-id="89aa1-129">Pour plus d’informations sur l’héritage de style de cellule, consultez [styles de cellule dans le contrôle DataGridView Windows Forms](cell-styles-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="89aa1-129">For more information about cell style inheritance, see [Cell Styles in the Windows Forms DataGridView Control](cell-styles-in-the-windows-forms-datagridview-control.md).</span></span>  
  
 <span data-ttu-id="89aa1-130">Les valeurs initiales affichées par les cellules de la ligne pour les nouveaux enregistrements sont extraites de la propriété <xref:System.Windows.Forms.DataGridViewCell.DefaultNewRowValue%2A> de chaque cellule.</span><span class="sxs-lookup"><span data-stu-id="89aa1-130">The initial values displayed by cells in the row for new records are retrieved from each cell's <xref:System.Windows.Forms.DataGridViewCell.DefaultNewRowValue%2A> property.</span></span> <span data-ttu-id="89aa1-131">Pour les cellules de type <xref:System.Windows.Forms.DataGridViewImageCell>, cette propriété retourne une image d’espace réservé.</span><span class="sxs-lookup"><span data-stu-id="89aa1-131">For cells of type <xref:System.Windows.Forms.DataGridViewImageCell>, this property returns a placeholder image.</span></span> <span data-ttu-id="89aa1-132">Sinon, cette propriété retourne `null`.</span><span class="sxs-lookup"><span data-stu-id="89aa1-132">Otherwise, this property returns `null`.</span></span> <span data-ttu-id="89aa1-133">Vous pouvez substituer cette propriété pour retourner une valeur personnalisée.</span><span class="sxs-lookup"><span data-stu-id="89aa1-133">You can override this property to return a custom value.</span></span> <span data-ttu-id="89aa1-134">Toutefois, ces valeurs initiales peuvent être remplacées par un gestionnaire d’événements <xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded> lorsque le focus entre dans la ligne pour les nouveaux enregistrements.</span><span class="sxs-lookup"><span data-stu-id="89aa1-134">However, these initial values can be replaced by a <xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded> event handler when focus enters the row for new records.</span></span>  
  
 <span data-ttu-id="89aa1-135">Les icônes standard pour l’en-tête de cette ligne, qui sont une flèche ou un astérisque, ne sont pas exposées publiquement.</span><span class="sxs-lookup"><span data-stu-id="89aa1-135">The standard icons for this row's header, which are an arrow or an asterisk, are not exposed publicly.</span></span> <span data-ttu-id="89aa1-136">Si vous souhaitez personnaliser les icônes, vous devrez créer une classe de <xref:System.Windows.Forms.DataGridViewRowHeaderCell> personnalisée.</span><span class="sxs-lookup"><span data-stu-id="89aa1-136">If you want to customize the icons, you will need to create a custom <xref:System.Windows.Forms.DataGridViewRowHeaderCell> class.</span></span>  
  
 <span data-ttu-id="89aa1-137">Les icônes standard utilisent la propriété <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> du <xref:System.Windows.Forms.DataGridViewCellStyle> en cours d’utilisation par la cellule d’en-tête de ligne.</span><span class="sxs-lookup"><span data-stu-id="89aa1-137">The standard icons use the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property of the <xref:System.Windows.Forms.DataGridViewCellStyle> in use by the row header cell.</span></span> <span data-ttu-id="89aa1-138">Les icônes standard ne sont pas rendues si l’espace est insuffisant pour les afficher complètement.</span><span class="sxs-lookup"><span data-stu-id="89aa1-138">The standard icons are not rendered if there is not enough space to display them completely.</span></span>  
  
 <span data-ttu-id="89aa1-139">Si la cellule d’en-tête de ligne a une valeur de chaîne définie et que l’espace est insuffisant pour le texte et l’icône, l’icône est supprimée en premier.</span><span class="sxs-lookup"><span data-stu-id="89aa1-139">If the row header cell has a string value set, and if there is not enough room for both the text and icon, the icon is dropped first.</span></span>  
  
## <a name="sorting"></a><span data-ttu-id="89aa1-140">Tri</span><span class="sxs-lookup"><span data-stu-id="89aa1-140">Sorting</span></span>  
 <span data-ttu-id="89aa1-141">En mode indépendant, les nouveaux enregistrements sont toujours ajoutés à la fin de l' <xref:System.Windows.Forms.DataGridView> même si l’utilisateur a trié le contenu du <xref:System.Windows.Forms.DataGridView>.</span><span class="sxs-lookup"><span data-stu-id="89aa1-141">In unbound mode, new records will always be added to the end of the <xref:System.Windows.Forms.DataGridView> even if the user has sorted the content of the <xref:System.Windows.Forms.DataGridView>.</span></span> <span data-ttu-id="89aa1-142">L’utilisateur devra réappliquer le tri pour trier la ligne à la position correcte ; ce comportement est similaire à celui du contrôle <xref:System.Windows.Forms.ListView>.</span><span class="sxs-lookup"><span data-stu-id="89aa1-142">The user will need to apply the sort again in order to sort the row to the correct position; this behavior is similar to that of the <xref:System.Windows.Forms.ListView> control.</span></span>  
  
 <span data-ttu-id="89aa1-143">Dans les modes de liaison de données et virtuelles, le comportement d’insertion lorsqu’un tri est appliqué dépend de l’implémentation du modèle de données.</span><span class="sxs-lookup"><span data-stu-id="89aa1-143">In data bound and virtual modes, the insertion behavior when a sort is applied will be dependent on the implementation of the data model.</span></span> <span data-ttu-id="89aa1-144">Pour ADO.NET, la ligne est immédiatement triée dans la position correcte.</span><span class="sxs-lookup"><span data-stu-id="89aa1-144">For ADO.NET, the row is immediately sorted into the correct position.</span></span>  
  
## <a name="other-notes-on-the-row-for-new-records"></a><span data-ttu-id="89aa1-145">Autres remarques sur la ligne pour les nouveaux enregistrements</span><span class="sxs-lookup"><span data-stu-id="89aa1-145">Other Notes on the Row for New Records</span></span>  
 <span data-ttu-id="89aa1-146">Vous ne pouvez pas définir la propriété <xref:System.Windows.Forms.DataGridViewRow.Visible%2A> de cette ligne sur `false`.</span><span class="sxs-lookup"><span data-stu-id="89aa1-146">You cannot set the <xref:System.Windows.Forms.DataGridViewRow.Visible%2A> property of this row to `false`.</span></span> <span data-ttu-id="89aa1-147">Une <xref:System.InvalidOperationException> est déclenchée si cette tentative est effectuée.</span><span class="sxs-lookup"><span data-stu-id="89aa1-147">An <xref:System.InvalidOperationException> is raised if this is attempted.</span></span>  
  
 <span data-ttu-id="89aa1-148">La ligne des nouveaux enregistrements est toujours créée dans l’état désélectionné.</span><span class="sxs-lookup"><span data-stu-id="89aa1-148">The row for new records is always created in the unselected state.</span></span>  
  
## <a name="virtual-mode"></a><span data-ttu-id="89aa1-149">Mode virtuel</span><span class="sxs-lookup"><span data-stu-id="89aa1-149">Virtual Mode</span></span>  
 <span data-ttu-id="89aa1-150">Si vous implémentez le mode virtuel, vous devez effectuer le suivi de la nécessité d’une ligne pour les nouveaux enregistrements dans le modèle de données et de la restauration de l’ajout de la ligne.</span><span class="sxs-lookup"><span data-stu-id="89aa1-150">If you are implementing virtual mode, you will need to track when a row for new records is needed in the data model and when to roll back the addition of the row.</span></span> <span data-ttu-id="89aa1-151">L’implémentation exacte de cette fonctionnalité dépend de l’implémentation du modèle de données et de sa sémantique de transaction, par exemple, si la portée de validation se situe au niveau de la cellule ou de la ligne.</span><span class="sxs-lookup"><span data-stu-id="89aa1-151">The exact implementation of this functionality depends on the implementation of the data model and its transaction semantics, for example, whether commit scope is at the cell or row level.</span></span> <span data-ttu-id="89aa1-152">Pour plus d’informations, consultez [mode virtuel dans le contrôle DataGridView Windows Forms](virtual-mode-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="89aa1-152">For more information, see [Virtual Mode in the Windows Forms DataGridView Control](virtual-mode-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="89aa1-153">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="89aa1-153">See also</span></span>

- <xref:System.Windows.Forms.DataGridView>
- <xref:System.Windows.Forms.DataGridView.DefaultValuesNeeded?displayProperty=nameWithType>
- [<span data-ttu-id="89aa1-154">Saisie de données dans le contrôle DataGridView Windows Forms</span><span class="sxs-lookup"><span data-stu-id="89aa1-154">Data Entry in the Windows Forms DataGridView Control</span></span>](data-entry-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="89aa1-155">Guide pratique pour spécifier des valeurs par défaut pour les nouvelles lignes dans le contrôle DataGridView Windows Forms</span><span class="sxs-lookup"><span data-stu-id="89aa1-155">How to: Specify Default Values for New Rows in the Windows Forms DataGridView Control</span></span>](specify-default-values-for-new-rows-in-the-datagrid.md)

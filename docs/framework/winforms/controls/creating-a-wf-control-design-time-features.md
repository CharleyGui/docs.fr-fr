---
title: 'Procédure pas à pas : création d’un contrôle Windows Forms qui tire parti des fonctionnalités au moment du design de Visual Studio'
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Windows Forms controls, creating
- design-time functionality [Windows Forms], Windows Forms
- DocumentDesigner class [Windows Forms]
- walkthroughs [Windows Forms], controls
ms.assetid: 6f487c59-cb38-4afa-ad2e-95edacb1d626
ms.openlocfilehash: 4d741beffa5649d1d1593ba3dbb7a1918b669b80
ms.sourcegitcommit: c4e9d05644c9cb89de5ce6002723de107ea2e2c4
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/19/2019
ms.locfileid: "65882312"
---
# <a name="walkthrough-creating-a-windows-forms-control-that-takes-advantage-of-visual-studio-design-time-features"></a><span data-ttu-id="d96b8-102">Procédure pas à pas : création d’un contrôle Windows Forms qui tire parti des fonctionnalités au moment du design de Visual Studio</span><span class="sxs-lookup"><span data-stu-id="d96b8-102">Walkthrough: Creating a Windows Forms Control That Takes Advantage of Visual Studio Design-Time Features</span></span>

<span data-ttu-id="d96b8-103">L’expérience au moment du design pour un contrôle personnalisé peut être améliorée en créant un concepteur personnalisé associé.</span><span class="sxs-lookup"><span data-stu-id="d96b8-103">The design-time experience for a custom control can be enhanced by authoring an associated custom designer.</span></span>

<span data-ttu-id="d96b8-104">Cette procédure pas à pas illustre comment créer un concepteur personnalisé pour un contrôle personnalisé.</span><span class="sxs-lookup"><span data-stu-id="d96b8-104">This walkthrough illustrates how to create a custom designer for a custom control.</span></span> <span data-ttu-id="d96b8-105">Vous allez implémenter un `MarqueeControl` type et une classe de concepteur associée, appelé `MarqueeControlRootDesigner`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-105">You will implement a `MarqueeControl` type and an associated designer class, called `MarqueeControlRootDesigner`.</span></span>

<span data-ttu-id="d96b8-106">Le `MarqueeControl` type implémente un affichage semblable à un texte défilant de théâtre, avec des lumières animées et du texte clignotant.</span><span class="sxs-lookup"><span data-stu-id="d96b8-106">The `MarqueeControl` type implements a display similar to a theater marquee, with animated lights and flashing text.</span></span>

<span data-ttu-id="d96b8-107">Le concepteur pour ce contrôle interagit avec l’environnement de conception pour fournir une expérience au moment du design personnalisée.</span><span class="sxs-lookup"><span data-stu-id="d96b8-107">The designer for this control interacts with the design environment to provide a custom design-time experience.</span></span> <span data-ttu-id="d96b8-108">Avec le concepteur personnalisé, vous pouvez assembler un personnalisé `MarqueeControl` implémentation avec des lumières animées et du texte clignotant selon plusieurs combinaisons.</span><span class="sxs-lookup"><span data-stu-id="d96b8-108">With the custom designer, you can assemble a custom `MarqueeControl` implementation with animated lights and flashing text in many combinations.</span></span> <span data-ttu-id="d96b8-109">Vous pouvez utiliser le contrôle assemblé sur un formulaire comme tout autre contrôle Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="d96b8-109">You can use the assembled control on a form like any other Windows Forms control.</span></span>

<span data-ttu-id="d96b8-110">Cette procédure pas à pas décrit notamment les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="d96b8-110">Tasks illustrated in this walkthrough include:</span></span>

- <span data-ttu-id="d96b8-111">Création du projet</span><span class="sxs-lookup"><span data-stu-id="d96b8-111">Creating the Project</span></span>

- <span data-ttu-id="d96b8-112">Création d’un projet de bibliothèque de contrôle</span><span class="sxs-lookup"><span data-stu-id="d96b8-112">Creating a Control Library Project</span></span>

- <span data-ttu-id="d96b8-113">Référencer le projet de contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-113">Referencing the Custom Control Project</span></span>

- <span data-ttu-id="d96b8-114">Définition d’un contrôle personnalisé et son concepteur personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-114">Defining a Custom Control and Its Custom Designer</span></span>

- <span data-ttu-id="d96b8-115">Création d’une Instance de votre contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-115">Creating an Instance of Your Custom Control</span></span>

- <span data-ttu-id="d96b8-116">Configuration du projet pour le débogage au moment du Design</span><span class="sxs-lookup"><span data-stu-id="d96b8-116">Setting Up the Project for Design-Time Debugging</span></span>

- <span data-ttu-id="d96b8-117">Implémentation de votre contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-117">Implementing Your Custom Control</span></span>

- <span data-ttu-id="d96b8-118">Création d’un contrôle enfant pour votre contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-118">Creating a Child Control for Your Custom Control</span></span>

- <span data-ttu-id="d96b8-119">Créer le contrôle enfant MarqueeBorder</span><span class="sxs-lookup"><span data-stu-id="d96b8-119">Create the MarqueeBorder Child Control</span></span>

- <span data-ttu-id="d96b8-120">Création d’un concepteur personnalisé pour les clichés instantanés et les propriétés de filtre</span><span class="sxs-lookup"><span data-stu-id="d96b8-120">Creating a Custom Designer to Shadow and Filter Properties</span></span>

- <span data-ttu-id="d96b8-121">Gestion des modifications de composant</span><span class="sxs-lookup"><span data-stu-id="d96b8-121">Handling Component Changes</span></span>

- <span data-ttu-id="d96b8-122">Ajout de verbes de concepteur à votre concepteur personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-122">Adding Designer Verbs to your Custom Designer</span></span>

- <span data-ttu-id="d96b8-123">Création d’un UITypeEditor personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-123">Creating a Custom UITypeEditor</span></span>

- <span data-ttu-id="d96b8-124">Test de votre contrôle personnalisé dans le Concepteur</span><span class="sxs-lookup"><span data-stu-id="d96b8-124">Testing your Custom Control in the Designer</span></span>

<span data-ttu-id="d96b8-125">Lorsque vous avez terminé, votre contrôle personnalisé se présente comme suit :</span><span class="sxs-lookup"><span data-stu-id="d96b8-125">When you are finished, your custom control will look something like the following:</span></span>

![L’application affiche un texte défilant indiquant que le texte et un boutons de démarrage et d’arrêt.](./media/creating-a-wf-control-design-time-features/demo-marquee-control.gif)

<span data-ttu-id="d96b8-127">Pour l’intégralité du code, consultez [Comment : Créer un contrôle Windows Forms tire parti des fonctionnalités de conception](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/307hck25(v=vs.120)).</span><span class="sxs-lookup"><span data-stu-id="d96b8-127">For the complete code listing, see [How to: Create a Windows Forms Control That Takes Advantage of Design-Time Features](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/307hck25(v=vs.120)).</span></span>

> [!NOTE]
> <span data-ttu-id="d96b8-128">Les boîtes de dialogue et les commandes de menu qui s'affichent peuvent être différentes de celles qui sont décrites dans l'aide, en fonction de vos paramètres actifs ou de l'édition utilisée.</span><span class="sxs-lookup"><span data-stu-id="d96b8-128">The dialog boxes and menu commands you see might differ from those described in Help depending on your active settings or edition.</span></span> <span data-ttu-id="d96b8-129">Pour modifier vos paramètres, choisissez **Importation et exportation de paramètres** dans le menu **Outils** .</span><span class="sxs-lookup"><span data-stu-id="d96b8-129">To change your settings, choose **Import and Export Settings** on the **Tools** menu.</span></span> <span data-ttu-id="d96b8-130">Pour plus d’informations, consultez [Personnaliser l’IDE Visual Studio](/visualstudio/ide/personalizing-the-visual-studio-ide).</span><span class="sxs-lookup"><span data-stu-id="d96b8-130">For more information, see [Personalize the Visual Studio IDE](/visualstudio/ide/personalizing-the-visual-studio-ide).</span></span>

## <a name="prerequisites"></a><span data-ttu-id="d96b8-131">Prérequis</span><span class="sxs-lookup"><span data-stu-id="d96b8-131">Prerequisites</span></span>

<span data-ttu-id="d96b8-132">Pour pouvoir effectuer cette procédure pas à pas, vous aurez besoin de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d96b8-132">In order to complete this walkthrough, you'll need Visual Studio.</span></span>

## <a name="creating-the-project"></a><span data-ttu-id="d96b8-133">Création du projet</span><span class="sxs-lookup"><span data-stu-id="d96b8-133">Creating the Project</span></span>

<span data-ttu-id="d96b8-134">La première étape consiste à créer le projet d’application.</span><span class="sxs-lookup"><span data-stu-id="d96b8-134">The first step is to create the application project.</span></span> <span data-ttu-id="d96b8-135">Vous utiliserez ce projet pour générer l’application qui héberge le contrôle personnalisé.</span><span class="sxs-lookup"><span data-stu-id="d96b8-135">You will use this project to build the application that hosts the custom control.</span></span>

<span data-ttu-id="d96b8-136">Ouvrez Visual Studio et créez un projet Windows Forms Application appelé « MarqueeControlTest » (**fichier** > **New** > **projet**  >  **Visual C#**  ou **Visual Basic** > **bureau classique** > **Windows Forms Application**).</span><span class="sxs-lookup"><span data-stu-id="d96b8-136">Open Visual Studio and create a Windows Forms Application project called "MarqueeControlTest" (**File** > **New** > **Project** > **Visual C#** or **Visual Basic** > **Classic Desktop** > **Windows Forms Application**).</span></span>

## <a name="creating-a-control-library-project"></a><span data-ttu-id="d96b8-137">Création d’un projet de bibliothèque de contrôle</span><span class="sxs-lookup"><span data-stu-id="d96b8-137">Creating a Control Library Project</span></span>

<span data-ttu-id="d96b8-138">L’étape suivante consiste à créer le projet de bibliothèque de contrôles.</span><span class="sxs-lookup"><span data-stu-id="d96b8-138">The next step is to create the control library project.</span></span> <span data-ttu-id="d96b8-139">Vous allez créer un nouveau contrôle personnalisé et son concepteur personnalisé correspondant.</span><span class="sxs-lookup"><span data-stu-id="d96b8-139">You will create a new custom control and its corresponding custom designer.</span></span>

### <a name="to-create-the-control-library-project"></a><span data-ttu-id="d96b8-140">Pour créer le projet de bibliothèque de contrôle</span><span class="sxs-lookup"><span data-stu-id="d96b8-140">To create the control library project</span></span>

1. <span data-ttu-id="d96b8-141">Ajouter un projet de bibliothèque de contrôles Windows Forms à la solution.</span><span class="sxs-lookup"><span data-stu-id="d96b8-141">Add a Windows Forms Control Library project to the solution.</span></span> <span data-ttu-id="d96b8-142">Nommez le projet « MarqueeControlLibrary ».</span><span class="sxs-lookup"><span data-stu-id="d96b8-142">Name the project "MarqueeControlLibrary."</span></span>

2. <span data-ttu-id="d96b8-143">À l’aide de **l’Explorateur de solutions**, supprimer le contrôle du projet par défaut en supprimant le fichier source nommé « UserControl1.cs » ou « UserControl1.vb », en fonction de la langue de votre choix.</span><span class="sxs-lookup"><span data-stu-id="d96b8-143">Using **Solution Explorer**, delete the project's default control by deleting the source file named "UserControl1.cs" or "UserControl1.vb", depending on your language of choice.</span></span> <span data-ttu-id="d96b8-144">Pour plus d'informations, voir [Procédure : Supprimer, suppression et exclure des éléments](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/0ebzhwsk(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="d96b8-144">For more information, see [How to: Remove, Delete, and Exclude Items](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/0ebzhwsk(v=vs.100)).</span></span>

3. <span data-ttu-id="d96b8-145">Ajouter un nouveau <xref:System.Windows.Forms.UserControl> d’élément à la `MarqueeControlLibrary` projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-145">Add a new <xref:System.Windows.Forms.UserControl> item to the `MarqueeControlLibrary` project.</span></span> <span data-ttu-id="d96b8-146">Nommez le nouveau fichier source une base de « MarqueeControl. »</span><span class="sxs-lookup"><span data-stu-id="d96b8-146">Give the new source file a base name of "MarqueeControl."</span></span>

4. <span data-ttu-id="d96b8-147">À l’aide de **l’Explorateur de solutions**, créez un dossier dans le `MarqueeControlLibrary` projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-147">Using **Solution Explorer**, create a new folder in the `MarqueeControlLibrary` project.</span></span> <span data-ttu-id="d96b8-148">Pour plus d'informations, voir [Procédure : Ajouter de nouveaux éléments de projet](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/w0572c5b(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="d96b8-148">For more information, see [How to: Add New Project Items](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/w0572c5b(v=vs.100)).</span></span> <span data-ttu-id="d96b8-149">Nommez le nouveau dossier « Conception ».</span><span class="sxs-lookup"><span data-stu-id="d96b8-149">Name the new folder "Design."</span></span>

5. <span data-ttu-id="d96b8-150">Cliquez sur le **conception** dossier et ajoutez une nouvelle classe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-150">Right-click the **Design** folder and add a new class.</span></span> <span data-ttu-id="d96b8-151">Nommez le fichier source une base de « MarqueeControlRootDesigner. »</span><span class="sxs-lookup"><span data-stu-id="d96b8-151">Give the source file a base name of "MarqueeControlRootDesigner."</span></span>

6. <span data-ttu-id="d96b8-152">Vous devez utiliser des types de l’assembly System.Design, ajoutez cette référence à la `MarqueeControlLibrary` projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-152">You will need to use types from the System.Design assembly, so add this reference to the `MarqueeControlLibrary` project.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d96b8-153">Pour utiliser l’assembly System.Design, votre projet doit cibler la version complète du .NET Framework, pas le .NET Framework Client Profile.</span><span class="sxs-lookup"><span data-stu-id="d96b8-153">To use the System.Design assembly, your project must target the full version of the .NET Framework, not the .NET Framework Client Profile.</span></span> <span data-ttu-id="d96b8-154">Pour modifier le framework cible, consultez [Comment : Cibler une version du .NET Framework](/visualstudio/ide/how-to-target-a-version-of-the-dotnet-framework).</span><span class="sxs-lookup"><span data-stu-id="d96b8-154">To change the target framework, see [How to: Target a Version of the .NET Framework](/visualstudio/ide/how-to-target-a-version-of-the-dotnet-framework).</span></span>

## <a name="referencing-the-custom-control-project"></a><span data-ttu-id="d96b8-155">Référencer le projet de contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-155">Referencing the Custom Control Project</span></span>

<span data-ttu-id="d96b8-156">Vous utiliserez le `MarqueeControlTest` projet pour tester le contrôle personnalisé.</span><span class="sxs-lookup"><span data-stu-id="d96b8-156">You will use the `MarqueeControlTest` project to test the custom control.</span></span> <span data-ttu-id="d96b8-157">Le projet de test auront connaissance du contrôle personnalisé lorsque vous ajoutez une référence de projet pour le `MarqueeControlLibrary` assembly.</span><span class="sxs-lookup"><span data-stu-id="d96b8-157">The test project will become aware of the custom control when you add a project reference to the `MarqueeControlLibrary` assembly.</span></span>

### <a name="to-reference-the-custom-control-project"></a><span data-ttu-id="d96b8-158">Pour référencer le projet de contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-158">To reference the custom control project</span></span>

- <span data-ttu-id="d96b8-159">Dans le `MarqueeControlTest` de projet, ajoutez une référence de projet pour le `MarqueeControlLibrary` assembly.</span><span class="sxs-lookup"><span data-stu-id="d96b8-159">In the `MarqueeControlTest` project, add a project reference to the `MarqueeControlLibrary` assembly.</span></span> <span data-ttu-id="d96b8-160">Veillez à utiliser le **projets** onglet dans le **ajouter une référence** boîte de dialogue au lieu de référencer le `MarqueeControlLibrary` assembly directement.</span><span class="sxs-lookup"><span data-stu-id="d96b8-160">Be sure to use the **Projects** tab in the **Add Reference** dialog box instead of referencing the `MarqueeControlLibrary` assembly directly.</span></span>

## <a name="defining-a-custom-control-and-its-custom-designer"></a><span data-ttu-id="d96b8-161">Définition d’un contrôle personnalisé et son concepteur personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-161">Defining a Custom Control and Its Custom Designer</span></span>
 <span data-ttu-id="d96b8-162">Votre contrôle personnalisé doivent dériver de la <xref:System.Windows.Forms.UserControl> classe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-162">Your custom control will derive from the <xref:System.Windows.Forms.UserControl> class.</span></span> <span data-ttu-id="d96b8-163">Cela permet à votre contrôle de contenir d’autres contrôles, et il donne à votre contrôle un grand nombre de fonctionnalités par défaut.</span><span class="sxs-lookup"><span data-stu-id="d96b8-163">This allows your control to contain other controls, and it gives your control a great deal of default functionality.</span></span>

 <span data-ttu-id="d96b8-164">Votre contrôle personnalisé aura un concepteur personnalisé associé.</span><span class="sxs-lookup"><span data-stu-id="d96b8-164">Your custom control will have an associated custom designer.</span></span> <span data-ttu-id="d96b8-165">Cela vous permet de créer une expérience de conception unique spécifiquement adaptée à votre contrôle personnalisé.</span><span class="sxs-lookup"><span data-stu-id="d96b8-165">This allows you to create a unique design experience tailored specifically for your custom control.</span></span>

 <span data-ttu-id="d96b8-166">Vous associez le contrôle à son concepteur à l’aide de la <xref:System.ComponentModel.DesignerAttribute> classe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-166">You associate the control with its designer by using the <xref:System.ComponentModel.DesignerAttribute> class.</span></span> <span data-ttu-id="d96b8-167">Étant donné que vous développez l’ensemble du comportement au moment du design de votre contrôle personnalisé, le concepteur personnalisé implémentera le <xref:System.ComponentModel.Design.IRootDesigner> interface.</span><span class="sxs-lookup"><span data-stu-id="d96b8-167">Because you are developing the entire design-time behavior of your custom control, the custom designer will implement the <xref:System.ComponentModel.Design.IRootDesigner> interface.</span></span>

### <a name="to-define-a-custom-control-and-its-custom-designer"></a><span data-ttu-id="d96b8-168">Pour définir un contrôle personnalisé et son concepteur personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-168">To define a custom control and its custom designer</span></span>

1. <span data-ttu-id="d96b8-169">Ouvrez le `MarqueeControl` fichier source dans le **éditeur de Code**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-169">Open the `MarqueeControl` source file in the **Code Editor**.</span></span> <span data-ttu-id="d96b8-170">En haut du fichier, importez les espaces de noms suivants :</span><span class="sxs-lookup"><span data-stu-id="d96b8-170">At the top of the file, import the following namespaces:</span></span>

     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#220](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#220)]
     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#220](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#220)]

2. <span data-ttu-id="d96b8-171">Ajouter le <xref:System.ComponentModel.DesignerAttribute> à la `MarqueeControl` déclaration de classe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-171">Add the <xref:System.ComponentModel.DesignerAttribute> to the `MarqueeControl` class declaration.</span></span> <span data-ttu-id="d96b8-172">Cela associe le contrôle personnalisé à son concepteur.</span><span class="sxs-lookup"><span data-stu-id="d96b8-172">This associates the custom control with its designer.</span></span>

     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#240](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#240)]
     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#240](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#240)]

3. <span data-ttu-id="d96b8-173">Ouvrez le `MarqueeControlRootDesigner` fichier source dans le **éditeur de Code**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-173">Open the `MarqueeControlRootDesigner` source file in the **Code Editor**.</span></span> <span data-ttu-id="d96b8-174">En haut du fichier, importez les espaces de noms suivants :</span><span class="sxs-lookup"><span data-stu-id="d96b8-174">At the top of the file, import the following namespaces:</span></span>

     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#520](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#520)]
     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#520](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#520)]

4. <span data-ttu-id="d96b8-175">Modifiez la déclaration de `MarqueeControlRootDesigner` d’hériter de la <xref:System.Windows.Forms.Design.DocumentDesigner> classe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-175">Change the declaration of `MarqueeControlRootDesigner` to inherit from the <xref:System.Windows.Forms.Design.DocumentDesigner> class.</span></span> <span data-ttu-id="d96b8-176">Appliquer le <xref:System.ComponentModel.ToolboxItemFilterAttribute> pour spécifier l’interaction du concepteur avec le **boîte à outils**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-176">Apply the <xref:System.ComponentModel.ToolboxItemFilterAttribute> to specify the designer interaction with the **Toolbox**.</span></span>

     <span data-ttu-id="d96b8-177">**Remarque** la définition de la `MarqueeControlRootDesigner` classe a été placée dans un espace de noms appelé « MarqueeControlLibrary.Design ».</span><span class="sxs-lookup"><span data-stu-id="d96b8-177">**Note** The definition for the `MarqueeControlRootDesigner` class has been enclosed in a namespace called "MarqueeControlLibrary.Design."</span></span> <span data-ttu-id="d96b8-178">Cette déclaration place le concepteur dans un espace de noms spécial réservé pour les types liés à la conception.</span><span class="sxs-lookup"><span data-stu-id="d96b8-178">This declaration places the designer in a special namespace reserved for design-related types.</span></span>

     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#530](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#530)]
     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#530](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#530)]

5. <span data-ttu-id="d96b8-179">Définissez le constructeur pour la `MarqueeControlRootDesigner` classe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-179">Define the constructor for the `MarqueeControlRootDesigner` class.</span></span> <span data-ttu-id="d96b8-180">Insérer un <xref:System.Diagnostics.Trace.WriteLine%2A> instruction dans le corps du constructeur.</span><span class="sxs-lookup"><span data-stu-id="d96b8-180">Insert a <xref:System.Diagnostics.Trace.WriteLine%2A> statement in the constructor body.</span></span> <span data-ttu-id="d96b8-181">Cela sera utile pour le débogage.</span><span class="sxs-lookup"><span data-stu-id="d96b8-181">This will be useful for debugging purposes.</span></span>

     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#540](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#540)]
     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#540](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#540)]

## <a name="creating-an-instance-of-your-custom-control"></a><span data-ttu-id="d96b8-182">Création d’une Instance de votre contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-182">Creating an Instance of Your Custom Control</span></span>
 <span data-ttu-id="d96b8-183">Pour observer le comportement personnalisé au moment du design de votre contrôle, vous placerez une instance de votre contrôle sur le formulaire dans `MarqueeControlTest` projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-183">To observe the custom design-time behavior of your control, you will place an instance of your control on the form in `MarqueeControlTest` project.</span></span>

### <a name="to-create-an-instance-of-your-custom-control"></a><span data-ttu-id="d96b8-184">Pour créer une instance de votre contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-184">To create an instance of your custom control</span></span>

1. <span data-ttu-id="d96b8-185">Ajouter un nouveau <xref:System.Windows.Forms.UserControl> d’élément à la `MarqueeControlTest` projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-185">Add a new <xref:System.Windows.Forms.UserControl> item to the `MarqueeControlTest` project.</span></span> <span data-ttu-id="d96b8-186">Nommez le nouveau fichier source une base de « DemoMarqueeControl. »</span><span class="sxs-lookup"><span data-stu-id="d96b8-186">Give the new source file a base name of "DemoMarqueeControl."</span></span>

2. <span data-ttu-id="d96b8-187">Ouvrez le `DemoMarqueeControl` de fichiers dans le **éditeur de Code**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-187">Open the `DemoMarqueeControl` file in the **Code Editor**.</span></span> <span data-ttu-id="d96b8-188">En haut du fichier, importez le `MarqueeControlLibrary` espace de noms :</span><span class="sxs-lookup"><span data-stu-id="d96b8-188">At the top of the file, import the `MarqueeControlLibrary` namespace:</span></span>

```vb
Imports MarqueeControlLibrary
```

```csharp
using MarqueeControlLibrary;
```

1. <span data-ttu-id="d96b8-189">Modifiez la déclaration de `DemoMarqueeControl` d’hériter de la `MarqueeControl` classe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-189">Change the declaration of `DemoMarqueeControl` to inherit from the `MarqueeControl` class.</span></span>

2. <span data-ttu-id="d96b8-190">Générez le projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-190">Build the project.</span></span>

3. <span data-ttu-id="d96b8-191">Ouvrez `Form1` dans le Concepteur Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="d96b8-191">Open `Form1` in the Windows Forms Designer.</span></span>

4. <span data-ttu-id="d96b8-192">Rechercher la **Composants MarqueeControlTest** onglet dans le **boîte à outils** et ouvrez-le.</span><span class="sxs-lookup"><span data-stu-id="d96b8-192">Find the **MarqueeControlTest Components** tab in the **Toolbox** and open it.</span></span> <span data-ttu-id="d96b8-193">Faites glisser un `DemoMarqueeControl` à partir de la **boîte à outils** vers votre formulaire.</span><span class="sxs-lookup"><span data-stu-id="d96b8-193">Drag a `DemoMarqueeControl` from the **Toolbox** onto your form.</span></span>

5. <span data-ttu-id="d96b8-194">Générez le projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-194">Build the project.</span></span>

## <a name="setting-up-the-project-for-design-time-debugging"></a><span data-ttu-id="d96b8-195">Configuration du projet pour le débogage au moment du Design</span><span class="sxs-lookup"><span data-stu-id="d96b8-195">Setting Up the Project for Design-Time Debugging</span></span>

<span data-ttu-id="d96b8-196">Lorsque vous développez une expérience de conception personnalisée, il sera nécessaire déboguer vos composants et contrôles.</span><span class="sxs-lookup"><span data-stu-id="d96b8-196">When you are developing a custom design-time experience, it will be necessary to debug your controls and components.</span></span> <span data-ttu-id="d96b8-197">Il existe un moyen simple de configurer votre projet pour autoriser le débogage au moment du design.</span><span class="sxs-lookup"><span data-stu-id="d96b8-197">There is a simple way to set up your project to allow debugging at design time.</span></span> <span data-ttu-id="d96b8-198">Pour plus d’informations, consultez [Procédure pas à pas : Débogage personnalisés Windows Forms des contrôles au moment du Design](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md).</span><span class="sxs-lookup"><span data-stu-id="d96b8-198">For more information, see [Walkthrough: Debugging Custom Windows Forms Controls at Design Time](walkthrough-debugging-custom-windows-forms-controls-at-design-time.md).</span></span>

### <a name="to-set-up-the-project-for-design-time-debugging"></a><span data-ttu-id="d96b8-199">Pour configurer le projet pour le débogage au moment du design</span><span class="sxs-lookup"><span data-stu-id="d96b8-199">To set up the project for design-time debugging</span></span>

1. <span data-ttu-id="d96b8-200">Cliquez sur le `MarqueeControlLibrary` de projet et sélectionnez **propriétés**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-200">Right-click the `MarqueeControlLibrary` project and select **Properties**.</span></span>

2. <span data-ttu-id="d96b8-201">Dans la boîte de dialogue « Pages de propriétés MarqueeControlLibrary », sélectionnez le **déboguer** page.</span><span class="sxs-lookup"><span data-stu-id="d96b8-201">In the "MarqueeControlLibrary Property Pages" dialog box, select the **Debug** page.</span></span>

3. <span data-ttu-id="d96b8-202">Dans le **Action de démarrage** section, sélectionnez **démarrer le programme externe**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-202">In the **Start Action** section, select **Start External Program**.</span></span> <span data-ttu-id="d96b8-203">Vous serez le débogage d’une instance distincte de Visual Studio, cliquez sur le bouton de sélection (![bouton les points de suspension (...) dans la fenêtre Propriétés de Visual Studio.](./media/visual-studio-ellipsis-button.png)) pour le rechercher l’IDE Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="d96b8-203">You will be debugging a separate instance of Visual Studio, so click the ellipsis (![The Ellipsis button (...) in the Properties window of Visual Studio.](./media/visual-studio-ellipsis-button.png)) button to browse for the Visual Studio IDE.</span></span> <span data-ttu-id="d96b8-204">Le nom du fichier exécutable est devenv.exe, et si vous avez installé à l’emplacement par défaut, son chemin d’accès est %programfiles%\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-204">The name of the executable file is devenv.exe, and if you installed to the default location, its path is %programfiles%\Microsoft Visual Studio 9.0\Common7\IDE\devenv.exe.</span></span>

4. <span data-ttu-id="d96b8-205">Cliquez sur OK pour fermer la boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="d96b8-205">Click OK to close the dialog box.</span></span>

5. <span data-ttu-id="d96b8-206">Cliquez sur le `MarqueeControlLibrary` de projet et sélectionnez « Définir comme projet de démarrage » pour activer cette configuration de débogage.</span><span class="sxs-lookup"><span data-stu-id="d96b8-206">Right-click the `MarqueeControlLibrary` project and select "Set as StartUp Project" to enable this debugging configuration.</span></span>

## <a name="checkpoint"></a><span data-ttu-id="d96b8-207">Point de contrôle</span><span class="sxs-lookup"><span data-stu-id="d96b8-207">Checkpoint</span></span>

<span data-ttu-id="d96b8-208">Vous êtes maintenant prêt à déboguer le comportement au moment du design de votre contrôle personnalisé.</span><span class="sxs-lookup"><span data-stu-id="d96b8-208">You are now ready to debug the design-time behavior of your custom control.</span></span> <span data-ttu-id="d96b8-209">Une fois que vous avez déterminé que l’environnement de débogage est correctement configuré, vous allez tester l’association entre le contrôle personnalisé et le concepteur personnalisé.</span><span class="sxs-lookup"><span data-stu-id="d96b8-209">Once you have determined that the debugging environment is set up correctly, you will test the association between the custom control and the custom designer.</span></span>

### <a name="to-test-the-debugging-environment-and-the-designer-association"></a><span data-ttu-id="d96b8-210">Pour tester l’environnement de débogage et l’association de concepteur</span><span class="sxs-lookup"><span data-stu-id="d96b8-210">To test the debugging environment and the designer association</span></span>

1. <span data-ttu-id="d96b8-211">Ouvrez le `MarqueeControlRootDesigner` fichier source dans le **éditeur de Code** et placer un point d’arrêt sur la <xref:System.Diagnostics.Trace.WriteLine%2A> instruction.</span><span class="sxs-lookup"><span data-stu-id="d96b8-211">Open the `MarqueeControlRootDesigner` source file in the **Code Editor** and place a breakpoint on the <xref:System.Diagnostics.Trace.WriteLine%2A> statement.</span></span>

2. <span data-ttu-id="d96b8-212">Appuyez sur F5 pour démarrer la session de débogage.</span><span class="sxs-lookup"><span data-stu-id="d96b8-212">Press F5 to start the debugging session.</span></span> <span data-ttu-id="d96b8-213">Notez qu’une nouvelle instance de Visual Studio est créée.</span><span class="sxs-lookup"><span data-stu-id="d96b8-213">Note that a new instance of Visual Studio is created.</span></span>

3. <span data-ttu-id="d96b8-214">Dans la nouvelle instance de Visual Studio, ouvrez la solution « MarqueeControlTest ».</span><span class="sxs-lookup"><span data-stu-id="d96b8-214">In the new instance of Visual Studio, open the "MarqueeControlTest" solution.</span></span> <span data-ttu-id="d96b8-215">Vous pouvez facilement trouver la solution en sélectionnant **projets récents** à partir de la **fichier** menu.</span><span class="sxs-lookup"><span data-stu-id="d96b8-215">You can easily find the solution by selecting **Recent Projects** from the **File** menu.</span></span> <span data-ttu-id="d96b8-216">Le fichier de solution « MarqueeControlTest.sln » apparaît comme étant le dernier fichier utilisé.</span><span class="sxs-lookup"><span data-stu-id="d96b8-216">The "MarqueeControlTest.sln" solution file will be listed as the most recently used file.</span></span>

4. <span data-ttu-id="d96b8-217">Ouvrez le `DemoMarqueeControl` dans le concepteur.</span><span class="sxs-lookup"><span data-stu-id="d96b8-217">Open the `DemoMarqueeControl` in the designer.</span></span> <span data-ttu-id="d96b8-218">Notez que l’instance de débogage de Visual Studio acquiert le focus et l’exécution s’arrête au point d’arrêt.</span><span class="sxs-lookup"><span data-stu-id="d96b8-218">Note that the debugging instance of Visual Studio acquires focus and execution stops at your breakpoint.</span></span> <span data-ttu-id="d96b8-219">Appuyez sur F5 pour continuer la session de débogage.</span><span class="sxs-lookup"><span data-stu-id="d96b8-219">Press F5 to continue the debugging session.</span></span>

<span data-ttu-id="d96b8-220">À ce stade, tout est en place pour vous permettre de développer et déboguer votre contrôle personnalisé et son concepteur personnalisé associé.</span><span class="sxs-lookup"><span data-stu-id="d96b8-220">At this point, everything is in place for you to develop and debug your custom control and its associated custom designer.</span></span> <span data-ttu-id="d96b8-221">Le reste de cette procédure pas à pas se concentre sur les détails de l’implémentation des fonctionnalités du contrôle et le concepteur.</span><span class="sxs-lookup"><span data-stu-id="d96b8-221">The remainder of this walkthrough will concentrate on the details of implementing features of the control and the designer.</span></span>

## <a name="implementing-your-custom-control"></a><span data-ttu-id="d96b8-222">Implémentation de votre contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-222">Implementing Your Custom Control</span></span>

<span data-ttu-id="d96b8-223">Le `MarqueeControl` est un <xref:System.Windows.Forms.UserControl> avec un peu de personnalisation.</span><span class="sxs-lookup"><span data-stu-id="d96b8-223">The `MarqueeControl` is a <xref:System.Windows.Forms.UserControl> with a little bit of customization.</span></span> <span data-ttu-id="d96b8-224">Il expose deux méthodes : `Start`, qui démarre l’animation de texte défilant, et `Stop`, ce qui arrête l’animation.</span><span class="sxs-lookup"><span data-stu-id="d96b8-224">It exposes two methods: `Start`, which starts the marquee animation, and `Stop`, which stops the animation.</span></span> <span data-ttu-id="d96b8-225">Étant donné que le `MarqueeControl` contient des contrôles enfants qui implémentent le `IMarqueeWidget` interface, `Start` et `Stop` énumérer chaque contrôle enfant et l’appel de la `StartMarquee` et `StopMarquee` méthodes, respectivement, sur chaque contrôle enfant qui implémente `IMarqueeWidget`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-225">Because the `MarqueeControl` contains child controls that implement the `IMarqueeWidget` interface, `Start` and `Stop` enumerate each child control and call the `StartMarquee` and `StopMarquee` methods, respectively, on each child control that implements `IMarqueeWidget`.</span></span>

<span data-ttu-id="d96b8-226">L’apparence de la `MarqueeBorder` et `MarqueeText` contrôles est dépendante de la disposition, afin `MarqueeControl` remplace le <xref:System.Windows.Forms.Control.OnLayout%2A> méthode et appelle <xref:System.Windows.Forms.Control.PerformLayout%2A> sur les contrôles enfants de ce type.</span><span class="sxs-lookup"><span data-stu-id="d96b8-226">The appearance of the `MarqueeBorder` and `MarqueeText` controls is dependent on the layout, so `MarqueeControl` overrides the <xref:System.Windows.Forms.Control.OnLayout%2A> method and calls <xref:System.Windows.Forms.Control.PerformLayout%2A> on child controls of this type.</span></span>

<span data-ttu-id="d96b8-227">Ceci est l’étendue de la `MarqueeControl` personnalisations.</span><span class="sxs-lookup"><span data-stu-id="d96b8-227">This is the extent of the `MarqueeControl` customizations.</span></span> <span data-ttu-id="d96b8-228">Les fonctionnalités d’exécution sont implémentées par le `MarqueeBorder` et `MarqueeText` contrôles et les fonctionnalités au moment du design sont implémentées par le `MarqueeBorderDesigner` et `MarqueeControlRootDesigner` classes.</span><span class="sxs-lookup"><span data-stu-id="d96b8-228">The run-time features are implemented by the `MarqueeBorder` and `MarqueeText` controls, and the design-time features are implemented by the `MarqueeBorderDesigner` and `MarqueeControlRootDesigner` classes.</span></span>

### <a name="to-implement-your-custom-control"></a><span data-ttu-id="d96b8-229">Pour implémenter votre contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-229">To implement your custom control</span></span>

1. <span data-ttu-id="d96b8-230">Ouvrez le `MarqueeControl` fichier source dans le **éditeur de Code**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-230">Open the `MarqueeControl` source file in the **Code Editor**.</span></span> <span data-ttu-id="d96b8-231">Implémentez le `Start` et `Stop` méthodes.</span><span class="sxs-lookup"><span data-stu-id="d96b8-231">Implement the `Start` and `Stop` methods.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#260](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#260)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#260](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#260)]

2. <span data-ttu-id="d96b8-232">Remplacez la méthode <xref:System.Windows.Forms.Control.OnLayout%2A> .</span><span class="sxs-lookup"><span data-stu-id="d96b8-232">Override the <xref:System.Windows.Forms.Control.OnLayout%2A> method.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#270](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrol.cs#270)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#270](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrol.vb#270)]

## <a name="creating-a-child-control-for-your-custom-control"></a><span data-ttu-id="d96b8-233">Création d’un contrôle enfant pour votre contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-233">Creating a Child Control for Your Custom Control</span></span>

<span data-ttu-id="d96b8-234">Le `MarqueeControl` hébergera les deux types de contrôle enfant : le `MarqueeBorder` contrôle et le `MarqueeText` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d96b8-234">The `MarqueeControl` will host two kinds of child control: the `MarqueeBorder` control and the `MarqueeText` control.</span></span>

- <span data-ttu-id="d96b8-235">`MarqueeBorder`: Ce contrôle est peint une bordure de « lumières » autour de ses bords.</span><span class="sxs-lookup"><span data-stu-id="d96b8-235">`MarqueeBorder`: This control paints a border of "lights" around its edges.</span></span> <span data-ttu-id="d96b8-236">Les lumières flash en séquence, afin qu’ils semblent se déplacent autour de la bordure.</span><span class="sxs-lookup"><span data-stu-id="d96b8-236">The lights flash in sequence, so they appear to be moving around the border.</span></span> <span data-ttu-id="d96b8-237">La vitesse à laquelle l’éclairage flash est contrôlée par une propriété appelée `UpdatePeriod`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-237">The speed at which the lights flash is controlled by a property called `UpdatePeriod`.</span></span> <span data-ttu-id="d96b8-238">Plusieurs autres propriétés personnalisées déterminent les autres aspects de l’apparence du contrôle.</span><span class="sxs-lookup"><span data-stu-id="d96b8-238">Several other custom properties determine other aspects of the control's appearance.</span></span> <span data-ttu-id="d96b8-239">Deux méthodes, appelées `StartMarquee` et `StopMarquee`, contrôler quand l’animation démarre et s’arrête.</span><span class="sxs-lookup"><span data-stu-id="d96b8-239">Two methods, called `StartMarquee` and `StopMarquee`, control when the animation starts and stops.</span></span>

- <span data-ttu-id="d96b8-240">`MarqueeText`: Ce contrôle est peint une chaîne clignotante.</span><span class="sxs-lookup"><span data-stu-id="d96b8-240">`MarqueeText`: This control paints a flashing string.</span></span> <span data-ttu-id="d96b8-241">Comme le `MarqueeBorder` contrôle, la vitesse à laquelle le texte clignote est contrôlée par le `UpdatePeriod` propriété.</span><span class="sxs-lookup"><span data-stu-id="d96b8-241">Like the `MarqueeBorder` control, the speed at which the text flashes is controlled by the `UpdatePeriod` property.</span></span> <span data-ttu-id="d96b8-242">Le `MarqueeText` contrôle a également la `StartMarquee` et `StopMarquee` méthodes en commun avec la `MarqueeBorder` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d96b8-242">The `MarqueeText` control also has the `StartMarquee` and `StopMarquee` methods in common with the `MarqueeBorder` control.</span></span>

<span data-ttu-id="d96b8-243">Au moment du design, le `MarqueeControlRootDesigner` permet à ces deux types de contrôle à ajouter à un `MarqueeControl` dans n’importe quelle combinaison.</span><span class="sxs-lookup"><span data-stu-id="d96b8-243">At design time, the `MarqueeControlRootDesigner` allows these two control types to be added to a `MarqueeControl` in any combination.</span></span>

<span data-ttu-id="d96b8-244">Fonctionnalités communes des deux contrôles sont incluses dans une interface appelée `IMarqueeWidget`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-244">Common features of the two controls are factored into an interface called `IMarqueeWidget`.</span></span> <span data-ttu-id="d96b8-245">Cela permet la `MarqueeControl` pour découvrir tous les contrôles enfants connexes au texte défilant et de leur traitement spécial.</span><span class="sxs-lookup"><span data-stu-id="d96b8-245">This allows the `MarqueeControl` to discover any Marquee-related child controls and give them special treatment.</span></span>

<span data-ttu-id="d96b8-246">Pour implémenter la fonctionnalité d’animation périodique, vous allez utiliser <xref:System.ComponentModel.BackgroundWorker> objets à partir de la <xref:System.ComponentModel?displayProperty=nameWithType> espace de noms.</span><span class="sxs-lookup"><span data-stu-id="d96b8-246">To implement the periodic animation feature, you will use <xref:System.ComponentModel.BackgroundWorker> objects from the <xref:System.ComponentModel?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="d96b8-247">Vous pouvez utiliser <xref:System.Windows.Forms.Timer> objets, mais lorsque plusieurs `IMarqueeWidget` objets sont présents, le thread d’interface utilisateur unique peut être incapable de suivre l’animation.</span><span class="sxs-lookup"><span data-stu-id="d96b8-247">You could use <xref:System.Windows.Forms.Timer> objects, but when many `IMarqueeWidget` objects are present, the single UI thread may be unable to keep up with the animation.</span></span>

### <a name="to-create-a-child-control-for-your-custom-control"></a><span data-ttu-id="d96b8-248">Pour créer un contrôle enfant pour votre contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-248">To create a child control for your custom control</span></span>

1. <span data-ttu-id="d96b8-249">Ajouter un nouvel élément de classe pour le `MarqueeControlLibrary` projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-249">Add a new class item to the `MarqueeControlLibrary` project.</span></span> <span data-ttu-id="d96b8-250">Nommez le nouveau fichier source une base « IMarqueeWidget. »</span><span class="sxs-lookup"><span data-stu-id="d96b8-250">Give the new source file a base name of "IMarqueeWidget."</span></span>

2. <span data-ttu-id="d96b8-251">Ouvrez le `IMarqueeWidget` fichier source dans le **éditeur de Code** et modifiez la déclaration de `class` à `interface`:</span><span class="sxs-lookup"><span data-stu-id="d96b8-251">Open the `IMarqueeWidget` source file in the **Code Editor** and change the declaration from `class` to `interface`:</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#2](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/imarqueewidget.cs#2)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#2](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/imarqueewidget.vb#2)]

3. <span data-ttu-id="d96b8-252">Ajoutez le code suivant à la `IMarqueeWidget` interface à exposer deux méthodes et une propriété qui manipulent l’animation de texte défilant :</span><span class="sxs-lookup"><span data-stu-id="d96b8-252">Add the following code to the `IMarqueeWidget` interface to expose two methods and a property that manipulate the marquee animation:</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#3](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/imarqueewidget.cs#3)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#3](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/imarqueewidget.vb#3)]

4. <span data-ttu-id="d96b8-253">Ajouter un nouveau **contrôle personnalisé** d’élément à la `MarqueeControlLibrary` projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-253">Add a new **Custom Control** item to the `MarqueeControlLibrary` project.</span></span> <span data-ttu-id="d96b8-254">Nommez le nouveau fichier source une base de « MarqueeText. »</span><span class="sxs-lookup"><span data-stu-id="d96b8-254">Give the new source file a base name of "MarqueeText."</span></span>

5. <span data-ttu-id="d96b8-255">Faites glisser un <xref:System.ComponentModel.BackgroundWorker> composant à partir de la **boîte à outils** sur votre `MarqueeText` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d96b8-255">Drag a <xref:System.ComponentModel.BackgroundWorker> component from the **Toolbox** onto your `MarqueeText` control.</span></span> <span data-ttu-id="d96b8-256">Ce composant permettra la `MarqueeText` contrôle se mettre à jour en mode asynchrone.</span><span class="sxs-lookup"><span data-stu-id="d96b8-256">This component will allow the `MarqueeText` control to update itself asynchronously.</span></span>

6. <span data-ttu-id="d96b8-257">Dans la fenêtre Propriétés, définissez la <xref:System.ComponentModel.BackgroundWorker> du composant `WorkerReportsProgress` et <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> propriétés à `true`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-257">In the Properties window, set the <xref:System.ComponentModel.BackgroundWorker> component's `WorkerReportsProgress` and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`.</span></span> <span data-ttu-id="d96b8-258">Ces paramètres permettent la <xref:System.ComponentModel.BackgroundWorker> composant déclencher périodiquement la <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> événement et d’annuler les mises à jour asynchrones.</span><span class="sxs-lookup"><span data-stu-id="d96b8-258">These settings allow the <xref:System.ComponentModel.BackgroundWorker> component to periodically raise the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event and to cancel asynchronous updates.</span></span> <span data-ttu-id="d96b8-259">Pour plus d’informations, consultez [composant BackgroundWorker](backgroundworker-component.md).</span><span class="sxs-lookup"><span data-stu-id="d96b8-259">For more information, see [BackgroundWorker Component](backgroundworker-component.md).</span></span>

7. <span data-ttu-id="d96b8-260">Ouvrez le `MarqueeText` fichier source dans le **éditeur de Code**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-260">Open the `MarqueeText` source file in the **Code Editor**.</span></span> <span data-ttu-id="d96b8-261">En haut du fichier, importez les espaces de noms suivants :</span><span class="sxs-lookup"><span data-stu-id="d96b8-261">At the top of the file, import the following namespaces:</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#120](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#120)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#120](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#120)]

8. <span data-ttu-id="d96b8-262">Modifiez la déclaration de `MarqueeText` d’hériter de <xref:System.Windows.Forms.Label> et pour implémenter le `IMarqueeWidget` interface :</span><span class="sxs-lookup"><span data-stu-id="d96b8-262">Change the declaration of `MarqueeText` to inherit from <xref:System.Windows.Forms.Label> and to implement the `IMarqueeWidget` interface:</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#130](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#130)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#130](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#130)]

9. <span data-ttu-id="d96b8-263">Déclarez les variables d’instance qui correspondent aux propriétés exposées et les initialiser dans le constructeur.</span><span class="sxs-lookup"><span data-stu-id="d96b8-263">Declare the instance variables that correspond to the exposed properties, and initialize them in the constructor.</span></span> <span data-ttu-id="d96b8-264">Le `isLit` champ détermine si le texte doit être peint dans la couleur indiquée par le `LightColor` propriété.</span><span class="sxs-lookup"><span data-stu-id="d96b8-264">The `isLit` field determines if the text is to be painted in the color given by the `LightColor` property.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#140](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#140)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#140](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#140)]

10. <span data-ttu-id="d96b8-265">Implémentez l'interface `IMarqueeWidget`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-265">Implement the `IMarqueeWidget` interface.</span></span>

    <span data-ttu-id="d96b8-266">Le `StartMarquee` et `StopMarquee` méthodes appellent le <xref:System.ComponentModel.BackgroundWorker> du composant <xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A> et <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> méthodes pour démarrer et arrêter l’animation.</span><span class="sxs-lookup"><span data-stu-id="d96b8-266">The `StartMarquee` and `StopMarquee` methods invoke the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A> and <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> methods to start and stop the animation.</span></span>

    <span data-ttu-id="d96b8-267">Le <xref:System.ComponentModel.CategoryAttribute.Category%2A> et <xref:System.ComponentModel.BrowsableAttribute.Browsable%2A> attributs sont appliqués à la `UpdatePeriod` propriété afin qu’il apparaisse dans une section personnalisée de la fenêtre Propriétés appelée « Sélection ».</span><span class="sxs-lookup"><span data-stu-id="d96b8-267">The <xref:System.ComponentModel.CategoryAttribute.Category%2A> and <xref:System.ComponentModel.BrowsableAttribute.Browsable%2A> attributes are applied to the `UpdatePeriod` property so it appears in a custom section of the Properties window called "Marquee."</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#150](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#150)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#150](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#150)]

11. <span data-ttu-id="d96b8-268">Implémentez les accesseurs de propriété.</span><span class="sxs-lookup"><span data-stu-id="d96b8-268">Implement the property accessors.</span></span> <span data-ttu-id="d96b8-269">Vous exposerez deux propriétés aux clients : `LightColor` et `DarkColor`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-269">You will expose two properties to clients: `LightColor` and `DarkColor`.</span></span> <span data-ttu-id="d96b8-270">Le <xref:System.ComponentModel.CategoryAttribute.Category%2A> et <xref:System.ComponentModel.BrowsableAttribute.Browsable%2A> attributs sont appliqués à ces propriétés, par conséquent, les propriétés apparaissent dans une section personnalisée de la fenêtre Propriétés appelée « Sélection ».</span><span class="sxs-lookup"><span data-stu-id="d96b8-270">The <xref:System.ComponentModel.CategoryAttribute.Category%2A> and <xref:System.ComponentModel.BrowsableAttribute.Browsable%2A> attributes are applied to these properties, so the properties appear in a custom section of the Properties window called "Marquee."</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#160](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#160)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#160](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#160)]

12. <span data-ttu-id="d96b8-271">Implémentez les gestionnaires pour le <xref:System.ComponentModel.BackgroundWorker> du composant <xref:System.ComponentModel.BackgroundWorker.DoWork> et <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> événements.</span><span class="sxs-lookup"><span data-stu-id="d96b8-271">Implement the handlers for the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> events.</span></span>

    <span data-ttu-id="d96b8-272">Le <xref:System.ComponentModel.BackgroundWorker.DoWork> se met en veille du Gestionnaire d’événements pour le nombre de millisecondes spécifié par `UpdatePeriod` puis déclenche le <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> événement, jusqu'à ce que votre code s’arrête l’animation en appelant <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A>.</span><span class="sxs-lookup"><span data-stu-id="d96b8-272">The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler sleeps for the number of milliseconds specified by `UpdatePeriod` then raises the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event, until your code stops the animation by calling <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A>.</span></span>

    <span data-ttu-id="d96b8-273">Le <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> Gestionnaire d’événements Active ou désactive le texte entre son état clair et sombre pour donner l’apparence d’un clignotement.</span><span class="sxs-lookup"><span data-stu-id="d96b8-273">The <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler toggles the text between its light and dark state to give the appearance of flashing.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#180](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#180)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#180](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#180)]

13. <span data-ttu-id="d96b8-274">Remplacer le <xref:System.Windows.Forms.Control.OnPaint%2A> méthode pour activer l’animation.</span><span class="sxs-lookup"><span data-stu-id="d96b8-274">Override the <xref:System.Windows.Forms.Control.OnPaint%2A> method to enable the animation.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#170](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueetext.cs#170)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#170](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueetext.vb#170)]

14. <span data-ttu-id="d96b8-275">Appuyez sur F6 pour générer la solution.</span><span class="sxs-lookup"><span data-stu-id="d96b8-275">Press F6 to build the solution.</span></span>

## <a name="create-the-marqueeborder-child-control"></a><span data-ttu-id="d96b8-276">Créer le contrôle enfant MarqueeBorder</span><span class="sxs-lookup"><span data-stu-id="d96b8-276">Create the MarqueeBorder Child Control</span></span>

<span data-ttu-id="d96b8-277">Le `MarqueeBorder` contrôle est légèrement plus sophistiqué que le `MarqueeText` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d96b8-277">The `MarqueeBorder` control is slightly more sophisticated than the `MarqueeText` control.</span></span> <span data-ttu-id="d96b8-278">Il a plus de propriétés et l’animation dans le <xref:System.Windows.Forms.Control.OnPaint%2A> méthode est plus complexe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-278">It has more properties and the animation in the <xref:System.Windows.Forms.Control.OnPaint%2A> method is more involved.</span></span> <span data-ttu-id="d96b8-279">En principe, il est assez semblable à la `MarqueeText` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d96b8-279">In principle, it is quite similar to the `MarqueeText` control.</span></span>

<span data-ttu-id="d96b8-280">Étant donné que le `MarqueeBorder` contrôle peut avoir des contrôles enfants, il doit être conscient de <xref:System.Windows.Forms.Control.Layout> événements.</span><span class="sxs-lookup"><span data-stu-id="d96b8-280">Because the `MarqueeBorder` control can have child controls, it needs to be aware of <xref:System.Windows.Forms.Control.Layout> events.</span></span>

### <a name="to-create-the-marqueeborder-control"></a><span data-ttu-id="d96b8-281">Pour créer le contrôle MarqueeBorder</span><span class="sxs-lookup"><span data-stu-id="d96b8-281">To create the MarqueeBorder control</span></span>

1. <span data-ttu-id="d96b8-282">Ajouter un nouveau **contrôle personnalisé** d’élément à la `MarqueeControlLibrary` projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-282">Add a new **Custom Control** item to the `MarqueeControlLibrary` project.</span></span> <span data-ttu-id="d96b8-283">Nommez le nouveau fichier source une base de « MarqueeBorder. »</span><span class="sxs-lookup"><span data-stu-id="d96b8-283">Give the new source file a base name of "MarqueeBorder."</span></span>

2. <span data-ttu-id="d96b8-284">Faites glisser un <xref:System.ComponentModel.BackgroundWorker> composant à partir de la **boîte à outils** sur votre `MarqueeBorder` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d96b8-284">Drag a <xref:System.ComponentModel.BackgroundWorker> component from the **Toolbox** onto your `MarqueeBorder` control.</span></span> <span data-ttu-id="d96b8-285">Ce composant permettra la `MarqueeBorder` contrôle se mettre à jour en mode asynchrone.</span><span class="sxs-lookup"><span data-stu-id="d96b8-285">This component will allow the `MarqueeBorder` control to update itself asynchronously.</span></span>

3. <span data-ttu-id="d96b8-286">Dans la fenêtre Propriétés, définissez la <xref:System.ComponentModel.BackgroundWorker> du composant `WorkerReportsProgress` et <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> propriétés à `true`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-286">In the Properties window, set the <xref:System.ComponentModel.BackgroundWorker> component's `WorkerReportsProgress` and <xref:System.ComponentModel.BackgroundWorker.WorkerSupportsCancellation%2A> properties to `true`.</span></span> <span data-ttu-id="d96b8-287">Ces paramètres permettent la <xref:System.ComponentModel.BackgroundWorker> composant déclencher périodiquement la <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> événement et d’annuler les mises à jour asynchrones.</span><span class="sxs-lookup"><span data-stu-id="d96b8-287">These settings allow the <xref:System.ComponentModel.BackgroundWorker> component to periodically raise the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event and to cancel asynchronous updates.</span></span> <span data-ttu-id="d96b8-288">Pour plus d’informations, consultez [composant BackgroundWorker](backgroundworker-component.md).</span><span class="sxs-lookup"><span data-stu-id="d96b8-288">For more information, see [BackgroundWorker Component](backgroundworker-component.md).</span></span>

4. <span data-ttu-id="d96b8-289">Dans la fenêtre Propriétés, cliquez sur le bouton événements.</span><span class="sxs-lookup"><span data-stu-id="d96b8-289">In the Properties window, click the Events button.</span></span> <span data-ttu-id="d96b8-290">Joindre des gestionnaires pour les <xref:System.ComponentModel.BackgroundWorker.DoWork> et <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> événements.</span><span class="sxs-lookup"><span data-stu-id="d96b8-290">Attach handlers for the <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> events.</span></span>

5. <span data-ttu-id="d96b8-291">Ouvrez le `MarqueeBorder` fichier source dans le **éditeur de Code**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-291">Open the `MarqueeBorder` source file in the **Code Editor**.</span></span> <span data-ttu-id="d96b8-292">En haut du fichier, importez les espaces de noms suivants :</span><span class="sxs-lookup"><span data-stu-id="d96b8-292">At the top of the file, import the following namespaces:</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#20](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#20)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#20](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#20)]

6. <span data-ttu-id="d96b8-293">Modifiez la déclaration de `MarqueeBorder` d’hériter de <xref:System.Windows.Forms.Panel> et pour implémenter le `IMarqueeWidget` interface.</span><span class="sxs-lookup"><span data-stu-id="d96b8-293">Change the declaration of `MarqueeBorder` to inherit from <xref:System.Windows.Forms.Panel> and to implement the `IMarqueeWidget` interface.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#30](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#30)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#30](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#30)]

7. <span data-ttu-id="d96b8-294">Déclarez deux énumérations pour gérer le `MarqueeBorder` état du contrôle : `MarqueeSpinDirection`, qui détermine la direction dans laquelle les lumières « tournent » autour de la bordure et `MarqueeLightShape`, qui détermine la forme des lumières (carrées ou circulaires).</span><span class="sxs-lookup"><span data-stu-id="d96b8-294">Declare two enumerations for managing the `MarqueeBorder` control's state: `MarqueeSpinDirection`, which determines the direction in which the lights "spin" around the border, and `MarqueeLightShape`, which determines the shape of the lights (square or circular).</span></span> <span data-ttu-id="d96b8-295">Placez ces déclarations avant la `MarqueeBorder` déclaration de classe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-295">Place these declarations before the `MarqueeBorder` class declaration.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#97](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#97)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#97](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#97)]

8. <span data-ttu-id="d96b8-296">Déclarez les variables d’instance qui correspondent aux propriétés exposées et les initialiser dans le constructeur.</span><span class="sxs-lookup"><span data-stu-id="d96b8-296">Declare the instance variables that correspond to the exposed properties, and initialize them in the constructor.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#40](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#40)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#40](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#40)]

9. <span data-ttu-id="d96b8-297">Implémentez l'interface `IMarqueeWidget`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-297">Implement the `IMarqueeWidget` interface.</span></span>

    <span data-ttu-id="d96b8-298">Le `StartMarquee` et `StopMarquee` méthodes appellent le <xref:System.ComponentModel.BackgroundWorker> du composant <xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A> et <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> méthodes pour démarrer et arrêter l’animation.</span><span class="sxs-lookup"><span data-stu-id="d96b8-298">The `StartMarquee` and `StopMarquee` methods invoke the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.RunWorkerAsync%2A> and <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A> methods to start and stop the animation.</span></span>

    <span data-ttu-id="d96b8-299">Étant donné que le `MarqueeBorder` contrôle peut contenir des contrôles enfants, le `StartMarquee` méthode énumère tous les contrôles enfants et les appels `StartMarquee` sur ceux qui implémentent `IMarqueeWidget`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-299">Because the `MarqueeBorder` control can contain child controls, the `StartMarquee` method enumerates all child controls and calls `StartMarquee` on those that implement `IMarqueeWidget`.</span></span> <span data-ttu-id="d96b8-300">Le `StopMarquee` méthode a une implémentation semblable.</span><span class="sxs-lookup"><span data-stu-id="d96b8-300">The `StopMarquee` method has a similar implementation.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#50](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#50)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#50](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#50)]

10. <span data-ttu-id="d96b8-301">Implémentez les accesseurs de propriété.</span><span class="sxs-lookup"><span data-stu-id="d96b8-301">Implement the property accessors.</span></span> <span data-ttu-id="d96b8-302">Le `MarqueeBorder` contrôle a plusieurs propriétés pour contrôler son apparence.</span><span class="sxs-lookup"><span data-stu-id="d96b8-302">The `MarqueeBorder` control has several properties for controlling its appearance.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#60](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#60)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#60](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#60)]

11. <span data-ttu-id="d96b8-303">Implémentez les gestionnaires pour le <xref:System.ComponentModel.BackgroundWorker> du composant <xref:System.ComponentModel.BackgroundWorker.DoWork> et <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> événements.</span><span class="sxs-lookup"><span data-stu-id="d96b8-303">Implement the handlers for the <xref:System.ComponentModel.BackgroundWorker> component's <xref:System.ComponentModel.BackgroundWorker.DoWork> and <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> events.</span></span>

    <span data-ttu-id="d96b8-304">Le <xref:System.ComponentModel.BackgroundWorker.DoWork> se met en veille du Gestionnaire d’événements pour le nombre de millisecondes spécifié par `UpdatePeriod` puis déclenche le <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> événement, jusqu'à ce que votre code s’arrête l’animation en appelant <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A>.</span><span class="sxs-lookup"><span data-stu-id="d96b8-304">The <xref:System.ComponentModel.BackgroundWorker.DoWork> event handler sleeps for the number of milliseconds specified by `UpdatePeriod` then raises the <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event, until your code stops the animation by calling <xref:System.ComponentModel.BackgroundWorker.CancelAsync%2A>.</span></span>

    <span data-ttu-id="d96b8-305">Le <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> Gestionnaire d’événements incrémente la position de la lumière « base », à partir de laquelle l’état clair/sombre des autres lumières est déterminé, et appelle le <xref:System.Windows.Forms.Control.Refresh%2A> méthode pour que le contrôle à se redessiner.</span><span class="sxs-lookup"><span data-stu-id="d96b8-305">The <xref:System.ComponentModel.BackgroundWorker.ProgressChanged> event handler increments the position of the "base" light, from which the light/dark state of the other lights is determined, and calls the <xref:System.Windows.Forms.Control.Refresh%2A> method to cause the control to repaint itself.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#90](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#90)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#90](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#90)]

12. <span data-ttu-id="d96b8-306">Implémenter les méthodes d’assistance, `IsLit` et `DrawLight`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-306">Implement the helper methods, `IsLit` and `DrawLight`.</span></span>

    <span data-ttu-id="d96b8-307">Le `IsLit` méthode détermine la couleur d’une lumière à une position donnée.</span><span class="sxs-lookup"><span data-stu-id="d96b8-307">The `IsLit` method determines the color of a light at a given position.</span></span> <span data-ttu-id="d96b8-308">Les lumières sont « allumés » sont dessinées dans la couleur indiquée par le `LightColor` propriété et celles qui sont « foncé » sont dessinées dans la couleur indiquée par le `DarkColor` propriété.</span><span class="sxs-lookup"><span data-stu-id="d96b8-308">Lights that are "lit" are drawn in the color given by the `LightColor` property, and those that are "dark" are drawn in the color given by the `DarkColor` property.</span></span>

    <span data-ttu-id="d96b8-309">Le `DrawLight` méthode dessine une lumière à l’aide de la couleur appropriée, la forme et la position.</span><span class="sxs-lookup"><span data-stu-id="d96b8-309">The `DrawLight` method draws a light using the appropriate color, shape, and position.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#80](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#80)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#80](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#80)]

13. <span data-ttu-id="d96b8-310">Remplacer le <xref:System.Windows.Forms.Control.OnLayout%2A> et <xref:System.Windows.Forms.Control.OnPaint%2A> méthodes.</span><span class="sxs-lookup"><span data-stu-id="d96b8-310">Override the <xref:System.Windows.Forms.Control.OnLayout%2A> and <xref:System.Windows.Forms.Control.OnPaint%2A> methods.</span></span>

    <span data-ttu-id="d96b8-311">Le <xref:System.Windows.Forms.Control.OnPaint%2A> méthode dessine les lumières le long des bords de la `MarqueeBorder` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d96b8-311">The <xref:System.Windows.Forms.Control.OnPaint%2A> method draws the lights along the edges of the `MarqueeBorder` control.</span></span>

    <span data-ttu-id="d96b8-312">Étant donné que le <xref:System.Windows.Forms.Control.OnPaint%2A> méthode varie selon les dimensions de la `MarqueeBorder` contrôle, vous devez l’appeler chaque fois que la disposition change.</span><span class="sxs-lookup"><span data-stu-id="d96b8-312">Because the <xref:System.Windows.Forms.Control.OnPaint%2A> method depends on the dimensions of the `MarqueeBorder` control, you need to call it whenever the layout changes.</span></span> <span data-ttu-id="d96b8-313">Pour ce faire, substituez <xref:System.Windows.Forms.Control.OnLayout%2A> et appelez <xref:System.Windows.Forms.Control.Refresh%2A>.</span><span class="sxs-lookup"><span data-stu-id="d96b8-313">To achieve this, override <xref:System.Windows.Forms.Control.OnLayout%2A> and call <xref:System.Windows.Forms.Control.Refresh%2A>.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#70](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#70)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#70](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#70)]

## <a name="creating-a-custom-designer-to-shadow-and-filter-properties"></a><span data-ttu-id="d96b8-314">Création d’un concepteur personnalisé pour les clichés instantanés et les propriétés de filtre</span><span class="sxs-lookup"><span data-stu-id="d96b8-314">Creating a Custom Designer to Shadow and Filter Properties</span></span>

<span data-ttu-id="d96b8-315">Le `MarqueeControlRootDesigner` classe fournit l’implémentation pour le concepteur racine.</span><span class="sxs-lookup"><span data-stu-id="d96b8-315">The `MarqueeControlRootDesigner` class provides the implementation for the root designer.</span></span> <span data-ttu-id="d96b8-316">En plus de ce concepteur, qui fonctionne sur le `MarqueeControl`, vous devez un concepteur personnalisé qui est associé spécifiquement le `MarqueeBorder` contrôle.</span><span class="sxs-lookup"><span data-stu-id="d96b8-316">In addition to this designer, which operates on the `MarqueeControl`, you will need a custom designer that is specifically associated with the `MarqueeBorder` control.</span></span> <span data-ttu-id="d96b8-317">Ce concepteur fournit un comportement personnalisé qui est approprié dans le contexte du concepteur racine personnalisé.</span><span class="sxs-lookup"><span data-stu-id="d96b8-317">This designer provides custom behavior that is appropriate in the context of the custom root designer.</span></span>

<span data-ttu-id="d96b8-318">Plus précisément, le `MarqueeBorderDesigner` sera « masquer » et filtrer certaines propriétés sur le `MarqueeBorder` contrôle, en modifiant leur interaction avec l’environnement de conception.</span><span class="sxs-lookup"><span data-stu-id="d96b8-318">Specifically, the `MarqueeBorderDesigner` will "shadow" and filter certain properties on the `MarqueeBorder` control, changing their interaction with the design environment.</span></span>

<span data-ttu-id="d96b8-319">L’interception d’appels à l’accesseur de propriété d’un composant est appelé « occultation ».</span><span class="sxs-lookup"><span data-stu-id="d96b8-319">Intercepting calls to a component's property accessor is known as "shadowing."</span></span> <span data-ttu-id="d96b8-320">Il permet à un concepteur effectuer le suivi de la valeur définie par l’utilisateur et éventuellement passer cette valeur au composant en cours de conception.</span><span class="sxs-lookup"><span data-stu-id="d96b8-320">It allows a designer to track the value set by the user and optionally pass that value to the component being designed.</span></span>

<span data-ttu-id="d96b8-321">Pour cet exemple, le <xref:System.Windows.Forms.Control.Visible%2A> et <xref:System.Windows.Forms.Control.Enabled%2A> propriétés seront occultées par le `MarqueeBorderDesigner`, ce qui empêche l’utilisateur d’apporter la `MarqueeBorder` contrôle invisible ou désactivée au moment du design.</span><span class="sxs-lookup"><span data-stu-id="d96b8-321">For this example, the <xref:System.Windows.Forms.Control.Visible%2A> and <xref:System.Windows.Forms.Control.Enabled%2A> properties will be shadowed by the `MarqueeBorderDesigner`, which prevents the user from making the `MarqueeBorder` control invisible or disabled during design time.</span></span>

<span data-ttu-id="d96b8-322">Les concepteurs peuvent également ajouter ou supprimer des propriétés.</span><span class="sxs-lookup"><span data-stu-id="d96b8-322">Designers can also add and remove properties.</span></span> <span data-ttu-id="d96b8-323">Pour cet exemple, le <xref:System.Windows.Forms.Control.Padding%2A> propriété sera supprimée au moment du design, car le `MarqueeBorder` contrôle définit par programme le remplissage selon la taille des lumières spécifiées par la `LightSize` propriété.</span><span class="sxs-lookup"><span data-stu-id="d96b8-323">For this example, the <xref:System.Windows.Forms.Control.Padding%2A> property will be removed at design time, because the `MarqueeBorder` control programmatically sets the padding based on the size of the lights specified by the `LightSize` property.</span></span>

<span data-ttu-id="d96b8-324">La classe de base pour `MarqueeBorderDesigner` est <xref:System.ComponentModel.Design.ComponentDesigner>, qui a des méthodes qui peuvent modifier les attributs, les propriétés et les événements exposés par un contrôle au moment du design :</span><span class="sxs-lookup"><span data-stu-id="d96b8-324">The base class for `MarqueeBorderDesigner` is <xref:System.ComponentModel.Design.ComponentDesigner>, which has methods that can change the attributes, properties, and events exposed by a control at design time:</span></span>

- <xref:System.ComponentModel.Design.ComponentDesigner.PreFilterProperties%2A>

- <xref:System.ComponentModel.Design.ComponentDesigner.PostFilterProperties%2A>

- <xref:System.ComponentModel.Design.ComponentDesigner.PreFilterAttributes%2A>

- <xref:System.ComponentModel.Design.ComponentDesigner.PostFilterAttributes%2A>

- <xref:System.ComponentModel.Design.ComponentDesigner.PreFilterEvents%2A>

- <xref:System.ComponentModel.Design.ComponentDesigner.PostFilterEvents%2A>

<span data-ttu-id="d96b8-325">Lorsque vous modifiez l’interface publique d’un composant à l’aide de ces méthodes, vous devez suivre ces règles :</span><span class="sxs-lookup"><span data-stu-id="d96b8-325">When changing the public interface of a component using these methods, you must follow these rules:</span></span>

- <span data-ttu-id="d96b8-326">Ajouter ou supprimer des éléments dans le `PreFilter` méthodes uniquement</span><span class="sxs-lookup"><span data-stu-id="d96b8-326">Add or remove items in the `PreFilter` methods only</span></span>

- <span data-ttu-id="d96b8-327">Modifier des éléments existants dans le `PostFilter` méthodes uniquement</span><span class="sxs-lookup"><span data-stu-id="d96b8-327">Modify existing items in the `PostFilter` methods only</span></span>

- <span data-ttu-id="d96b8-328">Appeler l’implémentation de base tout d’abord dans le `PreFilter` méthodes</span><span class="sxs-lookup"><span data-stu-id="d96b8-328">Always call the base implementation first in the `PreFilter` methods</span></span>

- <span data-ttu-id="d96b8-329">Appeler l’implémentation de base dernière dans le `PostFilter` méthodes</span><span class="sxs-lookup"><span data-stu-id="d96b8-329">Always call the base implementation last in the `PostFilter` methods</span></span>

<span data-ttu-id="d96b8-330">Adhérant à ces règles permet de s’assurer que tous les concepteurs dans l’environnement au moment du design ont une vue cohérente de tous les composants en cours de conception.</span><span class="sxs-lookup"><span data-stu-id="d96b8-330">Adhering to these rules ensures that all designers in the design-time environment have a consistent view of all components being designed.</span></span>

<span data-ttu-id="d96b8-331">Le <xref:System.ComponentModel.Design.ComponentDesigner> classe fournit un dictionnaire pour gérer les valeurs des propriétés occultées, ce qui vous évite d’avoir à créer des variables d’instance spécifique.</span><span class="sxs-lookup"><span data-stu-id="d96b8-331">The <xref:System.ComponentModel.Design.ComponentDesigner> class provides a dictionary for managing the values of shadowed properties, which relieves you of the need to create specific instance variables.</span></span>

### <a name="to-create-a-custom-designer-to-shadow-and-filter-properties"></a><span data-ttu-id="d96b8-332">Pour créer un concepteur personnalisé pour les propriétés de filtre et les clichés instantanés</span><span class="sxs-lookup"><span data-stu-id="d96b8-332">To create a custom designer to shadow and filter properties</span></span>

1. <span data-ttu-id="d96b8-333">Cliquez sur le **conception** dossier et ajoutez une nouvelle classe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-333">Right-click the **Design** folder and add a new class.</span></span> <span data-ttu-id="d96b8-334">Nommez le fichier source une base de « MarqueeBorderDesigner. »</span><span class="sxs-lookup"><span data-stu-id="d96b8-334">Give the source file a base name of "MarqueeBorderDesigner."</span></span>

2. <span data-ttu-id="d96b8-335">Ouvrez le `MarqueeBorderDesigner` fichier source dans le **éditeur de Code**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-335">Open the `MarqueeBorderDesigner` source file in the **Code Editor**.</span></span> <span data-ttu-id="d96b8-336">En haut du fichier, importez les espaces de noms suivants :</span><span class="sxs-lookup"><span data-stu-id="d96b8-336">At the top of the file, import the following namespaces:</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#420](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#420)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#420](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#420)]

3. <span data-ttu-id="d96b8-337">Modifiez la déclaration de `MarqueeBorderDesigner` d’hériter de <xref:System.Windows.Forms.Design.ParentControlDesigner>.</span><span class="sxs-lookup"><span data-stu-id="d96b8-337">Change the declaration of `MarqueeBorderDesigner` to inherit from <xref:System.Windows.Forms.Design.ParentControlDesigner>.</span></span>

    <span data-ttu-id="d96b8-338">Étant donné que le `MarqueeBorder` contrôle peut contenir des contrôles enfants, `MarqueeBorderDesigner` hérite <xref:System.Windows.Forms.Design.ParentControlDesigner>, qui gère l’interaction parent-enfant.</span><span class="sxs-lookup"><span data-stu-id="d96b8-338">Because the `MarqueeBorder` control can contain child controls, `MarqueeBorderDesigner` inherits from <xref:System.Windows.Forms.Design.ParentControlDesigner>, which handles the parent-child interaction.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#430](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#430)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#430](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#430)]

4. <span data-ttu-id="d96b8-339">Substituer l’implémentation de base de <xref:System.ComponentModel.Design.ComponentDesigner.PreFilterProperties%2A>.</span><span class="sxs-lookup"><span data-stu-id="d96b8-339">Override the base implementation of <xref:System.ComponentModel.Design.ComponentDesigner.PreFilterProperties%2A>.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#450](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#450)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#450](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#450)]

5. <span data-ttu-id="d96b8-340">Implémentez les propriétés <xref:System.Windows.Forms.Control.Enabled%2A> et <xref:System.Windows.Forms.Control.Visible%2A>.</span><span class="sxs-lookup"><span data-stu-id="d96b8-340">Implement the <xref:System.Windows.Forms.Control.Enabled%2A> and <xref:System.Windows.Forms.Control.Visible%2A> properties.</span></span> <span data-ttu-id="d96b8-341">Ces implémentations occultent les propriétés du contrôle.</span><span class="sxs-lookup"><span data-stu-id="d96b8-341">These implementations shadow the control's properties.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#440](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborderdesigner.cs#440)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#440](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborderdesigner.vb#440)]

## <a name="handling-component-changes"></a><span data-ttu-id="d96b8-342">Gestion des modifications de composant</span><span class="sxs-lookup"><span data-stu-id="d96b8-342">Handling Component Changes</span></span>
 <span data-ttu-id="d96b8-343">Le `MarqueeControlRootDesigner` classe fournit l’expérience au moment du design personnalisé pour votre `MarqueeControl` instances.</span><span class="sxs-lookup"><span data-stu-id="d96b8-343">The `MarqueeControlRootDesigner` class provides the custom design-time experience for your `MarqueeControl` instances.</span></span> <span data-ttu-id="d96b8-344">La plupart des fonctionnalités au moment du design est héritée de la <xref:System.Windows.Forms.Design.DocumentDesigner> classe ; votre code est implémenter deux personnalisations spécifiques : gestion des modifications de composant et l’ajout de verbes de concepteur.</span><span class="sxs-lookup"><span data-stu-id="d96b8-344">Most of the design-time functionality is inherited from the <xref:System.Windows.Forms.Design.DocumentDesigner> class; your code will implement two specific customizations: handling component changes, and adding designer verbs.</span></span>

 <span data-ttu-id="d96b8-345">En tant que les utilisateurs à concevoir leurs `MarqueeControl` instances, votre concepteur racine suit les modifications apportées à la `MarqueeControl` et ses contrôles enfants.</span><span class="sxs-lookup"><span data-stu-id="d96b8-345">As users design their `MarqueeControl` instances, your root designer will track changes to the `MarqueeControl` and its child controls.</span></span> <span data-ttu-id="d96b8-346">L’environnement au moment du design offre un service commode, <xref:System.ComponentModel.Design.IComponentChangeService>, pour le suivi des modifications à l’état du composant.</span><span class="sxs-lookup"><span data-stu-id="d96b8-346">The design-time environment offers a convenient service, <xref:System.ComponentModel.Design.IComponentChangeService>, for tracking changes to component state.</span></span>

 <span data-ttu-id="d96b8-347">Vous acquérez une référence à ce service en interrogeant l’environnement avec la <xref:System.ComponentModel.Design.ComponentDesigner.GetService%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="d96b8-347">You acquire a reference to this service by querying the environment with the <xref:System.ComponentModel.Design.ComponentDesigner.GetService%2A> method.</span></span> <span data-ttu-id="d96b8-348">Si la requête est réussie, votre concepteur peut joindre un gestionnaire pour le <xref:System.ComponentModel.Design.IComponentChangeService.ComponentChanged> événements et effectuer toutes les tâches qui sont nécessaires pour maintenir un état cohérent au moment du design.</span><span class="sxs-lookup"><span data-stu-id="d96b8-348">If the query is successful, your designer can attach a handler for the <xref:System.ComponentModel.Design.IComponentChangeService.ComponentChanged> event and perform whatever tasks are required to maintain a consistent state at design time.</span></span>

 <span data-ttu-id="d96b8-349">Dans le cas de la `MarqueeControlRootDesigner` (classe), vous appellerez la <xref:System.Windows.Forms.Control.Refresh%2A> méthode sur chaque `IMarqueeWidget` objet contenu dans le `MarqueeControl`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-349">In the case of the `MarqueeControlRootDesigner` class, you will call the <xref:System.Windows.Forms.Control.Refresh%2A> method on each `IMarqueeWidget` object contained by the `MarqueeControl`.</span></span> <span data-ttu-id="d96b8-350">Cela entraîne le `IMarqueeWidget` objet à se redessiner correctement lorsque les propriétés telles que son parent <xref:System.Windows.Forms.Control.Size%2A> sont modifiés.</span><span class="sxs-lookup"><span data-stu-id="d96b8-350">This will cause the `IMarqueeWidget` object to repaint itself appropriately when properties like its parent's <xref:System.Windows.Forms.Control.Size%2A> are changed.</span></span>

### <a name="to-handle-component-changes"></a><span data-ttu-id="d96b8-351">Pour gérer les changements de composant</span><span class="sxs-lookup"><span data-stu-id="d96b8-351">To handle component changes</span></span>

1. <span data-ttu-id="d96b8-352">Ouvrez le `MarqueeControlRootDesigner` fichier source dans le **éditeur de Code** et remplacer le <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="d96b8-352">Open the `MarqueeControlRootDesigner` source file in the **Code Editor** and override the <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> method.</span></span> <span data-ttu-id="d96b8-353">Appeler l’implémentation de base de <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> et de requête pour le <xref:System.ComponentModel.Design.IComponentChangeService>.</span><span class="sxs-lookup"><span data-stu-id="d96b8-353">Call the base implementation of <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> and query for the <xref:System.ComponentModel.Design.IComponentChangeService>.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#580](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#580)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#580](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#580)]

2. <span data-ttu-id="d96b8-354">Implémentez le <xref:System.ComponentModel.Design.IComponentChangeService.OnComponentChanged%2A> Gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="d96b8-354">Implement the <xref:System.ComponentModel.Design.IComponentChangeService.OnComponentChanged%2A> event handler.</span></span> <span data-ttu-id="d96b8-355">Type du composant d’émission, de test et s’il s’agit une `IMarqueeWidget`, appeler ses <xref:System.Windows.Forms.Control.Refresh%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="d96b8-355">Test the sending component's type, and if it is an `IMarqueeWidget`, call its <xref:System.Windows.Forms.Control.Refresh%2A> method.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#560](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#560)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#560](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#560)]

## <a name="adding-designer-verbs-to-your-custom-designer"></a><span data-ttu-id="d96b8-356">Ajout de verbes de concepteur à votre concepteur personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-356">Adding Designer Verbs to your Custom Designer</span></span>

<span data-ttu-id="d96b8-357">Un verbe de concepteur est une commande de menu liée à un gestionnaire d’événements.</span><span class="sxs-lookup"><span data-stu-id="d96b8-357">A designer verb is a menu command linked to an event handler.</span></span> <span data-ttu-id="d96b8-358">Verbes de concepteur sont ajoutés au menu contextuel d’un composant au moment du design.</span><span class="sxs-lookup"><span data-stu-id="d96b8-358">Designer verbs are added to a component's shortcut menu at design time.</span></span> <span data-ttu-id="d96b8-359">Pour plus d'informations, consultez <xref:System.ComponentModel.Design.DesignerVerb>.</span><span class="sxs-lookup"><span data-stu-id="d96b8-359">For more information, see <xref:System.ComponentModel.Design.DesignerVerb>.</span></span>

<span data-ttu-id="d96b8-360">Vous allez ajouter deux verbes de concepteur à vos concepteurs : **Exécuter Test** et **arrêter le Test**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-360">You will add two designer verbs to your designers: **Run Test** and **Stop Test**.</span></span> <span data-ttu-id="d96b8-361">Ces verbes vous permettra d’afficher le comportement au moment de l’exécution de la `MarqueeControl` au moment du design.</span><span class="sxs-lookup"><span data-stu-id="d96b8-361">These verbs will allow you to view the run-time behavior of the `MarqueeControl` at design time.</span></span> <span data-ttu-id="d96b8-362">Ces verbes seront ajoutés à la `MarqueeControlRootDesigner`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-362">These verbs will be added to the `MarqueeControlRootDesigner`.</span></span>

<span data-ttu-id="d96b8-363">Lorsque **exécuter le Test** est appelé, le Gestionnaire d’événements de verbe appellera le `StartMarquee` méthode sur le `MarqueeControl`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-363">When **Run Test** is invoked, the verb event handler will call the `StartMarquee` method on the `MarqueeControl`.</span></span> <span data-ttu-id="d96b8-364">Lorsque **arrêter le Test** est appelé, le Gestionnaire d’événements de verbe appellera le `StopMarquee` méthode sur le `MarqueeControl`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-364">When **Stop Test** is invoked, the verb event handler will call the `StopMarquee` method on the `MarqueeControl`.</span></span> <span data-ttu-id="d96b8-365">L’implémentation de la `StartMarquee` et `StopMarquee` méthodes appellent ces méthodes sur les contrôles contenus qui implémentent `IMarqueeWidget`les `IMarqueeWidget` contrôles participeront également dans le test.</span><span class="sxs-lookup"><span data-stu-id="d96b8-365">The implementation of the `StartMarquee` and `StopMarquee` methods call these methods on contained controls that implement `IMarqueeWidget`, so any contained `IMarqueeWidget` controls will also participate in the test.</span></span>

### <a name="to-add-designer-verbs-to-your-custom-designers"></a><span data-ttu-id="d96b8-366">Pour ajouter des verbes de concepteur à vos concepteurs personnalisés</span><span class="sxs-lookup"><span data-stu-id="d96b8-366">To add designer verbs to your custom designers</span></span>

1. <span data-ttu-id="d96b8-367">Dans le `MarqueeControlRootDesigner` de classe, l’ajout de gestionnaires d’événements nommé `OnVerbRunTest` et `OnVerbStopTest`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-367">In the `MarqueeControlRootDesigner` class, add event handlers named `OnVerbRunTest` and `OnVerbStopTest`.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#570](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#570)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#570](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#570)]

2. <span data-ttu-id="d96b8-368">Se connecter à ces gestionnaires d’événements à leurs verbes de concepteur correspondantes.</span><span class="sxs-lookup"><span data-stu-id="d96b8-368">Connect these event handlers to their corresponding designer verbs.</span></span> <span data-ttu-id="d96b8-369">`MarqueeControlRootDesigner` hérite une <xref:System.ComponentModel.Design.DesignerVerbCollection> à partir de sa classe de base.</span><span class="sxs-lookup"><span data-stu-id="d96b8-369">`MarqueeControlRootDesigner` inherits a <xref:System.ComponentModel.Design.DesignerVerbCollection> from its base class.</span></span> <span data-ttu-id="d96b8-370">Vous allez créer deux nouveaux <xref:System.ComponentModel.Design.DesignerVerb> objets et les ajouter à cette collection dans le <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="d96b8-370">You will create two new <xref:System.ComponentModel.Design.DesignerVerb> objects and add them to this collection in the <xref:System.Windows.Forms.Design.DocumentDesigner.Initialize%2A> method.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#590](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueecontrolrootdesigner.cs#590)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#590](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueecontrolrootdesigner.vb#590)]

## <a name="creating-a-custom-uitypeeditor"></a><span data-ttu-id="d96b8-371">Création d’un UITypeEditor personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-371">Creating a Custom UITypeEditor</span></span>

<span data-ttu-id="d96b8-372">Lorsque vous créez une expérience au moment du design personnalisée pour les utilisateurs, il est souvent préférable de créer une interaction personnalisée avec la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="d96b8-372">When you create a custom design-time experience for users, it is often desirable to create a custom interaction with the Properties window.</span></span> <span data-ttu-id="d96b8-373">Vous pouvez y parvenir en créant un <xref:System.Drawing.Design.UITypeEditor>.</span><span class="sxs-lookup"><span data-stu-id="d96b8-373">You can accomplish this by creating a <xref:System.Drawing.Design.UITypeEditor>.</span></span> <span data-ttu-id="d96b8-374">Pour plus d'informations, voir [Procédure : Créer un éditeur de Type d’interface utilisateur](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/fd3kt7d5(v=vs.120)).</span><span class="sxs-lookup"><span data-stu-id="d96b8-374">For more information, see [How to: Create a UI Type Editor](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/fd3kt7d5(v=vs.120)).</span></span>

<span data-ttu-id="d96b8-375">Le `MarqueeBorder` contrôle expose plusieurs propriétés dans la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="d96b8-375">The `MarqueeBorder` control exposes several properties in the Properties window.</span></span> <span data-ttu-id="d96b8-376">Deux de ces propriétés, `MarqueeSpinDirection` et `MarqueeLightShape` sont représentés par des énumérations.</span><span class="sxs-lookup"><span data-stu-id="d96b8-376">Two of these properties, `MarqueeSpinDirection` and `MarqueeLightShape` are represented by enumerations.</span></span> <span data-ttu-id="d96b8-377">Pour illustrer l’utilisation d’un éditeur de type d’interface utilisateur, le `MarqueeLightShape` propriété aura associé à un <xref:System.Drawing.Design.UITypeEditor> classe.</span><span class="sxs-lookup"><span data-stu-id="d96b8-377">To illustrate the use of a UI type editor, the `MarqueeLightShape` property will have an associated <xref:System.Drawing.Design.UITypeEditor> class.</span></span>

### <a name="to-create-a-custom-ui-type-editor"></a><span data-ttu-id="d96b8-378">Pour créer un type d’interface utilisateur personnalisé éditeur</span><span class="sxs-lookup"><span data-stu-id="d96b8-378">To create a custom UI type editor</span></span>

1. <span data-ttu-id="d96b8-379">Ouvrez le `MarqueeBorder` fichier source dans le **éditeur de Code**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-379">Open the `MarqueeBorder` source file in the **Code Editor**.</span></span>

2. <span data-ttu-id="d96b8-380">Dans la définition de la `MarqueeBorder` classe, déclarez une classe appelée `LightShapeEditor` qui dérive de <xref:System.Drawing.Design.UITypeEditor>.</span><span class="sxs-lookup"><span data-stu-id="d96b8-380">In the definition of the `MarqueeBorder` class, declare a class called `LightShapeEditor` that derives from <xref:System.Drawing.Design.UITypeEditor>.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#96](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#96)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#96](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#96)]

3. <span data-ttu-id="d96b8-381">Déclarez un <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> variable d’instance appelée `editorService`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-381">Declare an <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> instance variable called `editorService`.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#92](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#92)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#92](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#92)]

4. <span data-ttu-id="d96b8-382">Remplacez la méthode <xref:System.Drawing.Design.UITypeEditor.GetEditStyle%2A> .</span><span class="sxs-lookup"><span data-stu-id="d96b8-382">Override the <xref:System.Drawing.Design.UITypeEditor.GetEditStyle%2A> method.</span></span> <span data-ttu-id="d96b8-383">Cette implémentation retourne <xref:System.Drawing.Design.UITypeEditorEditStyle.DropDown>, ce qui indique à l’environnement de design comment afficher le `LightShapeEditor`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-383">This implementation returns <xref:System.Drawing.Design.UITypeEditorEditStyle.DropDown>, which tells the design environment how to display the `LightShapeEditor`.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#93](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#93)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#93](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#93)]

5. <span data-ttu-id="d96b8-384">Remplacez la méthode <xref:System.Drawing.Design.UITypeEditor.EditValue%2A> .</span><span class="sxs-lookup"><span data-stu-id="d96b8-384">Override the <xref:System.Drawing.Design.UITypeEditor.EditValue%2A> method.</span></span> <span data-ttu-id="d96b8-385">Cette implémentation interroge l’environnement de conception pour un <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> objet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-385">This implementation queries the design environment for an <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> object.</span></span> <span data-ttu-id="d96b8-386">Si la réussite, il crée un `LightShapeSelectionControl`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-386">If successful, it creates a `LightShapeSelectionControl`.</span></span> <span data-ttu-id="d96b8-387">Le <xref:System.Windows.Forms.Design.IWindowsFormsEditorService.DropDownControl%2A> méthode est appelée pour démarrer le `LightShapeEditor`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-387">The <xref:System.Windows.Forms.Design.IWindowsFormsEditorService.DropDownControl%2A> method is invoked to start the `LightShapeEditor`.</span></span> <span data-ttu-id="d96b8-388">La valeur de retour de cet appel est retournée à l’environnement de conception.</span><span class="sxs-lookup"><span data-stu-id="d96b8-388">The return value from this invocation is returned to the design environment.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#94](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/marqueeborder.cs#94)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#94](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/marqueeborder.vb#94)]

## <a name="creating-a-view-control-for-your-custom-uitypeeditor"></a><span data-ttu-id="d96b8-389">Création d’un contrôle d’affichage pour votre UITypeEditor personnalisé</span><span class="sxs-lookup"><span data-stu-id="d96b8-389">Creating a View Control for your Custom UITypeEditor</span></span>

1. <span data-ttu-id="d96b8-390">Le `MarqueeLightShape` propriété prend en charge deux types de formes légères : `Square` et `Circle`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-390">The `MarqueeLightShape` property supports two types of light shapes: `Square` and `Circle`.</span></span> <span data-ttu-id="d96b8-391">Vous allez créer un contrôle personnalisé utilisé aux seules fins afficher graphiquement ces valeurs dans la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="d96b8-391">You will create a custom control used solely for the purpose of graphically displaying these values in the Properties window.</span></span> <span data-ttu-id="d96b8-392">Ce contrôle personnalisé sera être utilisé par votre <xref:System.Drawing.Design.UITypeEditor> pour interagir avec la fenêtre Propriétés.</span><span class="sxs-lookup"><span data-stu-id="d96b8-392">This custom control will be used by your <xref:System.Drawing.Design.UITypeEditor> to interact with the Properties window.</span></span>

### <a name="to-create-a-view-control-for-your-custom-ui-type-editor"></a><span data-ttu-id="d96b8-393">Pour créer un contrôle d’affichage pour votre interface utilisateur personnalisée à l’éditeur de type</span><span class="sxs-lookup"><span data-stu-id="d96b8-393">To create a view control for your custom UI type editor</span></span>

1. <span data-ttu-id="d96b8-394">Ajouter un nouveau <xref:System.Windows.Forms.UserControl> d’élément à la `MarqueeControlLibrary` projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-394">Add a new <xref:System.Windows.Forms.UserControl> item to the `MarqueeControlLibrary` project.</span></span> <span data-ttu-id="d96b8-395">Nommez le nouveau fichier source une base de « LightShapeSelectionControl. »</span><span class="sxs-lookup"><span data-stu-id="d96b8-395">Give the new source file a base name of "LightShapeSelectionControl."</span></span>

2. <span data-ttu-id="d96b8-396">Faites glisser deux <xref:System.Windows.Forms.Panel> des contrôles de la **boîte à outils** sur le `LightShapeSelectionControl`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-396">Drag two <xref:System.Windows.Forms.Panel> controls from the **Toolbox** onto the `LightShapeSelectionControl`.</span></span> <span data-ttu-id="d96b8-397">Nommez-les `squarePanel` et `circlePanel`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-397">Name them `squarePanel` and `circlePanel`.</span></span> <span data-ttu-id="d96b8-398">Disposez-les côte à côte.</span><span class="sxs-lookup"><span data-stu-id="d96b8-398">Arrange them side by side.</span></span> <span data-ttu-id="d96b8-399">Définir le <xref:System.Windows.Forms.Control.Size%2A> propriété des deux <xref:System.Windows.Forms.Panel> de contrôles à (60, 60).</span><span class="sxs-lookup"><span data-stu-id="d96b8-399">Set the <xref:System.Windows.Forms.Control.Size%2A> property of both <xref:System.Windows.Forms.Panel> controls to (60, 60).</span></span> <span data-ttu-id="d96b8-400">Définir le <xref:System.Windows.Forms.Control.Location%2A> propriété de la `squarePanel` le contrôle à (8, 10).</span><span class="sxs-lookup"><span data-stu-id="d96b8-400">Set the <xref:System.Windows.Forms.Control.Location%2A> property of the `squarePanel` control to (8, 10).</span></span> <span data-ttu-id="d96b8-401">Définir le <xref:System.Windows.Forms.Control.Location%2A> propriété de la `circlePanel` le contrôle à (80, 10).</span><span class="sxs-lookup"><span data-stu-id="d96b8-401">Set the <xref:System.Windows.Forms.Control.Location%2A> property of the `circlePanel` control to (80, 10).</span></span> <span data-ttu-id="d96b8-402">Enfin, définissez la <xref:System.Windows.Forms.Control.Size%2A> propriété de la `LightShapeSelectionControl` à (150, 80).</span><span class="sxs-lookup"><span data-stu-id="d96b8-402">Finally, set the <xref:System.Windows.Forms.Control.Size%2A> property of the `LightShapeSelectionControl` to (150, 80).</span></span>

3. <span data-ttu-id="d96b8-403">Ouvrez le `LightShapeSelectionControl` fichier source dans le **éditeur de Code**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-403">Open the `LightShapeSelectionControl` source file in the **Code Editor**.</span></span> <span data-ttu-id="d96b8-404">En haut du fichier, importez le <xref:System.Windows.Forms.Design?displayProperty=nameWithType> espace de noms :</span><span class="sxs-lookup"><span data-stu-id="d96b8-404">At the top of the file, import the <xref:System.Windows.Forms.Design?displayProperty=nameWithType> namespace:</span></span>

```vb
Imports System.Windows.Forms.Design
```

```csharp
using System.Windows.Forms.Design;
```

1. <span data-ttu-id="d96b8-405">Implémentez <xref:System.Windows.Forms.Control.Click> gestionnaires d’événements pour le `squarePanel` et `circlePanel` contrôles.</span><span class="sxs-lookup"><span data-stu-id="d96b8-405">Implement <xref:System.Windows.Forms.Control.Click> event handlers for the `squarePanel` and `circlePanel` controls.</span></span> <span data-ttu-id="d96b8-406">Ces méthodes appellent <xref:System.Windows.Forms.Design.IWindowsFormsEditorService.CloseDropDown%2A> à la fin personnalisé <xref:System.Drawing.Design.UITypeEditor> session d’édition.</span><span class="sxs-lookup"><span data-stu-id="d96b8-406">These methods invoke <xref:System.Windows.Forms.Design.IWindowsFormsEditorService.CloseDropDown%2A> to end the custom <xref:System.Drawing.Design.UITypeEditor> editing session.</span></span>

    [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#390](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#390)]
    [!code-vb[System.Windows.Forms.Design.DocumentDesigner#390](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#390)]

2. <span data-ttu-id="d96b8-407">Déclarez un <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> variable d’instance appelée `editorService`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-407">Declare an <xref:System.Windows.Forms.Design.IWindowsFormsEditorService> instance variable called `editorService`.</span></span>

```vb
Private editorService As IWindowsFormsEditorService
```

```csharp
private IWindowsFormsEditorService editorService;
```

1. <span data-ttu-id="d96b8-408">Déclarez un `MarqueeLightShape` variable d’instance appelée `lightShapeValue`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-408">Declare a `MarqueeLightShape` instance variable called `lightShapeValue`.</span></span>

     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#330](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#330)]
     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#330](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#330)]

2. <span data-ttu-id="d96b8-409">Dans le `LightShapeSelectionControl` constructeur, attacher le <xref:System.Windows.Forms.Control.Click> gestionnaires d’événements pour le `squarePanel` et `circlePanel` contrôles <xref:System.Windows.Forms.Control.Click> événements.</span><span class="sxs-lookup"><span data-stu-id="d96b8-409">In the `LightShapeSelectionControl` constructor, attach the <xref:System.Windows.Forms.Control.Click> event handlers to the `squarePanel` and `circlePanel` controls' <xref:System.Windows.Forms.Control.Click> events.</span></span> <span data-ttu-id="d96b8-410">Définissez également une surcharge de constructeur qui affecte le `MarqueeLightShape` valeur de l’environnement de conception vers le `lightShapeValue` champ.</span><span class="sxs-lookup"><span data-stu-id="d96b8-410">Also, define a constructor overload that assigns the `MarqueeLightShape` value from the design environment to the `lightShapeValue` field.</span></span>

     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#340](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#340)]
     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#340](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#340)]

3. <span data-ttu-id="d96b8-411">Dans le <xref:System.ComponentModel.Component.Dispose%2A> (méthode), détacher le <xref:System.Windows.Forms.Control.Click> gestionnaires d’événements.</span><span class="sxs-lookup"><span data-stu-id="d96b8-411">In the <xref:System.ComponentModel.Component.Dispose%2A> method, detach the <xref:System.Windows.Forms.Control.Click> event handlers.</span></span>

     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#350](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#350)]
     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#350](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#350)]

4. <span data-ttu-id="d96b8-412">Dans l’**Explorateur de solutions**, cliquez sur le bouton **Afficher tous les fichiers**.</span><span class="sxs-lookup"><span data-stu-id="d96b8-412">In **Solution Explorer**, click the **Show All Files** button.</span></span> <span data-ttu-id="d96b8-413">Ouvrez le fichier LightShapeSelectionControl.Designer.cs ou LightShapeSelectionControl.Designer.vb et supprimez la définition par défaut de la <xref:System.ComponentModel.Component.Dispose%2A> (méthode).</span><span class="sxs-lookup"><span data-stu-id="d96b8-413">Open the LightShapeSelectionControl.Designer.cs or LightShapeSelectionControl.Designer.vb file, and remove the default definition of the <xref:System.ComponentModel.Component.Dispose%2A> method.</span></span>

5. <span data-ttu-id="d96b8-414">Implémentez la propriété `LightShape`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-414">Implement the `LightShape` property.</span></span>

     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#360](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#360)]
     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#360](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#360)]

6. <span data-ttu-id="d96b8-415">Remplacez la méthode <xref:System.Windows.Forms.Control.OnPaint%2A> .</span><span class="sxs-lookup"><span data-stu-id="d96b8-415">Override the <xref:System.Windows.Forms.Control.OnPaint%2A> method.</span></span> <span data-ttu-id="d96b8-416">Cette implémentation dessinera un carré rempli et un cercle.</span><span class="sxs-lookup"><span data-stu-id="d96b8-416">This implementation will draw a filled square and circle.</span></span> <span data-ttu-id="d96b8-417">Elle sera également en surbrillance la valeur sélectionnée en dessinant une bordure autour d’une forme ou l’autre.</span><span class="sxs-lookup"><span data-stu-id="d96b8-417">It will also highlight the selected value by drawing a border around one shape or the other.</span></span>

     [!code-csharp[System.Windows.Forms.Design.DocumentDesigner#380](~/samples/snippets/csharp/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/CS/lightshapeselectioncontrol.cs#380)]
     [!code-vb[System.Windows.Forms.Design.DocumentDesigner#380](~/samples/snippets/visualbasic/VS_Snippets_Winforms/System.Windows.Forms.Design.DocumentDesigner/VB/lightshapeselectioncontrol.vb#380)]

## <a name="testing-your-custom-control-in-the-designer"></a><span data-ttu-id="d96b8-418">Test de votre contrôle personnalisé dans le Concepteur</span><span class="sxs-lookup"><span data-stu-id="d96b8-418">Testing your Custom Control in the Designer</span></span>

<span data-ttu-id="d96b8-419">À ce stade, vous pouvez générer le `MarqueeControlLibrary` projet.</span><span class="sxs-lookup"><span data-stu-id="d96b8-419">At this point, you can build the `MarqueeControlLibrary` project.</span></span> <span data-ttu-id="d96b8-420">Tester votre implémentation en créant un contrôle qui hérite de la `MarqueeControl` classe et l’utiliser sur un formulaire.</span><span class="sxs-lookup"><span data-stu-id="d96b8-420">Test your implementation by creating a control that inherits from the `MarqueeControl` class and using it on a form.</span></span>

### <a name="to-create-a-custom-marqueecontrol-implementation"></a><span data-ttu-id="d96b8-421">Pour créer une implémentation personnalisée de MarqueeControl</span><span class="sxs-lookup"><span data-stu-id="d96b8-421">To create a custom MarqueeControl implementation</span></span>

1. <span data-ttu-id="d96b8-422">Ouvrez `DemoMarqueeControl` dans le Concepteur Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="d96b8-422">Open `DemoMarqueeControl` in the Windows Forms Designer.</span></span> <span data-ttu-id="d96b8-423">Cette opération crée une instance de la `DemoMarqueeControl` type et l’affiche dans une instance de la `MarqueeControlRootDesigner` type.</span><span class="sxs-lookup"><span data-stu-id="d96b8-423">This creates an instance of the `DemoMarqueeControl` type and displays it in an instance of the `MarqueeControlRootDesigner` type.</span></span>

2. <span data-ttu-id="d96b8-424">Dans le **boîte à outils**, ouvrez le **composants MarqueeControlLibrary** onglet. Vous verrez la `MarqueeBorder` et `MarqueeText` contrôles disponibles pour la sélection.</span><span class="sxs-lookup"><span data-stu-id="d96b8-424">In the **Toolbox**, open the **MarqueeControlLibrary Components** tab. You will see the `MarqueeBorder` and `MarqueeText` controls available for selection.</span></span>

3. <span data-ttu-id="d96b8-425">Faites glisser une instance de la `MarqueeBorder` contrôler sur le `DemoMarqueeControl` aire de conception.</span><span class="sxs-lookup"><span data-stu-id="d96b8-425">Drag an instance of the `MarqueeBorder` control onto the `DemoMarqueeControl` design surface.</span></span> <span data-ttu-id="d96b8-426">Ancrez ce `MarqueeBorder` vers le contrôle parent.</span><span class="sxs-lookup"><span data-stu-id="d96b8-426">Dock this `MarqueeBorder` control to the parent control.</span></span>

4. <span data-ttu-id="d96b8-427">Faites glisser une instance de la `MarqueeText` contrôler sur le `DemoMarqueeControl` aire de conception.</span><span class="sxs-lookup"><span data-stu-id="d96b8-427">Drag an instance of the `MarqueeText` control onto the `DemoMarqueeControl` design surface.</span></span>

5. <span data-ttu-id="d96b8-428">Générez la solution.</span><span class="sxs-lookup"><span data-stu-id="d96b8-428">Build the solution.</span></span>

6. <span data-ttu-id="d96b8-429">Avec le bouton droit le `DemoMarqueeControl` et dans le menu contextuel, sélectionnez le **exécuter le Test** option pour démarrer l’animation.</span><span class="sxs-lookup"><span data-stu-id="d96b8-429">Right-click the `DemoMarqueeControl` and from the shortcut menu select the **Run Test** option to start the animation.</span></span> <span data-ttu-id="d96b8-430">Cliquez sur **arrêter le Test** pour arrêter l’animation.</span><span class="sxs-lookup"><span data-stu-id="d96b8-430">Click **Stop Test** to stop the animation.</span></span>

7. <span data-ttu-id="d96b8-431">Ouvrez **Form1** en mode Création.</span><span class="sxs-lookup"><span data-stu-id="d96b8-431">Open **Form1** in Design view.</span></span>

8. <span data-ttu-id="d96b8-432">Placez deux <xref:System.Windows.Forms.Button> contrôles du formulaire.</span><span class="sxs-lookup"><span data-stu-id="d96b8-432">Place two <xref:System.Windows.Forms.Button> controls on the form.</span></span> <span data-ttu-id="d96b8-433">Nommez-les `startButton` et `stopButton`et modifier le <xref:System.Windows.Forms.Control.Text%2A> valeurs de propriété à **Démarrer** et **arrêter**, respectivement.</span><span class="sxs-lookup"><span data-stu-id="d96b8-433">Name them `startButton` and `stopButton`, and change the <xref:System.Windows.Forms.Control.Text%2A> property values to **Start** and **Stop**, respectively.</span></span>

9. <span data-ttu-id="d96b8-434">Implémentez <xref:System.Windows.Forms.Control.Click> gestionnaires d’événements pour les deux <xref:System.Windows.Forms.Button> contrôles.</span><span class="sxs-lookup"><span data-stu-id="d96b8-434">Implement <xref:System.Windows.Forms.Control.Click> event handlers for both <xref:System.Windows.Forms.Button> controls.</span></span>

10. <span data-ttu-id="d96b8-435">Dans le **boîte à outils**, ouvrez le **Composants MarqueeControlTest** onglet. Vous verrez le `DemoMarqueeControl` disponibles pour la sélection.</span><span class="sxs-lookup"><span data-stu-id="d96b8-435">In the **Toolbox**, open the **MarqueeControlTest Components** tab. You will see the `DemoMarqueeControl` available for selection.</span></span>

11. <span data-ttu-id="d96b8-436">Faites glisser une instance de `DemoMarqueeControl` sur le **Form1** aire de conception.</span><span class="sxs-lookup"><span data-stu-id="d96b8-436">Drag an instance of `DemoMarqueeControl` onto the **Form1** design surface.</span></span>

12. <span data-ttu-id="d96b8-437">Dans le <xref:System.Windows.Forms.Control.Click> appeler des gestionnaires d’événements, le `Start` et `Stop` méthodes sur le `DemoMarqueeControl`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-437">In the <xref:System.Windows.Forms.Control.Click> event handlers, invoke the `Start` and `Stop` methods on the `DemoMarqueeControl`.</span></span>

```vb
Private Sub startButton_Click(sender As Object, e As System.EventArgs)
    Me.demoMarqueeControl1.Start()
End Sub 'startButton_Click

Private Sub stopButton_Click(sender As Object, e As System.EventArgs)
Me.demoMarqueeControl1.Stop()
End Sub 'stopButton_Click
```

```csharp
private void startButton_Click(object sender, System.EventArgs e)
{
    this.demoMarqueeControl1.Start();
}

private void stopButton_Click(object sender, System.EventArgs e)
{
    this.demoMarqueeControl1.Stop();
}
```

1. <span data-ttu-id="d96b8-438">Définir le `MarqueeControlTest` projet comme projet de démarrage et l’exécuter.</span><span class="sxs-lookup"><span data-stu-id="d96b8-438">Set the `MarqueeControlTest` project as the startup project and run it.</span></span> <span data-ttu-id="d96b8-439">Vous verrez le formulaire contenant votre `DemoMarqueeControl`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-439">You will see the form displaying your `DemoMarqueeControl`.</span></span> <span data-ttu-id="d96b8-440">Cliquez sur le **Démarrer** bouton pour démarrer l’animation.</span><span class="sxs-lookup"><span data-stu-id="d96b8-440">Click the **Start** button to start the animation.</span></span> <span data-ttu-id="d96b8-441">Vous devez voir le texte clignote et les lumières se déplacent autour de la bordure.</span><span class="sxs-lookup"><span data-stu-id="d96b8-441">You should see the text flashing and the lights moving around the border.</span></span>

## <a name="next-steps"></a><span data-ttu-id="d96b8-442">Étapes suivantes</span><span class="sxs-lookup"><span data-stu-id="d96b8-442">Next Steps</span></span>

<span data-ttu-id="d96b8-443">Le `MarqueeControlLibrary` illustre une implémentation simple de contrôles personnalisés et des concepteurs associés.</span><span class="sxs-lookup"><span data-stu-id="d96b8-443">The `MarqueeControlLibrary` demonstrates a simple implementation of custom controls and associated designers.</span></span> <span data-ttu-id="d96b8-444">Vous pouvez rendre cet exemple plus sophistiquées de plusieurs façons :</span><span class="sxs-lookup"><span data-stu-id="d96b8-444">You can make this sample more sophisticated in several ways:</span></span>

- <span data-ttu-id="d96b8-445">Modifier les valeurs de propriété pour la `DemoMarqueeControl` dans le concepteur.</span><span class="sxs-lookup"><span data-stu-id="d96b8-445">Change the property values for the `DemoMarqueeControl` in the designer.</span></span> <span data-ttu-id="d96b8-446">Ajouter d’autres `MarqueBorder` contrôle et de les ancrer dans leurs instances parentes pour créer un effet imbriqué.</span><span class="sxs-lookup"><span data-stu-id="d96b8-446">Add more `MarqueBorder` controls and dock them within their parent instances to create a nested effect.</span></span> <span data-ttu-id="d96b8-447">Essayez d’utiliser des paramètres différents pour le `UpdatePeriod` et les propriétés liées à la lumière.</span><span class="sxs-lookup"><span data-stu-id="d96b8-447">Experiment with different settings for the `UpdatePeriod` and the light-related properties.</span></span>

- <span data-ttu-id="d96b8-448">Créez vos propres implémentations de `IMarqueeWidget`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-448">Author your own implementations of `IMarqueeWidget`.</span></span> <span data-ttu-id="d96b8-449">Vous pouvez, par exemple, créer une clignotant « enseigne » ou un signe animé avec plusieurs images.</span><span class="sxs-lookup"><span data-stu-id="d96b8-449">You could, for example, create a flashing "neon sign" or an animated sign with multiple images.</span></span>

- <span data-ttu-id="d96b8-450">Personnaliser davantage l’expérience au moment du design.</span><span class="sxs-lookup"><span data-stu-id="d96b8-450">Further customize the design-time experience.</span></span> <span data-ttu-id="d96b8-451">Vous pouvez essayer plus de propriétés que l’occultation <xref:System.Windows.Forms.Control.Enabled%2A> et <xref:System.Windows.Forms.Control.Visible%2A>, et vous pouvez ajouter de nouvelles propriétés.</span><span class="sxs-lookup"><span data-stu-id="d96b8-451">You could try shadowing more properties than <xref:System.Windows.Forms.Control.Enabled%2A> and <xref:System.Windows.Forms.Control.Visible%2A>, and you could add new properties.</span></span> <span data-ttu-id="d96b8-452">Ajoutez de nouveaux verbes de concepteur pour simplifier les tâches courantes comme l’ancrage de contrôles enfants.</span><span class="sxs-lookup"><span data-stu-id="d96b8-452">Add new designer verbs to simplify common tasks like docking child controls.</span></span>

- <span data-ttu-id="d96b8-453">Licence le `MarqueeControl`.</span><span class="sxs-lookup"><span data-stu-id="d96b8-453">License the `MarqueeControl`.</span></span> <span data-ttu-id="d96b8-454">Pour plus d'informations, voir [Procédure : Licence des composants et contrôles](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/fe8b1eh9(v=vs.120)).</span><span class="sxs-lookup"><span data-stu-id="d96b8-454">For more information, see [How to: License Components and Controls](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/fe8b1eh9(v=vs.120)).</span></span>

- <span data-ttu-id="d96b8-455">Contrôler la façon dont vos contrôles sont sérialisés et comment le code est généré pour eux.</span><span class="sxs-lookup"><span data-stu-id="d96b8-455">Control how your controls are serialized and how code is generated for them.</span></span> <span data-ttu-id="d96b8-456">Pour plus d’informations, consultez [Compilation et génération de Code Source dynamique](../../reflection-and-codedom/dynamic-source-code-generation-and-compilation.md).</span><span class="sxs-lookup"><span data-stu-id="d96b8-456">For more information, see [Dynamic Source Code Generation and Compilation](../../reflection-and-codedom/dynamic-source-code-generation-and-compilation.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="d96b8-457">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d96b8-457">See also</span></span>

- <xref:System.Windows.Forms.UserControl>
- <xref:System.Windows.Forms.Design.ParentControlDesigner>
- <xref:System.Windows.Forms.Design.DocumentDesigner>
- <xref:System.ComponentModel.Design.IRootDesigner>
- <xref:System.ComponentModel.Design.DesignerVerb>
- <xref:System.Drawing.Design.UITypeEditor>
- <xref:System.ComponentModel.BackgroundWorker>
- <span data-ttu-id="d96b8-458">[Guide pratique pour Créer un contrôle Windows Forms tire parti des fonctionnalités de conception](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/307hck25(v=vs.120))</span><span class="sxs-lookup"><span data-stu-id="d96b8-458">[How to: Create a Windows Forms Control That Takes Advantage of Design-Time Features](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/307hck25(v=vs.120))</span></span>
- <span data-ttu-id="d96b8-459">[Extension de la prise en charge au moment du design](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/37899azc(v=vs.120))</span><span class="sxs-lookup"><span data-stu-id="d96b8-459">[Extending Design-Time Support](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/37899azc(v=vs.120))</span></span>
- <span data-ttu-id="d96b8-460">[Concepteurs personnalisés](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/h51z5c0x(v=vs.120))</span><span class="sxs-lookup"><span data-stu-id="d96b8-460">[Custom Designers](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2013/h51z5c0x(v=vs.120))</span></span>

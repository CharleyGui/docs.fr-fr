---
title: Fusion d’éléments de menu dans le contrôle MenuStrip
ms.date: 03/30/2017
helpviewer_keywords:
- MenuStrip [Windows Forms], merging
- merging [Windows Forms], general concepts
ms.assetid: 95e113ba-f362-4dda-8a76-6d95ddc45cee
ms.openlocfilehash: 9fc2b40ef23d72db51853c124095b734a7646cda
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/24/2020
ms.locfileid: "76739041"
---
# <a name="merging-menu-items-in-the-windows-forms-menustrip-control"></a><span data-ttu-id="f8892-102">Fusion d'éléments de menu dans le contrôle MenuStrip Windows Forms</span><span class="sxs-lookup"><span data-stu-id="f8892-102">Merging Menu Items in the Windows Forms MenuStrip Control</span></span>
<span data-ttu-id="f8892-103">Si vous disposez d’une application d’interface multidocument (MDI, multiple document interface), vous pouvez fusionner des éléments de menu ou des menus entiers du formulaire enfant dans les menus du formulaire parent.</span><span class="sxs-lookup"><span data-stu-id="f8892-103">If you have a multiple-document interface (MDI) application, you can merge menu items or whole menus from the child form into the menus of the parent form.</span></span>  
  
 <span data-ttu-id="f8892-104">Cette rubrique décrit les concepts de base associés à la fusion d’éléments de menu dans une application MDI.</span><span class="sxs-lookup"><span data-stu-id="f8892-104">This topic describes the basic concepts associated with merging menu items in an MDI application.</span></span>  
  
## <a name="general-concepts"></a><span data-ttu-id="f8892-105">Concepts généraux</span><span class="sxs-lookup"><span data-stu-id="f8892-105">General Concepts</span></span>  
 <span data-ttu-id="f8892-106">Les procédures de fusion impliquent à la fois une cible et un contrôle de code source :</span><span class="sxs-lookup"><span data-stu-id="f8892-106">Merging procedures involve both a target and a source control:</span></span>  
  
- <span data-ttu-id="f8892-107">La cible est le contrôle <xref:System.Windows.Forms.MenuStrip> sur le formulaire principal ou parent MDI dans lequel vous fusionnez les éléments de menu.</span><span class="sxs-lookup"><span data-stu-id="f8892-107">The target is the <xref:System.Windows.Forms.MenuStrip> control on the main or MDI parent form into which you are merging menu items.</span></span>  
  
- <span data-ttu-id="f8892-108">La source est le contrôle <xref:System.Windows.Forms.MenuStrip> sur le formulaire enfant MDI qui contient les éléments de menu que vous souhaitez fusionner dans le menu cible.</span><span class="sxs-lookup"><span data-stu-id="f8892-108">The source is the <xref:System.Windows.Forms.MenuStrip> control on the MDI child form that contains the menu items you want to merge into the target menu.</span></span>  
  
 <span data-ttu-id="f8892-109">La propriété <xref:System.Windows.Forms.MenuStrip.MdiWindowListItem%2A> identifie l’élément de menu dont vous remplissez les listes déroulantes avec les titres des enfants MDI du formulaire MDI parent.</span><span class="sxs-lookup"><span data-stu-id="f8892-109">The <xref:System.Windows.Forms.MenuStrip.MdiWindowListItem%2A> property identifies the menu item whose drop-down list you will populate with the titles of the current MDI parent form's MDI children.</span></span> <span data-ttu-id="f8892-110">Par exemple, vous répertoriez généralement les enfants MDI qui sont actuellement ouverts dans le menu **fenêtre** .</span><span class="sxs-lookup"><span data-stu-id="f8892-110">For example, you typically list MDI children that are currently open on the **Window** menu.</span></span>  
  
 <span data-ttu-id="f8892-111">La propriété <xref:System.Windows.Forms.ToolStripMenuItem.IsMdiWindowListEntry%2A> identifie les éléments de menu provenant d’un <xref:System.Windows.Forms.MenuStrip> sur un formulaire MDI enfant.</span><span class="sxs-lookup"><span data-stu-id="f8892-111">The <xref:System.Windows.Forms.ToolStripMenuItem.IsMdiWindowListEntry%2A> property identifies which menu items come from a <xref:System.Windows.Forms.MenuStrip> on an MDI child form.</span></span>  
  
 <span data-ttu-id="f8892-112">Vous pouvez fusionner les éléments de menu manuellement ou automatiquement.</span><span class="sxs-lookup"><span data-stu-id="f8892-112">You can merge menu items manually or automatically.</span></span> <span data-ttu-id="f8892-113">Les éléments de menu sont fusionnés de la même façon pour les deux méthodes, mais la fusion est activée différemment, comme indiqué dans les sections « fusion manuelle » et « fusion automatique » plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="f8892-113">The menu items merge in the same way for both methods, but the merge is activated differently, as discussed in the "Manual Merging" and "Automatic Merging" sections later in this topic.</span></span> <span data-ttu-id="f8892-114">Dans les fusions manuelle et automatique, chaque action de fusion affecte l’action de fusion suivante.</span><span class="sxs-lookup"><span data-stu-id="f8892-114">In both manual and automatic merging, each merge action affects the next merge action.</span></span>  
  
 <span data-ttu-id="f8892-115"><xref:System.Windows.Forms.MenuStrip> la fusion déplace les éléments de menu d’un <xref:System.Windows.Forms.ToolStrip> à un autre au lieu de les cloner, comme c’était le cas avec <xref:System.Windows.Forms.MainMenu>.</span><span class="sxs-lookup"><span data-stu-id="f8892-115"><xref:System.Windows.Forms.MenuStrip> merging moves menu items from one <xref:System.Windows.Forms.ToolStrip> to another rather than cloning them, as was the case with <xref:System.Windows.Forms.MainMenu>.</span></span>  
  
## <a name="mergeaction-values"></a><span data-ttu-id="f8892-116">Valeurs MergeAction</span><span class="sxs-lookup"><span data-stu-id="f8892-116">MergeAction Values</span></span>  
 <span data-ttu-id="f8892-117">Vous définissez l’action de fusion sur les éléments de menu du <xref:System.Windows.Forms.MenuStrip> source à l’aide de la propriété <xref:System.Windows.Forms.MergeAction>.</span><span class="sxs-lookup"><span data-stu-id="f8892-117">You set the merge action on menu items in the source <xref:System.Windows.Forms.MenuStrip> using the <xref:System.Windows.Forms.MergeAction> property.</span></span>  
  
 <span data-ttu-id="f8892-118">Le tableau suivant décrit la signification et l’utilisation classique des actions de fusion disponibles.</span><span class="sxs-lookup"><span data-stu-id="f8892-118">The following table describes the meaning and typical use of the available merge actions.</span></span>  
  
|<span data-ttu-id="f8892-119">Valeur MergeAction</span><span class="sxs-lookup"><span data-stu-id="f8892-119">MergeAction Value</span></span>|<span data-ttu-id="f8892-120">Description</span><span class="sxs-lookup"><span data-stu-id="f8892-120">Description</span></span>|<span data-ttu-id="f8892-121">Utilisation courante</span><span class="sxs-lookup"><span data-stu-id="f8892-121">Typical Use</span></span>|  
|-----------------------|-----------------|-----------------|  
|<xref:System.Windows.Forms.MergeAction.Append>|<span data-ttu-id="f8892-122">Valeurs Ajoute l’élément source à la fin de la collection de l’élément cible.</span><span class="sxs-lookup"><span data-stu-id="f8892-122">(Default) Adds the source item to the end of the target item's collection.</span></span>|<span data-ttu-id="f8892-123">Ajout d’éléments de menu à la fin du menu quand une partie du programme est activée.</span><span class="sxs-lookup"><span data-stu-id="f8892-123">Adding menu items to the end of the menu when some part of the program is activated.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Insert>|<span data-ttu-id="f8892-124">Ajoute l’élément source à la collection de l’élément cible, à l’emplacement spécifié par la propriété <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> définie sur l’élément source.</span><span class="sxs-lookup"><span data-stu-id="f8892-124">Adds the source item to the target item's collection, in the location specified by the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> property set on the source item.</span></span>|<span data-ttu-id="f8892-125">Ajout d’éléments de menu au milieu ou au début du menu quand une partie du programme est activée.</span><span class="sxs-lookup"><span data-stu-id="f8892-125">Adding menu items to the middle or the beginning of the menu when some part of the program is activated.</span></span><br /><br /> <span data-ttu-id="f8892-126">Si la valeur de <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> est la même pour les deux éléments de menu, ceux-ci sont ajoutés dans l’ordre inverse.</span><span class="sxs-lookup"><span data-stu-id="f8892-126">If the value of <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> is the same for both menu items, they are added in reverse order.</span></span> <span data-ttu-id="f8892-127">Définissez <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> de manière appropriée pour conserver l’ordre d’origine.</span><span class="sxs-lookup"><span data-stu-id="f8892-127">Set <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> appropriately to preserve the original order.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Replace>|<span data-ttu-id="f8892-128">Recherche une correspondance de texte ou utilise la valeur <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> si aucune correspondance de texte n’est trouvée, puis remplace l’élément de menu cible correspondant par l’élément de menu source.</span><span class="sxs-lookup"><span data-stu-id="f8892-128">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then replaces the matching target menu item with the source menu item.</span></span>|<span data-ttu-id="f8892-129">Remplacement d’un élément de menu cible par un élément de menu source portant le même nom, ce qui diffère.</span><span class="sxs-lookup"><span data-stu-id="f8892-129">Replacing a target menu item with a source menu item of the same name that does something different.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.MatchOnly>|<span data-ttu-id="f8892-130">Recherche une correspondance de texte ou utilise la valeur <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> si aucune correspondance de texte n’est trouvée, puis ajoute tous les éléments déroulants de la source à la cible.</span><span class="sxs-lookup"><span data-stu-id="f8892-130">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then adds all the drop-down items from the source to the target.</span></span>|<span data-ttu-id="f8892-131">Création d’une structure de menu qui insère ou ajoute des éléments de menu dans un sous-menu, ou supprime des éléments de menu d’un sous-menu.</span><span class="sxs-lookup"><span data-stu-id="f8892-131">Building a menu structure that inserts or adds menu items into a submenu, or removes menu items from a submenu.</span></span> <span data-ttu-id="f8892-132">Par exemple, vous pouvez ajouter un élément de menu d’un enfant MDI à un menu principal <xref:System.Windows.Forms.MenuStrip>**Enregistrer sous** .</span><span class="sxs-lookup"><span data-stu-id="f8892-132">For example, you can add a menu item from an MDI child to a main <xref:System.Windows.Forms.MenuStrip>**Save As** menu.</span></span><br /><br /> <span data-ttu-id="f8892-133"><xref:System.Windows.Forms.MergeAction.MatchOnly> vous permet de parcourir la structure de menus sans entreprendre aucune action.</span><span class="sxs-lookup"><span data-stu-id="f8892-133"><xref:System.Windows.Forms.MergeAction.MatchOnly> allows you to navigate through the menu structure without taking any action.</span></span> <span data-ttu-id="f8892-134">Il offre un moyen d’évaluer les éléments suivants.</span><span class="sxs-lookup"><span data-stu-id="f8892-134">It provides a way to evaluate the subsequent items.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Remove>|<span data-ttu-id="f8892-135">Recherche une correspondance de texte ou utilise la valeur <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> si aucune correspondance de texte n’est trouvée, puis supprime l’élément de la cible.</span><span class="sxs-lookup"><span data-stu-id="f8892-135">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then removes the item from the target.</span></span>|<span data-ttu-id="f8892-136">Suppression d’un élément de menu du <xref:System.Windows.Forms.MenuStrip>cible.</span><span class="sxs-lookup"><span data-stu-id="f8892-136">Removing a menu item from the target <xref:System.Windows.Forms.MenuStrip>.</span></span>|  
  
## <a name="manual-merging"></a><span data-ttu-id="f8892-137">Fusion manuelle</span><span class="sxs-lookup"><span data-stu-id="f8892-137">Manual Merging</span></span>  
 <span data-ttu-id="f8892-138">Seuls les contrôles <xref:System.Windows.Forms.MenuStrip> participent à la fusion automatique.</span><span class="sxs-lookup"><span data-stu-id="f8892-138">Only <xref:System.Windows.Forms.MenuStrip> controls participate in automatic merging.</span></span> <span data-ttu-id="f8892-139">Pour combiner les éléments d’autres contrôles, tels que les contrôles <xref:System.Windows.Forms.ToolStrip> et <xref:System.Windows.Forms.StatusStrip>, vous devez les fusionner manuellement, en appelant les méthodes <xref:System.Windows.Forms.ToolStripManager.Merge%2A> et <xref:System.Windows.Forms.ToolStripManager.RevertMerge%2A> dans votre code, selon les besoins.</span><span class="sxs-lookup"><span data-stu-id="f8892-139">To combine the items of other controls, such as <xref:System.Windows.Forms.ToolStrip> and <xref:System.Windows.Forms.StatusStrip> controls, you must merge them manually, by calling the <xref:System.Windows.Forms.ToolStripManager.Merge%2A> and <xref:System.Windows.Forms.ToolStripManager.RevertMerge%2A> methods in your code as required.</span></span>  
  
## <a name="automatic-merging"></a><span data-ttu-id="f8892-140">Fusion automatique</span><span class="sxs-lookup"><span data-stu-id="f8892-140">Automatic Merging</span></span>  
 <span data-ttu-id="f8892-141">Vous pouvez utiliser la fusion automatique pour les applications MDI en activant le formulaire source.</span><span class="sxs-lookup"><span data-stu-id="f8892-141">You can use automatic merging for MDI applications by activating the source form.</span></span> <span data-ttu-id="f8892-142">Pour utiliser un <xref:System.Windows.Forms.MenuStrip> dans une application MDI, affectez à la propriété <xref:System.Windows.Forms.Form.MainMenuStrip%2A> la <xref:System.Windows.Forms.MenuStrip> cible afin que les actions de fusion effectuées sur le <xref:System.Windows.Forms.MenuStrip> source soient reflétées dans le <xref:System.Windows.Forms.MenuStrip>cible.</span><span class="sxs-lookup"><span data-stu-id="f8892-142">To use a <xref:System.Windows.Forms.MenuStrip> in an MDI application, set the <xref:System.Windows.Forms.Form.MainMenuStrip%2A> property to the target <xref:System.Windows.Forms.MenuStrip> so that merging actions performed on the source <xref:System.Windows.Forms.MenuStrip> are reflected in the target <xref:System.Windows.Forms.MenuStrip>.</span></span>  
  
 <span data-ttu-id="f8892-143">Vous pouvez déclencher la fusion automatique en activant la <xref:System.Windows.Forms.MenuStrip> sur la source MDI.</span><span class="sxs-lookup"><span data-stu-id="f8892-143">You can trigger automatic merging by activating the <xref:System.Windows.Forms.MenuStrip> on the MDI source.</span></span> <span data-ttu-id="f8892-144">Lors de l’activation, la <xref:System.Windows.Forms.MenuStrip> source est fusionnée dans la cible MDI.</span><span class="sxs-lookup"><span data-stu-id="f8892-144">Upon activation, the source <xref:System.Windows.Forms.MenuStrip> is merged into the MDI target.</span></span> <span data-ttu-id="f8892-145">Lorsqu’un nouveau formulaire devient actif, la fusion est restaurée sur le dernier formulaire et déclenchée sur le nouveau formulaire.</span><span class="sxs-lookup"><span data-stu-id="f8892-145">When a new form becomes active, the merge is reverted on the last form and triggered on the new form.</span></span> <span data-ttu-id="f8892-146">Vous pouvez contrôler ce comportement en définissant la propriété <xref:System.Windows.Forms.ToolStripItem.MergeAction%2A> selon les besoins sur chaque <xref:System.Windows.Forms.ToolStripItem>, et en définissant la propriété <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> sur chaque <xref:System.Windows.Forms.MenuStrip>.</span><span class="sxs-lookup"><span data-stu-id="f8892-146">You can control this behavior by setting the <xref:System.Windows.Forms.ToolStripItem.MergeAction%2A> property as needed on each <xref:System.Windows.Forms.ToolStripItem>, and by setting the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property on each <xref:System.Windows.Forms.MenuStrip>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f8892-147">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f8892-147">See also</span></span>

- <xref:System.Windows.Forms.ToolStripManager>
- <xref:System.Windows.Forms.MenuStrip>
- [<span data-ttu-id="f8892-148">MenuStrip, contrôle</span><span class="sxs-lookup"><span data-stu-id="f8892-148">MenuStrip Control</span></span>](menustrip-control-windows-forms.md)
- [<span data-ttu-id="f8892-149">Guide pratique pour créer une liste des fenêtres MDI avec MenuStrip</span><span class="sxs-lookup"><span data-stu-id="f8892-149">How to: Create an MDI Window List with MenuStrip</span></span>](how-to-create-an-mdi-window-list-with-menustrip-windows-forms.md)
- [<span data-ttu-id="f8892-150">Guide pratique pour configurer la fusion de menus automatique pour les applications MDI</span><span class="sxs-lookup"><span data-stu-id="f8892-150">How to: Set Up Automatic Menu Merging for MDI Applications</span></span>](how-to-set-up-automatic-menu-merging-for-mdi-applications.md)

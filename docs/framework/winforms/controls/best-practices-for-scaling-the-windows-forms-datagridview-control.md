---
title: Meilleures pratiques pour la mise à l’échelle du contrôle DataGridView
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], row sharing
- data grids [Windows Forms], best practices
- DataGridView control [Windows Forms], shared rows
- DataGridView control [Windows Forms], best practices
- best practices [Windows Forms], dataGridView control
- DataGridView control [Windows Forms], scaling
ms.assetid: 8321a8a6-6340-4fd1-b475-fa090b905aaf
ms.openlocfilehash: 63500a79def89510b4bc7a436abc4620a7265a79
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/24/2020
ms.locfileid: "76744124"
---
# <a name="best-practices-for-scaling-the-windows-forms-datagridview-control"></a><span data-ttu-id="2a1ce-102">Meilleures pratiques pour la mise à l'échelle du contrôle DataGridView Windows Forms</span><span class="sxs-lookup"><span data-stu-id="2a1ce-102">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>

<span data-ttu-id="2a1ce-103">Le contrôle <xref:System.Windows.Forms.DataGridView> est conçu pour offrir une évolutivité maximale.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-103">The <xref:System.Windows.Forms.DataGridView> control is designed to provide maximum scalability.</span></span> <span data-ttu-id="2a1ce-104">Si vous avez besoin d’afficher de grandes quantités de données, vous devez suivre les instructions décrites dans cette rubrique pour éviter de consommer de grandes quantités de mémoire ou de dégrader la réactivité de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-104">If you need to display large amounts of data, you should follow the guidelines described in this topic to avoid consuming large amounts of memory or degrading the responsiveness of the user interface (UI).</span></span> <span data-ttu-id="2a1ce-105">Cette rubrique présente les problèmes suivants :</span><span class="sxs-lookup"><span data-stu-id="2a1ce-105">This topic discusses the following issues:</span></span>

- <span data-ttu-id="2a1ce-106">Utilisation efficace des styles de cellule</span><span class="sxs-lookup"><span data-stu-id="2a1ce-106">Using cell styles efficiently</span></span>

- <span data-ttu-id="2a1ce-107">Utilisation efficace des menus contextuels</span><span class="sxs-lookup"><span data-stu-id="2a1ce-107">Using shortcut menus efficiently</span></span>

- <span data-ttu-id="2a1ce-108">Utilisation efficace du redimensionnement automatique</span><span class="sxs-lookup"><span data-stu-id="2a1ce-108">Using automatic resizing efficiently</span></span>

- <span data-ttu-id="2a1ce-109">Utilisation efficace des collections de cellules, de lignes et de colonnes sélectionnées</span><span class="sxs-lookup"><span data-stu-id="2a1ce-109">Using the selected cells, rows, and columns collections efficiently</span></span>

- <span data-ttu-id="2a1ce-110">Utilisation de lignes partagées</span><span class="sxs-lookup"><span data-stu-id="2a1ce-110">Using shared rows</span></span>

- <span data-ttu-id="2a1ce-111">Empêcher le partage de lignes</span><span class="sxs-lookup"><span data-stu-id="2a1ce-111">Preventing rows from becoming unshared</span></span>

<span data-ttu-id="2a1ce-112">Si vous avez des besoins spécifiques en matière de performances, vous pouvez implémenter le mode virtuel et fournir vos propres opérations de gestion de données.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-112">If you have special performance needs, you can implement virtual mode and provide your own data management operations.</span></span> <span data-ttu-id="2a1ce-113">Pour plus d’informations, consultez [modes d’affichage des données dans le contrôle DataGridView Windows Forms](data-display-modes-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="2a1ce-113">For more information, see [Data Display Modes in the Windows Forms DataGridView Control](data-display-modes-in-the-windows-forms-datagridview-control.md).</span></span>

## <a name="using-cell-styles-efficiently"></a><span data-ttu-id="2a1ce-114">Utilisation efficace des styles de cellule</span><span class="sxs-lookup"><span data-stu-id="2a1ce-114">Using Cell Styles Efficiently</span></span>

<span data-ttu-id="2a1ce-115">Chaque cellule, ligne et colonne peut avoir ses propres informations de style.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-115">Each cell, row, and column can have its own style information.</span></span> <span data-ttu-id="2a1ce-116">Les informations de style sont stockées dans des objets <xref:System.Windows.Forms.DataGridViewCellStyle>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-116">Style information is stored in <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span> <span data-ttu-id="2a1ce-117">La création d’objets de style de cellule pour de nombreux éléments de <xref:System.Windows.Forms.DataGridView> individuels peut être inefficace, en particulier lors de l’utilisation de grandes quantités de données.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-117">Creating cell style objects for many individual <xref:System.Windows.Forms.DataGridView> elements can be inefficient, especially when working with large amounts of data.</span></span> <span data-ttu-id="2a1ce-118">Pour éviter un impact sur les performances, suivez les instructions ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="2a1ce-118">To avoid a performance impact, use the following guidelines:</span></span>

- <span data-ttu-id="2a1ce-119">Évitez de définir des propriétés de style de cellule pour des objets <xref:System.Windows.Forms.DataGridViewCell> ou <xref:System.Windows.Forms.DataGridViewRow>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-119">Avoid setting cell style properties for individual <xref:System.Windows.Forms.DataGridViewCell> or <xref:System.Windows.Forms.DataGridViewRow> objects.</span></span> <span data-ttu-id="2a1ce-120">Cela comprend l’objet Row spécifié par la propriété <xref:System.Windows.Forms.DataGridView.RowTemplate%2A>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-120">This includes the row object specified by the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> property.</span></span> <span data-ttu-id="2a1ce-121">Chaque nouvelle ligne clonée à partir du modèle de ligne reçoit sa propre copie de l’objet de style de cellule du modèle.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-121">Each new row that is cloned from the row template will receive its own copy of the template's cell style object.</span></span> <span data-ttu-id="2a1ce-122">Pour une extensibilité maximale, définissez les propriétés de style de cellule au niveau de la <xref:System.Windows.Forms.DataGridView>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-122">For maximum scalability, set cell style properties at the <xref:System.Windows.Forms.DataGridView> level.</span></span> <span data-ttu-id="2a1ce-123">Par exemple, définissez la propriété <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType> plutôt que la propriété <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-123">For example, set the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="2a1ce-124">Si certaines cellules nécessitent une mise en forme autre que la mise en forme par défaut, utilisez la même instance de <xref:System.Windows.Forms.DataGridViewCellStyle> entre des groupes de cellules, de lignes ou de colonnes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-124">If some cells require formatting other than default formatting, use the same <xref:System.Windows.Forms.DataGridViewCellStyle> instance across groups of cells, rows, or columns.</span></span> <span data-ttu-id="2a1ce-125">Évitez de définir directement les propriétés de type <xref:System.Windows.Forms.DataGridViewCellStyle> sur des cellules, des lignes et des colonnes spécifiques.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-125">Avoid directly setting properties of type <xref:System.Windows.Forms.DataGridViewCellStyle> on individual cells, rows, and columns.</span></span> <span data-ttu-id="2a1ce-126">Pour obtenir un exemple de partage de style de cellule, consultez [Comment : définir des styles de cellules par défaut pour le contrôle DataGridView Windows Forms](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="2a1ce-126">For an example of cell style sharing, see [How to: Set Default Cell Styles for the Windows Forms DataGridView Control](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span></span> <span data-ttu-id="2a1ce-127">Vous pouvez également éviter une altération des performances lors de la définition individuelle des styles de cellule en gérant le gestionnaire d’événements <xref:System.Windows.Forms.DataGridView.CellFormatting>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-127">You can also avoid a performance penalty when setting cell styles individually by handling the <xref:System.Windows.Forms.DataGridView.CellFormatting> event handler.</span></span> <span data-ttu-id="2a1ce-128">Pour obtenir un exemple, consultez [Comment : personnaliser la mise en forme des données dans le contrôle DataGridView Windows Forms](how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="2a1ce-128">For an example, see [How to: Customize Data Formatting in the Windows Forms DataGridView Control](how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md).</span></span>

- <span data-ttu-id="2a1ce-129">Lorsque vous déterminez le style d’une cellule, utilisez la propriété <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType> plutôt que la propriété <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-129">When determining a cell's style, use the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="2a1ce-130">L’accès à la propriété <xref:System.Windows.Forms.DataGridViewCell.Style%2A> crée une nouvelle instance de la classe <xref:System.Windows.Forms.DataGridViewCellStyle> si la propriété n’a pas déjà été utilisée.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-130">Accessing the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property creates a new instance of the <xref:System.Windows.Forms.DataGridViewCellStyle> class if the property has not already been used.</span></span> <span data-ttu-id="2a1ce-131">En outre, cet objet peut ne pas contenir les informations de style complètes pour la cellule si certains styles sont hérités de la ligne, de la colonne ou du contrôle.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-131">Additionally, this object might not contain the complete style information for the cell if some styles are inherited from the row, column, or control.</span></span> <span data-ttu-id="2a1ce-132">Pour plus d’informations sur l’héritage de style de cellule, consultez [styles de cellule dans le contrôle DataGridView Windows Forms](cell-styles-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="2a1ce-132">For more information about cell style inheritance, see [Cell Styles in the Windows Forms DataGridView Control](cell-styles-in-the-windows-forms-datagridview-control.md).</span></span>

## <a name="using-shortcut-menus-efficiently"></a><span data-ttu-id="2a1ce-133">Utilisation efficace des menus contextuels</span><span class="sxs-lookup"><span data-stu-id="2a1ce-133">Using Shortcut Menus Efficiently</span></span>

<span data-ttu-id="2a1ce-134">Chaque cellule, ligne et colonne peut avoir son propre menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-134">Each cell, row, and column can have its own shortcut menu.</span></span> <span data-ttu-id="2a1ce-135">Les menus contextuels du contrôle <xref:System.Windows.Forms.DataGridView> sont représentés par des contrôles <xref:System.Windows.Forms.ContextMenuStrip>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-135">Shortcut menus in the <xref:System.Windows.Forms.DataGridView> control are represented by <xref:System.Windows.Forms.ContextMenuStrip> controls.</span></span> <span data-ttu-id="2a1ce-136">Tout comme avec les objets de style de cellule, la création de menus contextuels pour de nombreux éléments de <xref:System.Windows.Forms.DataGridView> individuel aura un impact négatif sur les performances.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-136">Just as with cell style objects, creating shortcut menus for many individual <xref:System.Windows.Forms.DataGridView> elements will negatively impact performance.</span></span> <span data-ttu-id="2a1ce-137">Pour éviter cette pénalité, suivez les instructions ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="2a1ce-137">To avoid this penalty, use the following guidelines:</span></span>

- <span data-ttu-id="2a1ce-138">Évitez de créer des menus contextuels pour des cellules et des lignes individuelles.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-138">Avoid creating shortcut menus for individual cells and rows.</span></span> <span data-ttu-id="2a1ce-139">Cela comprend le modèle de ligne, qui est cloné avec son menu contextuel lorsque de nouvelles lignes sont ajoutées au contrôle.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-139">This includes the row template, which is cloned along with its shortcut menu when new rows are added to the control.</span></span> <span data-ttu-id="2a1ce-140">Pour une extensibilité maximale, utilisez uniquement la propriété <xref:System.Windows.Forms.Control.ContextMenuStrip%2A> du contrôle pour spécifier un menu contextuel unique pour l’ensemble du contrôle.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-140">For maximum scalability, use only the control's <xref:System.Windows.Forms.Control.ContextMenuStrip%2A> property to specify a single shortcut menu for the entire control.</span></span>

- <span data-ttu-id="2a1ce-141">Si vous avez besoin de plusieurs menus contextuels pour plusieurs lignes ou cellules, gérez les événements <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> ou <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-141">If you require multiple shortcut menus for multiple rows or cells, handle the <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> or <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> events.</span></span> <span data-ttu-id="2a1ce-142">Ces événements vous permettent de gérer les objets de menu contextuel vous-même, ce qui vous permet de régler les performances.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-142">These events let you manage the shortcut menu objects yourself, allowing you to tune performance.</span></span>

## <a name="using-automatic-resizing-efficiently"></a><span data-ttu-id="2a1ce-143">Utilisation efficace du redimensionnement automatique</span><span class="sxs-lookup"><span data-stu-id="2a1ce-143">Using Automatic Resizing Efficiently</span></span>

<span data-ttu-id="2a1ce-144">Les lignes, les colonnes et les en-têtes peuvent être redimensionnés automatiquement à mesure que le contenu des cellules change afin que le contenu entier des cellules soit affiché sans découpage.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-144">Rows, columns, and headers can be automatically resized as cell content changes so that the entire contents of cells are displayed without clipping.</span></span> <span data-ttu-id="2a1ce-145">La modification des modes de dimensionnement peut également redimensionner des lignes, des colonnes et des en-têtes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-145">Changing sizing modes can also resize rows, columns, and headers.</span></span> <span data-ttu-id="2a1ce-146">Pour déterminer la taille correcte, le contrôle de <xref:System.Windows.Forms.DataGridView> doit examiner la valeur de chaque cellule qu’il doit prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-146">To determine the correct size, the <xref:System.Windows.Forms.DataGridView> control must examine the value of each cell that it must accommodate.</span></span> <span data-ttu-id="2a1ce-147">Lors de l’utilisation de jeux de données volumineux, cette analyse peut avoir un impact négatif sur les performances du contrôle lorsque le redimensionnement automatique se produit.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-147">When working with large data sets, this analysis can negatively impact the performance of the control when automatic resizing occurs.</span></span> <span data-ttu-id="2a1ce-148">Pour éviter des pénalités en matière de performances, suivez les instructions ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="2a1ce-148">To avoid performance penalties, use the following guidelines:</span></span>

- <span data-ttu-id="2a1ce-149">Évitez d’utiliser le dimensionnement automatique sur un contrôle de <xref:System.Windows.Forms.DataGridView> avec un grand ensemble de lignes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-149">Avoid using automatic sizing on a <xref:System.Windows.Forms.DataGridView> control with a large set of rows.</span></span> <span data-ttu-id="2a1ce-150">Si vous utilisez le dimensionnement automatique, redimensionnez uniquement en fonction des lignes affichées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-150">If you do use automatic sizing, only resize based on the displayed rows.</span></span> <span data-ttu-id="2a1ce-151">Utilisez également uniquement les lignes affichées en mode virtuel.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-151">Use only the displayed rows in virtual mode as well.</span></span>

  - <span data-ttu-id="2a1ce-152">Pour les lignes et les colonnes, utilisez le champ `DisplayedCells` ou `DisplayedCellsExceptHeaders` des énumérations <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>, <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>et <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-152">For rows and columns, use the `DisplayedCells` or `DisplayedCellsExceptHeaders` field of the <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>, <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>, and <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode> enumerations.</span></span>

  - <span data-ttu-id="2a1ce-153">Pour les en-têtes de lignes, utilisez le champ <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders> ou <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader> de l’énumération <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-153">For row headers, use the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders> or <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader> field of the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode> enumeration.</span></span>

- <span data-ttu-id="2a1ce-154">Pour une extensibilité maximale, désactivez le dimensionnement automatique et utilisez le redimensionnement par programmation.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-154">For maximum scalability, turn off automatic sizing and use programmatic resizing.</span></span>

<span data-ttu-id="2a1ce-155">Pour plus d’informations, consultez [options de dimensionnement dans le contrôle DataGridView Windows Forms](sizing-options-in-the-windows-forms-datagridview-control.md).</span><span class="sxs-lookup"><span data-stu-id="2a1ce-155">For more information, see [Sizing Options in the Windows Forms DataGridView Control](sizing-options-in-the-windows-forms-datagridview-control.md).</span></span>

## <a name="using-the-selected-cells-rows-and-columns-collections-efficiently"></a><span data-ttu-id="2a1ce-156">Utilisation efficace des collections de cellules, de lignes et de colonnes sélectionnées</span><span class="sxs-lookup"><span data-stu-id="2a1ce-156">Using the Selected Cells, Rows, and Columns Collections Efficiently</span></span>

<span data-ttu-id="2a1ce-157">La collection <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> ne fonctionne pas efficacement avec de grandes sélections.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-157">The <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection does not perform efficiently with large selections.</span></span> <span data-ttu-id="2a1ce-158">Les collections <xref:System.Windows.Forms.DataGridView.SelectedRows%2A> et <xref:System.Windows.Forms.DataGridView.SelectedColumns%2A> peuvent également être inefficaces, bien qu’à un degré moindre, car il y a beaucoup moins de lignes que de cellules dans un contrôle <xref:System.Windows.Forms.DataGridView> classique, et beaucoup moins de colonnes que de lignes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-158">The <xref:System.Windows.Forms.DataGridView.SelectedRows%2A> and <xref:System.Windows.Forms.DataGridView.SelectedColumns%2A> collections can also be inefficient, although to a lesser degree because there are many fewer rows than cells in a typical <xref:System.Windows.Forms.DataGridView> control, and many fewer columns than rows.</span></span> <span data-ttu-id="2a1ce-159">Pour éviter des pénalités en matière de performances lors de l’utilisation de ces regroupements, suivez les instructions suivantes :</span><span class="sxs-lookup"><span data-stu-id="2a1ce-159">To avoid performance penalties when working with these collections, use the following guidelines:</span></span>

- <span data-ttu-id="2a1ce-160">Pour déterminer si toutes les cellules de la <xref:System.Windows.Forms.DataGridView> ont été sélectionnées avant d’accéder au contenu de la collection de <xref:System.Windows.Forms.DataGridView.SelectedCells%2A>, vérifiez la valeur de retour de la méthode <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-160">To determine whether all the cells in the <xref:System.Windows.Forms.DataGridView> have been selected before you access the contents of the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection, check the return value of the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A> method.</span></span> <span data-ttu-id="2a1ce-161">Notez, toutefois, que cette méthode peut provoquer le non-partage de lignes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-161">Note, however, that this method can cause rows to become unshared.</span></span> <span data-ttu-id="2a1ce-162">Pour plus d'informations, consultez la section suivante.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-162">For more information, see the next section.</span></span>

- <span data-ttu-id="2a1ce-163">Évitez d’utiliser la propriété <xref:System.Collections.ICollection.Count%2A> du <xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType> pour déterminer le nombre de cellules sélectionnées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-163">Avoid using the <xref:System.Collections.ICollection.Count%2A> property of the <xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType> to determine the number of selected cells.</span></span> <span data-ttu-id="2a1ce-164">Au lieu de cela, utilisez la méthode <xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType> et transmettez la valeur <xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-164">Instead, use the <xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType> method and pass in the <xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType> value.</span></span> <span data-ttu-id="2a1ce-165">De même, utilisez les méthodes <xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType> et <xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType> pour déterminer le nombre d’éléments sélectionnés, plutôt que d’accéder aux collections de lignes et de colonnes sélectionnées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-165">Similarly, use the <xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType> methods to determine the number of selected elements, rather than accessing the selected row and column collections.</span></span>

- <span data-ttu-id="2a1ce-166">Évitez les modes de sélection basés sur des cellules.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-166">Avoid cell-based selection modes.</span></span> <span data-ttu-id="2a1ce-167">Au lieu de cela, affectez à la propriété <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> la valeur <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> ou <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-167">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>

## <a name="using-shared-rows"></a><span data-ttu-id="2a1ce-168">Utilisation de lignes partagées</span><span class="sxs-lookup"><span data-stu-id="2a1ce-168">Using Shared Rows</span></span>

<span data-ttu-id="2a1ce-169">Une utilisation efficace de la mémoire est obtenue dans le contrôle <xref:System.Windows.Forms.DataGridView> par le biais de lignes partagées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-169">Efficient memory use is achieved in the <xref:System.Windows.Forms.DataGridView> control through shared rows.</span></span> <span data-ttu-id="2a1ce-170">Les lignes partageront la plus grande quantité d’informations sur leur apparence et leur comportement possible en partageant des instances de la classe <xref:System.Windows.Forms.DataGridViewRow>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-170">Rows will share as much information about their appearance and behavior as possible by sharing instances of the <xref:System.Windows.Forms.DataGridViewRow> class.</span></span>

<span data-ttu-id="2a1ce-171">Tandis que le partage d’instances de ligne permet d’économiser de la mémoire, les lignes peuvent facilement devenir non partagées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-171">While sharing row instances saves memory, rows can easily become unshared.</span></span> <span data-ttu-id="2a1ce-172">Par exemple, chaque fois qu’un utilisateur interagit directement avec une cellule, sa ligne devient non partagée.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-172">For example, whenever a user interacts directly with a cell, its row becomes unshared.</span></span> <span data-ttu-id="2a1ce-173">Étant donné que cela ne peut pas être évité, les instructions de cette rubrique sont utiles uniquement lorsque vous travaillez avec de très grandes quantités de données et uniquement lorsque les utilisateurs interagissent avec une partie relativement réduite des données chaque fois que votre programme est exécuté.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-173">Because this cannot be avoided, the guidelines in this topic are useful only when working with very large amounts of data and only when users will interact with a relatively small part of the data each time your program is run.</span></span>

<span data-ttu-id="2a1ce-174">Une ligne ne peut pas être partagée dans un contrôle de <xref:System.Windows.Forms.DataGridView> indépendant si l’une de ses cellules contient des valeurs.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-174">A row cannot be shared in an unbound <xref:System.Windows.Forms.DataGridView> control if any of its cells contain values.</span></span> <span data-ttu-id="2a1ce-175">Lorsque le contrôle de <xref:System.Windows.Forms.DataGridView> est lié à une source de données externe ou lorsque vous implémentez le mode virtuel et fournissez votre propre source de données, les valeurs des cellules sont stockées en dehors du contrôle plutôt que dans des objets de cellule, ce qui permet de partager les lignes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-175">When the <xref:System.Windows.Forms.DataGridView> control is bound to an external data source or when you implement virtual mode and provide your own data source, the cell values are stored outside the control rather than in cell objects, allowing the rows to be shared.</span></span>

<span data-ttu-id="2a1ce-176">Un objet Row peut être partagé uniquement si l’état de toutes ses cellules peut être déterminé à partir de l’état de la ligne et des États des colonnes contenant les cellules.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-176">A row object can only be shared if the state of all its cells can be determined from the state of the row and the states of the columns containing the cells.</span></span> <span data-ttu-id="2a1ce-177">Si vous modifiez l’état d’une cellule afin qu’elle ne puisse plus être déduite de l’état de sa ligne et de sa colonne, la ligne ne peut pas être partagée.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-177">If you change the state of a cell so that it can no longer be deduced from the state of its row and column, the row cannot be shared.</span></span>

<span data-ttu-id="2a1ce-178">Par exemple, une ligne ne peut pas être partagée dans l’une des situations suivantes :</span><span class="sxs-lookup"><span data-stu-id="2a1ce-178">For example, a row cannot be shared in any of the following situations:</span></span>

- <span data-ttu-id="2a1ce-179">La ligne contient une seule cellule sélectionnée qui ne se trouve pas dans une colonne sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-179">The row contains a single selected cell that is not in a selected column.</span></span>

- <span data-ttu-id="2a1ce-180">La ligne contient une cellule dont les propriétés <xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A> ou <xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> sont définies.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-180">The row contains a cell with its <xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A> or <xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> properties set.</span></span>

- <span data-ttu-id="2a1ce-181">La ligne contient un <xref:System.Windows.Forms.DataGridViewComboBoxCell> dont la propriété <xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A> est définie.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-181">The row contains a <xref:System.Windows.Forms.DataGridViewComboBoxCell> with its <xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A> property set.</span></span>

<span data-ttu-id="2a1ce-182">En mode dépendant ou en mode virtuel, vous pouvez fournir des info-bulles et des menus contextuels pour des cellules individuelles en gérant les événements <xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded> et <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-182">In bound mode or virtual mode, you can provide ToolTips and shortcut menus for individual cells by handling the <xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded> and <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> events.</span></span>

<span data-ttu-id="2a1ce-183">Le contrôle <xref:System.Windows.Forms.DataGridView> tente automatiquement d’utiliser des lignes partagées à chaque fois que des lignes sont ajoutées à la <xref:System.Windows.Forms.DataGridViewRowCollection>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-183">The <xref:System.Windows.Forms.DataGridView> control will automatically attempt to use shared rows whenever rows are added to the <xref:System.Windows.Forms.DataGridViewRowCollection>.</span></span> <span data-ttu-id="2a1ce-184">Suivez les indications ci-dessous pour vous assurer que les lignes sont partagées :</span><span class="sxs-lookup"><span data-stu-id="2a1ce-184">Use the following guidelines to ensure that rows are shared:</span></span>

- <span data-ttu-id="2a1ce-185">Évitez d’appeler la surcharge `Add(Object[])` de la méthode <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> et la surcharge `Insert(Object[])` de la méthode <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> de la collection <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-185">Avoid calling the `Add(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method and the `Insert(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="2a1ce-186">Ces surcharges créent automatiquement des lignes non partagées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-186">These overloads automatically create unshared rows.</span></span>

- <span data-ttu-id="2a1ce-187">Assurez-vous que la ligne spécifiée dans la propriété <xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType> peut être partagée dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="2a1ce-187">Be sure that the row specified in the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType> property can be shared in the following cases:</span></span>

  - <span data-ttu-id="2a1ce-188">Lors de l’appel de la `Add()` ou `Add(Int32)` des surcharges de la méthode <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> ou de la surcharge `Insert(Int32,Int32)` de la méthode <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> de la collection <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-188">When calling the `Add()` or `Add(Int32)` overloads of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method or the `Insert(Int32,Int32)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>

  - <span data-ttu-id="2a1ce-189">Lors de l’incrémentation de la valeur de la propriété <xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-189">When increasing the value of the <xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType> property.</span></span>

  - <span data-ttu-id="2a1ce-190">Lors de la définition de la propriété <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-190">When setting the <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="2a1ce-191">Assurez-vous que la ligne indiquée par le paramètre `indexSource` peut être partagée lors de l’appel des méthodes <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>et <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A> de la collection <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-191">Be sure that the row indicated by the `indexSource` parameter can be shared when calling the <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>, and <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A> methods of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>

- <span data-ttu-id="2a1ce-192">Assurez-vous que la ou les lignes spécifiées peuvent être partagées lors de l’appel de la surcharge `Add(DataGridViewRow)` de la méthode <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>, de la méthode <xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A>, de la surcharge `Insert(Int32,DataGridViewRow)` de la méthode <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> et de la méthode <xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A> de la collection <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-192">Be sure that the specified row or rows can be shared when calling the `Add(DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method, the <xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A> method, the `Insert(Int32,DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method, and the <xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>

<span data-ttu-id="2a1ce-193">Pour déterminer si une ligne est partagée, utilisez la méthode <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> pour récupérer l’objet Row, puis vérifiez la propriété <xref:System.Windows.Forms.DataGridViewBand.Index%2A> de l’objet.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-193">To determine whether a row is shared, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method to retrieve the row object, and then check the object's <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property.</span></span> <span data-ttu-id="2a1ce-194">Les lignes partagées ont toujours une valeur de propriété <xref:System.Windows.Forms.DataGridViewBand.Index%2A> de – 1.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-194">Shared rows always have an <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property value of –1.</span></span>

## <a name="preventing-rows-from-becoming-unshared"></a><span data-ttu-id="2a1ce-195">Empêcher le partage de lignes</span><span class="sxs-lookup"><span data-stu-id="2a1ce-195">Preventing Rows from Becoming Unshared</span></span>

<span data-ttu-id="2a1ce-196">Les lignes partagées peuvent devenir non partagées suite à une action de l’utilisateur ou du code.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-196">Shared rows can become unshared as a result of code or user action.</span></span> <span data-ttu-id="2a1ce-197">Pour éviter un impact sur les performances, vous devez éviter de rendre les lignes non partagées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-197">To avoid a performance impact, you should avoid causing rows to become unshared.</span></span> <span data-ttu-id="2a1ce-198">Pendant le développement d’applications, vous pouvez gérer l’événement <xref:System.Windows.Forms.DataGridView.RowUnshared> pour déterminer quand les lignes deviennent non partagées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-198">During application development, you can handle the <xref:System.Windows.Forms.DataGridView.RowUnshared> event to determine when rows become unshared.</span></span> <span data-ttu-id="2a1ce-199">Cela est utile lors du débogage de problèmes de partage de lignes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-199">This is useful when debugging row-sharing problems.</span></span>

<span data-ttu-id="2a1ce-200">Pour empêcher le partage de lignes, suivez les instructions ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="2a1ce-200">To prevent rows from becoming unshared, use the following guidelines:</span></span>

- <span data-ttu-id="2a1ce-201">Évitez d’indexer la collection <xref:System.Windows.Forms.DataGridView.Rows%2A> ou d’effectuer une itération à l’aide d’une boucle `foreach`.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-201">Avoid indexing the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection or iterating through it with a `foreach` loop.</span></span> <span data-ttu-id="2a1ce-202">En général, vous n’avez pas besoin d’accéder directement aux lignes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-202">You will not typically need to access rows directly.</span></span> <span data-ttu-id="2a1ce-203"><xref:System.Windows.Forms.DataGridView> méthodes qui opèrent sur des lignes prennent des arguments d’index de ligne plutôt que des instances de ligne.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-203"><xref:System.Windows.Forms.DataGridView> methods that operate on rows take row index arguments rather than row instances.</span></span> <span data-ttu-id="2a1ce-204">En outre, les gestionnaires des événements liés aux lignes reçoivent des objets d’argument d’événement avec des propriétés de ligne que vous pouvez utiliser pour manipuler des lignes sans les rendre non partagées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-204">Additionally, handlers for row-related events receive event argument objects with row properties that you can use to manipulate rows without causing them to become unshared.</span></span>

- <span data-ttu-id="2a1ce-205">Si vous devez accéder à un objet Row, utilisez la méthode <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> et transmettez l’index réel de la ligne.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-205">If you need to access a row object, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method and pass in the row's actual index.</span></span> <span data-ttu-id="2a1ce-206">Notez, toutefois, que la modification d’un objet de ligne partagé récupéré via cette méthode modifiera toutes les lignes qui partagent cet objet.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-206">Note, however, that modifying a shared row object retrieved through this method will modify all the rows that share this object.</span></span> <span data-ttu-id="2a1ce-207">Toutefois, la ligne des nouveaux enregistrements n’est pas partagée avec d’autres lignes. par conséquent, elle n’est pas affectée lorsque vous modifiez une autre ligne.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-207">The row for new records is not shared with other rows, however, so it will not be affected when you modify any other row.</span></span> <span data-ttu-id="2a1ce-208">Notez également que les différentes lignes représentées par une ligne partagée peuvent avoir des menus contextuels différents.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-208">Note also that different rows represented by a shared row may have different shortcut menus.</span></span> <span data-ttu-id="2a1ce-209">Pour récupérer le menu contextuel approprié à partir d’une instance de ligne partagée, utilisez la méthode <xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A> et transmettez l’index réel de la ligne.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-209">To retrieve the correct shortcut menu from a shared row instance, use the <xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A> method and pass in the row's actual index.</span></span> <span data-ttu-id="2a1ce-210">Si vous accédez à la propriété <xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> de la ligne partagée à la place, elle utilise l’index de ligne partagé-1 et ne récupère pas le menu contextuel approprié.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-210">If you access the shared row's <xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> property instead, it will use the shared row index of -1 and will not retrieve the correct shortcut menu.</span></span>

- <span data-ttu-id="2a1ce-211">Évitez d’indexer la collection <xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-211">Avoid indexing the <xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="2a1ce-212">L’accès direct à une cellule entraîne le non-partage de sa ligne parente, l’instanciation d’un nouveau <xref:System.Windows.Forms.DataGridViewRow>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-212">Accessing a cell directly will cause its parent row to become unshared, instantiating a new <xref:System.Windows.Forms.DataGridViewRow>.</span></span> <span data-ttu-id="2a1ce-213">Les gestionnaires pour les événements liés aux cellules reçoivent des objets d’argument d’événement avec des propriétés de cellule que vous pouvez utiliser pour manipuler des cellules sans entraîner le partage de lignes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-213">Handlers for cell-related events receive event argument objects with cell properties that you can use to manipulate cells without causing rows to become unshared.</span></span> <span data-ttu-id="2a1ce-214">Vous pouvez également utiliser la propriété <xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A> pour récupérer les index de ligne et de colonne de la cellule active sans accéder directement à la cellule.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-214">You can also use the <xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A> property to retrieve the row and column indexes of the current cell without accessing the cell directly.</span></span>

- <span data-ttu-id="2a1ce-215">Évitez les modes de sélection basés sur des cellules.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-215">Avoid cell-based selection modes.</span></span> <span data-ttu-id="2a1ce-216">Ces modes entraînent le non-partage des lignes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-216">These modes cause rows to become unshared.</span></span> <span data-ttu-id="2a1ce-217">Au lieu de cela, affectez à la propriété <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> la valeur <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> ou <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-217">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>

- <span data-ttu-id="2a1ce-218">Ne gérez pas les événements <xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType> ou <xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-218">Do not handle the <xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType> events.</span></span> <span data-ttu-id="2a1ce-219">Ces événements entraînent le non-partage des lignes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-219">These events cause rows to become unshared.</span></span> <span data-ttu-id="2a1ce-220">En outre, n’appelez pas les méthodes <xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType> ou <xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType>, qui déclenchent ces événements.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-220">Also, do not call the <xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType> methods, which raise these events.</span></span>

- <span data-ttu-id="2a1ce-221">N’accédez pas à la collection <xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType> lorsque la valeur de la propriété <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> est <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>ou <xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-221">Do not access the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType> collection when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>, or <xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>.</span></span> <span data-ttu-id="2a1ce-222">Toutes les lignes sélectionnées ne sont alors plus partagées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-222">This causes all selected rows to become unshared.</span></span>

- <span data-ttu-id="2a1ce-223">N’appelez pas la méthode <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-223">Do not call the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="2a1ce-224">Cette méthode peut provoquer le non-partage de lignes.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-224">This method can cause rows to become unshared.</span></span>

- <span data-ttu-id="2a1ce-225">N’appelez pas la méthode <xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType> lorsque la valeur de la propriété <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> est <xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-225">Do not call the <xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType> method when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>.</span></span> <span data-ttu-id="2a1ce-226">Toutes les lignes deviennent alors non partagées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-226">This causes all rows to become unshared.</span></span>

- <span data-ttu-id="2a1ce-227">Ne définissez pas la propriété <xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A> ou <xref:System.Windows.Forms.DataGridViewCell.Selected%2A> d’une cellule sur `false` lorsque la propriété correspondante dans sa colonne est définie sur `true`.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-227">Do not set the <xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A> or <xref:System.Windows.Forms.DataGridViewCell.Selected%2A> property of a cell to `false` when the corresponding property in its column is set to `true`.</span></span> <span data-ttu-id="2a1ce-228">Toutes les lignes deviennent alors non partagées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-228">This causes all rows to become unshared.</span></span>

- <span data-ttu-id="2a1ce-229">N’accédez pas à la propriété <xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-229">Do not access the <xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="2a1ce-230">Toutes les lignes deviennent alors non partagées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-230">This causes all rows to become unshared.</span></span>

- <span data-ttu-id="2a1ce-231">N’appelez pas la surcharge `Sort(IComparer)` de la méthode <xref:System.Windows.Forms.DataGridView.Sort%2A>.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-231">Do not call the `Sort(IComparer)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method.</span></span> <span data-ttu-id="2a1ce-232">Si vous triez avec un comparateur personnalisé, toutes les lignes deviennent non partagées.</span><span class="sxs-lookup"><span data-stu-id="2a1ce-232">Sorting with a custom comparer causes all rows to become unshared.</span></span>

## <a name="see-also"></a><span data-ttu-id="2a1ce-233">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2a1ce-233">See also</span></span>

- <xref:System.Windows.Forms.DataGridView>
- [<span data-ttu-id="2a1ce-234">Réglage des performances dans le contrôle DataGridView Windows Forms</span><span class="sxs-lookup"><span data-stu-id="2a1ce-234">Performance Tuning in the Windows Forms DataGridView Control</span></span>](performance-tuning-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="2a1ce-235">Mode virtuel dans le contrôle DataGridView Windows Forms</span><span class="sxs-lookup"><span data-stu-id="2a1ce-235">Virtual Mode in the Windows Forms DataGridView Control</span></span>](virtual-mode-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="2a1ce-236">Modes d’affichage des données dans le contrôle DataGridView Windows Forms</span><span class="sxs-lookup"><span data-stu-id="2a1ce-236">Data Display Modes in the Windows Forms DataGridView Control</span></span>](data-display-modes-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="2a1ce-237">Styles de cellules dans le contrôle DataGridView Windows Forms</span><span class="sxs-lookup"><span data-stu-id="2a1ce-237">Cell Styles in the Windows Forms DataGridView Control</span></span>](cell-styles-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="2a1ce-238">Guide pratique pour définir les styles de cellules par défaut pour le contrôle DataGridView Windows Forms</span><span class="sxs-lookup"><span data-stu-id="2a1ce-238">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="2a1ce-239">Options de dimensionnement dans le contrôle DataGridView Windows Forms</span><span class="sxs-lookup"><span data-stu-id="2a1ce-239">Sizing Options in the Windows Forms DataGridView Control</span></span>](sizing-options-in-the-windows-forms-datagridview-control.md)

---
title: Équivalence des types et types interop incorporés
description: Comprendre l’équivalence de type entre les types et les membres .NET avec un assembly managé, et les types COM incorporés dans cet assembly. Pour .NET 4 et versions ultérieures.
ms.date: 03/30/2017
helpviewer_keywords:
- type equivalence
- embedded interop types
- primary interop assemblies,not necessary in CLR version 4
- NoPIA
ms.assetid: 78892eba-2a58-4165-b4b1-0250ee2f41dc
ms.openlocfilehash: a096c6bd0703c19c6049ad5ab2532b4b05f6ede0
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/15/2020
ms.locfileid: "90558821"
---
# <a name="type-equivalence-and-embedded-interop-types"></a><span data-ttu-id="cf9ce-104">Équivalence des types et types interop incorporés</span><span class="sxs-lookup"><span data-stu-id="cf9ce-104">Type equivalence and embedded interop types</span></span>

<span data-ttu-id="cf9ce-105">À compter de .NET Framework 4, le Common Language Runtime prend en charge l’incorporation des informations de type, pour les types COM, directement dans les assemblys managés. Auparavant, les assemblys managés devaient obtenir ces informations des assemblys interop.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-105">Beginning with the .NET Framework 4, the common language runtime supports embedding type information for COM types directly into managed assemblies, instead of requiring the managed assemblies to obtain type information for COM types from interop assemblies.</span></span> <span data-ttu-id="cf9ce-106">Étant donné que les informations de type incorporées incluent uniquement les types et les membres qui sont réellement utilisés par un assembly managé, deux assemblys managés peuvent présenter des affichages très différents du même type COM.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-106">Because the embedded type information includes only the types and members that are actually used by a managed assembly, two managed assemblies might have very different views of the same COM type.</span></span> <span data-ttu-id="cf9ce-107">Chaque assembly managé a un objet <xref:System.Type> différent pour représenter son affichage du type COM.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-107">Each managed assembly has a different <xref:System.Type> object to represent its view of the COM type.</span></span> <span data-ttu-id="cf9ce-108">Le Common Language Runtime prend en charge l’équivalence des types entre ces différents affichages pour les interfaces, les structures, les énumérations et les délégués.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-108">The common language runtime supports type equivalence between these different views for interfaces, structures, enumerations, and delegates.</span></span>

<span data-ttu-id="cf9ce-109">Avec l’équivalence des types, un objet COM qui est passé d’un assembly managé à un autre peut être casté en type managé approprié dans l’assembly de réception.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-109">Type equivalence means that a COM object that is passed from one managed assembly to another can be cast to the appropriate managed type in the receiving assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="cf9ce-110">L’équivalence des types et les types interop incorporés simplifient le déploiement des applications et compléments qui utilisent des composants COM, car cela évite d’avoir à déployer des assemblys interop avec les applications.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-110">Type equivalence and embedded interop types simplify the deployment of applications and add-ins that use COM components, because it is not necessary to deploy interop assemblies with the applications.</span></span> <span data-ttu-id="cf9ce-111">Les développeurs de composants COM partagés doivent continuer à créer des assemblys PIA (Primary Interop Assemblies) s’ils veulent pouvoir utiliser leurs composants dans des versions de .NET Framework antérieures.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-111">Developers of shared COM components still have to create primary interop assemblies (PIAs) if they want their components to be used by earlier versions of the .NET Framework.</span></span>

## <a name="type-equivalence"></a><span data-ttu-id="cf9ce-112">Équivalence des types</span><span class="sxs-lookup"><span data-stu-id="cf9ce-112">Type equivalence</span></span>

 <span data-ttu-id="cf9ce-113">L’équivalence des types COM est prise en charge pour les interfaces, les structures, les énumérations et les délégués.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-113">Equivalence of COM types is supported for interfaces, structures, enumerations, and delegates.</span></span> <span data-ttu-id="cf9ce-114">Deux types COM sont considérés comme équivalents s’ils remplissent toutes les conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="cf9ce-114">COM types qualify as equivalent if all of the following are true:</span></span>

- <span data-ttu-id="cf9ce-115">Les deux types sont des interfaces, des structures, des énumérations ou des délégués.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-115">The types are both interfaces, or both structures, or both enumerations, or both delegates.</span></span>

- <span data-ttu-id="cf9ce-116">Les deux types ont la même identité, comme décrit dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-116">The types have the same identity, as described in the next section.</span></span>

- <span data-ttu-id="cf9ce-117">Les deux types sont éligibles pour l’équivalence de type, comme décrit dans la section [marquage de types com pour l’équivalence de type](#marking-com-types-for-type-equivalence) .</span><span class="sxs-lookup"><span data-stu-id="cf9ce-117">Both types are eligible for type equivalence, as described in the [Marking COM types for type equivalence](#marking-com-types-for-type-equivalence) section.</span></span>

### <a name="type-identity"></a><span data-ttu-id="cf9ce-118">Identité des types</span><span class="sxs-lookup"><span data-stu-id="cf9ce-118">Type identity</span></span>

<span data-ttu-id="cf9ce-119">Deux types sont considérés comme ayant la même identité si leurs portées et identités correspondent ou, en d’autres termes, s’ils sont chacun définis avec l’attribut <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> et si les deux attributs ont les mêmes propriétés <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> et <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A>.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-119">Two types are determined to have the same identity when their scopes and identities match, in other words, if they each have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, and the two attributes have matching <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> and <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> properties.</span></span> <span data-ttu-id="cf9ce-120">La comparaison de <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> est effectuée en respectant la casse.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-120">The comparison for <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> is case-insensitive.</span></span>

<span data-ttu-id="cf9ce-121">Si un type n’est pas défini avec l’attribut <xref:System.Runtime.InteropServices.TypeIdentifierAttribute>, ou si son attribut <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> ne spécifie pas de portée ni d’identité, le type reste toutefois disponible pour l’équivalence de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="cf9ce-121">If a type does not have the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute, or if it has a <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute that does not specify scope and identifier, the type can still be considered for equivalence as follows:</span></span>

- <span data-ttu-id="cf9ce-122">Pour les interfaces, la valeur de l’attribut <xref:System.Runtime.InteropServices.GuidAttribute> est utilisée à la place de la propriété <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> et la propriété <xref:System.Type.FullName%2A?displayProperty=nameWithType> (correspondant au nom de type, avec l’espace de noms) est utilisée à la place de la propriété <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-122">For interfaces, the value of the <xref:System.Runtime.InteropServices.GuidAttribute> is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A?displayProperty=nameWithType> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property (that is, the type name, including the namespace) is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A?displayProperty=nameWithType> property.</span></span>

- <span data-ttu-id="cf9ce-123">Pour les structures, les énumérations et les délégués, l’attribut <xref:System.Runtime.InteropServices.GuidAttribute> de l’assembly conteneur est utilisé au lieu de la propriété <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> et la propriété <xref:System.Type.FullName%2A?displayProperty=nameWithType> est utilisée au lieu de la propriété <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A>.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-123">For structures, enumerations, and delegates, the <xref:System.Runtime.InteropServices.GuidAttribute> of the containing assembly is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Scope%2A> property, and the <xref:System.Type.FullName%2A?displayProperty=nameWithType> property is used instead of the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute.Identifier%2A> property.</span></span>

### <a name="marking-com-types-for-type-equivalence"></a><span data-ttu-id="cf9ce-124">Marquer des types COM pour l’équivalence des types</span><span class="sxs-lookup"><span data-stu-id="cf9ce-124">Marking COM types for type equivalence</span></span>

 <span data-ttu-id="cf9ce-125">Vous pouvez marquer un type comme étant disponible pour l’équivalence des types de deux manières :</span><span class="sxs-lookup"><span data-stu-id="cf9ce-125">You can mark a type as eligible for type equivalence in two ways:</span></span>

- <span data-ttu-id="cf9ce-126">Appliquez l’attribut <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> au type.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-126">Apply the <xref:System.Runtime.InteropServices.TypeIdentifierAttribute> attribute to the type.</span></span>

- <span data-ttu-id="cf9ce-127">Marquez le type comme type d’importation COM.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-127">Make the type a COM import type.</span></span> <span data-ttu-id="cf9ce-128">Une interface est un type d’importation COM si elle a l’attribut <xref:System.Runtime.InteropServices.ComImportAttribute>.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-128">An interface is a COM import type if it has the <xref:System.Runtime.InteropServices.ComImportAttribute> attribute.</span></span> <span data-ttu-id="cf9ce-129">Une interface, une structure, une énumération ou un délégué est un type d’importation COM si l’assembly dans lequel ils sont définis a l’attribut <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute>.</span><span class="sxs-lookup"><span data-stu-id="cf9ce-129">An interface, structure, enumeration, or delegate is a COM import type if the assembly in which it is defined has the <xref:System.Runtime.InteropServices.ImportedFromTypeLibAttribute> attribute.</span></span>

## <a name="see-also"></a><span data-ttu-id="cf9ce-130">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="cf9ce-130">See also</span></span>

- <xref:System.Type.IsEquivalentTo%2A>
- <span data-ttu-id="cf9ce-131">[Utiliser des types COM dans du code managé](/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="cf9ce-131">[Using COM Types in Managed Code](/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="cf9ce-132">Importation d'une bibliothèque de types sous la forme d'un assembly</span><span class="sxs-lookup"><span data-stu-id="cf9ce-132">Importing a Type Library as an Assembly</span></span>](importing-a-type-library-as-an-assembly.md)

---
title: Importation d'une bibliothèque de types sous la forme d'un assembly
description: Importez une bibliothèque de types, qui contient des définitions de types COM, sous la forme d’un assembly. Apprenez comment créer des métadonnées à partir d’une bibliothèque de types, ce qui se traduit par un assembly d’interopérabilité.
ms.date: 03/30/2017
helpviewer_keywords:
- importing type library
- type metadata
- custom wrappers
- metadata
- exposing COM components to .NET Framework
- Type Library Importer
- interoperation with unmanaged code, importing type library
- interoperation with unmanaged code, exposing COM components
- type libraries
- TypeLibConverter class, importing type library as assembly
- COM interop, importing type library
- COM interop, exposing COM components
ms.assetid: d1898229-cd40-426e-a275-f3eb65fbc79f
ms.openlocfilehash: e5187e3c2ce533f25a38e93bc3715dd3e2e47c11
ms.sourcegitcommit: e02d17b2cf9c1258dadda4810a5e6072a0089aee
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/01/2020
ms.locfileid: "85622716"
---
# <a name="importing-a-type-library-as-an-assembly"></a><span data-ttu-id="c2837-104">Importation d'une bibliothèque de types sous la forme d'un assembly</span><span class="sxs-lookup"><span data-stu-id="c2837-104">Importing a Type Library as an Assembly</span></span>

<span data-ttu-id="c2837-105">Les définitions des types COM résident généralement dans une bibliothèque de types.</span><span class="sxs-lookup"><span data-stu-id="c2837-105">COM type definitions usually reside in a type library.</span></span> <span data-ttu-id="c2837-106">Les compilateurs conformes CLS produisent quant à eux les métadonnées des types dans un assembly.</span><span class="sxs-lookup"><span data-stu-id="c2837-106">In contrast, CLS-compliant compilers produce type metadata in an assembly.</span></span> <span data-ttu-id="c2837-107">Ces deux sources d’informations sur les types sont assez différentes.</span><span class="sxs-lookup"><span data-stu-id="c2837-107">The two sources of type information are quite different.</span></span> <span data-ttu-id="c2837-108">Cette rubrique décrit des techniques permettant de générer des métadonnées à partir d’une bibliothèque de types.</span><span class="sxs-lookup"><span data-stu-id="c2837-108">This topic describes techniques for generating metadata from a type library.</span></span> <span data-ttu-id="c2837-109">L’assembly résultant est appelé assembly d’interopérabilité, et les informations de type qu’il contient permettent aux applications .NET Framework d’utiliser des types COM.</span><span class="sxs-lookup"><span data-stu-id="c2837-109">The resulting assembly is called an interop assembly, and the type information it contains enables .NET Framework applications to use COM types.</span></span>

<span data-ttu-id="c2837-110">Il existe deux façons de mettre ces informations de type à la disposition de votre application :</span><span class="sxs-lookup"><span data-stu-id="c2837-110">There are two ways to make this type information available to your application:</span></span>

- <span data-ttu-id="c2837-111">À l’aide des assemblys d’interopérabilité au moment du design : à partir du .NET Framework 4, vous pouvez indiquer au compilateur d’incorporer les informations de type de l’assembly d’interopérabilité dans votre fichier exécutable.</span><span class="sxs-lookup"><span data-stu-id="c2837-111">Using design-time-only interop assemblies: Beginning with the .NET Framework 4, you can instruct the compiler to embed type information from the interop assembly into your executable.</span></span> <span data-ttu-id="c2837-112">Le compilateur incorpore uniquement les informations de type que votre application utilise.</span><span class="sxs-lookup"><span data-stu-id="c2837-112">The compiler embeds only the type information that your application uses.</span></span> <span data-ttu-id="c2837-113">Vous n’avez pas à déployer l’assembly d’interopérabilité avec votre application.</span><span class="sxs-lookup"><span data-stu-id="c2837-113">You do not have to deploy the interop assembly with your application.</span></span> <span data-ttu-id="c2837-114">Il s’agit de la technique recommandée.</span><span class="sxs-lookup"><span data-stu-id="c2837-114">This is the recommended technique.</span></span>

- <span data-ttu-id="c2837-115">En déployant des assemblys d’interopérabilité : vous pouvez créer une référence standard à l’assembly d’interopérabilité.</span><span class="sxs-lookup"><span data-stu-id="c2837-115">Deploying interop assemblies: You can create a standard reference to the interop assembly.</span></span> <span data-ttu-id="c2837-116">Dans ce cas, l’assembly d’interopérabilité doit être déployé avec votre application.</span><span class="sxs-lookup"><span data-stu-id="c2837-116">In this case, the interop assembly must be deployed with your application.</span></span> <span data-ttu-id="c2837-117">Si vous utilisez cette technique et que vous n’utilisez pas un composant COM privé, référencez toujours l’assembly PIA (Primary Interop Assembly) publié par l’auteur du composant COM que vous prévoyez d’incorporer dans votre code managé.</span><span class="sxs-lookup"><span data-stu-id="c2837-117">If you employ this technique, and you are not using a private COM component, always reference the primary interop assembly (PIA) published by the author of the COM component you intend to incorporate in your managed code.</span></span> <span data-ttu-id="c2837-118">Pour plus d’informations sur la production et l’utilisation d’assemblys PIA (Primary Interop Assembly), consultez [Assemblys PIA (Primary Interop Assembly)](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="c2837-118">For more information about producing and using primary interop assemblies, see [Primary Interop Assemblies](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/aax7sdch(v=vs.100)).</span></span>

<span data-ttu-id="c2837-119">Quand vous utilisez des assemblys d’interopérabilité au moment du design, vous pouvez incorporer les informations de type de l’assembly PIA publié par l’auteur du composant COM.</span><span class="sxs-lookup"><span data-stu-id="c2837-119">When you use design-time-only interop assemblies, you can embed type information from the primary interop assembly published by the author of the COM component.</span></span> <span data-ttu-id="c2837-120">Toutefois, vous n’avez pas à déployer l’assembly PIA avec votre application.</span><span class="sxs-lookup"><span data-stu-id="c2837-120">However, you do not have to deploy the primary interop assembly with your application.</span></span>

<span data-ttu-id="c2837-121">L’utilisation d’assemblys d’interopérabilité au moment du design réduit la taille de votre application, car la plupart des applications n’utilisent pas toutes les fonctionnalités d’un composant COM.</span><span class="sxs-lookup"><span data-stu-id="c2837-121">Using design-time-only interop assemblies reduces the size of your application, because most applications do not use all the features of a COM component.</span></span> <span data-ttu-id="c2837-122">Le compilateur est très efficace quand il incorpore les informations de type ; si votre application utilise uniquement certaines des méthodes sur une interface COM, le compilateur n’incorpore pas les méthodes inutilisées.</span><span class="sxs-lookup"><span data-stu-id="c2837-122">The compiler is very efficient when it embeds type information; if your application uses only some of the methods on a COM interface, the compiler does not embed the unused methods.</span></span> <span data-ttu-id="c2837-123">Lorsqu’une application qui a incorporé les informations de type interagit avec une autre application du même type, ou interagit avec une application qui utilise un assembly PIA, le common language runtime utilise des règles d’équivalence du type pour déterminer si deux types avec le même nom représentent le même type COM.</span><span class="sxs-lookup"><span data-stu-id="c2837-123">When an application that has embedded type information interacts with another such application, or interacts with an application that uses a primary interop assembly, the common language runtime uses type equivalence rules to determine whether two types with the same name represent the same COM type.</span></span> <span data-ttu-id="c2837-124">Vous n’avez pas à connaître ces règles pour utiliser des objets COM.</span><span class="sxs-lookup"><span data-stu-id="c2837-124">You do not have to know these rules to use COM objects.</span></span> <span data-ttu-id="c2837-125">Toutefois, si vous vous intéressez aux règles, consultez [Équivalence de type et types interop incorporés](type-equivalence-and-embedded-interop-types.md).</span><span class="sxs-lookup"><span data-stu-id="c2837-125">However, if you are interested in the rules, see [Type Equivalence and Embedded Interop Types](type-equivalence-and-embedded-interop-types.md).</span></span>

## <a name="generating-metadata"></a><span data-ttu-id="c2837-126">Génération de métadonnées</span><span class="sxs-lookup"><span data-stu-id="c2837-126">Generating Metadata</span></span>

<span data-ttu-id="c2837-127">Les bibliothèques de types COM peuvent être des fichiers autonomes qui ont une extension .tlb, comme Loanlib.tlb.</span><span class="sxs-lookup"><span data-stu-id="c2837-127">COM type libraries can be stand-alone files that have a .tlb extension, such as Loanlib.tlb.</span></span> <span data-ttu-id="c2837-128">Certaines bibliothèques de types sont incorporées dans la section de ressources d’un fichier .dll ou .exe.</span><span class="sxs-lookup"><span data-stu-id="c2837-128">Some type libraries are embedded in the resource section of a .dll or .exe file.</span></span> <span data-ttu-id="c2837-129">D’autres sources d’informations de bibliothèques de types sont les fichiers .olb et .ocx.</span><span class="sxs-lookup"><span data-stu-id="c2837-129">Other sources of type library information are .olb and .ocx files.</span></span>

<span data-ttu-id="c2837-130">Une fois que vous avez trouvé la bibliothèque de types qui contient l’implémentation de votre type COM cible, vous disposez des options suivantes pour générer un assembly d’interopérabilité contenant des métadonnées de type :</span><span class="sxs-lookup"><span data-stu-id="c2837-130">After you locate the type library that contains the implementation of your target COM type, you have the following options for generating an interop assembly containing type metadata:</span></span>

- <span data-ttu-id="c2837-131">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c2837-131">Visual Studio</span></span>

  <span data-ttu-id="c2837-132">Visual Studio convertit automatiquement des types COM dans une bibliothèque de types en métadonnées dans un assembly.</span><span class="sxs-lookup"><span data-stu-id="c2837-132">Visual Studio automatically converts COM types in a type library to metadata in an assembly.</span></span> <span data-ttu-id="c2837-133">Pour obtenir des instructions, consultez [Comment : ajouter des références aux bibliothèques de types](how-to-add-references-to-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="c2837-133">For instructions, see [How to: Add References to Type Libraries](how-to-add-references-to-type-libraries.md).</span></span>

- [<span data-ttu-id="c2837-134">Importateur de bibliothèques de types (Tlbimp.exe)</span><span class="sxs-lookup"><span data-stu-id="c2837-134">Type Library Importer (Tlbimp.exe)</span></span>](../tools/tlbimp-exe-type-library-importer.md)

  <span data-ttu-id="c2837-135">Cet importateur fournit des options de ligne de commande pour ajuster les métadonnées dans le fichier d’interopérabilité résultant, importe des types d’une bibliothèque de types existante et génère un assembly d’interopérabilité et un espace de noms.</span><span class="sxs-lookup"><span data-stu-id="c2837-135">The Type Library Importer provides command-line options to adjust metadata in the resulting interop file, imports types from an existing type library, and generates an interop assembly and a namespace.</span></span> <span data-ttu-id="c2837-136">Pour obtenir des instructions, consultez [Guide pratique pour générer des assemblys d’interopérabilité à partir de bibliothèques de types](how-to-generate-interop-assemblies-from-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="c2837-136">For instructions, see [How to: Generate Interop Assemblies from Type Libraries](how-to-generate-interop-assemblies-from-type-libraries.md).</span></span>

- <span data-ttu-id="c2837-137">Classe <xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="c2837-137"><xref:System.Runtime.InteropServices.TypeLibConverter?displayProperty=nameWithType> class</span></span>

  <span data-ttu-id="c2837-138">Cette classe fournit des méthodes pour convertir des coclasses et des interfaces dans une bibliothèque de types en métadonnées dans un assembly.</span><span class="sxs-lookup"><span data-stu-id="c2837-138">This class provides methods to convert coclasses and interfaces in a type library to metadata within an assembly.</span></span> <span data-ttu-id="c2837-139">Elle produit la même sortie de métadonnées que Tlbimp.exe.</span><span class="sxs-lookup"><span data-stu-id="c2837-139">It produces the same metadata output as Tlbimp.exe.</span></span> <span data-ttu-id="c2837-140">Toutefois, la classe <xref:System.Runtime.InteropServices.TypeLibConverter> peut convertir une bibliothèque de types en mémoire en métadonnées contrairement à Tlbimp.exe.</span><span class="sxs-lookup"><span data-stu-id="c2837-140">However, unlike Tlbimp.exe, the <xref:System.Runtime.InteropServices.TypeLibConverter> class can convert an in-memory type library to metadata.</span></span>

- <span data-ttu-id="c2837-141">Wrappers personnalisés</span><span class="sxs-lookup"><span data-stu-id="c2837-141">Custom wrappers</span></span>

  <span data-ttu-id="c2837-142">Quand une bibliothèque de types est indisponible ou incorrecte, vous pouvez opter pour la création d’une définition dupliquée de la classe ou de l’interface dans du code source managé.</span><span class="sxs-lookup"><span data-stu-id="c2837-142">When a type library is unavailable or incorrect, one option is to create a duplicate definition of the class or interface in managed source code.</span></span> <span data-ttu-id="c2837-143">Vous pouvez ensuite compiler le code source avec un compilateur qui cible le runtime pour produire des métadonnées dans un assembly.</span><span class="sxs-lookup"><span data-stu-id="c2837-143">You then compile the source code with a compiler that targets the runtime to produce metadata in an assembly.</span></span>

  <span data-ttu-id="c2837-144">Pour définir manuellement des types COM, vous devez avoir accès aux éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="c2837-144">To define COM types manually, you must have access to the following items:</span></span>

  - <span data-ttu-id="c2837-145">des descriptions précises des coclasses et des interfaces qui sont définies ;</span><span class="sxs-lookup"><span data-stu-id="c2837-145">Precise descriptions of the coclasses and interfaces being defined.</span></span>

  - <span data-ttu-id="c2837-146">un compilateur, tel que le compilateur C#, pouvant générer les définitions des classes .NET Framework appropriées ;</span><span class="sxs-lookup"><span data-stu-id="c2837-146">A compiler, such as the C# compiler, that can generate the appropriate .NET Framework class definitions.</span></span>

  - <span data-ttu-id="c2837-147">une connaissance des règles de conversion de bibliothèque de types en assembly.</span><span class="sxs-lookup"><span data-stu-id="c2837-147">Knowledge of the type library-to-assembly conversion rules.</span></span>

  <span data-ttu-id="c2837-148">L’écriture d’un wrapper personnalisé est une technique avancée.</span><span class="sxs-lookup"><span data-stu-id="c2837-148">Writing a custom wrapper is an advanced technique.</span></span> <span data-ttu-id="c2837-149">Pour obtenir des informations supplémentaires sur la manière de générer un wrapper personnalisé, consultez [Personnalisation de wrappers standard](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="c2837-149">For additional information about how to generate a custom wrapper, see [Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100)).</span></span>

 <span data-ttu-id="c2837-150">Pour plus d’informations sur le processus d’importation COM Interop, consultez [Résumé de la conversion d’une bibliothèque de types en assembly](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="c2837-150">For more information about the COM interop import process, see [Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100)).</span></span>

## <a name="see-also"></a><span data-ttu-id="c2837-151">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c2837-151">See also</span></span>

- <xref:System.Runtime.InteropServices.TypeLibConverter>
- [<span data-ttu-id="c2837-152">Exposition de composants COM au .NET Framework</span><span class="sxs-lookup"><span data-stu-id="c2837-152">Exposing COM Components to the .NET Framework</span></span>](exposing-com-components.md)
- <span data-ttu-id="c2837-153">[Récapitulatif de la conversion d’une bibliothèque de types en assembly](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="c2837-153">[Type Library to Assembly Conversion Summary](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/k83zzh38(v=vs.100))</span></span>
- [<span data-ttu-id="c2837-154">Tlbimp.exe (importateur de bibliothèques de types)</span><span class="sxs-lookup"><span data-stu-id="c2837-154">Tlbimp.exe (Type Library Importer)</span></span>](../tools/tlbimp-exe-type-library-importer.md)
- <span data-ttu-id="c2837-155">[Personnaliser des wrappers standard](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="c2837-155">[Customizing Standard Wrappers](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/h7hx9abd(v=vs.100))</span></span>
- <span data-ttu-id="c2837-156">[Utiliser des types COM dans du code managé](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="c2837-156">[Using COM Types in Managed Code](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/3y76b69k(v=vs.100))</span></span>
- [<span data-ttu-id="c2837-157">Compilation d'un projet d'interopérabilité</span><span class="sxs-lookup"><span data-stu-id="c2837-157">Compiling an Interop Project</span></span>](compiling-an-interop-project.md)
- [<span data-ttu-id="c2837-158">Déploiement d'une application d'interopérabilité</span><span class="sxs-lookup"><span data-stu-id="c2837-158">Deploying an Interop Application</span></span>](deploying-an-interop-application.md)
- [<span data-ttu-id="c2837-159">Procédure : ajouter des références aux bibliothèques de types</span><span class="sxs-lookup"><span data-stu-id="c2837-159">How to: Add References to Type Libraries</span></span>](how-to-add-references-to-type-libraries.md)
- [<span data-ttu-id="c2837-160">Procédure : générer des assemblys d’interopérabilité à partir de bibliothèques de types</span><span class="sxs-lookup"><span data-stu-id="c2837-160">How to: Generate Interop Assemblies from Type Libraries</span></span>](how-to-generate-interop-assemblies-from-type-libraries.md)

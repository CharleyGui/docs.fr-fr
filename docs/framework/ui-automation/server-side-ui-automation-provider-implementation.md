---
title: Implémentation de fournisseur UI Automation côté serveur
ms.date: 03/30/2017
helpviewer_keywords:
- server-side UI Automation provider implementation
- UI Automation, server-side provider implementation
- provider implementation, UI Automation
ms.assetid: 6acc6d08-bd67-4e2e-915c-9c1d34eb86fe
ms.openlocfilehash: 25f22d5e8caacc69643f6d79e109ebaa94159d80
ms.sourcegitcommit: 7bc6887ab658550baa78f1520ea735838249345e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/03/2020
ms.locfileid: "75632309"
---
# <a name="server-side-ui-automation-provider-implementation"></a><span data-ttu-id="a8330-102">Implémentation de fournisseur UI Automation côté serveur</span><span class="sxs-lookup"><span data-stu-id="a8330-102">Server-Side UI Automation Provider Implementation</span></span>

> [!NOTE]
> <span data-ttu-id="a8330-103">Cette documentation s'adresse aux développeurs .NET Framework qui souhaitent utiliser les classes [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] managées définies dans l'espace de noms <xref:System.Windows.Automation>.</span><span class="sxs-lookup"><span data-stu-id="a8330-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="a8330-104">Pour obtenir les dernières informations sur [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], consultez [API Windows Automation : UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="a8330-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="a8330-105">Cette section explique comment implémenter un fournisseur UI Automation côté serveur pour un contrôle personnalisé.</span><span class="sxs-lookup"><span data-stu-id="a8330-105">This section describes how to implement a server-side UI Automation provider for a custom control.</span></span>

<span data-ttu-id="a8330-106">L’implémentation pour les éléments Windows Presentation Foundation (WPF) et les éléments non WPF (tels que ceux conçus pour [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]) est fondamentalement différente.</span><span class="sxs-lookup"><span data-stu-id="a8330-106">The implementation for Windows Presentation Foundation (WPF) elements and non-WPF elements (such as those designed for [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]) is fundamentally different.</span></span> <span data-ttu-id="a8330-107">Les éléments WPF assurent la prise en charge de [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] par le biais d’une classe dérivée de <xref:System.Windows.Automation.Peers.AutomationPeer>.</span><span class="sxs-lookup"><span data-stu-id="a8330-107">WPF elements provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] through a class derived from <xref:System.Windows.Automation.Peers.AutomationPeer>.</span></span> <span data-ttu-id="a8330-108">Les éléments non-WPF assurent la prise en charge via des implémentations d’interfaces de fournisseur.</span><span class="sxs-lookup"><span data-stu-id="a8330-108">Non-WPF elements provide support through implementations of provider interfaces.</span></span>

<a name="Security_Considerations"></a>

## <a name="security-considerations"></a><span data-ttu-id="a8330-109">Considérations sur la sécurité</span><span class="sxs-lookup"><span data-stu-id="a8330-109">Security Considerations</span></span>

<span data-ttu-id="a8330-110">Les fournisseurs doivent être écrits de manière à pouvoir travailler dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="a8330-110">Providers should be written so that they can work in a partial-trust environment.</span></span> <span data-ttu-id="a8330-111">Étant donné qu'UIAutomationClient.dll n'est pas configuré pour s'exécuter avec un niveau de confiance partielle, le code de votre fournisseur ne doit pas référencer cet assembly.</span><span class="sxs-lookup"><span data-stu-id="a8330-111">Because UIAutomationClient.dll is not configured to run under partial trust, your provider code should not reference that assembly.</span></span> <span data-ttu-id="a8330-112">S'il le fait, le code risque de s'exécuter dans un environnement de confiance totale mais d'échouer dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="a8330-112">If it does so, the code may run in a full-trust environment but then fail in a partial-trust environment.</span></span>

<span data-ttu-id="a8330-113">En particulier, n'utilisez pas de champs provenant de classes d'UIAutomationClient.dll, tels que ceux d' <xref:System.Windows.Automation.AutomationElement>.</span><span class="sxs-lookup"><span data-stu-id="a8330-113">In particular, do not use fields from classes in UIAutomationClient.dll such as those in <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="a8330-114">Utilisez plutôt les champs de classes équivalents, tels que les <xref:System.Windows.Automation.AutomationElementIdentifiers>, dans UIAutomationTypes.dll.</span><span class="sxs-lookup"><span data-stu-id="a8330-114">Instead, use the equivalent fields from classes in UIAutomationTypes.dll, such as <xref:System.Windows.Automation.AutomationElementIdentifiers>.</span></span>

<a name="Provider_Implementation_by_WPF_Elements"></a>

## <a name="provider-implementation-by-windows-presentation-foundation-elements"></a><span data-ttu-id="a8330-115">Implémentation de fournisseur par les éléments Windows Presentation Foundation</span><span class="sxs-lookup"><span data-stu-id="a8330-115">Provider Implementation by Windows Presentation Foundation Elements</span></span>

<span data-ttu-id="a8330-116">Pour plus d'informations sur ce sujet, consultez [UI Automation d'un contrôle personnalisé WPF](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span><span class="sxs-lookup"><span data-stu-id="a8330-116">For more information on this topic, please see [UI Automation of a WPF Custom Control](../wpf/controls/ui-automation-of-a-wpf-custom-control.md).</span></span>

<a name="Provider_Implementation_by_non_WPF_Elements"></a>

## <a name="provider-implementation-by-non-wpf-elements"></a><span data-ttu-id="a8330-117">Implémentation de fournisseur par des éléments non-WPF</span><span class="sxs-lookup"><span data-stu-id="a8330-117">Provider Implementation by non-WPF Elements</span></span>

<span data-ttu-id="a8330-118">Les contrôles personnalisés qui ne font pas partie de l’infrastructure WPF, mais qui sont écrits en code managé (le plus souvent, il s’agit de contrôles [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]), assurent la prise en charge de [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] en implémentant des interfaces.</span><span class="sxs-lookup"><span data-stu-id="a8330-118">Custom controls that are not part of the WPF framework, but that are written in managed code (most often these are [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] controls), provide support for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] by implementing interfaces.</span></span> <span data-ttu-id="a8330-119">Chaque élément doit implémenter au moins une des interfaces répertoriées dans le premier tableau de la section suivante.</span><span class="sxs-lookup"><span data-stu-id="a8330-119">Every element must implement at least one of the interfaces listed in the first table in the next section.</span></span> <span data-ttu-id="a8330-120">De plus, si l'élément prend en charge un ou plusieurs modèles de contrôle, il doit implémenter l'interface appropriée pour chaque modèle de contrôle.</span><span class="sxs-lookup"><span data-stu-id="a8330-120">In addition, if the element supports one or more control patterns, it must implement the appropriate interface for each control pattern.</span></span>

<span data-ttu-id="a8330-121">Le projet de votre fournisseur [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] doit référencer les assemblys suivants :</span><span class="sxs-lookup"><span data-stu-id="a8330-121">Your [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider project must reference the following assemblies:</span></span>

- <span data-ttu-id="a8330-122">UIAutomationProviders.dll</span><span class="sxs-lookup"><span data-stu-id="a8330-122">UIAutomationProviders.dll</span></span>

- <span data-ttu-id="a8330-123">UIAutomationTypes.dll</span><span class="sxs-lookup"><span data-stu-id="a8330-123">UIAutomationTypes.dll</span></span>

- <span data-ttu-id="a8330-124">WindowsBase.dll</span><span class="sxs-lookup"><span data-stu-id="a8330-124">WindowsBase.dll</span></span>

<a name="Provider_Interfaces"></a>

### <a name="provider-interfaces"></a><span data-ttu-id="a8330-125">Interfaces de fournisseur</span><span class="sxs-lookup"><span data-stu-id="a8330-125">Provider Interfaces</span></span>

<span data-ttu-id="a8330-126">Chaque fournisseur [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] doit implémenter l'une des interfaces suivantes.</span><span class="sxs-lookup"><span data-stu-id="a8330-126">Every [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] provider must implement one of the following interfaces.</span></span>

|<span data-ttu-id="a8330-127">Interface</span><span class="sxs-lookup"><span data-stu-id="a8330-127">Interface</span></span>|<span data-ttu-id="a8330-128">Description</span><span class="sxs-lookup"><span data-stu-id="a8330-128">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderSimple>|<span data-ttu-id="a8330-129">Fournit les fonctionnalités pour un contrôle simple hébergé dans une fenêtre, y compris une prise en charge pour les modèles de contrôle et les propriétés.</span><span class="sxs-lookup"><span data-stu-id="a8330-129">Provides functionality for a simple control hosted in a window, including support for control patterns and properties.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragment>|<span data-ttu-id="a8330-130">Hérite de <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span><span class="sxs-lookup"><span data-stu-id="a8330-130">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple>.</span></span> <span data-ttu-id="a8330-131">Ajoute des fonctionnalités pour un élément d'un contrôle complexe, y compris celles permettant de naviguer dans le fragment, de définir le focus et de retourner le rectangle englobant de l'élément.</span><span class="sxs-lookup"><span data-stu-id="a8330-131">Adds functionality for an element in a complex control, including navigation within the fragment, setting focus, and returning the bounding rectangle of the element.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>|<span data-ttu-id="a8330-132">Hérite de <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span><span class="sxs-lookup"><span data-stu-id="a8330-132">Inherits from <xref:System.Windows.Automation.Provider.IRawElementProviderFragment>.</span></span> <span data-ttu-id="a8330-133">Ajoute des fonctionnalités pour l'élément racine d'un contrôle complexe, y compris la localisation d'un élément enfant à des coordonnées spécifiées et la définition de l'état du focus pour l'ensemble du contrôle.</span><span class="sxs-lookup"><span data-stu-id="a8330-133">Adds functionality for the root element in a complex control, including locating a child element at specified coordinates and setting the focus state for the entire control.</span></span>|

<span data-ttu-id="a8330-134">Les interfaces suivantes fournissent des fonctionnalités supplémentaires, mais leur implémentation n'est pas obligatoire.</span><span class="sxs-lookup"><span data-stu-id="a8330-134">The following interfaces provide added functionality but are not required to be implemented.</span></span>

|<span data-ttu-id="a8330-135">Interface</span><span class="sxs-lookup"><span data-stu-id="a8330-135">Interface</span></span>|<span data-ttu-id="a8330-136">Description</span><span class="sxs-lookup"><span data-stu-id="a8330-136">Description</span></span>|
|---------------|-----------------|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="a8330-137">Permet au fournisseur de suivre des demandes pour des événements.</span><span class="sxs-lookup"><span data-stu-id="a8330-137">Enables the provider to track requests for events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride>|<span data-ttu-id="a8330-138">Active le repositionnement d’éléments basés sur une fenêtre dans l’arborescence [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] d’un fragment.</span><span class="sxs-lookup"><span data-stu-id="a8330-138">Enables repositioning of window-based elements within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree of a fragment.</span></span>|

<span data-ttu-id="a8330-139">Toutes les autres interfaces de l’espace de noms <xref:System.Windows.Automation.Provider> concernent la prise en charge du modèle de contrôle.</span><span class="sxs-lookup"><span data-stu-id="a8330-139">All other interfaces in the <xref:System.Windows.Automation.Provider> namespace are for control pattern support.</span></span>

<a name="Requirements_for_Non_WPF_Providers"></a>

### <a name="requirements-for-non-wpf-providers"></a><span data-ttu-id="a8330-140">Spécifications pour les fournisseurs non-WPF</span><span class="sxs-lookup"><span data-stu-id="a8330-140">Requirements for Non-WPF Providers</span></span>

<span data-ttu-id="a8330-141">Pour communiquer avec [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], votre contrôle doit implémenter les principaux domaines de fonctionnalités suivants :</span><span class="sxs-lookup"><span data-stu-id="a8330-141">In order to communicate with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], your control must implement the following main areas of functionality:</span></span>

|<span data-ttu-id="a8330-142">Fonctionnalité</span><span class="sxs-lookup"><span data-stu-id="a8330-142">Functionality</span></span>|<span data-ttu-id="a8330-143">Implémentation</span><span class="sxs-lookup"><span data-stu-id="a8330-143">Implementation</span></span>|
|-------------------|--------------------|
|<span data-ttu-id="a8330-144">Exposer le fournisseur à [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span><span class="sxs-lookup"><span data-stu-id="a8330-144">Expose the provider to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]</span></span>|<span data-ttu-id="a8330-145">En réponse à un message WM_GETOBJECT envoyé à la fenêtre de contrôle, retournez l'objet qui implémente <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (ou une interface dérivée).</span><span class="sxs-lookup"><span data-stu-id="a8330-145">In response to a WM_GETOBJECT message sent to the control window, return the object that implements <xref:System.Windows.Automation.Provider.IRawElementProviderSimple> (or a derived interface).</span></span> <span data-ttu-id="a8330-146">Pour les fragments, il doit s'agir du fournisseur pour la racine du fragment.</span><span class="sxs-lookup"><span data-stu-id="a8330-146">For fragments, this must be the provider for the fragment root.</span></span>|
|<span data-ttu-id="a8330-147">Fournir des valeurs de propriété</span><span class="sxs-lookup"><span data-stu-id="a8330-147">Provide property values</span></span>|<span data-ttu-id="a8330-148">Implémentez <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> pour fournir ou substituer des valeurs.</span><span class="sxs-lookup"><span data-stu-id="a8330-148">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPropertyValue%2A> to provide or override values.</span></span>|
|<span data-ttu-id="a8330-149">Permettre au client d'interagir avec le contrôle</span><span class="sxs-lookup"><span data-stu-id="a8330-149">Enable the client to interact with the control</span></span>|<span data-ttu-id="a8330-150">Implémentez des interfaces qui prennent en charge des modèles de contrôle, tels qu’ <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span><span class="sxs-lookup"><span data-stu-id="a8330-150">Implement interfaces that support control patterns, such as <xref:System.Windows.Automation.Provider.IInvokeProvider>.</span></span> <span data-ttu-id="a8330-151">Retournez ces fournisseurs de modèles dans votre implémentation de <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span><span class="sxs-lookup"><span data-stu-id="a8330-151">Return these pattern providers in your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.GetPatternProvider%2A>.</span></span>|
|<span data-ttu-id="a8330-152">Déclencher des événements</span><span class="sxs-lookup"><span data-stu-id="a8330-152">Raise events</span></span>|<span data-ttu-id="a8330-153">Appelez une des méthodes statiques d' <xref:System.Windows.Automation.Provider.AutomationInteropProvider> pour déclencher un événement que le client pourra écouter.</span><span class="sxs-lookup"><span data-stu-id="a8330-153">Call one of the static methods of <xref:System.Windows.Automation.Provider.AutomationInteropProvider> to raise an event that a client can listen for.</span></span>|
|<span data-ttu-id="a8330-154">Activer la navigation et le focus dans un fragment</span><span class="sxs-lookup"><span data-stu-id="a8330-154">Enable navigation and focusing within a fragment</span></span>|<span data-ttu-id="a8330-155">Implémentez <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> pour chaque élément du fragment</span><span class="sxs-lookup"><span data-stu-id="a8330-155">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment> for each element within the fragment.</span></span> <span data-ttu-id="a8330-156">(sauf pour les éléments qui ne font pas partie d'un fragment).</span><span class="sxs-lookup"><span data-stu-id="a8330-156">(Not necessary for elements that are not part of a fragment.)</span></span>|
|<span data-ttu-id="a8330-157">Activer le focus et l'emplacement d'un élément enfant dans un fragment</span><span class="sxs-lookup"><span data-stu-id="a8330-157">Enable focusing and location of child element in a fragment</span></span>|<span data-ttu-id="a8330-158">Implémentez <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span><span class="sxs-lookup"><span data-stu-id="a8330-158">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragmentRoot>.</span></span> <span data-ttu-id="a8330-159">(Sauf pour les éléments qui ne sont pas des racines de fragment.)</span><span class="sxs-lookup"><span data-stu-id="a8330-159">(Not necessary for elements that are not fragment roots.)</span></span>|

<a name="Property_Values_in_Non_WPF_Providers"></a>

### <a name="property-values-in-non-wpf-providers"></a><span data-ttu-id="a8330-160">Valeurs de la propriété dans les fournisseurs non-WPF</span><span class="sxs-lookup"><span data-stu-id="a8330-160">Property Values in Non-WPF Providers</span></span>

<span data-ttu-id="a8330-161">Les fournisseurs[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] pour les contrôles personnalisés doivent prendre en charge certaines propriétés qui peuvent être utilisées aussi bien par le système d'automatisation que par les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="a8330-161">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] providers for custom controls must support certain properties that can be used by the automation system as well as by client applications.</span></span> <span data-ttu-id="a8330-162">Pour les éléments hébergés dans des fenêtres (HWND), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] peut récupérer certaines propriétés depuis un fournisseur de fenêtre par défaut, mais doit en obtenir d'autres du fournisseur personnalisé.</span><span class="sxs-lookup"><span data-stu-id="a8330-162">For elements that are hosted in windows (HWNDs), [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] can retrieve some properties from the default window provider, but must obtain others from the custom provider.</span></span>

<span data-ttu-id="a8330-163">Habituellement, les fournisseurs de contrôles basés sur HWND n'ont pas besoin de fournir les propriétés suivantes (identifiées par des valeurs de champ) :</span><span class="sxs-lookup"><span data-stu-id="a8330-163">Providers for HWND based controls do not usually need to provide the following properties (identified by field values):</span></span>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClickablePointProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ProcessIdProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.ClassNameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.HasKeyboardFocusProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsEnabledProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.IsPasswordProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>

- <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty>

> [!NOTE]
> <span data-ttu-id="a8330-164">La <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> d'un simple élément ou d'une racine de fragment hébergé dans une fenêtre est obtenue depuis la fenêtre ; toutefois, les éléments fragments sous la racine (tels que des éléments de liste dans une zone de liste) doivent fournir leurs propres identificateurs.</span><span class="sxs-lookup"><span data-stu-id="a8330-164">The <xref:System.Windows.Automation.AutomationElementIdentifiers.RuntimeIdProperty> of a simple element or fragment root hosted in a window is obtained from the window; however, fragment elements below the root (such as list items in a list box) must provide their own identifiers.</span></span> <span data-ttu-id="a8330-165">Pour plus d'informations, consultez <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span><span class="sxs-lookup"><span data-stu-id="a8330-165">For more information, see <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.GetRuntimeId%2A>.</span></span>
>
> <span data-ttu-id="a8330-166">La <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> doit être retournée pour les fournisseurs hébergés dans un contrôle [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a8330-166">The <xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty> should be returned for providers hosted in a [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)] control.</span></span> <span data-ttu-id="a8330-167">Dans ce cas, le fournisseur de fenêtre par défaut ne pourra peut-être pas récupérer la bonne valeur.</span><span class="sxs-lookup"><span data-stu-id="a8330-167">In this case, the default window provider may be unable to retrieve the correct value.</span></span>
>
> <span data-ttu-id="a8330-168">La <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> est généralement fournie par le fournisseur hôte.</span><span class="sxs-lookup"><span data-stu-id="a8330-168">The <xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> is usually supplied by the host provider.</span></span> <span data-ttu-id="a8330-169">Par exemple, si un contrôle personnalisé est dérivé de <xref:System.Windows.Forms.Control>, le nom est dérivé de la propriété `Text` du contrôle.</span><span class="sxs-lookup"><span data-stu-id="a8330-169">For example, if a custom control is derived from <xref:System.Windows.Forms.Control>, the name is derived from the `Text` property of the control.</span></span>

<span data-ttu-id="a8330-170">Pour obtenir un exemple de code, consultez [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span><span class="sxs-lookup"><span data-stu-id="a8330-170">For example code, see [Return Properties from a UI Automation Provider](return-properties-from-a-ui-automation-provider.md).</span></span>

<a name="Events_in_Non_WPF_Providers"></a>

### <a name="events-in-non-wpf-providers"></a><span data-ttu-id="a8330-171">Événements dans les fournisseurs non-WPF</span><span class="sxs-lookup"><span data-stu-id="a8330-171">Events in Non-WPF Providers</span></span>

<span data-ttu-id="a8330-172">Les fournisseurs[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] doivent déclencher des événements pour informer les applications clientes des modifications de l'état de l'interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="a8330-172">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] providers should raise events to notify client applications of changes in the state of the UI.</span></span> <span data-ttu-id="a8330-173">Les méthodes suivantes sont utilisées pour déclencher des événements.</span><span class="sxs-lookup"><span data-stu-id="a8330-173">The following methods are used to raise events.</span></span>

|<span data-ttu-id="a8330-174">Méthode</span><span class="sxs-lookup"><span data-stu-id="a8330-174">Method</span></span>|<span data-ttu-id="a8330-175">Description</span><span class="sxs-lookup"><span data-stu-id="a8330-175">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationEvent%2A>|<span data-ttu-id="a8330-176">Déclenche différents événements, y compris les événements déclenchés par les modèles de contrôle.</span><span class="sxs-lookup"><span data-stu-id="a8330-176">Raises various events, including events triggered by control patterns.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseAutomationPropertyChangedEvent%2A>|<span data-ttu-id="a8330-177">Déclenche un événement quand une propriété [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] a été modifiée.</span><span class="sxs-lookup"><span data-stu-id="a8330-177">Raises an event when a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property has changed.</span></span>|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.RaiseStructureChangedEvent%2A>|<span data-ttu-id="a8330-178">Déclenche un événement quand la structure de l'arborescence [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] a été modifiée ; par exemple, à l'occasion de la suppression ou de l'ajout d'un élément.</span><span class="sxs-lookup"><span data-stu-id="a8330-178">Raises an event when the structure of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree has changed; for example, by the removal or addition of an element.</span></span>|

<span data-ttu-id="a8330-179">Le but d'un événement est d'informer le client que quelque chose est en train de se passer dans l' [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], que l'activité soit ou non déclenchée par le système [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] lui-même.</span><span class="sxs-lookup"><span data-stu-id="a8330-179">The purpose of an event is to notify the client of something taking place in the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)], whether or not the activity is triggered by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] system itself.</span></span> <span data-ttu-id="a8330-180">Par exemple, l'événement identifié par <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> doit être déclenché chaque fois que le contrôle est appelé, via l'entrée d'utilisateur directe ou par l'application cliente appelant <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span><span class="sxs-lookup"><span data-stu-id="a8330-180">For example, the event identified by <xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent> should be raised whenever the control is invoked, either through direct user input or by the client application calling <xref:System.Windows.Automation.InvokePattern.Invoke%2A>.</span></span>

<span data-ttu-id="a8330-181">Pour optimiser les performances, un fournisseur peut déclencher des événements de manière sélective ou ne pas en déclencher du tout si aucune application cliente n'est enregistrée pour les recevoir.</span><span class="sxs-lookup"><span data-stu-id="a8330-181">To optimize performance, a provider can selectively raise events, or raise no events at all if no client application is registered to receive them.</span></span> <span data-ttu-id="a8330-182">Les méthodes suivantes sont utilisées pour l'optimisation.</span><span class="sxs-lookup"><span data-stu-id="a8330-182">The following methods are used for optimization.</span></span>

|<span data-ttu-id="a8330-183">Méthode</span><span class="sxs-lookup"><span data-stu-id="a8330-183">Method</span></span>|<span data-ttu-id="a8330-184">Description</span><span class="sxs-lookup"><span data-stu-id="a8330-184">Description</span></span>|
|------------|-----------------|
|<xref:System.Windows.Automation.Provider.AutomationInteropProvider.ClientsAreListening%2A>|<span data-ttu-id="a8330-185">Cette propriété statique spécifie si des applications clientes se sont abonnées à des événements [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a8330-185">This static property specifies whether any client applications have subscribed to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events.</span></span>|
|<xref:System.Windows.Automation.Provider.IRawElementProviderAdviseEvents>|<span data-ttu-id="a8330-186">L'implémentation de cette interface par le fournisseur sur une racine de fragment lui permet d'être avertie quand des clients enregistrent et annulent l'enregistrement de gestionnaires d'événements pour les événements situés sur le fragment.</span><span class="sxs-lookup"><span data-stu-id="a8330-186">The provider's implementation of this interface on a fragment root enables it to be advised when clients register and unregister event handlers for events on the fragment.</span></span>|

<a name="Non_WPF_Provider_Navigation"></a>

### <a name="non-wpf-provider-navigation"></a><span data-ttu-id="a8330-187">Navigation d'un fournisseur non-WPF</span><span class="sxs-lookup"><span data-stu-id="a8330-187">Non-WPF Provider Navigation</span></span>

<span data-ttu-id="a8330-188">Les fournisseurs de simples contrôles tels qu'un bouton personnalisé hébergé dans une fenêtre (HWND) n'ont pas besoin de prendre en charge la navigation dans l'arborescence [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="a8330-188">Providers for simple controls such as a custom button hosted in a window (HWND) do not need to support navigation within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree.</span></span> <span data-ttu-id="a8330-189">La navigation vers et depuis l'élément est contrôlée par le fournisseur par défaut de la fenêtre hôte, ce qui est spécifié dans l'implémentation de <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span><span class="sxs-lookup"><span data-stu-id="a8330-189">Navigation to and from the element is handled by the default provider for the host window, which is specified in the implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>.</span></span> <span data-ttu-id="a8330-190">Quand vous implémentez un fournisseur pour un contrôle personnalisé complexe, vous devez toutefois prendre en charge la navigation entre le nœud racine du fragment et ses descendants, et entre nœuds frères.</span><span class="sxs-lookup"><span data-stu-id="a8330-190">When you implement a provider for a complex custom control, however, you must support navigation between the root node of the fragment and its descendants, and between sibling nodes.</span></span>

> [!NOTE]
> <span data-ttu-id="a8330-191">Les éléments d'un fragment autre que la racine doivent retourner une référence `null` depuis <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, car ils ne sont pas hébergés directement dans une fenêtre et aucun fournisseur par défaut ne peut prendre en charge la navigation vers et depuis ces éléments.</span><span class="sxs-lookup"><span data-stu-id="a8330-191">Elements of a fragment other than the root must return a `null` reference  from <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, because they are not directly hosted in a window, and no default provider can support navigation to and from them.</span></span>

<span data-ttu-id="a8330-192">La structure du fragment est déterminée par votre implémentation de <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span><span class="sxs-lookup"><span data-stu-id="a8330-192">The structure of the fragment is determined by your implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A>.</span></span> <span data-ttu-id="a8330-193">Pour chaque direction possible à partir de chaque fragment, cette méthode retourne l'objet fournisseur de l'élément dans cette direction.</span><span class="sxs-lookup"><span data-stu-id="a8330-193">For each possible direction from each fragment, this method returns the provider object for the element in that direction.</span></span> <span data-ttu-id="a8330-194">S'il n'y a aucun élément dans cette direction, la méthode retourne une référence `null` .</span><span class="sxs-lookup"><span data-stu-id="a8330-194">If there is no element in that direction, the method returns a `null` reference.</span></span>

<span data-ttu-id="a8330-195">La racine du fragment ne prend en charge la navigation que vers les éléments enfants.</span><span class="sxs-lookup"><span data-stu-id="a8330-195">The fragment root supports navigation only to child elements.</span></span> <span data-ttu-id="a8330-196">Par exemple, une zone de liste retourne le premier élément de la liste quand la direction est <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>, et le dernier élément quand la direction est <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span><span class="sxs-lookup"><span data-stu-id="a8330-196">For example, a list box returns the first item in the list when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.FirstChild>, and the last item when the direction is <xref:System.Windows.Automation.Provider.NavigateDirection.LastChild>.</span></span> <span data-ttu-id="a8330-197">La racine du fragment ne prend pas en charge la navigation vers un parent ou des frères ; cela est géré par le fournisseur de fenêtre hôte.</span><span class="sxs-lookup"><span data-stu-id="a8330-197">The fragment root does not support navigation to a parent or siblings; this is handled by the host window provider.</span></span>

<span data-ttu-id="a8330-198">Les éléments d'un fragment qui ne sont pas la racine doivent prendre en charge la navigation vers le parent et tous leurs frères et enfants.</span><span class="sxs-lookup"><span data-stu-id="a8330-198">Elements of a fragment that are not the root must support navigation to the parent, and to any siblings and children they have.</span></span>

<a name="Non_WPF_Provider_Reparenting"></a>

### <a name="non-wpf-provider-reparenting"></a><span data-ttu-id="a8330-199">Définition de l'état de parent d'un fournisseur non-WPF</span><span class="sxs-lookup"><span data-stu-id="a8330-199">Non-WPF Provider Reparenting</span></span>

<span data-ttu-id="a8330-200">Les fenêtres indépendantes sont en fait des fenêtres de niveau supérieur ; elles apparaissent donc par défaut dans l'arborescence [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] en tant qu'enfants du bureau.</span><span class="sxs-lookup"><span data-stu-id="a8330-200">Pop-up windows are actually top-level windows, and so by default appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree as children of the desktop.</span></span> <span data-ttu-id="a8330-201">Dans de nombreux cas, toutefois, les fenêtres indépendantes sont logiquement des enfants d'autres contrôles.</span><span class="sxs-lookup"><span data-stu-id="a8330-201">In many cases, however, pop-up windows are logically children of some other control.</span></span> <span data-ttu-id="a8330-202">Par exemple, la liste déroulante d'une zone de liste modifiable est logiquement un enfant de la zone de liste modifiable.</span><span class="sxs-lookup"><span data-stu-id="a8330-202">For example, the drop-down list of a combo box is logically a child of the combo box.</span></span> <span data-ttu-id="a8330-203">De la même façon, une fenêtre indépendante de menu est logiquement un enfant du menu.</span><span class="sxs-lookup"><span data-stu-id="a8330-203">Similarly, a menu pop-up window is logically a child of the menu.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="a8330-204">assure la prise en charge permettant de définir un nouveau parent pour les fenêtres indépendantes afin qu'elles apparaissent en tant qu'enfants du contrôle associé.</span><span class="sxs-lookup"><span data-stu-id="a8330-204">provides support to reparent pop-up windows so that they appear to be children of the associated control.</span></span>

<span data-ttu-id="a8330-205">Pour définir l'état de changement de parent d'une fenêtre indépendante :</span><span class="sxs-lookup"><span data-stu-id="a8330-205">To reparent a pop-up window:</span></span>

1. <span data-ttu-id="a8330-206">Créez un fournisseur pour la fenêtre indépendante.</span><span class="sxs-lookup"><span data-stu-id="a8330-206">Create a provider for the pop-up window.</span></span> <span data-ttu-id="a8330-207">Pour cela, il faut que la classe de la fenêtre indépendante soit connue à l'avance.</span><span class="sxs-lookup"><span data-stu-id="a8330-207">This requires that the class of the pop-up window is known in advance.</span></span>

2. <span data-ttu-id="a8330-208">Implémentez toutes les propriétés et tous les modèles habituels pour cette fenêtre, comme s'il s'agissait d'un contrôle.</span><span class="sxs-lookup"><span data-stu-id="a8330-208">Implement all properties and patterns as usual for that pop-up, as though it were a control in its own right.</span></span>

3. <span data-ttu-id="a8330-209">Implémentez la propriété <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> pour qu'elle retourne la valeur obtenue depuis <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, où le paramètre est le handle de fenêtre de la fenêtre indépendante.</span><span class="sxs-lookup"><span data-stu-id="a8330-209">Implement the <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A> property so that it returns the value obtained from <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, where the parameter is the window handle of the pop-up window.</span></span>

4. <span data-ttu-id="a8330-210">Implémentez <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> pour la fenêtre indépendante et son parent afin que la navigation soit correctement contrôlée du parent logique aux enfants logiques, et entre enfants de mêmes parents.</span><span class="sxs-lookup"><span data-stu-id="a8330-210">Implement <xref:System.Windows.Automation.Provider.IRawElementProviderFragment.Navigate%2A> for the pop-up window and its parent so that navigation is handled properly from the logical parent to the logical children, and between sibling children.</span></span>

<span data-ttu-id="a8330-211">Quand [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] rencontre la fenêtre indépendante, il reconnaît que cette navigation est substituée à la valeur par défaut et il ignore la fenêtre indépendante quand elle est rencontrée en tant qu'enfant du bureau.</span><span class="sxs-lookup"><span data-stu-id="a8330-211">When [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] encounters the pop-up window, it recognizes that navigation is being overridden from the default, and skips over the pop-up window when it is encountered as a child of the desktop.</span></span> <span data-ttu-id="a8330-212">À la place, le nœud sera accessible uniquement via le fragment.</span><span class="sxs-lookup"><span data-stu-id="a8330-212">Instead, the node will only be reachable through the fragment.</span></span>

<span data-ttu-id="a8330-213">La définition de l'état de parent n'est pas appropriée quand un contrôle peut héberger une fenêtre de n'importe quelle classe.</span><span class="sxs-lookup"><span data-stu-id="a8330-213">Reparenting is not suitable for cases where a control can host a window of any class.</span></span> <span data-ttu-id="a8330-214">Par exemple, un contrôle rebar peut héberger n'importe quel type de HWND dans ses bandes.</span><span class="sxs-lookup"><span data-stu-id="a8330-214">For example, a rebar can host any type of HWND in its bands.</span></span> <span data-ttu-id="a8330-215">Pour gérer ces cas, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] prend en charge une autre forme de réadressage HWND, comme décrit dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="a8330-215">To handle these cases, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] supports an alternative form of HWND relocation, as described in the next section.</span></span>

<a name="Non_WPF_Provider_Repositioning"></a>

### <a name="non-wpf-provider-repositioning"></a><span data-ttu-id="a8330-216">Repositionnement d'un fournisseur non-WPF</span><span class="sxs-lookup"><span data-stu-id="a8330-216">Non-WPF Provider Repositioning</span></span>

<span data-ttu-id="a8330-217">Les fragments[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] peuvent contenir deux éléments ou plus, tous contenus dans une fenêtre (HWND).</span><span class="sxs-lookup"><span data-stu-id="a8330-217">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] fragments may contain two or more elements that are each contained in a window (HWND).</span></span> <span data-ttu-id="a8330-218">Comme chaque HWND possède son propre fournisseur par défaut qui considère le HWND comme un enfant d’un HWND contenant, l’arborescence [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] affiche, par défaut, les HWND dans le fragment en tant qu’enfants de la fenêtre parente.</span><span class="sxs-lookup"><span data-stu-id="a8330-218">Because each HWND has its own default provider that considers the HWND to be a child of a containing HWND, the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree will, by default, show the HWNDs in the fragment as children of the parent window.</span></span> <span data-ttu-id="a8330-219">Dans la plupart des cas, ce comportement est conseillé, mais il peut parfois porter à confusion, car il ne correspond pas à la structure logique de l' [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="a8330-219">In most cases this is desirable behavior, but sometimes it can lead to confusion because it does not match the logical structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span>

<span data-ttu-id="a8330-220">Le contrôle rebar en est un bon exemple.</span><span class="sxs-lookup"><span data-stu-id="a8330-220">A good example of this is a rebar control.</span></span> <span data-ttu-id="a8330-221">Un rebar contient des bandes, qui peuvent, elles aussi, contenir un contrôle basé sur HWND, tel qu'une barre d'outils, une zone d'édition ou une zone de liste modifiable.</span><span class="sxs-lookup"><span data-stu-id="a8330-221">A rebar contains bands, each of which can in turn contain an HWND-based control such as a toolbar, an edit box, or a combo box.</span></span> <span data-ttu-id="a8330-222">Le fournisseur de fenêtre par défaut du HWND rebar considère les HWND du contrôle de bandes comme des enfants, tandis que le fournisseur rebar considère les bandes comme des enfants.</span><span class="sxs-lookup"><span data-stu-id="a8330-222">The default window provider for the rebar HWND sees the band control HWNDs as children, and the rebar provider sees the bands as children.</span></span> <span data-ttu-id="a8330-223">Étant donné que le fournisseur HWND et le fournisseur rebar travaillent en tandem et qu'ils combinent leurs enfants, les bandes et les contrôles basés sur HWND apparaissent comme les enfants du rebar.</span><span class="sxs-lookup"><span data-stu-id="a8330-223">Because the HWND provider and the rebar provider are working in tandem and combining their children, both the bands and the HWND-based controls appear as children of the rebar.</span></span> <span data-ttu-id="a8330-224">Toutefois, seules les bandes devraient logiquement apparaître comme les enfants du rebar et chaque fournisseur de bandes devrait être associé au fournisseur HWND par défaut pour le contrôle qu'il contient.</span><span class="sxs-lookup"><span data-stu-id="a8330-224">Logically, however, only the bands should appear as children of the rebar, and each band provider should be coupled with the default HWND provider for the control it contains.</span></span>

<span data-ttu-id="a8330-225">Pour cela, le fournisseur de la racine du fragment pour le rebar expose un jeu d'enfants représentant les bandes.</span><span class="sxs-lookup"><span data-stu-id="a8330-225">To accomplish this, the fragment root provider for the rebar exposes a set of children representing the bands.</span></span> <span data-ttu-id="a8330-226">Chaque bande possède un seul fournisseur qui peut exposer des propriétés et des modèles.</span><span class="sxs-lookup"><span data-stu-id="a8330-226">Each band has a single provider that may expose properties and patterns.</span></span> <span data-ttu-id="a8330-227">Dans son implémentation de <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, le fournisseur de bandes retourne le fournisseur de fenêtre par défaut pour le HWND de contrôle qu'il obtient en appelant <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, en passant le handle de fenêtre du contrôle.</span><span class="sxs-lookup"><span data-stu-id="a8330-227">In its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderSimple.HostRawElementProvider%2A>, the band provider returns the default window provider for the control HWND, which it obtains by calling <xref:System.Windows.Automation.Provider.AutomationInteropProvider.HostProviderFromHandle%2A>, passing in the control's window handle.</span></span> <span data-ttu-id="a8330-228">Enfin, le fournisseur de la racine du fragment pour le rebar implémente l'interface <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> et, dans son implémentation de <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> , il retourne le fournisseur de bandes approprié pour le contrôle contenu dans le HWND spécifié.</span><span class="sxs-lookup"><span data-stu-id="a8330-228">Finally, the fragment root provider for the rebar implements the <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride> interface, and in its implementation of <xref:System.Windows.Automation.Provider.IRawElementProviderHwndOverride.GetOverrideProviderForHwnd%2A> it returns the appropriate band provider for the control contained in the specified HWND.</span></span>

## <a name="see-also"></a><span data-ttu-id="a8330-229">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="a8330-229">See also</span></span>

- [<span data-ttu-id="a8330-230">Vue d’ensemble des fournisseurs UI Automation</span><span class="sxs-lookup"><span data-stu-id="a8330-230">UI Automation Providers Overview</span></span>](ui-automation-providers-overview.md)
- [<span data-ttu-id="a8330-231">Exposer un fournisseur UI Automation côté serveur</span><span class="sxs-lookup"><span data-stu-id="a8330-231">Expose a Server-side UI Automation Provider</span></span>](expose-a-server-side-ui-automation-provider.md)
- [<span data-ttu-id="a8330-232">Retourner les propriétés d’un fournisseur UI Automation</span><span class="sxs-lookup"><span data-stu-id="a8330-232">Return Properties from a UI Automation Provider</span></span>](return-properties-from-a-ui-automation-provider.md)
- [<span data-ttu-id="a8330-233">Déclencher des événements à partir d’un fournisseur UI Automation</span><span class="sxs-lookup"><span data-stu-id="a8330-233">Raise Events from a UI Automation Provider</span></span>](raise-events-from-a-ui-automation-provider.md)
- [<span data-ttu-id="a8330-234">Activer la navigation dans un fournisseur de fragment UI Automation</span><span class="sxs-lookup"><span data-stu-id="a8330-234">Enable Navigation in a UI Automation Fragment Provider</span></span>](enable-navigation-in-a-ui-automation-fragment-provider.md)
- [<span data-ttu-id="a8330-235">Prendre en charge des modèles de contrôle dans un fournisseur UI Automation</span><span class="sxs-lookup"><span data-stu-id="a8330-235">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)

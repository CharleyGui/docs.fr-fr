---
title: Implémentation du modèle de contrôle ExpandCollapse d'UI Automation
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, ExpandCollapse control pattern
- ExpandCollapse control pattern
- control patterns, ExpandCollapse
ms.assetid: 1dbabb8c-0d68-47c1-a35e-1c01cb01af26
ms.openlocfilehash: 073ff0727fc6aab1189f73a254aa95da60820cc3
ms.sourcegitcommit: 9a39f2a06f110c9c7ca54ba216900d038aa14ef3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/23/2019
ms.locfileid: "74447149"
---
# <a name="implementing-the-ui-automation-expandcollapse-control-pattern"></a><span data-ttu-id="f58e3-102">Implémentation du modèle de contrôle ExpandCollapse d'UI Automation</span><span class="sxs-lookup"><span data-stu-id="f58e3-102">Implementing the UI Automation ExpandCollapse Control Pattern</span></span>

> [!NOTE]
> <span data-ttu-id="f58e3-103">Cette documentation s'adresse aux développeurs .NET Framework qui souhaitent utiliser les classes [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] managées définies dans l'espace de noms <xref:System.Windows.Automation>.</span><span class="sxs-lookup"><span data-stu-id="f58e3-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="f58e3-104">Pour obtenir les dernières informations sur [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], consultez [API Windows Automation : UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="f58e3-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>

<span data-ttu-id="f58e3-105">Cette rubrique présente les conventions et directives à respecter pour implémenter <xref:System.Windows.Automation.Provider.IExpandCollapseProvider>, notamment les informations sur les propriétés, les méthodes et les événements.</span><span class="sxs-lookup"><span data-stu-id="f58e3-105">This topic introduces guidelines and conventions for implementing <xref:System.Windows.Automation.Provider.IExpandCollapseProvider>, including information about properties, methods, and events.</span></span> <span data-ttu-id="f58e3-106">Des liens vers des références supplémentaires sont répertoriés à la fin de la vue d'ensemble.</span><span class="sxs-lookup"><span data-stu-id="f58e3-106">Links to additional references are listed at the end of the overview.</span></span>

<span data-ttu-id="f58e3-107">Le modèle de contrôle <xref:System.Windows.Automation.ExpandCollapsePattern> est utilisé pour prendre en charge les contrôles qui peuvent être visuellement développés pour afficher davantage de contenu et réduits pour masquer le contenu.</span><span class="sxs-lookup"><span data-stu-id="f58e3-107">The <xref:System.Windows.Automation.ExpandCollapsePattern> control pattern is used to support controls that visually expand to display more content and collapse to hide content.</span></span> <span data-ttu-id="f58e3-108">Pour obtenir des exemples de contrôles implémentant ce modèle de contrôle, consultez [Control Pattern Mapping for UI Automation Clients](control-pattern-mapping-for-ui-automation-clients.md).</span><span class="sxs-lookup"><span data-stu-id="f58e3-108">For examples of controls that implement this control pattern, see [Control Pattern Mapping for UI Automation Clients](control-pattern-mapping-for-ui-automation-clients.md).</span></span>

<a name="Implementation_Guidelines_and_Conventions"></a>

## <a name="implementation-guidelines-and-conventions"></a><span data-ttu-id="f58e3-109">Conventions et directives d'implémentation</span><span class="sxs-lookup"><span data-stu-id="f58e3-109">Implementation Guidelines and Conventions</span></span>

<span data-ttu-id="f58e3-110">Quand vous implémentez le modèle de contrôle ExpandCollapse, notez les conventions et directives suivantes :</span><span class="sxs-lookup"><span data-stu-id="f58e3-110">When implementing the ExpandCollapse control pattern, note the following guidelines and conventions:</span></span>

- <span data-ttu-id="f58e3-111">Les contrôles d'agrégat, générés avec des objets enfants qui fournissent la fonctionnalité de développement/réduction à l'interface utilisateur, doivent prendre en charge le modèle de contrôle <xref:System.Windows.Automation.ExpandCollapsePattern> même si leurs éléments enfants ne le font pas.</span><span class="sxs-lookup"><span data-stu-id="f58e3-111">Aggregate controls—built with child objects that provide the UI with expand/collapse functionality—must support the <xref:System.Windows.Automation.ExpandCollapsePattern> control pattern whereas their child elements do not.</span></span> <span data-ttu-id="f58e3-112">Par exemple, un contrôle zone de liste déroulante est généré avec une combinaison de contrôles zone de liste, de contrôles bouton et de contrôles d'édition, mais seule la zone de liste déroulante parente doit prendre en charge <xref:System.Windows.Automation.ExpandCollapsePattern>.</span><span class="sxs-lookup"><span data-stu-id="f58e3-112">For example, a combo box control is built with a combination of list box, button, and edit controls, but it is only the parent combo box that must support the <xref:System.Windows.Automation.ExpandCollapsePattern>.</span></span>

  > [!NOTE]
  > <span data-ttu-id="f58e3-113">Le contrôle de menu, qui est un agrégat d'objets MenuItem individuels, fait exception à cette règle.</span><span class="sxs-lookup"><span data-stu-id="f58e3-113">An exception is the menu control, which is an aggregate of individual MenuItem objects.</span></span> <span data-ttu-id="f58e3-114">Les objets MenuItem peuvent prendre en charge le modèle de contrôle <xref:System.Windows.Automation.ExpandCollapsePattern> , mais le contrôle Menu parent ne le peut pas.</span><span class="sxs-lookup"><span data-stu-id="f58e3-114">The MenuItem objects can support the <xref:System.Windows.Automation.ExpandCollapsePattern> control pattern, but the parent Menu control cannot.</span></span> <span data-ttu-id="f58e3-115">Une exception semblable s'applique aux contrôles Tree et Tree Item.</span><span class="sxs-lookup"><span data-stu-id="f58e3-115">A similar exception applies to the Tree and Tree Item controls.</span></span>

- <span data-ttu-id="f58e3-116">Quand l' <xref:System.Windows.Automation.ExpandCollapseState> d'un contrôle est défini sur <xref:System.Windows.Automation.ExpandCollapseState.LeafNode>, toute fonctionnalité <xref:System.Windows.Automation.ExpandCollapsePattern> est actuellement inactive pour le contrôle et la seule information qui peut être obtenue à l'aide de ce modèle de contrôle est l' <xref:System.Windows.Automation.ExpandCollapseState>.</span><span class="sxs-lookup"><span data-stu-id="f58e3-116">When the <xref:System.Windows.Automation.ExpandCollapseState> of a control is set to <xref:System.Windows.Automation.ExpandCollapseState.LeafNode>, any <xref:System.Windows.Automation.ExpandCollapsePattern> functionality is currently inactive for the control and the only information that can be obtained using this control pattern is the <xref:System.Windows.Automation.ExpandCollapseState>.</span></span> <span data-ttu-id="f58e3-117">Si des objets enfants sont ajoutés par la suite, l' <xref:System.Windows.Automation.ExpandCollapseState> change et la fonctionnalité <xref:System.Windows.Automation.ExpandCollapsePattern> est activée.</span><span class="sxs-lookup"><span data-stu-id="f58e3-117">If any child objects are subsequently added, the <xref:System.Windows.Automation.ExpandCollapseState> changes and <xref:System.Windows.Automation.ExpandCollapsePattern> functionality is activated.</span></span>

- <span data-ttu-id="f58e3-118"><xref:System.Windows.Automation.ExpandCollapseState> fait référence uniquement à la visibilité des objets enfants immédiats ; il ne fait pas référence à celle de tous les objets descendants.</span><span class="sxs-lookup"><span data-stu-id="f58e3-118"><xref:System.Windows.Automation.ExpandCollapseState> refers to the visibility of immediate child objects only; it does not refer to the visibility of all descendant objects.</span></span>

- <span data-ttu-id="f58e3-119">La fonctionnalité de développement/réduction est propre au contrôle.</span><span class="sxs-lookup"><span data-stu-id="f58e3-119">Expand and Collapse functionality is control-specific.</span></span> <span data-ttu-id="f58e3-120">Voici des exemples de ce comportement.</span><span class="sxs-lookup"><span data-stu-id="f58e3-120">The following are examples of this behavior.</span></span>

  - <span data-ttu-id="f58e3-121">Le menu personnel d'Office peut être un MenuItem à trois états (<xref:System.Windows.Automation.ExpandCollapseState.Expanded>, <xref:System.Windows.Automation.ExpandCollapseState.Collapsed> et <xref:System.Windows.Automation.ExpandCollapseState.PartiallyExpanded>) où le contrôle spécifie l'état à adopter quand un <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> ou <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> est appelé.</span><span class="sxs-lookup"><span data-stu-id="f58e3-121">The Office Personal Menu can be a tri-state MenuItem (<xref:System.Windows.Automation.ExpandCollapseState.Expanded>, <xref:System.Windows.Automation.ExpandCollapseState.Collapsed> and <xref:System.Windows.Automation.ExpandCollapseState.PartiallyExpanded>) where the control specifies the state to adopt when an <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> is called.</span></span>

  - <span data-ttu-id="f58e3-122">L'appel d' <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> sur un TreeItem peut afficher tous les descendants ou seulement les enfants immédiats.</span><span class="sxs-lookup"><span data-stu-id="f58e3-122">Calling <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> on a TreeItem may display all descendants or only immediate children.</span></span>

  - <span data-ttu-id="f58e3-123">Si l'appel d' <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> ou de <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> sur un contrôle maintient l'état de ses descendants, un événement de modification de la visibilité doit être envoyé, et non un événement de modification d'état. Si le contrôle parent ne maintient pas l'état de ses descendants quand il est réduit, le contrôle peut détruire tous les descendants qui ne sont plus visibles et déclencher un événement détruit, ou bien il peut modifier l' <xref:System.Windows.Automation.Provider.IExpandCollapseProvider.ExpandCollapseState%2A> pour chaque descendant et déclencher un événement de modification de la visibilité.</span><span class="sxs-lookup"><span data-stu-id="f58e3-123">If calling <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> on a control maintains the state of its descendants, a visibility change event should be sent, not a state change event If the parent control does not maintain the state of its descendants when collapsed, the control may destroy all the descendants that are no longer visible and raise a destroyed event; or it may change the <xref:System.Windows.Automation.Provider.IExpandCollapseProvider.ExpandCollapseState%2A> for each descendant and raise a visibility change event.</span></span>

- <span data-ttu-id="f58e3-124">Pour assurer la navigation, il est souhaitable qu'un objet se trouve dans l'arborescence [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] (avec l'état de visibilité approprié), quel que soit l' <xref:System.Windows.Automation.ExpandCollapseState>de ses parents.</span><span class="sxs-lookup"><span data-stu-id="f58e3-124">To guarantee navigation, it is desirable for an object to be in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree (with appropriate visibility state) regardless of its parents <xref:System.Windows.Automation.ExpandCollapseState>.</span></span> <span data-ttu-id="f58e3-125">Si des descendants sont générés à la demande, il est possible qu'ils n'apparaissent dans l'arborescence [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] qu'après leur premier affichage ou que quand ils sont visibles.</span><span class="sxs-lookup"><span data-stu-id="f58e3-125">If descendants are generated on demand, they may only appear in the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree after being displayed for the first time or only while they are visible.</span></span>

<a name="Required_Members_for_the_IValueProvider_Interface"></a>

## <a name="required-members-for-iexpandcollapseprovider"></a><span data-ttu-id="f58e3-126">Membres nécessaires pour IExpandCollapseProvider</span><span class="sxs-lookup"><span data-stu-id="f58e3-126">Required Members for IExpandCollapseProvider</span></span>

<span data-ttu-id="f58e3-127">Les propriétés et méthodes suivantes sont nécessaires à l'implémentation d' <xref:System.Windows.Automation.Provider.IExpandCollapseProvider>.</span><span class="sxs-lookup"><span data-stu-id="f58e3-127">The following properties and methods are required for implementing <xref:System.Windows.Automation.Provider.IExpandCollapseProvider>.</span></span>

|<span data-ttu-id="f58e3-128">Membres nécessaires</span><span class="sxs-lookup"><span data-stu-id="f58e3-128">Required members</span></span>|<span data-ttu-id="f58e3-129">Type de membre</span><span class="sxs-lookup"><span data-stu-id="f58e3-129">Member type</span></span>|<span data-ttu-id="f58e3-130">Notes</span><span class="sxs-lookup"><span data-stu-id="f58e3-130">Notes</span></span>|
|----------------------|-----------------|-----------|
|<xref:System.Windows.Automation.Provider.IExpandCollapseProvider.ExpandCollapseState%2A>|<span data-ttu-id="f58e3-131">Property</span><span class="sxs-lookup"><span data-stu-id="f58e3-131">Property</span></span>|<span data-ttu-id="f58e3-132">aucune.</span><span class="sxs-lookup"><span data-stu-id="f58e3-132">None</span></span>|
|<xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A>|<span data-ttu-id="f58e3-133">Méthode</span><span class="sxs-lookup"><span data-stu-id="f58e3-133">Method</span></span>|<span data-ttu-id="f58e3-134">aucune.</span><span class="sxs-lookup"><span data-stu-id="f58e3-134">None</span></span>|
|<xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A>|<span data-ttu-id="f58e3-135">Méthode</span><span class="sxs-lookup"><span data-stu-id="f58e3-135">Method</span></span>|<span data-ttu-id="f58e3-136">aucune.</span><span class="sxs-lookup"><span data-stu-id="f58e3-136">None</span></span>|
|<xref:System.Windows.Automation.AutomationPropertyChangedEventHandler>|<span data-ttu-id="f58e3-137">événement</span><span class="sxs-lookup"><span data-stu-id="f58e3-137">Event</span></span>|<span data-ttu-id="f58e3-138">Aucun événement n'est associé à ce contrôle ; utilisez ce délégué générique.</span><span class="sxs-lookup"><span data-stu-id="f58e3-138">This control has no associated events; use this generic delegate.</span></span>|

<a name="Exceptions"></a>

## <a name="exceptions"></a><span data-ttu-id="f58e3-139">Exceptions</span><span class="sxs-lookup"><span data-stu-id="f58e3-139">Exceptions</span></span>

<span data-ttu-id="f58e3-140">Les fournisseurs doivent lever les exceptions suivantes.</span><span class="sxs-lookup"><span data-stu-id="f58e3-140">Providers must throw the following exceptions.</span></span>

|<span data-ttu-id="f58e3-141">Type d'exception</span><span class="sxs-lookup"><span data-stu-id="f58e3-141">Exception type</span></span>|<span data-ttu-id="f58e3-142">Condition</span><span class="sxs-lookup"><span data-stu-id="f58e3-142">Condition</span></span>|
|--------------------|---------------|
|<xref:System.InvalidOperationException>|<span data-ttu-id="f58e3-143">Either <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> is called when the <xref:System.Windows.Automation.ExpandCollapseState> = <xref:System.Windows.Automation.ExpandCollapseState.LeafNode>.</span><span class="sxs-lookup"><span data-stu-id="f58e3-143">Either <xref:System.Windows.Automation.ExpandCollapsePattern.Expand%2A> or <xref:System.Windows.Automation.ExpandCollapsePattern.Collapse%2A> is called when the <xref:System.Windows.Automation.ExpandCollapseState> = <xref:System.Windows.Automation.ExpandCollapseState.LeafNode>.</span></span>|

## <a name="see-also"></a><span data-ttu-id="f58e3-144">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f58e3-144">See also</span></span>

- [<span data-ttu-id="f58e3-145">Vue d’ensemble des modèles de contrôle UI Automation</span><span class="sxs-lookup"><span data-stu-id="f58e3-145">UI Automation Control Patterns Overview</span></span>](ui-automation-control-patterns-overview.md)
- [<span data-ttu-id="f58e3-146">Prendre en charge des modèles de contrôle dans un fournisseur UI Automation</span><span class="sxs-lookup"><span data-stu-id="f58e3-146">Support Control Patterns in a UI Automation Provider</span></span>](support-control-patterns-in-a-ui-automation-provider.md)
- [<span data-ttu-id="f58e3-147">Modèles de contrôle UI Automation pour les clients</span><span class="sxs-lookup"><span data-stu-id="f58e3-147">UI Automation Control Patterns for Clients</span></span>](ui-automation-control-patterns-for-clients.md)
- [<span data-ttu-id="f58e3-148">Naviguer entre les éléments UI Automation avec TreeWalker</span><span class="sxs-lookup"><span data-stu-id="f58e3-148">Navigate Among UI Automation Elements with TreeWalker</span></span>](navigate-among-ui-automation-elements-with-treewalker.md)
- [<span data-ttu-id="f58e3-149">Présentation de l’arborescence UI Automation</span><span class="sxs-lookup"><span data-stu-id="f58e3-149">UI Automation Tree Overview</span></span>](ui-automation-tree-overview.md)
- [<span data-ttu-id="f58e3-150">Utiliser la mise en cache dans UI Automation</span><span class="sxs-lookup"><span data-stu-id="f58e3-150">Use Caching in UI Automation</span></span>](use-caching-in-ui-automation.md)

---
title: Implémentation de fournisseur UI Automation côté client
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, client-side provider implementation
- client-side UI Automation provider, implementation
- provider implementation, UI Automation
ms.assetid: 3584c0a1-9cd0-4968-8b63-b06390890ef6
ms.openlocfilehash: 50d7921f1c63580248b562864f9c1f398d41c9bc
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/12/2020
ms.locfileid: "79180258"
---
# <a name="client-side-ui-automation-provider-implementation"></a><span data-ttu-id="9c827-102">Implémentation de fournisseur UI Automation côté client</span><span class="sxs-lookup"><span data-stu-id="9c827-102">Client-Side UI Automation Provider Implementation</span></span>
> [!NOTE]
> <span data-ttu-id="9c827-103">Cette documentation s'adresse aux développeurs .NET Framework qui souhaitent utiliser les classes [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] managées définies dans l'espace de noms <xref:System.Windows.Automation>.</span><span class="sxs-lookup"><span data-stu-id="9c827-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="9c827-104">Pour obtenir les dernières informations sur [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], consultez [API Windows Automation : UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="9c827-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
 <span data-ttu-id="9c827-105">Plusieurs [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] cadres différents sont utilisés dans les systèmes d’exploitation Microsoft, y compris Win32, Windows Forms, et [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9c827-105">Several different [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] frameworks are in use within Microsoft operating systems, including Win32, Windows Forms, and [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)].</span></span> [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] <span data-ttu-id="9c827-106">expose aux clients des informations sur les éléments d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9c827-106">exposes information about UI elements to clients.</span></span> <span data-ttu-id="9c827-107">Toutefois, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] n’a pas connaissance des différents types de contrôle qui existent dans ces infrastructures, ni des techniques nécessaires pour en extraire les informations.</span><span class="sxs-lookup"><span data-stu-id="9c827-107">However, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] does not itself have awareness of the different types of controls that exist in these frameworks and the techniques that are needed to extract information from them.</span></span> <span data-ttu-id="9c827-108">En revanche, cette tâche est affectée aux objets appelés fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="9c827-108">Instead, it leaves this task to objects called providers.</span></span> <span data-ttu-id="9c827-109">Un fournisseur extrait des informations d’un contrôle spécifique, et les transmet à [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], qui les présente ensuite au client de façon cohérente.</span><span class="sxs-lookup"><span data-stu-id="9c827-109">A provider extracts information from a specific control and hands that information to [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], which then presents it to the client in a consistent manner.</span></span>  
  
 <span data-ttu-id="9c827-110">Les fournisseurs peuvent exister côté serveur ou côté client.</span><span class="sxs-lookup"><span data-stu-id="9c827-110">Providers can exist either on the server side or on the client side.</span></span> <span data-ttu-id="9c827-111">Un fournisseur côté serveur est implémenté par le contrôle lui-même.</span><span class="sxs-lookup"><span data-stu-id="9c827-111">A server-side provider is implemented by the control itself.</span></span> <span data-ttu-id="9c827-112">Les éléments[!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)] implémentent des fournisseurs, comme tout contrôle tiers écrit avec [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] à l’esprit.</span><span class="sxs-lookup"><span data-stu-id="9c827-112">[!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)] elements implement providers, as can any third-party controls written with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] in mind.</span></span>  
  
 <span data-ttu-id="9c827-113">Cependant, les contrôles plus anciens tels que ceux de [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]Win32 et de Windows Forms ne prennent pas directement en charge .</span><span class="sxs-lookup"><span data-stu-id="9c827-113">However, older controls such as those in Win32 and Windows Forms do not directly support [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span> <span data-ttu-id="9c827-114">En effet, ces contrôles sont traités par des fournisseurs qui existent dans le processus client et obtiennent des informations sur les contrôles à l’aide de la communication entre processus. C’est le cas, par exemple, avec la surveillance des messages de fenêtres à destination et en provenance des contrôles.</span><span class="sxs-lookup"><span data-stu-id="9c827-114">These controls are served instead by providers that exist in the client process and obtain information about controls using cross-process communication; for example, by monitoring windows messages to and from the controls.</span></span> <span data-ttu-id="9c827-115">Ces fournisseurs côté client sont parfois appelés des proxies.</span><span class="sxs-lookup"><span data-stu-id="9c827-115">Such client-side providers are sometimes called proxies.</span></span>  
  
 <span data-ttu-id="9c827-116">Windows Vista fournit des fournisseurs pour les contrôles Standard Win32 et Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="9c827-116">Windows Vista supplies providers for standard Win32 and Windows Forms controls.</span></span> <span data-ttu-id="9c827-117">En outre, un fournisseur [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] de repli apporte un soutien partiel à tout contrôle qui n’est pas servi par un autre fournisseur ou un proxy côté serveur, mais qui dispose d’une implémentation Microsoft Active Accessibility.</span><span class="sxs-lookup"><span data-stu-id="9c827-117">In addition, a fallback provider gives partial [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] support to any control that is not served by another server-side provider or proxy but has a Microsoft Active Accessibility implementation.</span></span> <span data-ttu-id="9c827-118">Tous ces fournisseurs sont automatiquement chargés et disponibles pour les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="9c827-118">All these providers are automatically loaded and available to client applications.</span></span>  
  
 <span data-ttu-id="9c827-119">Pour plus d’informations sur la prise en charge des contrôles Win32 et Windows Forms, voir [UI Automation Support for Standard Controls](ui-automation-support-for-standard-controls.md).</span><span class="sxs-lookup"><span data-stu-id="9c827-119">For more information on support for Win32 and Windows Forms controls, see [UI Automation Support for Standard Controls](ui-automation-support-for-standard-controls.md).</span></span>  
  
 <span data-ttu-id="9c827-120">Les applications peuvent également inscrire d’autres fournisseurs côté client.</span><span class="sxs-lookup"><span data-stu-id="9c827-120">Applications can also register other client-side providers.</span></span>  
  
<a name="Distributing_Client-Side_Providers"></a>
## <a name="distributing-client-side-providers"></a><span data-ttu-id="9c827-121">Distribution des fournisseurs côté client</span><span class="sxs-lookup"><span data-stu-id="9c827-121">Distributing Client-Side Providers</span></span>  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="9c827-122">s’attend à trouver des fournisseurs côté client dans un assembly de code managé.</span><span class="sxs-lookup"><span data-stu-id="9c827-122">expects to find client-side providers in a managed-code assembly.</span></span> <span data-ttu-id="9c827-123">L’espace de noms de cet assembly doit avoir le même nom que l’assembly.</span><span class="sxs-lookup"><span data-stu-id="9c827-123">The namespace in this assembly should have the same name as the assembly.</span></span> <span data-ttu-id="9c827-124">Par exemple, un assembly appelé ContosoProxies.dll doit contenir l’espace de noms ContosoProxies.</span><span class="sxs-lookup"><span data-stu-id="9c827-124">For example, an assembly called ContosoProxies.dll would contain the ContosoProxies namespace.</span></span> <span data-ttu-id="9c827-125">Dans l’espace de noms, créez une classe <xref:UIAutomationClientsideProviders.UIAutomationClientSideProviders> .</span><span class="sxs-lookup"><span data-stu-id="9c827-125">Within the namespace, create a <xref:UIAutomationClientsideProviders.UIAutomationClientSideProviders> class.</span></span> <span data-ttu-id="9c827-126">Dans l’implémentation du champ <xref:UIAutomationClientsideProviders.UIAutomationClientSideProviders.ClientSideProviderDescriptionTable> statique, créez un tableau de structures <xref:System.Windows.Automation.ClientSideProviderDescription> décrivant les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="9c827-126">In the implementation of the static <xref:UIAutomationClientsideProviders.UIAutomationClientSideProviders.ClientSideProviderDescriptionTable> field, create an array of <xref:System.Windows.Automation.ClientSideProviderDescription> structures describing the providers.</span></span>  
  
<a name="Registering_and_Configuring_Client-Side_Providers"></a>
## <a name="registering-and-configuring-client-side-providers"></a><span data-ttu-id="9c827-127">Inscription et configuration des fournisseurs côté client</span><span class="sxs-lookup"><span data-stu-id="9c827-127">Registering and Configuring Client-Side Providers</span></span>  
 <span data-ttu-id="9c827-128">Les fournisseurs de clients d’une bibliothèque à liaison <xref:System.Windows.Automation.ClientSettings.RegisterClientSideProviderAssembly%2A>dynamique (DLL) sont chargés en appelant .</span><span class="sxs-lookup"><span data-stu-id="9c827-128">Client-side providers in a dynamic-link library (DLL) are loaded by calling <xref:System.Windows.Automation.ClientSettings.RegisterClientSideProviderAssembly%2A>.</span></span> <span data-ttu-id="9c827-129">Aucune action supplémentaire n’est nécessaire de la part de l’application cliente pour utiliser les fournisseurs.</span><span class="sxs-lookup"><span data-stu-id="9c827-129">No further action is required by a client application to make use of the providers.</span></span>  
  
 <span data-ttu-id="9c827-130">Les fournisseurs implémentés dans le propre code du client sont inscrits à l’aide de <xref:System.Windows.Automation.ClientSettings.RegisterClientSideProviders%2A>.</span><span class="sxs-lookup"><span data-stu-id="9c827-130">Providers implemented in the client's own code are registered by using <xref:System.Windows.Automation.ClientSettings.RegisterClientSideProviders%2A>.</span></span> <span data-ttu-id="9c827-131">Cette méthode utilise comme argument un tableau de structures <xref:System.Windows.Automation.ClientSideProviderDescription> , qui spécifient chacune les propriétés suivantes :</span><span class="sxs-lookup"><span data-stu-id="9c827-131">This method takes as an argument an array of <xref:System.Windows.Automation.ClientSideProviderDescription> structures, each of which specifies the following properties:</span></span>  
  
- <span data-ttu-id="9c827-132">une fonction de rappel qui crée l’objet fournisseur ;</span><span class="sxs-lookup"><span data-stu-id="9c827-132">A callback function that creates the provider object.</span></span>  
  
- <span data-ttu-id="9c827-133">le nom de la classe des contrôles que le fournisseur doit traiter ;</span><span class="sxs-lookup"><span data-stu-id="9c827-133">The class name of the controls that the provider will serve.</span></span>  
  
- <span data-ttu-id="9c827-134">le nom d’image de l’application (généralement le nom complet du fichier exécutable) que le fournisseur doit traiter ;</span><span class="sxs-lookup"><span data-stu-id="9c827-134">The image name of the application (usually the full name of the executable file) that the provider will serve.</span></span>  
  
- <span data-ttu-id="9c827-135">les indicateurs qui déterminent la comparaison du nom de la classe aux classes de fenêtres trouvées dans l’application cible.</span><span class="sxs-lookup"><span data-stu-id="9c827-135">Flags that govern how the class name is matched against window classes found in the target application.</span></span>  
  
 <span data-ttu-id="9c827-136">Les deux derniers paramètres sont facultatifs.</span><span class="sxs-lookup"><span data-stu-id="9c827-136">The last two parameters are optional.</span></span> <span data-ttu-id="9c827-137">Le client peut spécifier le nom d’image de l’application cible quand il souhaite utiliser différents fournisseurs pour différentes applications.</span><span class="sxs-lookup"><span data-stu-id="9c827-137">The client might specify the image name of the target application when it wants to use different providers for different applications.</span></span> <span data-ttu-id="9c827-138">Par exemple, le client peut utiliser un fournisseur pour un contrôle de vue de liste Win32 dans une application connue qui prend en charge le modèle De vue multiple, et un autre pour un contrôle similaire dans une autre application connue qui ne le fait pas.</span><span class="sxs-lookup"><span data-stu-id="9c827-138">For example, the client might use one provider for a Win32 list view control in a known application that supports the Multiple View pattern, and another for a similar control in another known application that does not.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9c827-139">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="9c827-139">See also</span></span>

- [<span data-ttu-id="9c827-140">Créer un fournisseur UI Automation côté client</span><span class="sxs-lookup"><span data-stu-id="9c827-140">Create a Client-Side UI Automation Provider</span></span>](create-a-client-side-ui-automation-provider.md)
- [<span data-ttu-id="9c827-141">Implémenter des fournisseurs UI Automation dans une application cliente</span><span class="sxs-lookup"><span data-stu-id="9c827-141">Implement UI Automation Providers in a Client Application</span></span>](implement-ui-automation-providers-in-a-client-application.md)

---
title: Obtention d'éléments UI Automation
description: Passez en revue les différentes façons d’obtenir des objets AutomationElement (UI Automation Element) pour les éléments de l’interface utilisateur.
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, obtaining elements
- elements, UI Automation, obtaining
ms.assetid: c2caaf45-e59c-42a1-bc9b-77a6de520171
ms.openlocfilehash: 66a8d9e944a8f8a777ec744a33f2cdb2d33e200c
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/26/2020
ms.locfileid: "96237350"
---
# <a name="obtaining-ui-automation-elements"></a><span data-ttu-id="387f3-103">Obtention d'éléments UI Automation</span><span class="sxs-lookup"><span data-stu-id="387f3-103">Obtaining UI Automation Elements</span></span>

> [!NOTE]
> <span data-ttu-id="387f3-104">Cette documentation s'adresse aux développeurs .NET Framework qui souhaitent utiliser les classes [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] managées définies dans l'espace de noms <xref:System.Windows.Automation>.</span><span class="sxs-lookup"><span data-stu-id="387f3-104">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="387f3-105">Pour obtenir les dernières informations sur [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], consultez [API Windows Automation : UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span><span class="sxs-lookup"><span data-stu-id="387f3-105">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](/windows/win32/winauto/entry-uiauto-win32).</span></span>  
  
 <span data-ttu-id="387f3-106">Cette rubrique décrit les différentes façons d’obtenir des objets <xref:System.Windows.Automation.AutomationElement> pour les éléments d’ [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="387f3-106">This topic describes the various ways of obtaining <xref:System.Windows.Automation.AutomationElement> objects for [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] elements.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="387f3-107">Si votre application cliente peut tenter de rechercher des éléments dans sa propre interface utilisateur, vous devez effectuer tous les appels [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] sur un thread distinct.</span><span class="sxs-lookup"><span data-stu-id="387f3-107">If your client application might attempt to find elements in its own user interface, you must make all [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] calls on a separate thread.</span></span> <span data-ttu-id="387f3-108">Pour plus d'informations, consultez [UI Automation Threading Issues](ui-automation-threading-issues.md).</span><span class="sxs-lookup"><span data-stu-id="387f3-108">For more information, see [UI Automation Threading Issues](ui-automation-threading-issues.md).</span></span>  
  
<a name="The_Root_Element"></a>

## <a name="root-element"></a><span data-ttu-id="387f3-109">Élément racine</span><span class="sxs-lookup"><span data-stu-id="387f3-109">Root Element</span></span>  

 <span data-ttu-id="387f3-110">Toutes les recherches d’objets <xref:System.Windows.Automation.AutomationElement> doivent avoir un point de départ.</span><span class="sxs-lookup"><span data-stu-id="387f3-110">All searches for <xref:System.Windows.Automation.AutomationElement> objects must have a starting-place.</span></span> <span data-ttu-id="387f3-111">Cela peut être n’importe quel élément, y compris le bureau, une fenêtre d’application ou un contrôle.</span><span class="sxs-lookup"><span data-stu-id="387f3-111">This can be any element, including the desktop, an application window, or a control.</span></span>  
  
 <span data-ttu-id="387f3-112">L’élément racine pour le bureau, duquel tous les éléments proviennent, est obtenu à partir de la propriété <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType> statique.</span><span class="sxs-lookup"><span data-stu-id="387f3-112">The root element for the desktop, from which all elements are descended, is obtained from the static <xref:System.Windows.Automation.AutomationElement.RootElement%2A?displayProperty=nameWithType> property.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="387f3-113">En général, vous devez essayer d’obtenir uniquement les enfants directs de <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span><span class="sxs-lookup"><span data-stu-id="387f3-113">In general, you should try to obtain only direct children of the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span> <span data-ttu-id="387f3-114">Une recherche des descendants peut itérer au sein de centaines ou de milliers d’éléments, ce qui peut provoquer un dépassement de capacité de la pile.</span><span class="sxs-lookup"><span data-stu-id="387f3-114">A search for descendants may iterate through hundreds or even thousands of elements, possibly resulting in a stack overflow.</span></span> <span data-ttu-id="387f3-115">Si vous tentez d’obtenir un élément spécifique de niveau inférieur, vous devez commencer votre recherche à partir de la fenêtre d’application ou d’un conteneur de niveau inférieur.</span><span class="sxs-lookup"><span data-stu-id="387f3-115">If you are attempting to obtain a specific element at a lower level, you should start your search from the application window or from a container at a lower level.</span></span>  
  
<a name="Using_Conditions"></a>

## <a name="conditions"></a><span data-ttu-id="387f3-116">Conditions</span><span class="sxs-lookup"><span data-stu-id="387f3-116">Conditions</span></span>  

 <span data-ttu-id="387f3-117">Pour la plupart des techniques que vous pouvez utiliser pour récupérer des éléments [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , vous devez spécifier un <xref:System.Windows.Automation.Condition>, qui est un ensemble de critères définissant les éléments que vous souhaitez récupérer.</span><span class="sxs-lookup"><span data-stu-id="387f3-117">For most techniques you can use to retrieve [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements, you must specify a <xref:System.Windows.Automation.Condition>, which is a set of criteria defining what elements you want to retrieve.</span></span>  
  
 <span data-ttu-id="387f3-118">La condition la plus simple est <xref:System.Windows.Automation.Condition.TrueCondition>, un objet prédéfini spécifiant que tous les éléments dans la zone de recherche doivent être retournés.</span><span class="sxs-lookup"><span data-stu-id="387f3-118">The simplest condition is <xref:System.Windows.Automation.Condition.TrueCondition>, a predefined object specifying that all elements within the search scope are to be returned.</span></span> <span data-ttu-id="387f3-119">La condition<xref:System.Windows.Automation.Condition.FalseCondition>, inverse de <xref:System.Windows.Automation.Condition.TrueCondition>, est moins utile, car elle empêche certains éléments d’être recherchés.</span><span class="sxs-lookup"><span data-stu-id="387f3-119"><xref:System.Windows.Automation.Condition.FalseCondition>, the converse of <xref:System.Windows.Automation.Condition.TrueCondition>, is less useful, as it would prevent any elements from being found.</span></span>  
  
 <span data-ttu-id="387f3-120">Trois autres conditions prédéfinies peuvent être utilisées seules ou combinées à d’autres conditions : <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>et <xref:System.Windows.Automation.Automation.RawViewCondition>.</span><span class="sxs-lookup"><span data-stu-id="387f3-120">Three other predefined conditions can be used alone or in combination with other conditions: <xref:System.Windows.Automation.Automation.ContentViewCondition>, <xref:System.Windows.Automation.Automation.ControlViewCondition>, and <xref:System.Windows.Automation.Automation.RawViewCondition>.</span></span> <span data-ttu-id="387f3-121">La condition, utilisée par elle-même, est équivalente à , car elle ne filtre pas les éléments par leurs propriétés  ou  .</span><span class="sxs-lookup"><span data-stu-id="387f3-121"><xref:System.Windows.Automation.Automation.RawViewCondition>, used by itself, is equivalent to <xref:System.Windows.Automation.Condition.TrueCondition>, because it does not filter elements by their <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> or <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> properties.</span></span>  
  
 <span data-ttu-id="387f3-122">D’autres conditions sont développées à partir d’un ou plusieurs objets <xref:System.Windows.Automation.PropertyCondition> , chacun spécifiant une valeur de propriété.</span><span class="sxs-lookup"><span data-stu-id="387f3-122">Other conditions are built up from one or more <xref:System.Windows.Automation.PropertyCondition> objects, each of which specifies a property value.</span></span> <span data-ttu-id="387f3-123">Par exemple, une condition <xref:System.Windows.Automation.PropertyCondition> peut spécifier que l’élément est activé ou qu’il prend en charge un certain modèle de contrôle.</span><span class="sxs-lookup"><span data-stu-id="387f3-123">For example, a <xref:System.Windows.Automation.PropertyCondition> might specify that the element is enabled, or that it supports a certain control pattern.</span></span>  
  
 <span data-ttu-id="387f3-124">Les conditions peuvent être combinées à l’aide d’une logique booléenne en construisant des objets de types <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>et <xref:System.Windows.Automation.NotCondition>.</span><span class="sxs-lookup"><span data-stu-id="387f3-124">Conditions can be combined using Boolean logic by constructing objects of types <xref:System.Windows.Automation.AndCondition>, <xref:System.Windows.Automation.OrCondition>, and <xref:System.Windows.Automation.NotCondition>.</span></span>  
  
<a name="Search_Scope"></a>

## <a name="search-scope"></a><span data-ttu-id="387f3-125">Étendue de recherche</span><span class="sxs-lookup"><span data-stu-id="387f3-125">Search Scope</span></span>  

 <span data-ttu-id="387f3-126">Les recherches effectuées à l’aide de <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> ou <xref:System.Windows.Automation.AutomationElement.FindAll%2A> doivent avoir une étendue et un point de départ.</span><span class="sxs-lookup"><span data-stu-id="387f3-126">Searches done by using <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> or <xref:System.Windows.Automation.AutomationElement.FindAll%2A> must have a scope as well as a starting-place.</span></span>  
  
 <span data-ttu-id="387f3-127">L’étendue définit l’espace autour du point de départ dans lequel doit avoir lieu la recherche.</span><span class="sxs-lookup"><span data-stu-id="387f3-127">The scope defines the space around the starting-place that is to be searched.</span></span> <span data-ttu-id="387f3-128">Cela peut inclure l’élément lui-même, ses frères, son parent, ses ancêtres, ses enfants immédiats et ses descendants.</span><span class="sxs-lookup"><span data-stu-id="387f3-128">This might include the element itself, its siblings, its parent, its ancestors, its immediate children, and its descendants.</span></span>  
  
 <span data-ttu-id="387f3-129">L’étendue d’une recherche est définie par une combinaison de valeurs au niveau du bit de l’énumération <xref:System.Windows.Automation.TreeScope> .</span><span class="sxs-lookup"><span data-stu-id="387f3-129">The scope of a search is defined by a bitwise combination of values from the <xref:System.Windows.Automation.TreeScope> enumeration.</span></span>  
  
<a name="Finding_a_Known_Element"></a>

## <a name="finding-a-known-element"></a><span data-ttu-id="387f3-130">Recherche d’un élément connu</span><span class="sxs-lookup"><span data-stu-id="387f3-130">Finding a Known Element</span></span>  

 <span data-ttu-id="387f3-131">Pour rechercher un élément connu, identifié par sa propriété <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>ou une autre propriété ou combinaison de propriétés, il est plus facile d’utiliser la méthode <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> .</span><span class="sxs-lookup"><span data-stu-id="387f3-131">To find a known element, identified by its <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.Name%2A>, <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.AutomationId%2A>, or some other property or combination of properties, it is easiest to use the <xref:System.Windows.Automation.AutomationElement.FindFirst%2A> method.</span></span> <span data-ttu-id="387f3-132">Si l’élément recherché est une fenêtre d’application, le point de départ de la recherche peut être <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span><span class="sxs-lookup"><span data-stu-id="387f3-132">If the element sought is an application window, the starting-point of the search can be the <xref:System.Windows.Automation.AutomationElement.RootElement%2A>.</span></span>  
  
 <span data-ttu-id="387f3-133">Cette façon de rechercher des éléments [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] est particulièrement utile dans les scénarios de tests automatisés.</span><span class="sxs-lookup"><span data-stu-id="387f3-133">This way of finding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] elements is most useful in automated testing scenarios.</span></span>  
  
<a name="Finding_Elements_in_a_Subtree"></a>

## <a name="finding-elements-in-a-subtree"></a><span data-ttu-id="387f3-134">Recherche d’éléments dans une sous-arborescence</span><span class="sxs-lookup"><span data-stu-id="387f3-134">Finding Elements in a Subtree</span></span>  

 <span data-ttu-id="387f3-135">Pour rechercher tous les éléments répondant à des critères spécifiques liés à un élément connu, vous pouvez utiliser <xref:System.Windows.Automation.AutomationElement.FindAll%2A>.</span><span class="sxs-lookup"><span data-stu-id="387f3-135">To find all elements meeting specific criteria that are related to a known element, you can use <xref:System.Windows.Automation.AutomationElement.FindAll%2A>.</span></span> <span data-ttu-id="387f3-136">Par exemple, vous pouvez utiliser cette méthode pour récupérer des éléments de liste ou des éléments de menu d’une liste ou d’un menu, ou pour identifier tous les contrôles d’une boîte de dialogue.</span><span class="sxs-lookup"><span data-stu-id="387f3-136">For example, you could use this method to retrieve list items or menu items from a list or menu, or to identify all controls in a dialog box.</span></span>  
  
<a name="Walking_a_Subtree"></a>

## <a name="walking-a-subtree"></a><span data-ttu-id="387f3-137">Parcourir une sous-arborescence</span><span class="sxs-lookup"><span data-stu-id="387f3-137">Walking a Subtree</span></span>  

 <span data-ttu-id="387f3-138">Si vous ne connaissez pas au préalable les applications avec lesquelles votre client peut être utilisé, vous pouvez construire une sous-arborescence de tous les éléments d’intérêt à l’aide de la classe <xref:System.Windows.Automation.TreeWalker> .</span><span class="sxs-lookup"><span data-stu-id="387f3-138">If you have no prior knowledge of the applications that your client may be used with, you can construct a subtree of all elements of interest by using the <xref:System.Windows.Automation.TreeWalker> class.</span></span> <span data-ttu-id="387f3-139">Votre application peut le faire en réponse à un événement de modification de focus, c’est-à-dire, quand une application ou un contrôle reçoit le focus d’entrée, le client UI Automation examine les enfants, voire tous les descendants de l’élément ayant le focus.</span><span class="sxs-lookup"><span data-stu-id="387f3-139">Your application might do this in response to a focus-changed event; that is, when an application or control receives input focus, the UI Automation client examines children and perhaps all descendants of the focused element.</span></span>  
  
 <span data-ttu-id="387f3-140">Une autre façon d’utiliser <xref:System.Windows.Automation.TreeWalker> est d’identifier les ancêtres d’un élément.</span><span class="sxs-lookup"><span data-stu-id="387f3-140">Another way in which <xref:System.Windows.Automation.TreeWalker> can be used is to identify the ancestors of an element.</span></span> <span data-ttu-id="387f3-141">Par exemple, en parcourant l’arborescence, vous pouvez identifier la fenêtre parente d’un contrôle.</span><span class="sxs-lookup"><span data-stu-id="387f3-141">For example, by walking up the tree you can identify the parent window of a control.</span></span>  
  
 <span data-ttu-id="387f3-142">Vous pouvez utiliser <xref:System.Windows.Automation.TreeWalker> en créant un objet de la classe (qui définit les éléments d’intérêt en passant une condition <xref:System.Windows.Automation.Condition>), ou à l’aide de l’un des objets prédéfinis suivants, définis en tant que champs de <xref:System.Windows.Automation.TreeWalker>.</span><span class="sxs-lookup"><span data-stu-id="387f3-142">You can use <xref:System.Windows.Automation.TreeWalker> either by creating an object of the class (defining the elements of interest by passing a <xref:System.Windows.Automation.Condition>), or by using one of the following predefined objects that are defined as fields of <xref:System.Windows.Automation.TreeWalker>.</span></span>  
  
|||  
|-|-|  
|<xref:System.Windows.Automation.TreeWalker.ContentViewWalker>|<span data-ttu-id="387f3-143">Recherche uniquement les éléments dont la propriété <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> est `true`.</span><span class="sxs-lookup"><span data-stu-id="387f3-143">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.ControlViewWalker>|<span data-ttu-id="387f3-144">Recherche uniquement les éléments dont la propriété <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> est `true`.</span><span class="sxs-lookup"><span data-stu-id="387f3-144">Finds only elements whose <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> property is `true`.</span></span>|  
|<xref:System.Windows.Automation.TreeWalker.RawViewWalker>|<span data-ttu-id="387f3-145">Recherche tous les éléments.</span><span class="sxs-lookup"><span data-stu-id="387f3-145">Finds all elements.</span></span>|  
  
 <span data-ttu-id="387f3-146">Une fois que vous avez obtenu un <xref:System.Windows.Automation.TreeWalker>, son utilisation est simple.</span><span class="sxs-lookup"><span data-stu-id="387f3-146">After you have obtained a <xref:System.Windows.Automation.TreeWalker>, using it is straightforward.</span></span> <span data-ttu-id="387f3-147">Appelez simplement les méthodes `Get` pour naviguer entre les éléments de la sous-arborescence.</span><span class="sxs-lookup"><span data-stu-id="387f3-147">Simply call the `Get` methods to navigate among elements of the subtree.</span></span>  
  
 <span data-ttu-id="387f3-148">La méthode <xref:System.Windows.Automation.TreeWalker.Normalize%2A> peut être utilisée pour naviguer vers un élément dans la sous-arborescence à partir d’un autre élément qui ne fait pas partie de l’affichage.</span><span class="sxs-lookup"><span data-stu-id="387f3-148">The <xref:System.Windows.Automation.TreeWalker.Normalize%2A> method can be used for navigating to an element in the subtree from another element that is not part of the view.</span></span> <span data-ttu-id="387f3-149">Par exemple, supposons que vous avez créé un affichage d’une sous-arborescence à l’aide de <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>.</span><span class="sxs-lookup"><span data-stu-id="387f3-149">For example, suppose you have created a view of a subtree by using <xref:System.Windows.Automation.TreeWalker.ContentViewWalker>.</span></span> <span data-ttu-id="387f3-150">Votre application reçoit une notification l’informant qu’une barre de défilement a reçu le focus d’entrée.</span><span class="sxs-lookup"><span data-stu-id="387f3-150">Your application then receives notification that a scroll bar has received the input focus.</span></span> <span data-ttu-id="387f3-151">Comme une barre de défilement n’est pas un élément de contenu, elle n’est pas présente dans l’affichage de la sous-arborescence.</span><span class="sxs-lookup"><span data-stu-id="387f3-151">Because a scroll bar is not a content element, it is not present in your view of the subtree.</span></span> <span data-ttu-id="387f3-152">Toutefois, vous pouvez passer <xref:System.Windows.Automation.AutomationElement> qui représente la barre de défilement à <xref:System.Windows.Automation.TreeWalker.Normalize%2A> et récupérer l’ancêtre le plus proche qui se trouve dans l’affichage de contenu.</span><span class="sxs-lookup"><span data-stu-id="387f3-152">However, you can pass the <xref:System.Windows.Automation.AutomationElement> representing the scroll bar to <xref:System.Windows.Automation.TreeWalker.Normalize%2A> and retrieve the nearest ancestor that is in the content view.</span></span>  
  
<a name="Other_Ways_to_Retrieve_an_Element"></a>

## <a name="other-ways-to-retrieve-an-element"></a><span data-ttu-id="387f3-153">Autres moyens de récupérer un élément</span><span class="sxs-lookup"><span data-stu-id="387f3-153">Other Ways to Retrieve an Element</span></span>  

 <span data-ttu-id="387f3-154">Outre les recherches et la navigation, vous pouvez récupérer un <xref:System.Windows.Automation.AutomationElement> des façons suivantes.</span><span class="sxs-lookup"><span data-stu-id="387f3-154">In addition to searches and navigation, you can retrieve an <xref:System.Windows.Automation.AutomationElement> in the following ways.</span></span>  
  
### <a name="from-an-event"></a><span data-ttu-id="387f3-155">À partir d’un événement</span><span class="sxs-lookup"><span data-stu-id="387f3-155">From an Event</span></span>  

 <span data-ttu-id="387f3-156">Quand votre application reçoit un événement [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] , l’objet source passé à votre gestionnaire d’événements est un <xref:System.Windows.Automation.AutomationElement>.</span><span class="sxs-lookup"><span data-stu-id="387f3-156">When your application receives a [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] event, the source object passed to your event handler is an <xref:System.Windows.Automation.AutomationElement>.</span></span> <span data-ttu-id="387f3-157">Par exemple, si vous êtes abonné à des événements de changement de focus, la source passée à votre <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> est l’élément qui a reçu le focus.</span><span class="sxs-lookup"><span data-stu-id="387f3-157">For example, if you have subscribed to focus-changed events, the source passed to your <xref:System.Windows.Automation.AutomationFocusChangedEventHandler> is the element that received the focus.</span></span>  
  
 <span data-ttu-id="387f3-158">Pour plus d'informations, consultez [Subscribe to UI Automation Events](subscribe-to-ui-automation-events.md).</span><span class="sxs-lookup"><span data-stu-id="387f3-158">For more information, see [Subscribe to UI Automation Events](subscribe-to-ui-automation-events.md).</span></span>  
  
### <a name="from-a-point"></a><span data-ttu-id="387f3-159">À partir d’un point</span><span class="sxs-lookup"><span data-stu-id="387f3-159">From a Point</span></span>  

 <span data-ttu-id="387f3-160">Si vous disposez de coordonnées d’écran (par exemple, la position d’un curseur), vous pouvez récupérer un <xref:System.Windows.Automation.AutomationElement> à l’aide de la méthode statique <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> .</span><span class="sxs-lookup"><span data-stu-id="387f3-160">If you have screen coordinates (for example, a cursor position), you can retrieve an <xref:System.Windows.Automation.AutomationElement> by using the static <xref:System.Windows.Automation.AutomationElement.FromPoint%2A> method.</span></span>  
  
### <a name="from-a-window-handle"></a><span data-ttu-id="387f3-161">À partir d’un handle de fenêtre</span><span class="sxs-lookup"><span data-stu-id="387f3-161">From a Window Handle</span></span>  

 <span data-ttu-id="387f3-162">Pour récupérer un <xref:System.Windows.Automation.AutomationElement> à partir d’un HWND, utilisez la méthode statique <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> .</span><span class="sxs-lookup"><span data-stu-id="387f3-162">To retrieve an <xref:System.Windows.Automation.AutomationElement> from an HWND, use the static <xref:System.Windows.Automation.AutomationElement.FromHandle%2A> method.</span></span>  
  
### <a name="from-the-focused-control"></a><span data-ttu-id="387f3-163">À partir du contrôle ayant le focus</span><span class="sxs-lookup"><span data-stu-id="387f3-163">From the Focused Control</span></span>  

 <span data-ttu-id="387f3-164">Vous pouvez récupérer un <xref:System.Windows.Automation.AutomationElement> qui représente le contrôle ayant le focus à partir de la propriété statique <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> .</span><span class="sxs-lookup"><span data-stu-id="387f3-164">You can retrieve an <xref:System.Windows.Automation.AutomationElement> that represents the focused control from the static <xref:System.Windows.Automation.AutomationElement.FocusedElement%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="387f3-165">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="387f3-165">See also</span></span>

- [<span data-ttu-id="387f3-166">Rechercher un élément UI Automation basé sur une condition de propriété</span><span class="sxs-lookup"><span data-stu-id="387f3-166">Find a UI Automation Element Based on a Property Condition</span></span>](find-a-ui-automation-element-based-on-a-property-condition.md)
- [<span data-ttu-id="387f3-167">Naviguer entre les éléments UI Automation avec TreeWalker</span><span class="sxs-lookup"><span data-stu-id="387f3-167">Navigate Among UI Automation Elements with TreeWalker</span></span>](navigate-among-ui-automation-elements-with-treewalker.md)
- [<span data-ttu-id="387f3-168">Vue d’ensemble de l’arborescence UI Automation</span><span class="sxs-lookup"><span data-stu-id="387f3-168">UI Automation Tree Overview</span></span>](ui-automation-tree-overview.md)

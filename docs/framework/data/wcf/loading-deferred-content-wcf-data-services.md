---
title: Chargement de contenu différé (services de données WCF)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, client library
- WCF Data Services, deferred content
- WCF Data Services, loading data
ms.assetid: 32f9b588-c832-44c4-a7e0-fcce635df59a
ms.openlocfilehash: db0127712ab0cb4586b364abf899bcf4765632d7
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "64645602"
---
# <a name="loading-deferred-content-wcf-data-services"></a><span data-ttu-id="fafcb-102">Chargement de contenu différé (services de données WCF)</span><span class="sxs-lookup"><span data-stu-id="fafcb-102">Loading Deferred Content (WCF Data Services)</span></span>
<span data-ttu-id="fafcb-103">Par défaut, [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] limite la quantité de données retournées par une requête.</span><span class="sxs-lookup"><span data-stu-id="fafcb-103">By default, [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] limits the amount of data that a query returns.</span></span> <span data-ttu-id="fafcb-104">Toutefois, vous pouvez charger explicitement des données supplémentaires, notamment les entités connexes, les données de réponse paginées et les flux de données binaires, à partir du service de données si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="fafcb-104">However, you can explicitly load additional data, including related entities, paged response data, and binary data streams, from the data service when it is needed.</span></span> <span data-ttu-id="fafcb-105">Cette rubrique décrit comment charger un contenu différé dans votre application.</span><span class="sxs-lookup"><span data-stu-id="fafcb-105">This topic describes how to load such deferred content into your application.</span></span>  
  
## <a name="related-entities"></a><span data-ttu-id="fafcb-106">Entités connexes</span><span class="sxs-lookup"><span data-stu-id="fafcb-106">Related Entities</span></span>  
 <span data-ttu-id="fafcb-107">Lorsque vous exécutez une requête, seules les entités dans le jeu d'entités traitées sont retournées.</span><span class="sxs-lookup"><span data-stu-id="fafcb-107">When you execute a query, only entities in the addressed entity set are returned.</span></span> <span data-ttu-id="fafcb-108">Par exemple, lorsqu'une requête exécutée sur le service de données Northwind retourne les entités `Customers`, par défaut, les entités `Orders` connexes ne sont pas retournées, même s'il existe une relation entre `Customers` et `Orders`.</span><span class="sxs-lookup"><span data-stu-id="fafcb-108">For example, when a query against the Northwind data service returns `Customers` entities, by default the related `Orders` entities are not returned, even though there is a relationship between `Customers` and `Orders`.</span></span> <span data-ttu-id="fafcb-109">De plus, lorsque la pagination est autorisée dans le service de données, vous devez charger explicitement les pages de données suivantes à partir du service.</span><span class="sxs-lookup"><span data-stu-id="fafcb-109">Also, when paging is enabled in the data service, you must explicitly load subsequent data pages from the service.</span></span> <span data-ttu-id="fafcb-110">Il y a deux façons de charger des entités connexes :</span><span class="sxs-lookup"><span data-stu-id="fafcb-110">There are two ways to load related entities:</span></span>  
  
- <span data-ttu-id="fafcb-111">**Le chargement hâtif**: Vous pouvez utiliser la `$expand` option de requête pour demander que la requête retourne des entités liées par une association à l’entité qui a défini la requête demandée.</span><span class="sxs-lookup"><span data-stu-id="fafcb-111">**Eager loading**: You can use the `$expand` query option to request that the query return entities that are related by an association to the entity set that the query requested.</span></span> <span data-ttu-id="fafcb-112">Utilisez la méthode <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> sur le <xref:System.Data.Services.Client.DataServiceQuery%601> pour ajouter l'option `$expand` à la requête envoyée au service de données.</span><span class="sxs-lookup"><span data-stu-id="fafcb-112">Use the <xref:System.Data.Services.Client.DataServiceQuery%601.Expand%2A> method on the <xref:System.Data.Services.Client.DataServiceQuery%601> to add the `$expand` option to the query that is sent to the data service.</span></span> <span data-ttu-id="fafcb-113">Vous pouvez demander plusieurs jeux d'entités connexes en les séparant par une virgule, comme dans l'exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="fafcb-113">You can request multiple related entity sets by separating them by a comma, as in the following example.</span></span> <span data-ttu-id="fafcb-114">Toutes les entités demandées par la requête sont retournées dans une réponse unique.</span><span class="sxs-lookup"><span data-stu-id="fafcb-114">All entities requested by the query are returned in a single response.</span></span> <span data-ttu-id="fafcb-115">L'exemple de code suivant retourne `Order_Details` et `Customers` ainsi que le jeu d'entités `Orders` :</span><span class="sxs-lookup"><span data-stu-id="fafcb-115">The following example returns `Order_Details` and `Customers` together with the `Orders` entity set:</span></span>  
  
     [!code-csharp[Astoria Northwind Client#ExpandOrderDetailsSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#expandorderdetailsspecific)]
     [!code-vb[Astoria Northwind Client#ExpandOrderDetailsSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#expandorderdetailsspecific)]  
  
     [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] <span data-ttu-id="fafcb-116">limite à 12 le nombre de jeux d'entités pouvant être inclus dans une requête unique à l'aide de l'option de requête `$expand`.</span><span class="sxs-lookup"><span data-stu-id="fafcb-116">limits to 12 the number of entity sets that can be included in a single query by using the `$expand` query option.</span></span>  
  
- <span data-ttu-id="fafcb-117">**Chargement explicite**: Vous pouvez appeler la <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> méthode sur le <xref:System.Data.Services.Client.DataServiceContext> instance pour charger explicitement des entités associées.</span><span class="sxs-lookup"><span data-stu-id="fafcb-117">**Explicit loading**: You can call the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method on the <xref:System.Data.Services.Client.DataServiceContext> instance to explicitly load related entities.</span></span> <span data-ttu-id="fafcb-118">Chaque appel à la méthode <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> crée une demande séparée au service de données.</span><span class="sxs-lookup"><span data-stu-id="fafcb-118">Each call to the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method creates a separate request to the data service.</span></span> <span data-ttu-id="fafcb-119">L'exemple suivant charge explicitement `Order_Details` pour une entité `Orders` :</span><span class="sxs-lookup"><span data-stu-id="fafcb-119">The following example explicitly loads `Order_Details` for an `Orders` entity:</span></span>  
  
     [!code-csharp[Astoria Northwind Client#LoadRelatedOrderDetailsSpecific](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#loadrelatedorderdetailsspecific)]
     [!code-vb[Astoria Northwind Client#LoadRelatedOrderDetailsSpecific](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#loadrelatedorderdetailsspecific)]  
  
 <span data-ttu-id="fafcb-120">Au moment de choisir l'option à utiliser, sachez qu'il y a une corrélation entre le nombre de demandes adressées au service de données et la quantité de données retournées dans une réponse individuelle.</span><span class="sxs-lookup"><span data-stu-id="fafcb-120">When you consider which option to use, realize that there is a tradeoff between the number of requests to the data service and the amount of data that is returned in a single response.</span></span> <span data-ttu-id="fafcb-121">Utilisez le chargement hâtif lorsque votre application requiert des objets associés et que vous souhaitez éviter la latence liée aux demandes supplémentaires nécessaires à leur récupération explicite.</span><span class="sxs-lookup"><span data-stu-id="fafcb-121">Use eager loading when your application requires associated objects and you want to avoid the added latency of additional requests to explicitly retrieve them.</span></span> <span data-ttu-id="fafcb-122">Toutefois, s'il y a des cas où l'application ne nécessite que les données pour les instances d'entité connexes spécifiques, vous devez envisager de charger explicitement ces entités en appelant la méthode <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A>.</span><span class="sxs-lookup"><span data-stu-id="fafcb-122">However, if there are cases when the application only needs the data for specific related entity instances, you should consider explicitly loading those entities by calling the <xref:System.Data.Services.Client.DataServiceContext.LoadProperty%2A> method.</span></span> <span data-ttu-id="fafcb-123">Pour plus d'informations, voir [Procédure : Charger des entités connexes](../../../../docs/framework/data/wcf/how-to-load-related-entities-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="fafcb-123">For more information, see [How to: Load Related Entities](../../../../docs/framework/data/wcf/how-to-load-related-entities-wcf-data-services.md).</span></span>  
  
## <a name="paged-content"></a><span data-ttu-id="fafcb-124">Contenu paginé</span><span class="sxs-lookup"><span data-stu-id="fafcb-124">Paged Content</span></span>  
 <span data-ttu-id="fafcb-125">Lorsque la pagination est autorisée dans le service de données, le nombre d'entrées dans le flux qui sont retournées par le service de données est limité par la configuration du service de données.</span><span class="sxs-lookup"><span data-stu-id="fafcb-125">When paging is enabled in the data service, the number of entries in the feed that the data service returns is limited by the configuration of the data service.</span></span> <span data-ttu-id="fafcb-126">Des limites de pPage peuvent être définies séparément pour chaque jeu d'entités.</span><span class="sxs-lookup"><span data-stu-id="fafcb-126">Page limits can be set separately for each entity set.</span></span> <span data-ttu-id="fafcb-127">Pour plus d’informations, consultez [configuration du Service de données](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="fafcb-127">For more information, see [Configuring the Data Service](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md).</span></span> <span data-ttu-id="fafcb-128">Lorsque la pagination est activée, la dernière entrée dans le flux contient un lien vers la page suivante de données.</span><span class="sxs-lookup"><span data-stu-id="fafcb-128">When paging is enabled, the final entry in the feed contains a link to the next page of data.</span></span> <span data-ttu-id="fafcb-129">Ce lien est contenu dans un objet <xref:System.Data.Services.Client.DataServiceQueryContinuation%601>.</span><span class="sxs-lookup"><span data-stu-id="fafcb-129">This link is contained in a <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> object.</span></span> <span data-ttu-id="fafcb-130">Vous obtenez l'URI vers la page suivante de données en appelant la méthode <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> sur le <xref:System.Data.Services.Client.QueryOperationResponse%601> retourné lorsque <xref:System.Data.Services.Client.DataServiceQuery%601> est exécuté.</span><span class="sxs-lookup"><span data-stu-id="fafcb-130">You obtain the URI to the next page of data by calling the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method on the <xref:System.Data.Services.Client.QueryOperationResponse%601> returned when the <xref:System.Data.Services.Client.DataServiceQuery%601> is executed.</span></span> <span data-ttu-id="fafcb-131">L'objet <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> retourné est ensuite utilisé pour charger la page suivante de résultats.</span><span class="sxs-lookup"><span data-stu-id="fafcb-131">The returned <xref:System.Data.Services.Client.DataServiceQueryContinuation%601> object is then used to load the next page of results.</span></span> <span data-ttu-id="fafcb-132">Vous devez énumérer le résultat de la requête avant d'appeler la méthode <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A>.</span><span class="sxs-lookup"><span data-stu-id="fafcb-132">You must enumerate the query result before you call the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method.</span></span> <span data-ttu-id="fafcb-133">Envisagez d'utiliser une boucle `do…while` pour énumérer en premier le résultat de la requête, puis rechercher une valeur `non-null` de lien suivante.</span><span class="sxs-lookup"><span data-stu-id="fafcb-133">Consider using a `do…while` loop to first enumerate the query result and then check for a `non-null` next link value.</span></span> <span data-ttu-id="fafcb-134">Lorsque la méthode <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> retourne `null` (`Nothing` en Visual Basic), il n'y a aucune page de résultat supplémentaire pour la requête d'origine.</span><span class="sxs-lookup"><span data-stu-id="fafcb-134">When the <xref:System.Data.Services.Client.QueryOperationResponse%601.GetContinuation%2A> method returns `null` (`Nothing` in Visual Basic), there are no additional result pages for the original query.</span></span> <span data-ttu-id="fafcb-135">L'exemple suivant affiche une boucle `do…while` qui charges des données clientes paginées depuis l'exemple de service de données Northwind.</span><span class="sxs-lookup"><span data-stu-id="fafcb-135">The following example shows a `do…while` loop that loads paged customer data from the Northwind sample data service.</span></span>  
  
 [!code-csharp[Astoria Northwind Client#LoadNextLink](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#loadnextlink)]
 [!code-vb[Astoria Northwind Client#LoadNextLink](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#loadnextlink)]  
  
 <span data-ttu-id="fafcb-136">Lorsqu'une requête demande que les entités connexes soient retournées dans une réponse unique avec le jeu d'entités demandé, des limites de pagination peuvent affecter les flux imbriqués inclus inline avec la réponse.</span><span class="sxs-lookup"><span data-stu-id="fafcb-136">When a query requests that related entities are returned in a single response together with the requested entity set, paging limits may affect nested feeds that are included inline with the response.</span></span> <span data-ttu-id="fafcb-137">Par exemple, lorsqu'une limite de pagination est définie dans l'exemple de service de données Northwind pour le jeu d'entités `Customers`, une limite de pagination indépendante peut également être définie pour le jeu d'entités `Orders` connexe, comme dans l'exemple suivant du fichier Northwind.svc.cs qui définit l'exemple de service de données Northwind.</span><span class="sxs-lookup"><span data-stu-id="fafcb-137">For example, when a paging limit is set in the Northwind sample data service for the `Customers` entity set, an independent paging limit can also be set for the related `Orders` entity set, as in the following example from the Northwind.svc.cs file that defines the Northwind sample data service.</span></span>  
  
 [!code-csharp[Astoria Northwind Service#DataServiceConfigPaging](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_service/cs/northwind.svc.cs#dataserviceconfigpaging)]
 [!code-vb[Astoria Northwind Service#DataServiceConfigPaging](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_service/vb/northwind.svc.vb#dataserviceconfigpaging)]  
  
 <span data-ttu-id="fafcb-138">Dans ce cas, vous devez implémenter la pagination pour le `Customers` de niveau supérieur et les flux d'entité `Orders` imbriqués.</span><span class="sxs-lookup"><span data-stu-id="fafcb-138">In this case, you must implement paging for both the top-level `Customers` and the nested `Orders` entity feeds.</span></span> <span data-ttu-id="fafcb-139">L'exemple suivant montre la boucle `while` utilisée pour charger des pages d'entités `Orders` associées à une entité `Customers` sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="fafcb-139">The following example shows the `while` loop used to load pages of `Orders` entities related to a selected `Customers` entity.</span></span>  
  
 [!code-csharp[Astoria Northwind Client#LoadNextOrdersLink](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_client/cs/source.cs#loadnextorderslink)]
 [!code-vb[Astoria Northwind Client#LoadNextOrdersLink](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_client/vb/source.vb#loadnextorderslink)]  
  
 <span data-ttu-id="fafcb-140">Pour plus d'informations, voir [Procédure : Charger des résultats paginés](../../../../docs/framework/data/wcf/how-to-load-paged-results-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="fafcb-140">For more information, see [How to: Load Paged Results](../../../../docs/framework/data/wcf/how-to-load-paged-results-wcf-data-services.md).</span></span>  
  
## <a name="binary-data-streams"></a><span data-ttu-id="fafcb-141">Flux de données binaires</span><span class="sxs-lookup"><span data-stu-id="fafcb-141">Binary Data Streams</span></span>  
 [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] <span data-ttu-id="fafcb-142">vous permet d'accéder à des données d'objet BLOB (binary large object) comme un flux de données.</span><span class="sxs-lookup"><span data-stu-id="fafcb-142">enables you to access binary large object (BLOB) data as a data stream.</span></span> <span data-ttu-id="fafcb-143">La diffusion en continu diffère le chargement des données binaires tant qu'elles ne sont pas nécessaires, et le client peut traiter ces données plus efficacement.</span><span class="sxs-lookup"><span data-stu-id="fafcb-143">Streaming defers the loading of binary data until it is needed, and the client can more efficiently process this data.</span></span> <span data-ttu-id="fafcb-144">Pour tirer parti de ces fonctionnalités, le service de données doit implémenter le fournisseur <xref:System.Data.Services.Providers.IDataServiceStreamProvider>.</span><span class="sxs-lookup"><span data-stu-id="fafcb-144">In order to take advantage of this functionality, the data service must implement the <xref:System.Data.Services.Providers.IDataServiceStreamProvider> provider.</span></span> <span data-ttu-id="fafcb-145">Pour plus d’informations, consultez [fournisseur de diffusion en continu](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="fafcb-145">For more information, see [Streaming Provider](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).</span></span> <span data-ttu-id="fafcb-146">Lorsque la diffusion en continu est activée, les types d'entité sont retournés sans les données binaires associées.</span><span class="sxs-lookup"><span data-stu-id="fafcb-146">When streaming is enabled, entity types are returned without the related binary data.</span></span> <span data-ttu-id="fafcb-147">Dans ce cas, vous devez utiliser le <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> méthode de la <xref:System.Data.Services.Client.DataServiceContext> classe pour accéder au flux de données pour les données binaires à partir du service.</span><span class="sxs-lookup"><span data-stu-id="fafcb-147">In this case, you must use the <xref:System.Data.Services.Client.DataServiceContext.GetReadStream%2A> method of the <xref:System.Data.Services.Client.DataServiceContext> class to access the data stream for the binary data from the service.</span></span> <span data-ttu-id="fafcb-148">De la même façon, utilisez la méthode <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> pour ajouter ou modifier les données binaires pour une entité comme un flux de données.</span><span class="sxs-lookup"><span data-stu-id="fafcb-148">Similarly, use the <xref:System.Data.Services.Client.DataServiceContext.SetSaveStream%2A> method to add or change binary data for an entity as a stream.</span></span> <span data-ttu-id="fafcb-149">Pour plus d’informations, consultez [utilisation des données binaires](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="fafcb-149">For more information, see [Working with Binary Data](../../../../docs/framework/data/wcf/working-with-binary-data-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="fafcb-150">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="fafcb-150">See also</span></span>

- [<span data-ttu-id="fafcb-151">Bibliothèque cliente WCF Data Services</span><span class="sxs-lookup"><span data-stu-id="fafcb-151">WCF Data Services Client Library</span></span>](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)
- [<span data-ttu-id="fafcb-152">Interrogation du service de données</span><span class="sxs-lookup"><span data-stu-id="fafcb-152">Querying the Data Service</span></span>](../../../../docs/framework/data/wcf/querying-the-data-service-wcf-data-services.md)

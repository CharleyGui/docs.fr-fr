---
title: Opérations de traitement par lots (services de données WCF)
ms.date: 03/30/2017
helpviewer_keywords:
- WCF Data Services, client library
ms.assetid: 962a49d1-cc11-4b96-bc7d-071dd6607d6c
ms.openlocfilehash: 95524c1397172e645d682a6ef3f03b17bb3a639d
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/24/2020
ms.locfileid: "91166064"
---
# <a name="batching-operations-wcf-data-services"></a><span data-ttu-id="54bf4-102">Opérations de traitement par lots (services de données WCF)</span><span class="sxs-lookup"><span data-stu-id="54bf4-102">Batching Operations (WCF Data Services)</span></span>

<span data-ttu-id="54bf4-103">Le Open Data Protocol (OData) prend en charge le traitement par lots des demandes à un service OData.</span><span class="sxs-lookup"><span data-stu-id="54bf4-103">The Open Data Protocol (OData) supports batch processing of requests to an OData-based service.</span></span> <span data-ttu-id="54bf4-104">Pour plus d’informations, consultez [OData : traitement par lots](https://www.odata.org/documentation/odata-version-2-0/batch-processing/).</span><span class="sxs-lookup"><span data-stu-id="54bf4-104">For more information, see [OData: Batch Processing](https://www.odata.org/documentation/odata-version-2-0/batch-processing/).</span></span> <span data-ttu-id="54bf4-105">Dans WCF Data Services, chaque opération qui utilise <xref:System.Data.Services.Client.DataServiceContext> , telle que l’exécution d’une requête ou l’enregistrement de modifications, entraîne l’envoi d’une demande séparée au service de données.</span><span class="sxs-lookup"><span data-stu-id="54bf4-105">In WCF Data Services, each operation that uses the <xref:System.Data.Services.Client.DataServiceContext>, such as executing a query or saving changes, results in a separate request being sent to the data service.</span></span> <span data-ttu-id="54bf4-106">Pour maintenir une étendue logique pour les jeux d'opérations, vous pouvez définir explicitement des lots opérationnels.</span><span class="sxs-lookup"><span data-stu-id="54bf4-106">In order to maintain a logical scope for sets of operations, you can explicitly define operational batches.</span></span> <span data-ttu-id="54bf4-107">Cela garantit que toutes les opérations dans le lot sont envoyées au service de données dans une requête HTTP unique, et cela permet au serveur de traiter les opérations de manière atomique et de réduire le nombre de boucles vers le service de données.</span><span class="sxs-lookup"><span data-stu-id="54bf4-107">This ensures that all operations in the batch are sent to the data service in a single HTTP request, enables the server to process the operations atomically, and reduces the number of round trips to the data service.</span></span>  
  
## <a name="batching-query-operations"></a><span data-ttu-id="54bf4-108">Opérations de traitement par lot des requêtes</span><span class="sxs-lookup"><span data-stu-id="54bf4-108">Batching Query Operations</span></span>  

 <span data-ttu-id="54bf4-109">Pour exécuter plusieurs requêtes dans un lot unique, vous devez créer chaque requête dans le lot comme une instance distincte de la classe <xref:System.Data.Services.Client.DataServiceRequest%601>.</span><span class="sxs-lookup"><span data-stu-id="54bf4-109">To execute multiple queries in a single batch, you must create each query in the batch as a separate instance of the <xref:System.Data.Services.Client.DataServiceRequest%601> class.</span></span> <span data-ttu-id="54bf4-110">Lorsque vous créez une requête d'interrogation de cette manière, la requête elle-même est définie comme un URI, et elle suit les règles pour l'adressage de ressources.</span><span class="sxs-lookup"><span data-stu-id="54bf4-110">When you create a query request in this manner, the query itself is defined as a URI, and it follows the rules for addressing resources.</span></span> <span data-ttu-id="54bf4-111">Pour plus d’informations, consultez [accès aux ressources du service de données](accessing-data-service-resources-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="54bf4-111">For more information, see [Accessing Data Service Resources](accessing-data-service-resources-wcf-data-services.md).</span></span> <span data-ttu-id="54bf4-112">Les requêtes d'interrogation par lot sont envoyées au service de données lorsque la méthode <xref:System.Data.Services.Client.DataServiceContext.ExecuteBatch%2A> est appelée qui contient les objets de requête d'interrogation.</span><span class="sxs-lookup"><span data-stu-id="54bf4-112">The batched query requests are sent to the data service when the <xref:System.Data.Services.Client.DataServiceContext.ExecuteBatch%2A> method is called that contains the query request objects.</span></span> <span data-ttu-id="54bf4-113">Cette méthode retourne un objet <xref:System.Data.Services.Client.DataServiceResponse> qui est une collection d’objets <xref:System.Data.Services.Client.QueryOperationResponse%601> qui représentent des réponses aux requêtes individuelles dans le lot, chacune contenant une collection d’objets retournés par la requête ou des informations d’erreur.</span><span class="sxs-lookup"><span data-stu-id="54bf4-113">This method returns a <xref:System.Data.Services.Client.DataServiceResponse> object, which is a collection of <xref:System.Data.Services.Client.QueryOperationResponse%601> objects that represent responses to individual queries in the batch, each of which contains either a collection of objects returned by the query or error information.</span></span> <span data-ttu-id="54bf4-114">Lorsqu'une opération de requête unique dans le lot échoue, les informations d'erreur sont retournées dans l'objet <xref:System.Data.Services.Client.QueryOperationResponse%601> pour l'opération qui a échoué et les opérations restantes sont exécutées.</span><span class="sxs-lookup"><span data-stu-id="54bf4-114">When any single query operation in the batch fails, error information is returned in the <xref:System.Data.Services.Client.QueryOperationResponse%601> object for the operation that failed and the remaining operations are still executed.</span></span> <span data-ttu-id="54bf4-115">Pour plus d’informations, consultez [Comment : exécuter des requêtes dans un lot](how-to-execute-queries-in-a-batch-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="54bf4-115">For more information, see [How to: Execute Queries in a Batch](how-to-execute-queries-in-a-batch-wcf-data-services.md).</span></span>  
  
 <span data-ttu-id="54bf4-116">Les requêtes par lot peuvent également être exécutées de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="54bf4-116">Batched queries can also be executed asynchronously.</span></span> <span data-ttu-id="54bf4-117">Pour plus d’informations, consultez [opérations asynchrones](asynchronous-operations-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="54bf4-117">For more information, see [Asynchronous Operations](asynchronous-operations-wcf-data-services.md).</span></span>  
  
## <a name="batching-the-savechanges-operation"></a><span data-ttu-id="54bf4-118">Traitement par lot de l'opération SaveChanges</span><span class="sxs-lookup"><span data-stu-id="54bf4-118">Batching the SaveChanges Operation</span></span>  

 <span data-ttu-id="54bf4-119">Lorsque vous appelez la <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> méthode, toutes les modifications apportées par les pistes de contexte sont traduites en opérations Rest envoyées en tant que demandes au service OData.</span><span class="sxs-lookup"><span data-stu-id="54bf4-119">When you call the <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> method, all changes that the context tracks are translated into REST-based operations that are sent as requests to the OData service.</span></span> <span data-ttu-id="54bf4-120">Par défaut, ces modifications ne sont pas envoyées dans un message de demande unique.</span><span class="sxs-lookup"><span data-stu-id="54bf4-120">By default, these changes are not sent in a single request message.</span></span> <span data-ttu-id="54bf4-121">Pour exiger que toutes les modifications soient envoyées dans une requête unique, vous devez appeler la <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%28System.Data.Services.Client.SaveChangesOptions%29> méthode et inclure une valeur de <xref:System.Data.Services.Client.SaveChangesOptions.Batch> dans l' <xref:System.Data.Services.Client.SaveChangesOptions> énumération que vous fournissez à la méthode.</span><span class="sxs-lookup"><span data-stu-id="54bf4-121">To require that all changes be sent in a single request, you must call the <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%28System.Data.Services.Client.SaveChangesOptions%29> method and include a value of <xref:System.Data.Services.Client.SaveChangesOptions.Batch> in the <xref:System.Data.Services.Client.SaveChangesOptions> enumeration that you supply to the method.</span></span>  
  
 <span data-ttu-id="54bf4-122">Vous pouvez également enregistrer de façon asynchrone les modifications par lot.</span><span class="sxs-lookup"><span data-stu-id="54bf4-122">You can also asynchronously save batched changes.</span></span> <span data-ttu-id="54bf4-123">Pour plus d’informations, consultez [opérations asynchrones](asynchronous-operations-wcf-data-services.md).</span><span class="sxs-lookup"><span data-stu-id="54bf4-123">For more information, see [Asynchronous Operations](asynchronous-operations-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="54bf4-124">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="54bf4-124">See also</span></span>

- [<span data-ttu-id="54bf4-125">Bibliothèque client services de données WCF</span><span class="sxs-lookup"><span data-stu-id="54bf4-125">WCF Data Services Client Library</span></span>](wcf-data-services-client-library.md)

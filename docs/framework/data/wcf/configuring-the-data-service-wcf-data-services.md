---
title: Configuration du service de données (services de données WCF)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- WCF Data Services, configuring
ms.assetid: 59efd4c8-cc7a-4800-a0a4-d3f8abe6c55c
ms.openlocfilehash: d2469324317fe19d2876dceefe68d70a5fd2eae3
ms.sourcegitcommit: a970268118ea61ce14207e0916e17243546a491f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/21/2019
ms.locfileid: "67306285"
---
# <a name="configuring-the-data-service-wcf-data-services"></a>Configuration du service de données (services de données WCF)
Avec [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)], vous pouvez créer des services de données qui exposent [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] flux. Les données de ces flux peuvent provenir de diverses sources. [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] utilise des fournisseurs de données pour exposer ces données comme un [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] flux. Ces fournisseurs comprennent un fournisseur [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)], un fournisseur de réflexion et un jeu d'interfaces de fournisseur de services de données personnalisé. L'implémentation de fournisseur définit le modèle de données du service. Pour plus d’informations, consultez [fournisseurs de Services de données](../../../../docs/framework/data/wcf/data-services-providers-wcf-data-services.md).  
  
 Dans [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)], un service de données est une classe qui hérite de la classe <xref:System.Data.Services.DataService%601> , où le type du service de données est le conteneur d'entités du modèle de données. Ce conteneur d'entités a une ou plusieurs propriétés qui retournent un objet <xref:System.Linq.IQueryable%601> utilisé pour accéder aux jeux d'entités dans le modèle de données.  
  
 Les comportements du service de données sont définis par les membres de la classe <xref:System.Data.Services.DataServiceConfiguration>, et par les membres de la classe <xref:System.Data.Services.DataServiceBehavior>, accessible depuis la propriété <xref:System.Data.Services.DataServiceConfiguration.DataServiceBehavior%2A> de la classe <xref:System.Data.Services.DataServiceConfiguration>. La classe <xref:System.Data.Services.DataServiceConfiguration> est fournie à la méthode `InitializeService` implémentée par le service de données, comme dans l'implémentation suivante d'un service de données Northwind :  
  
[!code-csharp[Astoria Northwind Service#DataServiceConfigComplete](../../../../samples/snippets/csharp/VS_Snippets_Misc/astoria_northwind_service/cs/northwind.svc.cs#dataserviceconfigcomplete)]  
[!code-vb[Astoria Northwind Service#DataServiceConfigComplete](../../../../samples/snippets/visualbasic/VS_Snippets_Misc/astoria_northwind_service/vb/northwind.svc.vb#dataserviceconfigcomplete)]  
  
## <a name="data-service-configuration-settings"></a>Paramètres de la configuration du service de données  
 La classe <xref:System.Data.Services.DataServiceConfiguration> vous permet de spécifier les comportements de service de données suivants :  
  
|Membre|Comportement|  
|------------|--------------|  
|<xref:System.Data.Services.DataServiceBehavior.AcceptCountRequests%2A>|Vous permet de désactiver les demandes de nombre soumises au service de données à l’aide du segment de chemin d’accès `$count` et l’option de requête `$inlinecount`. Pour plus d’informations, consultez [OData : Conventions d’URI](https://go.microsoft.com/fwlink/?LinkId=185564).|  
|<xref:System.Data.Services.DataServiceBehavior.AcceptProjectionRequests%2A>|Vous permet de désactiver la prise en charge pour la projection de données dans les demandes soumises au service de données à l'aide de l'option de requête `$select`. Pour plus d’informations, consultez [OData : Conventions d’URI](https://go.microsoft.com/fwlink/?LinkId=185564).|  
|<xref:System.Data.Services.DataServiceConfiguration.EnableTypeAccess%2A>|Permet l'exposition d'un type de données dans les métadonnées pour un fournisseur de métadonnées dynamique défini à l'aide de l'interface <xref:System.Data.Services.Providers.IDataServiceMetadataProvider>.|  
|<xref:System.Data.Services.DataServiceConfiguration.EnableTypeConversion%2A>|Vous permet de spécifier si l'exécution du service de données doit convertir le type contenu dans la charge utile au type de propriété réel spécifié dans la demande.|  
|<xref:System.Data.Services.DataServiceBehavior.InvokeInterceptorsOnLinkDelete%2A>|Vous permet de spécifier si les intercepteurs de modification enregistrés sont appelés sur les entités liées lorsqu'un lien de relation entre deux entités est supprimé.|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxBatchCount%2A>|Vous permet de limiter le nombre d'ensembles de modifications et d'opérations de requête autorisés dans un lot unique. Pour plus d’informations, consultez [OData : Batch](https://go.microsoft.com/fwlink/?LinkId=185602) et [le traitement par lots des opérations](../../../../docs/framework/data/wcf/batching-operations-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxChangesetCount%2A>|Vous permet de limiter le nombre de modifications qui peuvent être incluses dans un seul ensemble de modifications. Pour plus d'informations, voir [Procédure : Activer la pagination des résultats de Service de données](../../../../docs/framework/data/wcf/how-to-enable-paging-of-data-service-results-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxExpandCount%2A>|Vous permet de limiter la taille d'une réponse en limitant le nombre des entités connexes qui peuvent être incluses dans une demande unique à l'aide de l'opérateur de requête `$expand`. Pour plus d’informations, consultez [OData : Conventions d’URI](https://go.microsoft.com/fwlink/?LinkId=185564) et [chargement de contenu différé](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxExpandDepth%2A>|Vous permet de limiter la taille d'une réponse en limitant la profondeur du graphique des entités connexes qui peuvent être incluses dans une demande unique à l'aide de l'opérateur de requête `$expand`. Pour plus d’informations, consultez [OData : Conventions d’URI](https://go.microsoft.com/fwlink/?LinkId=185564) et [chargement de contenu différé](../../../../docs/framework/data/wcf/loading-deferred-content-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxObjectCountOnInsert%2A>|Vous permet de limiter le nombre d'entités à insérer et pouvant être contenues dans une requête POST unique.|  
|<xref:System.Data.Services.DataServiceBehavior.MaxProtocolVersion%2A>|Définit la version du protocole Atom utilisé par le service de données. Lorsque la valeur de <xref:System.Data.Services.DataServiceBehavior.MaxProtocolVersion%2A> est définie sur une valeur inférieure à la valeur maximale de <xref:System.Data.Services.Common.DataServiceProtocolVersion>, les fonctionnalités les plus récentes d'[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] ne sont pas disponibles pour les clients qui accèdent au service de données. Pour plus d’informations, consultez [gestion des versions du Service de données](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.MaxResultsPerCollection%2A>|Vous permet de limiter la taille d'une réponse en limitant le nombre d'entités dans chaque jeu d'entités retourné comme un flux de données.|  
|<xref:System.Data.Services.DataServiceConfiguration.RegisterKnownType%2A>|Ajoute un type de données à la liste des types reconnus par le service de données.|  
|<xref:System.Data.Services.DataServiceConfiguration.SetEntitySetAccessRule%2A>|Définit les droits d'accès pour les ressources de jeu d'entités qui sont disponibles sur le service de données. Une valeur d'astérisque (`*` peut être fournie pour le paramètre de nom pour définir l'accès pour tous les jeux d'entités restants au même niveau. Nous vous recommandons de définir l'accès aux jeux d'entités pour fournir l'accès le moins privilégié aux ressources de service de données requises par les applications clientes. Pour plus d'informations, consultez [Securing WCF Data Services](../../../../docs/framework/data/wcf/securing-wcf-data-services.md). Pour obtenir des exemples de droits d’accès minimaux requis pour une action donnée de l’URI et HTTP, consultez le tableau dans le [minimale exigences d’accès de ressource](../../../../docs/framework/data/wcf/configuring-the-data-service-wcf-data-services.md#accessRequirements) section.|  
|<xref:System.Data.Services.DataServiceConfiguration.SetEntitySetPageSize%2A>|Définit la taille maximale de page pour une ressource de jeu d'entités. Pour plus d'informations, voir [Procédure : Activer la pagination des résultats de Service de données](../../../../docs/framework/data/wcf/how-to-enable-paging-of-data-service-results-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.SetServiceOperationAccessRule%2A>|Définit les droits d'accès pour les opérations de service définies sur le service de données. Pour plus d’informations, consultez [opérations de Service](../../../../docs/framework/data/wcf/service-operations-wcf-data-services.md). Une valeur d'astérisque (`*` peut être fournie pour le paramètre de nom pour définir l'accès pour toutes les opérations de service au même niveau. Nous vous recommandons de définir l'accès aux opérations de service pour fournir l'accès le moins privilégié aux ressources de service de données requises par les applications clientes. Pour plus d'informations, consultez [Securing WCF Data Services](../../../../docs/framework/data/wcf/securing-wcf-data-services.md).|  
|<xref:System.Data.Services.DataServiceConfiguration.UseVerboseErrors%2A>|Cette propriété de configuration vous permet de dépanner plus facilement un service de données en retournant plus d'informations dans le message de réponse d'erreur. L'utilisation de cette option n'est pas destinée à un environnement de production. Pour plus d’informations, consultez [développement et déploiement des Services de données WCF](../../../../docs/framework/data/wcf/developing-and-deploying-wcf-data-services.md).|  
  
<a name="accessRequirements"></a>   
## <a name="minimum-resource-access-requirements"></a>Spécifications minimales pour l'accès aux ressources  
 Le tableau suivant détaille les droits minimaux de jeu d'entités qui doivent être accordés pour exécuter une opération spécifique. Exemples de chemin d’accès sont basés sur le service de données Northwind est créé lorsque vous complétez le [quickstart](../../../../docs/framework/data/wcf/quickstart-wcf-data-services.md). Puisque l'énumération <xref:System.Data.Services.EntitySetRights> et l'énumération <xref:System.Data.Services.ServiceOperationRights> sont toutes deux définies à l'aide de l'objet <xref:System.FlagsAttribute>, vous pouvez utiliser un opérateur OR logique pour spécifier plusieurs autorisations pour un jeu d'entités ou une opération unique. Pour plus d'informations, voir [Procédure : Activer l’accès au Service de données](../../../../docs/framework/data/wcf/how-to-enable-access-to-the-data-service-wcf-data-services.md).  
  
|Chemin d'accès/action|`GET`|`DELETE`|`MERGE`|`POST`|`PUT`|  
|------------------|-----------|--------------|-------------|------------|-----------|  
|`/Customers`|<xref:System.Data.Services.EntitySetRights.ReadMultiple>|Non pris en charge|Non pris en charge|<xref:System.Data.Services.EntitySetRights.WriteAppend>|Non pris en charge|  
|`/Customers('ALFKI')`|<xref:System.Data.Services.EntitySetRights.ReadSingle>|<xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteDelete>|<xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteMerge>|N/A|<xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Customers('ALFKI')/Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadMultiple>|Non pris en charge|Non pris en charge|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteMerge> ou <xref:System.Data.Services.EntitySetRights.WriteReplace><br /><br /> -et-<br /><br /> `Orders` `:` Et <xref:System.Data.Services.EntitySetRights.WriteAppend>|Non pris en charge|  
|`/Customers('ALFKI')/Orders(10643)`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders` : <xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteDelete>|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders` : <xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteMerge>|Non pris en charge|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders` : <xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Orders(10643)/Customer`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Customers` : <xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteDelete><br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteMerge> ;<br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Customers`: <xref:System.Data.Services.EntitySetRights.WriteAppend><br /><br /> -et-<br /><br /> `Orders` : <xref:System.Data.Services.EntitySetRights.WriteAppend> et <xref:System.Data.Services.EntitySetRights.ReadSingle>|Non pris en charge|  
|`/Customers('ALFKI')/$links/Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadMultiple>|Non pris en charge|Non pris en charge|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteMerge> ou <xref:System.Data.Services.EntitySetRights.WriteReplace><br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|Non pris en charge|  
|`/Customers('ALFKI')/$links/Orders(10643)`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteMerge> ou <xref:System.Data.Services.EntitySetRights.WriteReplace><br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|Non pris en charge|Non pris en charge|Non pris en charge|  
|`/Orders(10643)/$links/Customer`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle>|`Orders`: <xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteMerge> ou <xref:System.Data.Services.EntitySetRights.WriteReplace>|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders` : <xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteMerge>|Non pris en charge|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle>;<br /><br /> -et-<br /><br /> `Orders` : <xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Customers/$count`|<xref:System.Data.Services.EntitySetRights.ReadMultiple>|Non pris en charge|Non pris en charge|Non pris en charge|Non pris en charge|  
|`/Customers('ALFKI')/ContactName`|<xref:System.Data.Services.EntitySetRights.ReadSingle>|Non pris en charge|<xref:System.Data.Services.EntitySetRights.WriteMerge>|Non pris en charge|<xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Customers('ALFKI')/Address/StreetAddress/$value` <sup>1</sup>|<xref:System.Data.Services.EntitySetRights.ReadSingle>|<xref:System.Data.Services.EntitySetRights.WriteDelete>|Non pris en charge|Non pris en charge|Non pris en charge|  
|`/Customers('ALFKI')/ContactName/$value`|<xref:System.Data.Services.EntitySetRights.ReadSingle>|<xref:System.Data.Services.EntitySetRights.ReadSingle> et <xref:System.Data.Services.EntitySetRights.WriteDelete>|<xref:System.Data.Services.EntitySetRights.WriteMerge>|Non pris en charge|<xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Customers('ALFKI')/$value` <sup>2</sup>|<xref:System.Data.Services.EntitySetRights.ReadSingle>|Non pris en charge|Non pris en charge|Non pris en charge|<xref:System.Data.Services.EntitySetRights.WriteReplace>|  
|`/Customers?$select=Orders/*&$expand=Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadMultiple>|Non pris en charge|Non pris en charge|`Customers`: <xref:System.Data.Services.EntitySetRights.WriteAppend>|Non pris en charge|  
|`/Customers('ALFKI')?$select=Orders/*&$expand=Orders`|`Customers`: <xref:System.Data.Services.EntitySetRights.ReadSingle><br /><br /> -et-<br /><br /> `Orders`: <xref:System.Data.Services.EntitySetRights.ReadMultiple>|Non pris en charge|Non pris en charge|Non pris en charge|Non pris en charge|  
  
 <sup>1</sup> dans cet exemple, `Address` représente une propriété de type complexe de la `Customers` entité qui a une propriété nommée `StreetAddress`. Le modèle utilisé par les services de données Northwind ne définit pas ce type complexe explicitement. Lorsque le modèle de données est défini à l’aide de le [!INCLUDE[adonet_ef](../../../../includes/adonet-ef-md.md)] fournisseur, vous pouvez utiliser les outils Entity Data Model pour définir un tel type complex. Pour plus d'informations, voir [Procédure : Créer et modifier des Types complexes](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/dd456820(v=vs.100)).  
  
 <sup>2</sup> cet URI est pris en charge lorsqu’une propriété qui retourne un objet binaire volumineux (BLOB) est définie en tant que la ressource multimédia qui appartient à une entité qui est une entrée de lien média, qui est dans ce cas, `Customers`. Pour plus d’informations, consultez [fournisseur de diffusion en continu](../../../../docs/framework/data/wcf/streaming-provider-wcf-data-services.md).  
  
<a name="versioning"></a>   
## <a name="versioning-requirements"></a>Exigences pour le contrôle de version  
 Les comportements de configuration du service de données suivants nécessitent la version 2 du protocole [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] ou les versions ultérieures.  
  
- Prise en charge des demandes relatives au nombre de lignes.  
  
- Prise en charge de l'option de requête $select pour la projection.  
  
 Pour plus d’informations, consultez [gestion des versions du Service de données](../../../../docs/framework/data/wcf/data-service-versioning-wcf-data-services.md).  
  
## <a name="see-also"></a>Voir aussi

- [Définition de WCF Data Services](../../../../docs/framework/data/wcf/defining-wcf-data-services.md)
- [Hébergement du service de données](../../../../docs/framework/data/wcf/hosting-the-data-service-wcf-data-services.md)

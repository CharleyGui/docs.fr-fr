---
title: Exécution de la requête
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: c0e6cf23-63ac-47dd-bfe9-d5bdca826fac
ms.openlocfilehash: fcf0d3eed95d36f7764ca048da62b589779d8d47
ms.sourcegitcommit: 4e2d355baba82814fa53efd6b8bbb45bfe054d11
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/04/2019
ms.locfileid: "70249547"
---
# <a name="query-execution"></a><span data-ttu-id="35e2a-102">Exécution de la requête</span><span class="sxs-lookup"><span data-stu-id="35e2a-102">Query Execution</span></span>
<span data-ttu-id="35e2a-103">Après avoir été créée par un utilisateur, une requête LINQ est convertie en arborescence de commandes.</span><span class="sxs-lookup"><span data-stu-id="35e2a-103">After a LINQ query is created by a user, it is converted to a command tree.</span></span> <span data-ttu-id="35e2a-104">Une arborescence de commandes est une représentation de requête compatible avec Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="35e2a-104">A command tree is a representation of a query that is compatible with the Entity Framework.</span></span> <span data-ttu-id="35e2a-105">L’arborescence de requêtes est ensuite exécutée sur la source de données.</span><span class="sxs-lookup"><span data-stu-id="35e2a-105">The command tree is then executed against the data source.</span></span> <span data-ttu-id="35e2a-106">Pendant l'exécution de la requête, toutes les expressions de la requête (c'est-à-dire, toutes ses composantes) sont évaluées, y compris les expressions utilisées dans la matérialisation des résultats.</span><span class="sxs-lookup"><span data-stu-id="35e2a-106">At query execution time, all query expressions (that is, all components of the query) are evaluated, including those expressions that are used in result materialization.</span></span>  
  
 <span data-ttu-id="35e2a-107">Le moment où les expressions d'une requête sont exécutées peut varier.</span><span class="sxs-lookup"><span data-stu-id="35e2a-107">At what point query expressions are executed can vary.</span></span> <span data-ttu-id="35e2a-108">Les requêtes LINQ sont toujours exécutées lorsque la variable de requête fait l'objet d'une itération, et non au moment où elle est créée.</span><span class="sxs-lookup"><span data-stu-id="35e2a-108">LINQ queries are always executed when the query variable is iterated over, not when the query variable is created.</span></span> <span data-ttu-id="35e2a-109">C’est ce que l’on appelle *l’exécution différée*.</span><span class="sxs-lookup"><span data-stu-id="35e2a-109">This is called *deferred execution*.</span></span> <span data-ttu-id="35e2a-110">Vous pouvez également forcer l'exécution immédiate de la requête, ce qui est utile pour mettre en cache les résultats de la requête.</span><span class="sxs-lookup"><span data-stu-id="35e2a-110">You can also force a query to execute immediately, which is useful for caching query results.</span></span> <span data-ttu-id="35e2a-111">Ce sujet est abordé plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="35e2a-111">This is described later in this topic.</span></span>  
  
 <span data-ttu-id="35e2a-112">Lorsqu'une requête LINQ to Entities est exécutée, il est possible que certaines expressions de la requête soient exécutées sur le serveur et que certaines parties soient exécutées localement sur le client.</span><span class="sxs-lookup"><span data-stu-id="35e2a-112">When a LINQ to Entities query is executed, some expressions in the query might be executed on the server and some parts might be executed locally on the client.</span></span> <span data-ttu-id="35e2a-113">L'évaluation côté client d'une expression a lieu avant l'exécution de la requête sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="35e2a-113">Client-side evaluation of an expression takes place before the query is executed on the server.</span></span> <span data-ttu-id="35e2a-114">Si une expression est évaluée sur le client, le résultat de cette évaluation remplace l'expression de la requête, et la requête est ensuite exécutée sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="35e2a-114">If an expression is evaluated on the client, the result of that evaluation is substituted for the expression in the query, and the query is then executed on the server.</span></span> <span data-ttu-id="35e2a-115">Étant donné que les requêtes sont exécutées sur la source de données, la configuration de la source de données prévaut sur le comportement spécifié dans le client.</span><span class="sxs-lookup"><span data-stu-id="35e2a-115">Because queries are executed on the data source, the data source configuration overrides the behavior specified in the client.</span></span> <span data-ttu-id="35e2a-116">Par exemple, la gestion des valeurs Null et la précision numérique dépendent des paramètres du serveur.</span><span class="sxs-lookup"><span data-stu-id="35e2a-116">For example, null value handling and numerical precision depend on the server settings.</span></span> <span data-ttu-id="35e2a-117">Toutes les exceptions levées pendant l'exécution de la requête sur le serveur sont passées directement au client.</span><span class="sxs-lookup"><span data-stu-id="35e2a-117">Any exceptions thrown during query execution on the server are passed directly up to the client.</span></span>  
 
> [!TIP]
> <span data-ttu-id="35e2a-118">Pour obtenir un résumé pratique des opérateurs de requête dans un format de table, qui vous permet d’identifier rapidement le comportement d’exécution d’un opérateur, consultez [classification des opérateursC#de requête standard par mode d’exécution ()](../../../../../csharp/programming-guide/concepts/linq/classification-of-standard-query-operators-by-manner-of-execution.md).</span><span class="sxs-lookup"><span data-stu-id="35e2a-118">For a convenient summary of query operators in table format, which lets you quickly identify an operator's execution behavior, see [Classification of Standard Query Operators by Manner of Execution (C#)](../../../../../csharp/programming-guide/concepts/linq/classification-of-standard-query-operators-by-manner-of-execution.md).</span></span>

## <a name="deferred-query-execution"></a><span data-ttu-id="35e2a-119">Exécution de requête différée</span><span class="sxs-lookup"><span data-stu-id="35e2a-119">Deferred query execution</span></span>  
 <span data-ttu-id="35e2a-120">Dans une requête qui retourne une séquence, la variable de requête elle-même ne contient jamais les résultats de la requête et stocke uniquement les commandes de requête.</span><span class="sxs-lookup"><span data-stu-id="35e2a-120">In a query that returns a sequence of values, the query variable itself never holds the query results and only stores the query commands.</span></span> <span data-ttu-id="35e2a-121">L'exécution de la requête est différée jusqu'à ce que la variable de requête soit itérée au sein d'une boucle `foreach` ou `For Each`.</span><span class="sxs-lookup"><span data-stu-id="35e2a-121">Execution of the query is deferred until the query variable is iterated over in a `foreach` or `For Each` loop.</span></span> <span data-ttu-id="35e2a-122">C’est ce qu’on appelle une *exécution différée*. autrement dit, l’exécution de la requête a lieu un certain temps après la construction de la requête.</span><span class="sxs-lookup"><span data-stu-id="35e2a-122">This is known as *deferred execution*; that is, query execution occurs some time after the query is constructed.</span></span> <span data-ttu-id="35e2a-123">Vous pouvez ainsi exécuter une requête aussi fréquemment que vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="35e2a-123">This means that you can execute a query as frequently as you want to.</span></span> <span data-ttu-id="35e2a-124">Cela est utile lorsque, par exemple, l'une de vos bases de données est en cours de mise à jour par d'autres applications.</span><span class="sxs-lookup"><span data-stu-id="35e2a-124">This is useful when, for example, you have a database that is being updated by other applications.</span></span> <span data-ttu-id="35e2a-125">Dans votre application, vous pouvez créer une requête pour récupérer les informations les plus récentes et l'exécuter à plusieurs reprises, pour retourner chaque fois les informations à jour.</span><span class="sxs-lookup"><span data-stu-id="35e2a-125">In your application, you can create a query to retrieve the latest information and repeatedly execute the query, returning the updated information every time.</span></span>  
  
 <span data-ttu-id="35e2a-126">L'exécution différée permet de combiner plusieurs requêtes ou d'étendre une requête.</span><span class="sxs-lookup"><span data-stu-id="35e2a-126">Deferred execution enables multiple queries to be combined or a query to be extended.</span></span> <span data-ttu-id="35e2a-127">Lorsqu'une requête est étendue, elle est modifiée de manière à inclure les nouvelles opérations, et l'exécution finale reflète les modifications.</span><span class="sxs-lookup"><span data-stu-id="35e2a-127">When a query is extended, it is modified to include the new operations, and the eventual execution will reflect the changes.</span></span> <span data-ttu-id="35e2a-128">Dans l'exemple suivant, la première requête retourne tous les produits.</span><span class="sxs-lookup"><span data-stu-id="35e2a-128">In the following example, the first query returns all the products.</span></span> <span data-ttu-id="35e2a-129">La deuxième requête étend la première en utilisant `Where` pour retourner tous les produits de taille « L » :</span><span class="sxs-lookup"><span data-stu-id="35e2a-129">The second query extends the first by using `Where` to return all the products of size "L":</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#Composing1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#composing1)]
 [!code-vb[DP L2E Conceptual Examples#Composing1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#composing1)]  
  
 <span data-ttu-id="35e2a-130">Une fois qu'une requête est exécutée, toutes les requêtes suivantes utilisent les opérateurs LINQ en mémoire.</span><span class="sxs-lookup"><span data-stu-id="35e2a-130">After a query has been executed all successive queries will use the in-memory LINQ operators.</span></span> <span data-ttu-id="35e2a-131">L'itération sur la variable de requête par le biais d'une instruction `foreach` ou `For Each` ou par l'appel à l'un des opérateurs de conversion LINQ provoqueront une exécution immédiate.</span><span class="sxs-lookup"><span data-stu-id="35e2a-131">Iterating over the query variable by using a `foreach` or `For Each` statement or by calling one of the LINQ conversion operators will cause immediate execution.</span></span> <span data-ttu-id="35e2a-132">Ces opérateurs de conversion sont notamment : <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToArray%2A>, <xref:System.Linq.Enumerable.ToLookup%2A> et <xref:System.Linq.Enumerable.ToDictionary%2A>.</span><span class="sxs-lookup"><span data-stu-id="35e2a-132">These conversion operators include the following: <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToArray%2A>, <xref:System.Linq.Enumerable.ToLookup%2A>, and <xref:System.Linq.Enumerable.ToDictionary%2A>.</span></span>  
  
## <a name="immediate-query-execution"></a><span data-ttu-id="35e2a-133">Exécution de requête immédiate</span><span class="sxs-lookup"><span data-stu-id="35e2a-133">Immediate Query Execution</span></span>  
 <span data-ttu-id="35e2a-134">Contrairement à l'exécution différée des requêtes qui produisent une séquence de valeurs, les requêtes qui retournent une valeur singleton sont exécutées immédiatement.</span><span class="sxs-lookup"><span data-stu-id="35e2a-134">In contrast to the deferred execution of queries that produce a sequence of values, queries that return a singleton value are executed immediately.</span></span> <span data-ttu-id="35e2a-135">Les requêtes <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.First%2A> et <xref:System.Linq.Enumerable.Max%2A> en sont quelques exemples.</span><span class="sxs-lookup"><span data-stu-id="35e2a-135">Some examples of singleton queries are <xref:System.Linq.Enumerable.Average%2A>, <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.First%2A>, and <xref:System.Linq.Enumerable.Max%2A>.</span></span> <span data-ttu-id="35e2a-136">Elles s'exécutent immédiatement parce que la requête doit produire une séquence pour calculer le résultat singleton.</span><span class="sxs-lookup"><span data-stu-id="35e2a-136">These execute immediately because the query must produce a sequence to calculate the singleton result.</span></span> <span data-ttu-id="35e2a-137">Vous pouvez également forcer l'exécution immédiate.</span><span class="sxs-lookup"><span data-stu-id="35e2a-137">You can also force immediate execution.</span></span> <span data-ttu-id="35e2a-138">Cela peut s'avérer utile lorsque vous souhaitez mettre en cache les résultats d'une requête.</span><span class="sxs-lookup"><span data-stu-id="35e2a-138">This is useful when you want to cache the results of a query.</span></span> <span data-ttu-id="35e2a-139">Pour forcer l'exécution immédiate d'une requête qui ne produit pas de valeur singleton, vous pouvez appeler la méthode <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToDictionary%2A> ou <xref:System.Linq.Enumerable.ToArray%2A> sur une requête ou une variable de requête.</span><span class="sxs-lookup"><span data-stu-id="35e2a-139">To force immediate execution of a query that does not produce a singleton value, you can call the <xref:System.Linq.Enumerable.ToList%2A> method, the <xref:System.Linq.Enumerable.ToDictionary%2A> method, or the <xref:System.Linq.Enumerable.ToArray%2A> method on a query or query variable.</span></span> <span data-ttu-id="35e2a-140">L'exemple ci-dessous utilise la méthode <xref:System.Linq.Enumerable.ToArray%2A> pour évaluer immédiatement une séquence dans un tableau.</span><span class="sxs-lookup"><span data-stu-id="35e2a-140">The following example uses the <xref:System.Linq.Enumerable.ToArray%2A> method to immediately evaluate a sequence into an array.</span></span>  
  
 [!code-csharp[DP L2E Examples#ToArray](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Examples/CS/Program.cs#toarray)]
 [!code-vb[DP L2E Examples#ToArray](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Examples/VB/Module1.vb#toarray)]  
  
 <span data-ttu-id="35e2a-141">Vous pouvez également forcer l’exécution en plaçant la boucle `foreach` ou `For Each` de suite après l’expression de requête, mais en appelant <xref:System.Linq.Enumerable.ToList%2A> ou <xref:System.Linq.Enumerable.ToArray%2A>, vous mettez en cache toutes les données contenues dans un objet de collection unique.</span><span class="sxs-lookup"><span data-stu-id="35e2a-141">You could also force execution by putting the `foreach` or `For Each` loop immediately after the query expression, but by calling <xref:System.Linq.Enumerable.ToList%2A> or <xref:System.Linq.Enumerable.ToArray%2A> you cache all the data in a single collection object.</span></span>  
  
## <a name="store-execution"></a><span data-ttu-id="35e2a-142">Exécution sur les magasins</span><span class="sxs-lookup"><span data-stu-id="35e2a-142">Store Execution</span></span>  
 <span data-ttu-id="35e2a-143">En règle générale, les expressions dans LINQ to Entities sont évaluées sur le serveur, et le comportement de l'expression n'est pas censé suivre la sémantique CLR (Common Language Runtime), mais celle de la source de données.</span><span class="sxs-lookup"><span data-stu-id="35e2a-143">In general, expressions in LINQ to Entities are evaluated on the server, and the behavior of the expression should not be expected to follow common language runtime (CLR) semantics, but those of the data source.</span></span> <span data-ttu-id="35e2a-144">Toutefois, il y a des exceptions à cette règle, notamment lorsque l'expression est exécutée sur le client.</span><span class="sxs-lookup"><span data-stu-id="35e2a-144">There are exceptions to this, however, such as when the expression is executed on the client.</span></span> <span data-ttu-id="35e2a-145">Cela peut donner lieu à des résultats inattendus, par exemple lorsque le serveur et le client sont situés dans des fuseaux horaires différents.</span><span class="sxs-lookup"><span data-stu-id="35e2a-145">This could cause unexpected results, for example when the server and client are in different time zones.</span></span>  
  
 <span data-ttu-id="35e2a-146">Il est possible que certaines expressions de la requête soient exécutées sur le client.</span><span class="sxs-lookup"><span data-stu-id="35e2a-146">Some expressions in the query might be executed on the client.</span></span> <span data-ttu-id="35e2a-147">En général, l'exécution de la requête est supposée se produire en grande partie sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="35e2a-147">In general, most query execution is expected to occur on the server.</span></span> <span data-ttu-id="35e2a-148">En dehors des méthodes exécutées sur des éléments de requête mappés à la source de données, il existe souvent, dans la requête, des expressions qui peuvent être exécutées localement.</span><span class="sxs-lookup"><span data-stu-id="35e2a-148">Aside from methods executed against query elements mapped to the data source, there are often expressions in the query that can be executed locally.</span></span> <span data-ttu-id="35e2a-149">L'exécution locale d'une expression de requête génère une valeur qui peut être utilisée dans l'exécution de la requête ou dans la construction du résultat.</span><span class="sxs-lookup"><span data-stu-id="35e2a-149">Local execution of a query expression yields a value that can be used in the query execution or result construction.</span></span>  
  
 <span data-ttu-id="35e2a-150">Certaines opérations sont toujours exécutées sur le client, notamment la liaison de valeurs, les sous-expressions, les sous-requêtes de clôtures et la matérialisation d'objets dans les résultats de requête.</span><span class="sxs-lookup"><span data-stu-id="35e2a-150">Certain operations are always executed on the client, such as binding of values, sub expressions, sub queries from closures, and materialization of objects into query results.</span></span> <span data-ttu-id="35e2a-151">En conséquence de quoi, ces éléments (par exemple, les valeurs de paramètres) ne peuvent pas être mis à jour pendant l'exécution.</span><span class="sxs-lookup"><span data-stu-id="35e2a-151">The net effect of this is that these elements (for example, parameter values) cannot be updated during the execution.</span></span> <span data-ttu-id="35e2a-152">Des types anonymes peuvent être construits par incorporation dans la source de données, mais ils ne sont pas censés l'être.</span><span class="sxs-lookup"><span data-stu-id="35e2a-152">Anonymous types can be constructed inline on the data source, but should not be assumed to do so.</span></span> <span data-ttu-id="35e2a-153">Des regroupements inline peuvent être construits dans la source de données, mais cela n'est pas systématique.</span><span class="sxs-lookup"><span data-stu-id="35e2a-153">Inline groupings can be constructed in the data source, as well, but this should not be assumed in every instance.</span></span> <span data-ttu-id="35e2a-154">En règle générale, il est préférable de ne pas faire de suppositions sur ce qui est construit sur le serveur.</span><span class="sxs-lookup"><span data-stu-id="35e2a-154">In general, it is best not to make any assumptions about what is constructed on the server.</span></span>  
  
 <span data-ttu-id="35e2a-155">Cette section décrit les scénarios dans lesquels le code est exécuté localement sur le client.</span><span class="sxs-lookup"><span data-stu-id="35e2a-155">This section describes the scenarios in which code is executed locally on the client.</span></span> <span data-ttu-id="35e2a-156">Pour plus d’informations sur les types d’expressions exécutés localement, consultez [expressions dans les requêtes LINQ to Entities](expressions-in-linq-to-entities-queries.md).</span><span class="sxs-lookup"><span data-stu-id="35e2a-156">For more information about which types of expressions are executed locally, see [Expressions in LINQ to Entities Queries](expressions-in-linq-to-entities-queries.md).</span></span>  
  
### <a name="literals-and-parameters"></a><span data-ttu-id="35e2a-157">Littéraux et paramètres</span><span class="sxs-lookup"><span data-stu-id="35e2a-157">Literals and Parameters</span></span>  
 <span data-ttu-id="35e2a-158">Les variables locales, telles que la variable `orderID` de l'exemple suivant, sont évaluées sur le client.</span><span class="sxs-lookup"><span data-stu-id="35e2a-158">Local variables, such as the `orderID` variable in the following example, are evaluated on the client.</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#LiteralParameter1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#literalparameter1)]
 [!code-vb[DP L2E Conceptual Examples#LiteralParameter1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#literalparameter1)]  
  
 <span data-ttu-id="35e2a-159">Les paramètres de méthode sont également évalués sur le client.</span><span class="sxs-lookup"><span data-stu-id="35e2a-159">Method parameters are also evaluated on the client.</span></span> <span data-ttu-id="35e2a-160">Le paramètre `orderID` passé dans la méthode `MethodParameterExample` ci-dessous en est l'illustration.</span><span class="sxs-lookup"><span data-stu-id="35e2a-160">The `orderID` parameter passed into the `MethodParameterExample` method, below, is an example.</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#MethodParameterExample](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#methodparameterexample)]
 [!code-vb[DP L2E Conceptual Examples#MethodParameterExample](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#methodparameterexample)]  
  
### <a name="casting-literals-on-the-client"></a><span data-ttu-id="35e2a-161">Conversion des littéraux sur le client</span><span class="sxs-lookup"><span data-stu-id="35e2a-161">Casting Literals on the Client</span></span>  
 <span data-ttu-id="35e2a-162">Le cast d'une valeur `null` en type CLR est exécutée sur le client :</span><span class="sxs-lookup"><span data-stu-id="35e2a-162">Casting from `null` to a CLR type is executed on the client:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#NullCastToString](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#nullcasttostring)]
 [!code-vb[DP L2E Conceptual Examples#NullCastToString](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#nullcasttostring)]  
  
 <span data-ttu-id="35e2a-163">Le cast en type, tel qu'un type <xref:System.Decimal> Nullable, est exécutée sur le client :</span><span class="sxs-lookup"><span data-stu-id="35e2a-163">Casting to a type, such as a nullable <xref:System.Decimal>, is executed on the client:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CastToNullable](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#casttonullable)]
 [!code-vb[DP L2E Conceptual Examples#CastToNullable](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#casttonullable)]  
  
### <a name="constructors-for-literals"></a><span data-ttu-id="35e2a-164">Constructeurs pour littéraux</span><span class="sxs-lookup"><span data-stu-id="35e2a-164">Constructors for Literals</span></span>  
 <span data-ttu-id="35e2a-165">Les nouveaux types CLR qui peuvent être mappés aux types de modèle conceptuel sont exécutés sur le client :</span><span class="sxs-lookup"><span data-stu-id="35e2a-165">New CLR types that can be mapped to conceptual model types are executed on the client:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#ConstructorForLiteral](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#constructorforliteral)]
 [!code-vb[DP L2E Conceptual Examples#ConstructorForLiteral](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#constructorforliteral)]  
  
 <span data-ttu-id="35e2a-166">Les nouveaux tableaux sont également exécutés sur le client.</span><span class="sxs-lookup"><span data-stu-id="35e2a-166">New arrays are also executed on the client.</span></span>  
  
## <a name="store-exceptions"></a><span data-ttu-id="35e2a-167">Exceptions de magasin</span><span class="sxs-lookup"><span data-stu-id="35e2a-167">Store Exceptions</span></span>  
 <span data-ttu-id="35e2a-168">Les erreurs de magasin rencontrées lors de l'exécution d'une requête sont transmises au client. Elles ne sont ni mappées, ni gérées.</span><span class="sxs-lookup"><span data-stu-id="35e2a-168">Any store errors that are encountered during query execution are passed up to the client, and are not mapped or handled.</span></span>  
  
## <a name="store-configuration"></a><span data-ttu-id="35e2a-169">Configuration de magasin</span><span class="sxs-lookup"><span data-stu-id="35e2a-169">Store Configuration</span></span>  
 <span data-ttu-id="35e2a-170">Lorsque la requête s'exécute sur le magasin, la configuration de ce dernier prévaut sur tous les comportements du client, et la sémantique du magasin est exprimée pour l'ensemble des opérations et des expressions.</span><span class="sxs-lookup"><span data-stu-id="35e2a-170">When the query executes on the store, the store configuration overrides all client behaviors, and store semantics are expressed for all operations and expressions.</span></span> <span data-ttu-id="35e2a-171">Il peut en résulter une différence de comportement entre le CLR et l'exécution sur le magasin dans certains domaines tels que les comparaisons de valeurs Null, le tri de GUID, la précision et l'exactitude des opérations faisant intervenir des types de données non précis (par exemple, les types à virgule flottante ou <xref:System.DateTime>) et les opérations de chaîne.</span><span class="sxs-lookup"><span data-stu-id="35e2a-171">This can result in a difference in behavior between CLR and store execution in areas such as null comparisons, GUID ordering, precision and accuracy of operations involving non-precise data types (such as floating point types or <xref:System.DateTime>), and string operations.</span></span> <span data-ttu-id="35e2a-172">Il est important de garder cela à l'esprit au moment d'examiner des résultats de requête.</span><span class="sxs-lookup"><span data-stu-id="35e2a-172">It is important to keep this in mind when examining query results.</span></span>  
  
 <span data-ttu-id="35e2a-173">Par exemple, voici quelques différences de comportement entre le CLR et SQL Server :</span><span class="sxs-lookup"><span data-stu-id="35e2a-173">For example, the following are some differences in behavior between the CLR and SQL Server:</span></span>  
  
- <span data-ttu-id="35e2a-174">SQL Server trie les GUID de façon différente par rapport au CLR.</span><span class="sxs-lookup"><span data-stu-id="35e2a-174">SQL Server orders GUIDs differently than the CLR.</span></span>  
  
- <span data-ttu-id="35e2a-175">Des différences peuvent également être constatées sur le plan de la précision des résultats lorsque le type Décimal est utilisé dans SQL Server.</span><span class="sxs-lookup"><span data-stu-id="35e2a-175">There can also be differences in result precision when dealing with the Decimal type on SQL Server.</span></span> <span data-ttu-id="35e2a-176">Cela est dû aux exigences de précision fixe inhérentes au type Décimal de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="35e2a-176">This is due to the fixed precision requirements of the SQL Server decimal type.</span></span> <span data-ttu-id="35e2a-177">Par exemple, la moyenne des valeurs <xref:System.Decimal> 0,0, 0,0 et 1,0 est de 0,3333333333333333333333333333 dans la mémoire du client, mais de 0,333333 dans le magasin (selon la précision par défaut du type Décimal de SQL Server).</span><span class="sxs-lookup"><span data-stu-id="35e2a-177">For example, the average of <xref:System.Decimal> values 0.0, 0.0, and 1.0 is 0.3333333333333333333333333333 in memory on the client, but 0.333333 in the store (based on the default precision for SQL Server’s decimal type).</span></span>  
  
- <span data-ttu-id="35e2a-178">De même, le traitement de certaines opérations de comparaison de chaînes est différent selon qu'elles sont traitées dans SQL Server ou dans le CLR.</span><span class="sxs-lookup"><span data-stu-id="35e2a-178">Some string comparison operations are also handled differently in SQL Server than in the CLR.</span></span> <span data-ttu-id="35e2a-179">Le comportement en matière de comparaison de chaînes dépend des paramètres de classement du serveur.</span><span class="sxs-lookup"><span data-stu-id="35e2a-179">String comparison behavior depends on the collation settings on the server.</span></span>  
  
- <span data-ttu-id="35e2a-180">Les appels de fonction ou de méthode éventuellement inclus dans une requête LINQ to Entities sont mappés aux fonctions canoniques d'Entity Framework, qui sont ensuite traduites dans Transact-SQL et exécutées sur la base de données SQL Server.</span><span class="sxs-lookup"><span data-stu-id="35e2a-180">Function or method calls, when included in a LINQ to Entities query, are mapped to canonical functions in the Entity Framework, which are then translated to Transact-SQL and executed on the SQL Server database.</span></span> <span data-ttu-id="35e2a-181">Dans certains cas, le comportement affiché par ces fonctions mappées peut être différent de l'implémentation dans les bibliothèques de classes de base.</span><span class="sxs-lookup"><span data-stu-id="35e2a-181">There are cases when the behavior these mapped functions exhibit might differ from the implementation in the base class libraries.</span></span> <span data-ttu-id="35e2a-182">Par exemple, l'appel des méthodes <xref:System.String.Contains%2A>, <xref:System.String.StartsWith%2A> et <xref:System.String.EndsWith%2A> avec une chaîne vide en guise de paramètre retourne une valeur `true` en cas d'exécution dans le CLR, mais retourne une valeur `false` en cas d'exécution dans SQL Server.</span><span class="sxs-lookup"><span data-stu-id="35e2a-182">For example, calling the <xref:System.String.Contains%2A>, <xref:System.String.StartsWith%2A>, and <xref:System.String.EndsWith%2A> methods with an empty string as a parameter will return `true` when executed in the CLR, but will return `false` when executed in SQL Server.</span></span> <span data-ttu-id="35e2a-183">La méthode <xref:System.String.EndsWith%2A> peut également retourner des résultats différents. En effet, SQL Server considère que deux chaînes sont égales si seul un espace à droite les différencie. Or, dans ce cas, le CLR les considère différentes.</span><span class="sxs-lookup"><span data-stu-id="35e2a-183">The <xref:System.String.EndsWith%2A> method can also return different results because SQL Server considers two strings to be equal if they only differ in trailing white space, whereas the CLR considers them to be not equal.</span></span> <span data-ttu-id="35e2a-184">Ceci est illustré dans l'exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="35e2a-184">This is illustrated by the following example:</span></span>  
  
 [!code-csharp[DP L2E Conceptual Examples#CanonicalFuncVsCLRBaseType](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DP L2E Conceptual Examples/CS/Program.cs#canonicalfuncvsclrbasetype)]
 [!code-vb[DP L2E Conceptual Examples#CanonicalFuncVsCLRBaseType](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DP L2E Conceptual Examples/VB/Module1.vb#canonicalfuncvsclrbasetype)]

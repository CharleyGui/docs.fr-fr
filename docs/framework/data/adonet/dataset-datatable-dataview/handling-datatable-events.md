---
title: Gestion des événements de DataTable
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 62f404a5-13ea-4b93-a29f-55b74a16c9d3
ms.openlocfilehash: c00e5e42508160a210d16f058c46afbf62ae0ee0
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/24/2020
ms.locfileid: "91164725"
---
# <a name="handling-datatable-events"></a><span data-ttu-id="468b9-102">Gestion des événements de DataTable</span><span class="sxs-lookup"><span data-stu-id="468b9-102">Handling DataTable Events</span></span>

<span data-ttu-id="468b9-103">L'objet <xref:System.Data.DataTable> fournit une série d'événements pouvant être traités par une application.</span><span class="sxs-lookup"><span data-stu-id="468b9-103">The <xref:System.Data.DataTable> object provides a series of events that can be processed by an application.</span></span> <span data-ttu-id="468b9-104">Le tableau ci-dessous décrit les événements `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="468b9-104">The following table describes `DataTable` events.</span></span>  
  
|<span data-ttu-id="468b9-105">Événement</span><span class="sxs-lookup"><span data-stu-id="468b9-105">Event</span></span>|<span data-ttu-id="468b9-106">Description</span><span class="sxs-lookup"><span data-stu-id="468b9-106">Description</span></span>|  
|-----------|-----------------|  
|<xref:System.Data.DataTable.Initialized>|<span data-ttu-id="468b9-107">Se produit après que la méthode <xref:System.Data.DataTable.EndInit%2A> d'un `DataTable` a été appelée.</span><span class="sxs-lookup"><span data-stu-id="468b9-107">Occurs after the <xref:System.Data.DataTable.EndInit%2A> method of a `DataTable` is called.</span></span> <span data-ttu-id="468b9-108">Cet événement est destiné principalement à prendre en charge les scénarios au moment du design.</span><span class="sxs-lookup"><span data-stu-id="468b9-108">This event is intended primarily to support design-time scenarios.</span></span>|  
|<xref:System.Data.DataTable.ColumnChanged>|<span data-ttu-id="468b9-109">Se produit après qu'une valeur a été modifiée avec succès dans un <xref:System.Data.DataColumn>.</span><span class="sxs-lookup"><span data-stu-id="468b9-109">Occurs after a value has been successfully changed in a <xref:System.Data.DataColumn>.</span></span>|  
|<xref:System.Data.DataTable.ColumnChanging>|<span data-ttu-id="468b9-110">Se produit quand une valeur a été proposée pour un `DataColumn`.</span><span class="sxs-lookup"><span data-stu-id="468b9-110">Occurs when a value has been submitted for a `DataColumn`.</span></span>|  
|<xref:System.Data.DataTable.RowChanged>|<span data-ttu-id="468b9-111">Se produit après qu'une valeur `DataColumn` ou le <xref:System.Data.DataRow.RowState%2A> d'un <xref:System.Data.DataRow> ont été modifiés avec succès dans le `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="468b9-111">Occurs after a `DataColumn` value or the <xref:System.Data.DataRow.RowState%2A> of a <xref:System.Data.DataRow> in the `DataTable` has been changed successfully.</span></span>|  
|<xref:System.Data.DataTable.RowChanging>|<span data-ttu-id="468b9-112">Se produit quand une modification a été proposée pour une valeur `DataColumn` ou le `RowState` d'un `DataRow` dans le `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="468b9-112">Occurs when a change has been submitted for a `DataColumn` value or the `RowState` of a `DataRow` in the `DataTable`.</span></span>|  
|<xref:System.Data.DataTable.RowDeleted>|<span data-ttu-id="468b9-113">Se produit après qu'un `DataRow` dans le `DataTable` a été marqué comme `Deleted`.</span><span class="sxs-lookup"><span data-stu-id="468b9-113">Occurs after a `DataRow` in the `DataTable` has been marked as `Deleted`.</span></span>|  
|<xref:System.Data.DataTable.RowDeleting>|<span data-ttu-id="468b9-114">Se produit avant qu'un `DataRow` dans le `DataTable` soit marqué comme `Deleted`.</span><span class="sxs-lookup"><span data-stu-id="468b9-114">Occurs before a `DataRow` in the `DataTable` is marked as `Deleted`.</span></span>|  
|<xref:System.Data.DataTable.TableCleared>|<span data-ttu-id="468b9-115">Se produit après qu'un appel à la méthode <xref:System.Data.DataTable.Clear%2A> du `DataTable` a effacé avec succès chaque `DataRow`.</span><span class="sxs-lookup"><span data-stu-id="468b9-115">Occurs after a call to the <xref:System.Data.DataTable.Clear%2A> method of the `DataTable` has successfully cleared every `DataRow`.</span></span>|  
|<xref:System.Data.DataTable.TableClearing>|<span data-ttu-id="468b9-116">Se produit après que la méthode `Clear` a été appelée mais avant que l'opération `Clear` commence.</span><span class="sxs-lookup"><span data-stu-id="468b9-116">Occurs after the `Clear` method is called but before the `Clear` operation begins.</span></span>|  
|<xref:System.Data.DataTable.TableNewRow>|<span data-ttu-id="468b9-117">Se produit après la création d'un nouveau `DataRow` par un appel à la méthode `NewRow` du `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="468b9-117">Occurs after a new `DataRow` is created by a call to the `NewRow` method of the `DataTable`.</span></span>|  
|<xref:System.ComponentModel.MarshalByValueComponent.Disposed>|<span data-ttu-id="468b9-118">Se produit lorsque le `DataTable` a la valeur `Disposed`.</span><span class="sxs-lookup"><span data-stu-id="468b9-118">Occurs when the `DataTable` is `Disposed`.</span></span> <span data-ttu-id="468b9-119">Hérité de <xref:System.ComponentModel.MarshalByValueComponent>.</span><span class="sxs-lookup"><span data-stu-id="468b9-119">Inherited from <xref:System.ComponentModel.MarshalByValueComponent>.</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="468b9-120">La plupart des opérations qui ajoutent ou suppriment des lignes ne déclenchent pas les événements `ColumnChanged` et `ColumnChanging`.</span><span class="sxs-lookup"><span data-stu-id="468b9-120">Most operations that add or delete rows do not raise the `ColumnChanged` and `ColumnChanging` events.</span></span> <span data-ttu-id="468b9-121">Toutefois, la méthode `ReadXml` déclenche les événements `ColumnChanged` et `ColumnChanging`, à moins que `XmlReadMode` ait la valeur `DiffGram` ou `Auto` lorsque le document XML lu est un `DiffGram`.</span><span class="sxs-lookup"><span data-stu-id="468b9-121">However, the `ReadXml` method does raise `ColumnChanged` and `ColumnChanging` events, unless the `XmlReadMode` is set to `DiffGram` or is set to `Auto` when the XML document being read is a `DiffGram`.</span></span>  
  
> [!WARNING]
> <span data-ttu-id="468b9-122">Les données peuvent être endommagées si elles sont modifiées dans un `DataSet` à partir duquel l'événement `RowChanged` est déclenché.</span><span class="sxs-lookup"><span data-stu-id="468b9-122">Data corruption can occur if data is modified in a `DataSet` from which the `RowChanged` event is raised.</span></span> <span data-ttu-id="468b9-123">Aucune exception n'est levée en cas d'endommagement de ce type.</span><span class="sxs-lookup"><span data-stu-id="468b9-123">No exception will be raised if such data corruption occurs.</span></span>  
  
## <a name="additional-related-events"></a><span data-ttu-id="468b9-124">Autres événements liés</span><span class="sxs-lookup"><span data-stu-id="468b9-124">Additional Related Events</span></span>  

 <span data-ttu-id="468b9-125">La propriété <xref:System.Data.DataTable.Constraints%2A> détient une instance <xref:System.Data.ConstraintCollection>.</span><span class="sxs-lookup"><span data-stu-id="468b9-125">The <xref:System.Data.DataTable.Constraints%2A> property holds a <xref:System.Data.ConstraintCollection> instance.</span></span> <span data-ttu-id="468b9-126">La classe <xref:System.Data.ConstraintCollection> expose un événement <xref:System.Data.ConstraintCollection.CollectionChanged>.</span><span class="sxs-lookup"><span data-stu-id="468b9-126">The <xref:System.Data.ConstraintCollection> class exposes a <xref:System.Data.ConstraintCollection.CollectionChanged> event.</span></span> <span data-ttu-id="468b9-127">Cet événement se déclenche lorsqu'une contrainte est ajoutée, modifiée ou supprimée dans `ConstraintCollection`.</span><span class="sxs-lookup"><span data-stu-id="468b9-127">This event fires when a constraint is added, modified, or removed from the `ConstraintCollection`.</span></span>  
  
 <span data-ttu-id="468b9-128">La propriété <xref:System.Data.DataTable.Columns%2A> détient une instance <xref:System.Data.DataColumnCollection>.</span><span class="sxs-lookup"><span data-stu-id="468b9-128">The <xref:System.Data.DataTable.Columns%2A> property holds a <xref:System.Data.DataColumnCollection> instance.</span></span> <span data-ttu-id="468b9-129">La classe `DataColumnCollection` expose un événement <xref:System.Data.DataColumnCollection.CollectionChanged>.</span><span class="sxs-lookup"><span data-stu-id="468b9-129">The `DataColumnCollection` class exposes a <xref:System.Data.DataColumnCollection.CollectionChanged> event.</span></span> <span data-ttu-id="468b9-130">Cet événement se déclenche lorsqu'un `DataColumn` est ajouté, modifié ou supprimé dans `DataColumnCollection`.</span><span class="sxs-lookup"><span data-stu-id="468b9-130">This event fires when a `DataColumn` is added, modified, or removed from the `DataColumnCollection`.</span></span> <span data-ttu-id="468b9-131">Les modifications à l'origine du déclenchement de l'événement incluent des modifications du nom, du type, de l'expression ou de la position ordinale d'une colonne.</span><span class="sxs-lookup"><span data-stu-id="468b9-131">Modifications that cause the event to fire include changes to the name, type, expression or ordinal position of a column.</span></span>  
  
 <span data-ttu-id="468b9-132">La propriété <xref:System.Data.DataSet.Tables%2A> d'un <xref:System.Data.DataSet> détient une instance <xref:System.Data.DataTableCollection>.</span><span class="sxs-lookup"><span data-stu-id="468b9-132">The <xref:System.Data.DataSet.Tables%2A> property of a <xref:System.Data.DataSet> holds a <xref:System.Data.DataTableCollection> instance.</span></span> <span data-ttu-id="468b9-133">La classe `DataTableCollection` expose un événement `CollectionChanged` et un événement `CollectionChanging`.</span><span class="sxs-lookup"><span data-stu-id="468b9-133">The `DataTableCollection` class exposes both a `CollectionChanged` and a `CollectionChanging` event.</span></span> <span data-ttu-id="468b9-134">Ces événements se déclenchent lorsqu'un `DataTable` est ajouté ou supprimé dans le `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="468b9-134">These events fire when a `DataTable` is added to or removed from the `DataSet`.</span></span>  
  
 <span data-ttu-id="468b9-135">Les modifications apportées aux `DataRows` peuvent également déclencher des événements pour un <xref:System.Data.DataView> associé.</span><span class="sxs-lookup"><span data-stu-id="468b9-135">Changes to `DataRows` can also trigger events for an associated <xref:System.Data.DataView>.</span></span> <span data-ttu-id="468b9-136">La classe `DataView` expose un événement <xref:System.Data.DataView.ListChanged> qui se déclenche lorsqu'une valeur `DataColumn` change ou lorsque la composition ou l'ordre de tri de la vue changent.</span><span class="sxs-lookup"><span data-stu-id="468b9-136">The `DataView` class exposes a <xref:System.Data.DataView.ListChanged> event that fires when a `DataColumn` value changes or when the composition or sort order of the view changes.</span></span> <span data-ttu-id="468b9-137">La classe <xref:System.Data.DataRowView> expose un événement <xref:System.Data.DataRowView.PropertyChanged> qui se déclenche lorsqu'une valeur `DataColumn` associée change.</span><span class="sxs-lookup"><span data-stu-id="468b9-137">The <xref:System.Data.DataRowView> class exposes a <xref:System.Data.DataRowView.PropertyChanged> event that fires when an associated `DataColumn` value changes.</span></span>  
  
## <a name="sequence-of-operations"></a><span data-ttu-id="468b9-138">Ordre des opérations</span><span class="sxs-lookup"><span data-stu-id="468b9-138">Sequence of Operations</span></span>  

 <span data-ttu-id="468b9-139">Voici l'ordre des opérations qui se produisent lorsqu'un `DataRow` est ajouté, modifié ou supprimé :</span><span class="sxs-lookup"><span data-stu-id="468b9-139">Here is the sequence of operations that occur when a `DataRow` is added, modified, or deleted:</span></span>  
  
1. <span data-ttu-id="468b9-140">Créez l'enregistrement proposé et appliquez les modifications éventuelles.</span><span class="sxs-lookup"><span data-stu-id="468b9-140">Create the proposed record and apply any changes.</span></span>  
  
2. <span data-ttu-id="468b9-141">Vérifiez les contraintes pour les colonnes autres que les colonnes d'expression.</span><span class="sxs-lookup"><span data-stu-id="468b9-141">Check constraints for non-expression columns.</span></span>  
  
3. <span data-ttu-id="468b9-142">Déclenchez les événements `RowChanging` ou `RowDeleting` selon les besoins.</span><span class="sxs-lookup"><span data-stu-id="468b9-142">Raise the `RowChanging` or `RowDeleting` events as applicable.</span></span>  
  
4. <span data-ttu-id="468b9-143">Définissez l'enregistrement proposé comme enregistrement en cours.</span><span class="sxs-lookup"><span data-stu-id="468b9-143">Set the proposed record to be the current record.</span></span>  
  
5. <span data-ttu-id="468b9-144">Mettez à jour les index associés éventuels.</span><span class="sxs-lookup"><span data-stu-id="468b9-144">Update any associated indexes.</span></span>  
  
6. <span data-ttu-id="468b9-145">Déclenchez les événements `ListChanged` pour les objets `DataView` associés et les événements `PropertyChanged` pour les objets `DataRowView` associés.</span><span class="sxs-lookup"><span data-stu-id="468b9-145">Raise `ListChanged` events for associated `DataView` objects and `PropertyChanged` events for associated `DataRowView` objects.</span></span>  
  
7. <span data-ttu-id="468b9-146">Évaluez toutes les colonnes d'expression, mais retardez la vérification des contraintes éventuelles sur ces colonnes.</span><span class="sxs-lookup"><span data-stu-id="468b9-146">Evaluate all expression columns, but delay checking any constraints on these columns.</span></span>  
  
8. <span data-ttu-id="468b9-147">Déclenchez les événements `ListChanged` pour les objets `DataView` associés et les événements `PropertyChanged` pour les objets `DataRowView` associés affectés par les évaluations des colonnes d'expression.</span><span class="sxs-lookup"><span data-stu-id="468b9-147">Raise `ListChanged` events for associated `DataView` objects and `PropertyChanged` events for associated `DataRowView` objects affected by the expression column evaluations.</span></span>  
  
9. <span data-ttu-id="468b9-148">Déclenchez les événements `RowChanged` ou `RowDeleted` selon les besoins.</span><span class="sxs-lookup"><span data-stu-id="468b9-148">Raise `RowChanged` or `RowDeleted` events as applicable.</span></span>  
  
10. <span data-ttu-id="468b9-149">Vérifiez les contraintes sur les colonnes d'expression.</span><span class="sxs-lookup"><span data-stu-id="468b9-149">Check constraints on expression columns.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="468b9-150">Des modifications apportées aux colonnes d'expression ne déclenchent jamais des événements `DataTable`.</span><span class="sxs-lookup"><span data-stu-id="468b9-150">Changes to expression columns never raise `DataTable` events.</span></span> <span data-ttu-id="468b9-151">Des modifications apportées aux colonnes d'expression déclenchent uniquement des événements `DataView` et `DataRowView`.</span><span class="sxs-lookup"><span data-stu-id="468b9-151">Changes to expression columns only raise `DataView` and `DataRowView` events.</span></span> <span data-ttu-id="468b9-152">Les colonnes d'expression peuvent avoir des dépendances sur plusieurs autres colonnes et peuvent être évaluées plusieurs fois au cours d'une même opération `DataRow`.</span><span class="sxs-lookup"><span data-stu-id="468b9-152">Expression columns can have dependencies on multiple other columns, and can be evaluated multiple times during a single `DataRow` operation.</span></span> <span data-ttu-id="468b9-153">Chaque évaluation d'expression déclenche des événements et une opération `DataRow` individuelle peut déclencher plusieurs événements `ListChanged` et `PropertyChanged` lorsque des colonnes d'expression sont affectées, dont éventuellement plusieurs événements pour une même colonne d'expression.</span><span class="sxs-lookup"><span data-stu-id="468b9-153">Each expression evaluation raises events, and a single `DataRow` operation can raise multiple `ListChanged` and `PropertyChanged` events when expression columns are affected, possibly including multiple events for the same expression column.</span></span>  
  
> [!WARNING]
> <span data-ttu-id="468b9-154">Ne levez pas de <xref:System.NullReferenceException> à l'intérieur du gestionnaire d'événements `RowChanged`.</span><span class="sxs-lookup"><span data-stu-id="468b9-154">Do not throw a <xref:System.NullReferenceException> within the `RowChanged` event handler.</span></span> <span data-ttu-id="468b9-155">Si une <xref:System.NullReferenceException> est levée à l'intérieur de l'événement `RowChanged` d'une `DataTable`, `DataTable` sera corrompue.</span><span class="sxs-lookup"><span data-stu-id="468b9-155">If a <xref:System.NullReferenceException> is thrown within the `RowChanged` event of a `DataTable`, then the `DataTable` will be corrupted.</span></span>  
  
### <a name="example"></a><span data-ttu-id="468b9-156">Exemple</span><span class="sxs-lookup"><span data-stu-id="468b9-156">Example</span></span>  

 <span data-ttu-id="468b9-157">L'exemple ci-dessous montre comment créer des gestionnaires d'événements pour les événements `RowChanged`, `RowChanging`, `RowDeleted`, `RowDeleting`, `ColumnChanged`, `ColumnChanging`, `TableNewRow`, `TableCleared` et `TableClearing`.</span><span class="sxs-lookup"><span data-stu-id="468b9-157">The following example demonstrates how to create event handlers for the `RowChanged`, `RowChanging`, `RowDeleted`, `RowDeleting`, `ColumnChanged`, `ColumnChanging`, `TableNewRow`, `TableCleared`, and `TableClearing` events.</span></span> <span data-ttu-id="468b9-158">Chaque gestionnaire d'événements affiche la sortie dans la fenêtre de console lorsqu'il est déclenché.</span><span class="sxs-lookup"><span data-stu-id="468b9-158">Each event handler displays output in the console window when it is fired.</span></span>  
  
 [!code-csharp[DataWorks DataTable.Events#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataTable.Events/CS/source.cs#1)]
 [!code-vb[DataWorks DataTable.Events#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataTable.Events/VB/source.vb#1)]  
  
## <a name="see-also"></a><span data-ttu-id="468b9-159">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="468b9-159">See also</span></span>

- [<span data-ttu-id="468b9-160">Manipulation des données dans un DataTable</span><span class="sxs-lookup"><span data-stu-id="468b9-160">Manipulating Data in a DataTable</span></span>](manipulating-data-in-a-datatable.md)
- [<span data-ttu-id="468b9-161">Gestion des événements DataAdapter</span><span class="sxs-lookup"><span data-stu-id="468b9-161">Handling DataAdapter Events</span></span>](../handling-dataadapter-events.md)
- [<span data-ttu-id="468b9-162">Gestion des événements de DataSet</span><span class="sxs-lookup"><span data-stu-id="468b9-162">Handling DataSet Events</span></span>](handling-dataset-events.md)
- [<span data-ttu-id="468b9-163">Vue d'ensemble d’ADO.NET</span><span class="sxs-lookup"><span data-stu-id="468b9-163">ADO.NET Overview</span></span>](../ado-net-overview.md)

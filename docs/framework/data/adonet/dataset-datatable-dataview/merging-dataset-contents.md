---
title: Fusion de contenu de DataSet
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: e5e9309a-3ebb-4a9c-9d78-21c4e2bafc5b
ms.openlocfilehash: e5a8040a803fbc9b098fc1b56e0f5d837c4cdb94
ms.sourcegitcommit: 2d792961ed48f235cf413d6031576373c3050918
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/31/2019
ms.locfileid: "70203363"
---
# <a name="merging-dataset-contents"></a><span data-ttu-id="94393-102">Fusion de contenu de DataSet</span><span class="sxs-lookup"><span data-stu-id="94393-102">Merging DataSet Contents</span></span>

<span data-ttu-id="94393-103">Vous pouvez utiliser la méthode <xref:System.Data.DataSet.Merge%2A> pour fusionner le contenu d'un tableau <xref:System.Data.DataSet>, <xref:System.Data.DataTable> ou <xref:System.Data.DataRow> dans un `DataSet` existant.</span><span class="sxs-lookup"><span data-stu-id="94393-103">You can use the <xref:System.Data.DataSet.Merge%2A> method to merge the contents of a <xref:System.Data.DataSet>, <xref:System.Data.DataTable>, or <xref:System.Data.DataRow> array into an existing `DataSet`.</span></span> <span data-ttu-id="94393-104">La façon dont les nouvelles données sont fusionnées dans un `DataSet` existant dépend de plusieurs facteurs et options.</span><span class="sxs-lookup"><span data-stu-id="94393-104">Several factors and options affect how new data is merged into an existing `DataSet`.</span></span>

## <a name="primary-keys"></a><span data-ttu-id="94393-105">Clés primaires</span><span class="sxs-lookup"><span data-stu-id="94393-105">Primary Keys</span></span>

<span data-ttu-id="94393-106">Si la table qui reçoit les nouvelles données et informations de schéma suite à une fusion dispose d’une clé primaire, les nouvelles lignes des données entrantes sont mises en correspondance avec les lignes existantes ayant les mêmes valeurs de clé primaire <xref:System.Data.DataRowVersion.Original> que celles des données entrantes.</span><span class="sxs-lookup"><span data-stu-id="94393-106">If the table receiving new data and schema from a merge has a primary key, new rows from the incoming data are matched with existing rows that have the same <xref:System.Data.DataRowVersion.Original> primary key values as those in the incoming data.</span></span> <span data-ttu-id="94393-107">Si les colonnes du schéma entrant correspondent à celles du schéma existant, les données des lignes existantes sont modifiées.</span><span class="sxs-lookup"><span data-stu-id="94393-107">If the columns from the incoming schema match those of the existing schema, the data in the existing rows is modified.</span></span> <span data-ttu-id="94393-108">Les colonnes qui ne correspondent pas au schéma existant sont soit ignorées soit ajoutées en fonction du paramètre <xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A>.</span><span class="sxs-lookup"><span data-stu-id="94393-108">Columns that do not match the existing schema are either ignored or added based on the <xref:System.Data.Common.DataAdapter.MissingSchemaAction%2A> parameter.</span></span> <span data-ttu-id="94393-109">Les nouvelles lignes dont les valeurs de clé primaire ne correspondent à aucune ligne existante sont ajoutées à la table existante.</span><span class="sxs-lookup"><span data-stu-id="94393-109">New rows with primary key values that do not match any existing rows are appended to the existing table.</span></span>

<span data-ttu-id="94393-110">Si des lignes entrantes ou existantes présentent un état de ligne <xref:System.Data.DataRowState.Added>, leurs valeurs de clé primaire sont mises en correspondance à l'aide de la valeur de clé primaire <xref:System.Data.DataRowVersion.Current> de la ligne `Added` car il n'existe pas de version `Original` de ces lignes.</span><span class="sxs-lookup"><span data-stu-id="94393-110">If incoming or existing rows have a row state of <xref:System.Data.DataRowState.Added>, their primary key values are matched using the <xref:System.Data.DataRowVersion.Current> primary key value of the `Added` row because no `Original` row version exists.</span></span>

<span data-ttu-id="94393-111">Si une table entrante et une table existante contiennent une colonne du même nom, mais dont le type de données diffère, une exception est levée et l'événement <xref:System.Data.DataSet.MergeFailed> du `DataSet` est déclenché.</span><span class="sxs-lookup"><span data-stu-id="94393-111">If an incoming table and an existing table contain a column with the same name but different data types, an exception is thrown and the <xref:System.Data.DataSet.MergeFailed> event of the `DataSet` is raised.</span></span> <span data-ttu-id="94393-112">Si une table entrante et une table existante contiennent toutes deux des clés définies, mais si les clés primaires s'appliquent à des colonnes différentes, une exception est levée et l'événement `MergeFailed` du `DataSet` est déclenché.</span><span class="sxs-lookup"><span data-stu-id="94393-112">If an incoming table and an existing table both have defined keys, but the primary keys are for different columns, an exception is thrown and the `MergeFailed` event of the `DataSet` is raised.</span></span>

<span data-ttu-id="94393-113">Si aucune clé primaire n'est définie dans la table qui reçoit les nouvelles données suite à une fusion, les nouvelles lignes des données entrantes ne peuvent pas être mises en correspondance avec les lignes existantes de la table et sont alors ajoutées à la table existante.</span><span class="sxs-lookup"><span data-stu-id="94393-113">If the table receiving new data from a merge does not have a primary key, new rows from the incoming data cannot be matched to existing rows in the table and are instead appended to the existing table.</span></span>

## <a name="table-names-and-namespaces"></a><span data-ttu-id="94393-114">Noms de tables et espaces de noms</span><span class="sxs-lookup"><span data-stu-id="94393-114">Table Names and Namespaces</span></span>

<span data-ttu-id="94393-115">Une valeur de propriété <xref:System.Data.DataTable> peut être assignée à un objet <xref:System.Data.DataTable.Namespace%2A>.</span><span class="sxs-lookup"><span data-stu-id="94393-115"><xref:System.Data.DataTable> objects can optionally be assigned a <xref:System.Data.DataTable.Namespace%2A> property value.</span></span> <span data-ttu-id="94393-116">Lorsque des valeurs de propriété <xref:System.Data.DataTable.Namespace%2A> sont assignées, un <xref:System.Data.DataSet> peut contenir plusieurs objets <xref:System.Data.DataTable> avec la même valeur de propriété <xref:System.Data.DataTable.TableName%2A>.</span><span class="sxs-lookup"><span data-stu-id="94393-116">When <xref:System.Data.DataTable.Namespace%2A> values are assigned, a <xref:System.Data.DataSet> can contain multiple <xref:System.Data.DataTable> objects with the same <xref:System.Data.DataTable.TableName%2A> value.</span></span> <span data-ttu-id="94393-117">Au cours des opérations de fusion, les propriétés <xref:System.Data.DataTable.TableName%2A> et <xref:System.Data.DataTable.Namespace%2A> sont toutes deux utilisées pour identifier la cible d'une fusion.</span><span class="sxs-lookup"><span data-stu-id="94393-117">During merge operations, both <xref:System.Data.DataTable.TableName%2A> and <xref:System.Data.DataTable.Namespace%2A> are used to identify the target of a merge.</span></span> <span data-ttu-id="94393-118">Si aucune propriété <xref:System.Data.DataTable.Namespace%2A> n’a été assignée, seule la propriété <xref:System.Data.DataTable.TableName%2A> est utilisée pour identifier la cible d’une fusion.</span><span class="sxs-lookup"><span data-stu-id="94393-118">If no <xref:System.Data.DataTable.Namespace%2A> has been assigned, only the <xref:System.Data.DataTable.TableName%2A> is used to identify the target of a merge.</span></span>

> [!NOTE]
> <span data-ttu-id="94393-119">Ce comportement est modifié dans la version 2.0 du .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="94393-119">This behavior changed in version 2.0 of the .NET Framework.</span></span> <span data-ttu-id="94393-120">Dans la version 1.1, les espaces de noms étaient pris en charge mais étaient ignorés au cours des opérations de fusion.</span><span class="sxs-lookup"><span data-stu-id="94393-120">In version 1.1, namespaces were supported but were ignored during merge operations.</span></span> <span data-ttu-id="94393-121">C'est pourquoi, un objet <xref:System.Data.DataSet> qui utilise les valeurs de propriété <xref:System.Data.DataTable.Namespace%2A> aura des comportements différents selon la version du .NET Framework qui est exécutée.</span><span class="sxs-lookup"><span data-stu-id="94393-121">For this reason, a <xref:System.Data.DataSet> that uses <xref:System.Data.DataTable.Namespace%2A> property values will have different behaviors depending on which version of the .NET Framework you are running.</span></span> <span data-ttu-id="94393-122">Prenons par exemple deux `DataSets` contenant des `DataTables` avec les mêmes valeurs de propriété <xref:System.Data.DataTable.TableName%2A> mais des valeurs de propriété <xref:System.Data.DataTable.Namespace%2A> différentes.</span><span class="sxs-lookup"><span data-stu-id="94393-122">For example, suppose you have two `DataSets` containing `DataTables` with the same <xref:System.Data.DataTable.TableName%2A> property values but different <xref:System.Data.DataTable.Namespace%2A> property values.</span></span> <span data-ttu-id="94393-123">Dans la version 1.1 du .NET Framework, les noms <xref:System.Data.DataTable.Namespace%2A> différents seront ignorés lors de la fusion de deux objets <xref:System.Data.DataSet>.</span><span class="sxs-lookup"><span data-stu-id="94393-123">In version 1.1 of the .NET Framework, the different <xref:System.Data.DataTable.Namespace%2A> names will be ignored when merging the two <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="94393-124">Toutefois, à partir de la version 2.0, la fusion entraîne la création de deux `DataTables` dans le <xref:System.Data.DataSet> cible.</span><span class="sxs-lookup"><span data-stu-id="94393-124">However, starting with version 2.0, merging causes two new `DataTables` to be created in the target <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="94393-125">Les `DataTables` d'origine ne seront pas affectés par la fusion.</span><span class="sxs-lookup"><span data-stu-id="94393-125">The original `DataTables` will be unaffected by the merge.</span></span>

## <a name="preservechanges"></a><span data-ttu-id="94393-126">PreserveChanges</span><span class="sxs-lookup"><span data-stu-id="94393-126">PreserveChanges</span></span>

<span data-ttu-id="94393-127">Lorsque vous passez un tableau `DataSet`, `DataTable` ou `DataRow` à la méthode `Merge`, vous pouvez inclure des paramètres facultatifs pour indiquer s'il convient ou non de conserver les modifications dans le `DataSet` existant et comment gérer les nouveaux éléments de schéma situés dans les données entrantes.</span><span class="sxs-lookup"><span data-stu-id="94393-127">When you pass a `DataSet`, `DataTable`, or `DataRow` array to the `Merge` method, you can include optional parameters that specify whether or not to preserve changes in the existing `DataSet`, and how to handle new schema elements found in the incoming data.</span></span> <span data-ttu-id="94393-128">Le premier de ces paramètres après les données entrantes est un indicateur booléen, <xref:System.Data.LoadOption.PreserveChanges>, qui indique si les modifications seront ou non conservées dans le `DataSet` existant.</span><span class="sxs-lookup"><span data-stu-id="94393-128">The first of these parameters after the incoming data is a Boolean flag, <xref:System.Data.LoadOption.PreserveChanges>, which specifies whether or not to preserve the changes in the existing `DataSet`.</span></span> <span data-ttu-id="94393-129">Si l'indicateur `PreserveChanges` a la valeur `true`, les valeurs entrantes ne remplacent pas les valeurs existantes dans la version `Current` de la ligne existante.</span><span class="sxs-lookup"><span data-stu-id="94393-129">If the `PreserveChanges` flag is set to `true`, incoming values do not overwrite existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="94393-130">Si l'indicateur `PreserveChanges` a la valeur `false`, les valeurs entrantes remplacent les valeurs existantes dans la version `Current` de la ligne existante.</span><span class="sxs-lookup"><span data-stu-id="94393-130">If the `PreserveChanges` flag is set to `false`, incoming values do overwrite the existing values in the `Current` row version of the existing row.</span></span> <span data-ttu-id="94393-131">Si l'indicateur `PreserveChanges` n'est pas spécifié, il a par défaut la valeur `false`.</span><span class="sxs-lookup"><span data-stu-id="94393-131">If the `PreserveChanges` flag is not specified, it is set to `false` by default.</span></span> <span data-ttu-id="94393-132">Pour plus d’informations sur les versions de ligne, consultez [États de ligne et versions de ligne](row-states-and-row-versions.md).</span><span class="sxs-lookup"><span data-stu-id="94393-132">For more information about row versions, see [Row States and Row Versions](row-states-and-row-versions.md).</span></span>

<span data-ttu-id="94393-133">Lorsque `PreserveChanges` a la valeur `true`, les données de la ligne existante sont conservées dans la version <xref:System.Data.DataRowVersion.Current> de la ligne existante, alors que les données de la version <xref:System.Data.DataRowVersion.Original> de la ligne existante sont remplacées par les données de la version `Original` de la ligne entrante.</span><span class="sxs-lookup"><span data-stu-id="94393-133">When `PreserveChanges` is `true`, the data from the existing row is maintained in the <xref:System.Data.DataRowVersion.Current> row version of the existing row, while the data from the <xref:System.Data.DataRowVersion.Original> row version of the existing row is overwritten with the data from the `Original` row version of the incoming row.</span></span> <span data-ttu-id="94393-134">La propriété <xref:System.Data.DataRow.RowState%2A> de la ligne existante prend la valeur <xref:System.Data.DataRowState.Modified>.</span><span class="sxs-lookup"><span data-stu-id="94393-134">The <xref:System.Data.DataRow.RowState%2A> of the existing row is set to <xref:System.Data.DataRowState.Modified>.</span></span> <span data-ttu-id="94393-135">Il existe toutefois certaines exceptions :</span><span class="sxs-lookup"><span data-stu-id="94393-135">The following exceptions apply:</span></span>

- <span data-ttu-id="94393-136">Si le `RowState` de la ligne existante est `Deleted`, ce `RowState` reste `Deleted` et ne prend pas la valeur `Modified`.</span><span class="sxs-lookup"><span data-stu-id="94393-136">If the existing row has a `RowState` of `Deleted`, this `RowState` remains `Deleted` and is not set to `Modified`.</span></span> <span data-ttu-id="94393-137">Dans ce cas, les données de la ligne entrante seront stockées dans la version `Original` de la ligne existante, remplaçant ainsi la version `Original` de la ligne existante (sauf si le `RowState` de la ligne entrante est `Added`).</span><span class="sxs-lookup"><span data-stu-id="94393-137">In this case, the data from the incoming row will still be stored in the `Original` row version of the existing row, overwriting the `Original` row version of the existing row (unless the incoming row has a `RowState` of `Added`).</span></span>

- <span data-ttu-id="94393-138">Si le `RowState` de la ligne entrante est `Added`, les données de la version `Original` de la ligne existante ne seront pas remplacées par les données de la ligne entrante car cette dernière n'a pas de version de ligne `Original`.</span><span class="sxs-lookup"><span data-stu-id="94393-138">If the incoming row has a `RowState` of `Added`, the data from the `Original` row version of the existing row will not be overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>

<span data-ttu-id="94393-139">Lorsque `PreserveChanges` a la valeur `false`, les versions `Current` et `Original` de ligne existante sont remplacées par les données de la ligne entrante et le `RowState` de la ligne existante prend la valeur du `RowState` de la ligne entrante.</span><span class="sxs-lookup"><span data-stu-id="94393-139">When `PreserveChanges` is `false`, both the `Current` and `Original` row versions in the existing row are overwritten with the data from the incoming row, and the `RowState` of the existing row is set to the `RowState` of the incoming row.</span></span> <span data-ttu-id="94393-140">Il existe toutefois certaines exceptions :</span><span class="sxs-lookup"><span data-stu-id="94393-140">The following exceptions apply:</span></span>

- <span data-ttu-id="94393-141">Si le `RowState` de la ligne entrante est `Unchanged` et si le `RowState` de la ligne existante est `Modified`, `Deleted` ou `Added`, le `RowState` de la ligne existante prend la valeur `Modified`.</span><span class="sxs-lookup"><span data-stu-id="94393-141">If the incoming row has a `RowState` of `Unchanged` and the existing row has a `RowState` of `Modified`, `Deleted`, or `Added`, the `RowState` of the existing row is set to `Modified`.</span></span>

- <span data-ttu-id="94393-142">Si le `RowState` de la ligne entrante est `Added` et si le `RowState` de la ligne existante est `Unchanged`, `Modified` ou `Deleted`, le `RowState` de la ligne existante prend la valeur `Modified`.</span><span class="sxs-lookup"><span data-stu-id="94393-142">If the incoming row has a `RowState` of `Added`, and the existing row has a `RowState` of `Unchanged`, `Modified`, or `Deleted`, the `RowState` of the existing row is set to `Modified`.</span></span> <span data-ttu-id="94393-143">De même, les données de la version `Original` de la ligne existante ne sont pas remplacées par les données de la ligne entrante car cette dernière n'a pas de version de ligne `Original`.</span><span class="sxs-lookup"><span data-stu-id="94393-143">Also, the data from the `Original` row version of the existing row is not overwritten with data from the incoming row, because the incoming row does not have an `Original` row version.</span></span>

## <a name="missingschemaaction"></a><span data-ttu-id="94393-144">MissingSchemaAction</span><span class="sxs-lookup"><span data-stu-id="94393-144">MissingSchemaAction</span></span>

<span data-ttu-id="94393-145">Vous pouvez utiliser le paramètre facultatif <xref:System.Data.MissingSchemaAction> de la méthode `Merge` pour spécifier comment `Merge` va gérer les éléments de schéma présents dans les données entrantes et qui ne font pas partie du `DataSet` existant.</span><span class="sxs-lookup"><span data-stu-id="94393-145">You can use the optional <xref:System.Data.MissingSchemaAction> parameter of the `Merge` method to specify how `Merge` will handle schema elements in the incoming data that are not part of the existing `DataSet`.</span></span>

<span data-ttu-id="94393-146">Le tableau suivant décrit les options de `MissingSchemaAction`.</span><span class="sxs-lookup"><span data-stu-id="94393-146">The following table describes the options for `MissingSchemaAction`.</span></span>

|<span data-ttu-id="94393-147">Option MissingSchemaAction</span><span class="sxs-lookup"><span data-stu-id="94393-147">MissingSchemaAction option</span></span>|<span data-ttu-id="94393-148">Description</span><span class="sxs-lookup"><span data-stu-id="94393-148">Description</span></span>|
|--------------------------------|-----------------|
|<xref:System.Data.MissingSchemaAction.Add>|<span data-ttu-id="94393-149">Ajoute les nouvelles informations de schéma au `DataSet` et remplit les nouvelles colonnes avec les valeurs entrantes.</span><span class="sxs-lookup"><span data-stu-id="94393-149">Add the new schema information to the `DataSet` and populate the new columns with the incoming values.</span></span> <span data-ttu-id="94393-150">Il s'agit de la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="94393-150">This is the default.</span></span>|
|<xref:System.Data.MissingSchemaAction.AddWithKey>|<span data-ttu-id="94393-151">Ajoute les nouvelles informations de schéma et de clé primaire au `DataSet` et remplit les nouvelles colonnes avec les valeurs entrantes.</span><span class="sxs-lookup"><span data-stu-id="94393-151">Add the new schema and primary key information to the `DataSet` and populate the new columns with the incoming values.</span></span>|
|<xref:System.Data.MissingSchemaAction.Error>|<span data-ttu-id="94393-152">Lève une exception si une incompatibilité au niveau des informations de schéma est détectée.</span><span class="sxs-lookup"><span data-stu-id="94393-152">Throw an exception if mismatched schema information is encountered.</span></span>|
|<xref:System.Data.MissingSchemaAction.Ignore>|<span data-ttu-id="94393-153">Ignore les nouvelles informations de schéma.</span><span class="sxs-lookup"><span data-stu-id="94393-153">Ignore the new schema information.</span></span>|

## <a name="constraints"></a><span data-ttu-id="94393-154">Contraintes</span><span class="sxs-lookup"><span data-stu-id="94393-154">Constraints</span></span>

<span data-ttu-id="94393-155">Avec la méthode`Merge`, la vérification des contraintes ne s'effectue qu'une fois toutes les nouvelles données ajoutées au `DataSet` existant.</span><span class="sxs-lookup"><span data-stu-id="94393-155">With the `Merge` method, constraints are not checked until all new data has been added to the existing `DataSet`.</span></span> <span data-ttu-id="94393-156">Les contraintes sont alors appliquées aux valeurs actuelles du `DataSet`.</span><span class="sxs-lookup"><span data-stu-id="94393-156">Once the data has been added, constraints are enforced on the current values in the `DataSet`.</span></span> <span data-ttu-id="94393-157">Vous devez veiller à ce que votre code gère les exceptions levées en cas de violations des contraintes.</span><span class="sxs-lookup"><span data-stu-id="94393-157">You must ensure that your code handles any exceptions that might be thrown due to constraint violations.</span></span>

<span data-ttu-id="94393-158">Prenons l'exemple d'une ligne `DataSet` existante d'un `Unchanged` dont la valeur de clé primaire est 1.</span><span class="sxs-lookup"><span data-stu-id="94393-158">Consider a case where an existing row in a `DataSet` is an `Unchanged` row with a primary key value of 1.</span></span> <span data-ttu-id="94393-159">Au cours d'une opération de fusion avec une ligne `Modified` entrante dont la valeur de clé primaire `Original` est 2 et la valeur de clé primaire `Current` est 1, la ligne existante et la ligne entrante ne sont pas mises en correspondance car les valeurs de clé primaire `Original` diffèrent.</span><span class="sxs-lookup"><span data-stu-id="94393-159">During a merge operation with a `Modified` incoming row with an `Original` primary key value of 2 and a `Current` primary key value of 1, the existing row and the incoming row are not considered matching because the `Original` primary key values differ.</span></span> <span data-ttu-id="94393-160">Cependant, lorsque la fusion est terminée et la vérification des contraintes effectuée, une exception est levée car les valeurs de clé primaire `Current` enfreignent la contrainte unique définie pour la colonne de clé primaire.</span><span class="sxs-lookup"><span data-stu-id="94393-160">However, when the merge is completed and constraints are checked, an exception will be thrown because the `Current` primary key values violate the unique constraint for the primary key column.</span></span>

> [!NOTE]
> <span data-ttu-id="94393-161">Lorsque des lignes sont insérées dans une table de base de données contenant une colonne à incrémentation automatique comme une colonne d’identité, la valeur de colonne d’identité retournée par l’insertion peut ne pas correspondre à la valeur du `DataSet`, ce qui conduit à l’ajout des lignes retournées et non à leur fusion.</span><span class="sxs-lookup"><span data-stu-id="94393-161">When rows are inserted into a database table containing an auto incrementing column such as an identity column, the identity column value returned by the insert may not match the value in the `DataSet`, causing the returned rows to be appended instead of merged.</span></span> <span data-ttu-id="94393-162">Pour plus d’informations, consultez récupération d’une [identité ou de valeurs NuméroAuto](../retrieving-identity-or-autonumber-values.md).</span><span class="sxs-lookup"><span data-stu-id="94393-162">For more information, see [Retrieving Identity or Autonumber Values](../retrieving-identity-or-autonumber-values.md).</span></span>

<span data-ttu-id="94393-163">L’exemple de code suivant fusionne `DataSet` deux objets avec des schémas différents en `DataSet` un seul avec les schémas combinés des deux objets `DataSet` entrants.</span><span class="sxs-lookup"><span data-stu-id="94393-163">The following code example merges two `DataSet` objects with different schemas into one `DataSet` with the combined schemas of the two incoming `DataSet` objects.</span></span>

[!code-csharp[DataWorks DataSet.Merge#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/CS/source.cs#1)]
[!code-vb[DataWorks DataSet.Merge#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.Merge/VB/source.vb#1)]

<span data-ttu-id="94393-164">L'exemple de code suivant prend un `DataSet` existant avec des mises à jour et passe ces mises à jour à un `DataAdapter` pour qu'elles soient traitées au niveau de la source de données.</span><span class="sxs-lookup"><span data-stu-id="94393-164">The following code example takes an existing `DataSet` with updates and passes those updates to a `DataAdapter` to be processed at the data source.</span></span> <span data-ttu-id="94393-165">Les résultats sont ensuite fusionnés dans le `DataSet` d’origine.</span><span class="sxs-lookup"><span data-stu-id="94393-165">The results are then merged into the original `DataSet`.</span></span> <span data-ttu-id="94393-166">Après rejet des modifications ayant abouti à une erreur, les modifications fusionnées sont validées avec `AcceptChanges`.</span><span class="sxs-lookup"><span data-stu-id="94393-166">After rejecting changes that resulted in an error, the merged changes are committed with `AcceptChanges`.</span></span>

[!code-csharp[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#1)]
[!code-vb[DataWorks DataSet.MergeAcceptChanges#1](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#1)]

[!code-csharp[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/CS/source.cs#2)]
[!code-vb[DataWorks DataSet.MergeAcceptChanges#2](../../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks DataSet.MergeAcceptChanges/VB/source.vb#2)]

## <a name="see-also"></a><span data-ttu-id="94393-167">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="94393-167">See also</span></span>

- [<span data-ttu-id="94393-168">DataSets, DataTables et DataViews</span><span class="sxs-lookup"><span data-stu-id="94393-168">DataSets, DataTables, and DataViews</span></span>](index.md)
- [<span data-ttu-id="94393-169">États des lignes et versions des lignes</span><span class="sxs-lookup"><span data-stu-id="94393-169">Row States and Row Versions</span></span>](row-states-and-row-versions.md)
- [<span data-ttu-id="94393-170">DataAdapters et DataReaders</span><span class="sxs-lookup"><span data-stu-id="94393-170">DataAdapters and DataReaders</span></span>](../dataadapters-and-datareaders.md)
- [<span data-ttu-id="94393-171">Extraction et modification de données dans ADO.NET</span><span class="sxs-lookup"><span data-stu-id="94393-171">Retrieving and Modifying Data in ADO.NET</span></span>](../retrieving-and-modifying-data.md)
- [<span data-ttu-id="94393-172">Récupération de valeurs d’identité ou de numérotation automatique</span><span class="sxs-lookup"><span data-stu-id="94393-172">Retrieving Identity or Autonumber Values</span></span>](../retrieving-identity-or-autonumber-values.md)
- [<span data-ttu-id="94393-173">Fournisseurs managés ADO.NET et centre de développement DataSet</span><span class="sxs-lookup"><span data-stu-id="94393-173">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)

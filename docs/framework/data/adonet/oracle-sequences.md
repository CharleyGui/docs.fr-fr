---
title: Séquences Oracle
ms.date: 03/30/2017
ms.assetid: 27cd371d-8252-414d-b5b2-5d31fa44b585
ms.openlocfilehash: d6e6bb51b8bd317c7161500b89993be689659fad
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/12/2020
ms.locfileid: "79149412"
---
# <a name="oracle-sequences"></a><span data-ttu-id="66171-102">Séquences Oracle</span><span class="sxs-lookup"><span data-stu-id="66171-102">Oracle Sequences</span></span>
<span data-ttu-id="66171-103">Le fournisseur de données .NET Framework pour Oracle offre une prise en charge pour l'extraction des valeurs de séquence Oracle clés générées par le serveur, une fois les insertions réalisées par <xref:System.Data.OracleClient.OracleDataAdapter>.</span><span class="sxs-lookup"><span data-stu-id="66171-103">The .NET Framework Data Provider for Oracle provides support for retrieving the server-generated key Oracle Sequence values after performing inserts by using the <xref:System.Data.OracleClient.OracleDataAdapter>.</span></span>  
  
 <span data-ttu-id="66171-104">SQL Server et Oracle prennent en charge la création des colonnes à incrémentation automatique pouvant être désignées comme des clés primaires.</span><span class="sxs-lookup"><span data-stu-id="66171-104">SQL Server and Oracle support the creation of automatically incrementing columns that can be designated as primary keys.</span></span> <span data-ttu-id="66171-105">Ces valeurs sont générées par le serveur lorsque des lignes sont ajoutées à une table.</span><span class="sxs-lookup"><span data-stu-id="66171-105">These values are generated by the server as rows are added to a table.</span></span> <span data-ttu-id="66171-106">Dans SQL Server, vous définissez la propriété Identity d'une colonne ; dans Oracle, vous créez une séquence.</span><span class="sxs-lookup"><span data-stu-id="66171-106">In SQL Server, you set the Identity property of a column; in Oracle you create a Sequence.</span></span> <span data-ttu-id="66171-107">La différence entre les colonnes à incrémentation automatique dans SQL Server et les séquences dans Oracle est la suivante :</span><span class="sxs-lookup"><span data-stu-id="66171-107">The difference between auto-increment columns in SQL Server and sequences in Oracle is that:</span></span>  
  
- <span data-ttu-id="66171-108">Dans SQL Server, vous marquez une colonne en tant que colonne à incrémentation automatique et SQL Server génère automatiquement de nouvelles valeurs pour la colonne lorsque vous insérez une nouvelle ligne.</span><span class="sxs-lookup"><span data-stu-id="66171-108">In SQL Server, you mark a column as an auto-increment column and SQL Server automatically generates new values for the column when you insert a new row.</span></span>  
  
- <span data-ttu-id="66171-109">Dans Oracle, vous créez une séquence afin de générer de nouvelles valeurs pour une colonne de votre table, mais il n'existe aucun lien direct entre la séquence et la table ou la colonne.</span><span class="sxs-lookup"><span data-stu-id="66171-109">In Oracle, you create a sequence to generate new values for a column in your table, but there is no direct link between the sequence and the table or column.</span></span> <span data-ttu-id="66171-110">Une séquence Oracle est un objet, comme une table ou une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="66171-110">An Oracle sequence is an object, like a table or a stored procedure.</span></span>  
  
 <span data-ttu-id="66171-111">Lorsque vous créez une séquence dans une base de données Oracle, vous pouvez définir sa valeur initiale et l'incrémentation entre ses valeurs.</span><span class="sxs-lookup"><span data-stu-id="66171-111">When you create a sequence in an Oracle database, you can define its initial value and the increment between its values.</span></span> <span data-ttu-id="66171-112">Vous pouvez également interroger la séquence à propos de nouvelles valeurs avant de soumettre de nouvelles lignes.</span><span class="sxs-lookup"><span data-stu-id="66171-112">You can also query the sequence for new values before submitting new rows.</span></span> <span data-ttu-id="66171-113">Cela signifie que votre code peut reconnaître les valeurs clés des nouvelles lignes avant que vous ne les insériez dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="66171-113">That means your code can recognize the key values for new rows before you insert them into the database.</span></span>  
  
 <span data-ttu-id="66171-114">Pour plus d’informations sur la création de colonnes d’incrément automatique en utilisant SQL Server et ADO.NET, voir [Retrieving Identity ou Autonumber Values](retrieving-identity-or-autonumber-values.md) et [Créer des colonnes d’augmentation automatique](./dataset-datatable-dataview/creating-autoincrement-columns.md).</span><span class="sxs-lookup"><span data-stu-id="66171-114">For more information about creating auto-increment columns by using SQL Server and ADO.NET, see [Retrieving Identity or Autonumber Values](retrieving-identity-or-autonumber-values.md) and [Creating AutoIncrement Columns](./dataset-datatable-dataview/creating-autoincrement-columns.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="66171-115"> Exemple</span><span class="sxs-lookup"><span data-stu-id="66171-115">Example</span></span>  
 <span data-ttu-id="66171-116">L'exemple C# suivant montre comment vous pouvez extraire de nouvelles valeurs de séquence à partir d'une base de données Oracle.</span><span class="sxs-lookup"><span data-stu-id="66171-116">The following C# example demonstrates how you can retrieve new sequence values from Oracle database.</span></span> <span data-ttu-id="66171-117">Cet exemple référence la séquence dans la requête INSERT INTO utilisée pour soumettre les nouvelles lignes, puis retourne la valeur de séquence générée à l'aide de la clause RETURNING introduite dans Oracle10g.</span><span class="sxs-lookup"><span data-stu-id="66171-117">The example references the sequence in the INSERT INTO query used to submit the new rows, and then returns the sequence value generated using the RETURNING clause introduced in Oracle10g.</span></span> <span data-ttu-id="66171-118">L'exemple ajoute une série de nouvelles lignes en attente dans <xref:System.Data.DataTable> à l'aide d'une fonctionnalité d'incrémentation automatique ADO.NET pour générer des valeurs de clé primaire « espace réservé ».</span><span class="sxs-lookup"><span data-stu-id="66171-118">The example adds a series of pending new rows in a <xref:System.Data.DataTable> by using ADO.NET’s auto-increment functionality to generate "placeholder" primary key values.</span></span> <span data-ttu-id="66171-119">Notez que la valeur incrémentielle ADO.NET générée pour la nouvelle ligne est simplement un « espace réservé ».</span><span class="sxs-lookup"><span data-stu-id="66171-119">Note that the increment value ADO.NET generated for the new row is just a "placeholder".</span></span> <span data-ttu-id="66171-120">Cela signifie que la base de données peut générer des valeurs différentes de celles qu'ADO.NET génère.</span><span class="sxs-lookup"><span data-stu-id="66171-120">That means the database might generate different values from the ones ADO.NET generates.</span></span>  
  
 <span data-ttu-id="66171-121">Avant de soumettre les insertions en attente à la base de données, l'exemple affiche le contenu des lignes.</span><span class="sxs-lookup"><span data-stu-id="66171-121">Before submitting the pending inserts to the database, the example displays the contents of the rows.</span></span> <span data-ttu-id="66171-122">Ensuite, le code crée un nouvel objet <xref:System.Data.OracleClient.OracleDataAdapter>, puis définit ses propriétés <xref:System.Data.OracleClient.OracleDataAdapter.InsertCommand%2A> et <xref:System.Data.OracleClient.OracleDataAdapter.UpdateBatchSize%2A>.</span><span class="sxs-lookup"><span data-stu-id="66171-122">Then, the code creates a new <xref:System.Data.OracleClient.OracleDataAdapter> object and sets its <xref:System.Data.OracleClient.OracleDataAdapter.InsertCommand%2A> and the <xref:System.Data.OracleClient.OracleDataAdapter.UpdateBatchSize%2A> properties.</span></span> <span data-ttu-id="66171-123">Cet exemple fournit également la logique pour retourner les valeurs générées par le serveur à l'aide des paramètres de sortie.</span><span class="sxs-lookup"><span data-stu-id="66171-123">The example also supplies the logic to return the server-generated values by using output parameters.</span></span> <span data-ttu-id="66171-124">Ensuite, il procède à la mise à jour pour soumettre les lignes en attente et affiche le contenu de <xref:System.Data.DataTable>.</span><span class="sxs-lookup"><span data-stu-id="66171-124">Then, the example executes the update to submit the pending rows and displays the contents of the <xref:System.Data.DataTable>.</span></span>  
  
```csharp  
public void OracleSequence(String connectionString)  
{  
   String insertString =
      "INSERT INTO SequenceTest_Table (ID, OtherColumn)" +  
      "VALUES (SequenceTest_Sequence.NEXTVAL, :OtherColumn)" +  
      "RETURNING ID INTO :ID";  
  
   using (OracleConnection conn = new OracleConnection(connectionString))  
   {  
      //Open a connection.  
      conn.Open();  
      OracleCommand cmd = conn.CreateCommand();  
  
      // Prepare the database.  
      cmd.CommandText = "DROP SEQUENCE SequenceTest_Sequence";  
      try { cmd.ExecuteNonQuery(); } catch { }  
  
      cmd.CommandText = "DROP TABLE SequenceTest_Table";  
      try { cmd.ExecuteNonQuery(); } catch { }  
  
      cmd.CommandText = "CREATE TABLE SequenceTest_Table " +  
                     "(ID int PRIMARY KEY, OtherColumn varchar(255))";  
      cmd.ExecuteNonQuery();  
  
      cmd.CommandText = "CREATE SEQUENCE SequenceTest_Sequence " +  
                        "START WITH 100 INCREMENT BY 5";  
      cmd.ExecuteNonQuery();  
  
      DataTable testTable = new DataTable();  
      DataColumn column = testTable.Columns.Add("ID", typeof(int));  
      column.AutoIncrement = true;  
      column.AutoIncrementSeed = -1;  
      column.AutoIncrementStep = -1;  
      testTable.PrimaryKey = new DataColumn[] { column };  
      testTable.Columns.Add("OtherColumn", typeof(string));  
      for (int rowCounter = 1; rowCounter <= 15; rowCounter++)  
      {  
         testTable.Rows.Add(null, "Row #" + rowCounter.ToString());  
      }  
  
      Console.WriteLine("Before Update => ");  
      foreach (DataRow row in testTable.Rows)  
      {  
         Console.WriteLine("   {0} - {1}", row["ID"], row["OtherColumn"]);  
      }  
      Console.WriteLine();  
  
      cmd.CommandText =
        "SELECT ID, OtherColumn FROM SequenceTest_Table";  
      OracleDataAdapter da = new OracleDataAdapter(cmd);  
      da.InsertCommand = new OracleCommand(insertString, conn);  
      da.InsertCommand.Parameters.Add(":ID", OracleType.Int32, 0, "ID");  
      da.InsertCommand.Parameters[0].Direction = ParameterDirection.Output;  
      da.InsertCommand.Parameters.Add(":OtherColumn", OracleType.VarChar, 255, "OtherColumn");  
      da.InsertCommand.UpdatedRowSource = UpdateRowSource.OutputParameters;  
      da.UpdateBatchSize = 10;  
  
      da.Update(testTable);  
  
      Console.WriteLine("After Update => ");  
      foreach (DataRow row in testTable.Rows)  
      {  
         Console.WriteLine("   {0} - {1}", row["ID"], row["OtherColumn"]);  
      }  
      // Close the connection.  
      conn.Close();  
   }  
}  
```  
  
## <a name="see-also"></a><span data-ttu-id="66171-125">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="66171-125">See also</span></span>

- [<span data-ttu-id="66171-126">Oracle et ADO.NET</span><span class="sxs-lookup"><span data-stu-id="66171-126">Oracle and ADO.NET</span></span>](oracle-and-adonet.md)
- [<span data-ttu-id="66171-127">Vue d'ensemble d’ADO.NET</span><span class="sxs-lookup"><span data-stu-id="66171-127">ADO.NET Overview</span></span>](ado-net-overview.md)

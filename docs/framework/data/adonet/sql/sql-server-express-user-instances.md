---
title: Instances utilisateur SQL Server Express
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 00c12376-cb26-4317-86ad-e6e9c089be57
ms.openlocfilehash: 71f42cb2707c27be6c1a761d09d3a2dae1791680
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/15/2020
ms.locfileid: "90552672"
---
# <a name="sql-server-express-user-instances"></a><span data-ttu-id="487db-102">Instances utilisateur SQL Server Express</span><span class="sxs-lookup"><span data-stu-id="487db-102">SQL Server Express User Instances</span></span>
<span data-ttu-id="487db-103">Microsoft SQL Server Express Edition (SQL Server Express) prend en charge une nouvelle fonctionnalité, l’instance utilisateur, disponible uniquement avec le fournisseur de données .NET Framework pour SQL Server (`SqlClient`).</span><span class="sxs-lookup"><span data-stu-id="487db-103">Microsoft SQL Server Express Edition (SQL Server Express) supports the user instance feature, which is only available when using the .NET Framework Data Provider for SQL Server (`SqlClient`).</span></span> <span data-ttu-id="487db-104">Une instance utilisateur est une instance distincte du moteur de base de données SQL Server Express générée par une instance parente.</span><span class="sxs-lookup"><span data-stu-id="487db-104">A user instance is a separate instance of the SQL Server Express Database Engine that is generated by a parent instance.</span></span> <span data-ttu-id="487db-105">Les instances utilisateur permettent aux utilisateurs qui ne sont pas des administrateurs sur leurs ordinateurs locaux de joindre et de se connecter à des bases de données SQL Server Express.</span><span class="sxs-lookup"><span data-stu-id="487db-105">User instances allow users who are not administrators on their local computers to attach and connect to SQL Server Express databases.</span></span> <span data-ttu-id="487db-106">Chaque instance s’exécute dans le contexte de sécurité de l’utilisateur individuel, sur la base d’une instance par utilisateur.</span><span class="sxs-lookup"><span data-stu-id="487db-106">Each instance runs under the security context of the individual user, on a one-instance-per-user basis.</span></span>  
  
## <a name="user-instance-capabilities"></a><span data-ttu-id="487db-107">Fonctionnalités de l'instance utilisateur</span><span class="sxs-lookup"><span data-stu-id="487db-107">User Instance Capabilities</span></span>  
 <span data-ttu-id="487db-108">Les instances utilisateur sont utiles pour les utilisateurs qui exécutent Windows dans le cadre d’un compte d’utilisateur disposant de privilèges minimum (LUA).</span><span class="sxs-lookup"><span data-stu-id="487db-108">User instances are useful for users who are running Windows under a least-privilege user account (LUA).</span></span> <span data-ttu-id="487db-109">Chaque utilisateur a SQL Server `sysadmin` des privilèges d’administrateur système sur l’instance en cours d’exécution sur son ordinateur sans avoir à s’exécuter en tant qu’administrateur Windows.</span><span class="sxs-lookup"><span data-stu-id="487db-109">Each user has SQL Server system administrator (`sysadmin`) privileges over the instance running on their computer without needing to run as a Windows administrator as well.</span></span> <span data-ttu-id="487db-110">Les logiciels qui s’exécutent sur une instance utilisateur avec des autorisations limitées ne peuvent pas apporter de modifications à l’ensemble du système, car l’instance SQL Server Express s’exécute sous le compte Windows non administrateur de l’utilisateur, pas en tant que service.</span><span class="sxs-lookup"><span data-stu-id="487db-110">Software executing on a user instance with limited permissions cannot make system-wide changes because the instance of SQL Server Express is running under the non-administrator Windows account of the user, not as a service.</span></span> <span data-ttu-id="487db-111">Chaque instance utilisateur est isolée de l’instance parente et de toutes les autres instances utilisateur exécutées sur le même ordinateur.</span><span class="sxs-lookup"><span data-stu-id="487db-111">Each user instance is isolated from its parent instance and from any other user instances running on the same computer.</span></span> <span data-ttu-id="487db-112">Les bases de données qui s’exécutent sur une instance utilisateur sont ouvertes uniquement en mode mono-utilisateur, et il n’est pas possible pour plusieurs utilisateurs de se connecter aux bases de données qui s’exécutent sur une instance utilisateur.</span><span class="sxs-lookup"><span data-stu-id="487db-112">Databases running on a user instance are opened in single-user mode only, and it is not possible for multiple users to connect to databases running on a user instance.</span></span> <span data-ttu-id="487db-113">La réplication et les requêtes distribuées sont également désactivées pour les instances utilisateur.</span><span class="sxs-lookup"><span data-stu-id="487db-113">Replication and distributed queries are also disabled for user instances.</span></span>
  
> [!NOTE]
> <span data-ttu-id="487db-114">Les instances utilisateur ne sont pas nécessaires pour les utilisateurs qui sont déjà administrateurs sur leurs propres ordinateurs ou pour les scénarios impliquant plusieurs utilisateurs de base de données.</span><span class="sxs-lookup"><span data-stu-id="487db-114">User instances are not needed for users who are already administrators on their own computers, or for scenarios involving multiple database users.</span></span>  
  
## <a name="enabling-user-instances"></a><span data-ttu-id="487db-115">Activation des instances utilisateur</span><span class="sxs-lookup"><span data-stu-id="487db-115">Enabling User Instances</span></span>  
 <span data-ttu-id="487db-116">Pour générer des instances d’utilisateur, une instance parente de SQL Server Express doit être en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="487db-116">To generate user instances, a parent instance of SQL Server Express must be running.</span></span> <span data-ttu-id="487db-117">Les instances utilisateur sont activées par défaut lors de l’installation de SQL Server Express, et elles peuvent être activées ou désactivées de manière explicite par un administrateur système qui exécute la procédure stockée **système sp_configure** sur l’instance parente.</span><span class="sxs-lookup"><span data-stu-id="487db-117">User instances are enabled by default when SQL Server Express is installed, and they can be explicitly enabled or disabled by a system administrator executing the **sp_configure** system stored procedure on the parent instance.</span></span>  
  
```sql  
-- Enable user instances.  
sp_configure 'user instances enabled','1'
  
-- Disable user instances.  
sp_configure 'user instances enabled','0'  
```  
  
 <span data-ttu-id="487db-118">Le protocole réseau pour les instances utilisateur doit être un canal nommé local.</span><span class="sxs-lookup"><span data-stu-id="487db-118">The network protocol for user instances must be local Named Pipes.</span></span> <span data-ttu-id="487db-119">Une instance utilisateur ne peut pas être démarrée sur une instance distante de SQL Server, et les connexions SQL Server ne sont pas autorisées.</span><span class="sxs-lookup"><span data-stu-id="487db-119">A user instance cannot be started on a remote instance of SQL Server, and SQL Server logins are not allowed.</span></span>  
  
## <a name="connecting-to-a-user-instance"></a><span data-ttu-id="487db-120">Connexion à une instance utilisateur</span><span class="sxs-lookup"><span data-stu-id="487db-120">Connecting to a User Instance</span></span>  
 <span data-ttu-id="487db-121">Les mots clés `User Instance` et `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> autorisent <xref:System.Data.SqlClient.SqlConnection> à se connecter à une instance utilisateur.</span><span class="sxs-lookup"><span data-stu-id="487db-121">The `User Instance` and `AttachDBFilename`<xref:System.Data.SqlClient.SqlConnection.ConnectionString%2A> keywords allow a <xref:System.Data.SqlClient.SqlConnection> to connect to a user instance.</span></span> <span data-ttu-id="487db-122">Les instances utilisateur sont également prises en charge par les propriétés <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` et `AttachDBFilename`.</span><span class="sxs-lookup"><span data-stu-id="487db-122">User instances are also supported by the <xref:System.Data.SqlClient.SqlConnectionStringBuilder>`UserInstance` and `AttachDBFilename` properties.</span></span>  
  
 <span data-ttu-id="487db-123">Notez les points suivants à propos de l’exemple de chaîne de connexion présenté ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="487db-123">Note the following about the sample connection string shown below:</span></span>  
  
- <span data-ttu-id="487db-124">Le mot clé `Data Source` fait référence à l’instance parente de SQL Server Express qui génère l’instance utilisateur.</span><span class="sxs-lookup"><span data-stu-id="487db-124">The `Data Source` keyword refers to the parent instance of SQL Server Express that is generating the user instance.</span></span> <span data-ttu-id="487db-125">L'instance par défaut est .\sqlexpress.</span><span class="sxs-lookup"><span data-stu-id="487db-125">The default instance is .\sqlexpress.</span></span>  
  
- <span data-ttu-id="487db-126">`Integrated Security` a la valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="487db-126">`Integrated Security` is set to `true`.</span></span> <span data-ttu-id="487db-127">Pour se connecter à une instance utilisateur, l’authentification Windows est requise ; les connexions SQL Server ne sont pas prises en charge.</span><span class="sxs-lookup"><span data-stu-id="487db-127">To connect to a user instance, Windows Authentication is required; SQL Server logins are not supported.</span></span>  
  
- <span data-ttu-id="487db-128">La valeur `User Instance` est définie sur `true`, ce qui appelle une instance utilisateur.</span><span class="sxs-lookup"><span data-stu-id="487db-128">The `User Instance` is set to `true`, which invokes a user instance.</span></span> <span data-ttu-id="487db-129">(La valeur par défaut est `false`.)</span><span class="sxs-lookup"><span data-stu-id="487db-129">(The default is `false`.)</span></span>  
  
- <span data-ttu-id="487db-130">Le mot clé de chaîne de connexion `AttachDbFileName` est utilisé pour attacher le fichier de base de données primaire (.mdf), qui doit inclure le nom du chemin d’accès complet.</span><span class="sxs-lookup"><span data-stu-id="487db-130">The `AttachDbFileName` connection string keyword is used to attach the primary database file (.mdf), which must include the full path name.</span></span> <span data-ttu-id="487db-131">`AttachDbFileName` correspond également aux clés « extended properties » et « initial file name » dans une chaîne de connexion <xref:System.Data.SqlClient.SqlConnection>.</span><span class="sxs-lookup"><span data-stu-id="487db-131">`AttachDbFileName` also corresponds to the "extended properties" and "initial file name" keys within a <xref:System.Data.SqlClient.SqlConnection> connection string.</span></span>  
  
- <span data-ttu-id="487db-132">La chaîne de substitution `|DataDirectory|` placée entre les symboles de barre verticale fait référence au répertoire de données de l’application qui ouvre la connexion et fournit un chemin d’accès relatif indiquant l’emplacement des fichiers journaux et de base de données .mdf et .ldf.</span><span class="sxs-lookup"><span data-stu-id="487db-132">The `|DataDirectory|` substitution string enclosed in the pipe symbols refers to the data directory of the application opening the connection and provides a relative path indicating the location of the .mdf and .ldf database and log files.</span></span> <span data-ttu-id="487db-133">Si vous souhaitez localiser ces fichiers ailleurs, vous devez fournir le chemin d’accès complet aux fichiers.</span><span class="sxs-lookup"><span data-stu-id="487db-133">If you want to locate these files elsewhere, you must provide the full path to the files.</span></span>  
  
```text
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;AttachDBFilename=|DataDirectory|\InstanceDB.mdf;  
Initial Catalog=InstanceDB;  
```  
  
> [!NOTE]
> <span data-ttu-id="487db-134">Vous pouvez également utiliser les propriétés <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> et <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> pour générer une chaîne de connexion au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="487db-134">You can also use the <xref:System.Data.SqlClient.SqlConnectionStringBuilder><xref:System.Data.SqlClient.SqlConnectionStringBuilder.UserInstance%2A> and <xref:System.Data.SqlClient.SqlConnectionStringBuilder.AttachDBFilename%2A> properties to build a connection string at run time.</span></span>  
  
### <a name="using-the-124datadirectory124-substitution-string"></a><span data-ttu-id="487db-135">Utilisation de la chaîne de substitution &#124;DataDirectory&#124;</span><span class="sxs-lookup"><span data-stu-id="487db-135">Using the &#124;DataDirectory&#124; Substitution String</span></span>  
 <span data-ttu-id="487db-136">`AttachDbFileName` a été étendu dans ADO.NET 2.0 avec l'introduction de la chaîne de substitution `|DataDirectory|` (dans les symboles de barre verticale).</span><span class="sxs-lookup"><span data-stu-id="487db-136">`AttachDbFileName` was extended in ADO.NET 2.0 with the introduction of the `|DataDirectory|` (enclosed in pipe symbols) substitution string.</span></span> <span data-ttu-id="487db-137">`DataDirectory` est utilisé conjointement à `AttachDbFileName` pour indiquer un chemin relatif à un fichier de données, ce qui permet aux développeurs de créer des chaînes de connexion basées sur un chemin relatif à la source de données au lieu de devoir spécifier un chemin complet.</span><span class="sxs-lookup"><span data-stu-id="487db-137">`DataDirectory` is used in conjunction with `AttachDbFileName` to indicate a relative path to a data file, allowing developers to create connection strings that are based on a relative path to the data source instead of being required to specify a full path.</span></span>  
  
 <span data-ttu-id="487db-138">L’emplacement physique vers lequel `DataDirectory` pointe dépend du type d’application.</span><span class="sxs-lookup"><span data-stu-id="487db-138">The physical location that `DataDirectory` points to depends on the type of application.</span></span> <span data-ttu-id="487db-139">Dans cet exemple, le fichier Northwind.mdf à joindre se trouve dans le dossier \app_data de l’application.</span><span class="sxs-lookup"><span data-stu-id="487db-139">In this example, the Northwind.mdf file to be attached is located in the application's \app_data folder.</span></span>  
  
```text
Data Source=.\\SQLExpress;Integrated Security=true;  
User Instance=true;  
AttachDBFilename=|DataDirectory|\app_data\Northwind.mdf;  
Initial Catalog=Northwind;  
```  
  
 <span data-ttu-id="487db-140">Lorsque `DataDirectory` est utilisé, le chemin de fichier résultant ne peut pas être plus haut dans la structure de répertoires que le répertoire vers lequel pointe la chaîne de substitution.</span><span class="sxs-lookup"><span data-stu-id="487db-140">When `DataDirectory` is used, the resulting file path cannot be higher in the directory structure than the directory pointed to by the substitution string.</span></span> <span data-ttu-id="487db-141">Par exemple, si le `DataDirectory` entièrement développé est C:\AppDirectory\app_data, l’exemple de chaîne de connexion illustré ci-dessus fonctionne, car il est situé sous C:\AppDirectory.</span><span class="sxs-lookup"><span data-stu-id="487db-141">For example, if the fully expanded `DataDirectory` is C:\AppDirectory\app_data, then the sample connection string shown above works because it is below c:\AppDirectory.</span></span> <span data-ttu-id="487db-142">Cependant, si vous tentez de spécifier `DataDirectory` sous la forme `|DataDirectory|\..\data`, il en résulte une erreur car \data n’est pas un sous-répertoire de \AppDirectory.</span><span class="sxs-lookup"><span data-stu-id="487db-142">However, attempting to specify `DataDirectory` as `|DataDirectory|\..\data` will result in an error because \data is not a subdirectory of \AppDirectory.</span></span>  
  
 <span data-ttu-id="487db-143">Si la chaîne de connexion a une chaîne de substitution mal mise en forme, une <xref:System.ArgumentException> est levée.</span><span class="sxs-lookup"><span data-stu-id="487db-143">If the connection string has an improperly formatted substitution string, an <xref:System.ArgumentException> will be thrown.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="487db-144"><xref:System.Data.SqlClient> résout les chaînes de substitution en chemins d’accès complets sur le système de fichiers de l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="487db-144"><xref:System.Data.SqlClient> resolves the substitution strings into full paths against the local computer file system.</span></span> <span data-ttu-id="487db-145">Par conséquent, les noms de chemin d’accès de serveur distant, HTTP et UNC ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="487db-145">Therefore, remote server, HTTP, and UNC path names are not supported.</span></span> <span data-ttu-id="487db-146">Une exception est levée lorsque la connexion est ouverte si le serveur ne se trouve pas sur l’ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="487db-146">An exception is thrown when the connection is opened if the server is not located on the local computer.</span></span>  
  
 <span data-ttu-id="487db-147">Quand la <xref:System.Data.SqlClient.SqlConnection> est ouverte, elle est redirigée de l’instance SQL Server Express par défaut vers une instance initiée au moment de l’exécution, qui s’exécute sous le compte de l’appelant.</span><span class="sxs-lookup"><span data-stu-id="487db-147">When the <xref:System.Data.SqlClient.SqlConnection> is opened, it is redirected from the default SQL Server Express instance to a run-time initiated instance running under the caller's account.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="487db-148">Il peut être nécessaire d’augmenter la valeur de <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A>, car le chargement des instances utilisateur peut prendre plus de temps que les instances normales.</span><span class="sxs-lookup"><span data-stu-id="487db-148">It may be necessary to increase the <xref:System.Data.SqlClient.SqlConnection.ConnectionTimeout%2A> value since user instances may take longer to load than regular instances.</span></span>  
  
 <span data-ttu-id="487db-149">Le fragment de code suivant ouvre une nouvelle `SqlConnection`, affiche la chaîne de connexion dans la fenêtre de console, puis ferme la connexion lors de la sortie du bloc de code `using`.</span><span class="sxs-lookup"><span data-stu-id="487db-149">The following code fragment opens a new `SqlConnection`, displays the connection string in the console window, and then closes the connection when exiting the `using` code block.</span></span>  
  
```vb  
Private Sub OpenSqlConnection()  
    ' Retrieve the connection string.  
    Dim connectionString As String = GetConnectionString()  
  
    Using connection As New SqlConnection(connectionString)  
        connection.Open()  
        Console.WriteLine("ConnectionString: {0}", _  
           connection.ConnectionString)  
    End Using  
End Sub  
```  
  
```csharp  
private static void OpenSqlConnection()  
{  
    // Retrieve the connection string.  
    string connectionString = GetConnectionString();  
  
    using (SqlConnection connection =
        new SqlConnection(connectionString))  
    {  
        connection.Open();  
        Console.WriteLine("ConnectionString: {0}",
             connection.ConnectionString);  
    }  
}  
```  
  
> [!NOTE]
> <span data-ttu-id="487db-150">Les instances utilisateur ne sont pas prises en charge dans le Common Language Runtime (CLR) qui s’exécute dans SQL Server.</span><span class="sxs-lookup"><span data-stu-id="487db-150">User instances are not supported in common language runtime (CLR) code that is running inside of SQL Server.</span></span> <span data-ttu-id="487db-151">Une <xref:System.InvalidOperationException> est levée si `Open` est appelé sur une <xref:System.Data.SqlClient.SqlConnection> qui a `User Instance=true` dans la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="487db-151">An <xref:System.InvalidOperationException> is thrown if `Open` is called on a <xref:System.Data.SqlClient.SqlConnection> that has `User Instance=true` in the connection string.</span></span>  
  
## <a name="lifetime-of-a-user-instance-connection"></a><span data-ttu-id="487db-152">Durée de vie d'une connexion à une instance utilisateur</span><span class="sxs-lookup"><span data-stu-id="487db-152">Lifetime of a User Instance Connection</span></span>  
 <span data-ttu-id="487db-153">Contrairement aux versions de SQL Server qui s’exécutent en tant que service, les instances SQL Server Express n’ont pas besoin d’être démarrées et arrêtées manuellement.</span><span class="sxs-lookup"><span data-stu-id="487db-153">Unlike versions of SQL Server that run as a service, SQL Server Express instances do not need to be manually started and stopped.</span></span> <span data-ttu-id="487db-154">Chaque fois qu’un utilisateur s’identifie et se connecte à une instance utilisateur, l’instance utilisateur est démarrée si elle n’est pas déjà en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="487db-154">Each time a user logs in and connects to a user instance, the user instance is started if it is not already running.</span></span> <span data-ttu-id="487db-155">L’option `AutoClose` est définie pour les bases de données d’instance utilisateur afin que la base de données s’arrête automatiquement après une période d’inactivité.</span><span class="sxs-lookup"><span data-stu-id="487db-155">User instance databases have the `AutoClose` option set so that the database is automatically shut down after a period of inactivity.</span></span> <span data-ttu-id="487db-156">Le processus sqlservr.exe démarré reste en cours d’exécution pendant un délai d’attente limité après la fermeture de la dernière connexion à l’instance ; il n’est donc pas nécessaire de redémarrer si une autre connexion est ouverte avant l’expiration du délai d’attente.</span><span class="sxs-lookup"><span data-stu-id="487db-156">The sqlservr.exe process that is started is kept running for a limited time-out period after the last connection to the instance is closed, so it does not need to be restarted if another connection is opened before the time-out has expired.</span></span> <span data-ttu-id="487db-157">L’instance utilisateur s’arrête automatiquement si aucune nouvelle connexion n’est ouverte avant l’expiration du délai d’attente.</span><span class="sxs-lookup"><span data-stu-id="487db-157">The user instance automatically shuts down if no new connection opens before that time-out period has expired.</span></span> <span data-ttu-id="487db-158">Un administrateur système sur l’instance parente peut définir la durée du délai d’attente pour une instance utilisateur à l’aide de **sp_configure** afin de modifier l’option de **délai d’attente de l’instance utilisateur**.</span><span class="sxs-lookup"><span data-stu-id="487db-158">A system administrator on the parent instance can set the duration of the time-out period for a user instance by using **sp_configure** to change the **user instance timeout** option.</span></span> <span data-ttu-id="487db-159">La valeur par défaut est de 60 minutes.</span><span class="sxs-lookup"><span data-stu-id="487db-159">The default is 60 minutes.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="487db-160">Si `Min Pool Size` est utilisé dans la chaîne de connexion avec une valeur supérieure à zéro, le dispositif de regroupement garde toujours quelques connexions ouvertes et l’instance utilisateur ne s’arrête pas automatiquement.</span><span class="sxs-lookup"><span data-stu-id="487db-160">If `Min Pool Size` is used in the connection string with a value greater than zero, the connection pooler will always maintain a few opened connections, and the user instance will not automatically shut down.</span></span>  
  
## <a name="how-user-instances-work"></a><span data-ttu-id="487db-161">Fonctionnement des instances utilisateur</span><span class="sxs-lookup"><span data-stu-id="487db-161">How User Instances Work</span></span>  
 <span data-ttu-id="487db-162">La première fois qu’une instance utilisateur est générée pour chaque utilisateur, les bases de données système **master** et **msdb** sont copiées du dossier Template Data vers un chemin sous le répertoire de stockage des données d’application local de l’utilisateur pour être utilisées exclusivement par l’instance utilisateur.</span><span class="sxs-lookup"><span data-stu-id="487db-162">The first time a user instance is generated for each user, the **master** and **msdb** system databases are copied from the Template Data folder to a path under the user's local application data repository directory for exclusive use by the user instance.</span></span> <span data-ttu-id="487db-163">Ce chemin d’accès est généralement `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span><span class="sxs-lookup"><span data-stu-id="487db-163">This path is typically `C:\Documents and Settings\<UserName>\Local Settings\Application Data\Microsoft\Microsoft SQL Server Data\SQLEXPRESS`.</span></span> <span data-ttu-id="487db-164">Quand une instance utilisateur démarre, les fichiers **tempdb**, journaux et de suivi sont aussi écrits dans ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="487db-164">When a user instance starts up, the **tempdb**, log, and trace files are also written to this directory.</span></span> <span data-ttu-id="487db-165">Un nom est généré pour l’instance, et son unicité est garantie pour chaque utilisateur.</span><span class="sxs-lookup"><span data-stu-id="487db-165">A name is generated for the instance, which is guaranteed to be unique for each user.</span></span>  
  
 <span data-ttu-id="487db-166">Par défaut, tous les membres du groupe Windows Builtin\Users disposent des autorisations pour se connecter à l’instance locale, ainsi que des autorisations de lecture et d’exécution sur les fichiers binaires de SQL Server.</span><span class="sxs-lookup"><span data-stu-id="487db-166">By default all members of the Windows Builtin\Users group are granted permissions to connect on the local instance as well as read and execute permissions on the SQL Server binaries.</span></span> <span data-ttu-id="487db-167">Une fois que les informations d’identification de l’utilisateur appelant qui héberge l’instance utilisateur ont été vérifiées, cet utilisateur devient le `sysadmin` sur cette instance.</span><span class="sxs-lookup"><span data-stu-id="487db-167">Once the credentials of the calling user hosting the user instance have been verified, that user becomes the `sysadmin` on that instance.</span></span> <span data-ttu-id="487db-168">Seule la mémoire partagée est activée pour les instances utilisateur, ce qui signifie que seules les opérations sur l’ordinateur local sont possibles.</span><span class="sxs-lookup"><span data-stu-id="487db-168">Only shared memory is enabled for user instances, which means that only operations on the local machine are possible.</span></span>  
  
 <span data-ttu-id="487db-169">Les utilisateurs doivent disposer d’autorisations en lecture et en écriture sur les fichiers .mdf et .ldf spécifiés dans la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="487db-169">Users must be granted both read and write permissions on the .mdf and .ldf files specified in the connection string.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="487db-170">Les fichiers .mdf et .ldf représentent les fichiers de base de données et les fichiers journaux, respectivement.</span><span class="sxs-lookup"><span data-stu-id="487db-170">The .mdf and .ldf files represent the database and log files, respectively.</span></span> <span data-ttu-id="487db-171">Ces deux fichiers étant un ensemble mis en correspondance, il convient de faire preuve de prudence lors des opérations de sauvegarde et de restauration.</span><span class="sxs-lookup"><span data-stu-id="487db-171">These two files are a matched set, so care must be taken during backup and restore operations.</span></span> <span data-ttu-id="487db-172">Le fichier de base de données contient des informations sur la version exacte du fichier journal, et la base de données ne s’ouvre pas si elle est couplée au mauvais fichier journal.</span><span class="sxs-lookup"><span data-stu-id="487db-172">The database file contains information about the exact version of the log file, and the database will not open if it is coupled with the wrong log file.</span></span>  
  
 <span data-ttu-id="487db-173">Pour éviter tout endommagement des données, une base de données de l’instance utilisateur est ouverte avec un accès exclusif.</span><span class="sxs-lookup"><span data-stu-id="487db-173">To avoid data corruption, a database in the user instance is opened with exclusive access.</span></span> <span data-ttu-id="487db-174">Si deux instances utilisateur différentes partagent la même base de données sur le même ordinateur, l’utilisateur sur la première instance doit fermer la base de données avant de pouvoir l’ouvrir dans une deuxième instance.</span><span class="sxs-lookup"><span data-stu-id="487db-174">If two different user instances share the same database on the same computer, the user on the first instance must close the database before it can be opened in a second instance.</span></span>  
  
## <a name="user-instance-scenarios"></a><span data-ttu-id="487db-175">Scénarios d'instance utilisateur</span><span class="sxs-lookup"><span data-stu-id="487db-175">User Instance Scenarios</span></span>  
 <span data-ttu-id="487db-176">Les instances utilisateur fournissent aux développeurs d’applications de base de données un magasin de données SQL Server qui ne nécessite pas que les développeurs disposent de comptes d’administration sur leurs ordinateurs de développement.</span><span class="sxs-lookup"><span data-stu-id="487db-176">User instances provide developers of database applications with a SQL Server data store that does not depend on developers having administrative accounts on their development computers.</span></span> <span data-ttu-id="487db-177">Les instances utilisateur sont basées sur le modèle Access/Jet, où l’application de base de données se connecte simplement à un fichier, et l’utilisateur dispose automatiquement d’autorisations complètes sur tous les objets de base de données sans avoir besoin de l’intervention d’un administrateur système pour accorder des autorisations.</span><span class="sxs-lookup"><span data-stu-id="487db-177">User instances are based on the Access/Jet model, where the database application simply connects to a file, and the user automatically has full permissions on all of the database objects without needing the intervention of a system administrator to grant permissions.</span></span> <span data-ttu-id="487db-178">Ce comportement est prévu pour fonctionner dans des situations où l’utilisateur s’exécute sous un compte d’utilisateur avec des privilèges minimum et ne dispose pas de privilèges d’administrateur sur le serveur ou l’ordinateur local, mais a besoin de créer des objets et applications de base de données.</span><span class="sxs-lookup"><span data-stu-id="487db-178">It is intended to work in situations where the user is running under a least-privilege user account (LUA) and does not have administrative privileges on the server or local machine, yet needs to create database objects and applications.</span></span> <span data-ttu-id="487db-179">Les instances utilisateur permettent aux utilisateurs de créer des instances au moment de l’exécution qui s’exécutent sous le contexte de sécurité de l’utilisateur, et non dans le contexte de sécurité d’un service système plus privilégié.</span><span class="sxs-lookup"><span data-stu-id="487db-179">User instances allow users to create instances at run time that run under the user's own security context, and not in the security context of a more privileged system service.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="487db-180">Les instances utilisateur ne doivent être utilisées que dans les scénarios où toutes les applications qui l’utilisent sont entièrement fiables.</span><span class="sxs-lookup"><span data-stu-id="487db-180">User instances should only be used in scenarios where all the applications using it are fully trusted.</span></span>  
  
 <span data-ttu-id="487db-181">Les scénarios d’instance utilisateur sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="487db-181">User instance scenarios include:</span></span>  
  
- <span data-ttu-id="487db-182">Toute application mono-utilisateur où le partage de données n’est pas requis.</span><span class="sxs-lookup"><span data-stu-id="487db-182">Any single-user application where sharing data is not required.</span></span>  
  
- <span data-ttu-id="487db-183">Déploiement ClickOnce.</span><span class="sxs-lookup"><span data-stu-id="487db-183">ClickOnce deployment.</span></span> <span data-ttu-id="487db-184">Si .NET Framework 2,0 (ou version ultérieure) et SQL Server Express sont déjà installés sur l’ordinateur cible, le package d’installation téléchargé suite à une action ClickOnce peut être installé et utilisé par des utilisateurs non-administrateurs.</span><span class="sxs-lookup"><span data-stu-id="487db-184">If .NET Framework 2.0 (or later) and SQL Server Express are already installed on the target computer, the installation package downloaded as a result of a ClickOnce action can be installed and used by non-administrator users.</span></span> <span data-ttu-id="487db-185">Notez qu’un administrateur doit installer SQL Server Express s’il fait partie de l’installation.</span><span class="sxs-lookup"><span data-stu-id="487db-185">Note that an administrator must install SQL Server Express if that is part of the setup.</span></span> <span data-ttu-id="487db-186">Pour plus d'informations, consultez [Déploiement ClickOnce pour Windows Forms](/dotnet/desktop/winforms/clickonce-deployment-for-windows-forms).</span><span class="sxs-lookup"><span data-stu-id="487db-186">For more information, see [ClickOnce Deployment for Windows Forms](/dotnet/desktop/winforms/clickonce-deployment-for-windows-forms).</span></span>
  
- <span data-ttu-id="487db-187">Hébergement ASP.NET dédié à l’aide de l’authentification Windows.</span><span class="sxs-lookup"><span data-stu-id="487db-187">Dedicated ASP.NET hosting using Windows Authentication.</span></span> <span data-ttu-id="487db-188">Une seule instance SQL Server Express peut être hébergée sur un intranet.</span><span class="sxs-lookup"><span data-stu-id="487db-188">A single SQL Server Express instance can be hosted on an intranet.</span></span> <span data-ttu-id="487db-189">L’application se connecte à l’aide du compte Windows ASPNET, et non à l’aide de l’emprunt d’identité.</span><span class="sxs-lookup"><span data-stu-id="487db-189">The application connects using the ASPNET Windows account, not by using impersonation.</span></span> <span data-ttu-id="487db-190">Les instances utilisateur ne doivent pas être utilisées pour les scénarios d’hébergement tiers ou partagé, où toutes les applications partagent la même instance utilisateur et ne sont plus isolées les unes des autres.</span><span class="sxs-lookup"><span data-stu-id="487db-190">User instances should not be used for third-party or shared hosting scenarios where all applications would share the same user instance and would no longer remain isolated from each other.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="487db-191">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="487db-191">See also</span></span>

- [<span data-ttu-id="487db-192">SQL Server et ADO.NET</span><span class="sxs-lookup"><span data-stu-id="487db-192">SQL Server and ADO.NET</span></span>](index.md)
- [<span data-ttu-id="487db-193">Chaînes de connexion</span><span class="sxs-lookup"><span data-stu-id="487db-193">Connection Strings</span></span>](../connection-strings.md)
- [<span data-ttu-id="487db-194">Connexion à une source de données</span><span class="sxs-lookup"><span data-stu-id="487db-194">Connecting to a Data Source</span></span>](../connecting-to-a-data-source.md)
- [<span data-ttu-id="487db-195">Vue d'ensemble d’ADO.NET</span><span class="sxs-lookup"><span data-stu-id="487db-195">ADO.NET Overview</span></span>](../ado-net-overview.md)

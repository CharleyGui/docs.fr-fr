---
title: Modèle objet LINQ to SQL
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 81dd0c37-e2a4-4694-83b0-f2e49e693810
ms.openlocfilehash: b17e1b6f4a6f849e3b42d69e9b9c2d5f906218e1
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/24/2020
ms.locfileid: "91155508"
---
# <a name="the-linq-to-sql-object-model"></a><span data-ttu-id="7435d-102">Modèle objet LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="7435d-102">The LINQ to SQL Object Model</span></span>

<span data-ttu-id="7435d-103">Dans [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] , un modèle objet exprimé dans le langage de programmation du développeur est mappé au modèle de données d’une base de données relationnelle.</span><span class="sxs-lookup"><span data-stu-id="7435d-103">In [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)], an object model expressed in the programming language of the developer is mapped to the data model of a relational database.</span></span> <span data-ttu-id="7435d-104">Les opérations sur les données sont ensuite effectuées en fonction du modèle objet.</span><span class="sxs-lookup"><span data-stu-id="7435d-104">Operations on the data are then conducted according to the object model.</span></span>  
  
 <span data-ttu-id="7435d-105">Dans ce scénario, vous ne transmettez pas de commandes de base de données (par exemple, `INSERT`) à la base de données.</span><span class="sxs-lookup"><span data-stu-id="7435d-105">In this scenario, you do not issue database commands (for example, `INSERT`) to the database.</span></span> <span data-ttu-id="7435d-106">Vous modifiez des valeurs et exécutez des méthodes dans votre modèle objet.</span><span class="sxs-lookup"><span data-stu-id="7435d-106">Instead, you change values and execute methods within your object model.</span></span> <span data-ttu-id="7435d-107">Lorsque vous souhaitez interroger la base de données ou lui envoyer des modifications, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] traduit vos demandes en commandes SQL appropriées et envoie ces commandes à la base de données.</span><span class="sxs-lookup"><span data-stu-id="7435d-107">When you want to query the database or send it changes, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] translates your requests into the correct SQL commands and sends those commands to the database.</span></span>  
  
 ![Capture d’écran qui montre le modèle d’objet LINQ.](./media/the-linq-to-sql-object-model/linq-object-model-two-tier.png)  
  
 <span data-ttu-id="7435d-109">Les éléments les plus fondamentaux dans le [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] modèle objet et leur relation aux éléments dans le modèle de données relationnelles sont résumés dans le tableau suivant :</span><span class="sxs-lookup"><span data-stu-id="7435d-109">The most fundamental elements in the [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] object model and their relationship to elements in the relational data model are summarized in the following table:</span></span>  
  
|<span data-ttu-id="7435d-110">Modèle d'objet LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="7435d-110">LINQ to SQL Object Model</span></span>|<span data-ttu-id="7435d-111">Modèle de données relationnel</span><span class="sxs-lookup"><span data-stu-id="7435d-111">Relational Data Model</span></span>|  
|------------------------------|---------------------------|  
|<span data-ttu-id="7435d-112">Classe d'entité</span><span class="sxs-lookup"><span data-stu-id="7435d-112">Entity class</span></span>|<span data-ttu-id="7435d-113">Table de charge de travail</span><span class="sxs-lookup"><span data-stu-id="7435d-113">Table</span></span>|  
|<span data-ttu-id="7435d-114">Membre de classe</span><span class="sxs-lookup"><span data-stu-id="7435d-114">Class member</span></span>|<span data-ttu-id="7435d-115">Colonne</span><span class="sxs-lookup"><span data-stu-id="7435d-115">Column</span></span>|  
|<span data-ttu-id="7435d-116">Association</span><span class="sxs-lookup"><span data-stu-id="7435d-116">Association</span></span>|<span data-ttu-id="7435d-117">Relation de clé étrangère</span><span class="sxs-lookup"><span data-stu-id="7435d-117">Foreign-key relationship</span></span>|  
|<span data-ttu-id="7435d-118">Méthode</span><span class="sxs-lookup"><span data-stu-id="7435d-118">Method</span></span>|<span data-ttu-id="7435d-119">Procédure stockée ou fonction</span><span class="sxs-lookup"><span data-stu-id="7435d-119">Stored Procedure or Function</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="7435d-120">Les descriptions suivantes supposent que vous possédez des connaissances de base sur le modèle de données relationnel et ses règles.</span><span class="sxs-lookup"><span data-stu-id="7435d-120">The following descriptions assume that you have a basic knowledge of the relational data model and rules.</span></span>  
  
## <a name="linq-to-sql-entity-classes-and-database-tables"></a><span data-ttu-id="7435d-121">Classes d'entité et tables de base de données LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="7435d-121">LINQ to SQL Entity Classes and Database Tables</span></span>  

 <span data-ttu-id="7435d-122">Dans [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] , une table de base de données est représentée par une *classe d’entité*.</span><span class="sxs-lookup"><span data-stu-id="7435d-122">In [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)], a database table is represented by an *entity class*.</span></span> <span data-ttu-id="7435d-123">Une classe d'entité est similaire aux autres classes si ce n'est que vous pouvez l'annoter en utilisant des informations spéciales qui l'associent à une table de base de données.</span><span class="sxs-lookup"><span data-stu-id="7435d-123">An entity class is like any other class you might create except that you annotate the class by using special information that associates the class with a database table.</span></span> <span data-ttu-id="7435d-124">Pour procéder à cette annotation, ajoutez un attribut personnalisé (<xref:System.Data.Linq.Mapping.TableAttribute>) à votre déclaration de classe, comme dans l'exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="7435d-124">You make this annotation by adding a custom attribute (<xref:System.Data.Linq.Mapping.TableAttribute>) to your class declaration, as in the following example:</span></span>  
  
### <a name="example"></a><span data-ttu-id="7435d-125">Exemple</span><span class="sxs-lookup"><span data-stu-id="7435d-125">Example</span></span>  

 [!code-csharp[DLinqObjectModel#1](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqObjectModel/cs/Program.cs#1)]
 [!code-vb[DLinqObjectModel#1](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqObjectModel/vb/Module1.vb#1)]  
  
 <span data-ttu-id="7435d-126">Seules les instances de classes déclarées comme des tables (classes d'entité) peuvent être enregistrées dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="7435d-126">Only instances of classes declared as tables (that is, entity classes) can be saved to the database.</span></span>  
  
 <span data-ttu-id="7435d-127">Pour plus d’informations, consultez la section attribut de table du [mappage basé sur les attributs](attribute-based-mapping.md).</span><span class="sxs-lookup"><span data-stu-id="7435d-127">For more information, see the Table Attribute section of [Attribute-Based Mapping](attribute-based-mapping.md).</span></span>  
  
## <a name="linq-to-sql-class-members-and-database-columns"></a><span data-ttu-id="7435d-128">Membres de classe et colonnes de base de données LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="7435d-128">LINQ to SQL Class Members and Database Columns</span></span>  

 <span data-ttu-id="7435d-129">Vous pouvez non seulement associer des classes à des tables, mais également désigner des champs ou des propriétés pour représenter des colonnes de base de données.</span><span class="sxs-lookup"><span data-stu-id="7435d-129">In addition to associating classes with tables, you designate fields or properties to represent database columns.</span></span> <span data-ttu-id="7435d-130">À cette fin, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] définit l'attribut <xref:System.Data.Linq.Mapping.ColumnAttribute>, comme dans l'exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="7435d-130">For this purpose, [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] defines the <xref:System.Data.Linq.Mapping.ColumnAttribute> attribute, as in the following example:</span></span>  
  
### <a name="example"></a><span data-ttu-id="7435d-131">Exemple</span><span class="sxs-lookup"><span data-stu-id="7435d-131">Example</span></span>  

 [!code-csharp[DLinqObjectModel#2](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqObjectModel/cs/Program.cs#2)]
 [!code-vb[DLinqObjectModel#2](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqObjectModel/vb/Module1.vb#2)]  
  
 <span data-ttu-id="7435d-132">Seuls les champs et les propriétés mappés à des colonnes sont rendus persistants ou récupérés dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="7435d-132">Only fields and properties mapped to columns are persisted to or retrieved from the database.</span></span> <span data-ttu-id="7435d-133">Ceux qui ne sont pas déclarés comme des colonnes sont considérés comme des éléments temporaires de votre logique d'application.</span><span class="sxs-lookup"><span data-stu-id="7435d-133">Those not declared as columns are considered as transient parts of your application logic.</span></span>  
  
 <span data-ttu-id="7435d-134">L'attribut <xref:System.Data.Linq.Mapping.ColumnAttribute> possède diverses propriétés que vous pouvez utiliser pour personnaliser les membres qui représentent des colonnes (par exemple, désigner un membre comme représentant d'une colonne de clé primaire).</span><span class="sxs-lookup"><span data-stu-id="7435d-134">The <xref:System.Data.Linq.Mapping.ColumnAttribute> attribute has a variety of properties that you can use to customize these members that represent columns (for example, designating a member as representing a primary key column).</span></span> <span data-ttu-id="7435d-135">Pour plus d’informations, consultez la section attribut de colonne du [mappage basé sur les attributs](attribute-based-mapping.md).</span><span class="sxs-lookup"><span data-stu-id="7435d-135">For more information, see the Column Attribute section of [Attribute-Based Mapping](attribute-based-mapping.md).</span></span>  
  
## <a name="linq-to-sql-associations-and-database-foreign-key-relationships"></a><span data-ttu-id="7435d-136">Associations et relations de clé étrangère de base de données LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="7435d-136">LINQ to SQL Associations and Database Foreign-key Relationships</span></span>  

 <span data-ttu-id="7435d-137">Dans [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] , vous représentez les associations de base de données (telles que les relations de clé étrangère à clé primaire) en appliquant l' <xref:System.Data.Linq.Mapping.AssociationAttribute> attribut.</span><span class="sxs-lookup"><span data-stu-id="7435d-137">In [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)], you represent database associations (such as foreign-key to primary-key relationships) by applying the <xref:System.Data.Linq.Mapping.AssociationAttribute> attribute.</span></span> <span data-ttu-id="7435d-138">Dans le segment de code suivant, la `Order` classe contient une `Customer` propriété qui a un <xref:System.Data.Linq.Mapping.AssociationAttribute> attribut.</span><span class="sxs-lookup"><span data-stu-id="7435d-138">In the following segment of code, the `Order` class contains a `Customer` property that has an <xref:System.Data.Linq.Mapping.AssociationAttribute> attribute.</span></span> <span data-ttu-id="7435d-139">Cette propriété et son attribut fournissent à la classe `Order` une relation avec la classe `Customer`.</span><span class="sxs-lookup"><span data-stu-id="7435d-139">This property and its attribute provide the `Order` class with a relationship to the `Customer` class.</span></span>  
  
 <span data-ttu-id="7435d-140">L'exemple de code suivant présente la propriété `Customer` de la classe `Order`.</span><span class="sxs-lookup"><span data-stu-id="7435d-140">The following code example shows the `Customer` property from the `Order` class.</span></span>  
  
### <a name="example"></a><span data-ttu-id="7435d-141">Exemple</span><span class="sxs-lookup"><span data-stu-id="7435d-141">Example</span></span>  

 [!code-csharp[DLinqObjectModel#3](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqObjectModel/cs/northwind.cs#3)]
 [!code-vb[DLinqObjectModel#3](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqObjectModel/vb/northwind.vb#3)]  
  
 <span data-ttu-id="7435d-142">Pour plus d’informations, consultez la section attribut d’association du [mappage basé sur les attributs](attribute-based-mapping.md).</span><span class="sxs-lookup"><span data-stu-id="7435d-142">For more information, see the Association Attribute section of [Attribute-Based Mapping](attribute-based-mapping.md).</span></span>  
  
## <a name="linq-to-sql-methods-and-database-stored-procedures"></a><span data-ttu-id="7435d-143">Méthodes et procédures stockées de base de données LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="7435d-143">LINQ to SQL Methods and Database Stored Procedures</span></span>  

 [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="7435d-144">prend en charge des procédures stockées et des fonctions définies par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="7435d-144">supports stored procedures and user-defined functions.</span></span> <span data-ttu-id="7435d-145">Dans [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] , vous mappez ces abstractions définies par la base de données aux objets clients afin que vous puissiez y accéder de manière fortement typée à partir du code client.</span><span class="sxs-lookup"><span data-stu-id="7435d-145">In [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)], you map these database-defined abstractions to client objects so that you can access them in a strongly typed manner from client code.</span></span> <span data-ttu-id="7435d-146">Les signatures de méthode sont aussi semblables que possible aux signatures des procédures et fonctions définies dans la base de données.</span><span class="sxs-lookup"><span data-stu-id="7435d-146">The method signatures resemble as closely as possible the signatures of the procedures and functions defined in the database.</span></span> <span data-ttu-id="7435d-147">Vous pouvez utiliser IntelliSense pour découvrir ces méthodes.</span><span class="sxs-lookup"><span data-stu-id="7435d-147">You can use IntelliSense to discover these methods.</span></span>  
  
 <span data-ttu-id="7435d-148">Un jeu de résultats retourné par un appel à une procédure mappée est une collection fortement typée.</span><span class="sxs-lookup"><span data-stu-id="7435d-148">A result set that is returned by a call to a mapped procedure is a strongly typed collection.</span></span>  
  
 [!INCLUDE[vbtecdlinq](../../../../../../includes/vbtecdlinq-md.md)] <span data-ttu-id="7435d-149">mappe des procédures stockées et des fonctions à des méthodes en utilisant les attributs <xref:System.Data.Linq.Mapping.FunctionAttribute> et <xref:System.Data.Linq.Mapping.ParameterAttribute>.</span><span class="sxs-lookup"><span data-stu-id="7435d-149">maps stored procedures and functions to methods by using the <xref:System.Data.Linq.Mapping.FunctionAttribute> and <xref:System.Data.Linq.Mapping.ParameterAttribute> attributes.</span></span> <span data-ttu-id="7435d-150">Les méthodes qui représentent des procédures stockées se distinguent de celles qui représentent des fonctions définies par l'utilisateur par la propriété <xref:System.Data.Linq.Mapping.FunctionAttribute.IsComposable%2A>.</span><span class="sxs-lookup"><span data-stu-id="7435d-150">Methods representing stored procedures are distinguished from those representing user-defined functions by the <xref:System.Data.Linq.Mapping.FunctionAttribute.IsComposable%2A> property.</span></span> <span data-ttu-id="7435d-151">Si cette propriété a la valeur `false` (valeur par défaut), la méthode représente une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="7435d-151">If this property is set to `false` (the default), the method represents a stored procedure.</span></span> <span data-ttu-id="7435d-152">Si elle a la valeur `true`, la méthode représente une fonction de base de données.</span><span class="sxs-lookup"><span data-stu-id="7435d-152">If it is set to `true`, the method represents a database function.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7435d-153">Si vous utilisez Visual Studio, vous pouvez utiliser la Concepteur Objet Relationnel pour créer des méthodes mappées à des procédures stockées et à des fonctions définies par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="7435d-153">If you are using Visual Studio, you can use the Object Relational Designer to create methods mapped to stored procedures and user-defined functions.</span></span>  
  
### <a name="example"></a><span data-ttu-id="7435d-154">Exemple</span><span class="sxs-lookup"><span data-stu-id="7435d-154">Example</span></span>  

 [!code-csharp[DLinqObjectModel#4](../../../../../../samples/snippets/csharp/VS_Snippets_Data/DLinqObjectModel/cs/northwind.cs#4)]
 [!code-vb[DLinqObjectModel#4](../../../../../../samples/snippets/visualbasic/VS_Snippets_Data/DLinqObjectModel/vb/northwind.vb#4)]  
  
 <span data-ttu-id="7435d-155">Pour plus d’informations, consultez les sections attribut de fonction, attribut de procédure stockée et attribut de paramètre du mappage et des [procédures stockées](stored-procedures.md) [basés sur des attributs](attribute-based-mapping.md) .</span><span class="sxs-lookup"><span data-stu-id="7435d-155">For more information, see the Function Attribute, Stored Procedure Attribute, and Parameter Attribute sections of [Attribute-Based Mapping](attribute-based-mapping.md) and [Stored Procedures](stored-procedures.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7435d-156">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7435d-156">See also</span></span>

- [<span data-ttu-id="7435d-157">Mappage basé sur les attributs</span><span class="sxs-lookup"><span data-stu-id="7435d-157">Attribute-Based Mapping</span></span>](attribute-based-mapping.md)
- [<span data-ttu-id="7435d-158">Informations générales</span><span class="sxs-lookup"><span data-stu-id="7435d-158">Background Information</span></span>](background-information.md)

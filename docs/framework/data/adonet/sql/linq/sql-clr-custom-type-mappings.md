---
title: Mappages de types personnalisés SQL-CLR
ms.date: 03/30/2017
ms.assetid: d916c7fb-4b56-4214-acbe-5e23365047b2
ms.openlocfilehash: 8901998533ec14e733ea072dd1a69b465e596328
ms.sourcegitcommit: d2e1dfa7ef2d4e9ffae3d431cf6a4ffd9c8d378f
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/07/2019
ms.locfileid: "70781086"
---
# <a name="sql-clr-custom-type-mappings"></a><span data-ttu-id="7ad44-102">Mappages de types personnalisés SQL-CLR</span><span class="sxs-lookup"><span data-stu-id="7ad44-102">SQL-CLR Custom Type Mappings</span></span>
<span data-ttu-id="7ad44-103">Le mappage de type entre SQL Server et le langage Common Language Runtime (CLR) est automatiquement spécifié lorsque vous utilisez l'outil de ligne de commande SQLMetal ou le Concepteur Objet/Relationnel (Concepteur O/R).</span><span class="sxs-lookup"><span data-stu-id="7ad44-103">Type mapping between SQL Server and the common language runtime (CLR) is automatically specified when you use the SQLMetal command-line tool, Object Relational Designer (O/R Designer).</span></span>  
  
 <span data-ttu-id="7ad44-104">Quand aucun mappage personnalisé n’est effectué, ces outils assignent des mappages de types par défaut, comme décrit dans [mappage de type SQL-CLR](sql-clr-type-mapping.md).</span><span class="sxs-lookup"><span data-stu-id="7ad44-104">When no customized mapping is performed, these tools assign default type mappings as described in [SQL-CLR Type Mapping](sql-clr-type-mapping.md).</span></span> <span data-ttu-id="7ad44-105">Si vous souhaitez que les mappages de types s'effectuent différemment de ceux par défaut, vous devez les personnaliser.</span><span class="sxs-lookup"><span data-stu-id="7ad44-105">If you want to type mappings differently from these defaults, you need to do some customization of the type mappings.</span></span>  
  
 <span data-ttu-id="7ad44-106">Lors de la personnalisation des mappages de types, l'approche recommandée consiste à modifier un fichier DBML intermédiaire.</span><span class="sxs-lookup"><span data-stu-id="7ad44-106">When customizing type mappings, the recommended approach is to make the changes in an intermediary DBML file.</span></span> <span data-ttu-id="7ad44-107">Vous devez ensuite utiliser ce fichier DBML personnalisé lorsque vous créez les fichiers de code et de mappage à l'aide de SQLMetal ou du Concepteur O/R.</span><span class="sxs-lookup"><span data-stu-id="7ad44-107">Then, your customized DBML file should be used when you create you code and mapping files with SQLMetal or O/R Designer.</span></span>  
  
 <span data-ttu-id="7ad44-108">Après avoir instancié l'objet <xref:System.Data.Linq.DataContext> à partir des fichiers de code et de mappage, la méthode <xref:System.Data.Linq.DataContext.CreateDatabase%2A?displayProperty=nameWithType> crée une base de données en fonction des mappages de types spécifiés.</span><span class="sxs-lookup"><span data-stu-id="7ad44-108">Once you instantiate the <xref:System.Data.Linq.DataContext> object from the code and mapping files, the <xref:System.Data.Linq.DataContext.CreateDatabase%2A?displayProperty=nameWithType> method creates a database based on the type mappings that are specified.</span></span> <span data-ttu-id="7ad44-109">En l'absence d'attributs `type` CLR spécifié dans les mappages, les mappages de types par défaut sont utilisés.</span><span class="sxs-lookup"><span data-stu-id="7ad44-109">If there are no CLR `type` attributes specified in the mappings, the default type mappings will be used.</span></span>  
  
## <a name="customization-with-sqlmetal-or-or-designer"></a><span data-ttu-id="7ad44-110">Personnalisation à l'aide de SQLMetal ou du Concepteur O/R</span><span class="sxs-lookup"><span data-stu-id="7ad44-110">Customization with SQLMetal or O/R Designer</span></span>  
 <span data-ttu-id="7ad44-111">SQLMetal et le Concepteur O/R vous permettent de créer automatiquement un modèle objet qui inclut les informations de mappage de type à l'intérieur ou à l'extérieur du fichier de code.</span><span class="sxs-lookup"><span data-stu-id="7ad44-111">With SQLMetal and O/R Designer, you can automatically create an object model that includes the type mapping information inside or outside the code file.</span></span> <span data-ttu-id="7ad44-112">Ces fichiers étant remplacés par SQLMetal ou le Concepteur O/R, chaque fois que vous recréez vos mappages, l'approche recommandée en termes de spécification de mappages de types personnalisés consiste à personnaliser un fichier DBML.</span><span class="sxs-lookup"><span data-stu-id="7ad44-112">Because these files are overwritten by SQLMetal or O/R Designer, each time you recreate your mappings, the recommended approach to specifying custom type mappings is to customize a DBML file.</span></span>  
  
 <span data-ttu-id="7ad44-113">Pour personnaliser des mappages de types à l'aide de SQLMetal ou du Concepteur OR, commencez par générer un fichier DBML.</span><span class="sxs-lookup"><span data-stu-id="7ad44-113">To customize type mappings with SQLMetal or O/R Designer, first generate a DBML file.</span></span> <span data-ttu-id="7ad44-114">Puis, avant de générer le fichier de code ou de mappage, modifiez ce fichier DBML de façon à identifier les mappages de types souhaités.</span><span class="sxs-lookup"><span data-stu-id="7ad44-114">Then, before generating the code file or mapping file, modify the DBML file to identify the desired type mappings.</span></span> <span data-ttu-id="7ad44-115">Si vous utilisez SQLMetal, vous devez modifier manuellement les attributs `Type` et `DbType` dans le fichier DBML pour personnaliser les mappages de types.</span><span class="sxs-lookup"><span data-stu-id="7ad44-115">With SQLMetal, you have to manually change the `Type` and `DbType` attributes in the DBML file to make your type mapping customizations.</span></span> <span data-ttu-id="7ad44-116">Si vous utilisez le Concepteur O/R, vous pouvez apporter vos modifications dans celui-ci.</span><span class="sxs-lookup"><span data-stu-id="7ad44-116">With O/R Designer, you can make your changes within the Designer.</span></span> <span data-ttu-id="7ad44-117">Pour plus d’informations sur l’utilisation du Concepteur O/R, consultez [LINQ to SQL Tools dans Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2).</span><span class="sxs-lookup"><span data-stu-id="7ad44-117">For more information about using the O/R Designer, see [LINQ to SQL Tools in Visual Studio](/visualstudio/data-tools/linq-to-sql-tools-in-visual-studio2).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="7ad44-118">Certains mappages de types peuvent entraîner des exceptions de dépassement de capacité ou de perte de données lors de la traduction à partir de la base de données ou vers celle-ci.</span><span class="sxs-lookup"><span data-stu-id="7ad44-118">Some type mappings may result in overflow or data loss exceptions while translating to or from the database.</span></span> <span data-ttu-id="7ad44-119">Examinez attentivement la matrice de comportement au moment de l’exécution du mappage de type dans le [mappage de type SQL-CLR](sql-clr-type-mapping.md) avant d’effectuer des personnalisations.</span><span class="sxs-lookup"><span data-stu-id="7ad44-119">Carefully review the Type Mapping Run-time Behavior Matrix in [SQL-CLR Type Mapping](sql-clr-type-mapping.md) before making any customizations.</span></span>  
  
 <span data-ttu-id="7ad44-120">Pour que SQLMetal ou le Concepteur O/R reconnaisse les personnalisations de mappage de type, vous devez vous assurer que ces outils incluent le chemin d'accès à votre fichier DBML personnalisé lorsque vous générez le fichier de code ou de mappage externe.</span><span class="sxs-lookup"><span data-stu-id="7ad44-120">In order for your type mapping customizations to be recognized by SQLMetal or O/R Designer, you need to make sure that these tools are supplied with the path to your custom DBML file when you generate your code file or external mapping file.</span></span> <span data-ttu-id="7ad44-121">Même si cela n'est pas requis dans le cadre de la personnalisation de mappage de type, nous vous recommandons de séparer systématiquement les informations de mappage de type du fichier de code et de générer le fichier de mappage externe supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="7ad44-121">Although not required for type mapping customization, it is recommended that you always separate your type mapping information from your code file and generate the additional external type mapping file.</span></span> <span data-ttu-id="7ad44-122">Cela offre une certaine souplesse en vous évitant d'avoir à recompiler le fichier de code.</span><span class="sxs-lookup"><span data-stu-id="7ad44-122">Doing so will leave some flexibility by not requiring that the code file be recompiled.</span></span>  
  
## <a name="incorporating-database-changes"></a><span data-ttu-id="7ad44-123">Intégration des modifications de base de données</span><span class="sxs-lookup"><span data-stu-id="7ad44-123">Incorporating Database Changes</span></span>  
 <span data-ttu-id="7ad44-124">En cas de modification de la base de données, vous devez mettre à jour le fichier DBML afin qu'il prenne ces modifications en compte.</span><span class="sxs-lookup"><span data-stu-id="7ad44-124">When your database changes, you will need to update your DBML file to reflect those changes.</span></span> <span data-ttu-id="7ad44-125">L'une des méthodes utilisées consiste à créer automatiquement un nouveau fichier DBML et à effectuer de nouveau les personnalisations de mappage de type.</span><span class="sxs-lookup"><span data-stu-id="7ad44-125">One way to do this is to automatically create a new DBML file and then re-do your type mapping customizations.</span></span> <span data-ttu-id="7ad44-126">Vous pouvez aussi comparer les différences entre le nouveau fichier DBML et le fichier DBML personnalisé, puis mettre ce dernier à jour manuellement afin de prendre en compte les modifications de base de données.</span><span class="sxs-lookup"><span data-stu-id="7ad44-126">Alternatively, you could compare the differences between your new DBML file and your customized DBML file and update your custom DBML file manually to reflect the database change.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7ad44-127">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7ad44-127">See also</span></span>

- [<span data-ttu-id="7ad44-128">Mappage de type SQL-CLR</span><span class="sxs-lookup"><span data-stu-id="7ad44-128">SQL-CLR Type Mapping</span></span>](sql-clr-type-mapping.md)
- [<span data-ttu-id="7ad44-129">Génération de code dans LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="7ad44-129">Code Generation in LINQ to SQL</span></span>](code-generation-in-linq-to-sql.md)

---
title: Configuration des paramètres et types de données de paramètre
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 537d8a2c-d40b-4000-83eb-bc1fcc93f707
ms.openlocfilehash: 638e8177060c489a7469f80adde68cb9ba266365
ms.sourcegitcommit: c4e9d05644c9cb89de5ce6002723de107ea2e2c4
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/19/2019
ms.locfileid: "65879968"
---
# <a name="configuring-parameters-and-parameter-data-types"></a><span data-ttu-id="30ef7-102">Configuration des paramètres et types de données de paramètre</span><span class="sxs-lookup"><span data-stu-id="30ef7-102">Configuring parameters and parameter data types</span></span>

<span data-ttu-id="30ef7-103">Les objets de commande utilisent des paramètres pour passer des valeurs à des instructions SQL ou à des procédures stockées, en fournissant la vérification et la validation des types.</span><span class="sxs-lookup"><span data-stu-id="30ef7-103">Command objects use parameters to pass values to SQL statements or stored procedures, providing type checking and validation.</span></span> <span data-ttu-id="30ef7-104">Contrairement au texte de la commande, l'entrée de paramètre est traitée comme une valeur littérale et non pas comme du code exécutable.</span><span class="sxs-lookup"><span data-stu-id="30ef7-104">Unlike command text, parameter input is treated as a literal value, not as executable code.</span></span> <span data-ttu-id="30ef7-105">Cela vous permet de vous protéger des attaques « par injection de code SQL », dans lesquelles un attaquant insère une commande qui compromet la sécurité sur le serveur dans une instruction SQL.</span><span class="sxs-lookup"><span data-stu-id="30ef7-105">This helps guard against "SQL injection" attacks, in which an attacker inserts a command that compromises security on the server into an SQL statement.</span></span>

<span data-ttu-id="30ef7-106">Les commandes paramétrées améliorent également les performances d'exécution des requêtes car elles permettent au serveur de base de données de faire correspondre la commande entrante avec un plan de requête mis en cache approprié.</span><span class="sxs-lookup"><span data-stu-id="30ef7-106">Parameterized commands can also improve query execution performance, because they help the database server accurately match the incoming command with a proper cached query plan.</span></span> <span data-ttu-id="30ef7-107">Pour plus d’informations, consultez [l’exécution de planifier la mise en cache et réutilisation](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) et [paramètres et la réutilisation du Plan d’exécution](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span><span class="sxs-lookup"><span data-stu-id="30ef7-107">For more information, see [Execution Plan Caching and Reuse](/sql/relational-databases/query-processing-architecture-guide#execution-plan-caching-and-reuse) and [Parameters and Execution Plan Reuse](/sql/relational-databases/query-processing-architecture-guide#PlanReuse).</span></span> <span data-ttu-id="30ef7-108">Outre les avantages relatifs à la sécurité et aux performances, les commandes paramétrées fournissent une méthode pratique d'organisation des valeurs passées à une source de données.</span><span class="sxs-lookup"><span data-stu-id="30ef7-108">In addition to the security and performance benefits, parameterized commands provide a convenient method for organizing values passed to a data source.</span></span>

<span data-ttu-id="30ef7-109">Un objet <xref:System.Data.Common.DbParameter> peut être créé à l'aide de son constructeur ou en l'ajoutant à la propriété <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> en appelant la méthode `Add` de la collection <xref:System.Data.Common.DbParameterCollection> .</span><span class="sxs-lookup"><span data-stu-id="30ef7-109">A <xref:System.Data.Common.DbParameter> object can be created by using its constructor, or by adding it to the <xref:System.Data.Common.DbCommand.DbParameterCollection%2A> by calling the `Add` method of the <xref:System.Data.Common.DbParameterCollection> collection.</span></span> <span data-ttu-id="30ef7-110">La méthode `Add` prendra comme entrée des arguments de constructeur ou un objet Parameter existant, selon le fournisseur de données.</span><span class="sxs-lookup"><span data-stu-id="30ef7-110">The `Add` method will take as input either constructor arguments or an existing parameter object, depending on the data provider.</span></span>

## <a name="supplying-the-parameterdirection-property"></a><span data-ttu-id="30ef7-111">En fournissant la propriété ParameterDirection</span><span class="sxs-lookup"><span data-stu-id="30ef7-111">Supplying the ParameterDirection property</span></span>

<span data-ttu-id="30ef7-112">Lorsque vous ajoutez des paramètres, vous devez fournir une propriété <xref:System.Data.ParameterDirection> pour les paramètres autres que les paramètres d'entrée.</span><span class="sxs-lookup"><span data-stu-id="30ef7-112">When adding parameters, you must supply a <xref:System.Data.ParameterDirection> property for parameters other than input parameters.</span></span> <span data-ttu-id="30ef7-113">Le tableau ci-dessous indique les valeurs `ParameterDirection` que vous pouvez utiliser avec l'énumération <xref:System.Data.ParameterDirection> .</span><span class="sxs-lookup"><span data-stu-id="30ef7-113">The following table shows the `ParameterDirection` values that you can use with the <xref:System.Data.ParameterDirection> enumeration.</span></span>

|<span data-ttu-id="30ef7-114">Nom de membre</span><span class="sxs-lookup"><span data-stu-id="30ef7-114">Member name</span></span>|<span data-ttu-id="30ef7-115">Description</span><span class="sxs-lookup"><span data-stu-id="30ef7-115">Description</span></span>|
|-----------------|-----------------|
|<xref:System.Data.ParameterDirection.Input>|<span data-ttu-id="30ef7-116">Le paramètre est un paramètre d'entrée.</span><span class="sxs-lookup"><span data-stu-id="30ef7-116">The parameter is an input parameter.</span></span> <span data-ttu-id="30ef7-117">Il s'agit de la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="30ef7-117">This is the default.</span></span>|
|<xref:System.Data.ParameterDirection.InputOutput>|<span data-ttu-id="30ef7-118">Le paramètre peut être à la fois un paramètre d'entrée et de sortie.</span><span class="sxs-lookup"><span data-stu-id="30ef7-118">The parameter can perform both input and output.</span></span>|
|<xref:System.Data.ParameterDirection.Output>|<span data-ttu-id="30ef7-119">Le paramètre est un paramètre de sortie.</span><span class="sxs-lookup"><span data-stu-id="30ef7-119">The parameter is an output parameter.</span></span>|
|<xref:System.Data.ParameterDirection.ReturnValue>|<span data-ttu-id="30ef7-120">Le paramètre représente une valeur de retour d'une opération telle qu'une procédure stockée, une fonction intégrée ou une fonction définie par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="30ef7-120">The parameter represents a return value from an operation such as a stored procedure, built-in function, or user-defined function.</span></span>|

## <a name="working-with-parameter-placeholders"></a><span data-ttu-id="30ef7-121">Utilisation des espaces réservés de paramètre</span><span class="sxs-lookup"><span data-stu-id="30ef7-121">Working with parameter placeholders</span></span>

<span data-ttu-id="30ef7-122">La syntaxe des espaces réservés des paramètres dépend de la source de données.</span><span class="sxs-lookup"><span data-stu-id="30ef7-122">The syntax for parameter placeholders depends on the data source.</span></span> <span data-ttu-id="30ef7-123">Les fournisseurs de données .NET Framework gèrent différemment la dénomination et la spécification des paramètres et des espaces réservés de paramètres.</span><span class="sxs-lookup"><span data-stu-id="30ef7-123">The .NET Framework data providers handle naming and specifying parameters and parameter placeholders differently.</span></span> <span data-ttu-id="30ef7-124">Cette syntaxe est personnalisée en fonction d'une source de données spécifique, comme le décrit le tableau ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="30ef7-124">This syntax is customized to a specific data source, as described in the following table.</span></span>

|<span data-ttu-id="30ef7-125">Fournisseur de données</span><span class="sxs-lookup"><span data-stu-id="30ef7-125">Data provider</span></span>|<span data-ttu-id="30ef7-126">Syntaxe d'attribution de noms aux paramètres</span><span class="sxs-lookup"><span data-stu-id="30ef7-126">Parameter naming syntax</span></span>|
|-------------------|-----------------------------|
|<xref:System.Data.SqlClient>|<span data-ttu-id="30ef7-127">Utilise des paramètres nommés au format `@`*nom_paramètre*.</span><span class="sxs-lookup"><span data-stu-id="30ef7-127">Uses named parameters in the format `@`*parametername*.</span></span>|
|<xref:System.Data.OleDb>|<span data-ttu-id="30ef7-128">Utilise des marqueurs de paramètres positionnels indiqués par un point d'interrogation (`?`).</span><span class="sxs-lookup"><span data-stu-id="30ef7-128">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.Odbc>|<span data-ttu-id="30ef7-129">Utilise des marqueurs de paramètres positionnels indiqués par un point d'interrogation (`?`).</span><span class="sxs-lookup"><span data-stu-id="30ef7-129">Uses positional parameter markers indicated by a question mark (`?`).</span></span>|
|<xref:System.Data.OracleClient>|<span data-ttu-id="30ef7-130">Utilise des paramètres nommés au format `:`*nom_paramètre* (ou *nom_paramètre*).</span><span class="sxs-lookup"><span data-stu-id="30ef7-130">Uses named parameters in the format `:`*parmname* (or *parmname*).</span></span>|

## <a name="specifying-parameter-data-types"></a><span data-ttu-id="30ef7-131">Spécification des types de données de paramètre</span><span class="sxs-lookup"><span data-stu-id="30ef7-131">Specifying parameter data types</span></span>

<span data-ttu-id="30ef7-132">Le type de données d’un paramètre est spécifique au fournisseur de données .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="30ef7-132">The data type of a parameter is specific to the .NET Framework data provider.</span></span> <span data-ttu-id="30ef7-133">Spécification du type convertit la valeur de la `Parameter` pour le type de fournisseur de données .NET Framework avant de passer la valeur à la source de données.</span><span class="sxs-lookup"><span data-stu-id="30ef7-133">Specifying the type converts the value of the `Parameter` to the .NET Framework data provider type before passing the value to the data source.</span></span> <span data-ttu-id="30ef7-134">Vous pouvez également spécifier le type d'un `Parameter` de façon générique en affectant à la propriété `DbType` de l'objet `Parameter` un <xref:System.Data.DbType>particulier.</span><span class="sxs-lookup"><span data-stu-id="30ef7-134">You may also specify the type of a `Parameter` in a generic manner by setting the `DbType` property of the `Parameter` object to a particular <xref:System.Data.DbType>.</span></span>

<span data-ttu-id="30ef7-135">Le type de fournisseur de données .NET Framework un `Parameter` objet est déduit du type .NET Framework de la `Value` de la `Parameter` objet, ou à partir de la `DbType` de la `Parameter` objet.</span><span class="sxs-lookup"><span data-stu-id="30ef7-135">The .NET Framework data provider type of a `Parameter` object is inferred from the .NET Framework type of the `Value` of the `Parameter` object, or from the `DbType` of the `Parameter` object.</span></span> <span data-ttu-id="30ef7-136">Le tableau suivant indique le type `Parameter` déduit en fonction de l'objet passé comme valeur `Parameter` ou du `DbType`spécifié.</span><span class="sxs-lookup"><span data-stu-id="30ef7-136">The following table shows the inferred `Parameter` type based on the object passed as the `Parameter` value or the specified `DbType`.</span></span>

|<span data-ttu-id="30ef7-137">Type .NET Framework</span><span class="sxs-lookup"><span data-stu-id="30ef7-137">.NET Framework type</span></span>|<span data-ttu-id="30ef7-138">DbType</span><span class="sxs-lookup"><span data-stu-id="30ef7-138">DbType</span></span>|<span data-ttu-id="30ef7-139">SqlDbType</span><span class="sxs-lookup"><span data-stu-id="30ef7-139">SqlDbType</span></span>|<span data-ttu-id="30ef7-140">OleDbType</span><span class="sxs-lookup"><span data-stu-id="30ef7-140">OleDbType</span></span>|<span data-ttu-id="30ef7-141">OdbcType</span><span class="sxs-lookup"><span data-stu-id="30ef7-141">OdbcType</span></span>|<span data-ttu-id="30ef7-142">OracleType</span><span class="sxs-lookup"><span data-stu-id="30ef7-142">OracleType</span></span>|
|-------------------------|------------|---------------|---------------|--------------|----------------|
|<xref:System.Boolean>|<span data-ttu-id="30ef7-143">Booléen</span><span class="sxs-lookup"><span data-stu-id="30ef7-143">Boolean</span></span>|<span data-ttu-id="30ef7-144">Bit</span><span class="sxs-lookup"><span data-stu-id="30ef7-144">Bit</span></span>|<span data-ttu-id="30ef7-145">Booléen</span><span class="sxs-lookup"><span data-stu-id="30ef7-145">Boolean</span></span>|<span data-ttu-id="30ef7-146">Bit</span><span class="sxs-lookup"><span data-stu-id="30ef7-146">Bit</span></span>|<span data-ttu-id="30ef7-147">Byte</span><span class="sxs-lookup"><span data-stu-id="30ef7-147">Byte</span></span>|
|<xref:System.Byte>|<span data-ttu-id="30ef7-148">Byte</span><span class="sxs-lookup"><span data-stu-id="30ef7-148">Byte</span></span>|<span data-ttu-id="30ef7-149">TinyInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-149">TinyInt</span></span>|<span data-ttu-id="30ef7-150">UnsignedTinyInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-150">UnsignedTinyInt</span></span>|<span data-ttu-id="30ef7-151">TinyInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-151">TinyInt</span></span>|<span data-ttu-id="30ef7-152">Byte</span><span class="sxs-lookup"><span data-stu-id="30ef7-152">Byte</span></span>|
|<span data-ttu-id="30ef7-153">byte[]</span><span class="sxs-lookup"><span data-stu-id="30ef7-153">byte[]</span></span>|<span data-ttu-id="30ef7-154">Binaire</span><span class="sxs-lookup"><span data-stu-id="30ef7-154">Binary</span></span>|<span data-ttu-id="30ef7-155">VarBinary.</span><span class="sxs-lookup"><span data-stu-id="30ef7-155">VarBinary.</span></span> <span data-ttu-id="30ef7-156">Cette conversion implicite échouera si le tableau d’octets est supérieur à la taille maximale d’un VarBinary, soit 8 000 octets. Pour des tableaux d’octets supérieurs à 8 000 octets, définissez explicitement le <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="30ef7-156">This implicit conversion will fail if the byte array is larger than the maximum size of a VarBinary, which is 8000 bytes.For byte arrays larger than 8000 bytes, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="30ef7-157">VarBinary</span><span class="sxs-lookup"><span data-stu-id="30ef7-157">VarBinary</span></span>|<span data-ttu-id="30ef7-158">Binaire</span><span class="sxs-lookup"><span data-stu-id="30ef7-158">Binary</span></span>|<span data-ttu-id="30ef7-159">Raw</span><span class="sxs-lookup"><span data-stu-id="30ef7-159">Raw</span></span>|
|<xref:System.Char>| |<span data-ttu-id="30ef7-160">La déduction de <xref:System.Data.SqlDbType> à partir de char n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="30ef7-160">Inferring a <xref:System.Data.SqlDbType> from char is not supported.</span></span>|<span data-ttu-id="30ef7-161">Char</span><span class="sxs-lookup"><span data-stu-id="30ef7-161">Char</span></span>|<span data-ttu-id="30ef7-162">Char</span><span class="sxs-lookup"><span data-stu-id="30ef7-162">Char</span></span>|<span data-ttu-id="30ef7-163">Byte</span><span class="sxs-lookup"><span data-stu-id="30ef7-163">Byte</span></span>|
|<xref:System.DateTime>|<span data-ttu-id="30ef7-164">DateTime</span><span class="sxs-lookup"><span data-stu-id="30ef7-164">DateTime</span></span>|<span data-ttu-id="30ef7-165">DateTime</span><span class="sxs-lookup"><span data-stu-id="30ef7-165">DateTime</span></span>|<span data-ttu-id="30ef7-166">DBTimeStamp</span><span class="sxs-lookup"><span data-stu-id="30ef7-166">DBTimeStamp</span></span>|<span data-ttu-id="30ef7-167">DateTime</span><span class="sxs-lookup"><span data-stu-id="30ef7-167">DateTime</span></span>|<span data-ttu-id="30ef7-168">DateTime</span><span class="sxs-lookup"><span data-stu-id="30ef7-168">DateTime</span></span>|
|<xref:System.DateTimeOffset>|<span data-ttu-id="30ef7-169">DateTimeOffset</span><span class="sxs-lookup"><span data-stu-id="30ef7-169">DateTimeOffset</span></span>|<span data-ttu-id="30ef7-170">DateTimeOffset dans SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="30ef7-170">DateTimeOffset in SQL Server 2008.</span></span> <span data-ttu-id="30ef7-171">La déduction de <xref:System.Data.SqlDbType> à partir de DateTimeOffset n'est pas prise en charge dans les versions de SQL Server antérieures à SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="30ef7-171">Inferring a <xref:System.Data.SqlDbType> from DateTimeOffset is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|||<span data-ttu-id="30ef7-172">DateTime</span><span class="sxs-lookup"><span data-stu-id="30ef7-172">DateTime</span></span>|
|<xref:System.Decimal>|<span data-ttu-id="30ef7-173">Decimal</span><span class="sxs-lookup"><span data-stu-id="30ef7-173">Decimal</span></span>|<span data-ttu-id="30ef7-174">Decimal</span><span class="sxs-lookup"><span data-stu-id="30ef7-174">Decimal</span></span>|<span data-ttu-id="30ef7-175">Decimal</span><span class="sxs-lookup"><span data-stu-id="30ef7-175">Decimal</span></span>|<span data-ttu-id="30ef7-176">Numérique</span><span class="sxs-lookup"><span data-stu-id="30ef7-176">Numeric</span></span>|<span data-ttu-id="30ef7-177">nombre</span><span class="sxs-lookup"><span data-stu-id="30ef7-177">Number</span></span>|
|<xref:System.Double>|<span data-ttu-id="30ef7-178">Double</span><span class="sxs-lookup"><span data-stu-id="30ef7-178">Double</span></span>|<span data-ttu-id="30ef7-179">Float</span><span class="sxs-lookup"><span data-stu-id="30ef7-179">Float</span></span>|<span data-ttu-id="30ef7-180">Double</span><span class="sxs-lookup"><span data-stu-id="30ef7-180">Double</span></span>|<span data-ttu-id="30ef7-181">Double</span><span class="sxs-lookup"><span data-stu-id="30ef7-181">Double</span></span>|<span data-ttu-id="30ef7-182">Double</span><span class="sxs-lookup"><span data-stu-id="30ef7-182">Double</span></span>|
|<xref:System.Single>|<span data-ttu-id="30ef7-183">Single</span><span class="sxs-lookup"><span data-stu-id="30ef7-183">Single</span></span>|<span data-ttu-id="30ef7-184">Real</span><span class="sxs-lookup"><span data-stu-id="30ef7-184">Real</span></span>|<span data-ttu-id="30ef7-185">Single</span><span class="sxs-lookup"><span data-stu-id="30ef7-185">Single</span></span>|<span data-ttu-id="30ef7-186">Real</span><span class="sxs-lookup"><span data-stu-id="30ef7-186">Real</span></span>|<span data-ttu-id="30ef7-187">Float</span><span class="sxs-lookup"><span data-stu-id="30ef7-187">Float</span></span>|
|<xref:System.Guid>|<span data-ttu-id="30ef7-188">GUID</span><span class="sxs-lookup"><span data-stu-id="30ef7-188">Guid</span></span>|<span data-ttu-id="30ef7-189">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="30ef7-189">UniqueIdentifier</span></span>|<span data-ttu-id="30ef7-190">GUID</span><span class="sxs-lookup"><span data-stu-id="30ef7-190">Guid</span></span>|<span data-ttu-id="30ef7-191">UniqueIdentifier</span><span class="sxs-lookup"><span data-stu-id="30ef7-191">UniqueIdentifier</span></span>|<span data-ttu-id="30ef7-192">Raw</span><span class="sxs-lookup"><span data-stu-id="30ef7-192">Raw</span></span>|
|<xref:System.Int16>|<span data-ttu-id="30ef7-193">Int16</span><span class="sxs-lookup"><span data-stu-id="30ef7-193">Int16</span></span>|<span data-ttu-id="30ef7-194">SmallInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-194">SmallInt</span></span>|<span data-ttu-id="30ef7-195">SmallInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-195">SmallInt</span></span>|<span data-ttu-id="30ef7-196">SmallInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-196">SmallInt</span></span>|<span data-ttu-id="30ef7-197">Int16</span><span class="sxs-lookup"><span data-stu-id="30ef7-197">Int16</span></span>|
|<xref:System.Int32>|<span data-ttu-id="30ef7-198">Int32</span><span class="sxs-lookup"><span data-stu-id="30ef7-198">Int32</span></span>|<span data-ttu-id="30ef7-199">Int</span><span class="sxs-lookup"><span data-stu-id="30ef7-199">Int</span></span>|<span data-ttu-id="30ef7-200">Int</span><span class="sxs-lookup"><span data-stu-id="30ef7-200">Int</span></span>|<span data-ttu-id="30ef7-201">Int</span><span class="sxs-lookup"><span data-stu-id="30ef7-201">Int</span></span>|<span data-ttu-id="30ef7-202">Int32</span><span class="sxs-lookup"><span data-stu-id="30ef7-202">Int32</span></span>|
|<xref:System.Int64>|<span data-ttu-id="30ef7-203">Int64</span><span class="sxs-lookup"><span data-stu-id="30ef7-203">Int64</span></span>|<span data-ttu-id="30ef7-204">BigInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-204">BigInt</span></span>|<span data-ttu-id="30ef7-205">BigInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-205">BigInt</span></span>|<span data-ttu-id="30ef7-206">BigInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-206">BigInt</span></span>|<span data-ttu-id="30ef7-207">Nombre</span><span class="sxs-lookup"><span data-stu-id="30ef7-207">Number</span></span>|
|<xref:System.Object>|<span data-ttu-id="30ef7-208">Object</span><span class="sxs-lookup"><span data-stu-id="30ef7-208">Object</span></span>|<span data-ttu-id="30ef7-209">Variante</span><span class="sxs-lookup"><span data-stu-id="30ef7-209">Variant</span></span>|<span data-ttu-id="30ef7-210">Variante</span><span class="sxs-lookup"><span data-stu-id="30ef7-210">Variant</span></span>|<span data-ttu-id="30ef7-211">La déduction d'OdbcType à partir d'Object n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="30ef7-211">Inferring an OdbcType from Object is not supported.</span></span>|<span data-ttu-id="30ef7-212">Blob</span><span class="sxs-lookup"><span data-stu-id="30ef7-212">Blob</span></span>|
|<xref:System.String>|<span data-ttu-id="30ef7-213">Chaîne</span><span class="sxs-lookup"><span data-stu-id="30ef7-213">String</span></span>|<span data-ttu-id="30ef7-214">NVarChar.</span><span class="sxs-lookup"><span data-stu-id="30ef7-214">NVarChar.</span></span> <span data-ttu-id="30ef7-215">Cette conversion implicite échouera si la chaîne est supérieure à la taille maximale de NVarChar, soit 4 000 caractères.</span><span class="sxs-lookup"><span data-stu-id="30ef7-215">This implicit conversion will fail if the string is larger than the maximum size of an NVarChar, which is 4000 characters.</span></span> <span data-ttu-id="30ef7-216">Pour les chaînes supérieures à 4 000 caractères, définissez explicitement <xref:System.Data.SqlDbType>.</span><span class="sxs-lookup"><span data-stu-id="30ef7-216">For strings larger than 4000 characters, explicitly set the <xref:System.Data.SqlDbType>.</span></span>|<span data-ttu-id="30ef7-217">VarWChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-217">VarWChar</span></span>|<span data-ttu-id="30ef7-218">NVarChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-218">NVarChar</span></span>|<span data-ttu-id="30ef7-219">NVarChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-219">NVarChar</span></span>|
|<xref:System.TimeSpan>|<span data-ttu-id="30ef7-220">réflexion</span><span class="sxs-lookup"><span data-stu-id="30ef7-220">Time</span></span>|<span data-ttu-id="30ef7-221">Time dans SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="30ef7-221">Time in SQL Server 2008.</span></span> <span data-ttu-id="30ef7-222">La déduction de <xref:System.Data.SqlDbType> à partir de TimeSpan n'est pas prise en charge dans les versions de SQL Server antérieures à SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="30ef7-222">Inferring a <xref:System.Data.SqlDbType> from TimeSpan is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="30ef7-223">DBTime</span><span class="sxs-lookup"><span data-stu-id="30ef7-223">DBTime</span></span>|<span data-ttu-id="30ef7-224">réflexion</span><span class="sxs-lookup"><span data-stu-id="30ef7-224">Time</span></span>|<span data-ttu-id="30ef7-225">DateTime</span><span class="sxs-lookup"><span data-stu-id="30ef7-225">DateTime</span></span>|
|<xref:System.UInt16>|<span data-ttu-id="30ef7-226">UInt16</span><span class="sxs-lookup"><span data-stu-id="30ef7-226">UInt16</span></span>|<span data-ttu-id="30ef7-227">La déduction de <xref:System.Data.SqlDbType> à partir de UInt16 n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="30ef7-227">Inferring a <xref:System.Data.SqlDbType> from UInt16 is not supported.</span></span>|<span data-ttu-id="30ef7-228">UnsignedSmallInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-228">UnsignedSmallInt</span></span>|<span data-ttu-id="30ef7-229">Int</span><span class="sxs-lookup"><span data-stu-id="30ef7-229">Int</span></span>|<span data-ttu-id="30ef7-230">UInt16</span><span class="sxs-lookup"><span data-stu-id="30ef7-230">UInt16</span></span>|
|<xref:System.UInt32>|<span data-ttu-id="30ef7-231">UInt32</span><span class="sxs-lookup"><span data-stu-id="30ef7-231">UInt32</span></span>|<span data-ttu-id="30ef7-232">La déduction de <xref:System.Data.SqlDbType> à partir de UInt32 n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="30ef7-232">Inferring a <xref:System.Data.SqlDbType> from UInt32 is not supported.</span></span>|<span data-ttu-id="30ef7-233">UnsignedInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-233">UnsignedInt</span></span>|<span data-ttu-id="30ef7-234">BigInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-234">BigInt</span></span>|<span data-ttu-id="30ef7-235">UInt32</span><span class="sxs-lookup"><span data-stu-id="30ef7-235">UInt32</span></span>|
|<xref:System.UInt64>|<span data-ttu-id="30ef7-236">UInt64</span><span class="sxs-lookup"><span data-stu-id="30ef7-236">UInt64</span></span>|<span data-ttu-id="30ef7-237">La déduction de <xref:System.Data.SqlDbType> à partir de UInt64 n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="30ef7-237">Inferring a <xref:System.Data.SqlDbType> from UInt64 is not supported.</span></span>|<span data-ttu-id="30ef7-238">UnsignedBigInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-238">UnsignedBigInt</span></span>|<span data-ttu-id="30ef7-239">Numérique</span><span class="sxs-lookup"><span data-stu-id="30ef7-239">Numeric</span></span>|<span data-ttu-id="30ef7-240">nombre</span><span class="sxs-lookup"><span data-stu-id="30ef7-240">Number</span></span>|
||<span data-ttu-id="30ef7-241">AnsiString</span><span class="sxs-lookup"><span data-stu-id="30ef7-241">AnsiString</span></span>|<span data-ttu-id="30ef7-242">VarChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-242">VarChar</span></span>|<span data-ttu-id="30ef7-243">VarChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-243">VarChar</span></span>|<span data-ttu-id="30ef7-244">VarChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-244">VarChar</span></span>|<span data-ttu-id="30ef7-245">VarChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-245">VarChar</span></span>|
||<span data-ttu-id="30ef7-246">AnsiStringFixedLength</span><span class="sxs-lookup"><span data-stu-id="30ef7-246">AnsiStringFixedLength</span></span>|<span data-ttu-id="30ef7-247">Char</span><span class="sxs-lookup"><span data-stu-id="30ef7-247">Char</span></span>|<span data-ttu-id="30ef7-248">Char</span><span class="sxs-lookup"><span data-stu-id="30ef7-248">Char</span></span>|<span data-ttu-id="30ef7-249">Char</span><span class="sxs-lookup"><span data-stu-id="30ef7-249">Char</span></span>|<span data-ttu-id="30ef7-250">Char</span><span class="sxs-lookup"><span data-stu-id="30ef7-250">Char</span></span>|
||<span data-ttu-id="30ef7-251">Devise</span><span class="sxs-lookup"><span data-stu-id="30ef7-251">Currency</span></span>|<span data-ttu-id="30ef7-252">Money</span><span class="sxs-lookup"><span data-stu-id="30ef7-252">Money</span></span>|<span data-ttu-id="30ef7-253">Devise</span><span class="sxs-lookup"><span data-stu-id="30ef7-253">Currency</span></span>|<span data-ttu-id="30ef7-254">La déduction d' `OdbcType` à partir de `Currency` n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="30ef7-254">Inferring an `OdbcType` from `Currency` is not supported.</span></span>|<span data-ttu-id="30ef7-255">nombre</span><span class="sxs-lookup"><span data-stu-id="30ef7-255">Number</span></span>|
||<span data-ttu-id="30ef7-256">Date</span><span class="sxs-lookup"><span data-stu-id="30ef7-256">Date</span></span>|<span data-ttu-id="30ef7-257">Date dans SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="30ef7-257">Date in SQL Server 2008.</span></span> <span data-ttu-id="30ef7-258">La déduction de <xref:System.Data.SqlDbType> à partir de Date n'est pas prise en charge dans les versions de SQL Server antérieures à SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="30ef7-258">Inferring a <xref:System.Data.SqlDbType> from Date is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="30ef7-259">DBDate</span><span class="sxs-lookup"><span data-stu-id="30ef7-259">DBDate</span></span>|<span data-ttu-id="30ef7-260">Date</span><span class="sxs-lookup"><span data-stu-id="30ef7-260">Date</span></span>|<span data-ttu-id="30ef7-261">DateTime</span><span class="sxs-lookup"><span data-stu-id="30ef7-261">DateTime</span></span>|
||<span data-ttu-id="30ef7-262">SByte</span><span class="sxs-lookup"><span data-stu-id="30ef7-262">SByte</span></span>|<span data-ttu-id="30ef7-263">La déduction de <xref:System.Data.SqlDbType> à partir de SByte n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="30ef7-263">Inferring a <xref:System.Data.SqlDbType> from SByte is not supported.</span></span>|<span data-ttu-id="30ef7-264">TinyInt</span><span class="sxs-lookup"><span data-stu-id="30ef7-264">TinyInt</span></span>|<span data-ttu-id="30ef7-265">La déduction de `OdbcType` à partir de SByte n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="30ef7-265">Inferring an `OdbcType` from SByte is not supported.</span></span>|<span data-ttu-id="30ef7-266">SByte</span><span class="sxs-lookup"><span data-stu-id="30ef7-266">SByte</span></span>|
||<span data-ttu-id="30ef7-267">StringFixedLength</span><span class="sxs-lookup"><span data-stu-id="30ef7-267">StringFixedLength</span></span>|<span data-ttu-id="30ef7-268">NChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-268">NChar</span></span>|<span data-ttu-id="30ef7-269">WChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-269">WChar</span></span>|<span data-ttu-id="30ef7-270">NChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-270">NChar</span></span>|<span data-ttu-id="30ef7-271">NChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-271">NChar</span></span>|
||<span data-ttu-id="30ef7-272">réflexion</span><span class="sxs-lookup"><span data-stu-id="30ef7-272">Time</span></span>|<span data-ttu-id="30ef7-273">Time dans SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="30ef7-273">Time in SQL Server 2008.</span></span> <span data-ttu-id="30ef7-274">La déduction de <xref:System.Data.SqlDbType> à partir de Time n'est pas prise en charge dans les versions de SQL Server antérieures à SQL Server 2008.</span><span class="sxs-lookup"><span data-stu-id="30ef7-274">Inferring a <xref:System.Data.SqlDbType> from Time is not supported in versions of SQL Server earlier than SQL Server 2008.</span></span>|<span data-ttu-id="30ef7-275">DBTime</span><span class="sxs-lookup"><span data-stu-id="30ef7-275">DBTime</span></span>|<span data-ttu-id="30ef7-276">réflexion</span><span class="sxs-lookup"><span data-stu-id="30ef7-276">Time</span></span>|<span data-ttu-id="30ef7-277">DateTime</span><span class="sxs-lookup"><span data-stu-id="30ef7-277">DateTime</span></span>|
||<span data-ttu-id="30ef7-278">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="30ef7-278">VarNumeric</span></span>|<span data-ttu-id="30ef7-279">La déduction de <xref:System.Data.SqlDbType> à partir de VarNumeric n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="30ef7-279">Inferring a <xref:System.Data.SqlDbType> from VarNumeric is not supported.</span></span>|<span data-ttu-id="30ef7-280">VarNumeric</span><span class="sxs-lookup"><span data-stu-id="30ef7-280">VarNumeric</span></span>|<span data-ttu-id="30ef7-281">La déduction de `OdbcType` à partir de VarNumeric n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="30ef7-281">Inferring an `OdbcType` from VarNumeric is not supported.</span></span>|<span data-ttu-id="30ef7-282">nombre</span><span class="sxs-lookup"><span data-stu-id="30ef7-282">Number</span></span>|
|<span data-ttu-id="30ef7-283">type défini par l'utilisateur (objet avec <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute>)</span><span class="sxs-lookup"><span data-stu-id="30ef7-283">user-defined type (an object with <xref:Microsoft.SqlServer.Server.SqlUserDefinedAggregateAttribute></span></span>|<span data-ttu-id="30ef7-284">Objet ou chaîne, selon le fournisseur (SqlClient retourne toujours un objet, ODBC retourne toujours une chaîne et le fournisseur de données managées OleDb l'un ou l'autre)</span><span class="sxs-lookup"><span data-stu-id="30ef7-284">Object or String, depending the provider (SqlClient always returns an Object, Odbc always returns a String, and the OleDb managed data provider can see either</span></span>|<span data-ttu-id="30ef7-285">SqlDbType.Udt si <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> est présent, sinon Variant</span><span class="sxs-lookup"><span data-stu-id="30ef7-285">SqlDbType.Udt if <xref:Microsoft.SqlServer.Server.SqlUserDefinedTypeAttribute> is present, otherwise Variant</span></span>|<span data-ttu-id="30ef7-286">OleDbType.VarWChar (si la valeur est Null), sinon OleDbType.Variant.</span><span class="sxs-lookup"><span data-stu-id="30ef7-286">OleDbType.VarWChar (if value is null) otherwise OleDbType.Variant.</span></span>|<span data-ttu-id="30ef7-287">OdbcType.NVarChar</span><span class="sxs-lookup"><span data-stu-id="30ef7-287">OdbcType.NVarChar</span></span>|<span data-ttu-id="30ef7-288">non pris en charge</span><span class="sxs-lookup"><span data-stu-id="30ef7-288">not supported</span></span>|

> [!NOTE]
> <span data-ttu-id="30ef7-289">Les conversions du type decimal vers d'autres types sont des conversions restrictives qui arrondissent la valeur décimale à la valeur entière la plus proche de zéro.</span><span class="sxs-lookup"><span data-stu-id="30ef7-289">Conversions from decimal to other types are narrowing conversions that round the decimal value to the nearest integer value toward zero.</span></span> <span data-ttu-id="30ef7-290">Si le résultat de la conversion ne peut pas être représenté dans le type de destination, un <xref:System.OverflowException> est levé.</span><span class="sxs-lookup"><span data-stu-id="30ef7-290">If the result of the conversion is not representable in the destination type, an <xref:System.OverflowException> is thrown.</span></span>

> [!NOTE]
> <span data-ttu-id="30ef7-291">Lorsque vous envoyez une valeur de paramètre null au serveur, vous devez spécifier <xref:System.DBNull>, et non `null` (`Nothing` en Visual Basic).</span><span class="sxs-lookup"><span data-stu-id="30ef7-291">When you send a null parameter value to the server, you must specify <xref:System.DBNull>, not `null` (`Nothing` in Visual Basic).</span></span> <span data-ttu-id="30ef7-292">Dans le système, la valeur null désigne un objet vide qui ne possède pas de valeur.</span><span class="sxs-lookup"><span data-stu-id="30ef7-292">The null value in the system is an empty object that has no value.</span></span> <span data-ttu-id="30ef7-293"><xref:System.DBNull> est utilisé pour représenter des valeurs null.</span><span class="sxs-lookup"><span data-stu-id="30ef7-293"><xref:System.DBNull> is used to represent null values.</span></span> <span data-ttu-id="30ef7-294">Pour plus d’informations sur les valeurs Null de base de données, consultez [Handling Null Values](./sql/handling-null-values.md).</span><span class="sxs-lookup"><span data-stu-id="30ef7-294">For more information about database nulls, see [Handling Null Values](./sql/handling-null-values.md).</span></span>

## <a name="deriving-parameter-information"></a><span data-ttu-id="30ef7-295">Dérivation des informations sur les paramètres</span><span class="sxs-lookup"><span data-stu-id="30ef7-295">Deriving parameter information</span></span>

<span data-ttu-id="30ef7-296">Les paramètres peuvent aussi être dérivés d'une procédure stockée à l'aide de la classe `DbCommandBuilder` .</span><span class="sxs-lookup"><span data-stu-id="30ef7-296">Parameters can also be derived from a stored procedure using the `DbCommandBuilder` class.</span></span> <span data-ttu-id="30ef7-297">Les classes `SqlCommandBuilder` et `OleDbCommandBuilder` fournissent une méthode statique, `DeriveParameters`, qui remplit automatiquement la collection de paramètres d'un objet Command qui utilise les informations sur les paramètres provenant d'une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="30ef7-297">Both the `SqlCommandBuilder` and `OleDbCommandBuilder` classes provide a static method, `DeriveParameters`, which automatically populates the parameters collection of a command object that uses parameter information from a stored procedure.</span></span> <span data-ttu-id="30ef7-298">Notez que `DeriveParameters` remplace toutes les informations existantes sur les paramètres pour la commande.</span><span class="sxs-lookup"><span data-stu-id="30ef7-298">Note that `DeriveParameters` overwrites any existing parameter information for the command.</span></span>

> [!NOTE]
> <span data-ttu-id="30ef7-299">La dérivation des informations de paramètre entraîne une baisse des performances car elle requiert un aller-retour supplémentaire vers la source de données pour extraire les informations.</span><span class="sxs-lookup"><span data-stu-id="30ef7-299">Deriving parameter information incurs a performance penalty because it requires an additional round trip to the data source to retrieve the information.</span></span> <span data-ttu-id="30ef7-300">Si les informations sur les paramètres sont connues au moment du design, vous pouvez améliorer la performance de votre application en définissant les paramètres de manière explicite.</span><span class="sxs-lookup"><span data-stu-id="30ef7-300">If parameter information is known at design time, you can improve the performance of your application by setting the parameters explicitly.</span></span>

<span data-ttu-id="30ef7-301">Pour plus d’informations, consultez [générant des commandes avec CommandBuilders](generating-commands-with-commandbuilders.md).</span><span class="sxs-lookup"><span data-stu-id="30ef7-301">For more information, see [Generating Commands with CommandBuilders](generating-commands-with-commandbuilders.md).</span></span>

## <a name="using-parameters-with-a-sqlcommand-and-a-stored-procedure"></a><span data-ttu-id="30ef7-302">Utilisation de paramètres avec un objet SqlCommand ou une procédure stockée</span><span class="sxs-lookup"><span data-stu-id="30ef7-302">Using parameters with a SqlCommand and a stored procedure</span></span>

<span data-ttu-id="30ef7-303">Les procédures stockées offrent de nombreux avantages dans les applications pilotées par des données.</span><span class="sxs-lookup"><span data-stu-id="30ef7-303">Stored procedures offer many advantages in data-driven applications.</span></span> <span data-ttu-id="30ef7-304">En utilisant les procédures stockées, les opérations de base de données peuvent être encapsulées dans une commande unique, optimisées pour de meilleures performances et améliorées grâce à une sécurité supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="30ef7-304">By using stored procedures, database operations can be encapsulated in a single command, optimized for best performance, and enhanced with additional security.</span></span> <span data-ttu-id="30ef7-305">Bien qu’une procédure stockée peut être appelée en passant le nom de procédure stockée suivi d’arguments de paramètre comme instruction SQL, à l’aide de la <xref:System.Data.Common.DbCommand.Parameters%2A> collection d’ADO.NET <xref:System.Data.Common.DbCommand> objet vous permet de définir plus explicitement de procédure stockée paramètres, ainsi que pour accéder aux paramètres de sortie et valeurs de retour.</span><span class="sxs-lookup"><span data-stu-id="30ef7-305">Although a stored procedure can be called by passing the stored procedure name followed by parameter arguments as an SQL statement, by using the <xref:System.Data.Common.DbCommand.Parameters%2A> collection of the ADO.NET <xref:System.Data.Common.DbCommand> object enables you to more explicitly define stored procedure parameters, and to access output parameters and return values.</span></span>

> [!NOTE]
> <span data-ttu-id="30ef7-306">Les instructions paramétrées sont exécutées sur le serveur à l'aide de `sp_executesql,` , ce qui permet la réutilisation des plans de requête.</span><span class="sxs-lookup"><span data-stu-id="30ef7-306">Parameterized statements are executed on the server by using `sp_executesql,` which allows for query plan reuse.</span></span> <span data-ttu-id="30ef7-307">Les curseurs ou variables locaux dans le lot `sp_executesql` ne sont pas visibles pour le lot qui appelle `sp_executesql`.</span><span class="sxs-lookup"><span data-stu-id="30ef7-307">Local cursors or variables in the `sp_executesql` batch are not visible to the batch that calls `sp_executesql`.</span></span> <span data-ttu-id="30ef7-308">Les modifications dans le contexte de la base de données durent uniquement jusqu'à la fin de l'instruction `sp_executesql` .</span><span class="sxs-lookup"><span data-stu-id="30ef7-308">Changes in database context last only to the end of the `sp_executesql` statement.</span></span> <span data-ttu-id="30ef7-309">Pour plus d’informations, consultez [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span><span class="sxs-lookup"><span data-stu-id="30ef7-309">For more information, see [sp_executesql (Transact-SQL)](/sql/relational-databases/system-stored-procedures/sp-executesql-transact-sql).</span></span>

<span data-ttu-id="30ef7-310">Lorsque vous utilisez des paramètres avec un objet <xref:System.Data.SqlClient.SqlCommand> pour exécuter une procédure stockée SQL Server, les noms des paramètres ajoutés à la collection <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> doivent correspondre à ceux des marqueurs de paramètres dans la procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="30ef7-310">When using parameters with a <xref:System.Data.SqlClient.SqlCommand> to execute a SQL Server stored procedure, the names of the parameters added to the <xref:System.Data.SqlClient.SqlCommand.Parameters%2A> collection must match the names of the parameter markers in the stored procedure.</span></span> <span data-ttu-id="30ef7-311">Le fournisseur de données .NET Framework pour SQL Server ne prend pas en charge l’espace réservé de point d’interrogation ( ?) pour passer des paramètres à une instruction SQL ou une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="30ef7-311">The .NET Framework Data Provider for SQL Server does not support the question mark (?) placeholder for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="30ef7-312">Il traite les paramètres de la procédure stockée comme des paramètres nommés et recherche les marqueurs de paramètres correspondants.</span><span class="sxs-lookup"><span data-stu-id="30ef7-312">It treats parameters in the stored procedure as named parameters and searches for matching parameter markers.</span></span> <span data-ttu-id="30ef7-313">Par exemple, la procédure stockée `CustOrderHist` est définie à l'aide d'un paramètre nommé `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="30ef7-313">For example, the `CustOrderHist` stored procedure is defined by using a parameter named `@CustomerID`.</span></span> <span data-ttu-id="30ef7-314">Lorsque votre code exécute la procédure stockée, il doit également utiliser un paramètre nommé `@CustomerID`.</span><span class="sxs-lookup"><span data-stu-id="30ef7-314">When your code executes the stored procedure, it must also use a parameter named `@CustomerID`.</span></span>

```sql
CREATE PROCEDURE dbo.CustOrderHist @CustomerID varchar(5)
```

### <a name="example"></a><span data-ttu-id="30ef7-315">Exemple</span><span class="sxs-lookup"><span data-stu-id="30ef7-315">Example</span></span>

<span data-ttu-id="30ef7-316">Cet exemple montre comment appeler une procédure stockée SQL Server dans l'exemple de base de données `Northwind` .</span><span class="sxs-lookup"><span data-stu-id="30ef7-316">This example demonstrates how to call a SQL Server stored procedure in the `Northwind` sample database.</span></span> <span data-ttu-id="30ef7-317">Le nom de la procédure stockée est `dbo.SalesByCategory` et il possède un paramètre d'entrée nommé `@CategoryName` avec un type de données `nvarchar(15)`.</span><span class="sxs-lookup"><span data-stu-id="30ef7-317">The name of the stored procedure is `dbo.SalesByCategory` and it has an input parameter named `@CategoryName` with a data type of `nvarchar(15)`.</span></span> <span data-ttu-id="30ef7-318">Le code crée un nouveau <xref:System.Data.SqlClient.SqlConnection> à l'intérieur d'un bloc using pour que la connexion soit libérée une fois la procédure terminée.</span><span class="sxs-lookup"><span data-stu-id="30ef7-318">The code creates a new <xref:System.Data.SqlClient.SqlConnection> inside a using block so that the connection is disposed when the procedure ends.</span></span> <span data-ttu-id="30ef7-319">Les objets <xref:System.Data.SqlClient.SqlCommand> et <xref:System.Data.SqlClient.SqlParameter> sont créés et leurs propriétés sont définies.</span><span class="sxs-lookup"><span data-stu-id="30ef7-319">The <xref:System.Data.SqlClient.SqlCommand> and <xref:System.Data.SqlClient.SqlParameter> objects are created, and their properties set.</span></span> <span data-ttu-id="30ef7-320">Un <xref:System.Data.SqlClient.SqlDataReader> exécute `SqlCommand` et retourne le jeu de résultats provenant de la procédure stockée, en affichant la sortie dans la fenêtre de console.</span><span class="sxs-lookup"><span data-stu-id="30ef7-320">A <xref:System.Data.SqlClient.SqlDataReader> executes the `SqlCommand` and returns the result set from the stored procedure, displaying the output in the console window.</span></span>

> [!NOTE]
> <span data-ttu-id="30ef7-321">Au lieu de créer les objets `SqlCommand` et `SqlParameter` puis de définir les propriétés dans des instructions distinctes, vous pouvez choisir d'utiliser l'un des constructeurs surchargés pour définir plusieurs propriétés dans une instruction unique.</span><span class="sxs-lookup"><span data-stu-id="30ef7-321">Instead of creating `SqlCommand` and `SqlParameter` objects and then setting properties in separate statements, you can instead elect to use one of the overloaded constructors to set multiple properties in a single statement.</span></span>

[!code-csharp[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/CS/source.cs#1)]
[!code-vb[DataWorks SqlClient.StoredProcedure#1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DataWorks SqlClient.StoredProcedure/VB/source.vb#1)]

## <a name="using-parameters-with-an-oledbcommand-or-odbccommand"></a><span data-ttu-id="30ef7-322">Utilisation de paramètres avec OleDbCommand ou OdbcCommand</span><span class="sxs-lookup"><span data-stu-id="30ef7-322">Using parameters with an OleDbCommand or OdbcCommand</span></span>

<span data-ttu-id="30ef7-323">Lorsque vous utilisez des paramètres avec un objet <xref:System.Data.OleDb.OleDbCommand> ou <xref:System.Data.Odbc.OdbcCommand>, l'ordre des paramètres ajoutés à la collection `Parameters` doit correspondre à celui des paramètres définis dans votre procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="30ef7-323">When using parameters with an <xref:System.Data.OleDb.OleDbCommand> or <xref:System.Data.Odbc.OdbcCommand>, the order of the parameters added to the `Parameters` collection must match the order of the parameters defined in your stored procedure.</span></span> <span data-ttu-id="30ef7-324">Le fournisseur de données .NET Framework pour OLE DB et le fournisseur de données .NET Framework pour ODBC traitent les paramètres d’une procédure stockée en tant qu’espaces réservés et appliquent des valeurs de paramètre dans l’ordre.</span><span class="sxs-lookup"><span data-stu-id="30ef7-324">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC treat parameters in a stored procedure as placeholders and apply parameter values in order.</span></span> <span data-ttu-id="30ef7-325">En outre, les paramètres des valeurs de retour doivent être les premiers paramètres ajoutés à la collection `Parameters` .</span><span class="sxs-lookup"><span data-stu-id="30ef7-325">In addition, return value parameters must be the first parameters added to the `Parameters` collection.</span></span>

<span data-ttu-id="30ef7-326">Le fournisseur de données .NET Framework pour OLE DB et le fournisseur de données .NET Framework pour ODBC ne gèrent pas les paramètres nommés pour passer des paramètres à une instruction SQL ou une procédure stockée.</span><span class="sxs-lookup"><span data-stu-id="30ef7-326">The .NET Framework Data Provider for OLE DB and .NET Framework Data Provider for ODBC do not support named parameters for passing parameters to an SQL statement or a stored procedure.</span></span> <span data-ttu-id="30ef7-327">Dans ce cas, vous devez utiliser l'espace réservé de point d'interrogation (?), comme dans l'exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="30ef7-327">In this case, you must use the question mark (?) placeholder, as in the following example.</span></span>

```sql
SELECT * FROM Customers WHERE CustomerID = ?
```

<span data-ttu-id="30ef7-328">En conséquence, l'ordre dans lequel les objets `Parameter` sont ajoutés à la collection `Parameters` doit directement correspondre à la position de l'espace réservé ?</span><span class="sxs-lookup"><span data-stu-id="30ef7-328">As a result, the order in which `Parameter` objects are added to the `Parameters` collection must directly correspond to the position of the ?</span></span> <span data-ttu-id="30ef7-329">pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="30ef7-329">placeholder for the parameter.</span></span>

### <a name="oledb-example"></a><span data-ttu-id="30ef7-330">Exemple OleDb</span><span class="sxs-lookup"><span data-stu-id="30ef7-330">OleDb Example</span></span>

```vb
Dim command As OleDbCommand = New OleDbCommand( _
  "SampleProc", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OleDbParameter = command.Parameters.Add( _
  "RETURN_VALUE", OleDbType.Integer)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OleDbType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OleDbType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OleDbCommand command = new OleDbCommand("SampleProc", connection);
command.CommandType = CommandType.StoredProcedure;

OleDbParameter parameter = command.Parameters.Add(
  "RETURN_VALUE", OleDbType.Integer);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add(
  "@InputParm", OleDbType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add(
  "@OutputParm", OleDbType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="odbc-example"></a><span data-ttu-id="30ef7-331">Exemple Odbc</span><span class="sxs-lookup"><span data-stu-id="30ef7-331">Odbc Example</span></span>

```vb
Dim command As OdbcCommand = New OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection)
command.CommandType = CommandType.StoredProcedure

Dim parameter As OdbcParameter = command.Parameters.Add("RETURN_VALUE", OdbcType.Int)
parameter.Direction = ParameterDirection.ReturnValue

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12)
parameter.Value = "Sample Value"

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28)
parameter.Direction = ParameterDirection.Output
```

```csharp
OdbcCommand command = new OdbcCommand( _
  "{ ? = CALL SampleProc(?, ?) }", connection);
command.CommandType = CommandType.StoredProcedure;

OdbcParameter parameter = command.Parameters.Add( _
  "RETURN_VALUE", OdbcType.Int);
parameter.Direction = ParameterDirection.ReturnValue;

parameter = command.Parameters.Add( _
  "@InputParm", OdbcType.VarChar, 12);
parameter.Value = "Sample Value";

parameter = command.Parameters.Add( _
  "@OutputParm", OdbcType.VarChar, 28);
parameter.Direction = ParameterDirection.Output;
```

## <a name="see-also"></a><span data-ttu-id="30ef7-332">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="30ef7-332">See also</span></span>

- [<span data-ttu-id="30ef7-333">Commandes et paramètres</span><span class="sxs-lookup"><span data-stu-id="30ef7-333">Commands and Parameters</span></span>](commands-and-parameters.md)
- [<span data-ttu-id="30ef7-334">Paramètres DataAdapter</span><span class="sxs-lookup"><span data-stu-id="30ef7-334">DataAdapter Parameters</span></span>](dataadapter-parameters.md)
- [<span data-ttu-id="30ef7-335">Mappages de types de données dans ADO.NET</span><span class="sxs-lookup"><span data-stu-id="30ef7-335">Data Type Mappings in ADO.NET</span></span>](data-type-mappings-in-ado-net.md)
- [<span data-ttu-id="30ef7-336">Vue d’ensemble d’ADO.NET</span><span class="sxs-lookup"><span data-stu-id="30ef7-336">ADO.NET Overview</span></span>](ado-net-overview.md)

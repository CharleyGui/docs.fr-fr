---
title: Requêtes dans LINQ to DataSet
description: Apprenez à composer des requêtes dans LINQ to DataSet en obtenant la ou les sources de données, en créant la requête et en exécutant la requête.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: c1a78fa8-9f0c-40bc-a372-5575a48708fe
ms.openlocfilehash: 829e7dce4801508a8311f7bcbfeccbc36184cffc
ms.sourcegitcommit: 33deec3e814238fb18a49b2a7e89278e27888291
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/02/2020
ms.locfileid: "84286635"
---
# <a name="queries-in-linq-to-dataset"></a><span data-ttu-id="9dcff-103">Requêtes dans LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="9dcff-103">Queries in LINQ to DataSet</span></span>
<span data-ttu-id="9dcff-104">Une requête est une expression qui récupère des données d'une source de données.</span><span class="sxs-lookup"><span data-stu-id="9dcff-104">A query is an expression that retrieves data from a data source.</span></span> <span data-ttu-id="9dcff-105">En général, les requêtes sont exprimées dans un langage de requête spécialisé, tel que SQL pour les bases de données relationnelles et Xquery pour XML.</span><span class="sxs-lookup"><span data-stu-id="9dcff-105">Queries are usually expressed in a specialized query language, such as SQL for relational databases and XQuery for XML.</span></span> <span data-ttu-id="9dcff-106">Par conséquent, les développeurs ont dû apprendre un nouveau langage de requête pour chaque type de source de données ou format de données qu'ils interrogent.</span><span class="sxs-lookup"><span data-stu-id="9dcff-106">Therefore, developers have had to learn a new query language for each type of data source or data format that they query.</span></span> <span data-ttu-id="9dcff-107">LINQ (Language-Integrated Query) propose un modèle cohérent plus simple qui permet d'utiliser des données de types de sources et de formats divers.</span><span class="sxs-lookup"><span data-stu-id="9dcff-107">Language-Integrated Query (LINQ) offers a simpler, consistent model for working with data across various kinds of data sources and formats.</span></span> <span data-ttu-id="9dcff-108">Dans une requête LINQ, vous travaillez toujours avec des objets de programmation.</span><span class="sxs-lookup"><span data-stu-id="9dcff-108">In a LINQ query, you always work with programming objects.</span></span>  
  
 <span data-ttu-id="9dcff-109">Une opération de requête LINQ se compose de trois actions : obtenir la ou les sources de données, créer la requête, puis exécuter cette dernière.</span><span class="sxs-lookup"><span data-stu-id="9dcff-109">A LINQ query operation consists of three actions: obtain the data source or sources, create the query, and execute the query.</span></span>  
  
 <span data-ttu-id="9dcff-110">Les sources de données qui implémentent l' <xref:System.Collections.Generic.IEnumerable%601> interface générique peuvent être interrogées à l’aide de Linq.</span><span class="sxs-lookup"><span data-stu-id="9dcff-110">Data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> generic interface can be queried through LINQ.</span></span> <span data-ttu-id="9dcff-111"><xref:System.Data.DataTableExtensions.AsEnumerable%2A>L’appel de sur un <xref:System.Data.DataTable> retourne un objet qui implémente l' <xref:System.Collections.Generic.IEnumerable%601> interface générique, qui sert de source de données pour les requêtes de LINQ to DataSet.</span><span class="sxs-lookup"><span data-stu-id="9dcff-111">Calling <xref:System.Data.DataTableExtensions.AsEnumerable%2A> on a <xref:System.Data.DataTable> returns an object which implements the generic <xref:System.Collections.Generic.IEnumerable%601> interface, which serves as the data source for LINQ to DataSet queries.</span></span>  
  
 <span data-ttu-id="9dcff-112">Dans la requête, vous spécifiez exactement les informations que vous voulez récupérer à partir de la source de données.</span><span class="sxs-lookup"><span data-stu-id="9dcff-112">In the query, you specify exactly the information that you want to retrieve from the data source.</span></span> <span data-ttu-id="9dcff-113">Une requête peut également spécifier la manière dont ces informations doivent être triées, regroupées et mises en forme avant d'être retournées.</span><span class="sxs-lookup"><span data-stu-id="9dcff-113">A query can also specify how that information should be sorted, grouped, and shaped before it is returned.</span></span> <span data-ttu-id="9dcff-114">Dans LINQ, une requête est stockée dans une variable.</span><span class="sxs-lookup"><span data-stu-id="9dcff-114">In LINQ, a query is stored in a variable.</span></span> <span data-ttu-id="9dcff-115">Si la requête est conçue pour retourner une séquence de valeurs, la variable de requête doit elle-même être de type dénombrable.</span><span class="sxs-lookup"><span data-stu-id="9dcff-115">If the query is designed to return a sequence of values, the query variable itself must be a enumerable type.</span></span> <span data-ttu-id="9dcff-116">Cette variable de requête n'effectue aucune action et ne retourne aucune donnée ; elle stocke uniquement les informations de requête.</span><span class="sxs-lookup"><span data-stu-id="9dcff-116">This query variable takes no action and returns no data; it only stores the query information.</span></span> <span data-ttu-id="9dcff-117">Une fois que vous avez créé une requête, vous devez l'exécuter pour extraire des données.</span><span class="sxs-lookup"><span data-stu-id="9dcff-117">After you create a query you must execute that query to retrieve any data.</span></span>  
  
 <span data-ttu-id="9dcff-118">Dans une requête qui retourne une séquence, la variable de requête elle-même ne contient jamais les résultats de la requête et stocke uniquement les commandes de requête.</span><span class="sxs-lookup"><span data-stu-id="9dcff-118">In a query that returns a sequence of values, the query variable itself never holds the query results and only stores the query commands.</span></span> <span data-ttu-id="9dcff-119">L'exécution de la requête est différée jusqu'à ce que la variable de requête soit itérée au sein d'une boucle `foreach` ou `For Each`.</span><span class="sxs-lookup"><span data-stu-id="9dcff-119">Execution of the query is deferred until the query variable is iterated over in a `foreach` or `For Each` loop.</span></span> <span data-ttu-id="9dcff-120">C’est ce que l’on appelle *l’exécution différée*; autrement dit, l’exécution de la requête a lieu un certain temps après la construction de la requête.</span><span class="sxs-lookup"><span data-stu-id="9dcff-120">This is called *deferred execution*; that is, query execution occurs some time after the query is constructed.</span></span> <span data-ttu-id="9dcff-121">Vous pouvez ainsi exécuter une requête aussi souvent que vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="9dcff-121">This means that you can execute a query as often as you want to.</span></span> <span data-ttu-id="9dcff-122">Cela est utile lorsque, par exemple, l'une de vos bases de données est en cours de mise à jour par d'autres applications.</span><span class="sxs-lookup"><span data-stu-id="9dcff-122">This is useful when, for example, you have a database that is being updated by other applications.</span></span> <span data-ttu-id="9dcff-123">Dans votre application, vous pouvez créer une requête pour récupérer les informations les plus récentes et l'exécuter à plusieurs reprises, pour retourner chaque fois les informations à jour.</span><span class="sxs-lookup"><span data-stu-id="9dcff-123">In your application, you can create a query to retrieve the latest information and repeatedly execute the query, returning the updated information every time.</span></span>  
  
 <span data-ttu-id="9dcff-124">Contrairement aux requêtes différées qui retournent une séquence de valeurs, les requêtes qui retournent une valeur singleton sont exécutées immédiatement.</span><span class="sxs-lookup"><span data-stu-id="9dcff-124">In contrast to deferred queries, which return a sequence of values, queries that return a singleton value are executed immediately.</span></span> <span data-ttu-id="9dcff-125">Les requêtes <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Average%2A> et <xref:System.Linq.Enumerable.First%2A> en sont quelques exemples.</span><span class="sxs-lookup"><span data-stu-id="9dcff-125">Some examples of singleton queries are <xref:System.Linq.Enumerable.Count%2A>, <xref:System.Linq.Enumerable.Max%2A>, <xref:System.Linq.Enumerable.Average%2A>, and <xref:System.Linq.Enumerable.First%2A>.</span></span> <span data-ttu-id="9dcff-126">Elles s'exécutent immédiatement parce que les résultats de la requête sont nécessaires pour calculer le résultat singleton.</span><span class="sxs-lookup"><span data-stu-id="9dcff-126">These execute immediately because the query results are required to calculate the singleton result.</span></span> <span data-ttu-id="9dcff-127">Par exemple, pour trouver la moyenne des résultats, la requête doit être exécutée pour que la fonction de moyenne dispose de données sur lesquelles effectuer ses calculs.</span><span class="sxs-lookup"><span data-stu-id="9dcff-127">For example, in order to find the average of the query results the query must be executed so that the averaging function has input data to work with.</span></span> <span data-ttu-id="9dcff-128">Vous pouvez également utiliser les méthodes <xref:System.Linq.Enumerable.ToList%2A> ou <xref:System.Linq.Enumerable.ToArray%2A> sur une requête pour forcer l'exécution immédiate d'une requête qui ne produit pas de valeur singleton.</span><span class="sxs-lookup"><span data-stu-id="9dcff-128">You can also use the <xref:System.Linq.Enumerable.ToList%2A> or <xref:System.Linq.Enumerable.ToArray%2A> methods on a query to force immediate execution of a query that does not produce a singleton value.</span></span> <span data-ttu-id="9dcff-129">Ces techniques peuvent être utiles lorsque vous souhaitez mettre en cache les résultats d'une requête.</span><span class="sxs-lookup"><span data-stu-id="9dcff-129">These techniques to force immediate execution can be useful when you want to cache the results of a query.</span></span>
  
## <a name="queries"></a><span data-ttu-id="9dcff-130">Requêtes</span><span class="sxs-lookup"><span data-stu-id="9dcff-130">Queries</span></span>  
 <span data-ttu-id="9dcff-131">LINQ to DataSet requêtes peuvent être formulées dans deux syntaxes différentes : la syntaxe d’expression de requête et la syntaxe de requête fondée sur une méthode.</span><span class="sxs-lookup"><span data-stu-id="9dcff-131">LINQ to DataSet queries can be formulated in two different syntaxes: query expression syntax and method-based query syntax.</span></span>  
  
### <a name="query-expression-syntax"></a><span data-ttu-id="9dcff-132">Syntaxe d’expression de requête</span><span class="sxs-lookup"><span data-stu-id="9dcff-132">Query Expression Syntax</span></span>  
 <span data-ttu-id="9dcff-133">Les expressions de requête utilisent une syntaxe de requête déclarative.</span><span class="sxs-lookup"><span data-stu-id="9dcff-133">Query expressions are a declarative query syntax.</span></span> <span data-ttu-id="9dcff-134">Cette syntaxe permet au développeur d'écrire des requêtes en C# ou Visual Basic dans un format similaire à SQL.</span><span class="sxs-lookup"><span data-stu-id="9dcff-134">This syntax enables a developer to write queries in C# or Visual Basic in a format similar to SQL.</span></span> <span data-ttu-id="9dcff-135">En utilisant la syntaxe d'expression de requête, vous pouvez même effectuer des opérations de filtrage, de classement et de regroupement complexes sur des sources de données avec un minimum de code.</span><span class="sxs-lookup"><span data-stu-id="9dcff-135">By using query expression syntax, you can perform even complex filtering, ordering, and grouping operations on data sources with minimal code.</span></span> <span data-ttu-id="9dcff-136">Pour plus d’informations, consultez [expressions de requête LINQ](../../../csharp/linq/index.md#query-expression-overview) et [opérations de requête de base (Visual Basic)](../../../visual-basic/programming-guide/concepts/linq/basic-query-operations.md).</span><span class="sxs-lookup"><span data-stu-id="9dcff-136">For more information, see [LINQ Query Expressions](../../../csharp/linq/index.md#query-expression-overview) and [Basic Query Operations (Visual Basic)](../../../visual-basic/programming-guide/concepts/linq/basic-query-operations.md).</span></span>
  
 <span data-ttu-id="9dcff-137">Le .NET Framework common language runtime (CLR) ne peut pas lire la syntaxe de l’expression de requête proprement dite.</span><span class="sxs-lookup"><span data-stu-id="9dcff-137">The .NET Framework common language runtime (CLR) cannot read the query expression syntax itself.</span></span> <span data-ttu-id="9dcff-138">Par conséquent, au moment de la compilation, les expressions de requête sont traduites en appels de méthodes pour que le CLR puisse les comprendre.</span><span class="sxs-lookup"><span data-stu-id="9dcff-138">Therefore, at compile time, query expressions are translated to something that the CLR does understand: method calls.</span></span> <span data-ttu-id="9dcff-139">Ces méthodes sont appelées opérateurs de *requête standard*.</span><span class="sxs-lookup"><span data-stu-id="9dcff-139">These methods are referred to as the *standard query operators*.</span></span> <span data-ttu-id="9dcff-140">En tant que développeur, vous pouvez les appeler directement en utilisant la syntaxe de méthode plutôt que la syntaxe de requête.</span><span class="sxs-lookup"><span data-stu-id="9dcff-140">As a developer, you have the option of calling them directly by using method syntax, instead of using query syntax.</span></span> <span data-ttu-id="9dcff-141">Pour plus d’informations, consultez [Syntaxe de requête et syntaxe de méthode dans LINQ](../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md).</span><span class="sxs-lookup"><span data-stu-id="9dcff-141">For more information, see [Query Syntax and Method Syntax in LINQ](../../../csharp/programming-guide/concepts/linq/query-syntax-and-method-syntax-in-linq.md).</span></span> <span data-ttu-id="9dcff-142">Pour plus d’informations sur les opérateurs de requête standard, consultez [vue d’ensemble des opérateurs de requête standard](../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md).</span><span class="sxs-lookup"><span data-stu-id="9dcff-142">For more information about the standard query operators, see [Standard Query Operators Overview](../../../csharp/programming-guide/concepts/linq/standard-query-operators-overview.md).</span></span>  
  
 <span data-ttu-id="9dcff-143">L'exemple ci-dessous utilise <xref:System.Linq.Enumerable.Select%2A> pour retourner toutes les lignes de la table `Product` et afficher les noms de produits.</span><span class="sxs-lookup"><span data-stu-id="9dcff-143">The following example uses <xref:System.Linq.Enumerable.Select%2A> to return all the rows from `Product` table and display the product names.</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#SelectSimple1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#selectsimple1)]
 [!code-vb[DP LINQ to DataSet Examples#SelectSimple1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#selectsimple1)]  
  
### <a name="method-based-query-syntax"></a><span data-ttu-id="9dcff-144">Syntaxe de requête fondée sur une méthode</span><span class="sxs-lookup"><span data-stu-id="9dcff-144">Method-Based Query Syntax</span></span>  
 <span data-ttu-id="9dcff-145">L’autre façon de formuler des requêtes de LINQ to DataSet consiste à utiliser des requêtes basées sur une méthode.</span><span class="sxs-lookup"><span data-stu-id="9dcff-145">The other way to formulate LINQ to DataSet queries is by using method-based queries.</span></span> <span data-ttu-id="9dcff-146">La syntaxe de requête fondée sur une méthode est une séquence d'appels directs de méthodes d'opérateur LINQ passant des expressions lambda comme paramètres.</span><span class="sxs-lookup"><span data-stu-id="9dcff-146">The method-based query syntax is a sequence of direct method calls to LINQ operator methods, passing lambda expressions as the parameters.</span></span> <span data-ttu-id="9dcff-147">Pour plus d’informations, consultez [expressions lambda](../../../csharp/programming-guide/statements-expressions-operators/lambda-expressions.md).</span><span class="sxs-lookup"><span data-stu-id="9dcff-147">For more information, see [Lambda Expressions](../../../csharp/programming-guide/statements-expressions-operators/lambda-expressions.md).</span></span>  
  
 <span data-ttu-id="9dcff-148">Cet exemple utilise <xref:System.Linq.Enumerable.Select%2A> pour retourner toutes les lignes de `Product` et afficher les noms de produits.</span><span class="sxs-lookup"><span data-stu-id="9dcff-148">This example uses <xref:System.Linq.Enumerable.Select%2A> to return all the rows from `Product` and display the product names.</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#SelectAnonymousTypes_MQ](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#selectanonymoustypes_mq)]
 [!code-vb[DP LINQ to DataSet Examples#SelectAnonymousTypes_MQ](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#selectanonymoustypes_mq)]  
  
## <a name="composing-queries"></a><span data-ttu-id="9dcff-149">Composition de requêtes</span><span class="sxs-lookup"><span data-stu-id="9dcff-149">Composing Queries</span></span>  
 <span data-ttu-id="9dcff-150">Comme mentionné précédemment dans cette rubrique, la variable de requête elle-même ne stocke les commandes de requête que lorsque la requête est conçue pour retourner une séquence de valeurs.</span><span class="sxs-lookup"><span data-stu-id="9dcff-150">As mentioned earlier in this topic, the query variable itself only stores the query commands when the query is designed to return a sequence of values.</span></span> <span data-ttu-id="9dcff-151">Si la requête ne contient pas de méthode qui déclenche une exécution immédiate, l'exécution effective de la requête est différée jusqu'à ce que vous itériez au sein de la variable de requête dans une boucle `foreach` ou `For Each`.</span><span class="sxs-lookup"><span data-stu-id="9dcff-151">If the query does not contain a method that will cause immediate execution, the actual execution of the query is deferred until you iterate over the query variable in a `foreach` or `For Each` loop.</span></span> <span data-ttu-id="9dcff-152">L'exécution différée permet de combiner plusieurs requêtes ou d'étendre une requête.</span><span class="sxs-lookup"><span data-stu-id="9dcff-152">Deferred execution enables multiple queries to be combined or a query to be extended.</span></span> <span data-ttu-id="9dcff-153">Lorsqu'une requête est étendue, elle est modifiée de manière à inclure les nouvelles opérations, et l'exécution finale reflète les modifications.</span><span class="sxs-lookup"><span data-stu-id="9dcff-153">When a query is extended, it is modified to include the new operations, and the eventual execution will reflect the changes.</span></span> <span data-ttu-id="9dcff-154">Dans l'exemple suivant, la première requête retourne tous les produits.</span><span class="sxs-lookup"><span data-stu-id="9dcff-154">In the following example, the first query returns all the products.</span></span> <span data-ttu-id="9dcff-155">La deuxième requête étend la première en utilisant `Where` pour retourner tous les produits de taille « L » :</span><span class="sxs-lookup"><span data-stu-id="9dcff-155">The second query extends the first by using `Where` to return all the products of size "L":</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#Composing](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#composing)]
 [!code-vb[DP LINQ to DataSet Examples#Composing](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#composing)]  
  
 <span data-ttu-id="9dcff-156">Une fois qu’une requête a été exécutée, aucune requête supplémentaire ne peut être composée, et toutes les requêtes suivantes utilisent les opérateurs LINQ en mémoire.</span><span class="sxs-lookup"><span data-stu-id="9dcff-156">After a query has been executed, no additional queries can be composed, and all subsequent queries will use the in-memory LINQ operators.</span></span> <span data-ttu-id="9dcff-157">L’exécution de la requête se produit lorsque vous itérez au sein de la variable de requête dans une `foreach` `For Each` instruction ou, ou par un appel à l’un des opérateurs de conversion LINQ qui provoquent une exécution immédiate.</span><span class="sxs-lookup"><span data-stu-id="9dcff-157">Query execution will occur when you iterate over the query variable in a `foreach` or `For Each` statement, or by a call to one of the LINQ conversion operators that cause immediate execution.</span></span> <span data-ttu-id="9dcff-158">Ces opérateurs sont notamment : <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToArray%2A>, <xref:System.Linq.Enumerable.ToLookup%2A> et <xref:System.Linq.Enumerable.ToDictionary%2A>.</span><span class="sxs-lookup"><span data-stu-id="9dcff-158">These operators include the following: <xref:System.Linq.Enumerable.ToList%2A>, <xref:System.Linq.Enumerable.ToArray%2A>, <xref:System.Linq.Enumerable.ToLookup%2A>, and <xref:System.Linq.Enumerable.ToDictionary%2A>.</span></span>  
  
 <span data-ttu-id="9dcff-159">Dans l'exemple suivant, la première requête retourne tous les produits triés par tarif.</span><span class="sxs-lookup"><span data-stu-id="9dcff-159">In the following example, the first query returns all the products ordered by list price.</span></span> <span data-ttu-id="9dcff-160">La méthode <xref:System.Linq.Enumerable.ToArray%2A> est utilisée pour forcer l'exécution immédiate de la requête :</span><span class="sxs-lookup"><span data-stu-id="9dcff-160">The <xref:System.Linq.Enumerable.ToArray%2A> method is used to force immediate query execution:</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#ToArray2](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#toarray2)]
 [!code-vb[DP LINQ to DataSet Examples#ToArray2](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#toarray2)]  
  
## <a name="see-also"></a><span data-ttu-id="9dcff-161">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="9dcff-161">See also</span></span>

- [<span data-ttu-id="9dcff-162">Guide de programmation</span><span class="sxs-lookup"><span data-stu-id="9dcff-162">Programming Guide</span></span>](programming-guide-linq-to-dataset.md)
- [<span data-ttu-id="9dcff-163">Interrogation de DataSets</span><span class="sxs-lookup"><span data-stu-id="9dcff-163">Querying DataSets</span></span>](querying-datasets-linq-to-dataset.md)
- [<span data-ttu-id="9dcff-164">Mise en route de LINQ en C#</span><span class="sxs-lookup"><span data-stu-id="9dcff-164">Getting Started with LINQ in C#</span></span>](../../../csharp/programming-guide/concepts/linq/index.md)
- [<span data-ttu-id="9dcff-165">Mise en route de LINQ dans Visual Basic</span><span class="sxs-lookup"><span data-stu-id="9dcff-165">Getting Started with LINQ in Visual Basic</span></span>](../../../visual-basic/programming-guide/concepts/linq/getting-started-with-linq.md)

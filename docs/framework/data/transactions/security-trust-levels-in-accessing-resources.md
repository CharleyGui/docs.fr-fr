---
title: Niveaux de confiance de sécurité dans l'accès aux ressources
description: Comprendre les niveaux de confiance de sécurité pour accéder aux ressources dans .NET. Il existe 3 niveaux de confiance principaux pour System. transactions.
ms.date: 03/30/2017
ms.assetid: fb5be924-317d-4d69-b33a-3d18ecfb9d6e
ms.openlocfilehash: cbae3e87fc11a4230ba8f62cdbc273677e220bfb
ms.sourcegitcommit: 5b475c1855b32cf78d2d1bbb4295e4c236f39464
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/24/2020
ms.locfileid: "91152908"
---
# <a name="security-trust-levels-in-accessing-resources"></a><span data-ttu-id="087ac-104">Niveaux de confiance de sécurité dans l'accès aux ressources</span><span class="sxs-lookup"><span data-stu-id="087ac-104">Security Trust Levels in Accessing Resources</span></span>

<span data-ttu-id="087ac-105">Cette rubrique présente la restriction de l'accès aux types de ressources exposés par <xref:System.Transactions>.</span><span class="sxs-lookup"><span data-stu-id="087ac-105">This topic discusses how access is restricted on the types of resources that <xref:System.Transactions> exposes.</span></span>  
  
 <span data-ttu-id="087ac-106">Il existe trois niveaux de confiance principaux pour <xref:System.Transactions>.</span><span class="sxs-lookup"><span data-stu-id="087ac-106">There are three main levels of trust for <xref:System.Transactions>.</span></span> <span data-ttu-id="087ac-107">Les niveaux de confiance sont définis d'après les types de ressources que <xref:System.Transactions> expose et le niveau de confiance nécessaire pour accéder à ces ressources.</span><span class="sxs-lookup"><span data-stu-id="087ac-107">The trust levels are defined based on the types of resources that <xref:System.Transactions> exposes, and the level of trust that should be required to access those resources.</span></span> <span data-ttu-id="087ac-108">Les ressources auxquelles <xref:System.Transactions> donne accès sont la mémoire système, les ressources partagées au niveau du processus et les ressources système.</span><span class="sxs-lookup"><span data-stu-id="087ac-108">The resources that <xref:System.Transactions> provides access to are system memory, shared process wide resources, and system wide resources.</span></span> <span data-ttu-id="087ac-109">Les niveaux sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="087ac-109">The levels are:</span></span>  
  
- <span data-ttu-id="087ac-110">**AllowPartiallyTrustedCallers** (APTCA) pour les applications utilisant des transactions au sein d’un domaine d’application unique.</span><span class="sxs-lookup"><span data-stu-id="087ac-110">**AllowPartiallyTrustedCallers** (APTCA) for applications using transactions within a single application domain.</span></span>  
  
- <span data-ttu-id="087ac-111">**DistributedTransactionPermission** (PAO) pour les applications utilisant des transactions distribuées.</span><span class="sxs-lookup"><span data-stu-id="087ac-111">**DistributedTransactionPermission** (DTP) for applications using distributed transactions.</span></span>  
  
- <span data-ttu-id="087ac-112">Confiance totale pour les ressources durables, les applications de gestion de configuration et les applications d'interopérabilité héritées.</span><span class="sxs-lookup"><span data-stu-id="087ac-112">Full trust for durable resources, configuration management applications, and legacy interop applications.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="087ac-113">N'appelez pas les interfaces inscrites avec des contextes personnifiés.</span><span class="sxs-lookup"><span data-stu-id="087ac-113">You should not call any of the enlistment interfaces with impersonated contexts.</span></span>  
  
## <a name="trust-levels"></a><span data-ttu-id="087ac-114">Niveaux de confiance</span><span class="sxs-lookup"><span data-stu-id="087ac-114">Trust Levels</span></span>  
  
### <a name="aptca-partial-trust"></a><span data-ttu-id="087ac-115">APTCA (confiance partielle)</span><span class="sxs-lookup"><span data-stu-id="087ac-115">APTCA (Partial Trust)</span></span>  

 <span data-ttu-id="087ac-116">L' <xref:System.Transactions> assembly peut être appelé par du code d’un niveau de confiance partiel, car il a été marqué avec l’attribut **ALLOWPARTIALLYTRUSTEDCALLERS** (APTCA).</span><span class="sxs-lookup"><span data-stu-id="087ac-116">The <xref:System.Transactions> assembly can be called by partially trusted code because it has been marked with the **AllowPartiallyTrustedCallers** attribute (APTCA).</span></span> <span data-ttu-id="087ac-117">Cet attribut supprime essentiellement le implicite <xref:System.Security.Permissions.SecurityAction.LinkDemand> pour le jeu d’autorisations **FullTrust** qui, sinon, est automatiquement placé sur chaque méthode accessible publiquement dans chaque type.</span><span class="sxs-lookup"><span data-stu-id="087ac-117">This attribute essentially removes the implicit <xref:System.Security.Permissions.SecurityAction.LinkDemand> for the **FullTrust** permission set that is otherwise automatically placed on each publicly accessible method in each type.</span></span> <span data-ttu-id="087ac-118">Toutefois, certains types et membres requièrent encore des autorisations plus élevées.</span><span class="sxs-lookup"><span data-stu-id="087ac-118">However, some types and members still require stronger permissions.</span></span>  
  
 <span data-ttu-id="087ac-119">L'attribut APTCA permet aux applications d'utiliser des transactions en confiance partielle au sein d'un domaine d'application unique.</span><span class="sxs-lookup"><span data-stu-id="087ac-119">The APTCA attribute enables applications to use transactions in partial trust within a single application domain.</span></span> <span data-ttu-id="087ac-120">Cela active les transactions non remontées et les inscriptions volatiles qui peuvent être utilisées pour la gestion des erreurs.</span><span class="sxs-lookup"><span data-stu-id="087ac-120">This enables non-escalated transactions and volatile enlistments that can be used for error handling.</span></span> <span data-ttu-id="087ac-121">Une table de hachage traitée et l'application qui l'utilise en sont des exemples.</span><span class="sxs-lookup"><span data-stu-id="087ac-121">One example of this is a transacted hash table and an application that uses it.</span></span> <span data-ttu-id="087ac-122">Il est possible d'ajouter ou de supprimer des données de la table de hachage sous une seule transaction.</span><span class="sxs-lookup"><span data-stu-id="087ac-122">Data can be added to and removed from the hash table under a single transaction.</span></span> <span data-ttu-id="087ac-123">En cas de restauration ultérieure de la transaction, toutes les modifications apportées à la table de hachage sous cette transaction peuvent être annulées.</span><span class="sxs-lookup"><span data-stu-id="087ac-123">If the transaction is later rolled back, all of the changes made to the hash table under that transaction can be undone.</span></span>  
  
### <a name="distributedtransactionpermission-dtp"></a><span data-ttu-id="087ac-124">DistributedTransactionPermission (DTP)</span><span class="sxs-lookup"><span data-stu-id="087ac-124">DistributedTransactionPermission (DTP)</span></span>  

 <span data-ttu-id="087ac-125">Lorsqu'une transaction <xref:System.Transactions> est remontée pour gestion par le MSDTC, <xref:System.Transactions> demande à <xref:System.Transactions.DistributedTransactionPermission> (DTP) de créer la transaction distribuée.</span><span class="sxs-lookup"><span data-stu-id="087ac-125">When a <xref:System.Transactions> transaction is escalated to be managed by MSDTC, <xref:System.Transactions> demands the <xref:System.Transactions.DistributedTransactionPermission> (DTP) to create the distributed transaction.</span></span> <span data-ttu-id="087ac-126">Cela signifie que le code provoquant la remontée de la transaction (par exemple, via la sérialisation ou les inscriptions durables supplémentaires) doit se voir accorder la DTP.</span><span class="sxs-lookup"><span data-stu-id="087ac-126">This means that the code that causes the transaction to be escalated (such as through serialization or additional durable enlistments) would need to be granted DTP.</span></span> <span data-ttu-id="087ac-127">Le code qui a initialement permis de créer la transaction <xref:System.Transactions> ne requiert pas nécessairement cette autorisation.</span><span class="sxs-lookup"><span data-stu-id="087ac-127">The code that originally created the <xref:System.Transactions> transaction does not necessarily need to possess this permission.</span></span>  
  
### <a name="fulltrust-link-demands"></a><span data-ttu-id="087ac-128">Demandes de liaison FullTrust</span><span class="sxs-lookup"><span data-stu-id="087ac-128">FullTrust Link Demands</span></span>  

 <span data-ttu-id="087ac-129">Ce niveau d'autorisation est conçu pour restreindre les applications qui écrivent dans des ressources durables.</span><span class="sxs-lookup"><span data-stu-id="087ac-129">This permission level is intended to restrict applications that are writing to durable resources.</span></span> <span data-ttu-id="087ac-130">Après défaillance, l'application doit pouvoir effectuer la récupération avec le gestionnaire de transactions pour déterminer le résultat final de la transaction, de façon à pouvoir mettre à jour les données permanentes.</span><span class="sxs-lookup"><span data-stu-id="087ac-130">Upon failure, the application needs to be able to recover with the transaction manager to determine the final outcome of the transaction, so that it can update permanent data.</span></span> <span data-ttu-id="087ac-131">Ce type d'application est connu en tant que gestionnaire de source durable.</span><span class="sxs-lookup"><span data-stu-id="087ac-131">This type of application is known as a durable source manager.</span></span> <span data-ttu-id="087ac-132">SQL est un exemple classique de ce type d'application.</span><span class="sxs-lookup"><span data-stu-id="087ac-132">A classic example of this type of application is SQL.</span></span>  
  
 <span data-ttu-id="087ac-133">Pour activer la récupération, ce type d'application est capable de consommer de façon permanente des ressources système.</span><span class="sxs-lookup"><span data-stu-id="087ac-133">To enable recovery, this type of application has the ability to permanently consume system resources.</span></span> <span data-ttu-id="087ac-134">Cela est dû au fait que le gestionnaire de transactions récupérables doit mémoriser les transactions qui ont été validées jusqu'à ce qu'il soit en mesure de confirmer que tous les gestionnaires de ressources durables participant à la transaction ont reçu le résultat.</span><span class="sxs-lookup"><span data-stu-id="087ac-134">This is because the recoverable transaction manager must remember transactions that have committed until it can confirm that all durable resource managers that are participating in the transaction have received the outcome.</span></span> <span data-ttu-id="087ac-135">Par conséquent, ce type d'application requiert une confiance totale et ne doit pas être exécuté sans que ce niveau de confiance n'ait été accordé.</span><span class="sxs-lookup"><span data-stu-id="087ac-135">Therefore, this type of application requires full trust and should not be run unless that level of trust has been granted.</span></span>  
  
 <span data-ttu-id="087ac-136">Pour plus d’informations sur les inscriptions durables et la récupération, consultez les rubriques [inscription de ressources en tant que participants dans une transaction](enlisting-resources-as-participants-in-a-transaction.md) et exécution de la [récupération](performing-recovery.md) .</span><span class="sxs-lookup"><span data-stu-id="087ac-136">For more information on durable enlistments and recovery, see the [Enlisting Resources as Participants in a Transaction](enlisting-resources-as-participants-in-a-transaction.md) and [Performing Recovery](performing-recovery.md) topics.</span></span>  
  
 <span data-ttu-id="087ac-137">Les applications qui effectuent un travail d'interopérabilité héritée avec COM+ sont également requises pour une confiance totale.</span><span class="sxs-lookup"><span data-stu-id="087ac-137">Applications that perform legacy interop work with COM+ are also required to have full trust.</span></span>  
  
 <span data-ttu-id="087ac-138">La liste suivante répertorie les types et les membres qui ne peuvent pas être appelés par du code d’un niveau de confiance partiel, car ils sont décorés avec l’attribut de sécurité déclarative **FullTrust** :</span><span class="sxs-lookup"><span data-stu-id="087ac-138">The following is a list of types and members that are not callable by partially trusted code because they are decorated with the **FullTrust** declarative security attribute:</span></span>  
  
 `PermissionSetAttribute(SecurityAction.LinkDemand, Name := "FullTrust")`  
  
- <xref:System.Transactions.Transaction.EnlistDurable%2A?displayProperty=nameWithType>  
  
- <xref:System.Transactions.Transaction.EnlistPromotableSinglePhase%2A>  
  
- <xref:System.Transactions.TransactionInterop>  
  
- <xref:System.Transactions.TransactionManager.DistributedTransactionStarted>  
  
- <xref:System.Transactions.HostCurrentTransactionCallback>  
  
- <xref:System.Transactions.TransactionManager.Reenlist%2A>  
  
- <xref:System.Transactions.TransactionManager.RecoveryComplete%2A>  
  
- <xref:System.Transactions.TransactionScope.%23ctor%28System.Transactions.TransactionScopeOption%2CSystem.Transactions.TransactionOptions%2CSystem.Transactions.EnterpriseServicesInteropOption%29>  
  
 <span data-ttu-id="087ac-139">Seul l’appelant immédiat est tenu de posséder l’autorisation **FullTrust** définie pour utiliser les types ou les méthodes ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="087ac-139">Only the immediate caller is required to possess the **FullTrust** permission set to use the above types or methods.</span></span>

---
title: Problèmes de sécurité dans l'émission de réflexion
description: Découvrez les problèmes de sécurité dans l’émission de réflexion, qui sont effectués par le biais d’assemblys dynamiques ou de méthodes dynamiques connectées à des assemblys existants ou hébergés anonymement.
ms.date: 03/30/2017
helpviewer_keywords:
- partially trusted code
- emitting dynamic assemblies, security
- reflection emit, security
- reflection emit, partial trust scenarios
- partial trust,emitting dynamic methods
- anonymously hosted dynamic methods [.NET Framework]
- emitting dynamic assemblies,partial trust scenarios
- dynamic assemblies, security
ms.assetid: 0f8bf8fa-b993-478f-87ab-1a1a7976d298
ms.openlocfilehash: 62bce7435887855f799d320736e6bce8f39e5999
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/15/2020
ms.locfileid: "90558795"
---
# <a name="security-issues-in-reflection-emit"></a><span data-ttu-id="2a093-103">Problèmes de sécurité dans l'émission de réflexion</span><span class="sxs-lookup"><span data-stu-id="2a093-103">Security Issues in Reflection Emit</span></span>
<span data-ttu-id="2a093-104">Le .NET Framework offre trois façons d’émettre du code MSIL (Microsoft Intermediate Language), chacune avec ses propres problèmes de sécurité :</span><span class="sxs-lookup"><span data-stu-id="2a093-104">The .NET Framework provides three ways to emit Microsoft intermediate language (MSIL), each with its own security issues:</span></span>  
  
- [<span data-ttu-id="2a093-105">Assemblys dynamiques</span><span class="sxs-lookup"><span data-stu-id="2a093-105">Dynamic assemblies</span></span>](#Dynamic_Assemblies)  
  
- [<span data-ttu-id="2a093-106">Méthodes dynamiques hébergées anonymement</span><span class="sxs-lookup"><span data-stu-id="2a093-106">Anonymously hosted dynamic methods</span></span>](#Anonymously_Hosted_Dynamic_Methods)  
  
- [<span data-ttu-id="2a093-107">Méthodes dynamiques associées à des assemblys existants</span><span class="sxs-lookup"><span data-stu-id="2a093-107">Dynamic methods associated with existing assemblies</span></span>](#Dynamic_Methods_Associated_with_Existing_Assemblies)  
  
 <span data-ttu-id="2a093-108">Quelle que soit la façon dont vous générez le code dynamique, l'exécution du code généré nécessite toutes les autorisations requises par les types et par les méthodes utilisées par le code généré.</span><span class="sxs-lookup"><span data-stu-id="2a093-108">Regardless of the way you generate dynamic code, executing the generated code requires all the permissions that are required by the types and methods the generated code uses.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2a093-109">Les autorisations nécessaires pour la réflexion sur le code et pour l’émission de code ont changé avec les versions successives du .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2a093-109">The permissions that are required for reflecting on code and emitting code have changed with succeeding releases of the .NET Framework.</span></span> <span data-ttu-id="2a093-110">Consultez [Informations sur la version](#Version_Information) plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="2a093-110">See [Version Information](#Version_Information), later in this topic.</span></span>  
  
<a name="Dynamic_Assemblies"></a>
## <a name="dynamic-assemblies"></a><span data-ttu-id="2a093-111">Assemblys dynamiques</span><span class="sxs-lookup"><span data-stu-id="2a093-111">Dynamic Assemblies</span></span>  
 <span data-ttu-id="2a093-112">Les assemblys dynamiques sont créés à l'aide de surcharges de la méthode <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a093-112">Dynamic assemblies are created by using overloads of the <xref:System.AppDomain.DefineDynamicAssembly%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="2a093-113">La plupart des surcharges de cette méthode sont dépréciées dans .NET Framework 4, en raison de la suppression de la stratégie de sécurité à l’échelle de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="2a093-113">Most overloads of this method are deprecated in the .NET Framework 4, because of the elimination of machine-wide security policy.</span></span> <span data-ttu-id="2a093-114">(Voir [modifications de sécurité](/previous-versions/dotnet/framework/security/security-changes).) Les surcharges restantes peuvent être exécutées par n’importe quel code, quel que soit le niveau de confiance.</span><span class="sxs-lookup"><span data-stu-id="2a093-114">(See [Security Changes](/previous-versions/dotnet/framework/security/security-changes).) The remaining overloads can be executed by any code, regardless of trust level.</span></span> <span data-ttu-id="2a093-115">Ces surcharges sont réparties en deux groupes : celles qui spécifient une liste d'attributs à appliquer à l'assembly dynamique lors de sa création, et celles qui ne les spécifient pas.</span><span class="sxs-lookup"><span data-stu-id="2a093-115">These overloads fall into two groups: those that specify a list of attributes to apply to the dynamic assembly when it is created, and those that do not.</span></span> <span data-ttu-id="2a093-116">Si vous ne spécifiez pas le modèle de transparence pour l’assembly, en appliquant l’attribut <xref:System.Security.SecurityRulesAttribute> au moment de sa création, le modèle de transparence est hérité de l’assembly émetteur.</span><span class="sxs-lookup"><span data-stu-id="2a093-116">If you do not specify the transparency model for the assembly, by applying the <xref:System.Security.SecurityRulesAttribute> attribute when you create it, the transparency model is inherited from the emitting assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2a093-117">Les attributs que vous appliquez à l'assembly dynamique après sa création, en utilisant la méthode <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A>, ne prennent pas effet tant que l'assembly n'a pas été enregistré sur le disque et rechargé en mémoire.</span><span class="sxs-lookup"><span data-stu-id="2a093-117">Attributes that you apply to the dynamic assembly after it is created, by using the <xref:System.Reflection.Emit.AssemblyBuilder.SetCustomAttribute%2A> method, do not take effect until the assembly has been saved to disk and loaded into memory again.</span></span>  
  
 <span data-ttu-id="2a093-118">Le code d'un assembly dynamique peut accéder aux types et aux membres visibles d'autres assemblys.</span><span class="sxs-lookup"><span data-stu-id="2a093-118">Code in a dynamic assembly can access visible types and members in other assemblies.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2a093-119">Les assemblys dynamiques n'utilisent pas les indicateurs <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> et <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, qui permettent aux méthodes dynamiques d'accéder aux types et aux membres non publics.</span><span class="sxs-lookup"><span data-stu-id="2a093-119">Dynamic assemblies do not use the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> and <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flags that allow dynamic methods to access nonpublic types and members.</span></span>  
  
 <span data-ttu-id="2a093-120">Les assemblys dynamiques transitoires sont créés en mémoire et ne sont jamais enregistrés sur disque : ils ne nécessitent donc pas d'autorisations d'accès à des fichiers.</span><span class="sxs-lookup"><span data-stu-id="2a093-120">Transient dynamic assemblies are created in memory and never saved to disk, so they require no file access permissions.</span></span> <span data-ttu-id="2a093-121">L'enregistrement d'un assembly dynamique sur disque requiert <xref:System.Security.Permissions.FileIOPermission> avec les indicateurs appropriés.</span><span class="sxs-lookup"><span data-stu-id="2a093-121">Saving a dynamic assembly to disk requires <xref:System.Security.Permissions.FileIOPermission> with the appropriate flags.</span></span>  
  
### <a name="generating-dynamic-assemblies-from-partially-trusted-code"></a><span data-ttu-id="2a093-122">Génération d'assemblys dynamiques à partir de code d'un niveau de confiance partiel</span><span class="sxs-lookup"><span data-stu-id="2a093-122">Generating Dynamic Assemblies from Partially Trusted Code</span></span>  
 <span data-ttu-id="2a093-123">Considérez les conditions dans lesquelles un assembly disposant d'autorisations Internet peut générer un assembly dynamique transitoire et exécuter son code :</span><span class="sxs-lookup"><span data-stu-id="2a093-123">Consider the conditions in which an assembly with Internet permissions can generate a transient dynamic assembly and execute its code:</span></span>  
  
- <span data-ttu-id="2a093-124">L'assembly dynamique utilise seulement des types et des membres publics d'autres assemblys.</span><span class="sxs-lookup"><span data-stu-id="2a093-124">The dynamic assembly uses only public types and members of other assemblies.</span></span>  
  
- <span data-ttu-id="2a093-125">Les autorisations demandées par ces types et ces membres sont incluses dans le jeu d'autorisations de l'assembly partiellement approuvé.</span><span class="sxs-lookup"><span data-stu-id="2a093-125">The permissions demanded by those types and members are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="2a093-126">L'assembly n'est pas enregistré sur disque.</span><span class="sxs-lookup"><span data-stu-id="2a093-126">The assembly is not saved to disk.</span></span>  
  
- <span data-ttu-id="2a093-127">Les symboles de débogage ne sont pas générés.</span><span class="sxs-lookup"><span data-stu-id="2a093-127">Debug symbols are not generated.</span></span> <span data-ttu-id="2a093-128">(Les jeux d'autorisations `Internet` et `LocalIntranet` n'incluent pas les autorisations nécessaires.)</span><span class="sxs-lookup"><span data-stu-id="2a093-128">(`Internet` and `LocalIntranet` permission sets do not include the necessary permissions.)</span></span>  
  
<a name="Anonymously_Hosted_Dynamic_Methods"></a>
## <a name="anonymously-hosted-dynamic-methods"></a><span data-ttu-id="2a093-129">Méthodes dynamiques hébergées anonymement</span><span class="sxs-lookup"><span data-stu-id="2a093-129">Anonymously Hosted Dynamic Methods</span></span>  
 <span data-ttu-id="2a093-130">Les méthodes dynamiques hébergées anonymement sont créées à l'aide des deux constructeurs de <xref:System.Reflection.Emit.DynamicMethod> qui ne spécifient pas un type ou un module associé, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> et <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span><span class="sxs-lookup"><span data-stu-id="2a093-130">Anonymously hosted dynamic methods are created by using the two <xref:System.Reflection.Emit.DynamicMethod> constructors that do not specify an associated type or module, <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%29> and <xref:System.Reflection.Emit.DynamicMethod.%23ctor%28System.String%2CSystem.Type%2CSystem.Type%5B%5D%2CSystem.Boolean%29>.</span></span> <span data-ttu-id="2a093-131">Ces constructeurs placent les méthodes dynamiques dans un assembly fourni par le système, entièrement fiable et transparent quant à la sécurité.</span><span class="sxs-lookup"><span data-stu-id="2a093-131">These constructors place the dynamic methods in a system-provided, fully trusted, security-transparent assembly.</span></span> <span data-ttu-id="2a093-132">Aucune autorisation n'est requise pour utiliser ces constructeurs ou pour émettre du code pour les méthodes dynamiques.</span><span class="sxs-lookup"><span data-stu-id="2a093-132">No permissions are required to use these constructors or to emit code for the dynamic methods.</span></span>  
  
 <span data-ttu-id="2a093-133">Au lieu de cela, quand une méthode dynamique hébergée anonymement est créée, la pile des appels est capturée.</span><span class="sxs-lookup"><span data-stu-id="2a093-133">Instead, when an anonymously hosted dynamic method is created, the call stack is captured.</span></span> <span data-ttu-id="2a093-134">Quand la méthode est construite, les demandes en matière de sécurité sont effectuées sur la pile des appels capturée.</span><span class="sxs-lookup"><span data-stu-id="2a093-134">When the method is constructed, security demands are made against the captured call stack.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2a093-135">Conceptuellement, les demandes sont effectuées pendant la construction de la méthode.</span><span class="sxs-lookup"><span data-stu-id="2a093-135">Conceptually, demands are made during the construction of the method.</span></span> <span data-ttu-id="2a093-136">Autrement dit, les demandes peuvent être faites à l'émission de chaque instruction MSIL.</span><span class="sxs-lookup"><span data-stu-id="2a093-136">That is, demands could be made as each MSIL instruction is emitted.</span></span> <span data-ttu-id="2a093-137">Dans l'implémentation actuelle, toutes les demandes sont faites quand la méthode <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> est appelée ou quand le compilateur juste-à-temps (JIT) est appelé, si la méthode est appelée sans appel de <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span><span class="sxs-lookup"><span data-stu-id="2a093-137">In the current implementation, all demands are made when the <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A?displayProperty=nameWithType> method is called or when the just-in-time (JIT) compiler is invoked, if the method is invoked without calling <xref:System.Reflection.Emit.DynamicMethod.CreateDelegate%2A>.</span></span>  
  
 <span data-ttu-id="2a093-138">Si le domaine d'application le permet, les méthodes dynamiques hébergées anonymement peuvent ignorer les contrôles de visibilité JIT, avec la restriction suivante : les types et les membres non publics auxquels accède une méthode dynamique hébergée anonymement doivent être dans des assemblys dont les jeux d'autorisations doivent être équivalents à ou être des sous-ensembles du jeu d'autorisations de la pile des appels émettrice.</span><span class="sxs-lookup"><span data-stu-id="2a093-138">If the application domain permits it, anonymously hosted dynamic methods can skip JIT visibility checks, subject to the following restriction: The nonpublic types and members accessed by an anonymously hosted dynamic method must be in assemblies whose grant sets are equal to, or subsets of, the grant set of the emitting call stack.</span></span> <span data-ttu-id="2a093-139">Cette possibilité restreinte d'ignorer les contrôles de visibilité JIT est activée si le domaine d'application accorde l'autorisation <xref:System.Security.Permissions.ReflectionPermission> avec l'indicateur <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a093-139">This restricted ability to skip JIT visibility checks is enabled if the application domain grants <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="2a093-140">Si votre méthode utilise seulement des types et des membres publics, aucune autorisation n'est requise pendant la construction.</span><span class="sxs-lookup"><span data-stu-id="2a093-140">If your method uses only public types and members, no permissions are required during construction.</span></span>  
  
- <span data-ttu-id="2a093-141">Si vous spécifiez que les contrôles de visibilité JIT doivent être ignorés, la demande qui est faite quand la méthode est construite inclut <xref:System.Security.Permissions.ReflectionPermission> avec l'indicateur <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> et le jeu d'autorisations de l'assembly qui contient le membre non public qui fait l'objet de l'accès.</span><span class="sxs-lookup"><span data-stu-id="2a093-141">If you specify that JIT visibility checks should be skipped, the demand that is made when the method is constructed includes <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag and the grant set of the assembly that contains the nonpublic member that is being accessed.</span></span>  
  
 <span data-ttu-id="2a093-142">Étant donné que le jeu d'autorisations du membre non public est pris en considération, le code d'un niveau de confiance partiel auquel l'autorisation <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> a été accordée ne peut pas élever ses privilèges en exécutant des membres non publics d'assemblys approuvés.</span><span class="sxs-lookup"><span data-stu-id="2a093-142">Because the grant set of the nonpublic member is taken into consideration, partially trusted code that has been granted <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> cannot elevate its privileges by executing nonpublic members of trusted assemblies.</span></span>  
  
 <span data-ttu-id="2a093-143">Comme avec tout autre code émis, l'exécution de la méthode dynamique nécessite toutes les autorisations demandées par les méthodes utilisées par la méthode dynamique.</span><span class="sxs-lookup"><span data-stu-id="2a093-143">As with any other emitted code, executing the dynamic method requires whatever permissions are demanded by the methods the dynamic method uses.</span></span>  
  
 <span data-ttu-id="2a093-144">L’assembly système qui héberge des méthodes dynamiques hébergées anonymement utilise le modèle de transparence <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType>, qui est le modèle de transparence utilisé dans le .NET Framework avant .NET Framework 4.</span><span class="sxs-lookup"><span data-stu-id="2a093-144">The system assembly that hosts anonymously-hosted dynamic methods uses the <xref:System.Security.SecurityRuleSet.Level1?displayProperty=nameWithType> transparency model, which is the transparency model that was used in the .NET Framework before the .NET Framework 4.</span></span>  
  
 <span data-ttu-id="2a093-145">Pour plus d'informations, consultez la classe <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="2a093-145">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-anonymously-hosted-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="2a093-146">Génération de méthodes dynamiques hébergées anonymement à partir de code d'un niveau de confiance partiel</span><span class="sxs-lookup"><span data-stu-id="2a093-146">Generating Anonymously Hosted Dynamic Methods from Partially Trusted Code</span></span>  
 <span data-ttu-id="2a093-147">Considérez les conditions dans lesquelles un assembly disposant d'autorisations Internet peut générer une méthode dynamique hébergée anonymement et l'exécuter :</span><span class="sxs-lookup"><span data-stu-id="2a093-147">Consider the conditions in which an assembly with Internet permissions can generate an anonymously hosted dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="2a093-148">La méthode dynamique utilise seulement des types et des membres publics.</span><span class="sxs-lookup"><span data-stu-id="2a093-148">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="2a093-149">Si son jeu d'autorisations inclut <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, elle peut utiliser des types et des membres non publics de tout assembly dont le jeu d'autorisations est équivalent à ou est un sous-ensemble du jeu d'autorisations de l'assembly émetteur.</span><span class="sxs-lookup"><span data-stu-id="2a093-149">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>, it can use nonpublic types and members of any assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="2a093-150">Les autorisations requises par tous les types et les membres utilisés par la méthode dynamique sont incluses dans le jeu d'autorisations de l'assembly partiellement approuvé.</span><span class="sxs-lookup"><span data-stu-id="2a093-150">The permissions that are required by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2a093-151">Les méthodes dynamiques ne prennent pas en charge les symboles de débogage.</span><span class="sxs-lookup"><span data-stu-id="2a093-151">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Dynamic_Methods_Associated_with_Existing_Assemblies"></a>
## <a name="dynamic-methods-associated-with-existing-assemblies"></a><span data-ttu-id="2a093-152">Méthodes dynamiques associées à des assemblys existants</span><span class="sxs-lookup"><span data-stu-id="2a093-152">Dynamic Methods Associated with Existing Assemblies</span></span>  
 <span data-ttu-id="2a093-153">Pour associer une méthode dynamique à un type ou un module d'un assembly existant, utilisez les constructeurs de <xref:System.Reflection.Emit.DynamicMethod> qui spécifient le type ou le module associé.</span><span class="sxs-lookup"><span data-stu-id="2a093-153">To associate a dynamic method with a type or module in an existing assembly, use any of the <xref:System.Reflection.Emit.DynamicMethod> constructors that specify the associated type or module.</span></span> <span data-ttu-id="2a093-154">Les autorisations requises pour appeler ces constructeurs varient, car l'association d'une méthode dynamique à un type ou un module existant donne à la méthode dynamique l'accès aux types et aux membres non publics :</span><span class="sxs-lookup"><span data-stu-id="2a093-154">The permissions that are required to call these constructors vary, because associating a dynamic method with an existing type or module gives the dynamic method access to nonpublic types and members:</span></span>  
  
- <span data-ttu-id="2a093-155">Une méthode dynamique qui est associée à un type a accès à tous les membres de ce type, même aux membres privés, et à tous les types et les membres internes de l'assembly qui contient le type associé.</span><span class="sxs-lookup"><span data-stu-id="2a093-155">A dynamic method that is associated with a type has access to all members of that type, even private members, and to all internal types and members in the assembly that contains the associated type.</span></span>  
  
- <span data-ttu-id="2a093-156">Une méthode dynamique qui est associée à un module a accès à tous les types et les membres `internal` (`Friend` en Visual Basic, `assembly` dans les métadonnées du common language runtime) du module.</span><span class="sxs-lookup"><span data-stu-id="2a093-156">A dynamic method that is associated with a module has access to all the `internal` types and members (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the module.</span></span>  
  
 <span data-ttu-id="2a093-157">En outre, vous pouvez utiliser un constructeur qui spécifie la possibilité d'ignorer les contrôles de visibilité du compilateur JIT.</span><span class="sxs-lookup"><span data-stu-id="2a093-157">In addition, you can use a constructor that specifies the ability to skip the visibility checks of the JIT compiler.</span></span> <span data-ttu-id="2a093-158">Procéder ainsi donne à votre méthode dynamique l'accès à tous les types et membres de tous les assemblys, quel que soit le niveau d'accès.</span><span class="sxs-lookup"><span data-stu-id="2a093-158">Doing so gives your dynamic method access to all types and members in all assemblies, regardless of access level.</span></span>  
  
 <span data-ttu-id="2a093-159">Les autorisations demandées par le constructeur dépendent du niveau d'accès que vous décidez de donner à votre méthode dynamique :</span><span class="sxs-lookup"><span data-stu-id="2a093-159">The permissions demanded by the constructor depend on how much access you decide to give your dynamic method:</span></span>  
  
- <span data-ttu-id="2a093-160">Si votre méthode utilise seulement des types et des membres publics, et que vous l'associez à votre propre type ou à votre propre module, aucune autorisation n'est requise.</span><span class="sxs-lookup"><span data-stu-id="2a093-160">If your method uses only public types and members, and you associate it with your own type or your own module, no permissions are required.</span></span>  
  
- <span data-ttu-id="2a093-161">Si vous spécifiez que les contrôles de visibilité JIT doivent être ignorés, le constructeur demande <xref:System.Security.Permissions.ReflectionPermission> avec l'indicateur <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a093-161">If you specify that JIT visibility checks should be skipped, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="2a093-162">Si vous associez la méthode dynamique à un autre type, même un autre type de votre propre assembly, le constructeur demande <xref:System.Security.Permissions.ReflectionPermission> avec l'indicateur <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> et <xref:System.Security.Permissions.SecurityPermission> avec l'indicateur <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a093-162">If you associate the dynamic method with another type, even another type in your own assembly, the constructor demands <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag and <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
- <span data-ttu-id="2a093-163">Si vous associez la méthode dynamique à un type ou un module d'un autre assembly, le constructeur demande deux éléments : <xref:System.Security.Permissions.ReflectionPermission> avec l'indicateur <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> et le jeu d'autorisations de l'assembly qui contient l'autre module.</span><span class="sxs-lookup"><span data-stu-id="2a093-163">If you associate the dynamic method with a type or module in another assembly, the constructor demands two things: <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag, and the grant set of the assembly that contains the other module.</span></span> <span data-ttu-id="2a093-164">Autrement dit, votre pile des appels doit inclure toutes les autorisations du jeu d'autorisations du module cible, plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a093-164">That is, your call stack must include all the permissions in the grant set of the target module, plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType>.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="2a093-165">Pour la compatibilité descendante, si la demande pour le jeu d'autorisations cible plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> échoue, le constructeur demande <xref:System.Security.Permissions.SecurityPermission> avec l'indicateur <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a093-165">For backward compatibility, if the demand for the target grant set plus <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> fails, the constructor demands <xref:System.Security.Permissions.SecurityPermission> with the <xref:System.Security.Permissions.SecurityPermissionFlag.ControlEvidence?displayProperty=nameWithType> flag.</span></span>  
  
 <span data-ttu-id="2a093-166">Bien que les éléments de cette liste soient décrits en les termes du jeu d'autorisations de l'assembly émetteur, n'oubliez pas que les demandes sont faites sur la pile des appels complète, y compris la limite du domaine de l'application.</span><span class="sxs-lookup"><span data-stu-id="2a093-166">Although the items in this list are described in terms of the grant set of the emitting assembly, remember that the demands are made against the full call stack, including the application domain boundary.</span></span>  
  
 <span data-ttu-id="2a093-167">Pour plus d'informations, consultez la classe <xref:System.Reflection.Emit.DynamicMethod>.</span><span class="sxs-lookup"><span data-stu-id="2a093-167">For more information, see the <xref:System.Reflection.Emit.DynamicMethod> class.</span></span>  
  
### <a name="generating-dynamic-methods-from-partially-trusted-code"></a><span data-ttu-id="2a093-168">Génération de méthodes dynamiques à partir de code d'un niveau de confiance partiel</span><span class="sxs-lookup"><span data-stu-id="2a093-168">Generating Dynamic Methods from Partially Trusted Code</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2a093-169">La méthode recommandée pour générer des méthodes dynamiques à partir de code d’un niveau de confiance partiel consiste à utiliser des [méthodes dynamiques hébergées anonymement](#Anonymously_Hosted_Dynamic_Methods).</span><span class="sxs-lookup"><span data-stu-id="2a093-169">The recommended way to generate dynamic methods from partially trusted code is to use [anonymously hosted dynamic methods](#Anonymously_Hosted_Dynamic_Methods).</span></span>  
  
 <span data-ttu-id="2a093-170">Considérez les conditions dans lesquelles un assembly disposant d'autorisations Internet peut générer une méthode dynamique et l'exécuter :</span><span class="sxs-lookup"><span data-stu-id="2a093-170">Consider the conditions in which an assembly with Internet permissions can generate a dynamic method and execute it:</span></span>  
  
- <span data-ttu-id="2a093-171">La méthode dynamique est associée au module ou au type qui l'émet, ou bien son jeu d'autorisations inclut <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> et elle est associée à un module d'un assembly dont le jeu d'autorisations est équivalent à ou est un sous-ensemble du jeu d'autorisations de l'assembly émetteur.</span><span class="sxs-lookup"><span data-stu-id="2a093-171">Either the dynamic method is associated with the module or type that emits it, or its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly.</span></span>  
  
- <span data-ttu-id="2a093-172">La méthode dynamique utilise seulement des types et des membres publics.</span><span class="sxs-lookup"><span data-stu-id="2a093-172">The dynamic method uses only public types and members.</span></span> <span data-ttu-id="2a093-173">Si son jeu d'autorisations inclut <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> et qu'elle est associée à un module d'un assembly dont le jeu d'autorisations est équivalent à ou est un sous-ensemble du jeu d'autorisations de l'assembly émetteur, elle peut utiliser les types et les membres marqués comme étant `internal` (`Friend` en Visual Basic, `assembly` dans les métadonnées du common language runtime) dans le module associé.</span><span class="sxs-lookup"><span data-stu-id="2a093-173">If its grant set includes <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> and it is associated with a module in an assembly whose grant set is equal to, or a subset of, the grant set of the emitting assembly, it can use types and members marked `internal` (`Friend` in Visual Basic, `assembly` in common language runtime metadata) in the associated module.</span></span>  
  
- <span data-ttu-id="2a093-174">Les autorisations demandées par tous les types et les membres utilisés par la méthode dynamique sont incluses dans le jeu d'autorisations de l'assembly partiellement approuvé.</span><span class="sxs-lookup"><span data-stu-id="2a093-174">The permissions demanded by all the types and members used by the dynamic method are included in the grant set of the partially trusted assembly.</span></span>  
  
- <span data-ttu-id="2a093-175">La méthode dynamique n'ignore pas les contrôles de visibilité JIT.</span><span class="sxs-lookup"><span data-stu-id="2a093-175">The dynamic method does not skip JIT visibility checks.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2a093-176">Les méthodes dynamiques ne prennent pas en charge les symboles de débogage.</span><span class="sxs-lookup"><span data-stu-id="2a093-176">Dynamic methods do not support debug symbols.</span></span>  
  
<a name="Version_Information"></a>
## <a name="version-information"></a><span data-ttu-id="2a093-177">Informations sur la version</span><span class="sxs-lookup"><span data-stu-id="2a093-177">Version Information</span></span>  
 <span data-ttu-id="2a093-178">À compter de .NET Framework 4, la stratégie de sécurité à l’échelle de l’ordinateur est supprimée et la transparence de sécurité devient le mécanisme d’application par défaut.</span><span class="sxs-lookup"><span data-stu-id="2a093-178">Starting with the .NET Framework 4, machine-wide security policy is eliminated and security transparency becomes the default enforcement mechanism.</span></span> <span data-ttu-id="2a093-179">Consultez [Changements en matière de sécurité](/previous-versions/dotnet/framework/security/security-changes).</span><span class="sxs-lookup"><span data-stu-id="2a093-179">See [Security Changes](/previous-versions/dotnet/framework/security/security-changes).</span></span>  
  
 <span data-ttu-id="2a093-180">À compter de .NET Framework 2.0 Service Pack 1, <xref:System.Security.Permissions.ReflectionPermission> avec l’indicateur <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> n’est plus nécessaire lors de l’émission d’assemblys et de méthodes dynamiques.</span><span class="sxs-lookup"><span data-stu-id="2a093-180">Starting with the .NET Framework 2.0 Service Pack 1, <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is no longer required when emitting dynamic assemblies and dynamic methods.</span></span> <span data-ttu-id="2a093-181">Cet indicateur est nécessaire dans toutes les versions antérieures du .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="2a093-181">This flag is required in all earlier versions of the .NET Framework.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="2a093-182"><xref:System.Security.Permissions.ReflectionPermission> avec l'indicateur <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> est inclus par défaut dans les jeux d'autorisations nommés `FullTrust` et `LocalIntranet`, mais pas dans le jeu d'autorisations `Internet`.</span><span class="sxs-lookup"><span data-stu-id="2a093-182"><xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit?displayProperty=nameWithType> flag is included by default in the `FullTrust` and `LocalIntranet` named permission sets, but not in the `Internet` permission set.</span></span> <span data-ttu-id="2a093-183">Par conséquent, dans les versions antérieures du .NET Framework, une bibliothèque peut être utilisée avec des autorisations Internet uniquement si elle exécute une méthode <xref:System.Security.PermissionSet.Assert%2A> pour <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span><span class="sxs-lookup"><span data-stu-id="2a093-183">Therefore, in earlier versions of the .NET Framework, a library can be used with Internet permissions only if it executes an <xref:System.Security.PermissionSet.Assert%2A> for <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>.</span></span> <span data-ttu-id="2a093-184">Ces bibliothèques nécessitent une revue minutieuse de la sécurité, car les erreurs de codage peuvent entraîner des failles de sécurité.</span><span class="sxs-lookup"><span data-stu-id="2a093-184">Such libraries require careful security review because coding errors could result in security holes.</span></span> <span data-ttu-id="2a093-185">.NET Framework 2.0 SP1 permet au code d’être émis dans des scénarios de confiance partielle sans émettre de demandes de sécurité, car la génération de code n’est pas fondamentalement une opération nécessitant des privilèges.</span><span class="sxs-lookup"><span data-stu-id="2a093-185">The .NET Framework 2.0 SP1 allows code to be emitted in partial trust scenarios without issuing any security demands, because generating code is not inherently a privileged operation.</span></span> <span data-ttu-id="2a093-186">Autrement dit, le code généré n'a pas plus d'autorisations que l'assembly qui l'émet.</span><span class="sxs-lookup"><span data-stu-id="2a093-186">That is, the generated code has no more permissions than the assembly that emits it.</span></span> <span data-ttu-id="2a093-187">Ceci permet aux bibliothèques qui émettent du code d'être transparentes de sécurité et supprime la nécessité de déclarer <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, ce qui simplifie l'écriture d'une bibliothèque sécurisée.</span><span class="sxs-lookup"><span data-stu-id="2a093-187">This allows libraries that emit code to be security transparent and removes the need to assert <xref:System.Security.Permissions.ReflectionPermissionFlag.ReflectionEmit>, which simplifies the task of writing a secure library.</span></span>  
  
 <span data-ttu-id="2a093-188">En outre, .NET Framework 2.0 SP1 introduit l’indicateur <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> pour accéder aux types et aux membres non publics à partir de méthodes dynamiques partiellement approuvées.</span><span class="sxs-lookup"><span data-stu-id="2a093-188">In addition, the .NET Framework 2.0 SP1 introduces the <xref:System.Security.Permissions.ReflectionPermissionFlag.RestrictedMemberAccess?displayProperty=nameWithType> flag for accessing nonpublic types and members from partially trusted dynamic methods.</span></span> <span data-ttu-id="2a093-189">Les versions antérieures du .NET Framework exigent l’indicateur <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> pour les méthodes dynamiques qui accèdent à des types et des membres non publics. Il s’agit d’une autorisation qui ne doit jamais être accordée à du code partiellement fiable.</span><span class="sxs-lookup"><span data-stu-id="2a093-189">Earlier versions of the .NET Framework require the <xref:System.Security.Permissions.ReflectionPermissionFlag.MemberAccess?displayProperty=nameWithType> flag for dynamic methods that access nonpublic types and members; this is a permission that should never be granted to partially trusted code.</span></span>  
  
 <span data-ttu-id="2a093-190">Pour finir, .NET Framework 2.0 SP1 introduit des méthodes hébergées anonymement.</span><span class="sxs-lookup"><span data-stu-id="2a093-190">Finally, the .NET Framework 2.0 SP1 introduces anonymously hosted methods.</span></span>  
  
### <a name="obtaining-information-on-types-and-members"></a><span data-ttu-id="2a093-191">Obtention d'informations sur les types et les membres</span><span class="sxs-lookup"><span data-stu-id="2a093-191">Obtaining Information on Types and Members</span></span>  
 <span data-ttu-id="2a093-192">Depuis .NET Framework 2.0, aucune autorisation n’est nécessaire pour obtenir des informations sur les types et les membres non publics.</span><span class="sxs-lookup"><span data-stu-id="2a093-192">Starting with the .NET Framework 2.0, no permissions are required to obtain information about nonpublic types and members.</span></span> <span data-ttu-id="2a093-193">La réflexion est utilisée pour obtenir les informations nécessaires à l'émission de méthodes dynamiques.</span><span class="sxs-lookup"><span data-stu-id="2a093-193">Reflection is used to obtain information needed to emit dynamic methods.</span></span> <span data-ttu-id="2a093-194">Par exemple, les objets <xref:System.Reflection.MethodInfo> sont utilisés pour émettre des appels de méthode.</span><span class="sxs-lookup"><span data-stu-id="2a093-194">For example, <xref:System.Reflection.MethodInfo> objects are used to emit method calls.</span></span> <span data-ttu-id="2a093-195">Les versions antérieures du .NET Framework exigent <xref:System.Security.Permissions.ReflectionPermission> avec l’indicateur <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="2a093-195">Earlier versions of the .NET Framework require <xref:System.Security.Permissions.ReflectionPermission> with the <xref:System.Security.Permissions.ReflectionPermissionFlag.TypeInformation?displayProperty=nameWithType> flag.</span></span> <span data-ttu-id="2a093-196">Pour plus d’informations, consultez [Considérations relatives à la sécurité de la réflexion](security-considerations-for-reflection.md).</span><span class="sxs-lookup"><span data-stu-id="2a093-196">For more information, see [Security Considerations for Reflection](security-considerations-for-reflection.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2a093-197">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2a093-197">See also</span></span>

- [<span data-ttu-id="2a093-198">Considérations sur la sécurité de la réflexion</span><span class="sxs-lookup"><span data-stu-id="2a093-198">Security Considerations for Reflection</span></span>](security-considerations-for-reflection.md)
- [<span data-ttu-id="2a093-199">Émission d’assemblys et de méthodes dynamiques</span><span class="sxs-lookup"><span data-stu-id="2a093-199">Emitting Dynamic Methods and Assemblies</span></span>](emitting-dynamic-methods-and-assemblies.md)

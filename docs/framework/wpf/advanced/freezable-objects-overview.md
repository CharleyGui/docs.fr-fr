---
title: Vue d'ensemble des objets Freezable
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- Freezable objects [WPF], description
- unfreezing Freezable objects [WPF]
- classes [WPF], Freezable
ms.assetid: 89c71692-4f43-4057-b611-67c6a8a863a2
ms.openlocfilehash: b1887afd19407898d8de1d92252e29778899fb89
ms.sourcegitcommit: 011314e0c8eb4cf4a11d92078f58176c8c3efd2d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/09/2020
ms.locfileid: "77095188"
---
# <a name="freezable-objects-overview"></a><span data-ttu-id="84bcc-102">Vue d'ensemble des objets Freezable</span><span class="sxs-lookup"><span data-stu-id="84bcc-102">Freezable Objects Overview</span></span>

<span data-ttu-id="84bcc-103">Cette rubrique explique comment utiliser et créer efficacement des objets <xref:System.Windows.Freezable>, qui fournissent des fonctionnalités spéciales qui peuvent aider à améliorer les performances de l’application.</span><span class="sxs-lookup"><span data-stu-id="84bcc-103">This topic describes how to effectively use and create <xref:System.Windows.Freezable> objects, which provide special features that can help improve application performance.</span></span> <span data-ttu-id="84bcc-104">Les pinceaux, les stylets, les transformations, les géométries et les animations sont des exemples d’objets Freezable.</span><span class="sxs-lookup"><span data-stu-id="84bcc-104">Examples of freezable objects include brushes, pens, transformations, geometries, and animations.</span></span>

<a name="whatisafreezable"></a>

## <a name="what-is-a-freezable"></a><span data-ttu-id="84bcc-105">Qu’est-ce qu’un Freezable ?</span><span class="sxs-lookup"><span data-stu-id="84bcc-105">What Is a Freezable?</span></span>

<span data-ttu-id="84bcc-106">Un <xref:System.Windows.Freezable> est un type spécial d’objet qui a deux États : non figé et figé.</span><span class="sxs-lookup"><span data-stu-id="84bcc-106">A <xref:System.Windows.Freezable> is a special type of object that has two states: unfrozen and frozen.</span></span> <span data-ttu-id="84bcc-107">Lorsqu’il est non figé, un <xref:System.Windows.Freezable> semble se comporter comme n’importe quel autre objet.</span><span class="sxs-lookup"><span data-stu-id="84bcc-107">When unfrozen, a <xref:System.Windows.Freezable> appears to behave like any other object.</span></span> <span data-ttu-id="84bcc-108">Lorsqu’il est figé, un <xref:System.Windows.Freezable> ne peut plus être modifié.</span><span class="sxs-lookup"><span data-stu-id="84bcc-108">When frozen, a <xref:System.Windows.Freezable> can no longer be modified.</span></span>

<span data-ttu-id="84bcc-109">Un <xref:System.Windows.Freezable> fournit un événement <xref:System.Windows.Freezable.Changed> pour notifier aux observateurs toute modification apportée à l’objet.</span><span class="sxs-lookup"><span data-stu-id="84bcc-109">A <xref:System.Windows.Freezable> provides a <xref:System.Windows.Freezable.Changed> event to notify observers of any modifications to the object.</span></span> <span data-ttu-id="84bcc-110">Le gel d’un <xref:System.Windows.Freezable> peut améliorer ses performances, car il n’a plus besoin de consacrer des ressources aux notifications de modification.</span><span class="sxs-lookup"><span data-stu-id="84bcc-110">Freezing a <xref:System.Windows.Freezable> can improve its performance, because it no longer needs to spend resources on change notifications.</span></span> <span data-ttu-id="84bcc-111">Un <xref:System.Windows.Freezable> figé peut également être partagé entre plusieurs threads, tandis qu’un <xref:System.Windows.Freezable> non figé ne peut pas.</span><span class="sxs-lookup"><span data-stu-id="84bcc-111">A frozen <xref:System.Windows.Freezable> can also be shared across threads, while an unfrozen <xref:System.Windows.Freezable> cannot.</span></span>

<span data-ttu-id="84bcc-112">Bien que la classe <xref:System.Windows.Freezable> possède de nombreuses applications, la plupart des objets <xref:System.Windows.Freezable> dans [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] sont liés au sous-système Graphics.</span><span class="sxs-lookup"><span data-stu-id="84bcc-112">Although the <xref:System.Windows.Freezable> class has many applications, most <xref:System.Windows.Freezable> objects in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] are related to the graphics sub-system.</span></span>

<span data-ttu-id="84bcc-113">La classe <xref:System.Windows.Freezable> facilite l’utilisation de certains objets système graphiques et peut aider à améliorer les performances de l’application.</span><span class="sxs-lookup"><span data-stu-id="84bcc-113">The <xref:System.Windows.Freezable> class makes it easier to use certain graphics system objects and can help improve application performance.</span></span> <span data-ttu-id="84bcc-114">Les exemples de types qui héritent de <xref:System.Windows.Freezable> incluent les classes <xref:System.Windows.Media.Brush>, <xref:System.Windows.Media.Transform>et <xref:System.Windows.Media.Geometry>.</span><span class="sxs-lookup"><span data-stu-id="84bcc-114">Examples of types that inherit from <xref:System.Windows.Freezable> include the <xref:System.Windows.Media.Brush>, <xref:System.Windows.Media.Transform>, and <xref:System.Windows.Media.Geometry> classes.</span></span> <span data-ttu-id="84bcc-115">Étant donné qu’ils contiennent des ressources non managées, le système doit surveiller ces objets pour y apporter des modifications, puis mettre à jour leurs ressources non managées correspondantes lorsqu’une modification est apportée à l’objet d’origine.</span><span class="sxs-lookup"><span data-stu-id="84bcc-115">Because they contain unmanaged resources, the system must monitor these objects for modifications, and then update their corresponding unmanaged resources when there is a change to the original object.</span></span> <span data-ttu-id="84bcc-116">Même si vous ne modifiez pas réellement un objet système Graphics, le système doit toujours consacrer certaines de ses ressources à la surveillance de l’objet, au cas où vous le modifieriez.</span><span class="sxs-lookup"><span data-stu-id="84bcc-116">Even if you don't actually modify a graphics system object, the system must still spend some of its resources monitoring the object, in case you do change it.</span></span>

<span data-ttu-id="84bcc-117">Par exemple, supposons que vous créez un <xref:System.Windows.Media.SolidColorBrush> pinceau et que vous l’utilisiez pour peindre l’arrière-plan d’un bouton.</span><span class="sxs-lookup"><span data-stu-id="84bcc-117">For example, suppose you create a <xref:System.Windows.Media.SolidColorBrush> brush and use it to paint the background of a button.</span></span>

[!code-csharp[freezablesample_procedural#FrozenExamplePart1](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#frozenexamplepart1)]
[!code-vb[freezablesample_procedural#FrozenExamplePart1](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#frozenexamplepart1)]

<span data-ttu-id="84bcc-118">Lorsque le bouton est rendu, le sous-système [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Graphics utilise les informations que vous avez fournies pour peindre un groupe de pixels afin de créer l’apparence d’un bouton.</span><span class="sxs-lookup"><span data-stu-id="84bcc-118">When the button is rendered, the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] graphics sub-system uses the information you provided to paint a group of pixels to create the appearance of a button.</span></span> <span data-ttu-id="84bcc-119">Bien que vous ayez utilisé un pinceau de couleur unie pour décrire comment le bouton doit être peint, votre pinceau de couleur unie ne fait pas réellement la peinture.</span><span class="sxs-lookup"><span data-stu-id="84bcc-119">Although you used a solid color brush to describe how the button should be painted, your solid color brush doesn't actually do the painting.</span></span> <span data-ttu-id="84bcc-120">Le système graphique génère des objets rapides et de bas niveau pour le bouton et le pinceau, et il s’agit des objets qui s’affichent réellement à l’écran.</span><span class="sxs-lookup"><span data-stu-id="84bcc-120">The graphics system generates fast, low-level objects for the button and the brush, and it is those objects that actually appear on the screen.</span></span>

<span data-ttu-id="84bcc-121">Si vous deviez modifier le pinceau, ces objets de bas niveau doivent être régénérés.</span><span class="sxs-lookup"><span data-stu-id="84bcc-121">If you were to modify the brush, those low-level objects would have to be regenerated.</span></span> <span data-ttu-id="84bcc-122">La classe Freezable permet à un pinceau de trouver ses objets de bas niveau et générés correspondants, et de les mettre à jour lorsqu’il change.</span><span class="sxs-lookup"><span data-stu-id="84bcc-122">The freezable class is what gives a brush the ability to find its corresponding generated, low-level objects and to update them when it changes.</span></span> <span data-ttu-id="84bcc-123">Lorsque cette fonctionnalité est activée, le pinceau est dit « non figé ».</span><span class="sxs-lookup"><span data-stu-id="84bcc-123">When this ability is enabled, the brush is said to be "unfrozen."</span></span>

<span data-ttu-id="84bcc-124">La méthode de <xref:System.Windows.Freezable.Freeze%2A> d’un Freezable vous permet de désactiver cette fonctionnalité de mise à jour automatique.</span><span class="sxs-lookup"><span data-stu-id="84bcc-124">A freezable's <xref:System.Windows.Freezable.Freeze%2A> method enables you to disable this self-updating ability.</span></span> <span data-ttu-id="84bcc-125">Vous pouvez utiliser cette méthode pour que le pinceau devienne « figé » ou non modifiable.</span><span class="sxs-lookup"><span data-stu-id="84bcc-125">You can use this method to make the brush become "frozen," or unmodifiable.</span></span>

> [!NOTE]
> <span data-ttu-id="84bcc-126">Tous les objets Freezable ne peuvent pas être figés.</span><span class="sxs-lookup"><span data-stu-id="84bcc-126">Not every Freezable object can be frozen.</span></span> <span data-ttu-id="84bcc-127">Pour éviter de lever une <xref:System.InvalidOperationException>, vérifiez la valeur de la propriété <xref:System.Windows.Freezable.CanFreeze%2A> de l’objet Freezable pour déterminer s’il peut être figé avant d’essayer de le geler.</span><span class="sxs-lookup"><span data-stu-id="84bcc-127">To avoid throwing an <xref:System.InvalidOperationException>, check the value of the Freezable object's <xref:System.Windows.Freezable.CanFreeze%2A> property to determine whether it can be frozen before attempting to freeze it.</span></span>

[!code-csharp[freezablesample_procedural#FrozenExamplePart2](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#frozenexamplepart2)]
[!code-vb[freezablesample_procedural#FrozenExamplePart2](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#frozenexamplepart2)]

<span data-ttu-id="84bcc-128">Lorsque vous n’avez plus besoin de modifier un Freezable, le gel offre des avantages en matière de performances.</span><span class="sxs-lookup"><span data-stu-id="84bcc-128">When you no longer need to modify a freezable, freezing it provides performance benefits.</span></span> <span data-ttu-id="84bcc-129">Si vous deviez figer le pinceau dans cet exemple, le système graphique n’aurait plus besoin de le surveiller pour les modifications.</span><span class="sxs-lookup"><span data-stu-id="84bcc-129">If you were to freeze the brush in this example, the graphics system would no longer need to monitor it for changes.</span></span> <span data-ttu-id="84bcc-130">Le système graphique peut également effectuer d’autres optimisations, car il sait que le pinceau ne changera pas.</span><span class="sxs-lookup"><span data-stu-id="84bcc-130">The graphics system can also make other optimizations, because it knows the brush won't change.</span></span>

> [!NOTE]
> <span data-ttu-id="84bcc-131">Pour plus de commodité, les objets Freezable restent non figés, sauf si vous les figez explicitement.</span><span class="sxs-lookup"><span data-stu-id="84bcc-131">For convenience, freezable objects remain unfrozen unless you explicitly freeze them.</span></span>

<a name="frozenfreezables"></a>

## <a name="using-freezables"></a><span data-ttu-id="84bcc-132">Utilisation de Freezables</span><span class="sxs-lookup"><span data-stu-id="84bcc-132">Using Freezables</span></span>

<span data-ttu-id="84bcc-133">L’utilisation d’un Freezable non figé est semblable à l’utilisation d’un autre type d’objet.</span><span class="sxs-lookup"><span data-stu-id="84bcc-133">Using an unfrozen freezable is like using any other type of object.</span></span> <span data-ttu-id="84bcc-134">Dans l’exemple suivant, la couleur d’un <xref:System.Windows.Media.SolidColorBrush> passe du jaune au rouge après qu’il a été utilisé pour peindre l’arrière-plan d’un bouton.</span><span class="sxs-lookup"><span data-stu-id="84bcc-134">In the following example, the color of a <xref:System.Windows.Media.SolidColorBrush> is changed from yellow to red after it's used to paint the background of a button.</span></span> <span data-ttu-id="84bcc-135">Le système graphique fonctionne en arrière-plan pour changer automatiquement le bouton du jaune en rouge lors de la prochaine actualisation de l’écran.</span><span class="sxs-lookup"><span data-stu-id="84bcc-135">The graphics system works behind the scenes to automatically change the button from yellow to red the next time the screen is refreshed.</span></span>

[!code-csharp[freezablesample_procedural#UnFrozenExampleShort](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#unfrozenexampleshort)]
[!code-vb[freezablesample_procedural#UnFrozenExampleShort](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#unfrozenexampleshort)]

### <a name="freezing-a-freezable"></a><span data-ttu-id="84bcc-136">Figer un Freezable</span><span class="sxs-lookup"><span data-stu-id="84bcc-136">Freezing a Freezable</span></span>

<span data-ttu-id="84bcc-137">Pour rendre un <xref:System.Windows.Freezable> non modifiable, vous devez appeler sa méthode <xref:System.Windows.Freezable.Freeze%2A>.</span><span class="sxs-lookup"><span data-stu-id="84bcc-137">To make a <xref:System.Windows.Freezable> unmodifiable, you call its <xref:System.Windows.Freezable.Freeze%2A> method.</span></span> <span data-ttu-id="84bcc-138">Quand vous figez un objet qui contient des objets Freezable, ces objets sont également figés.</span><span class="sxs-lookup"><span data-stu-id="84bcc-138">When you freeze an object that contains freezable objects, those objects are frozen as well.</span></span> <span data-ttu-id="84bcc-139">Par exemple, si vous figez un <xref:System.Windows.Media.PathGeometry>, les figures et les segments qu’il contient seraient également figés.</span><span class="sxs-lookup"><span data-stu-id="84bcc-139">For example, if you freeze a <xref:System.Windows.Media.PathGeometry>, the figures and segments it contains would be frozen too.</span></span>

<span data-ttu-id="84bcc-140">Un Freezable **ne peut pas** être figé si l’une des conditions suivantes est vraie :</span><span class="sxs-lookup"><span data-stu-id="84bcc-140">A Freezable **can't** be frozen if any of the following are true:</span></span>

- <span data-ttu-id="84bcc-141">Il a des propriétés animées ou liées aux données.</span><span class="sxs-lookup"><span data-stu-id="84bcc-141">It has animated or data bound properties.</span></span>

- <span data-ttu-id="84bcc-142">Ses propriétés sont définies par une ressource dynamique.</span><span class="sxs-lookup"><span data-stu-id="84bcc-142">It has properties set by a dynamic resource.</span></span> <span data-ttu-id="84bcc-143">(Pour plus d’informations sur les ressources dynamiques, consultez les [ressources XAML](../../../desktop-wpf/fundamentals/xaml-resources-define.md) .)</span><span class="sxs-lookup"><span data-stu-id="84bcc-143">(See the [XAML Resources](../../../desktop-wpf/fundamentals/xaml-resources-define.md) for more information about dynamic resources.)</span></span>

- <span data-ttu-id="84bcc-144">Il contient <xref:System.Windows.Freezable> sous-objets qui ne peuvent pas être figés.</span><span class="sxs-lookup"><span data-stu-id="84bcc-144">It contains <xref:System.Windows.Freezable> sub-objects that can't be frozen.</span></span>

<span data-ttu-id="84bcc-145">Si ces conditions ont la valeur false et que vous n’envisagez pas de modifier le <xref:System.Windows.Freezable>, vous devez le geler pour bénéficier des avantages en matière de performances décrits précédemment.</span><span class="sxs-lookup"><span data-stu-id="84bcc-145">If these conditions are false, and you don't intend to modify the <xref:System.Windows.Freezable>, then you should freeze it to gain the performance benefits described earlier.</span></span>

<span data-ttu-id="84bcc-146">Une fois que vous appelez la méthode <xref:System.Windows.Freezable.Freeze%2A> d’un Freezable, elle ne peut plus être modifiée.</span><span class="sxs-lookup"><span data-stu-id="84bcc-146">Once you call a freezable's <xref:System.Windows.Freezable.Freeze%2A> method, it can no longer be modified.</span></span> <span data-ttu-id="84bcc-147">Toute tentative de modification d’un objet figé provoque la levée d’une <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="84bcc-147">Attempting to modify a frozen object causes an <xref:System.InvalidOperationException> to be thrown.</span></span> <span data-ttu-id="84bcc-148">Le code suivant lève une exception, car nous tentons de modifier le pinceau après qu’il a été figé.</span><span class="sxs-lookup"><span data-stu-id="84bcc-148">The following code throws an exception, because we attempt to modify the brush after it's been frozen.</span></span>

[!code-csharp[freezablesample_procedural#ExceptionExample](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#exceptionexample)]
[!code-vb[freezablesample_procedural#ExceptionExample](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#exceptionexample)]

<span data-ttu-id="84bcc-149">Pour éviter de lever cette exception, vous pouvez utiliser la méthode <xref:System.Windows.Freezable.IsFrozen%2A> pour déterminer si un <xref:System.Windows.Freezable> est figé.</span><span class="sxs-lookup"><span data-stu-id="84bcc-149">To avoid throwing this exception, you can use the <xref:System.Windows.Freezable.IsFrozen%2A> method to determine whether a <xref:System.Windows.Freezable> is frozen.</span></span>

[!code-csharp[freezablesample_procedural#CheckIsFrozenExample](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#checkisfrozenexample)]
[!code-vb[freezablesample_procedural#CheckIsFrozenExample](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#checkisfrozenexample)]

<span data-ttu-id="84bcc-150">Dans l’exemple de code précédent, une copie modifiable a été effectuée d’un objet figé à l’aide de la méthode <xref:System.Windows.Freezable.Clone%2A>.</span><span class="sxs-lookup"><span data-stu-id="84bcc-150">In the preceding code example, a modifiable copy was made of a frozen object using the <xref:System.Windows.Freezable.Clone%2A> method.</span></span> <span data-ttu-id="84bcc-151">La section suivante décrit le clonage plus en détail.</span><span class="sxs-lookup"><span data-stu-id="84bcc-151">The next section discusses cloning in more detail.</span></span>

> [!NOTE]
> <span data-ttu-id="84bcc-152">Comme un Freezable figé ne peut pas être animé, le système d’animation crée automatiquement des clones modifiables d’objets <xref:System.Windows.Freezable> figés quand vous essayez de les animer avec une <xref:System.Windows.Media.Animation.Storyboard>.</span><span class="sxs-lookup"><span data-stu-id="84bcc-152">Because a frozen freezable cannot be animated, the animation system will automatically create modifiable clones of frozen <xref:System.Windows.Freezable> objects when you try to animate them with a <xref:System.Windows.Media.Animation.Storyboard>.</span></span> <span data-ttu-id="84bcc-153">Pour éliminer la surcharge de performances causée par le clonage, laissez un objet non figé si vous envisagez de l’animer.</span><span class="sxs-lookup"><span data-stu-id="84bcc-153">To eliminate the performance overhead caused by cloning, leave an object unfrozen if you intend to animate it.</span></span> <span data-ttu-id="84bcc-154">Pour plus d’informations sur l’animation avec les storyboards, consultez [vue d’ensemble des storyboards](../graphics-multimedia/storyboards-overview.md).</span><span class="sxs-lookup"><span data-stu-id="84bcc-154">For more information about animating with storyboards, see the [Storyboards Overview](../graphics-multimedia/storyboards-overview.md).</span></span>

### <a name="freezing-from-markup"></a><span data-ttu-id="84bcc-155">Figer à partir du balisage</span><span class="sxs-lookup"><span data-stu-id="84bcc-155">Freezing from Markup</span></span>

<span data-ttu-id="84bcc-156">Pour figer un objet <xref:System.Windows.Freezable> déclaré dans le balisage, vous utilisez l’attribut `PresentationOptions:Freeze`.</span><span class="sxs-lookup"><span data-stu-id="84bcc-156">To freeze a <xref:System.Windows.Freezable> object declared in markup, you use the `PresentationOptions:Freeze` attribute.</span></span> <span data-ttu-id="84bcc-157">Dans l’exemple suivant, un <xref:System.Windows.Media.SolidColorBrush> est déclaré en tant que ressource de page et figé.</span><span class="sxs-lookup"><span data-stu-id="84bcc-157">In the following example, a <xref:System.Windows.Media.SolidColorBrush> is declared as a page resource and frozen.</span></span> <span data-ttu-id="84bcc-158">Elle est ensuite utilisée pour définir l’arrière-plan d’un bouton.</span><span class="sxs-lookup"><span data-stu-id="84bcc-158">It is then used to set the background of a button.</span></span>

[!code-xaml[FreezableSample#FreezeFromMarkupWholePage](~/samples/snippets/csharp/VS_Snippets_Wpf/FreezableSample/CS/FreezeFromMarkupExample.xaml#freezefrommarkupwholepage)]

<span data-ttu-id="84bcc-159">Pour utiliser l’attribut `Freeze`, vous devez mapper à l’espace de noms options de présentation : `http://schemas.microsoft.com/winfx/2006/xaml/presentation/options`.</span><span class="sxs-lookup"><span data-stu-id="84bcc-159">To use the `Freeze` attribute, you must map to the presentation options namespace: `http://schemas.microsoft.com/winfx/2006/xaml/presentation/options`.</span></span> <span data-ttu-id="84bcc-160">`PresentationOptions` est le préfixe recommandé pour le mappage de cet espace de noms :</span><span class="sxs-lookup"><span data-stu-id="84bcc-160">`PresentationOptions` is the recommended prefix for mapping this namespace:</span></span>

```xaml
xmlns:PresentationOptions="http://schemas.microsoft.com/winfx/2006/xaml/presentation/options"
```

<span data-ttu-id="84bcc-161">Étant donné que tous les lecteurs XAML ne reconnaissent pas cet attribut, il est recommandé d’utiliser l' [attribut MC : Ignorable](mc-ignorable-attribute.md) pour marquer l’attribut `Presentation:Freeze` comme étant pouvant être ignoré :</span><span class="sxs-lookup"><span data-stu-id="84bcc-161">Because not all XAML readers recognize this attribute, it's recommended that you use the [mc:Ignorable Attribute](mc-ignorable-attribute.md) to mark the `Presentation:Freeze` attribute as ignorable:</span></span>

```xaml
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
mc:Ignorable="PresentationOptions"
```

<span data-ttu-id="84bcc-162">Pour plus d’informations, consultez la page de l' [attribut MC : Ignorable](mc-ignorable-attribute.md) .</span><span class="sxs-lookup"><span data-stu-id="84bcc-162">For more information, see the [mc:Ignorable Attribute](mc-ignorable-attribute.md) page.</span></span>

### <a name="unfreezing-a-freezable"></a><span data-ttu-id="84bcc-163">« Libération » d’un Freezable</span><span class="sxs-lookup"><span data-stu-id="84bcc-163">"Unfreezing" a Freezable</span></span>

<span data-ttu-id="84bcc-164">Une fois figée, un <xref:System.Windows.Freezable> ne peut jamais être modifié ou non figé ; Toutefois, vous pouvez créer un clone non figé à l’aide de la méthode <xref:System.Windows.Freezable.Clone%2A> ou <xref:System.Windows.Freezable.CloneCurrentValue%2A>.</span><span class="sxs-lookup"><span data-stu-id="84bcc-164">Once frozen, a <xref:System.Windows.Freezable> can never be modified or unfrozen; however, you can create an unfrozen clone using the <xref:System.Windows.Freezable.Clone%2A> or <xref:System.Windows.Freezable.CloneCurrentValue%2A> method.</span></span>

<span data-ttu-id="84bcc-165">Dans l’exemple suivant, l’arrière-plan du bouton est défini avec un pinceau et ce pinceau est alors figé.</span><span class="sxs-lookup"><span data-stu-id="84bcc-165">In the following example, the button's background is set with a brush and that brush is then frozen.</span></span> <span data-ttu-id="84bcc-166">Une copie non figée est faite du pinceau à l’aide de la méthode <xref:System.Windows.Freezable.Clone%2A>.</span><span class="sxs-lookup"><span data-stu-id="84bcc-166">An unfrozen copy is made of the brush using the <xref:System.Windows.Freezable.Clone%2A> method.</span></span> <span data-ttu-id="84bcc-167">Le clone est modifié et utilisé pour changer l’arrière-plan du bouton du jaune au rouge.</span><span class="sxs-lookup"><span data-stu-id="84bcc-167">The clone is modified and used to change the button's background from yellow to red.</span></span>

[!code-csharp[freezablesample_procedural#CloneExample](~/samples/snippets/csharp/VS_Snippets_Wpf/freezablesample_procedural/CSharp/freezablesample.cs#cloneexample)]
[!code-vb[freezablesample_procedural#CloneExample](~/samples/snippets/visualbasic/VS_Snippets_Wpf/freezablesample_procedural/visualbasic/freezablesample.vb#cloneexample)]

> [!NOTE]
> <span data-ttu-id="84bcc-168">Quelle que soit la méthode de clonage que vous utilisez, les animations ne sont jamais copiées dans le nouveau <xref:System.Windows.Freezable>.</span><span class="sxs-lookup"><span data-stu-id="84bcc-168">Regardless of which clone method you use, animations are never copied to the new <xref:System.Windows.Freezable>.</span></span>

<span data-ttu-id="84bcc-169">Les méthodes <xref:System.Windows.Freezable.Clone%2A> et <xref:System.Windows.Freezable.CloneCurrentValue%2A> produisent des copies complètes du Freezable.</span><span class="sxs-lookup"><span data-stu-id="84bcc-169">The <xref:System.Windows.Freezable.Clone%2A> and <xref:System.Windows.Freezable.CloneCurrentValue%2A> methods produce deep copies of the freezable.</span></span> <span data-ttu-id="84bcc-170">Si le Freezable contient d’autres objets Freezable figés, ils sont également clonés et rendus modifiables.</span><span class="sxs-lookup"><span data-stu-id="84bcc-170">If the freezable contains other frozen freezable objects, they are also cloned and made modifiable.</span></span> <span data-ttu-id="84bcc-171">Par exemple, si vous clonez un <xref:System.Windows.Media.PathGeometry> figé pour le rendre modifiable, les figures et les segments qu’il contient sont également copiés et rendus modifiables.</span><span class="sxs-lookup"><span data-stu-id="84bcc-171">For example, if you clone a frozen <xref:System.Windows.Media.PathGeometry> to make it modifiable, the figures and segments it contains are also copied and made modifiable.</span></span>

<a name="createyourownfreezableclass"></a>

## <a name="creating-your-own-freezable-class"></a><span data-ttu-id="84bcc-172">Création de votre propre classe Freezable</span><span class="sxs-lookup"><span data-stu-id="84bcc-172">Creating Your Own Freezable Class</span></span>

<span data-ttu-id="84bcc-173">Une classe qui dérive de <xref:System.Windows.Freezable> obtient les fonctionnalités suivantes.</span><span class="sxs-lookup"><span data-stu-id="84bcc-173">A class that derives from <xref:System.Windows.Freezable> gains the following features.</span></span>

- <span data-ttu-id="84bcc-174">États spéciaux : un État en lecture seule (figé) et un état accessible en écriture.</span><span class="sxs-lookup"><span data-stu-id="84bcc-174">Special states: a read-only (frozen) and a writable state.</span></span>

- <span data-ttu-id="84bcc-175">Sécurité des threads : les <xref:System.Windows.Freezable> figées peuvent être partagées entre les threads.</span><span class="sxs-lookup"><span data-stu-id="84bcc-175">Thread safety: a frozen <xref:System.Windows.Freezable> can be shared across threads.</span></span>

- <span data-ttu-id="84bcc-176">Notification de modification détaillée : contrairement à d’autres <xref:System.Windows.DependencyObject>, les objets Freezable fournissent des notifications de modification lorsque les valeurs de sous-propriétés changent.</span><span class="sxs-lookup"><span data-stu-id="84bcc-176">Detailed change notification: Unlike other <xref:System.Windows.DependencyObject>s, Freezable objects provide change notifications when sub-property values change.</span></span>

- <span data-ttu-id="84bcc-177">Clonage facile : la classe Freezable a déjà implémenté plusieurs méthodes qui produisent des clones profonds.</span><span class="sxs-lookup"><span data-stu-id="84bcc-177">Easy cloning: the Freezable class has already implemented several methods that produce deep clones.</span></span>

<span data-ttu-id="84bcc-178">Un <xref:System.Windows.Freezable> est un type de <xref:System.Windows.DependencyObject>et, par conséquent, utilise le système de propriétés de dépendance.</span><span class="sxs-lookup"><span data-stu-id="84bcc-178">A <xref:System.Windows.Freezable> is a type of <xref:System.Windows.DependencyObject>, and therefore uses the dependency property system.</span></span> <span data-ttu-id="84bcc-179">Vos propriétés de classe n’ont pas besoin d’être des propriétés de dépendance, mais l’utilisation de propriétés de dépendance réduit la quantité de code que vous devez écrire, car la classe <xref:System.Windows.Freezable> a été conçue avec les propriétés de dépendance à l’esprit.</span><span class="sxs-lookup"><span data-stu-id="84bcc-179">Your class properties don't have to be dependency properties, but using dependency properties will reduce the amount of code you have to write, because the <xref:System.Windows.Freezable> class was designed with dependency properties in mind.</span></span> <span data-ttu-id="84bcc-180">Pour plus d’informations sur le système de propriétés de dépendance, consultez [vue d’ensemble des propriétés de dépendance](dependency-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="84bcc-180">For more information about the dependency property system, see the [Dependency Properties Overview](dependency-properties-overview.md).</span></span>

<span data-ttu-id="84bcc-181">Chaque sous-classe <xref:System.Windows.Freezable> doit substituer la méthode <xref:System.Windows.Freezable.CreateInstanceCore%2A>.</span><span class="sxs-lookup"><span data-stu-id="84bcc-181">Every <xref:System.Windows.Freezable> subclass must override the <xref:System.Windows.Freezable.CreateInstanceCore%2A> method.</span></span> <span data-ttu-id="84bcc-182">Si votre classe utilise des propriétés de dépendance pour toutes ses données, vous avez terminé.</span><span class="sxs-lookup"><span data-stu-id="84bcc-182">If your class uses dependency properties for all its data, you're finished.</span></span>

<span data-ttu-id="84bcc-183">Si votre classe contient des membres de données de propriété de non dépendance, vous devez également substituer les méthodes suivantes :</span><span class="sxs-lookup"><span data-stu-id="84bcc-183">If your class contains non-dependency property data members, you must also override the following methods:</span></span>

- <xref:System.Windows.Freezable.CloneCore%2A>

- <xref:System.Windows.Freezable.CloneCurrentValueCore%2A>

- <xref:System.Windows.Freezable.GetAsFrozenCore%2A>

- <xref:System.Windows.Freezable.GetCurrentValueAsFrozenCore%2A>

- <xref:System.Windows.Freezable.FreezeCore%2A>

<span data-ttu-id="84bcc-184">Vous devez également respecter les règles suivantes pour l’accès et l’écriture aux membres de données qui ne sont pas des propriétés de dépendance :</span><span class="sxs-lookup"><span data-stu-id="84bcc-184">You must also observe the following rules for accessing and writing to data members that are not dependency properties:</span></span>

- <span data-ttu-id="84bcc-185">Au début de toute API qui lit les données membres de propriété de non dépendance, appelez la méthode <xref:System.Windows.Freezable.ReadPreamble%2A>.</span><span class="sxs-lookup"><span data-stu-id="84bcc-185">At the beginning of any API that reads non-dependency property data members, call the <xref:System.Windows.Freezable.ReadPreamble%2A> method.</span></span>

- <span data-ttu-id="84bcc-186">Au début de toute API qui écrit des membres de données de propriété de non dépendance, appelez la méthode <xref:System.Windows.Freezable.WritePreamble%2A>.</span><span class="sxs-lookup"><span data-stu-id="84bcc-186">At the beginning of any API that writes non-dependency property data members, call the <xref:System.Windows.Freezable.WritePreamble%2A> method.</span></span> <span data-ttu-id="84bcc-187">(Une fois que vous avez appelé <xref:System.Windows.Freezable.WritePreamble%2A> dans une API, vous n’avez pas besoin d’effectuer un appel supplémentaire à <xref:System.Windows.Freezable.ReadPreamble%2A> si vous lisez également des membres de données de propriété de non dépendance.)</span><span class="sxs-lookup"><span data-stu-id="84bcc-187">(Once you've called <xref:System.Windows.Freezable.WritePreamble%2A> in an API, you don't need to make an additional call to <xref:System.Windows.Freezable.ReadPreamble%2A> if you also read non-dependency property data members.)</span></span>

- <span data-ttu-id="84bcc-188">Appelez la méthode <xref:System.Windows.Freezable.WritePostscript%2A> avant de quitter les méthodes qui écrivent dans les membres de données de propriété de non dépendance.</span><span class="sxs-lookup"><span data-stu-id="84bcc-188">Call the <xref:System.Windows.Freezable.WritePostscript%2A> method before exiting methods that write to non-dependency property data members.</span></span>

<span data-ttu-id="84bcc-189">Si votre classe contient des membres de données de propriété non-dépendance qui sont des objets <xref:System.Windows.DependencyObject>, vous devez également appeler la méthode <xref:System.Windows.Freezable.OnFreezablePropertyChanged%2A> chaque fois que vous modifiez l’une de leurs valeurs, même si vous définissez le membre sur `null`.</span><span class="sxs-lookup"><span data-stu-id="84bcc-189">If your class contains non-dependency-property data members that are <xref:System.Windows.DependencyObject> objects, you must also call the <xref:System.Windows.Freezable.OnFreezablePropertyChanged%2A> method each time you change one of their values, even if you're setting the member to `null`.</span></span>

> [!NOTE]
> <span data-ttu-id="84bcc-190">Il est très important de commencer chaque méthode <xref:System.Windows.Freezable> que vous remplacez par un appel à l’implémentation de base.</span><span class="sxs-lookup"><span data-stu-id="84bcc-190">It's very important that you begin each <xref:System.Windows.Freezable> method you override with a call to the base implementation.</span></span>

<span data-ttu-id="84bcc-191">Pour obtenir un exemple de classe de <xref:System.Windows.Freezable> personnalisée, consultez l' [exemple animation personnalisée](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation).</span><span class="sxs-lookup"><span data-stu-id="84bcc-191">For an example of a custom <xref:System.Windows.Freezable> class, see the [Custom Animation Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation).</span></span>

## <a name="see-also"></a><span data-ttu-id="84bcc-192">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="84bcc-192">See also</span></span>

- <xref:System.Windows.Freezable>
- [<span data-ttu-id="84bcc-193">Exemple d’animation personnalisée</span><span class="sxs-lookup"><span data-stu-id="84bcc-193">Custom Animation Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)
- [<span data-ttu-id="84bcc-194">Vue d’ensemble des propriétés de dépendance</span><span class="sxs-lookup"><span data-stu-id="84bcc-194">Dependency Properties Overview</span></span>](dependency-properties-overview.md)
- [<span data-ttu-id="84bcc-195">Propriétés de dépendance personnalisées</span><span class="sxs-lookup"><span data-stu-id="84bcc-195">Custom Dependency Properties</span></span>](custom-dependency-properties.md)

---
title: Architecture de WPF
ms.date: 03/30/2017
helpviewer_keywords:
- properties [WPF], attached
- attached properties [WPF]
- architecture [WPF]
- unmanaged components [WPF]
- affinity thread [WPF]
- Storyboards [WPF]
- milcore [WPF]
- components [WPF], unmanaged
- painter's algorithm
- interfaces [WPF], INotifyPropertyChange
- CommandBindings [WPF]
- data templates [WPF]
- thread [WPF], affinity
ms.assetid: 8579c10b-76ab-4c52-9691-195ce02333c8
ms.openlocfilehash: c214cb39bf51dad2aafe4ec0c9050f355db5b2c5
ms.sourcegitcommit: 09d699aca28ae9723399bbd9d3d44aa0cbd3848d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/19/2019
ms.locfileid: "68331673"
---
# <a name="wpf-architecture"></a><span data-ttu-id="38b18-102">Architecture de WPF</span><span class="sxs-lookup"><span data-stu-id="38b18-102">WPF Architecture</span></span>
<span data-ttu-id="38b18-103">Cette rubrique fournit une visite guidée de la hiérarchie de classes Windows Presentation Foundation (WPF).</span><span class="sxs-lookup"><span data-stu-id="38b18-103">This topic provides a guided tour of the Windows Presentation Foundation (WPF) class hierarchy.</span></span> <span data-ttu-id="38b18-104">Elle couvre la plupart des principaux sous-systèmes de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] et décrit leur mode d’interaction.</span><span class="sxs-lookup"><span data-stu-id="38b18-104">It covers most of the major subsystems of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], and describes how they interact.</span></span> <span data-ttu-id="38b18-105">Elle passe également en revue certains choix opérés par les architectes de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="38b18-105">It also details some of the choices made by the architects of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span>  

<a name="System_Object"></a>   
## <a name="systemobject"></a><span data-ttu-id="38b18-106">System.Object</span><span class="sxs-lookup"><span data-stu-id="38b18-106">System.Object</span></span>  
 <span data-ttu-id="38b18-107">Le modèle de programmation [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] principal est exposé par le biais de code managé.</span><span class="sxs-lookup"><span data-stu-id="38b18-107">The primary [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] programming model is exposed through managed code.</span></span> <span data-ttu-id="38b18-108">Au début de la phase de conception de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], l’une des questions que se posaient les architectes était de savoir où placer la limite entre les composants managés du système et les composants non managés.</span><span class="sxs-lookup"><span data-stu-id="38b18-108">Early in the design phase of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] there were a number of debates about where the line should be drawn between the managed components of the system and the unmanaged ones.</span></span> <span data-ttu-id="38b18-109">Le [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] fournit un ensemble de fonctionnalités qui rendent le développement plus productif et robuste (notamment la gestion de la mémoire, la gestion des erreurs, le système de type commun ou CTS, etc.), mais ces fonctionnalités ne sont pas sans coût.</span><span class="sxs-lookup"><span data-stu-id="38b18-109">The [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] provides a number of features that make development more productive and robust (including memory management, error handling, common type system, etc.) but they come at a cost.</span></span>  
  
 <span data-ttu-id="38b18-110">Les principaux composants de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] sont illustrés dans la figure ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="38b18-110">The major components of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] are illustrated in the figure below.</span></span> <span data-ttu-id="38b18-111">Les sections rouges du diagramme (PresentationFramework, PresentationCore et milcore) correspondent aux parties principales du code de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="38b18-111">The red sections of the diagram (PresentationFramework, PresentationCore, and milcore) are the major code portions of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="38b18-112">Parmi celles-ci, milcore est le seul composant non managé.</span><span class="sxs-lookup"><span data-stu-id="38b18-112">Of these, only one is an unmanaged component – milcore.</span></span> <span data-ttu-id="38b18-113">Milcore est écrit en code non managé pour permettre une intégration étroite avec [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)].</span><span class="sxs-lookup"><span data-stu-id="38b18-113">Milcore is written in unmanaged code in order to enable tight integration with [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)].</span></span> <span data-ttu-id="38b18-114">Tout l’affichage dans [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] s’effectue via le moteur [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] pour optimiser le rendu matériel et logiciel.</span><span class="sxs-lookup"><span data-stu-id="38b18-114">All display in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is done through the [!INCLUDE[TLA2#tla_dx](../../../../includes/tla2sharptla-dx-md.md)] engine, allowing for efficient hardware and software rendering.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="38b18-115">nécessitait également un contrôle précis de la mémoire et de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="38b18-115">also required fine control over memory and execution.</span></span> <span data-ttu-id="38b18-116">Le moteur de composition dans milcore est extrêmement dépendant des performances. Pour améliorer les performances, il fallait donc renoncer à de nombreux avantages de [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="38b18-116">The composition engine in milcore is extremely performance sensitive, and required giving up many advantages of the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] to gain performance.</span></span>  
  
 <span data-ttu-id="38b18-117">![Position de WPF dans le .NET Framework.](./media/wpf-architect1.PNG "wpf_architect1")</span><span class="sxs-lookup"><span data-stu-id="38b18-117">![The position of WPF within the .NET Framework.](./media/wpf-architect1.PNG "wpf_architect1")</span></span>  
  
 <span data-ttu-id="38b18-118">La communication entre les parties managées et non managées de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] est présentée plus loin dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="38b18-118">Communication between the managed and unmanaged portions of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is discussed later in this topic.</span></span> <span data-ttu-id="38b18-119">Les autres aspects du modèle de programmation managé sont décrits ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="38b18-119">The remainder of the managed programming model is described below.</span></span>  
  
<a name="System_Threading_DispatcherObject"></a>   
## <a name="systemthreadingdispatcherobject"></a><span data-ttu-id="38b18-120">System.Threading.DispatcherObject</span><span class="sxs-lookup"><span data-stu-id="38b18-120">System.Threading.DispatcherObject</span></span>  
 <span data-ttu-id="38b18-121">La plupart des [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] objets dans <xref:System.Windows.Threading.DispatcherObject>dérivent de, qui fournit les constructions de base pour gérer l’accès concurrentiel et le Threading.</span><span class="sxs-lookup"><span data-stu-id="38b18-121">Most objects in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] derive from <xref:System.Windows.Threading.DispatcherObject>, which provides the basic constructs for dealing with concurrency and threading.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="38b18-122">est basé sur un système de messagerie implémenté par le répartiteur.</span><span class="sxs-lookup"><span data-stu-id="38b18-122">is based on a messaging system implemented by the dispatcher.</span></span> <span data-ttu-id="38b18-123">Le principe de fonctionnement est similaire à celui de la pompe de messages [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] : le répartiteur [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] utilise des messages User32 pour effectuer des appels entre les threads.</span><span class="sxs-lookup"><span data-stu-id="38b18-123">This works much like the familiar [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] message pump; in fact, the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dispatcher uses User32 messages for performing cross thread calls.</span></span>  
  
 <span data-ttu-id="38b18-124">ll existe en fait deux concepts fondamentaux à comprendre au sujet de la concurrence dans [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] : le répartiteur et l’affinité de thread.</span><span class="sxs-lookup"><span data-stu-id="38b18-124">There are really two core concepts to understand when discussing concurrency in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – the dispatcher and thread affinity.</span></span>  
  
 <span data-ttu-id="38b18-125">Pendant la phase de conception de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], l’objectif était de passer à un modèle avec un seul thread d’exécution, mais sans affinité de thread.</span><span class="sxs-lookup"><span data-stu-id="38b18-125">During the design phase of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the goal was to move to a single thread of execution, but a non-thread "affinitized" model.</span></span> <span data-ttu-id="38b18-126">L’affinité de thread intervient quand un composant utilise l’identité du thread d’exécution pour stocker un type d’état.</span><span class="sxs-lookup"><span data-stu-id="38b18-126">Thread affinity happens when a component uses the identity of the executing thread to store some type of state.</span></span> <span data-ttu-id="38b18-127">Sa forme la plus courante est l’utilisation du stockage local des threads (TLS) pour stocker l’état.</span><span class="sxs-lookup"><span data-stu-id="38b18-127">The most common form of this is to use the thread local store (TLS) to store state.</span></span> <span data-ttu-id="38b18-128">L’affinité de thread nécessite que chaque thread logique d’exécution soit détenu par un seul thread physique dans le système d’exploitation, susceptible d’utiliser beaucoup de mémoire.</span><span class="sxs-lookup"><span data-stu-id="38b18-128">Thread affinity requires that each logical thread of execution be owned by only one physical thread in the operating system, which can become memory intensive.</span></span> <span data-ttu-id="38b18-129">Au final, les architectes ont opté pour un modèle de thread WPF semblable au modèle de thread User32 existant, basé sur un seul thread d’exécution avec affinité de thread.</span><span class="sxs-lookup"><span data-stu-id="38b18-129">In the end, WPF’s threading model was kept in sync with the existing User32 threading model of single threaded execution with thread affinity.</span></span> <span data-ttu-id="38b18-130">Ce choix a été principalement motivé par les besoins d’interopérabilité, du fait que des systèmes comme [!INCLUDE[TLA2#tla_ole2.0](../../../../includes/tla2sharptla-ole2-0-md.md)], le Presse-papiers et Internet Explorer utilisent tous le modèle d’exécution STA (Single Thread Affinity).</span><span class="sxs-lookup"><span data-stu-id="38b18-130">The primary reason for this was interoperability – systems like [!INCLUDE[TLA2#tla_ole2.0](../../../../includes/tla2sharptla-ole2-0-md.md)], the clipboard, and Internet Explorer all require single thread affinity (STA) execution.</span></span>  
  
 <span data-ttu-id="38b18-131">Étant donné que vous avez des objets avec des threads STA, vous devez prévoir un moyen de communiquer entre les threads et valider que vous êtes sur le thread approprié.</span><span class="sxs-lookup"><span data-stu-id="38b18-131">Given that you have objects with STA threading, you need a way to communicate between threads, and validate that you are on the correct thread.</span></span> <span data-ttu-id="38b18-132">C’est le rôle du répartiteur.</span><span class="sxs-lookup"><span data-stu-id="38b18-132">Herein lies the role of the dispatcher.</span></span> <span data-ttu-id="38b18-133">Le répartiteur est un système de répartition de messages de base, avec plusieurs files d’attente de priorités différentes.</span><span class="sxs-lookup"><span data-stu-id="38b18-133">The dispatcher is a basic message dispatching system, with multiple prioritized queues.</span></span> <span data-ttu-id="38b18-134">Les messages concernés sont, par exemple, les notifications d’entrées brutes (déplacements de la souris), les fonctions de framework (disposition) ou les commandes utilisateur (exécuter cette méthode).</span><span class="sxs-lookup"><span data-stu-id="38b18-134">Examples of messages include raw input notifications (mouse moved), framework functions (layout), or user commands (execute this method).</span></span> <span data-ttu-id="38b18-135">En dérivant de <xref:System.Windows.Threading.DispatcherObject>, vous créez un [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] objet qui a un comportement STA et un pointeur vers un répartiteur est donné au moment de la création.</span><span class="sxs-lookup"><span data-stu-id="38b18-135">By deriving from <xref:System.Windows.Threading.DispatcherObject>, you create a [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] object that has STA behavior, and will be given a pointer to a dispatcher at creation time.</span></span>  
  
<a name="System_Windows_DependencyObject"></a>   
## <a name="systemwindowsdependencyobject"></a><span data-ttu-id="38b18-136">System.Windows.DependencyObject</span><span class="sxs-lookup"><span data-stu-id="38b18-136">System.Windows.DependencyObject</span></span>  
 <span data-ttu-id="38b18-137">Lors de la conception de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], l’une des principales philosophies suivies pour l’architecture était de privilégier les propriétés par rapport aux méthodes ou événements.</span><span class="sxs-lookup"><span data-stu-id="38b18-137">One of the primary architectural philosophies used in building [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] was a preference for properties over methods or events.</span></span> <span data-ttu-id="38b18-138">Les propriétés, qui sont déclaratives, permettent plus facilement de spécifier l’intention au lieu de l’action.</span><span class="sxs-lookup"><span data-stu-id="38b18-138">Properties are declarative and allow you to more easily specify intent instead of action.</span></span> <span data-ttu-id="38b18-139">Cette approche permettait également la prise en charge d’un système piloté par un modèle, ou piloté par les données, pour afficher le contenu de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="38b18-139">This also supported a model driven, or data driven, system for displaying user interface content.</span></span> <span data-ttu-id="38b18-140">Cette philosophie produisait l’effet recherché de créer davantage de propriétés qu’il n’en fallait pour établir des liaisons, afin de mieux contrôler le comportement d’une application.</span><span class="sxs-lookup"><span data-stu-id="38b18-140">This philosophy had the intended effect of creating more properties that you could bind to, in order to better control the behavior of an application.</span></span>  
  
 <span data-ttu-id="38b18-141">Pour que le système soit davantage piloté par les propriétés, il fallait un système de propriétés plus complet que celui fourni par [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)].</span><span class="sxs-lookup"><span data-stu-id="38b18-141">In order to have more of the system driven by properties, a richer property system than what the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] provides was needed.</span></span> <span data-ttu-id="38b18-142">Les notifications de modification en sont un exemple simple.</span><span class="sxs-lookup"><span data-stu-id="38b18-142">A simple example of this richness is change notifications.</span></span> <span data-ttu-id="38b18-143">Pour permettre une liaison bidirectionnelle, les deux côtés de la liaison doivent prendre en charge la notification de modification.</span><span class="sxs-lookup"><span data-stu-id="38b18-143">In order to enable two way binding, you need both sides of the bind to support change notification.</span></span> <span data-ttu-id="38b18-144">Pour que le comportement soit lié aux valeurs des propriétés, vous devez être notifié de chaque modification d’une valeur de propriété.</span><span class="sxs-lookup"><span data-stu-id="38b18-144">In order to have behavior tied to property values, you need to be notified when the property value changes.</span></span> <span data-ttu-id="38b18-145">Le Microsoft .NET Framework a une interface, **INotifyPropertyChange**, qui permet à un objet de publier des notifications de modification, mais il est facultatif.</span><span class="sxs-lookup"><span data-stu-id="38b18-145">The Microsoft .NET Framework has an interface, **INotifyPropertyChange**, which allows an object to publish change notifications, however it is optional.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="38b18-146">fournit un système de propriétés plus riche, dérivé du <xref:System.Windows.DependencyObject> type.</span><span class="sxs-lookup"><span data-stu-id="38b18-146">provides a richer property system, derived from the <xref:System.Windows.DependencyObject> type.</span></span> <span data-ttu-id="38b18-147">Le système de propriétés est un vrai système de propriétés de « dépendance », car il effectue le suivi des dépendances entre les expressions de propriété et revalide automatiquement les valeurs de propriété après un changement des dépendances.</span><span class="sxs-lookup"><span data-stu-id="38b18-147">The property system is truly a "dependency" property system in that it tracks dependencies between property expressions and automatically revalidates property values when dependencies change.</span></span> <span data-ttu-id="38b18-148">Par exemple, si vous avez une propriété qui hérite (comme <xref:System.Windows.Controls.Control.FontSize%2A>), le système est automatiquement mis à jour si la propriété change sur le parent d’un élément qui hérite de la valeur.</span><span class="sxs-lookup"><span data-stu-id="38b18-148">For example, if you have a property that inherits (like <xref:System.Windows.Controls.Control.FontSize%2A>), the system is automatically updated if the property changes on a parent of an element that inherits the value.</span></span>  
  
 <span data-ttu-id="38b18-149">Le système de propriétés de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] repose sur le concept d’expression de propriété.</span><span class="sxs-lookup"><span data-stu-id="38b18-149">The foundation of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] property system is the concept of a property expression.</span></span> <span data-ttu-id="38b18-150">Dans cette première version de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], le système d’expressions de propriété est fermé et toutes les expressions font partie intégrante du framework.</span><span class="sxs-lookup"><span data-stu-id="38b18-150">In this first release of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], the property expression system is closed, and the expressions are all provided as part of the framework.</span></span> <span data-ttu-id="38b18-151">L’utilisation d’expressions explique pourquoi la liaison de données, les styles ou l’héritage ne sont pas codés en dur dans le système de propriétés, mais plutôt fournis par des couches supérieures dans le framework.</span><span class="sxs-lookup"><span data-stu-id="38b18-151">Expressions are why the property system doesn’t have data binding, styling, or inheritance hard coded, but rather provided by later layers within the framework.</span></span>  
  
 <span data-ttu-id="38b18-152">Le système de propriétés offre également un stockage fragmenté des valeurs de propriété.</span><span class="sxs-lookup"><span data-stu-id="38b18-152">The property system also provides for sparse storage of property values.</span></span> <span data-ttu-id="38b18-153">Étant donné que les objets peuvent avoir des dizaines (voire des centaines) de propriétés, et que la plupart des valeurs conservent leur état par défaut (héritée, définie par les styles, etc.), il n’est pas nécessaire de définir chacune de ces propriétés pour chaque instance d’un objet.</span><span class="sxs-lookup"><span data-stu-id="38b18-153">Because objects can have dozens (if not hundreds) of properties, and most of the values are in their default state (inherited, set by styles, etc.), not every instance of an object needs to have the full weight of every property defined on it.</span></span>  
  
 <span data-ttu-id="38b18-154">La notion de propriétés jointes est la dernière nouvelle fonctionnalité du système de propriétés.</span><span class="sxs-lookup"><span data-stu-id="38b18-154">The final new feature of the property system is the notion of attached properties.</span></span> <span data-ttu-id="38b18-155">Les éléments [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] sont conçus sur le principe de composition et de réutilisation des composants.</span><span class="sxs-lookup"><span data-stu-id="38b18-155">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements are built on the principle of composition and component reuse.</span></span> <span data-ttu-id="38b18-156">C’est souvent le cas, par exemple, qu’un élément <xref:System.Windows.Controls.Grid> conteneur (comme un élément de disposition) a besoin de données supplémentaires sur des éléments enfants pour contrôler son comportement (comme les informations sur les lignes ou les colonnes).</span><span class="sxs-lookup"><span data-stu-id="38b18-156">It is often the case that some containing element (like a <xref:System.Windows.Controls.Grid> layout element) needs additional data on child elements to control its behavior (like the Row/Column information).</span></span> <span data-ttu-id="38b18-157">Au lieu d’associer toutes ces propriétés à chaque élément, les objets peuvent fournir des définitions de propriétés pour d’autres objets.</span><span class="sxs-lookup"><span data-stu-id="38b18-157">Instead of associating all of these properties with every element, any object is allowed to provide property definitions for any other object.</span></span> <span data-ttu-id="38b18-158">Ceci est similaire aux fonctionnalités « expando » de JavaScript.</span><span class="sxs-lookup"><span data-stu-id="38b18-158">This is similar to the "expando" features of JavaScript.</span></span>  
  
<a name="System_Windows_Media_Visual"></a>   
## <a name="systemwindowsmediavisual"></a><span data-ttu-id="38b18-159">System.Windows.Media.Visual</span><span class="sxs-lookup"><span data-stu-id="38b18-159">System.Windows.Media.Visual</span></span>  
 <span data-ttu-id="38b18-160">Une fois qu’un système a été défini, l’étape suivante est l’obtention des pixels dessinés à l’écran.</span><span class="sxs-lookup"><span data-stu-id="38b18-160">With a system defined, the next step is getting pixels drawn to the screen.</span></span> <span data-ttu-id="38b18-161">La <xref:System.Windows.Media.Visual> classe permet de générer une arborescence d’objets visuels, chacun contenant éventuellement des instructions de dessin et des métadonnées relatives au rendu de ces instructions (découpage, transformation, etc.).</span><span class="sxs-lookup"><span data-stu-id="38b18-161">The <xref:System.Windows.Media.Visual> class provides for building a tree of visual objects, each optionally containing drawing instructions and metadata about how to render those instructions (clipping, transformation, etc.).</span></span> <span data-ttu-id="38b18-162"><xref:System.Windows.Media.Visual>est conçu pour être extrêmement léger et flexible, si bien que la plupart des fonctionnalités n’ont pas d’exposition d’API publique et s’appuient fortement sur des fonctions de rappel protégées.</span><span class="sxs-lookup"><span data-stu-id="38b18-162"><xref:System.Windows.Media.Visual> is designed to be extremely lightweight and flexible, so most of the features have no public API exposure and rely heavily on protected callback functions.</span></span>  
  
 <span data-ttu-id="38b18-163"><xref:System.Windows.Media.Visual>est vraiment le point d’entrée du [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] système de composition.</span><span class="sxs-lookup"><span data-stu-id="38b18-163"><xref:System.Windows.Media.Visual> is really the entry point to the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] composition system.</span></span> <span data-ttu-id="38b18-164"><xref:System.Windows.Media.Visual>est le point de connexion entre ces deux sous-systèmes, l’API managée et le milcore non managé.</span><span class="sxs-lookup"><span data-stu-id="38b18-164"><xref:System.Windows.Media.Visual> is the point of connection between these two subsystems, the managed API and the unmanaged milcore.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="38b18-165">affiche les données en parcourant les structures de données non managées qui sont managées par le milcore.</span><span class="sxs-lookup"><span data-stu-id="38b18-165">displays data by traversing the unmanaged data structures managed by the milcore.</span></span> <span data-ttu-id="38b18-166">Ces structures, appelées nœuds de composition, représentent une arborescence d’affichage hiérarchique, avec des instructions de rendu à chaque nœud.</span><span class="sxs-lookup"><span data-stu-id="38b18-166">These structures, called composition nodes, represent a hierarchical display tree with rendering instructions at each node.</span></span> <span data-ttu-id="38b18-167">Cette arborescence, illustrée à droite de la figure ci-dessous, est accessible uniquement par le biais d’un protocole de messagerie.</span><span class="sxs-lookup"><span data-stu-id="38b18-167">This tree, illustrated on the right hand side of the figure below, is only accessible through a messaging protocol.</span></span>  
  
 <span data-ttu-id="38b18-168">Lors de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]la programmation, <xref:System.Windows.Media.Visual> vous créez des éléments, et des types dérivés, qui communiquent en interne à l’arborescence de composition par le biais de ce protocole de messagerie.</span><span class="sxs-lookup"><span data-stu-id="38b18-168">When programming [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], you create <xref:System.Windows.Media.Visual> elements, and derived types, which internally communicate to the composition tree through this messaging protocol.</span></span> <span data-ttu-id="38b18-169">Chaque <xref:System.Windows.Media.Visual> dans [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] peut créer un, aucun ou plusieurs nœuds de composition.</span><span class="sxs-lookup"><span data-stu-id="38b18-169">Each <xref:System.Windows.Media.Visual> in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] may create one, none, or several composition nodes.</span></span>  
  
 <span data-ttu-id="38b18-170">![Arborescence d’éléments visuels de Windows Presentation Foundation.](./media/wpf-architecture2.PNG "wpf_architecture2")</span><span class="sxs-lookup"><span data-stu-id="38b18-170">![The Windows Presentation Foundation Visual Tree.](./media/wpf-architecture2.PNG "wpf_architecture2")</span></span>  
  
 <span data-ttu-id="38b18-171">Il faut souligner un point important de cette architecture : toute l’arborescence des éléments visuels et des instructions de dessin est mise en cache.</span><span class="sxs-lookup"><span data-stu-id="38b18-171">There is a very important architectural detail to notice here – the entire tree of visuals and drawing instructions is cached.</span></span> <span data-ttu-id="38b18-172">Sur le plan graphique, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] utilise un système de rendu en mode conservation.</span><span class="sxs-lookup"><span data-stu-id="38b18-172">In graphics terms, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] uses a retained rendering system.</span></span> <span data-ttu-id="38b18-173">Le système peut ainsi actualiser les dessins à une fréquence élevée sans que cela entraîne un blocage du système de composition lors des rappels de code utilisateur.</span><span class="sxs-lookup"><span data-stu-id="38b18-173">This enables the system to repaint at high refresh rates without the composition system blocking on callbacks to user code.</span></span> <span data-ttu-id="38b18-174">Cela aide à prévenir l’apparition d’une application qui ne répond pas.</span><span class="sxs-lookup"><span data-stu-id="38b18-174">This helps prevent the appearance of an unresponsive application.</span></span>  
  
 <span data-ttu-id="38b18-175">Un autre point important à noter, que le diagramme ne montre pas vraiment, est la façon dont le système effectue réellement la composition.</span><span class="sxs-lookup"><span data-stu-id="38b18-175">Another important detail that isn’t really noticeable in the diagram is how the system actually performs composition.</span></span>  
  
 <span data-ttu-id="38b18-176">Dans User32 et [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)], le système fonctionne selon un système de découpage en mode immédiat.</span><span class="sxs-lookup"><span data-stu-id="38b18-176">In User32 and [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)], the system works on an immediate mode clipping system.</span></span> <span data-ttu-id="38b18-177">Quand un composant doit être affiché, le système établit les limites de la zone de découpage en dehors de laquelle le composant n’est pas autorisé à manipuler les pixels, puis il demande au composant de dessiner les pixels dans cette zone.</span><span class="sxs-lookup"><span data-stu-id="38b18-177">When a component needs to be rendered, the system establishes a clipping bounds outside of which the component isn’t allowed to touch the pixels, and then the component is asked to paint pixels in that box.</span></span> <span data-ttu-id="38b18-178">Cette approche est particulièrement efficace dans les systèmes à mémoire limitée, car lorsqu’un changement est effectué, vous avez uniquement à intervenir sur le composant concerné (la couleur d’un pixel étant toujours définie par un seul composant).</span><span class="sxs-lookup"><span data-stu-id="38b18-178">This system works very well in memory constrained systems because when something changes you only have to touch the affected component – no two components ever contribute to the color of a single pixel.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="38b18-179">utilise le modèle de dessin « algorithme du peintre ».</span><span class="sxs-lookup"><span data-stu-id="38b18-179">uses a "painter's algorithm" painting model.</span></span> <span data-ttu-id="38b18-180">Cela signifie que chaque composant doit effectuer le rendu de l’arrière vers l’avant de l’affichage, au lieu de procéder par découpage.</span><span class="sxs-lookup"><span data-stu-id="38b18-180">This means that instead of clipping each component, each component is asked to render from the back to the front of the display.</span></span> <span data-ttu-id="38b18-181">Chaque composant peut ainsi dessiner par-dessus l’affichage du composant précédent.</span><span class="sxs-lookup"><span data-stu-id="38b18-181">This allows each component to paint over the previous component's display.</span></span> <span data-ttu-id="38b18-182">L’avantage de ce modèle est que vous pouvez afficher des formes complexes partiellement transparentes.</span><span class="sxs-lookup"><span data-stu-id="38b18-182">The advantage of this model is that you can have complex, partially transparent shapes.</span></span> <span data-ttu-id="38b18-183">Avec les cartes graphiques actuelles, ce modèle est relativement rapide (ce qui n’était pas le cas quand les interfaces User32 et [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] ont été créées).</span><span class="sxs-lookup"><span data-stu-id="38b18-183">With today’s modern graphics hardware, this model is relatively fast (which wasn’t the case when User32/ [!INCLUDE[TLA2#tla_gdi](../../../../includes/tla2sharptla-gdi-md.md)] were created).</span></span>  
  
 <span data-ttu-id="38b18-184">Comme mentionné plus haut, une philosophie essentielle de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] est de passer à un modèle de programmation « axé sur les propriétés », davantage déclaratif.</span><span class="sxs-lookup"><span data-stu-id="38b18-184">As mentioned previously, a core philosophy of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is to move to a more declarative, "property centric" model of programming.</span></span> <span data-ttu-id="38b18-185">Cela s’observe à deux endroits intéressants du système visuel.</span><span class="sxs-lookup"><span data-stu-id="38b18-185">In the visual system, this shows up in a couple of interesting places.</span></span>  
  
 <span data-ttu-id="38b18-186">Tout d’abord, si vous réfléchissez au système graphique en mode conservation, cela revient en fait à passer d’un modèle de type DrawLine/DrawLine impératif à un modèle orienté données new Line()/new Line().</span><span class="sxs-lookup"><span data-stu-id="38b18-186">First, if you think about the retained mode graphic system, this is really moving away from an imperative DrawLine/DrawLine type model, to a data oriented model – new Line()/new Line().</span></span> <span data-ttu-id="38b18-187">Cette évolution vers un rendu piloté par les données permet d’exprimer des opérations complexes sur les instructions de dessin à l’aide de propriétés.</span><span class="sxs-lookup"><span data-stu-id="38b18-187">This move to data driven rendering allows complex operations on the drawing instructions to be expressed using properties.</span></span> <span data-ttu-id="38b18-188">Les types dérivés de <xref:System.Windows.Media.Drawing> sont effectivement le modèle objet pour le rendu.</span><span class="sxs-lookup"><span data-stu-id="38b18-188">The types deriving from <xref:System.Windows.Media.Drawing> are effectively the object model for rendering.</span></span>  
  
 <span data-ttu-id="38b18-189">Ensuite, si vous examinez le système d’animation, vous verrez qu’il est presque entièrement déclaratif.</span><span class="sxs-lookup"><span data-stu-id="38b18-189">Second, if you evaluate the animation system, you'll see that it is almost completely declarative.</span></span> <span data-ttu-id="38b18-190">Pour éviter au développeur d’avoir à calculer l’emplacement suivant, ou la couleur suivante, vous pouvez exprimer des animations dans un jeu de propriétés sur un objet animation.</span><span class="sxs-lookup"><span data-stu-id="38b18-190">Instead of requiring a developer to compute the next location, or next color, you can express animations as a set of properties on an animation object.</span></span> <span data-ttu-id="38b18-191">Ces animations peuvent alors exprimer l’intention du développeur ou du concepteur (par exemple, déplacer ce bouton d’ici à là dans cinq secondes), et le système peut déterminer le meilleur moyen d’y parvenir.</span><span class="sxs-lookup"><span data-stu-id="38b18-191">These animations can then express the intent of the developer or designer (move this button from here to there in 5 seconds), and the system can determine the most efficient way to accomplish that.</span></span>  
  
<a name="System_Windows_UIElement"></a>   
## <a name="systemwindowsuielement"></a><span data-ttu-id="38b18-192">System.Windows.UIElement</span><span class="sxs-lookup"><span data-stu-id="38b18-192">System.Windows.UIElement</span></span>  
 <span data-ttu-id="38b18-193"><xref:System.Windows.UIElement>définit les sous-systèmes de base, y compris la disposition, les entrées et les événements.</span><span class="sxs-lookup"><span data-stu-id="38b18-193"><xref:System.Windows.UIElement> defines core subsystems including Layout, Input, and Events.</span></span>  
  
 <span data-ttu-id="38b18-194">Layout est un concept fondamental dans [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="38b18-194">Layout is a core concept in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="38b18-195">Dans la plupart des systèmes, soit il y a un jeu fixe de modèles de disposition (HTML prend en charge trois modèles de disposition : fluide, absolu et tables), soit il n’y a aucun modèle de disposition (User32 prend réellement en charge uniquement le positionnement absolu).</span><span class="sxs-lookup"><span data-stu-id="38b18-195">In many systems there is either a fixed set of layout models (HTML supports three models for layout; flow, absolute, and tables) or no model for layout (User32 really only supports absolute positioning).</span></span> <span data-ttu-id="38b18-196">Aux débuts de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], l’hypothèse était que les développeurs et concepteurs avaient besoin d’un modèle de disposition flexible et extensible, piloté par les valeurs de propriété plutôt que par une logique impérative.</span><span class="sxs-lookup"><span data-stu-id="38b18-196">[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] started with the assumption that developers and designers wanted a flexible, extensible layout model, which could be driven by property values rather than imperative logic.</span></span> <span data-ttu-id="38b18-197">Au niveau, le contrat de base pour la disposition est introduit: un modèle à deux <xref:System.Windows.UIElement.Measure%2A> phases avec les passes et <xref:System.Windows.UIElement.Arrange%2A>. <xref:System.Windows.UIElement></span><span class="sxs-lookup"><span data-stu-id="38b18-197">At the <xref:System.Windows.UIElement> level, the basic contract for layout is introduced – a two phase model with <xref:System.Windows.UIElement.Measure%2A> and <xref:System.Windows.UIElement.Arrange%2A> passes.</span></span>  
  
 <span data-ttu-id="38b18-198"><xref:System.Windows.UIElement.Measure%2A>permet à un composant de déterminer la taille qu’il souhaite prendre.</span><span class="sxs-lookup"><span data-stu-id="38b18-198"><xref:System.Windows.UIElement.Measure%2A> allows a component to determine how much size it would like to take.</span></span> <span data-ttu-id="38b18-199">Il s’agit d’une phase <xref:System.Windows.UIElement.Arrange%2A> distincte de, car il existe de nombreuses situations où un élément parent demande à un enfant de mesurer plusieurs fois pour déterminer sa position et sa taille optimales.</span><span class="sxs-lookup"><span data-stu-id="38b18-199">This is a separate phase from <xref:System.Windows.UIElement.Arrange%2A> because there are many situations where a parent element will ask a child to measure several times to determine its optimal position and size.</span></span> <span data-ttu-id="38b18-200">Le fait que les éléments parents demandent aux éléments enfants d’effectuer les mesures illustre un autre point clé de la philosophie de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], à savoir l’ajustement de la taille au contenu.</span><span class="sxs-lookup"><span data-stu-id="38b18-200">The fact that parent elements ask child elements to measure demonstrates another key philosophy of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – size to content.</span></span> <span data-ttu-id="38b18-201">Tous les contrôles dans [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] peuvent se redimensionner à la taille naturelle de leur contenu.</span><span class="sxs-lookup"><span data-stu-id="38b18-201">All controls in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] support the ability to size to the natural size of their content.</span></span> <span data-ttu-id="38b18-202">Cela facilite la localisation et permet une disposition dynamique des éléments lors du redimensionnement.</span><span class="sxs-lookup"><span data-stu-id="38b18-202">This makes localization much easier, and allows for dynamic layout of elements as things resize.</span></span> <span data-ttu-id="38b18-203">La <xref:System.Windows.UIElement.Arrange%2A> phase permet à un parent de se positionner et de déterminer la taille finale de chaque enfant.</span><span class="sxs-lookup"><span data-stu-id="38b18-203">The <xref:System.Windows.UIElement.Arrange%2A> phase allows a parent to position and determine the final size of each child.</span></span>  
  
 <span data-ttu-id="38b18-204">Beaucoup de temps est souvent passé à parler du côté sortie de, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <xref:System.Windows.Media.Visual> et des objets connexes.</span><span class="sxs-lookup"><span data-stu-id="38b18-204">A lot of time is often spent talking about the output side of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – <xref:System.Windows.Media.Visual> and related objects.</span></span> <span data-ttu-id="38b18-205">Toutefois, il existe aussi de nombreuses innovations côté entrée.</span><span class="sxs-lookup"><span data-stu-id="38b18-205">However there is a tremendous amount of innovation on the input side as well.</span></span> <span data-ttu-id="38b18-206">Le changement le plus fondamental dans le modèle d’entrée pour [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] est probablement le modèle cohérent par lequel les événements d’entrée sont routés dans le système.</span><span class="sxs-lookup"><span data-stu-id="38b18-206">Probably the most fundamental change in the input model for [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is the consistent model by which input events are routed through the system.</span></span>  
  
 <span data-ttu-id="38b18-207">L’entrée est générée sous forme de signal sur un pilote de périphérique en mode noyau, puis elle est routée vers le processus et le thread appropriés selon un processus complexe impliquant User32 et le noyau Windows.</span><span class="sxs-lookup"><span data-stu-id="38b18-207">Input originates as a signal on a kernel mode device driver and gets routed to the correct process and thread through an intricate process involving the Windows kernel and User32.</span></span> <span data-ttu-id="38b18-208">Une fois que le message User32 correspondant à l’entrée a été routé vers [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], il est converti en message d’entrée brut [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] et envoyé au répartiteur.</span><span class="sxs-lookup"><span data-stu-id="38b18-208">Once the User32 message corresponding to the input is routed to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], it is converted into a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] raw input message and sent to the dispatcher.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="38b18-209">permet de convertir les événements d’entrée bruts en différents événements réels. Ainsi, certaines fonctionnalités telles que « MouseEnter » peuvent être implémentées à un niveau inférieur du système pour garantir leur transmission.</span><span class="sxs-lookup"><span data-stu-id="38b18-209">allows for raw input events to be converted to multiple actual events, enabling features like "MouseEnter" to be implemented at a low level of the system with guaranteed delivery.</span></span>  
  
 <span data-ttu-id="38b18-210">Chaque événement d’entrée est converti en deux événements au moins : un événement « preview » et l’événement réel.</span><span class="sxs-lookup"><span data-stu-id="38b18-210">Each input event is converted to at least two events – a "preview" event and the actual event.</span></span> <span data-ttu-id="38b18-211">Tous les événements dans [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] suivent une stratégie de routage dans l’arborescence des éléments.</span><span class="sxs-lookup"><span data-stu-id="38b18-211">All events in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] have a notion of routing through the element tree.</span></span> <span data-ttu-id="38b18-212">Les événements sont dits «bulles» s’ils traversent une cible vers le haut de l’arborescence jusqu’à la racine. ils sont dits «tunneling» s’ils commencent à la racine et passent à une cible.</span><span class="sxs-lookup"><span data-stu-id="38b18-212">Events are said to "bubble" if they traverse from a target up the tree to the root, and are said to "tunnel" if they start at the root and traverse down to a target.</span></span> <span data-ttu-id="38b18-213">Les événements preview d’entrée passent par un tunnel, ce qui permet aux éléments dans l’arborescence d’appliquer un filtre ou d’effectuer une action sur un événement.</span><span class="sxs-lookup"><span data-stu-id="38b18-213">Input preview events tunnel, enabling any element in the tree an opportunity to filter or take action on the event.</span></span> <span data-ttu-id="38b18-214">Les événements standard (non-preview) se propagent vers le haut de l’arborescence, de l’élément cible à la racine.</span><span class="sxs-lookup"><span data-stu-id="38b18-214">The regular (non-preview) events then bubble from the target up to the root.</span></span>  
  
 <span data-ttu-id="38b18-215">Grâce à cette distinction entre les phases de tunneling et de propagation, l’implémentation de fonctions comme les accélérateurs de clavier s’effectue de façon cohérente dans un environnement composite.</span><span class="sxs-lookup"><span data-stu-id="38b18-215">This split between the tunnel and bubble phase makes implementation of features like keyboard accelerators work in a consistent fashion in a composite world.</span></span> <span data-ttu-id="38b18-216">Dans User32, vous pouvez implémenter les accélérateurs de clavier en utilisant une seule table globale qui contient tous les accélérateurs à prendre en charge (Ctrl+N correspondant à « Nouveau »).</span><span class="sxs-lookup"><span data-stu-id="38b18-216">In User32 you would implement keyboard accelerators by having a single global table containing all the accelerators you wanted to support (Ctrl+N mapping to "New").</span></span> <span data-ttu-id="38b18-217">Dans le répartiteur de votre application, vous pouvez appeler **TranslateAccelerator** qui détecte les messages d’entrée dans User32 et détermine si l’un d’eux correspond à un accélérateur enregistré.</span><span class="sxs-lookup"><span data-stu-id="38b18-217">In the dispatcher for your application you would call **TranslateAccelerator** which would sniff the input messages in User32 and determine if any matched a registered accelerator.</span></span> <span data-ttu-id="38b18-218">Dans [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], cela ne fonctionne pas, car le système est entièrement « composable », c’est-à-dire que tout élément peut gérer et utiliser n’importe quel accélérateur de clavier.</span><span class="sxs-lookup"><span data-stu-id="38b18-218">In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] this wouldn’t work because the system is fully "composable" – any element can handle and use any keyboard accelerator.</span></span> <span data-ttu-id="38b18-219">Avec ce modèle d’entrée à deux phases, les composants peuvent implémenter leur propre « TranslateAccelerator ».</span><span class="sxs-lookup"><span data-stu-id="38b18-219">Having this two phase model for input allows components to implement their own "TranslateAccelerator".</span></span>  
  
 <span data-ttu-id="38b18-220">Pour aller plus loin, <xref:System.Windows.UIElement> Introduisez également la notion de CommandBindings.</span><span class="sxs-lookup"><span data-stu-id="38b18-220">To take this one step further, <xref:System.Windows.UIElement> also introduces the notion of CommandBindings.</span></span> <span data-ttu-id="38b18-221">Le [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] système de commandes permet aux développeurs de définir des fonctionnalités en termes de point de terminaison de commande, <xref:System.Windows.Input.ICommand>un composant qui implémente.</span><span class="sxs-lookup"><span data-stu-id="38b18-221">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] command system allows developers to define functionality in terms of a command end point – something that implements <xref:System.Windows.Input.ICommand>.</span></span> <span data-ttu-id="38b18-222">Avec les liaisons de commande, un élément peut définir un mappage entre un mouvement d’entrée (Ctrl+N) et une commande (Nouveau).</span><span class="sxs-lookup"><span data-stu-id="38b18-222">Command bindings enable an element to define a mapping between an input gesture (Ctrl+N) and a command (New).</span></span> <span data-ttu-id="38b18-223">Les mouvements d’entrée et les définitions de commande sont extensibles, et peuvent être liés ensemble au moment de l’utilisation.</span><span class="sxs-lookup"><span data-stu-id="38b18-223">Both the input gestures and command definitions are extensible, and can be wired together at usage time.</span></span> <span data-ttu-id="38b18-224">Vous pouvez alors facilement, par exemple, autoriser un utilisateur final à personnaliser les combinaisons de touches qu’il souhaite utiliser dans une application.</span><span class="sxs-lookup"><span data-stu-id="38b18-224">This makes it trivial, for example, to allow an end user to customize the key bindings that they want to use within an application.</span></span>  
  
 <span data-ttu-id="38b18-225">Jusqu’à présent, la rubrique a surtout abordé les fonctionnalités « clés » de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], à savoir les fonctionnalités implémentées dans l’assembly PresentationCore.</span><span class="sxs-lookup"><span data-stu-id="38b18-225">To this point in the topic, "core" features of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] – features implemented in the PresentationCore assembly, have been the focus.</span></span> <span data-ttu-id="38b18-226">Lors de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]la génération, une séparation nette entre les éléments fondamentaux (comme le contrat de disposition avec **mesure** et **organisation**) et les éléments de Framework (comme l’implémentation d' <xref:System.Windows.Controls.Grid>une disposition spécifique telle que) était la souhaitée résultats.</span><span class="sxs-lookup"><span data-stu-id="38b18-226">When building [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], a clean separation between foundational pieces (like the contract for layout with **Measure** and **Arrange**) and framework pieces (like the implementation of a specific layout like <xref:System.Windows.Controls.Grid>) was the desired outcome.</span></span> <span data-ttu-id="38b18-227">L’objectif était de fournir un point d’extensibilité en bas dans la pile qui permette aux développeurs externes de créer éventuellement leurs propres frameworks.</span><span class="sxs-lookup"><span data-stu-id="38b18-227">The goal was to provide an extensibility point low in the stack that would allow external developers to create their own frameworks if needed.</span></span>  
  
<a name="System_Windows_FrameworkElement"></a>   
## <a name="systemwindowsframeworkelement"></a><span data-ttu-id="38b18-228">System.Windows.FrameworkElement</span><span class="sxs-lookup"><span data-stu-id="38b18-228">System.Windows.FrameworkElement</span></span>  
 <span data-ttu-id="38b18-229"><xref:System.Windows.FrameworkElement>peut être consultée de deux façons différentes.</span><span class="sxs-lookup"><span data-stu-id="38b18-229"><xref:System.Windows.FrameworkElement> can be looked at in two different ways.</span></span> <span data-ttu-id="38b18-230">Il introduit un ensemble de stratégies et de personnalisations sur les sous-systèmes présents dans les couches inférieures de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="38b18-230">It introduces a set of policies and customizations on the subsystems introduced in lower layers of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="38b18-231">Il introduit également un ensemble de nouveaux sous-systèmes.</span><span class="sxs-lookup"><span data-stu-id="38b18-231">It also introduces a set of new subsystems.</span></span>  
  
 <span data-ttu-id="38b18-232">La stratégie principale introduite <xref:System.Windows.FrameworkElement> par est autour de la disposition de l’application.</span><span class="sxs-lookup"><span data-stu-id="38b18-232">The primary policy introduced by <xref:System.Windows.FrameworkElement> is around application layout.</span></span> <span data-ttu-id="38b18-233"><xref:System.Windows.FrameworkElement>s’appuie sur le contrat de disposition de <xref:System.Windows.UIElement> base introduit par et ajoute la notion d’un «emplacement» de disposition qui permet aux auteurs de disposition d’avoir un ensemble cohérent de sémantiques de mise en page pilotées par les propriétés.</span><span class="sxs-lookup"><span data-stu-id="38b18-233"><xref:System.Windows.FrameworkElement> builds on the basic layout contract introduced by <xref:System.Windows.UIElement> and adds the notion of a layout "slot" that makes it easier for layout authors to have a consistent set of property driven layout semantics.</span></span> <span data-ttu-id="38b18-234">Les propriétés <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A>telles <xref:System.Windows.FrameworkElement.VerticalAlignment%2A>que <xref:System.Windows.FrameworkElement.MinWidth%2A>,, <xref:System.Windows.FrameworkElement.Margin%2A> et (pour en nommer quelques-unes) permettent à <xref:System.Windows.FrameworkElement> tous les composants dérivés du comportement cohérent dans les conteneurs de disposition.</span><span class="sxs-lookup"><span data-stu-id="38b18-234">Properties like <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A>, <xref:System.Windows.FrameworkElement.VerticalAlignment%2A>, <xref:System.Windows.FrameworkElement.MinWidth%2A>, and <xref:System.Windows.FrameworkElement.Margin%2A> (to name a few) give all components derived from <xref:System.Windows.FrameworkElement> consistent behavior inside of layout containers.</span></span>  
  
 <span data-ttu-id="38b18-235"><xref:System.Windows.FrameworkElement>fournit également une plus grande facilité d’utilisation des API pour de nombreuses fonctionnalités [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]qui se trouvent dans les couches principales de.</span><span class="sxs-lookup"><span data-stu-id="38b18-235"><xref:System.Windows.FrameworkElement> also provides easier API exposure to many features found in the core layers of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span></span> <span data-ttu-id="38b18-236">Par exemple, <xref:System.Windows.FrameworkElement> fournit un accès direct à l’animation <xref:System.Windows.FrameworkElement.BeginStoryboard%2A> par le biais de la méthode.</span><span class="sxs-lookup"><span data-stu-id="38b18-236">For example, <xref:System.Windows.FrameworkElement> provides direct access to animation through the <xref:System.Windows.FrameworkElement.BeginStoryboard%2A> method.</span></span> <span data-ttu-id="38b18-237">Un <xref:System.Windows.Media.Animation.Storyboard> offre un moyen d’écrire des scripts pour plusieurs animations sur un ensemble de propriétés.</span><span class="sxs-lookup"><span data-stu-id="38b18-237">A <xref:System.Windows.Media.Animation.Storyboard> provides a way to script multiple animations against a set of properties.</span></span>  
  
 <span data-ttu-id="38b18-238">Les deux éléments <xref:System.Windows.FrameworkElement> les plus importants introduits sont la liaison de données et les styles.</span><span class="sxs-lookup"><span data-stu-id="38b18-238">The two most critical things that <xref:System.Windows.FrameworkElement> introduces are data binding and styles.</span></span>  
  
 <span data-ttu-id="38b18-239">Le sous-système de liaison [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] de données dans doit être relativement familier à toute [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] personne qui a utilisé ou ASP.NET [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]pour créer une application.</span><span class="sxs-lookup"><span data-stu-id="38b18-239">The data binding subsystem in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] should be relatively familiar to anyone that has used [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] or ASP.NET for creating an application [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)].</span></span> <span data-ttu-id="38b18-240">Chaque système offre un moyen simple d’exprimer votre intention de lier une ou plusieurs propriétés d’un élément spécifique à une donnée.</span><span class="sxs-lookup"><span data-stu-id="38b18-240">In each of these systems, there is a simple way to express that you want one or more properties from a given element to be bound to a piece of data.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="38b18-241">prend totalement en charge la liaison de propriété, la transformation et la liaison de liste.</span><span class="sxs-lookup"><span data-stu-id="38b18-241">has full support for property binding, transformation, and list binding.</span></span>  
  
 <span data-ttu-id="38b18-242">Les modèles de données sont l’une des fonctionnalités les plus intéressantes de la liaison de données dans [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="38b18-242">One of the most interesting features of data binding in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] is the introduction of data templates.</span></span> <span data-ttu-id="38b18-243">Ils permettent de spécifier de manière déclarative comment afficher les données.</span><span class="sxs-lookup"><span data-stu-id="38b18-243">Data templates allow you to declaratively specify how a piece of data should be visualized.</span></span> <span data-ttu-id="38b18-244">Au lieu de créer une interface utilisateur personnalisée pouvant être liée à des données, vous pouvez contourner le problème et laisser les données déterminer l’affichage à créer.</span><span class="sxs-lookup"><span data-stu-id="38b18-244">Instead of creating a custom user interface that can be bound to data, you can instead turn the problem around and let the data determine the display that will be created.</span></span>  
  
 <span data-ttu-id="38b18-245">Les styles constituent une forme légère de liaison de données.</span><span class="sxs-lookup"><span data-stu-id="38b18-245">Styling is really a lightweight form of data binding.</span></span> <span data-ttu-id="38b18-246">Vous pouvez utiliser les styles pour lier un jeu de propriétés d’une définition partagée à une ou plusieurs instances d’un élément.</span><span class="sxs-lookup"><span data-stu-id="38b18-246">Using styling you can bind a set of properties from a shared definition to one or more instances of an element.</span></span> <span data-ttu-id="38b18-247">Les styles sont appliqués à un élément par référence explicite (en définissant <xref:System.Windows.FrameworkElement.Style%2A> la propriété) ou implicitement en associant un style [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] au type de l’élément.</span><span class="sxs-lookup"><span data-stu-id="38b18-247">Styles get applied to an element either by explicit reference (by setting the <xref:System.Windows.FrameworkElement.Style%2A> property) or implicitly by associating a style with the [!INCLUDE[TLA2#tla_clr](../../../../includes/tla2sharptla-clr-md.md)] type of the element.</span></span>  
  
<a name="System_Windows_Controls_Control"></a>   
## <a name="systemwindowscontrolscontrol"></a><span data-ttu-id="38b18-248">System.Windows.Controls.Control</span><span class="sxs-lookup"><span data-stu-id="38b18-248">System.Windows.Controls.Control</span></span>  
 <span data-ttu-id="38b18-249">La création de modèles est la fonctionnalité la plus importante du contrôle.</span><span class="sxs-lookup"><span data-stu-id="38b18-249">Control’s most significant feature is templating.</span></span> <span data-ttu-id="38b18-250">Si vous considérez le système de composition de WPF comme un système de rendu en mode conservation, la création de modèles permet à un contrôle de décrire son rendu d’une manière déclarative et paramétrable.</span><span class="sxs-lookup"><span data-stu-id="38b18-250">If you think about WPF’s composition system as a retained mode rendering system, templating allows a control to describe its rendering in a parameterized, declarative manner.</span></span> <span data-ttu-id="38b18-251">Un <xref:System.Windows.Controls.ControlTemplate> n’est rien de plus qu’un script pour créer un jeu d’éléments enfants, avec des liaisons aux propriétés offertes par le contrôle.</span><span class="sxs-lookup"><span data-stu-id="38b18-251">A <xref:System.Windows.Controls.ControlTemplate> is really nothing more than a script to create a set of child elements, with bindings to properties offered by the control.</span></span>  
  
 <span data-ttu-id="38b18-252"><xref:System.Windows.Controls.Control>fournit un ensemble de propriétés stock, <xref:System.Windows.Controls.Control.Foreground%2A> <xref:System.Windows.Controls.Control.Padding%2A>, <xref:System.Windows.Controls.Control.Background%2A>,, pour n’en nommer que quelques-uns, que les auteurs de modèles peuvent ensuite utiliser pour personnaliser l’affichage d’un contrôle.</span><span class="sxs-lookup"><span data-stu-id="38b18-252"><xref:System.Windows.Controls.Control> provides a set of stock properties, <xref:System.Windows.Controls.Control.Foreground%2A>, <xref:System.Windows.Controls.Control.Background%2A>, <xref:System.Windows.Controls.Control.Padding%2A>, to name a few, which template authors can then use to customize the display of a control.</span></span> <span data-ttu-id="38b18-253">L’implémentation d’un contrôle fournit un modèle de données et un modèle d’interaction.</span><span class="sxs-lookup"><span data-stu-id="38b18-253">The implementation of a control provides a data model and interaction model.</span></span> <span data-ttu-id="38b18-254">Le modèle d’interaction définit un jeu de commandes (Fermer une fenêtre, par exemple) et des liaisons aux mouvements d’entrée (comme le fait de cliquer sur le X rouge dans le coin supérieur d’une fenêtre).</span><span class="sxs-lookup"><span data-stu-id="38b18-254">The interaction model defines a set of commands (like Close for a window) and bindings to input gestures (like clicking the red X in the upper corner of the window).</span></span> <span data-ttu-id="38b18-255">Le modèle de données fournit un jeu de propriétés pour personnaliser le modèle d’interaction ou l’affichage (déterminé par le modèle).</span><span class="sxs-lookup"><span data-stu-id="38b18-255">The data model provides a set of properties to either customize the interaction model or customize the display (determined by the template).</span></span>  
  
 <span data-ttu-id="38b18-256">Cette distinction entre le modèle de données (propriétés), le modèle d’interaction (commandes et événements) et le modèle d’affichage (modèles) permet d’effectuer une personnalisation complète de l’apparence et du comportement d’un contrôle.</span><span class="sxs-lookup"><span data-stu-id="38b18-256">This split between the data model (properties), interaction model (commands and events), and display model (templates) enables complete customization of a control’s look and behavior.</span></span>  
  
 <span data-ttu-id="38b18-257">Le modèle de contenu est un aspect commun du modèle de données des contrôles.</span><span class="sxs-lookup"><span data-stu-id="38b18-257">A common aspect of the data model of controls is the content model.</span></span> <span data-ttu-id="38b18-258">Si vous examinez un contrôle comme <xref:System.Windows.Controls.Button>, vous verrez qu’il a une propriété nommée «contenu» de type <xref:System.Object>.</span><span class="sxs-lookup"><span data-stu-id="38b18-258">If you look at a control like <xref:System.Windows.Controls.Button>, you will see that it has a property named "Content" of type <xref:System.Object>.</span></span> <span data-ttu-id="38b18-259">Dans [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] et ASP.net, cette propriété est généralement une chaîne, mais qui limite le type de contenu que vous pouvez placer dans un bouton.</span><span class="sxs-lookup"><span data-stu-id="38b18-259">In [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] and ASP.NET, this property would typically be a string – however that limits the type of content you can put in a button.</span></span> <span data-ttu-id="38b18-260">Le contenu d’un bouton peut être une chaîne simple, un objet de données complexe ou une arborescence entière d’éléments.</span><span class="sxs-lookup"><span data-stu-id="38b18-260">Content for a button can either be a simple string, a complex data object, or an entire element tree.</span></span> <span data-ttu-id="38b18-261">Dans le cas d’un objet de données, le modèle de données sert à créer un affichage.</span><span class="sxs-lookup"><span data-stu-id="38b18-261">In the case of a data object, the data template is used to construct a display.</span></span>  
  
<a name="Summary"></a>   
## <a name="summary"></a><span data-ttu-id="38b18-262">Récapitulatif</span><span class="sxs-lookup"><span data-stu-id="38b18-262">Summary</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="38b18-263">est conçu pour vous permettre de créer des systèmes de présentation dynamiques, pilotés par les données.</span><span class="sxs-lookup"><span data-stu-id="38b18-263">is designed to allow you to create dynamic, data driven presentation systems.</span></span> <span data-ttu-id="38b18-264">Chaque partie du système est destinée à la création d’objets à l’aide de jeux de propriétés qui pilotent le comportement.</span><span class="sxs-lookup"><span data-stu-id="38b18-264">Every part of the system is designed to create objects through property sets that drive behavior.</span></span> <span data-ttu-id="38b18-265">La liaison de données est une fonctionnalité essentielle du système qui est intégrée au niveau de chaque couche.</span><span class="sxs-lookup"><span data-stu-id="38b18-265">Data binding is a fundamental part of the system, and is integrated at every layer.</span></span>  
  
 <span data-ttu-id="38b18-266">Les applications standard créent un affichage, puis effectuent une liaison avec certaines données.</span><span class="sxs-lookup"><span data-stu-id="38b18-266">Traditional applications create a display and then bind to some data.</span></span> <span data-ttu-id="38b18-267">Dans [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], tout ce qui concerne le contrôle, chaque aspect de l’affichage, est généré par un certain type de liaison de données.</span><span class="sxs-lookup"><span data-stu-id="38b18-267">In [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], everything about the control, every aspect of the display, is generated by some type of data binding.</span></span> <span data-ttu-id="38b18-268">Le texte placé dans un bouton est affiché en créant un contrôle composé à l’intérieur du bouton et en liant son affichage à la propriété de contenu du bouton.</span><span class="sxs-lookup"><span data-stu-id="38b18-268">The text found inside a button is displayed by creating a composed control inside of the button and binding its display to the button’s content property.</span></span>  
  
 <span data-ttu-id="38b18-269">Quand vous commencerez à développer des applications basées sur [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], cela vous semblera déjà familier.</span><span class="sxs-lookup"><span data-stu-id="38b18-269">When you begin developing [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] based applications, it should feel very familiar.</span></span> <span data-ttu-id="38b18-270">Vous pouvez définir des propriétés, utiliser des objets et la liaison de données à peu près de la même [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] façon que vous pouvez utiliser ou ASP.net.</span><span class="sxs-lookup"><span data-stu-id="38b18-270">You can set properties, use objects, and data bind in much the same way that you can using [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] or ASP.NET.</span></span> <span data-ttu-id="38b18-271">Si vous étudiez l’architecture de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] de manière plus approfondie, vous verrez que vous avez la possibilité de créer des applications plus riches qui traitent fondamentalement les données comme le pilote principal de l’application.</span><span class="sxs-lookup"><span data-stu-id="38b18-271">With a deeper investigation into the architecture of [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)], you'll find that the possibility exists for creating much richer applications that fundamentally treat data as the core driver of the application.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="38b18-272">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="38b18-272">See also</span></span>

- <xref:System.Windows.Media.Visual>
- <xref:System.Windows.UIElement>
- <xref:System.Windows.Input.ICommand>
- <xref:System.Windows.FrameworkElement>
- <xref:System.Windows.Threading.DispatcherObject>
- <xref:System.Windows.Input.CommandBinding>
- <xref:System.Windows.Controls.Control>
- [<span data-ttu-id="38b18-273">Vue d’ensemble de la liaison de données</span><span class="sxs-lookup"><span data-stu-id="38b18-273">Data Binding Overview</span></span>](../data/data-binding-overview.md)
- [<span data-ttu-id="38b18-274">Disposition</span><span class="sxs-lookup"><span data-stu-id="38b18-274">Layout</span></span>](layout.md)
- [<span data-ttu-id="38b18-275">Vue d’ensemble de l’animation</span><span class="sxs-lookup"><span data-stu-id="38b18-275">Animation Overview</span></span>](../graphics-multimedia/animation-overview.md)

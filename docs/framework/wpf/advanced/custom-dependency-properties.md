---
title: Propriétés de dépendance personnalisées
description: Découvrez les étapes à suivre pour implémenter une propriété dans Windows Presentation Foundation, ainsi que les options permettant d’améliorer les performances, la facilité d’utilisation ou la polyvalence de la propriété.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- implementing [WPF], wrappers
- registering properties [WPF]
- properties [WPF], metadata
- metadata [WPF], for properties
- custom dependency properties [WPF]
- properties [WPF], registering
- wrappers [WPF], implementing
- dependency properties [WPF], custom
ms.assetid: e6bfcfac-b10d-4f58-9f77-a864c2a2938f
ms.openlocfilehash: b082340afb8b1a814fc5923126aa58183d43bc01
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/24/2020
ms.locfileid: "87168148"
---
# <a name="custom-dependency-properties"></a><span data-ttu-id="5136d-103">Propriétés de dépendance personnalisées</span><span class="sxs-lookup"><span data-stu-id="5136d-103">Custom Dependency Properties</span></span>

<span data-ttu-id="5136d-104">Cette rubrique décrit les raisons pour lesquelles les développeurs d’applications et les auteurs de composants [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] peuvent souhaiter créer une propriété de dépendance personnalisée, et décrit les étapes d’implémentation ainsi que certaines options d’implémentation susceptibles d’améliorer les performances, l’utilisation ou la souplesse de la propriété.</span><span class="sxs-lookup"><span data-stu-id="5136d-104">This topic describes the reasons that [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] application developers and component authors might want to create custom dependency property, and describes the implementation steps as well as some implementation options that can improve performance, usability, or versatility of the property.</span></span>

<a name="prerequisites"></a>

## <a name="prerequisites"></a><span data-ttu-id="5136d-105">Prérequis</span><span class="sxs-lookup"><span data-stu-id="5136d-105">Prerequisites</span></span>

<span data-ttu-id="5136d-106">Cette rubrique part du principe que vous maîtrisez les propriétés de dépendance du point de vue d’un consommateur de propriétés de dépendance existantes dans les classes [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], et que vous avez lu la rubrique [Vue d’ensemble des propriétés de dépendance](dependency-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-106">This topic assumes that you understand dependency properties from the perspective of a consumer of existing dependency properties on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes, and have read the [Dependency Properties Overview](dependency-properties-overview.md) topic.</span></span> <span data-ttu-id="5136d-107">Pour pouvoir suivre les exemples de cette rubrique, vous devez également comprendre [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] et savoir comment écrire des applications [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5136d-107">In order to follow the examples in this topic, you should also understand [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] and know how to write [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications.</span></span>

<a name="whatis"></a>

## <a name="what-is-a-dependency-property"></a><span data-ttu-id="5136d-108">Qu’est ce qu’une propriété de dépendance ?</span><span class="sxs-lookup"><span data-stu-id="5136d-108">What Is a Dependency Property?</span></span>

<span data-ttu-id="5136d-109">Vous pouvez activer ce qui serait autrement une propriété common language runtime (CLR) pour prendre en charge les styles, la liaison de données, l’héritage, les animations et les valeurs par défaut en les implémentant en tant que propriété de dépendance.</span><span class="sxs-lookup"><span data-stu-id="5136d-109">You can enable what would otherwise be a common language runtime (CLR) property to support styling, data binding, inheritance, animations, and default values by implementing it as a dependency property.</span></span> <span data-ttu-id="5136d-110">Les propriétés de dépendance sont des propriétés inscrites auprès du [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] système de propriétés en appelant la <xref:System.Windows.DependencyProperty.Register%2A> méthode (ou <xref:System.Windows.DependencyProperty.RegisterReadOnly%2A> ) et qui sont sauvegardées par un <xref:System.Windows.DependencyProperty> champ d’identificateur.</span><span class="sxs-lookup"><span data-stu-id="5136d-110">Dependency properties are properties that are registered with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system by calling the <xref:System.Windows.DependencyProperty.Register%2A> method (or <xref:System.Windows.DependencyProperty.RegisterReadOnly%2A>), and that are backed by a <xref:System.Windows.DependencyProperty> identifier field.</span></span> <span data-ttu-id="5136d-111">Les propriétés de dépendance peuvent être utilisées uniquement par <xref:System.Windows.DependencyObject> les types, mais elles <xref:System.Windows.DependencyObject> sont très élevées dans la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] hiérarchie de classes, de sorte que la majorité des classes disponibles dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] peuvent prendre en charge des propriétés de dépendance.</span><span class="sxs-lookup"><span data-stu-id="5136d-111">Dependency properties can be used only by <xref:System.Windows.DependencyObject> types, but <xref:System.Windows.DependencyObject> is quite high in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] class hierarchy, so the majority of classes available in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can support dependency properties.</span></span> <span data-ttu-id="5136d-112">Pour plus d’informations sur les propriétés de dépendance et sur la terminologie et les conventions utilisées pour les décrire dans ce kit de développement logiciel (SDK), consultez [vue d’ensemble des propriétés de dépendance](dependency-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-112">For more information about dependency properties and some of the terminology and conventions used for describing them in this SDK, see [Dependency Properties Overview](dependency-properties-overview.md).</span></span>

<a name="example_dp"></a>

## <a name="examples-of-dependency-properties"></a><span data-ttu-id="5136d-113">Exemples de propriétés de dépendance</span><span class="sxs-lookup"><span data-stu-id="5136d-113">Examples of Dependency Properties</span></span>

<span data-ttu-id="5136d-114">Les exemples de propriétés de dépendance implémentées sur [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] les classes incluent la <xref:System.Windows.Controls.Control.Background%2A> propriété, la <xref:System.Windows.FrameworkElement.Width%2A> propriété et la <xref:System.Windows.Controls.TextBox.Text%2A> propriété, entre autres.</span><span class="sxs-lookup"><span data-stu-id="5136d-114">Examples of dependency properties that are implemented on [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes include the <xref:System.Windows.Controls.Control.Background%2A> property, the <xref:System.Windows.FrameworkElement.Width%2A> property, and the <xref:System.Windows.Controls.TextBox.Text%2A> property, among many others.</span></span> <span data-ttu-id="5136d-115">Chaque propriété de dépendance exposée par une classe a un champ statique public correspondant de type <xref:System.Windows.DependencyProperty> exposé sur cette même classe.</span><span class="sxs-lookup"><span data-stu-id="5136d-115">Each dependency property exposed by a class has a corresponding public static field of type <xref:System.Windows.DependencyProperty> exposed on that same class.</span></span> <span data-ttu-id="5136d-116">Il s’agit de l’identificateur de la propriété de dépendance.</span><span class="sxs-lookup"><span data-stu-id="5136d-116">This is the identifier for the dependency property.</span></span> <span data-ttu-id="5136d-117">L’identificateur est nommé à l’aide d’une convention : le nom de la propriété de dépendance, auquel est ajoutée la chaîne `Property`.</span><span class="sxs-lookup"><span data-stu-id="5136d-117">The identifier is named using a convention: the name of the dependency property with the string `Property` appended to it.</span></span> <span data-ttu-id="5136d-118">Par exemple, le <xref:System.Windows.DependencyProperty> champ d’identificateur correspondant pour la <xref:System.Windows.Controls.Control.Background%2A> propriété est <xref:System.Windows.Controls.Control.BackgroundProperty> .</span><span class="sxs-lookup"><span data-stu-id="5136d-118">For example, the corresponding <xref:System.Windows.DependencyProperty> identifier field for the <xref:System.Windows.Controls.Control.Background%2A> property is <xref:System.Windows.Controls.Control.BackgroundProperty>.</span></span> <span data-ttu-id="5136d-119">L’identificateur stocke les informations sur la propriété de dépendance telle qu’elle a été inscrite, et l’identificateur est ensuite utilisé ultérieurement pour d’autres opérations impliquant la propriété de dépendance, telles que l’appel de <xref:System.Windows.DependencyObject.SetValue%2A> .</span><span class="sxs-lookup"><span data-stu-id="5136d-119">The identifier stores the information about the dependency property as it was registered, and the identifier is then used later for other operations involving the dependency property, such as calling <xref:System.Windows.DependencyObject.SetValue%2A>.</span></span>

<span data-ttu-id="5136d-120">Comme mentionné dans la [vue d’ensemble des propriétés de dépendance](dependency-properties-overview.md), toutes les propriétés de dépendance dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (à l’exception de la plupart des propriétés jointes) sont également des propriétés CLR en raison de l’implémentation de « wrapper ».</span><span class="sxs-lookup"><span data-stu-id="5136d-120">As mentioned in the [Dependency Properties Overview](dependency-properties-overview.md), all dependency properties in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (except most attached properties) are also CLR properties because of the "wrapper" implementation.</span></span> <span data-ttu-id="5136d-121">Par conséquent, à partir du code, vous pouvez récupérer ou définir des propriétés de dépendance en appelant des accesseurs CLR qui définissent les wrappers de la même manière que vous utilisez d’autres propriétés CLR.</span><span class="sxs-lookup"><span data-stu-id="5136d-121">Therefore, from code, you can get or set dependency properties by calling CLR accessors that define the wrappers in the same manner that you would use other CLR properties.</span></span> <span data-ttu-id="5136d-122">En tant que consommateur de propriétés de dépendance établies, vous n’utilisez généralement pas les <xref:System.Windows.DependencyObject> méthodes <xref:System.Windows.DependencyObject.GetValue%2A> et <xref:System.Windows.DependencyObject.SetValue%2A> , qui sont le point de connexion au système de propriétés sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="5136d-122">As a consumer of established dependency properties, you do not typically use the <xref:System.Windows.DependencyObject> methods <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A>, which are the connection point to the underlying property system.</span></span> <span data-ttu-id="5136d-123">Au lieu de cela, l’implémentation existante des propriétés CLR aura déjà appelé <xref:System.Windows.DependencyObject.GetValue%2A> et <xref:System.Windows.DependencyObject.SetValue%2A> dans `get` les `set` implémentations de wrapper et de la propriété, en utilisant le champ d’identificateur de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="5136d-123">Rather, the existing implementation of the CLR properties will have already called <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> within the `get` and `set` wrapper implementations of the property, using the identifier field appropriately.</span></span> <span data-ttu-id="5136d-124">Si vous implémentez une propriété de dépendance personnalisée vous-même, vous définirez le wrapper de la même façon.</span><span class="sxs-lookup"><span data-stu-id="5136d-124">If you are implementing a custom dependency property yourself, then you will be defining the wrapper in a similar way.</span></span>

<a name="backing_with_dp"></a>

## <a name="when-should-you-implement-a-dependency-property"></a><span data-ttu-id="5136d-125">Quand faut-il implémenter une propriété de dépendance ?</span><span class="sxs-lookup"><span data-stu-id="5136d-125">When Should You Implement a Dependency Property?</span></span>

<span data-ttu-id="5136d-126">Lorsque vous implémentez une propriété sur une classe, tant que la classe dérive de <xref:System.Windows.DependencyObject> , vous avez la possibilité de sauvegarder votre propriété avec un <xref:System.Windows.DependencyProperty> identificateur et de faire de ce fait une propriété de dépendance.</span><span class="sxs-lookup"><span data-stu-id="5136d-126">When you implement a property on a class, so long as your class derives from <xref:System.Windows.DependencyObject>, you have the option to back your property with a <xref:System.Windows.DependencyProperty> identifier and thus to make it a dependency property.</span></span> <span data-ttu-id="5136d-127">Faire de votre propriété une propriété de dépendance n’est pas toujours nécessaire ni approprié. Cela dépend des besoins de votre scénario.</span><span class="sxs-lookup"><span data-stu-id="5136d-127">Having your property be a dependency property is not always necessary or appropriate, and will depend on your scenario needs.</span></span> <span data-ttu-id="5136d-128">Parfois, la technique classique qui consiste à stocker la propriété dans un champ privé est adéquate.</span><span class="sxs-lookup"><span data-stu-id="5136d-128">Sometimes, the typical technique of backing your property with a private field is adequate.</span></span> <span data-ttu-id="5136d-129">Toutefois, vous devez implémenter votre propriété en tant que propriété de dépendance chaque fois que vous souhaitez qu’elle prenne en charge une ou plusieurs des fonctionnalités [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] suivantes :</span><span class="sxs-lookup"><span data-stu-id="5136d-129">However, you should implement your property as a dependency property whenever you want your property to support one or more of the following [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] capabilities:</span></span>

- <span data-ttu-id="5136d-130">Vous souhaitez que votre propriété puisse être définie dans un style.</span><span class="sxs-lookup"><span data-stu-id="5136d-130">You want your property to be settable in a style.</span></span> <span data-ttu-id="5136d-131">Pour plus d’informations, consultez [Application d’un style et création de modèles](../../../desktop-wpf/fundamentals/styles-templates-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-131">For more information, see [Styling and Templating](../../../desktop-wpf/fundamentals/styles-templates-overview.md).</span></span>

- <span data-ttu-id="5136d-132">Vous souhaitez que votre propriété prenne en charge la liaison de données.</span><span class="sxs-lookup"><span data-stu-id="5136d-132">You want your property to support data binding.</span></span> <span data-ttu-id="5136d-133">Pour plus d’informations sur les propriétés de dépendance de liaison de données, consultez [Lier les propriétés de deux contrôles](../data/how-to-bind-the-properties-of-two-controls.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-133">For more information about data binding dependency properties, see [Bind the Properties of Two Controls](../data/how-to-bind-the-properties-of-two-controls.md).</span></span>

- <span data-ttu-id="5136d-134">Vous souhaitez que votre propriété puisse être définie avec une référence à une ressource dynamique.</span><span class="sxs-lookup"><span data-stu-id="5136d-134">You want your property to be settable with a dynamic resource reference.</span></span> <span data-ttu-id="5136d-135">Pour plus d’informations, consultez [Ressources XAML](../../../desktop-wpf/fundamentals/xaml-resources-define.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-135">For more information, see [XAML Resources](../../../desktop-wpf/fundamentals/xaml-resources-define.md).</span></span>

- <span data-ttu-id="5136d-136">Vous voulez hériter automatiquement une valeur de propriété d’un élément parent dans l’arborescence d’éléments.</span><span class="sxs-lookup"><span data-stu-id="5136d-136">You want to inherit a property value automatically from a parent element in the element tree.</span></span> <span data-ttu-id="5136d-137">Dans ce cas, inscrivez-vous à la <xref:System.Windows.DependencyProperty.RegisterAttached%2A> méthode, même si vous créez également un wrapper de propriété pour l’accès CLR.</span><span class="sxs-lookup"><span data-stu-id="5136d-137">In this case, register with the <xref:System.Windows.DependencyProperty.RegisterAttached%2A> method, even if you also create a property wrapper for CLR access.</span></span> <span data-ttu-id="5136d-138">Pour plus d’informations, consultez [Héritage de valeur de propriété](property-value-inheritance.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-138">For more information, see [Property Value Inheritance](property-value-inheritance.md).</span></span>

- <span data-ttu-id="5136d-139">Vous souhaitez que votre propriété puisse être animée.</span><span class="sxs-lookup"><span data-stu-id="5136d-139">You want your property to be animatable.</span></span> <span data-ttu-id="5136d-140">Pour plus d’informations, consultez [vue d’ensemble](../graphics-multimedia/animation-overview.md)de l’animation.</span><span class="sxs-lookup"><span data-stu-id="5136d-140">For more information, see [Animation Overview](../graphics-multimedia/animation-overview.md).</span></span>

- <span data-ttu-id="5136d-141">Vous souhaitez que le système de propriétés signale quand la valeur précédente de la propriété a été modifiée par des actions effectuées par le système de propriétés, l’environnement ou l’utilisateur, ou par la lecture et l’utilisation de styles.</span><span class="sxs-lookup"><span data-stu-id="5136d-141">You want the property system to report when the previous value of the property has been changed by actions taken by the property system, the environment, or the user, or by reading and using styles.</span></span> <span data-ttu-id="5136d-142">À l’aide des métadonnées de propriété, votre propriété peut spécifier une méthode de rappel qui sera appelée chaque fois que le système de propriétés détermine que la valeur de propriété a été modifiée de manière certaine.</span><span class="sxs-lookup"><span data-stu-id="5136d-142">By using property metadata, your property can specify a callback method that will be invoked each time the property system determines that your property value was definitively changed.</span></span> <span data-ttu-id="5136d-143">Le forçage de valeur de propriété est un concept connexe.</span><span class="sxs-lookup"><span data-stu-id="5136d-143">A related concept is property value coercion.</span></span> <span data-ttu-id="5136d-144">Pour plus d’informations, consultez [Validation et rappels de propriétés de dépendance](dependency-property-callbacks-and-validation.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-144">For more information, see [Dependency Property Callbacks and Validation](dependency-property-callbacks-and-validation.md).</span></span>

- <span data-ttu-id="5136d-145">Vous souhaitez utiliser des conventions de métadonnées établies qui sont également utilisées par des processus [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], par exemple signaler si la modification d’une valeur de propriété exige que le système de disposition recompose les visuels d’un élément.</span><span class="sxs-lookup"><span data-stu-id="5136d-145">You want to use established metadata conventions that are also used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] processes, such as reporting whether changing a property value should require the layout system to recompose the visuals for an element.</span></span> <span data-ttu-id="5136d-146">Ou vous souhaitez pouvoir utiliser des substitutions de métadonnées pour que les classes dérivées puissent changer des caractéristiques basées sur les métadonnées, telles que la valeur par défaut.</span><span class="sxs-lookup"><span data-stu-id="5136d-146">Or you want to be able to use metadata overrides so that derived classes can change metadata-based characteristics such as the default value.</span></span>

- <span data-ttu-id="5136d-147">Vous souhaitez que les propriétés d’un contrôle personnalisé reçoivent la prise en charge du Concepteur WPF Visual Studio, par exemple la modification de la fenêtre **Propriétés** .</span><span class="sxs-lookup"><span data-stu-id="5136d-147">You want properties of a custom control to receive Visual Studio WPF Designer support, such as **Properties** window editing.</span></span> <span data-ttu-id="5136d-148">Pour plus d’informations, consultez [Vue d’ensemble de la création de contrôles](../controls/control-authoring-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-148">For more information, see [Control Authoring Overview](../controls/control-authoring-overview.md).</span></span>

<span data-ttu-id="5136d-149">Quand vous examinez ces scénarios, vous devez également réfléchir si vous pouvez accomplir votre scénario en substituant les métadonnées d’une propriété de dépendance existante, plutôt qu’en implémentant une toute nouvelle propriété.</span><span class="sxs-lookup"><span data-stu-id="5136d-149">When you examine these scenarios, you should also consider whether you can achieve your scenario by overriding the metadata of an existing dependency property, rather than implementing a completely new property.</span></span> <span data-ttu-id="5136d-150">Le fait qu’une substitution de métadonnées soit pratique ou non dépend de votre scénario et de sa ressemblance avec l’implémentation dans les classes et les propriétés de dépendance [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] existantes.</span><span class="sxs-lookup"><span data-stu-id="5136d-150">Whether a metadata override is practical depends on your scenario and how closely that scenario resembles the implementation in existing [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dependency properties and classes.</span></span> <span data-ttu-id="5136d-151">Pour plus d’informations sur la substitution de métadonnées dans les propriétés existantes, consultez [Métadonnées de propriété de dépendance](dependency-property-metadata.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-151">For more information about overriding metadata on existing properties, see [Dependency Property Metadata](dependency-property-metadata.md).</span></span>

<a name="checklist"></a>

## <a name="checklist-for-defining-a-dependency-property"></a><span data-ttu-id="5136d-152">Liste de vérification pour la définition d’une propriété de dépendance</span><span class="sxs-lookup"><span data-stu-id="5136d-152">Checklist for Defining a Dependency Property</span></span>

<span data-ttu-id="5136d-153">La définition d’une propriété de dépendance implique quatre concepts distincts.</span><span class="sxs-lookup"><span data-stu-id="5136d-153">Defining a dependency property consists of four distinct concepts.</span></span> <span data-ttu-id="5136d-154">Ces concepts ne sont pas des étapes procédurales nécessairement strictes, car certaines d’entre elles finissent par être combinées sur des lignes de code uniques dans l’implémentation :</span><span class="sxs-lookup"><span data-stu-id="5136d-154">These concepts are not necessarily strict procedural steps, because some of these end up being combined as single lines of code in the implementation:</span></span>

- <span data-ttu-id="5136d-155">(Facultatif) Créez des métadonnées de propriété pour la propriété de dépendance.</span><span class="sxs-lookup"><span data-stu-id="5136d-155">(Optional) Create property metadata for the dependency property.</span></span>

- <span data-ttu-id="5136d-156">Inscrivez le nom de propriété auprès du système de propriétés, en spécifiant un type de propriétaire et le type de la valeur de propriété.</span><span class="sxs-lookup"><span data-stu-id="5136d-156">Register the property name with the property system, specifying an owner type and the type of the property value.</span></span> <span data-ttu-id="5136d-157">Spécifiez également les métadonnées de propriété, si elles sont utilisées.</span><span class="sxs-lookup"><span data-stu-id="5136d-157">Also specify the property metadata, if used.</span></span>

- <span data-ttu-id="5136d-158">Définissez un <xref:System.Windows.DependencyProperty> identificateur en tant que `public` `static` `readonly` champ sur le type de propriétaire.</span><span class="sxs-lookup"><span data-stu-id="5136d-158">Define a <xref:System.Windows.DependencyProperty> identifier as a `public` `static` `readonly` field on the owner type.</span></span>

- <span data-ttu-id="5136d-159">Définissez une propriété « wrapper » CLR dont le nom correspond au nom de la propriété de dépendance.</span><span class="sxs-lookup"><span data-stu-id="5136d-159">Define a CLR "wrapper" property whose name matches the name of the dependency property.</span></span> <span data-ttu-id="5136d-160">Implémentez les accesseurs et de la propriété « wrapper » CLR `get` `set` pour vous connecter avec la propriété de dépendance qui le stocke.</span><span class="sxs-lookup"><span data-stu-id="5136d-160">Implement the CLR "wrapper" property's `get` and `set` accessors to connect with the dependency property that backs it.</span></span>

<a name="registering"></a>

### <a name="registering-the-property-with-the-property-system"></a><span data-ttu-id="5136d-161">Inscription de la propriété auprès du système de propriétés</span><span class="sxs-lookup"><span data-stu-id="5136d-161">Registering the Property with the Property System</span></span>

<span data-ttu-id="5136d-162">Pour que votre propriété soit une propriété de dépendance, vous devez l’inscrire dans une table gérée par le système de propriétés et lui donner un identificateur unique utilisé comme qualificateur pour les opérations de système de propriétés ultérieures.</span><span class="sxs-lookup"><span data-stu-id="5136d-162">In order for your property to be a dependency property, you must register that property into a table maintained by the property system, and give it a unique identifier that is used as the qualifier for later property system operations.</span></span> <span data-ttu-id="5136d-163">Ces opérations peuvent être des opérations internes ou votre propre code appelant des API du système de propriétés.</span><span class="sxs-lookup"><span data-stu-id="5136d-163">These operations might be internal operations, or your own code calling property system APIs.</span></span> <span data-ttu-id="5136d-164">Pour inscrire la propriété, vous appelez la <xref:System.Windows.DependencyProperty.Register%2A> méthode dans le corps de votre classe (à l’intérieur de la classe, mais en dehors de toutes les définitions de membre).</span><span class="sxs-lookup"><span data-stu-id="5136d-164">To register the property, you call the <xref:System.Windows.DependencyProperty.Register%2A> method within the body of your class (inside the class, but outside of any member definitions).</span></span> <span data-ttu-id="5136d-165">Le champ d’identificateur est également fourni par l' <xref:System.Windows.DependencyProperty.Register%2A> appel de méthode, comme valeur de retour.</span><span class="sxs-lookup"><span data-stu-id="5136d-165">The identifier field is also provided by the <xref:System.Windows.DependencyProperty.Register%2A> method call, as the return value.</span></span> <span data-ttu-id="5136d-166">La raison pour laquelle l' <xref:System.Windows.DependencyProperty.Register%2A> appel est effectué en dehors d’autres définitions de membres est que vous utilisez cette valeur de retour pour assigner et créer un `public` `static` `readonly` champ de type dans <xref:System.Windows.DependencyProperty> le cadre de votre classe.</span><span class="sxs-lookup"><span data-stu-id="5136d-166">The reason that the <xref:System.Windows.DependencyProperty.Register%2A> call is done outside of other member definitions is because you use this return value to assign and create a `public` `static` `readonly` field of type <xref:System.Windows.DependencyProperty> as part of your class.</span></span> <span data-ttu-id="5136d-167">Ce champ devient l’identificateur de votre propriété de dépendance.</span><span class="sxs-lookup"><span data-stu-id="5136d-167">This field becomes the identifier for your dependency property.</span></span>

[!code-csharp[WPFAquariumSln#RegisterAG](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFAquariumSln/CSharp/WPFAquariumObjects/Class1.cs#registerag)]
[!code-vb[WPFAquariumSln#RegisterAG](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFAquariumSln/visualbasic/wpfaquariumobjects/class1.vb#registerag)]

<a name="nameconventions"></a>

### <a name="dependency-property-name-conventions"></a><span data-ttu-id="5136d-168">Conventions pour les noms des propriétés de dépendance</span><span class="sxs-lookup"><span data-stu-id="5136d-168">Dependency Property Name Conventions</span></span>

<span data-ttu-id="5136d-169">Il existe des conventions d’affectation de noms établies pour les propriétés de dépendance. Vous devez les respecter dans toutes les circonstances, sauf les plus exceptionnelles.</span><span class="sxs-lookup"><span data-stu-id="5136d-169">There are established naming conventions regarding dependency properties that you must follow in all but exceptional circumstances.</span></span>

<span data-ttu-id="5136d-170">La propriété de dépendance elle-même aura un nom de base, « AquariumGraphic », comme dans cet exemple, qui est donné comme premier paramètre de <xref:System.Windows.DependencyProperty.Register%2A> .</span><span class="sxs-lookup"><span data-stu-id="5136d-170">The dependency property itself will have a basic name, "AquariumGraphic" as in this example, which is given as the first parameter of <xref:System.Windows.DependencyProperty.Register%2A>.</span></span> <span data-ttu-id="5136d-171">Ce nom doit être unique dans chaque type d’inscription.</span><span class="sxs-lookup"><span data-stu-id="5136d-171">That name must be unique within each registering type.</span></span> <span data-ttu-id="5136d-172">Les propriétés de dépendance héritées par l’intermédiaire des types de base sont considérées comme faisant déjà partie du type d’inscription ; les noms des propriétés héritées ne peuvent pas être réinscrits.</span><span class="sxs-lookup"><span data-stu-id="5136d-172">Dependency properties inherited through base types are considered to be already part of the registering type; names of inherited properties cannot be registered again.</span></span> <span data-ttu-id="5136d-173">Il existe toutefois une technique pour ajouter une classe en tant que propriétaire d’une propriété de dépendance, même quand celle-ci n’est pas héritée. Pour plus d’informations, consultez [Métadonnées de propriété de dépendance](dependency-property-metadata.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-173">However, there is a technique for adding a class as owner of a dependency property even when that dependency property is not inherited; for details, see [Dependency Property Metadata](dependency-property-metadata.md).</span></span>

<span data-ttu-id="5136d-174">Quand vous créez le champ d’identificateur, affectez-lui le même nom que la propriété que vous avez inscrite, plus le suffixe `Property`.</span><span class="sxs-lookup"><span data-stu-id="5136d-174">When you create the identifier field, name this field by the name of the property as you registered it, plus the suffix `Property`.</span></span> <span data-ttu-id="5136d-175">Ce champ est votre identificateur pour la propriété de dépendance, et il sera utilisé ultérieurement comme entrée pour le et les <xref:System.Windows.DependencyObject.SetValue%2A> <xref:System.Windows.DependencyObject.GetValue%2A> appels que vous allez effectuer dans les wrappers, par tout autre code qui accède à la propriété par votre propre code, par tout accès au code externe que vous autorisez, par le système de propriétés et potentiellement par les [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processeurs.</span><span class="sxs-lookup"><span data-stu-id="5136d-175">This field is your identifier for the dependency property, and it will be used later as an input for the <xref:System.Windows.DependencyObject.SetValue%2A> and <xref:System.Windows.DependencyObject.GetValue%2A> calls you will make in the wrappers, by any other code access to the property by your own code, by any external code access you allow, by the property system, and potentially by [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] processors.</span></span>

> [!NOTE]
> <span data-ttu-id="5136d-176">La définition de la propriété de dépendance dans le corps de la classe est l’implémentation type, mais vous pouvez aussi définir une propriété de dépendance dans le constructeur statique de classe.</span><span class="sxs-lookup"><span data-stu-id="5136d-176">Defining the dependency property in the class body is the typical implementation, but it is also possible to define a dependency property in the class static constructor.</span></span> <span data-ttu-id="5136d-177">Cette approche peut être plus logique si vous avez besoin de plus d’une ligne de code pour initialiser la propriété de dépendance.</span><span class="sxs-lookup"><span data-stu-id="5136d-177">This approach might make sense if you need more than one line of code to initialize the dependency property.</span></span>

<a name="wrapper1"></a>

### <a name="implementing-the-wrapper"></a><span data-ttu-id="5136d-178">Implémentation du « Wrapper »</span><span class="sxs-lookup"><span data-stu-id="5136d-178">Implementing the "Wrapper"</span></span>

<span data-ttu-id="5136d-179">Votre implémentation de wrapper doit appeler <xref:System.Windows.DependencyObject.GetValue%2A> dans l' `get` implémentation de et <xref:System.Windows.DependencyObject.SetValue%2A> dans l' `set` implémentation (l’appel d’inscription d’origine et le champ sont également affichés ici pour plus de clarté).</span><span class="sxs-lookup"><span data-stu-id="5136d-179">Your wrapper implementation should call <xref:System.Windows.DependencyObject.GetValue%2A> in the `get` implementation, and <xref:System.Windows.DependencyObject.SetValue%2A> in the `set` implementation (the original registration call and field are shown here too for clarity).</span></span>

<span data-ttu-id="5136d-180">Dans toutes les circonstances sauf dans des circonstances exceptionnelles, vos implémentations de wrapper doivent exécuter uniquement les <xref:System.Windows.DependencyObject.GetValue%2A> <xref:System.Windows.DependencyObject.SetValue%2A> actions et, respectivement.</span><span class="sxs-lookup"><span data-stu-id="5136d-180">In all but exceptional circumstances, your wrapper implementations should perform only the <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> actions, respectively.</span></span> <span data-ttu-id="5136d-181">La raison est expliquée dans la rubrique [Propriétés de dépendance et chargement XAML](xaml-loading-and-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-181">The reason for this is discussed in the topic [XAML Loading and Dependency Properties](xaml-loading-and-dependency-properties.md).</span></span>

<span data-ttu-id="5136d-182">Toutes les propriétés de dépendance publiques existantes fournies dans les classes [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] utilisent ce modèle d’implémentation de wrapper simple. La plus grande partie de la complexité du fonctionnement des métadonnées de propriété est un comportement inhérent du système de propriétés ou est implémentée via d’autres concepts, tels que le forçage de type ou les rappels de changement de propriété par l’intermédiaire de métadonnées de propriété.</span><span class="sxs-lookup"><span data-stu-id="5136d-182">All existing public dependency properties that are provided on the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] classes use this simple wrapper implementation model; most of the complexity of how dependency properties work is either inherently a behavior of the property system, or is implemented through other concepts such as coercion or property change callbacks through property metadata.</span></span>

[!code-csharp[WPFAquariumSln#AGWithWrapper](~/samples/snippets/csharp/VS_Snippets_Wpf/WPFAquariumSln/CSharp/WPFAquariumObjects/Class1.cs#agwithwrapper)]
[!code-vb[WPFAquariumSln#AGWithWrapper](~/samples/snippets/visualbasic/VS_Snippets_Wpf/WPFAquariumSln/visualbasic/wpfaquariumobjects/class1.vb#agwithwrapper)]

<span data-ttu-id="5136d-183">Là encore, par Convention, le nom de la propriété wrapper doit être le même que le nom choisi et donné comme premier paramètre de l' <xref:System.Windows.DependencyProperty.Register%2A> appel qui a inscrit la propriété.</span><span class="sxs-lookup"><span data-stu-id="5136d-183">Again, by convention, the name of the wrapper property must be the same as the name chosen and given as first parameter of the <xref:System.Windows.DependencyProperty.Register%2A> call that registered the property.</span></span> <span data-ttu-id="5136d-184">Si votre propriété ne respecte pas la convention, toutes les utilisations possibles ne sont pas nécessairement désactivées, mais vous rencontrerez plusieurs problèmes :</span><span class="sxs-lookup"><span data-stu-id="5136d-184">If your property does not follow the convention, this does not necessarily disable all possible uses, but you will encounter several notable issues:</span></span>

- <span data-ttu-id="5136d-185">Certains aspects des styles et modèles ne fonctionneront pas.</span><span class="sxs-lookup"><span data-stu-id="5136d-185">Certain aspects of styles and templates will not work.</span></span>

- <span data-ttu-id="5136d-186">La plupart des outils et concepteurs doivent s’appuyer sur les conventions d’affectation de noms pour sérialiser correctement [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], ou pour fournir l’assistance d’environnement de concepteur au niveau de chaque propriété.</span><span class="sxs-lookup"><span data-stu-id="5136d-186">Most tools and designers must rely on the naming conventions to properly serialize [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], or to provide designer environment assistance at a per-property level.</span></span>

- <span data-ttu-id="5136d-187">L’implémentation actuelle du [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] chargeur contourne entièrement les wrappers et s’appuie sur la Convention d’affectation de noms lors du traitement des valeurs d’attribut.</span><span class="sxs-lookup"><span data-stu-id="5136d-187">The current implementation of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] loader bypasses the wrappers entirely, and relies on the naming convention when processing attribute values.</span></span> <span data-ttu-id="5136d-188">Pour plus d’informations, consultez [Propriétés de dépendance et chargement XAML](xaml-loading-and-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-188">For more information, see [XAML Loading and Dependency Properties](xaml-loading-and-dependency-properties.md).</span></span>

<a name="metadata"></a>

### <a name="property-metadata-for-a-new-dependency-property"></a><span data-ttu-id="5136d-189">Métadonnées de propriété pour une nouvelle propriété de dépendance</span><span class="sxs-lookup"><span data-stu-id="5136d-189">Property Metadata for a New Dependency Property</span></span>

<span data-ttu-id="5136d-190">Quand vous inscrivez une propriété de dépendance, l’inscription dans le système de propriétés crée un objet de métadonnées qui stocke les caractéristiques de la propriété.</span><span class="sxs-lookup"><span data-stu-id="5136d-190">When you register a dependency property, the registration through the property system creates a metadata object that stores property characteristics.</span></span> <span data-ttu-id="5136d-191">La plupart de ces caractéristiques ont des valeurs par défaut qui sont définies si la propriété est inscrite avec les signatures simples de <xref:System.Windows.DependencyProperty.Register%2A> .</span><span class="sxs-lookup"><span data-stu-id="5136d-191">Many of these characteristics have defaults that are set if the property is registered with the simple signatures of <xref:System.Windows.DependencyProperty.Register%2A>.</span></span> <span data-ttu-id="5136d-192">D’autres signatures de vous <xref:System.Windows.DependencyProperty.Register%2A> permettent de spécifier les métadonnées que vous souhaitez lorsque vous inscrivez la propriété.</span><span class="sxs-lookup"><span data-stu-id="5136d-192">Other signatures of <xref:System.Windows.DependencyProperty.Register%2A> allow you to specify the metadata that you want as you register the property.</span></span> <span data-ttu-id="5136d-193">Les métadonnées les plus courantes pour les propriétés de dépendance consistent à leur attribuer une valeur par défaut qui est appliquée sur les nouvelles instances qui utilisent la propriété.</span><span class="sxs-lookup"><span data-stu-id="5136d-193">The most common metadata given for dependency properties is to give them a default value that is applied on new instances that use the property.</span></span>

<span data-ttu-id="5136d-194">Si vous créez une propriété de dépendance qui existe sur une classe dérivée de <xref:System.Windows.FrameworkElement> , vous pouvez utiliser la classe de métadonnées plus spécialisée <xref:System.Windows.FrameworkPropertyMetadata> plutôt que la classe de base <xref:System.Windows.PropertyMetadata> .</span><span class="sxs-lookup"><span data-stu-id="5136d-194">If you are creating a dependency property that exists on a derived class of <xref:System.Windows.FrameworkElement>, you can use the more specialized metadata class <xref:System.Windows.FrameworkPropertyMetadata> rather than the base <xref:System.Windows.PropertyMetadata> class.</span></span> <span data-ttu-id="5136d-195">Le constructeur pour la <xref:System.Windows.FrameworkPropertyMetadata> classe a plusieurs signatures dans lesquelles vous pouvez spécifier différentes caractéristiques de métadonnées en combinaison.</span><span class="sxs-lookup"><span data-stu-id="5136d-195">The constructor for the <xref:System.Windows.FrameworkPropertyMetadata> class has several signatures where you can specify various metadata characteristics in combination.</span></span> <span data-ttu-id="5136d-196">Si vous souhaitez spécifier la valeur par défaut uniquement, utilisez la signature qui accepte un seul paramètre de type <xref:System.Object> .</span><span class="sxs-lookup"><span data-stu-id="5136d-196">If you want to specify the default value only, use the signature that takes a single parameter of type <xref:System.Object>.</span></span> <span data-ttu-id="5136d-197">Transmettez ce paramètre d’objet en tant que valeur par défaut spécifique au type pour votre propriété (la valeur par défaut fournie doit être le type que vous avez fourni comme `propertyType` paramètre dans l' <xref:System.Windows.DependencyProperty.Register%2A> appel).</span><span class="sxs-lookup"><span data-stu-id="5136d-197">Pass that object parameter as a type-specific default value for your property (the default value provided must be the type you provided as the `propertyType` parameter in the <xref:System.Windows.DependencyProperty.Register%2A> call).</span></span>

<span data-ttu-id="5136d-198">Pour <xref:System.Windows.FrameworkPropertyMetadata> , vous pouvez également spécifier des indicateurs d’option de métadonnées pour votre propriété.</span><span class="sxs-lookup"><span data-stu-id="5136d-198">For <xref:System.Windows.FrameworkPropertyMetadata>, you can also specify metadata option flags for your property.</span></span> <span data-ttu-id="5136d-199">Ces indicateurs sont convertis en propriétés discrètes dans les métadonnées de propriété après l’inscription, et sont utilisés pour spécifier certaines conditions à d’autres processus, tels que le moteur de disposition.</span><span class="sxs-lookup"><span data-stu-id="5136d-199">These flags are converted into discrete properties on the property metadata after registration and are used to communicate certain conditionals to other processes such as the layout engine.</span></span>

#### <a name="setting-appropriate-metadata-flags"></a><span data-ttu-id="5136d-200">Définition des indicateurs de métadonnées appropriés</span><span class="sxs-lookup"><span data-stu-id="5136d-200">Setting Appropriate Metadata Flags</span></span>

- <span data-ttu-id="5136d-201">Si votre propriété (ou les modifications de sa valeur) affecte le [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] et, en particulier, affecte la taille ou le rendu de votre élément par le système de disposition dans une page, définissez un ou plusieurs des indicateurs suivants : <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure> , <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange> , <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender> .</span><span class="sxs-lookup"><span data-stu-id="5136d-201">If your property (or changes in its value) affects the [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)], and in particular affects how the layout system should size or render your element in a page, set one or more of the following flags: <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure>, <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange>, <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender>.</span></span>

  - <span data-ttu-id="5136d-202"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure>indique qu’une modification de cette propriété nécessite une modification du [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] rendu où l’objet conteneur peut nécessiter plus ou moins d’espace dans le parent.</span><span class="sxs-lookup"><span data-stu-id="5136d-202"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsMeasure> indicates that a change to this property requires a change to [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] rendering where the containing object might require more or less space within the parent.</span></span> <span data-ttu-id="5136d-203">Par exemple, cet indicateur doit être défini pour une propriété « Width ».</span><span class="sxs-lookup"><span data-stu-id="5136d-203">For example, a "Width" property should have this flag set.</span></span>

  - <span data-ttu-id="5136d-204"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange>indique qu’une modification de cette propriété nécessite une modification [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] du rendu qui ne nécessite généralement pas de modification de l’espace dédié, mais indique que le positionnement dans l’espace a changé.</span><span class="sxs-lookup"><span data-stu-id="5136d-204"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsArrange> indicates that a change to this property requires a change to [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] rendering that typically does not require a change in the dedicated space, but does indicate that the positioning within the space has changed.</span></span> <span data-ttu-id="5136d-205">Par exemple, cet indicateur doit être défini pour une propriété « Alignment ».</span><span class="sxs-lookup"><span data-stu-id="5136d-205">For example, an "Alignment" property should have this flag set.</span></span>

  - <span data-ttu-id="5136d-206"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender>indique qu’une autre modification a eu lieu et n’affecte pas la disposition et la mesure, mais exige un autre rendu.</span><span class="sxs-lookup"><span data-stu-id="5136d-206"><xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsRender> indicates that some other change has occurred that will not affect layout and measure, but does require another render.</span></span> <span data-ttu-id="5136d-207">Un exemple serait une propriété qui change une couleur d’un élément existant, telle que « Background ».</span><span class="sxs-lookup"><span data-stu-id="5136d-207">An example would be a property that changes a color of an existing element, such as "Background".</span></span>

  - <span data-ttu-id="5136d-208">Ces indicateurs sont souvent utilisés comme protocole dans les métadonnées pour vos propres implémentations de substitution de rappels de disposition ou de système de propriétés.</span><span class="sxs-lookup"><span data-stu-id="5136d-208">These flags are often used as a protocol in metadata for your own override implementations of property system or layout callbacks.</span></span> <span data-ttu-id="5136d-209">Par exemple, vous pouvez avoir un <xref:System.Windows.DependencyObject.OnPropertyChanged%2A> rappel qui appellera <xref:System.Windows.UIElement.InvalidateArrange%2A> si une propriété de l’instance signale une modification de valeur et a <xref:System.Windows.FrameworkPropertyMetadata.AffectsArrange%2A> comme `true` dans ses métadonnées.</span><span class="sxs-lookup"><span data-stu-id="5136d-209">For instance, you might have an <xref:System.Windows.DependencyObject.OnPropertyChanged%2A> callback that will call <xref:System.Windows.UIElement.InvalidateArrange%2A> if any property of the instance reports a value change and has <xref:System.Windows.FrameworkPropertyMetadata.AffectsArrange%2A> as `true` in its metadata.</span></span>

- <span data-ttu-id="5136d-210">Certaines propriétés peuvent affecter les caractéristiques de rendu de l’élément parent conteneur, au-delà des modifications de taille requise mentionnées ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="5136d-210">Some properties may affect the rendering characteristics of the containing parent element, in ways above and beyond the changes in required size mentioned above.</span></span> <span data-ttu-id="5136d-211">C’est le cas, par exemple, de la <xref:System.Windows.Documents.Paragraph.MinOrphanLines%2A> propriété utilisée dans le modèle de document dynamique, où les modifications apportées à cette propriété peuvent modifier le rendu global du document dynamique qui contient le paragraphe.</span><span class="sxs-lookup"><span data-stu-id="5136d-211">An example is the <xref:System.Windows.Documents.Paragraph.MinOrphanLines%2A> property used in the flow document model, where changes to that property can change the overall rendering of the flow document that contains the paragraph.</span></span> <span data-ttu-id="5136d-212">Utilisez <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentArrange> ou <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentMeasure> pour identifier des cas similaires dans vos propres propriétés.</span><span class="sxs-lookup"><span data-stu-id="5136d-212">Use <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentArrange> or <xref:System.Windows.FrameworkPropertyMetadataOptions.AffectsParentMeasure> to identify similar cases in your own properties.</span></span>

- <span data-ttu-id="5136d-213">Par défaut, les propriétés de dépendance prennent en charge la liaison de données.</span><span class="sxs-lookup"><span data-stu-id="5136d-213">By default, dependency properties support data binding.</span></span> <span data-ttu-id="5136d-214">Vous pouvez désactiver délibérément la liaison de données, dans les cas où il n’existe aucun scénario réaliste pour elle, ou quand les performances de liaison de données pour un objet volumineux sont reconnues comme étant un problème.</span><span class="sxs-lookup"><span data-stu-id="5136d-214">You can deliberately disable data binding, for cases where there is no realistic scenario for data binding, or where performance in data binding for a large object is recognized as a problem.</span></span>

- <span data-ttu-id="5136d-215">Par défaut, la liaison <xref:System.Windows.Data.Binding.Mode%2A> de données pour les propriétés de dépendance est définie par défaut sur <xref:System.Windows.Data.BindingMode.OneWay> .</span><span class="sxs-lookup"><span data-stu-id="5136d-215">By default, data binding <xref:System.Windows.Data.Binding.Mode%2A> for dependency properties defaults to <xref:System.Windows.Data.BindingMode.OneWay>.</span></span> <span data-ttu-id="5136d-216">Vous pouvez toujours modifier la liaison pour qu’elle soit <xref:System.Windows.Data.BindingMode.TwoWay> par instance de liaison. pour plus d’informations, consultez [spécifier le sens de la liaison](../data/how-to-specify-the-direction-of-the-binding.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-216">You can always change the binding to be <xref:System.Windows.Data.BindingMode.TwoWay> per binding instance; for details, see [Specify the Direction of the Binding](../data/how-to-specify-the-direction-of-the-binding.md).</span></span> <span data-ttu-id="5136d-217">Toutefois, en tant qu’auteur de la propriété de dépendance, vous pouvez choisir de faire en sorte que la propriété utilise le <xref:System.Windows.Data.BindingMode.TwoWay> mode de liaison par défaut.</span><span class="sxs-lookup"><span data-stu-id="5136d-217">But as the dependency property author, you can choose to make the property use <xref:System.Windows.Data.BindingMode.TwoWay> binding mode by default.</span></span> <span data-ttu-id="5136d-218">Un exemple de propriété de dépendance existante est <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A?displayProperty=nameWithType> ; le scénario de cette propriété est que la <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> logique de paramétrage et la composition de <xref:System.Windows.Controls.MenuItem> interagissent avec le style de thème par défaut.</span><span class="sxs-lookup"><span data-stu-id="5136d-218">An example of an existing dependency property is <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A?displayProperty=nameWithType>; the scenario for this property is that the <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> setting logic and the compositing of <xref:System.Windows.Controls.MenuItem> interact with the default theme style.</span></span> <span data-ttu-id="5136d-219">La <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> logique de propriété utilise la liaison de données en mode natif pour conserver l’état de la propriété en fonction d’autres propriétés d’État et des appels de méthode.</span><span class="sxs-lookup"><span data-stu-id="5136d-219">The <xref:System.Windows.Controls.MenuItem.IsSubmenuOpen%2A> property logic uses data binding natively to maintain the state of the property in accordance to other state properties and method calls.</span></span> <span data-ttu-id="5136d-220">Un autre exemple de propriété qui crée une liaison <xref:System.Windows.Data.BindingMode.TwoWay> par défaut est <xref:System.Windows.Controls.TextBox.Text%2A?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="5136d-220">Another example property that binds <xref:System.Windows.Data.BindingMode.TwoWay> by default is <xref:System.Windows.Controls.TextBox.Text%2A?displayProperty=nameWithType>.</span></span>

- <span data-ttu-id="5136d-221">Vous pouvez également activer l’héritage des propriétés dans une propriété de dépendance personnalisée en définissant l' <xref:System.Windows.FrameworkPropertyMetadataOptions.Inherits> indicateur.</span><span class="sxs-lookup"><span data-stu-id="5136d-221">You can also enable property inheritance in a custom dependency property by setting the <xref:System.Windows.FrameworkPropertyMetadataOptions.Inherits> flag.</span></span> <span data-ttu-id="5136d-222">L’héritage de propriété est utile pour un scénario où des éléments parents et des éléments enfants ont une propriété en commun, et où il est logique que les éléments enfants aient la même valeur de propriété que le parent.</span><span class="sxs-lookup"><span data-stu-id="5136d-222">Property inheritance is useful for a scenario where parent elements and child elements have a property in common, and it makes sense for the child elements to have that particular property value set to the same value as the parent set it.</span></span> <span data-ttu-id="5136d-223">Un exemple de propriété héritable est <xref:System.Windows.FrameworkElement.DataContext%2A> , qui est utilisé pour les opérations de liaison pour activer le scénario maître/détail important pour la présentation des données.</span><span class="sxs-lookup"><span data-stu-id="5136d-223">An example inheritable property is <xref:System.Windows.FrameworkElement.DataContext%2A>, which is used for binding operations to enable the important master-detail scenario for data presentation.</span></span> <span data-ttu-id="5136d-224">En rendant <xref:System.Windows.FrameworkElement.DataContext%2A> héritable, tous les éléments enfants héritent également de ce contexte de données.</span><span class="sxs-lookup"><span data-stu-id="5136d-224">By making <xref:System.Windows.FrameworkElement.DataContext%2A> inheritable, any child elements inherit that data context also.</span></span> <span data-ttu-id="5136d-225">En raison de l’héritage de valeur de propriété, vous pouvez spécifier un contexte de données à la racine de la page ou de l’application, et vous n’avez pas besoin de le respécifier pour les liaisons dans tous les éléments enfants possibles.</span><span class="sxs-lookup"><span data-stu-id="5136d-225">Because of property value inheritance, you can specify a data context at the page or application root, and do not need to respecify it for bindings in all possible child elements.</span></span> <span data-ttu-id="5136d-226"><xref:System.Windows.FrameworkElement.DataContext%2A>est également un bon exemple pour illustrer que l’héritage remplace la valeur par défaut, mais qu’elle peut toujours être définie localement sur un élément enfant particulier ; Pour plus d’informations, consultez [utiliser le modèle maître/détail avec des données hiérarchiques](../data/how-to-use-the-master-detail-pattern-with-hierarchical-data.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-226"><xref:System.Windows.FrameworkElement.DataContext%2A> is also a good example to illustrate that inheritance overrides the default value, but it can always be set locally on any particular child element; for details, see [Use the Master-Detail Pattern with Hierarchical Data](../data/how-to-use-the-master-detail-pattern-with-hierarchical-data.md).</span></span> <span data-ttu-id="5136d-227">L’héritage de valeur de propriété peut avoir un impact sur les performances, et doit donc être utilisé avec modération. Pour plus d’informations, consultez [Héritage de la valeur de propriété](property-value-inheritance.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-227">Property value inheritance does have a possible performance cost, and thus should be used sparingly; for details, see [Property Value Inheritance](property-value-inheritance.md).</span></span>

- <span data-ttu-id="5136d-228">Définissez l' <xref:System.Windows.FrameworkPropertyMetadataOptions.Journal> indicateur pour indiquer si votre propriété de dépendance doit être détectée ou utilisée par les services de journalisation de navigation.</span><span class="sxs-lookup"><span data-stu-id="5136d-228">Set the <xref:System.Windows.FrameworkPropertyMetadataOptions.Journal> flag to indicate if your dependency property should be detected or used by navigation journaling services.</span></span> <span data-ttu-id="5136d-229">C’est le cas, par exemple, de la <xref:System.Windows.Controls.Primitives.Selector.SelectedIndex%2A> propriété ; tout élément sélectionné dans un contrôle de sélection doit être rendu persistant lors de la navigation dans l’historique de journalisation.</span><span class="sxs-lookup"><span data-stu-id="5136d-229">An example is the <xref:System.Windows.Controls.Primitives.Selector.SelectedIndex%2A> property; any item selected in a selection control should be persisted when the journaling history is navigated.</span></span>

<a name="RODP"></a>

## <a name="read-only-dependency-properties"></a><span data-ttu-id="5136d-230">Propriétés de dépendance en lecture seule</span><span class="sxs-lookup"><span data-stu-id="5136d-230">Read-Only Dependency Properties</span></span>

<span data-ttu-id="5136d-231">Vous pouvez définir une propriété de dépendance en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="5136d-231">You can define a dependency property that is read-only.</span></span> <span data-ttu-id="5136d-232">Toutefois, les scénarios pour lesquels vous pourriez définir la propriété en lecture seule sont quelque peu différents, tout comme la procédure pour les inscrire auprès du système de propriétés et exposer l’identificateur.</span><span class="sxs-lookup"><span data-stu-id="5136d-232">However, the scenarios for why you might define your property as read-only are somewhat different, as is the procedure for registering them with the property system and exposing the identifier.</span></span> <span data-ttu-id="5136d-233">Pour plus d’informations, consultez [Propriétés de dépendance en lecture seule](read-only-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-233">For more information, see [Read-Only Dependency Properties](read-only-dependency-properties.md).</span></span>

<a name="CTDP"></a>

## <a name="collection-type-dependency-properties"></a><span data-ttu-id="5136d-234">Propriétés de dépendance de type collection</span><span class="sxs-lookup"><span data-stu-id="5136d-234">Collection-Type Dependency Properties</span></span>

<span data-ttu-id="5136d-235">Pour les propriétés de dépendance de type collection, vous devrez prendre en compte certains autres aspects relatifs à l’implémentation.</span><span class="sxs-lookup"><span data-stu-id="5136d-235">Collection-type dependency properties have some additional implementation issues to consider.</span></span> <span data-ttu-id="5136d-236">Pour plus d’informations, consultez [Propriétés de dépendance de type collection](collection-type-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-236">For details, see [Collection-Type Dependency Properties](collection-type-dependency-properties.md).</span></span>

<a name="SecurityC"></a>

## <a name="dependency-property-security-considerations"></a><span data-ttu-id="5136d-237">Considérations relatives à la sécurité des propriétés de dépendance</span><span class="sxs-lookup"><span data-stu-id="5136d-237">Dependency Property Security Considerations</span></span>

<span data-ttu-id="5136d-238">Les propriétés de dépendance doivent être déclarées en tant que propriétés publiques.</span><span class="sxs-lookup"><span data-stu-id="5136d-238">Dependency properties should be declared as public properties.</span></span> <span data-ttu-id="5136d-239">Les champs d’identificateur de propriété de dépendance doivent être déclarés en tant que champs statiques publics.</span><span class="sxs-lookup"><span data-stu-id="5136d-239">Dependency property identifier fields should be declared as public static fields.</span></span> <span data-ttu-id="5136d-240">Même si vous tentez de déclarer d’autres niveaux d’accès (par exemple, protected), une propriété de dépendance est toujours accessible par le biais de l’identificateur en association avec les API du système de propriétés.</span><span class="sxs-lookup"><span data-stu-id="5136d-240">Even if you attempt to declare other access levels (such as protected), a dependency property can always be accessed through the identifier in combination with the property system APIs.</span></span> <span data-ttu-id="5136d-241">Même un champ d’identificateur protégé est potentiellement accessible en raison des API de création de rapports de métadonnées ou de détermination de valeur qui font partie du système de propriétés, tel que <xref:System.Windows.LocalValueEnumerator> .</span><span class="sxs-lookup"><span data-stu-id="5136d-241">Even a protected identifier field is potentially accessible because of metadata reporting or value determination APIs that are part of the property system, such as <xref:System.Windows.LocalValueEnumerator>.</span></span> <span data-ttu-id="5136d-242">Pour plus d’informations, consultez [Sécurité des propriétés de dépendance](dependency-property-security.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-242">For more information, see [Dependency Property Security](dependency-property-security.md).</span></span>

<a name="DPCtor"></a>

## <a name="dependency-properties-and-class-constructors"></a><span data-ttu-id="5136d-243">Propriétés de dépendance et constructeurs de classe</span><span class="sxs-lookup"><span data-stu-id="5136d-243">Dependency Properties and Class Constructors</span></span>

<span data-ttu-id="5136d-244">Il existe un principe fondamental dans la programmation de code managé (souvent appliqué par des outils d’analyse de code tels que FxCop) selon lequel les constructeurs de classe ne doivent pas appeler de méthodes virtuelles.</span><span class="sxs-lookup"><span data-stu-id="5136d-244">There is a general principle in managed code programming (often enforced by code analysis tools such as FxCop) that class constructors should not call virtual methods.</span></span> <span data-ttu-id="5136d-245">Cela est dû au fait que les constructeurs peuvent être appelés en tant qu’initialisation de base d’un constructeur de classe dérivée, et l’entrée dans la méthode virtuelle par l’intermédiaire du constructeur peut se produire à un état d’initialisation incomplet de l’instance d’objet en cours de construction.</span><span class="sxs-lookup"><span data-stu-id="5136d-245">This is because constructors can be called as base initialization of a derived class constructor, and entering the virtual method through the constructor might occur at an incomplete initialization state of the object instance being constructed.</span></span> <span data-ttu-id="5136d-246">Lorsque vous dérivez d’une classe qui dérive déjà de <xref:System.Windows.DependencyObject> , vous devez savoir que le système de propriétés lui-même appelle et expose des méthodes virtuelles en interne.</span><span class="sxs-lookup"><span data-stu-id="5136d-246">When you derive from any class that already derives from <xref:System.Windows.DependencyObject>, you should be aware that the property system itself calls and exposes virtual methods internally.</span></span> <span data-ttu-id="5136d-247">Ces méthodes virtuelles font partie des services du système de propriétés [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="5136d-247">These virtual methods are part of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system services.</span></span> <span data-ttu-id="5136d-248">La substitution des méthodes permet aux classes dérivées de participer à la détermination de valeur.</span><span class="sxs-lookup"><span data-stu-id="5136d-248">Overriding the methods enables derived classes to participate in value determination.</span></span> <span data-ttu-id="5136d-249">Pour éviter les problèmes potentiels liés à l’initialisation au moment de l’exécution, vous ne devez pas définir de valeur de propriété de dépendance dans des constructeurs de classes, sauf si vous respectez un modèle de constructeur très spécifique.</span><span class="sxs-lookup"><span data-stu-id="5136d-249">To avoid potential issues with runtime initialization, you should not set dependency property values within constructors of classes, unless you follow a very specific constructor pattern.</span></span> <span data-ttu-id="5136d-250">Pour plus d’informations, consultez [Modèles de constructeur sécurisé pour DependencyObjects](safe-constructor-patterns-for-dependencyobjects.md).</span><span class="sxs-lookup"><span data-stu-id="5136d-250">For details, see [Safe Constructor Patterns for DependencyObjects](safe-constructor-patterns-for-dependencyobjects.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="5136d-251">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="5136d-251">See also</span></span>

- [<span data-ttu-id="5136d-252">Vue d’ensemble des propriétés de dépendance</span><span class="sxs-lookup"><span data-stu-id="5136d-252">Dependency Properties Overview</span></span>](dependency-properties-overview.md)
- [<span data-ttu-id="5136d-253">Métadonnées de propriété de dépendance</span><span class="sxs-lookup"><span data-stu-id="5136d-253">Dependency Property Metadata</span></span>](dependency-property-metadata.md)
- [<span data-ttu-id="5136d-254">Vue d’ensemble de la création de contrôles</span><span class="sxs-lookup"><span data-stu-id="5136d-254">Control Authoring Overview</span></span>](../controls/control-authoring-overview.md)
- [<span data-ttu-id="5136d-255">Propriétés de dépendance de type collection</span><span class="sxs-lookup"><span data-stu-id="5136d-255">Collection-Type Dependency Properties</span></span>](collection-type-dependency-properties.md)
- [<span data-ttu-id="5136d-256">Sécurité de propriété de dépendance</span><span class="sxs-lookup"><span data-stu-id="5136d-256">Dependency Property Security</span></span>](dependency-property-security.md)
- [<span data-ttu-id="5136d-257">Propriétés de dépendance et chargement XAML</span><span class="sxs-lookup"><span data-stu-id="5136d-257">XAML Loading and Dependency Properties</span></span>](xaml-loading-and-dependency-properties.md)
- [<span data-ttu-id="5136d-258">Modèles de constructeur sécurisé pour DependencyObjects</span><span class="sxs-lookup"><span data-stu-id="5136d-258">Safe Constructor Patterns for DependencyObjects</span></span>](safe-constructor-patterns-for-dependencyobjects.md)

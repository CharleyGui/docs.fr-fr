---
title: WPF et interopérabilité Win32
titleSuffix: ''
ms.date: 03/30/2017
helpviewer_keywords:
- hosting WPF content in Win32 window [WPF]
- HWND interop [WPF]
- Win32 code [WPF], WPF interoperation
- interoperability [WPF], Win32
ms.assetid: 0ffbde0d-701d-45a3-a6fa-dd71f4d9772e
ms.openlocfilehash: 7b7c3ed8f9833094ce1e836c11f84132ae84def2
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/24/2020
ms.locfileid: "76735229"
---
# <a name="wpf-and-win32-interoperation"></a><span data-ttu-id="4c5a5-102">Interopérabilité WPF et Win32</span><span class="sxs-lookup"><span data-stu-id="4c5a5-102">WPF and Win32 Interoperation</span></span>

<span data-ttu-id="4c5a5-103">Cette rubrique fournit une vue d’ensemble de l’interopérabilité de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et du code Win32.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-103">This topic provides an overview of how to interoperate [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and Win32 code.</span></span> [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] <span data-ttu-id="4c5a5-104">propose un environnement de création d'applications élaboré.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-104">provides a rich environment for creating applications.</span></span> <span data-ttu-id="4c5a5-105">Toutefois, lorsque vous avez un investissement important dans du code Win32, il peut être plus efficace de réutiliser une partie de ce code.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-105">However, when you have a substantial investment in Win32 code, it might be more effective to reuse some of that code.</span></span>

<a name="basics"></a>

## <a name="wpf-and-win32-interoperation-basics"></a><span data-ttu-id="4c5a5-106">Notions de base de l’interopérabilité WPF et Win32</span><span class="sxs-lookup"><span data-stu-id="4c5a5-106">WPF and Win32 Interoperation Basics</span></span>

<span data-ttu-id="4c5a5-107">Il existe deux techniques de base pour l’interopérabilité entre les [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et le code Win32.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-107">There are two basic techniques for interoperation between [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and Win32 code.</span></span>

- <span data-ttu-id="4c5a5-108">Hébergez [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu dans une fenêtre Win32.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-108">Host [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window.</span></span> <span data-ttu-id="4c5a5-109">Grâce à cette technique, vous pouvez utiliser les fonctionnalités graphiques avancées de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans le cadre d’une application et d’une fenêtre Win32 standard.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-109">With this technique, you can use the advanced graphics capabilities of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] within the framework of a standard Win32 window and application.</span></span>

- <span data-ttu-id="4c5a5-110">Hébergez une fenêtre Win32 dans le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4c5a5-110">Host a Win32 window in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span> <span data-ttu-id="4c5a5-111">Avec cette technique, vous pouvez utiliser un contrôle Win32 personnalisé existant dans le contexte d’autres [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] du contenu, et passer des données entre les limites.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-111">With this technique, you can use an existing custom Win32 control in the context of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and pass data across the boundaries.</span></span>

<span data-ttu-id="4c5a5-112">Cette rubrique présente les concepts inhérents à chacune de ces techniques.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-112">Each of these techniques is conceptually introduced in this topic.</span></span> <span data-ttu-id="4c5a5-113">Pour une illustration plus orientée code de l’hébergement d' [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans Win32, consultez [procédure pas à pas : Hébergement de contenu WPF dans Win32](walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-113">For a more code-oriented illustration of hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in Win32, see [Walkthrough: Hosting WPF Content in Win32](walkthrough-hosting-wpf-content-in-win32.md).</span></span> <span data-ttu-id="4c5a5-114">Pour une illustration plus orientée code de l’hébergement de Win32 dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], consultez [procédure pas à pas : Hébergement d’un contrôle Win32 dans WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-114">For a more code-oriented illustration of hosting Win32 in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Walkthrough: Hosting a Win32 Control in WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>

<a name="projects"></a>

## <a name="wpf-interoperation-projects"></a><span data-ttu-id="4c5a5-115">Projets d’interopérabilité WPF</span><span class="sxs-lookup"><span data-stu-id="4c5a5-115">WPF Interoperation Projects</span></span>

<span data-ttu-id="4c5a5-116">les API [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sont du code managé, mais la plupart des programmes Win32 existants sont écrits C++en non managés.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-116">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] APIs are managed code, but most existing Win32 programs are written in unmanaged C++.</span></span>  <span data-ttu-id="4c5a5-117">Vous ne pouvez pas appeler des API [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] à partir d’un véritable programme non managé.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-117">You cannot call [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] APIs from a true unmanaged program.</span></span> <span data-ttu-id="4c5a5-118">Toutefois, à l’aide de l’option `/clr` avec le C++ compilateur Microsoft Visual, vous pouvez créer un programme managé non managé mixte dans lequel vous pouvez mélanger en toute transparence des appels d’API managés et non managés.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-118">However, by using the `/clr` option with the Microsoft Visual C++ compiler, you can create a mixed managed-unmanaged program where you can seamlessly mix managed and unmanaged API calls.</span></span>

<span data-ttu-id="4c5a5-119">Une complication au niveau du projet est que vous ne pouvez pas compiler [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] C++ fichiers dans un projet.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-119">One project-level complication is that you cannot compile [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] files into a C++ project.</span></span>  <span data-ttu-id="4c5a5-120">Il existe toutefois plusieurs techniques de division du projet qui permettent de contourner ce problème.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-120">There are several project division techniques to compensate for this.</span></span>

- <span data-ttu-id="4c5a5-121">Créez une C# dll qui contient toutes vos pages [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] en tant qu’assembly compilé, puis faites C++ en sorte que votre exécutable inclue cette dll comme référence.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-121">Create a C# DLL that contains all your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] pages as a compiled assembly, and then have your C++ executable include that DLL as a reference.</span></span>

- <span data-ttu-id="4c5a5-122">Créer un C# exécutable pour le contenu de la [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et faire référence à une C++ dll qui contient le contenu Win32.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-122">Create a C# executable for the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content, and have it reference a C++ DLL that contains the Win32 content.</span></span>

- <span data-ttu-id="4c5a5-123">Utilisez <xref:System.Windows.Markup.XamlReader.Load%2A> pour charger des [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] au moment de l’exécution, au lieu de compiler votre [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4c5a5-123">Use <xref:System.Windows.Markup.XamlReader.Load%2A> to load any [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at run time, instead of compiling your [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span>

- <span data-ttu-id="4c5a5-124">N’utilisez pas de [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], et écrivez toutes vos [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans le code, en créant l’arborescence d’éléments à partir de <xref:System.Windows.Application>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-124">Do not use [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] at all, and write all your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in code, building up the element tree from <xref:System.Windows.Application>.</span></span>

<span data-ttu-id="4c5a5-125">Utilisez la technique qui vous convient le mieux.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-125">Use whatever approach works best for you.</span></span>

> [!NOTE]
> <span data-ttu-id="4c5a5-126">Si vous n’avez pas C++déjà utilisé/CLI, vous remarquerez peut-être des mots clés « nouveaux », tels que `gcnew` et `nullptr` dans les exemples de code d’interopérabilité.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-126">If you have not used C++/CLI before, you might notice some "new" keywords such as `gcnew` and `nullptr` in the interoperation code examples.</span></span> <span data-ttu-id="4c5a5-127">Ces mots clés remplacent l’ancienne syntaxe de double trait de soulignement (`__gc`) et fournissent une syntaxe plus naturelle C++pour le code managé dans.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-127">These keywords supersede the older double-underscore syntax (`__gc`) and provide a more natural syntax for managed code in C++.</span></span>  <span data-ttu-id="4c5a5-128">Pour en savoir plus sur C++les fonctionnalités managées/CLI, consultez [extensions de composant pour les plateformes Runtime](/cpp/windows/component-extensions-for-runtime-platforms).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-128">To learn more about the C++/CLI managed features, see [Component Extensions for Runtime Platforms](/cpp/windows/component-extensions-for-runtime-platforms).</span></span>

<a name="hwnds"></a>

## <a name="how-wpf-uses-hwnds"></a><span data-ttu-id="4c5a5-129">Utilisation des HWND par WPF</span><span class="sxs-lookup"><span data-stu-id="4c5a5-129">How WPF Uses Hwnds</span></span>

<span data-ttu-id="4c5a5-130">Pour tirer le meilleur parti de l’interopérabilité HWND dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], vous devez comprendre de quelle façon [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] utilise les HWND.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-130">To make the most of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] "HWND interop", you need to understand how [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] uses HWNDs.</span></span> <span data-ttu-id="4c5a5-131">Pour un HWND, vous ne pouvez pas mélanger [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rendu avec le rendu DirectX ou le rendu GDI/GDI+.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-131">For any HWND, you cannot mix [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] rendering with DirectX rendering or GDI / GDI+ rendering.</span></span> <span data-ttu-id="4c5a5-132">Ceci a plusieurs implications.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-132">This has a number of implications.</span></span> <span data-ttu-id="4c5a5-133">D’une part, pour pouvoir combiner ces modèles de rendu, vous devez créer une solution d’interopérabilité et utiliser les segments d’interopérabilité désignés pour chaque modèle de rendu à utiliser.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-133">Primarily, in order to mix these rendering models at all, you must create an interoperation solution, and use designated segments of interoperation for each rendering model that you choose to use.</span></span> <span data-ttu-id="4c5a5-134">D’autre part, le comportement de rendu crée une restriction d’« espace de rendu » (« airspace » en anglais) relative aux objectifs de la solution d’interopérabilité.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-134">Also, the rendering behavior creates an "airspace" restriction for what your interoperation solution can accomplish.</span></span> <span data-ttu-id="4c5a5-135">Le concept d’« espace de rendu » est expliqué en détail dans la rubrique [Vue d’ensemble des régions de technologie](technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-135">The "airspace" concept is explained in greater detail in the topic [Technology Regions Overview](technology-regions-overview.md).</span></span>

<span data-ttu-id="4c5a5-136">Tous les éléments [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] affichés sont stockés par un HWND.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-136">All [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements on the screen are ultimately backed by a HWND.</span></span> <span data-ttu-id="4c5a5-137">Lorsque vous créez un [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window>, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] crée un HWND de niveau supérieur et utilise une <xref:System.Windows.Interop.HwndSource> pour placer le <xref:System.Windows.Window> et son contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans le HWND.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-137">When you create a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window>, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] creates a top-level HWND, and uses an <xref:System.Windows.Interop.HwndSource> to put the <xref:System.Windows.Window> and its [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content inside the HWND.</span></span>  <span data-ttu-id="4c5a5-138">Le reste du contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans l’application partage ce HWND spécifique.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-138">The rest of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in the application shares that singular HWND.</span></span> <span data-ttu-id="4c5a5-139">Les menus, les zones de liste déroulante et les autres menus contextuels constituent une exception à ce principe.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-139">An exception is menus, combo box drop downs, and other pop-ups.</span></span> <span data-ttu-id="4c5a5-140">Ces éléments créent leur propre fenêtre de niveau supérieur, ce qui explique pourquoi un menu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] peut potentiellement dépasser le bord du HWND de fenêtre qui le contient.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-140">These elements create their own top-level window, which is why a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] menu can potentially go past the edge of the window HWND that contains it.</span></span> <span data-ttu-id="4c5a5-141">Lorsque vous utilisez <xref:System.Windows.Interop.HwndHost> pour placer un HWND à l’intérieur d' [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informe Win32 comment positionner le nouveau HWND enfant par rapport au [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> HWND.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-141">When you use <xref:System.Windows.Interop.HwndHost> to put an HWND inside [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] informs Win32 how to position the new child HWND relative to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.Window> HWND.</span></span>

<span data-ttu-id="4c5a5-142">La transparence dans et entre les HWND est un concept connexe des HWND.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-142">A related concept to HWND is transparency within and between each HWND.</span></span> <span data-ttu-id="4c5a5-143">Ceci est également expliqué dans la rubrique [Vue d’ensemble des régions de technologie](technology-regions-overview.md).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-143">This is also discussed in the topic [Technology Regions Overview](technology-regions-overview.md).</span></span>

<a name="hosting_a_wpf_page"></a>

## <a name="hosting-wpf-content-in-a-microsoft-win32-window"></a><span data-ttu-id="4c5a5-144">Hébergement de contenu WPF dans une fenêtre Microsoft Win32</span><span class="sxs-lookup"><span data-stu-id="4c5a5-144">Hosting WPF Content in a Microsoft Win32 Window</span></span>

<span data-ttu-id="4c5a5-145">La clé de l’hébergement d’un [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] sur une fenêtre Win32 est la classe <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-145">The key to hosting a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] on a Win32 window is the <xref:System.Windows.Interop.HwndSource> class.</span></span> <span data-ttu-id="4c5a5-146">Cette classe encapsule le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans une fenêtre Win32, afin que le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] puisse être incorporé dans votre [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] en tant que fenêtre enfant.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-146">This class wraps the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content in a Win32 window, so that the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content can be incorporated into your [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] as a child window.</span></span> <span data-ttu-id="4c5a5-147">L’approche suivante combine les [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Win32 et dans une même application.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-147">The following approach combines the Win32 and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] in a single application.</span></span>

1. <span data-ttu-id="4c5a5-148">Implémentez le contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (l’élément racine du contenu) comme une classe managée.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-148">Implement your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content (the content root element) as a managed class.</span></span> <span data-ttu-id="4c5a5-149">En règle générale, la classe hérite de l’une des classes pouvant contenir plusieurs éléments enfants et/ou utilisée en tant qu’élément racine, par exemple <xref:System.Windows.Controls.DockPanel> ou <xref:System.Windows.Controls.Page>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-149">Typically, the class inherits from one of the classes that can contain multiple child elements and/or used as a root element, such as <xref:System.Windows.Controls.DockPanel> or <xref:System.Windows.Controls.Page>.</span></span> <span data-ttu-id="4c5a5-150">Dans les étapes suivantes, cette classe est appelée « classe de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] » et les instances de la classe sont appelées « objets de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] ».</span><span class="sxs-lookup"><span data-stu-id="4c5a5-150">In subsequent steps, this class is referred to as the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class, and instances of the class are referred to as [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content objects.</span></span>

2. <span data-ttu-id="4c5a5-151">Implémenter une application Windows C++avec/CLI.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-151">Implement a Windows application with C++/CLI.</span></span> <span data-ttu-id="4c5a5-152">Si vous démarrez avec une C++ application non managée existante, vous pouvez généralement lui permettre d’appeler du code managé en modifiant les paramètres de votre projet de façon à inclure l’indicateur `/clr` du compilateur (la portée complète de ce qui peut être nécessaire pour prendre en charge `/clr` compilation n’est pas décrite dans cette rubrique).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-152">If you are starting with an existing unmanaged C++ application, you can usually enable it to call managed code by changing your project settings to include the `/clr` compiler flag (the full scope of what might be necessary to support `/clr` compilation is not described in this topic).</span></span>

3. <span data-ttu-id="4c5a5-153">Définissez le thread unique cloisonné (STA) comme modèle de thread.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-153">Set the threading model to Single Threaded Apartment (STA).</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="4c5a5-154">utilise ce modèle de thread.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-154">uses this threading model.</span></span>

4. <span data-ttu-id="4c5a5-155">Gérez la notification WM_CREATE dans votre procédure de fenêtre.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-155">Handle the WM_CREATE notification in your window procedure.</span></span>

5. <span data-ttu-id="4c5a5-156">Dans le gestionnaire (ou une fonction appelée par le gestionnaire), effectuez les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="4c5a5-156">Within the handler (or a function that the handler calls), do the following:</span></span>

    1. <span data-ttu-id="4c5a5-157">Créez un objet <xref:System.Windows.Interop.HwndSource> avec le HWND de la fenêtre parente comme paramètre `parent`.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-157">Create a new <xref:System.Windows.Interop.HwndSource> object with the parent window HWND as its `parent` parameter.</span></span>

    2. <span data-ttu-id="4c5a5-158">Créez une instance de la classe de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4c5a5-158">Create an instance of your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class.</span></span>

    3. <span data-ttu-id="4c5a5-159">Assignez une référence à l’objet de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] à la propriété <xref:System.Windows.Interop.HwndSource.RootVisual%2A> de l’objet <xref:System.Windows.Interop.HwndSource>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-159">Assign a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object to the <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.RootVisual%2A> property.</span></span>

    4. <span data-ttu-id="4c5a5-160">La propriété <xref:System.Windows.Interop.HwndSource.Handle%2A> de l’objet <xref:System.Windows.Interop.HwndSource> contient le handle de fenêtre (HWND).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-160">The <xref:System.Windows.Interop.HwndSource> object <xref:System.Windows.Interop.HwndSource.Handle%2A> property contains the window handle (HWND).</span></span> <span data-ttu-id="4c5a5-161">Pour obtenir un HWND que vous pouvez utiliser dans la partie non managée de l'application, effectuez un cast de `Handle.ToPointer()` en HWND.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-161">To get an HWND that you can use in the unmanaged part of your application, cast `Handle.ToPointer()` to an HWND.</span></span>

6. <span data-ttu-id="4c5a5-162">Implémentez une classe managée qui contient un champ statique comportant une référence à l’objet de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4c5a5-162">Implement a managed class that contains a static field that holds a reference to your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object.</span></span> <span data-ttu-id="4c5a5-163">Cette classe vous permet d’obtenir une référence à l’objet de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] à partir de votre code Win32, mais plus important encore, il empêche vos <xref:System.Windows.Interop.HwndSource> de faire l’objet d’un garbage collection par inadvertance.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-163">This class allows you to get a reference to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object from your Win32 code, but more importantly it prevents your <xref:System.Windows.Interop.HwndSource> from being inadvertently garbage collected.</span></span>

7. <span data-ttu-id="4c5a5-164">Recevez les notifications de l’objet de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] en attachant un gestionnaire à un ou plusieurs événements de l’objet de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4c5a5-164">Receive notifications from the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by attaching a handler to one or more of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object events.</span></span>

8. <span data-ttu-id="4c5a5-165">Communiquez avec l’objet de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] en utilisant la référence que vous avez stockée dans le champ statique pour définir les propriétés, les méthodes d’appel, etc.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-165">Communicate with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content object by using the reference that you stored in the static field to set properties, call methods, etc.</span></span>

> [!NOTE]
> <span data-ttu-id="4c5a5-166">Vous pouvez faire une partie ou la totalité de la définition de la classe de contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de la première étape dans [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] à l’aide de la classe partielle par défaut de la classe de contenu, à condition de créer un assembly distinct et de le référencer.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-166">You can do some or all of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content class definition for Step One in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] using the default partial class of the content class, if you produce a separate assembly and then reference it.</span></span> <span data-ttu-id="4c5a5-167">Même si vous incluez généralement un objet <xref:System.Windows.Application> dans le cadre de la compilation du [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] dans un assembly, vous n’utilisez pas ce <xref:System.Windows.Application> dans le cadre de l’interopérabilité, vous utilisez simplement une ou plusieurs des classes racine pour les fichiers [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] référencés par l’application et référencent leurs classes partielles.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-167">Although you typically include an <xref:System.Windows.Application> object as part of compiling the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] into an assembly, you do not end up using that <xref:System.Windows.Application> as part of the interoperation, you just use one or more of the root classes for [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] files referred to by the application and reference their partial classes.</span></span> <span data-ttu-id="4c5a5-168">Le reste de la procédure est quasiment identique à celle présentée ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-168">The remainder of the procedure is essentially similar to that outlined above.</span></span>
>
> <span data-ttu-id="4c5a5-169">Chacune de ces étapes est illustrée par du code dans la rubrique [Procédure pas à pas : hébergement de contenu WPF dans Win32](walkthrough-hosting-wpf-content-in-win32.md).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-169">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting WPF Content in Win32](walkthrough-hosting-wpf-content-in-win32.md).</span></span>

<a name="hosting_an_hwnd"></a>

## <a name="hosting-a-microsoft-win32-window-in-wpf"></a><span data-ttu-id="4c5a5-170">Hébergement d’une fenêtre Microsoft Win32 dans WPF</span><span class="sxs-lookup"><span data-stu-id="4c5a5-170">Hosting a Microsoft Win32 Window in WPF</span></span>

<span data-ttu-id="4c5a5-171">La clé de l’hébergement d’une fenêtre Win32 dans d’autres [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contenu est la classe <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-171">The key to hosting a Win32 window within other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content is the <xref:System.Windows.Interop.HwndHost> class.</span></span> <span data-ttu-id="4c5a5-172">Cette classe inclut la fenêtre dans un wrapper dans un élément [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] qui peut être ajouté à une arborescence d’éléments [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="4c5a5-172">This class wraps the window in a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element which can be added to a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element tree.</span></span> <span data-ttu-id="4c5a5-173"><xref:System.Windows.Interop.HwndHost> prend également en charge les API qui vous permettent d’effectuer des tâches telles que traiter des messages pour la fenêtre hébergée.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-173"><xref:System.Windows.Interop.HwndHost> also supports APIs that allow you to do such tasks as process messages for the hosted window.</span></span> <span data-ttu-id="4c5a5-174">La procédure de base est la suivante :</span><span class="sxs-lookup"><span data-stu-id="4c5a5-174">The basic procedure is:</span></span>

1. <span data-ttu-id="4c5a5-175">Créez une arborescence d’éléments pour une application [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] (à l’aide de code ou de balises).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-175">Create an element tree for a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application (can be through code or markup).</span></span> <span data-ttu-id="4c5a5-176">Recherchez un point approprié et autorisé dans l’arborescence d’éléments où l’implémentation de <xref:System.Windows.Interop.HwndHost> peut être ajoutée en tant qu’élément enfant.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-176">Find an appropriate and permissible point in the element tree where the <xref:System.Windows.Interop.HwndHost> implementation can be added as a child element.</span></span> <span data-ttu-id="4c5a5-177">Dans les étapes suivantes, cet élément est appelé élément de réservation.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-177">In the remainder of these steps, this element is referred to as the reserving element.</span></span>

2. <span data-ttu-id="4c5a5-178">Dérivez de <xref:System.Windows.Interop.HwndHost> pour créer un objet qui contient votre contenu Win32.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-178">Derive from <xref:System.Windows.Interop.HwndHost> to create an object that holds your Win32 content.</span></span>

3. <span data-ttu-id="4c5a5-179">Dans cette classe hôte, substituez la méthode <xref:System.Windows.Interop.HwndHost> <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-179">In that host class, override the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.BuildWindowCore%2A>.</span></span> <span data-ttu-id="4c5a5-180">Retournez le HWND de la fenêtre hébergée.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-180">Return the HWND of the hosted window.</span></span> <span data-ttu-id="4c5a5-181">Vous pouvez inclure le ou les contrôles réels dans un wrapper comme une fenêtre enfant de la fenêtre retournée. L’inclusion des contrôles dans un wrapper dans une fenêtre hôte permet au contenu [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] de recevoir facilement les notifications des contrôles.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-181">You might want to wrap the actual control(s) as a child window of the returned window; wrapping the controls in a host window provides a simple way for your [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content to receive notifications from the controls.</span></span> <span data-ttu-id="4c5a5-182">Cette technique permet de corriger certains problèmes Win32 relatifs à la gestion des messages au niveau de la limite du contrôle hébergé.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-182">This technique helps correct for some Win32 issues regarding message handling at the hosted control boundary.</span></span>

4. <span data-ttu-id="4c5a5-183">Substituez les méthodes de <xref:System.Windows.Interop.HwndHost> <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> et <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-183">Override the <xref:System.Windows.Interop.HwndHost> methods <xref:System.Windows.Interop.HwndHost.DestroyWindowCore%2A> and <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span> <span data-ttu-id="4c5a5-184">L’objectif est d’effectuer un nettoyage et de supprimer les références au contenu hébergé, en particulier si vous avez créé des références à des objets non managés.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-184">The intention here is to process cleanup and remove references to the hosted content, particularly if you created references to unmanaged objects.</span></span>

5. <span data-ttu-id="4c5a5-185">Dans votre fichier code-behind, créez une instance de la classe d’hébergement de contrôle et définissez-la comme enfant de l’élément de réservation.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-185">In your code-behind file, create an instance of the control hosting class and make it a child of the reserving element.</span></span> <span data-ttu-id="4c5a5-186">En général, vous utilisez un gestionnaire d’événements tel que <xref:System.Windows.FrameworkElement.Loaded>, ou vous utilisez le constructeur de classe partielle.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-186">Typically you would use an event handler such as <xref:System.Windows.FrameworkElement.Loaded>, or use the partial class constructor.</span></span> <span data-ttu-id="4c5a5-187">Vous pouvez également ajouter le contenu d’interopérabilité via un comportement au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-187">But you could also add the interoperation content through a runtime behavior.</span></span>

6. <span data-ttu-id="4c5a5-188">Traitez les messages de fenêtre sélectionnés, tels que les notifications de contrôle.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-188">Process selected window messages, such as control notifications.</span></span> <span data-ttu-id="4c5a5-189">Il y a deux approches possibles, qui fournissent un accès identique au flux de messages.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-189">There are two approaches.</span></span> <span data-ttu-id="4c5a5-190">Votre choix est donc essentiellement motivé par le côté pratique de la programmation.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-190">Both provide identical access to the message stream, so your choice is largely a matter of programming convenience.</span></span>

    - <span data-ttu-id="4c5a5-191">Implémentez le traitement des messages pour tous les messages (pas seulement les messages d’arrêt) dans votre remplacement de la méthode <xref:System.Windows.Interop.HwndHost> <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-191">Implement message processing for all messages (not just shutdown messages) in your override of the <xref:System.Windows.Interop.HwndHost> method <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>

    - <span data-ttu-id="4c5a5-192">Faire en sorte que l’élément [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] d’hébergement traite les messages en gérant l’événement <xref:System.Windows.Interop.HwndHost.MessageHook>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-192">Have the hosting [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] element process the messages by handling the <xref:System.Windows.Interop.HwndHost.MessageHook> event.</span></span> <span data-ttu-id="4c5a5-193">Cet événement est déclenché pour chaque message qui est envoyé à la procédure de fenêtre principale de la fenêtre hébergée.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-193">This event is raised for every message that is sent to the main window procedure of the hosted window.</span></span>

    - <span data-ttu-id="4c5a5-194">Vous ne pouvez pas traiter les messages de Windows qui sont en dehors du processus à l’aide de <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-194">You cannot process messages from windows that are out of process using <xref:System.Windows.Interop.HwndHost.WndProc%2A>.</span></span>

7. <span data-ttu-id="4c5a5-195">Communiquez avec la fenêtre hébergée en effectuant un appel de code non managé pour appeler la fonction `SendMessage` non managée.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-195">Communicate with the hosted window by using platform invoke to call the unmanaged `SendMessage` function.</span></span>

<span data-ttu-id="4c5a5-196">L’exécution de ces étapes crée une application qui fonctionne avec des entrées de la souris.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-196">Following these steps creates an application that works with mouse input.</span></span> <span data-ttu-id="4c5a5-197">Vous pouvez ajouter la prise en charge de la tabulation pour la fenêtre hébergée en implémentant l’interface <xref:System.Windows.Interop.IKeyboardInputSink>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-197">You can add tabbing support for your hosted window by implementing the <xref:System.Windows.Interop.IKeyboardInputSink> interface.</span></span>

<span data-ttu-id="4c5a5-198">Chacune de ces étapes est illustrée par du code dans la rubrique [Procédure pas à pas : hébergement d’un contrôle Win32 dans WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-198">Each of these steps is illustrated through code in the topic [Walkthrough: Hosting a Win32 Control in WPF](walkthrough-hosting-a-win32-control-in-wpf.md).</span></span>

### <a name="hwnds-inside-wpf"></a><span data-ttu-id="4c5a5-199">HWND dans WPF</span><span class="sxs-lookup"><span data-stu-id="4c5a5-199">Hwnds Inside WPF</span></span>

<span data-ttu-id="4c5a5-200">Vous pouvez considérer <xref:System.Windows.Interop.HwndHost> comme un contrôle spécial.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-200">You can think of <xref:System.Windows.Interop.HwndHost> as a special control.</span></span> <span data-ttu-id="4c5a5-201">(Techniquement, <xref:System.Windows.Interop.HwndHost> est une <xref:System.Windows.FrameworkElement> classe dérivée, et non une classe dérivée <xref:System.Windows.Controls.Control>, mais elle peut être considérée comme un contrôle à des fins d’interopérabilité.) <xref:System.Windows.Interop.HwndHost> soustrait la nature Win32 sous-jacente du contenu hébergé de telle sorte que le reste de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] considère le contenu hébergé comme un autre objet de contrôle, qui doit afficher et traiter l’entrée.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-201">(Technically, <xref:System.Windows.Interop.HwndHost> is a <xref:System.Windows.FrameworkElement> derived class, not a <xref:System.Windows.Controls.Control> derived class, but it can be considered a control for purposes of interoperation.) <xref:System.Windows.Interop.HwndHost> abstracts the underlying Win32 nature of the hosted content such that the remainder of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] considers the hosted content to be another control-like object, which should render and process input.</span></span> <span data-ttu-id="4c5a5-202"><xref:System.Windows.Interop.HwndHost> se comporte généralement comme tout autre [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, bien qu’il existe des différences importantes entre la sortie (dessin et graphiques) et l’entrée (souris et clavier) en fonction des limitations de ce que les HWND sous-jacents peuvent prendre en charge.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-202"><xref:System.Windows.Interop.HwndHost> generally behaves like any other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.FrameworkElement>, although there are some important differences around output (drawing and graphics) and input (mouse and keyboard) based on limitations of what the underlying HWNDs can support.</span></span>

#### <a name="notable-differences-in-output-behavior"></a><span data-ttu-id="4c5a5-203">Principales différences dans le comportement de sortie</span><span class="sxs-lookup"><span data-stu-id="4c5a5-203">Notable Differences in Output Behavior</span></span>

- <span data-ttu-id="4c5a5-204"><xref:System.Windows.FrameworkElement>, qui est la classe de base <xref:System.Windows.Interop.HwndHost>, a de nombreuses propriétés qui impliquent des modifications apportées à l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-204"><xref:System.Windows.FrameworkElement>, which is the <xref:System.Windows.Interop.HwndHost> base class, has quite a few properties that imply changes to the UI.</span></span> <span data-ttu-id="4c5a5-205">Celles-ci incluent des propriétés telles que <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>, qui modifie la disposition des éléments dans cet élément en tant que parent.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-205">These include properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A?displayProperty=nameWithType>, which changes the layout of elements within that element as a parent.</span></span> <span data-ttu-id="4c5a5-206">Toutefois, la plupart de ces propriétés ne sont pas mappées à des équivalents Win32 possibles, même si ces équivalents peuvent exister.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-206">However, most of these properties are not mapped to possible Win32 equivalents, even if such equivalents might exist.</span></span> <span data-ttu-id="4c5a5-207">Un trop grand nombre de ces propriétés et de leurs significations reposent essentiellement sur la technologie de rendu, ce qui rend les mappages difficiles à utiliser.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-207">Too many of these properties and their meanings are too rendering-technology specific for mappings to be practical.</span></span> <span data-ttu-id="4c5a5-208">Par conséquent, la définition de propriétés telles que <xref:System.Windows.FrameworkElement.FlowDirection%2A> sur <xref:System.Windows.Interop.HwndHost> n’a aucun effet.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-208">Therefore, setting properties such as <xref:System.Windows.FrameworkElement.FlowDirection%2A> on <xref:System.Windows.Interop.HwndHost> has no effect.</span></span>

- <span data-ttu-id="4c5a5-209">les <xref:System.Windows.Interop.HwndHost> ne peuvent pas être pivotées, mises à l’échelle, inclinées ou affectées par une transformation.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-209"><xref:System.Windows.Interop.HwndHost> cannot be rotated, scaled, skewed, or otherwise affected by a Transform.</span></span>

- <span data-ttu-id="4c5a5-210"><xref:System.Windows.Interop.HwndHost> ne prend pas en charge la propriété <xref:System.Windows.UIElement.Opacity%2A> (fusion alpha).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-210"><xref:System.Windows.Interop.HwndHost> does not support the <xref:System.Windows.UIElement.Opacity%2A> property (alpha blending).</span></span> <span data-ttu-id="4c5a5-211">Si le contenu à l’intérieur du <xref:System.Windows.Interop.HwndHost> effectue des opérations <xref:System.Drawing> qui incluent des informations alpha, qui n’est pas une violation, mais le <xref:System.Windows.Interop.HwndHost> dans son ensemble prend uniquement en charge l’opacité = 1,0 (100%).</span><span class="sxs-lookup"><span data-stu-id="4c5a5-211">If content inside the <xref:System.Windows.Interop.HwndHost> performs <xref:System.Drawing> operations that include alpha information, that is itself not a violation, but the <xref:System.Windows.Interop.HwndHost> as a whole only supports Opacity = 1.0 (100%).</span></span>

- <span data-ttu-id="4c5a5-212"><xref:System.Windows.Interop.HwndHost> s’affiche au-dessus des autres éléments [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dans la même fenêtre de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-212"><xref:System.Windows.Interop.HwndHost> will appear on top of other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements in the same top-level window.</span></span> <span data-ttu-id="4c5a5-213">Toutefois, un menu <xref:System.Windows.Controls.ToolTip> ou <xref:System.Windows.Controls.ContextMenu> généré est une fenêtre de niveau supérieur distincte, ce qui se comportera correctement avec <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-213">However, a <xref:System.Windows.Controls.ToolTip> or <xref:System.Windows.Controls.ContextMenu> generated menu is a separate top-level window, and so will behave correctly with <xref:System.Windows.Interop.HwndHost>.</span></span>

- <span data-ttu-id="4c5a5-214"><xref:System.Windows.Interop.HwndHost> ne respecte pas la zone de découpage de son <xref:System.Windows.UIElement>parent.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-214"><xref:System.Windows.Interop.HwndHost> does not respect the clipping region of its parent <xref:System.Windows.UIElement>.</span></span> <span data-ttu-id="4c5a5-215">Cela peut poser problème si vous tentez de placer une classe <xref:System.Windows.Interop.HwndHost> à l’intérieur d’une zone de défilement ou d' <xref:System.Windows.Controls.Canvas>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-215">This is potentially an issue if you attempt to put an <xref:System.Windows.Interop.HwndHost> class inside a scrolling region or <xref:System.Windows.Controls.Canvas>.</span></span>

#### <a name="notable-differences-in-input-behavior"></a><span data-ttu-id="4c5a5-216">Principales différences dans le comportement d’entrée</span><span class="sxs-lookup"><span data-stu-id="4c5a5-216">Notable Differences in Input Behavior</span></span>

- <span data-ttu-id="4c5a5-217">En général, alors que les appareils d’entrée sont étendus dans la région Win32 hébergée <xref:System.Windows.Interop.HwndHost>, les événements d’entrée sont directement dirigés vers Win32.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-217">In general, while input devices are scoped within the <xref:System.Windows.Interop.HwndHost> hosted Win32 region, input events go directly to Win32.</span></span>

- <span data-ttu-id="4c5a5-218">Lorsque la souris se trouve sur le <xref:System.Windows.Interop.HwndHost>, votre application ne reçoit pas d’événements de souris [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et la valeur de la propriété [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.UIElement.IsMouseOver%2A> est `false`.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-218">While the mouse is over the <xref:System.Windows.Interop.HwndHost>, your application does not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] mouse events, and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsMouseOver%2A> will be `false`.</span></span>

- <span data-ttu-id="4c5a5-219">Si le <xref:System.Windows.Interop.HwndHost> a le focus clavier, votre application ne recevra pas d’événements de clavier [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et la valeur de la propriété [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> sera `false`.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-219">While the <xref:System.Windows.Interop.HwndHost> has keyboard focus, your application will not receive [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] keyboard events and the value of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> will be `false`.</span></span>

- <span data-ttu-id="4c5a5-220">Lorsque le focus se trouve dans le <xref:System.Windows.Interop.HwndHost> et que les modifications apportées à un autre contrôle à l’intérieur du <xref:System.Windows.Interop.HwndHost>, votre application ne reçoit pas les événements [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <xref:System.Windows.UIElement.GotFocus> ou <xref:System.Windows.UIElement.LostFocus>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-220">When focus is within the <xref:System.Windows.Interop.HwndHost> and changes to another control inside the <xref:System.Windows.Interop.HwndHost>, your application will not receive the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] events <xref:System.Windows.UIElement.GotFocus> or <xref:System.Windows.UIElement.LostFocus>.</span></span>

- <span data-ttu-id="4c5a5-221">Les propriétés et les événements de stylet associés sont analogues et ne signalent pas d’informations lorsque le stylet se trouve sur <xref:System.Windows.Interop.HwndHost>.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-221">Related stylus properties and events are analogous, and do not report information while the stylus is over <xref:System.Windows.Interop.HwndHost>.</span></span>

<a name="tabbing_mnemonics_accelerators"></a>

## <a name="tabbing-mnemonics-and-accelerators"></a><span data-ttu-id="4c5a5-222">Tabulation, mnémoniques et accélérateurs</span><span class="sxs-lookup"><span data-stu-id="4c5a5-222">Tabbing, Mnemonics, and Accelerators</span></span>

<span data-ttu-id="4c5a5-223">Les interfaces <xref:System.Windows.Interop.IKeyboardInputSink> et <xref:System.Windows.Interop.IKeyboardInputSite> vous permettent de créer une expérience clavier transparente pour les applications mixtes [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et Win32 :</span><span class="sxs-lookup"><span data-stu-id="4c5a5-223">The <xref:System.Windows.Interop.IKeyboardInputSink> and <xref:System.Windows.Interop.IKeyboardInputSite> interfaces allow you to create a seamless keyboard experience for mixed [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and Win32 applications:</span></span>

- <span data-ttu-id="4c5a5-224">Tabulation entre les composants Win32 et [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="4c5a5-224">Tabbing between Win32 and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] components</span></span>

- <span data-ttu-id="4c5a5-225">Mnémoniques et accélérateurs fonctionnant quand le focus est sur un composant Win32 et sur un composant WPF.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-225">Mnemonics and accelerators that work both when focus is within a Win32 component and when it is within a WPF component.</span></span>

<span data-ttu-id="4c5a5-226">Les classes <xref:System.Windows.Interop.HwndHost> et <xref:System.Windows.Interop.HwndSource> fournissent toutes deux des implémentations de <xref:System.Windows.Interop.IKeyboardInputSink>, mais elles peuvent ne pas gérer tous les messages d’entrée souhaités pour des scénarios plus avancés.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-226">The <xref:System.Windows.Interop.HwndHost> and <xref:System.Windows.Interop.HwndSource> classes both provide implementations of <xref:System.Windows.Interop.IKeyboardInputSink>, but they may not handle all the input messages that you want for more advanced scenarios.</span></span> <span data-ttu-id="4c5a5-227">Dans ce cas, substituez les méthodes appropriées pour obtenir le comportement de clavier souhaité.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-227">Override the appropriate methods to get the keyboard behavior you want.</span></span>

<span data-ttu-id="4c5a5-228">Les interfaces assurent uniquement la prise en charge de ce qui se passe sur la transition entre les [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et les régions Win32.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-228">The interfaces only provide support for what happens on the transition between the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and Win32 regions.</span></span> <span data-ttu-id="4c5a5-229">Dans la région Win32, le comportement de tabulation est entièrement contrôlé par la logique Win32 implémentée pour la tabulation, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="4c5a5-229">Within the Win32 region, tabbing behavior is entirely controlled by the Win32 implemented logic for tabbing, if any.</span></span>

## <a name="see-also"></a><span data-ttu-id="4c5a5-230">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="4c5a5-230">See also</span></span>

- <xref:System.Windows.Interop.HwndHost>
- <xref:System.Windows.Interop.HwndSource>
- <xref:System.Windows.Interop>
- [<span data-ttu-id="4c5a5-231">Procédure pas à pas : hébergement d'un contrôle Win32 dans WPF</span><span class="sxs-lookup"><span data-stu-id="4c5a5-231">Walkthrough: Hosting a Win32 Control in WPF</span></span>](walkthrough-hosting-a-win32-control-in-wpf.md)
- [<span data-ttu-id="4c5a5-232">Procédure pas à pas : hébergement de contenu WPF dans Win32</span><span class="sxs-lookup"><span data-stu-id="4c5a5-232">Walkthrough: Hosting WPF Content in Win32</span></span>](walkthrough-hosting-wpf-content-in-win32.md)

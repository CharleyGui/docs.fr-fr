---
title: Création d'un contrôle avec une apparence personnalisable
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- controls [WPF], customizing
- VisualStateManager [WPF], managing the state of a control
- ControlTemplate [WPF], customizing appearance
- controls [WPF], defining the visual structure and behavior of
- customizing appearance [WPF], ControlTemplate
- managing control states [WPF], VisualStateManager
- VisualStateManager [WPF], best practice
ms.assetid: 9e356d3d-a3d0-4b01-a25f-2d43e4d53fe5
ms.openlocfilehash: c98035ef0b4ea1add22b09fb9927bcd49c00cd9b
ms.sourcegitcommit: 82f94a44ad5c64a399df2a03fa842db308185a76
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/25/2019
ms.locfileid: "72920040"
---
# <a name="creating-a-control-that-has-a-customizable-appearance"></a><span data-ttu-id="55ae5-102">Création d'un contrôle avec une apparence personnalisable</span><span class="sxs-lookup"><span data-stu-id="55ae5-102">Creating a Control That Has a Customizable Appearance</span></span>

<a name="introduction"></a>
<span data-ttu-id="55ae5-103">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] vous donne la possibilité de créer un contrôle dont l’apparence peut être personnalisée.</span><span class="sxs-lookup"><span data-stu-id="55ae5-103">[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] gives you the ability to create a control whose appearance can be customized.</span></span> <span data-ttu-id="55ae5-104">Par exemple, vous pouvez modifier l’apparence d’un <xref:System.Windows.Controls.CheckBox> au-delà de ce que les propriétés de paramètre feraient en créant une <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-104">For example, you can change the appearance of a <xref:System.Windows.Controls.CheckBox> beyond what setting properties will do by creating a new <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="55ae5-105">L’illustration suivante montre une <xref:System.Windows.Controls.CheckBox> qui utilise un <xref:System.Windows.Controls.ControlTemplate> par défaut et un <xref:System.Windows.Controls.CheckBox> qui utilise une <xref:System.Windows.Controls.ControlTemplate>personnalisée.</span><span class="sxs-lookup"><span data-stu-id="55ae5-105">The following illustration shows a <xref:System.Windows.Controls.CheckBox> that uses a default <xref:System.Windows.Controls.ControlTemplate> and a <xref:System.Windows.Controls.CheckBox> that uses a custom <xref:System.Windows.Controls.ControlTemplate>.</span></span>

<span data-ttu-id="55ae5-106">![Case à cocher avec le modèle de contrôle par défaut.](./media/ndp-checkboxdefault.png "NDP_CheckBoxDefault")</span><span class="sxs-lookup"><span data-stu-id="55ae5-106">![A checkbox with the default control template.](./media/ndp-checkboxdefault.png "NDP_CheckBoxDefault")</span></span>
<span data-ttu-id="55ae5-107">Case à cocher qui utilise le modèle de contrôle par défaut</span><span class="sxs-lookup"><span data-stu-id="55ae5-107">A CheckBox that uses the default control template</span></span>

<span data-ttu-id="55ae5-108">![Case à cocher avec un modèle de contrôle personnalisé.](./media/ndp-checkboxcustom.png "NDP_CheckBoxCustom")</span><span class="sxs-lookup"><span data-stu-id="55ae5-108">![A checkbox with a custom control template.](./media/ndp-checkboxcustom.png "NDP_CheckBoxCustom")</span></span>
<span data-ttu-id="55ae5-109">Case à cocher qui utilise un modèle de contrôle personnalisé</span><span class="sxs-lookup"><span data-stu-id="55ae5-109">A CheckBox that uses a custom control template</span></span>

<span data-ttu-id="55ae5-110">Si vous suivez le modèle des parties et des États lorsque vous créez un contrôle, l’apparence de votre contrôle sera personnalisable.</span><span class="sxs-lookup"><span data-stu-id="55ae5-110">If you follow the parts and states model when you create a control, your control's appearance will be customizable.</span></span> <span data-ttu-id="55ae5-111">Les outils de conception tels que Blend pour Visual Studio prennent en charge le modèle des parties et des États. par conséquent, lorsque vous suivez ce modèle, votre contrôle est personnalisable dans ces types d’applications.</span><span class="sxs-lookup"><span data-stu-id="55ae5-111">Designer tools such as Blend for Visual Studio support the parts and states model, so when you follow this model your control will be customizable in those types of applications.</span></span>  <span data-ttu-id="55ae5-112">Cette rubrique décrit le modèle de composants et d’États et comment le suivre lorsque vous créez votre propre contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-112">This topic discusses the parts and states model and how to follow it when you create your own control.</span></span> <span data-ttu-id="55ae5-113">Cette rubrique utilise un exemple de contrôle personnalisé, `NumericUpDown`, pour illustrer la philosophie de ce modèle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-113">This topic uses an example of a custom control, `NumericUpDown`, to illustrate the philosophy of this model.</span></span>  <span data-ttu-id="55ae5-114">Le contrôle `NumericUpDown` affiche une valeur numérique, qu’un utilisateur peut augmenter ou diminuer en cliquant sur les boutons du contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-114">The `NumericUpDown` control displays a numeric value, which a user can increase or decrease by clicking on the control's buttons.</span></span>  <span data-ttu-id="55ae5-115">L’illustration suivante montre le contrôle `NumericUpDown` abordé dans cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="55ae5-115">The following illustration shows the `NumericUpDown` control that is discussed in this topic.</span></span>

<span data-ttu-id="55ae5-116">![Contrôle personnalisé NumericUpDown.](./media/ndp-numericupdown.png "NDP_NumericUPDown")</span><span class="sxs-lookup"><span data-stu-id="55ae5-116">![NumericUpDown custom control.](./media/ndp-numericupdown.png "NDP_NumericUPDown")</span></span>
<span data-ttu-id="55ae5-117">Contrôle NumericUpDown personnalisé</span><span class="sxs-lookup"><span data-stu-id="55ae5-117">A custom NumericUpDown control</span></span>

<span data-ttu-id="55ae5-118">Cette rubrique contient les sections suivantes :</span><span class="sxs-lookup"><span data-stu-id="55ae5-118">This topic contains the following sections:</span></span>

- [<span data-ttu-id="55ae5-119">Prérequis</span><span class="sxs-lookup"><span data-stu-id="55ae5-119">Prerequisites</span></span>](#prerequisites)

- [<span data-ttu-id="55ae5-120">Modèle des parties et des États</span><span class="sxs-lookup"><span data-stu-id="55ae5-120">Parts and States Model</span></span>](#parts_and_states_model)

- [<span data-ttu-id="55ae5-121">Définition de la structure visuelle et du comportement visuel d’un contrôle dans un ControlTemplate</span><span class="sxs-lookup"><span data-stu-id="55ae5-121">Defining the Visual Structure and Visual Behavior of a Control in a ControlTemplate</span></span>](#defining_the_visual_structure_and_visual_behavior_of_a_control_in_a_controltemplate)

- [<span data-ttu-id="55ae5-122">Utilisation de parties du ControlTemplate dans le code</span><span class="sxs-lookup"><span data-stu-id="55ae5-122">Using Parts of the ControlTemplate in Code</span></span>](#using_parts_of_the_controltemplate_in_code)

- [<span data-ttu-id="55ae5-123">Fourniture du contrat de contrôle</span><span class="sxs-lookup"><span data-stu-id="55ae5-123">Providing the Control Contract</span></span>](#providing_the_control_contract)

- [<span data-ttu-id="55ae5-124">Exemple complet</span><span class="sxs-lookup"><span data-stu-id="55ae5-124">Complete Example</span></span>](#complete_example)

<a name="prerequisites"></a>

## <a name="prerequisites"></a><span data-ttu-id="55ae5-125">Configuration requise</span><span class="sxs-lookup"><span data-stu-id="55ae5-125">Prerequisites</span></span>

<span data-ttu-id="55ae5-126">Cette rubrique suppose que vous savez comment créer un <xref:System.Windows.Controls.ControlTemplate> pour un contrôle existant, que vous connaissez les éléments d’un contrat de contrôle et que vous comprenez les concepts abordés dans [Personnalisation de l’apparence d’un contrôle existant en créant un ControlTemplate](customizing-the-appearance-of-an-existing-control.md).</span><span class="sxs-lookup"><span data-stu-id="55ae5-126">This topic assumes that you know how to create a new <xref:System.Windows.Controls.ControlTemplate> for an existing control, are familiar with what the elements on a control contract are, and understand the concepts discussed in [Customizing the Appearance of an Existing Control by Creating a ControlTemplate](customizing-the-appearance-of-an-existing-control.md).</span></span>

> [!NOTE]
> <span data-ttu-id="55ae5-127">Pour créer un contrôle dont l’apparence peut être personnalisée, vous devez créer un contrôle qui hérite de la classe <xref:System.Windows.Controls.Control> ou de l’une de ses sous-classes autres que <xref:System.Windows.Controls.UserControl>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-127">To create a control that can have its appearance customized, you must create a control that inherits from the <xref:System.Windows.Controls.Control> class or one of its subclasses other than <xref:System.Windows.Controls.UserControl>.</span></span>  <span data-ttu-id="55ae5-128">Un contrôle qui hérite de <xref:System.Windows.Controls.UserControl> est un contrôle qui peut être rapidement créé, mais il n’utilise pas de <xref:System.Windows.Controls.ControlTemplate> et vous ne pouvez pas personnaliser son apparence.</span><span class="sxs-lookup"><span data-stu-id="55ae5-128">A control that inherits from <xref:System.Windows.Controls.UserControl> is a control that can be quickly created, but it does not use a <xref:System.Windows.Controls.ControlTemplate> and you cannot customize its appearance.</span></span>

<a name="parts_and_states_model"></a>

## <a name="parts-and-states-model"></a><span data-ttu-id="55ae5-129">Modèle des parties et des États</span><span class="sxs-lookup"><span data-stu-id="55ae5-129">Parts and States Model</span></span>

<span data-ttu-id="55ae5-130">Le modèle parties et États spécifie comment définir la structure visuelle et le comportement visuel d’un contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-130">The parts and states model specifies how to define the visual structure and visual behavior of a control.</span></span> <span data-ttu-id="55ae5-131">Pour suivre le modèle des parties et des États, vous devez effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="55ae5-131">To follow the parts and states model, you should do the following:</span></span>

- <span data-ttu-id="55ae5-132">Définir la structure visuelle et le comportement visuel dans le <xref:System.Windows.Controls.ControlTemplate> d’un contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-132">Define the visual structure and visual behavior in the <xref:System.Windows.Controls.ControlTemplate> of a control.</span></span>

- <span data-ttu-id="55ae5-133">Suivez certaines meilleures pratiques lorsque la logique de votre contrôle interagit avec des parties du modèle de contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-133">Follow certain best practices when your control's logic interacts with parts of the control template.</span></span>

- <span data-ttu-id="55ae5-134">Fournissez un contrat de contrôle pour spécifier ce qui doit être inclus dans le <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-134">Provide a control contract to specify what should be included in the <xref:System.Windows.Controls.ControlTemplate>.</span></span>

<span data-ttu-id="55ae5-135">Lorsque vous définissez la structure visuelle et le comportement visuel dans le <xref:System.Windows.Controls.ControlTemplate> d’un contrôle, les créateurs d’applications peuvent modifier la structure visuelle et le comportement visuel de votre contrôle en créant un nouveau <xref:System.Windows.Controls.ControlTemplate> au lieu d’écrire du code.</span><span class="sxs-lookup"><span data-stu-id="55ae5-135">When you define the visual structure and visual behavior in the <xref:System.Windows.Controls.ControlTemplate> of a control, application authors can change the visual structure and visual behavior of your control by creating a new <xref:System.Windows.Controls.ControlTemplate> instead of writing code.</span></span>   <span data-ttu-id="55ae5-136">Vous devez fournir un contrat de contrôle qui indique aux auteurs de l’application que <xref:System.Windows.FrameworkElement> objets et les États doivent être définis dans le <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-136">You must provide a control contract that tells application authors which <xref:System.Windows.FrameworkElement> objects and states should be defined in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="55ae5-137">Vous devez suivre certaines meilleures pratiques lorsque vous interagissez avec les composants de la <xref:System.Windows.Controls.ControlTemplate> afin que votre contrôle gère correctement un <xref:System.Windows.Controls.ControlTemplate>incomplet.</span><span class="sxs-lookup"><span data-stu-id="55ae5-137">You should follow some best practices when you interact with the parts in the <xref:System.Windows.Controls.ControlTemplate> so that your control properly handles an incomplete <xref:System.Windows.Controls.ControlTemplate>.</span></span>  <span data-ttu-id="55ae5-138">Si vous suivez ces trois principes, les créateurs d’applications peuvent créer un <xref:System.Windows.Controls.ControlTemplate> pour votre contrôle tout aussi facilement que pour les contrôles fournis avec [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="55ae5-138">If you follow these three principles, application authors will be able to create a <xref:System.Windows.Controls.ControlTemplate> for your control just as easily as they can for the controls that ship with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  <span data-ttu-id="55ae5-139">La section suivante explique en détail chacune de ces recommandations.</span><span class="sxs-lookup"><span data-stu-id="55ae5-139">The following section explains each of these recommendations in detail.</span></span>

<a name="defining_the_visual_structure_and_visual_behavior_of_a_control_in_a_controltemplate"></a>

## <a name="defining-the-visual-structure-and-visual-behavior-of-a-control-in-a-controltemplate"></a><span data-ttu-id="55ae5-140">Définition de la structure visuelle et du comportement visuel d’un contrôle dans un ControlTemplate</span><span class="sxs-lookup"><span data-stu-id="55ae5-140">Defining the Visual Structure and Visual Behavior of a Control in a ControlTemplate</span></span>

<span data-ttu-id="55ae5-141">Lorsque vous créez votre contrôle personnalisé à l’aide du modèle de composants et d’États, vous définissez la structure visuelle et le comportement visuel du contrôle dans son <xref:System.Windows.Controls.ControlTemplate> plutôt que dans sa logique.</span><span class="sxs-lookup"><span data-stu-id="55ae5-141">When you create your custom control by using the parts and states model, you define the control's visual structure and visual behavior in its <xref:System.Windows.Controls.ControlTemplate> instead of in its logic.</span></span>  <span data-ttu-id="55ae5-142">La structure visuelle d’un contrôle est l’composite d' <xref:System.Windows.FrameworkElement> objets qui composent le contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-142">The visual structure of a control is the composite of <xref:System.Windows.FrameworkElement> objects that make up the control.</span></span>  <span data-ttu-id="55ae5-143">Le comportement visuel est le mode d’affichage du contrôle lorsqu’il est dans un certain état.</span><span class="sxs-lookup"><span data-stu-id="55ae5-143">The visual behavior is the way the control appears when it is in a certain state.</span></span>   <span data-ttu-id="55ae5-144">Pour plus d’informations sur la création d’un <xref:System.Windows.Controls.ControlTemplate> qui spécifie la structure visuelle et le comportement visuel d’un contrôle, consultez [Personnalisation de l’apparence d’un contrôle existant en créant un ControlTemplate](customizing-the-appearance-of-an-existing-control.md).</span><span class="sxs-lookup"><span data-stu-id="55ae5-144">For more information about creating a <xref:System.Windows.Controls.ControlTemplate> that specifies the visual structure and visual behavior of a control, see [Customizing the Appearance of an Existing Control by Creating a ControlTemplate](customizing-the-appearance-of-an-existing-control.md).</span></span>

<span data-ttu-id="55ae5-145">Dans l’exemple du contrôle `NumericUpDown`, la structure visuelle comprend deux contrôles <xref:System.Windows.Controls.Primitives.RepeatButton> et un <xref:System.Windows.Controls.TextBlock>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-145">In the example of the `NumericUpDown` control, the visual structure includes two <xref:System.Windows.Controls.Primitives.RepeatButton> controls and a <xref:System.Windows.Controls.TextBlock>.</span></span>  <span data-ttu-id="55ae5-146">Si vous ajoutez ces contrôles dans le code du contrôle `NumericUpDown`, par exemple dans son constructeur, les positions de ces contrôles ne peuvent pas être modifiées.</span><span class="sxs-lookup"><span data-stu-id="55ae5-146">If you add these controls in the code of the `NumericUpDown` control--in its constructor, for example--the positions of those controls would be unalterable.</span></span>  <span data-ttu-id="55ae5-147">Au lieu de définir la structure visuelle et le comportement visuel du contrôle dans son code, vous devez le définir dans l' <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-147">Instead of defining the control's visual structure and visual behavior in its code, you should define it in the <xref:System.Windows.Controls.ControlTemplate>.</span></span>  <span data-ttu-id="55ae5-148">Un développeur d’applications peut ensuite personnaliser la position des boutons et <xref:System.Windows.Controls.TextBlock> et spécifier le comportement qui se produit quand `Value` est négatif, car le <xref:System.Windows.Controls.ControlTemplate> peut être remplacé.</span><span class="sxs-lookup"><span data-stu-id="55ae5-148">Then an application developer to customize the position of the buttons and <xref:System.Windows.Controls.TextBlock> and specify what behavior occurs when `Value` is negative because the <xref:System.Windows.Controls.ControlTemplate> can be replaced.</span></span>

<span data-ttu-id="55ae5-149">L’exemple suivant illustre la structure visuelle du contrôle `NumericUpDown`, qui comprend une <xref:System.Windows.Controls.Primitives.RepeatButton> pour augmenter `Value`, une <xref:System.Windows.Controls.Primitives.RepeatButton> pour réduire `Value`et une <xref:System.Windows.Controls.TextBlock> pour afficher `Value`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-149">The following example shows the visual structure of the `NumericUpDown` control, which includes a <xref:System.Windows.Controls.Primitives.RepeatButton> to increase `Value`, a <xref:System.Windows.Controls.Primitives.RepeatButton> to decrease `Value`, and a <xref:System.Windows.Controls.TextBlock> to display `Value`.</span></span>

[!code-xaml[VSMCustomControl#VisualStructure](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/window1.xaml#visualstructure)]

<span data-ttu-id="55ae5-150">Un comportement visuel du contrôle `NumericUpDown` est que la valeur est en rouge si elle est négative.</span><span class="sxs-lookup"><span data-stu-id="55ae5-150">A visual behavior of the `NumericUpDown` control is that the value is in a red font if it is negative.</span></span>  <span data-ttu-id="55ae5-151">Si vous modifiez la <xref:System.Windows.Controls.TextBlock.Foreground%2A> du <xref:System.Windows.Controls.TextBlock> dans le code lorsque le `Value` est négatif, le `NumericUpDown` affiche toujours une valeur négative rouge.</span><span class="sxs-lookup"><span data-stu-id="55ae5-151">If you change the <xref:System.Windows.Controls.TextBlock.Foreground%2A> of the <xref:System.Windows.Controls.TextBlock> in code when the `Value` is negative, the `NumericUpDown` will always show a red negative value.</span></span> <span data-ttu-id="55ae5-152">Vous spécifiez le comportement visuel du contrôle dans le <xref:System.Windows.Controls.ControlTemplate> en ajoutant des objets <xref:System.Windows.VisualState> à la <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-152">You specify the visual behavior of the control in the <xref:System.Windows.Controls.ControlTemplate> by adding <xref:System.Windows.VisualState> objects to the <xref:System.Windows.Controls.ControlTemplate>.</span></span>  <span data-ttu-id="55ae5-153">L’exemple suivant montre les objets <xref:System.Windows.VisualState> pour les États `Positive` et `Negative`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-153">The following example shows the <xref:System.Windows.VisualState> objects for the `Positive` and `Negative` states.</span></span>  <span data-ttu-id="55ae5-154">`Positive` et `Negative` s’excluent mutuellement (le contrôle est toujours exactement dans l’un des deux), l’exemple place les objets <xref:System.Windows.VisualState> dans un <xref:System.Windows.VisualStateGroup>unique.</span><span class="sxs-lookup"><span data-stu-id="55ae5-154">`Positive` and `Negative` are mutually exclusive (the control is always in exactly one of the two), so the example puts the <xref:System.Windows.VisualState> objects into a single <xref:System.Windows.VisualStateGroup>.</span></span>  <span data-ttu-id="55ae5-155">Lorsque le contrôle passe à l’État `Negative`, la <xref:System.Windows.Controls.TextBlock.Foreground%2A> du <xref:System.Windows.Controls.TextBlock> devient rouge.</span><span class="sxs-lookup"><span data-stu-id="55ae5-155">When the control goes into the `Negative` state, the <xref:System.Windows.Controls.TextBlock.Foreground%2A> of the <xref:System.Windows.Controls.TextBlock> turns red.</span></span>  <span data-ttu-id="55ae5-156">Lorsque le contrôle est dans l’État `Positive`, le <xref:System.Windows.Controls.TextBlock.Foreground%2A> retourne à sa valeur d’origine.</span><span class="sxs-lookup"><span data-stu-id="55ae5-156">When the control is in the `Positive` state, the <xref:System.Windows.Controls.TextBlock.Foreground%2A> returns to its original value.</span></span>  <span data-ttu-id="55ae5-157">La définition d’objets <xref:System.Windows.VisualState> dans un <xref:System.Windows.Controls.ControlTemplate> est expliquée plus en détail dans [Personnalisation de l’apparence d’un contrôle existant en créant un ControlTemplate](customizing-the-appearance-of-an-existing-control.md).</span><span class="sxs-lookup"><span data-stu-id="55ae5-157">Defining <xref:System.Windows.VisualState> objects in a <xref:System.Windows.Controls.ControlTemplate> is further discussed in [Customizing the Appearance of an Existing Control by Creating a ControlTemplate](customizing-the-appearance-of-an-existing-control.md).</span></span>

> [!NOTE]
> <span data-ttu-id="55ae5-158">Veillez à définir la propriété jointe <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> sur le <xref:System.Windows.FrameworkElement> racine de la <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-158">Be sure to set the <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> attached property on the root <xref:System.Windows.FrameworkElement> of the <xref:System.Windows.Controls.ControlTemplate>.</span></span>

[!code-xaml[VSMCustomControl#ValueStates](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/window1.xaml#valuestates)]

<a name="using_parts_of_the_controltemplate_in_code"></a>

## <a name="using-parts-of-the-controltemplate-in-code"></a><span data-ttu-id="55ae5-159">Utilisation de parties du ControlTemplate dans le code</span><span class="sxs-lookup"><span data-stu-id="55ae5-159">Using Parts of the ControlTemplate in Code</span></span>

<span data-ttu-id="55ae5-160">Un auteur de <xref:System.Windows.Controls.ControlTemplate> peut omettre des objets <xref:System.Windows.FrameworkElement> ou <xref:System.Windows.VisualState>, intentionnellement ou par erreur, mais la logique de votre contrôle peut avoir besoin de ces parties pour fonctionner correctement.</span><span class="sxs-lookup"><span data-stu-id="55ae5-160">A <xref:System.Windows.Controls.ControlTemplate> author might omit <xref:System.Windows.FrameworkElement> or <xref:System.Windows.VisualState> objects, either purposefully or by mistake, but your control's logic might need those parts to function properly.</span></span> <span data-ttu-id="55ae5-161">Le modèle des parties et des États spécifie que votre contrôle doit être résilient à une <xref:System.Windows.Controls.ControlTemplate> qui manque <xref:System.Windows.FrameworkElement> ou <xref:System.Windows.VisualState> objets.</span><span class="sxs-lookup"><span data-stu-id="55ae5-161">The parts and states model specifies that your control should be resilient to a <xref:System.Windows.Controls.ControlTemplate> that is missing <xref:System.Windows.FrameworkElement> or <xref:System.Windows.VisualState> objects.</span></span>  <span data-ttu-id="55ae5-162">Votre contrôle ne doit pas lever d’exception ou signaler une erreur si un <xref:System.Windows.FrameworkElement>, <xref:System.Windows.VisualState>ou <xref:System.Windows.VisualStateGroup> est manquant dans le <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-162">Your control should not throw an exception or report an error if a <xref:System.Windows.FrameworkElement>, <xref:System.Windows.VisualState>, or <xref:System.Windows.VisualStateGroup> is missing from the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="55ae5-163">Cette section décrit les pratiques recommandées pour l’interaction avec les objets <xref:System.Windows.FrameworkElement> et la gestion des États.</span><span class="sxs-lookup"><span data-stu-id="55ae5-163">This section describes the recommended practices for interacting with <xref:System.Windows.FrameworkElement> objects and managing states.</span></span>

### <a name="anticipate-missing-frameworkelement-objects"></a><span data-ttu-id="55ae5-164">Anticiper les objets FrameworkElement manquants</span><span class="sxs-lookup"><span data-stu-id="55ae5-164">Anticipate Missing FrameworkElement Objects</span></span>

<span data-ttu-id="55ae5-165">Lorsque vous définissez <xref:System.Windows.FrameworkElement> objets dans le <xref:System.Windows.Controls.ControlTemplate>, la logique de votre contrôle peut avoir besoin d’interagir avec certaines d’entre elles.</span><span class="sxs-lookup"><span data-stu-id="55ae5-165">When you define <xref:System.Windows.FrameworkElement> objects in the <xref:System.Windows.Controls.ControlTemplate>, your control's logic might need to interact with some of them.</span></span>  <span data-ttu-id="55ae5-166">Par exemple, le contrôle `NumericUpDown` s’abonne à l’événement <xref:System.Windows.Controls.Primitives.ButtonBase.Click> buttons pour augmenter ou diminuer `Value` et définit la propriété <xref:System.Windows.Controls.TextBlock.Text%2A> de <xref:System.Windows.Controls.TextBlock> sur `Value`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-166">For example, the `NumericUpDown` control subscribes to the buttons' <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event to increase or decrease `Value` and sets the <xref:System.Windows.Controls.TextBlock.Text%2A> property of the <xref:System.Windows.Controls.TextBlock> to `Value`.</span></span> <span data-ttu-id="55ae5-167">Si une <xref:System.Windows.Controls.ControlTemplate> personnalisée omet le <xref:System.Windows.Controls.TextBlock> ou les boutons, il est acceptable que le contrôle perde certaines de ses fonctionnalités, mais vous devez vous assurer que votre contrôle ne provoque pas d’erreur.</span><span class="sxs-lookup"><span data-stu-id="55ae5-167">If a custom <xref:System.Windows.Controls.ControlTemplate> omits the <xref:System.Windows.Controls.TextBlock> or buttons, it is acceptable that the control loses some of its functionality, but you should be sure that your control does not cause an error.</span></span> <span data-ttu-id="55ae5-168">Par exemple, si un <xref:System.Windows.Controls.ControlTemplate> ne contient pas les boutons pour modifier `Value`, le `NumericUpDown` perd cette fonctionnalité, mais une application qui utilise le <xref:System.Windows.Controls.ControlTemplate> continuera à s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="55ae5-168">For example, if a <xref:System.Windows.Controls.ControlTemplate> does not contain the buttons to change `Value`, the `NumericUpDown` loses that functionality, but an application that uses the <xref:System.Windows.Controls.ControlTemplate> will continue to run.</span></span>

<span data-ttu-id="55ae5-169">Les pratiques suivantes permettent de s’assurer que votre contrôle répond correctement aux objets <xref:System.Windows.FrameworkElement> manquants :</span><span class="sxs-lookup"><span data-stu-id="55ae5-169">The following practices will ensure that your control responds properly to missing <xref:System.Windows.FrameworkElement> objects:</span></span>

1. <span data-ttu-id="55ae5-170">Définissez l’attribut `x:Name` pour chaque <xref:System.Windows.FrameworkElement> que vous devez référencer dans le code.</span><span class="sxs-lookup"><span data-stu-id="55ae5-170">Set the `x:Name` attribute for each <xref:System.Windows.FrameworkElement> that you need to reference in code.</span></span>

2. <span data-ttu-id="55ae5-171">Définissez les propriétés privées de chaque <xref:System.Windows.FrameworkElement> avec lequel vous devez interagir.</span><span class="sxs-lookup"><span data-stu-id="55ae5-171">Define private properties for each <xref:System.Windows.FrameworkElement> that you need to interact with.</span></span>

3. <span data-ttu-id="55ae5-172">Abonnez-vous et annulez l’abonnement des événements que votre contrôle gère dans l’accesseur Set de la propriété <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-172">Subscribe to and unsubscribe from any events that your control handles in the <xref:System.Windows.FrameworkElement> property's set accessor.</span></span>

4. <span data-ttu-id="55ae5-173">Définissez les propriétés de <xref:System.Windows.FrameworkElement> que vous avez définies à l’étape 2 dans la méthode <xref:System.Windows.FrameworkElement.OnApplyTemplate%2A>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-173">Set the <xref:System.Windows.FrameworkElement> properties that you defined in step 2 in the <xref:System.Windows.FrameworkElement.OnApplyTemplate%2A> method.</span></span> <span data-ttu-id="55ae5-174">C’est la première fois que le <xref:System.Windows.FrameworkElement> dans le <xref:System.Windows.Controls.ControlTemplate> est disponible pour le contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-174">This is the earliest that the <xref:System.Windows.FrameworkElement> in the <xref:System.Windows.Controls.ControlTemplate> is available to the control.</span></span> <span data-ttu-id="55ae5-175">Utilisez la `x:Name` du <xref:System.Windows.FrameworkElement> pour l’extraire du <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-175">Use the `x:Name` of the <xref:System.Windows.FrameworkElement> to get it from the <xref:System.Windows.Controls.ControlTemplate>.</span></span>

5. <span data-ttu-id="55ae5-176">Vérifiez que le <xref:System.Windows.FrameworkElement> n’est pas `null` avant d’accéder à ses membres.</span><span class="sxs-lookup"><span data-stu-id="55ae5-176">Check that the <xref:System.Windows.FrameworkElement> is not `null` before accessing its members.</span></span>  <span data-ttu-id="55ae5-177">S’il s’agit d' `null`, ne signalez pas d’erreur.</span><span class="sxs-lookup"><span data-stu-id="55ae5-177">If it is `null`, do not report an error.</span></span>

<span data-ttu-id="55ae5-178">Les exemples suivants montrent comment le contrôle `NumericUpDown` interagit avec les objets <xref:System.Windows.FrameworkElement> conformément aux recommandations de la liste précédente.</span><span class="sxs-lookup"><span data-stu-id="55ae5-178">The following examples show how the `NumericUpDown` control interacts with <xref:System.Windows.FrameworkElement> objects in accordance with the recommendations in the preceding list.</span></span>

<span data-ttu-id="55ae5-179">Dans l’exemple qui définit la structure visuelle du contrôle `NumericUpDown` dans le <xref:System.Windows.Controls.ControlTemplate>, l’attribut `x:Name` de la <xref:System.Windows.Controls.Primitives.RepeatButton> qui augmente `Value` a la valeur `UpButton`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-179">In the example that defines the visual structure of the `NumericUpDown` control in the <xref:System.Windows.Controls.ControlTemplate>, the <xref:System.Windows.Controls.Primitives.RepeatButton> that increases `Value` has its `x:Name` attribute set to `UpButton`.</span></span>  <span data-ttu-id="55ae5-180">L’exemple suivant déclare une propriété appelée `UpButtonElement` qui représente le <xref:System.Windows.Controls.Primitives.RepeatButton> déclaré dans le <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-180">The following example declares a property called `UpButtonElement` that represents the <xref:System.Windows.Controls.Primitives.RepeatButton> that is declared in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="55ae5-181">L’accesseur `set` se désabonne d’abord à l’événement <xref:System.Windows.Controls.Primitives.ButtonBase.Click> du bouton si `UpDownElement` n’est pas `null`, puis définit la propriété et s’abonne à l’événement <xref:System.Windows.Controls.Primitives.ButtonBase.Click>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-181">The `set` accessor first unsubscribes to the button's <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event if `UpDownElement` is not `null`, then it sets the property, and then it subscribes to the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.</span></span> <span data-ttu-id="55ae5-182">Une propriété est également définie, mais elle n’est pas indiquée ici, pour l’autre <xref:System.Windows.Controls.Primitives.RepeatButton>, appelée `DownButtonElement`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-182">There is also a property defined, but not shown here, for the other <xref:System.Windows.Controls.Primitives.RepeatButton>, called `DownButtonElement`.</span></span>

[!code-csharp[VSMCustomControl#UpButtonProperty](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/numericupdown.cs#upbuttonproperty)]
[!code-vb[VSMCustomControl#UpButtonProperty](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmcustomcontrol/visualbasic/numericupdown.vb#upbuttonproperty)]

<span data-ttu-id="55ae5-183">L’exemple suivant montre les <xref:System.Windows.FrameworkElement.OnApplyTemplate%2A> pour le contrôle `NumericUpDown`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-183">The following example shows the <xref:System.Windows.FrameworkElement.OnApplyTemplate%2A> for the `NumericUpDown` control.</span></span>  <span data-ttu-id="55ae5-184">L’exemple utilise la méthode <xref:System.Windows.FrameworkElement.GetTemplateChild%2A> pour récupérer les objets <xref:System.Windows.FrameworkElement> à partir du <xref:System.Windows.Controls.ControlTemplate>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-184">The example uses the <xref:System.Windows.FrameworkElement.GetTemplateChild%2A> method to get the <xref:System.Windows.FrameworkElement> objects from the <xref:System.Windows.Controls.ControlTemplate>.</span></span>  <span data-ttu-id="55ae5-185">Notez que l’exemple empêche les cas où <xref:System.Windows.FrameworkElement.GetTemplateChild%2A> trouve une <xref:System.Windows.FrameworkElement> avec le nom spécifié qui n’est pas du type attendu.</span><span class="sxs-lookup"><span data-stu-id="55ae5-185">Notice that the example guards against cases where <xref:System.Windows.FrameworkElement.GetTemplateChild%2A> finds a <xref:System.Windows.FrameworkElement> with the specified name that is not of the expected type.</span></span> <span data-ttu-id="55ae5-186">Il est également conseillé d’ignorer les éléments qui ont le `x:Name` spécifié mais qui sont de type incorrect.</span><span class="sxs-lookup"><span data-stu-id="55ae5-186">It is also a best practice to ignore elements that have the specified `x:Name` but are of the wrong type.</span></span>

[!code-csharp[VSMCustomControl#ApplyTemplate](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/numericupdown.cs#applytemplate)]
[!code-vb[VSMCustomControl#ApplyTemplate](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmcustomcontrol/visualbasic/numericupdown.vb#applytemplate)]

<span data-ttu-id="55ae5-187">En suivant les pratiques présentées dans les exemples précédents, vous vous assurez que votre contrôle continuera à s’exécuter lorsque la <xref:System.Windows.Controls.ControlTemplate> ne dispose pas d’un <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-187">By following the practices that are shown in the previous examples, you ensure that your control will continue to run when the <xref:System.Windows.Controls.ControlTemplate> is missing a <xref:System.Windows.FrameworkElement>.</span></span>

### <a name="use-the-visualstatemanager-to-manage-states"></a><span data-ttu-id="55ae5-188">Utiliser le VisualStateManager pour gérer les États</span><span class="sxs-lookup"><span data-stu-id="55ae5-188">Use the VisualStateManager to Manage States</span></span>

<span data-ttu-id="55ae5-189">Le <xref:System.Windows.VisualStateManager> effectue le suivi des États d’un contrôle et exécute la logique nécessaire pour passer d’un État à l’autre.</span><span class="sxs-lookup"><span data-stu-id="55ae5-189">The <xref:System.Windows.VisualStateManager> keeps track of the states of a control and performs the logic necessary to transition between states.</span></span> <span data-ttu-id="55ae5-190">Lorsque vous ajoutez des objets <xref:System.Windows.VisualState> à l' <xref:System.Windows.Controls.ControlTemplate>, vous les ajoutez à un <xref:System.Windows.VisualStateGroup> et vous ajoutez l' <xref:System.Windows.VisualStateGroup> à la propriété jointe <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> afin que le <xref:System.Windows.VisualStateManager> y ait accès.</span><span class="sxs-lookup"><span data-stu-id="55ae5-190">When you add <xref:System.Windows.VisualState> objects to the <xref:System.Windows.Controls.ControlTemplate>, you add them to a <xref:System.Windows.VisualStateGroup> and add the <xref:System.Windows.VisualStateGroup> to the <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> attached property so that the <xref:System.Windows.VisualStateManager> has access to them.</span></span>

<span data-ttu-id="55ae5-191">L’exemple suivant répète l’exemple précédent qui montre les <xref:System.Windows.VisualState> objets qui correspondent aux États de `Positive` et de `Negative` du contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-191">The following example repeats the previous example that shows the <xref:System.Windows.VisualState> objects that correspond to the `Positive` and `Negative` states of the control.</span></span> <span data-ttu-id="55ae5-192">La <xref:System.Windows.Media.Animation.Storyboard> dans le `Negative`<xref:System.Windows.VisualState> convertit la <xref:System.Windows.Controls.TextBlock.Foreground%2A> du <xref:System.Windows.Controls.TextBlock> rouge.</span><span class="sxs-lookup"><span data-stu-id="55ae5-192">The <xref:System.Windows.Media.Animation.Storyboard> in the `Negative`<xref:System.Windows.VisualState> turns the <xref:System.Windows.Controls.TextBlock.Foreground%2A> of the <xref:System.Windows.Controls.TextBlock> red.</span></span>   <span data-ttu-id="55ae5-193">Lorsque le contrôle de `NumericUpDown` est dans l’État `Negative`, le Storyboard de l’état de `Negative` commence.</span><span class="sxs-lookup"><span data-stu-id="55ae5-193">When the `NumericUpDown` control is in the `Negative` state, the storyboard in the `Negative` state begins.</span></span>  <span data-ttu-id="55ae5-194">Ensuite, le <xref:System.Windows.Media.Animation.Storyboard> dans l’État `Negative` s’arrête lorsque le contrôle revient à l’État `Positive`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-194">Then the <xref:System.Windows.Media.Animation.Storyboard> in the `Negative` state stops when the control returns to the `Positive` state.</span></span>  <span data-ttu-id="55ae5-195">Le<xref:System.Windows.VisualState> `Positive`n’a pas besoin de contenir un <xref:System.Windows.Media.Animation.Storyboard>, car lorsque le <xref:System.Windows.Media.Animation.Storyboard> pour le `Negative` s’arrête, le <xref:System.Windows.Controls.TextBlock.Foreground%2A> retourne à sa couleur d’origine.</span><span class="sxs-lookup"><span data-stu-id="55ae5-195">The `Positive`<xref:System.Windows.VisualState> does not need to contain a <xref:System.Windows.Media.Animation.Storyboard> because when the <xref:System.Windows.Media.Animation.Storyboard> for the `Negative` stops, the <xref:System.Windows.Controls.TextBlock.Foreground%2A> returns to its original color.</span></span>

[!code-xaml[VSMCustomControl#ValueStates](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/window1.xaml#valuestates)]

<span data-ttu-id="55ae5-196">Notez que le <xref:System.Windows.Controls.TextBlock> reçoit un nom, mais le <xref:System.Windows.Controls.TextBlock> n’est pas dans le contrat de contrôle pour `NumericUpDown`, car la logique du contrôle ne fait jamais référence à l' <xref:System.Windows.Controls.TextBlock>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-196">Note that the <xref:System.Windows.Controls.TextBlock> is given a name, but the <xref:System.Windows.Controls.TextBlock> is not in the control contract for `NumericUpDown` because the control's logic never references the <xref:System.Windows.Controls.TextBlock>.</span></span>  <span data-ttu-id="55ae5-197">Les éléments référencés dans le <xref:System.Windows.Controls.ControlTemplate> avoir des noms, mais n’ont pas besoin d’être inclus dans le contrat de contrôle, car il est possible qu’un nouveau <xref:System.Windows.Controls.ControlTemplate> pour le contrôle n’ait pas besoin de référencer cet élément.</span><span class="sxs-lookup"><span data-stu-id="55ae5-197">Elements that are referenced in the <xref:System.Windows.Controls.ControlTemplate> have names, but do not need to be part of the control contract because a new <xref:System.Windows.Controls.ControlTemplate> for the control might not need to reference that element.</span></span>  <span data-ttu-id="55ae5-198">Par exemple, une personne qui crée une nouvelle <xref:System.Windows.Controls.ControlTemplate> pour `NumericUpDown` peut décider de ne pas indiquer que `Value` est négatif en modifiant le <xref:System.Windows.Controls.Control.Foreground%2A>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-198">For example, someone who creates a new <xref:System.Windows.Controls.ControlTemplate> for `NumericUpDown` might decide to not indicate that `Value` is negative by changing the <xref:System.Windows.Controls.Control.Foreground%2A>.</span></span>  <span data-ttu-id="55ae5-199">Dans ce cas, ni le code ni le <xref:System.Windows.Controls.ControlTemplate> ne référencent le <xref:System.Windows.Controls.TextBlock> par nom.</span><span class="sxs-lookup"><span data-stu-id="55ae5-199">In that case, neither the code nor the <xref:System.Windows.Controls.ControlTemplate> references the <xref:System.Windows.Controls.TextBlock> by name.</span></span>

<span data-ttu-id="55ae5-200">La logique du contrôle est responsable de la modification de l’état du contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-200">The control's logic is responsible for changing the control's state.</span></span> <span data-ttu-id="55ae5-201">L’exemple suivant montre que le contrôle `NumericUpDown` appelle la méthode <xref:System.Windows.VisualStateManager.GoToState%2A> pour passer à l’État `Positive` lorsque `Value` a une valeur supérieure ou égale à 0, et l’État `Negative` lorsque `Value` est inférieur à 0.</span><span class="sxs-lookup"><span data-stu-id="55ae5-201">The following example shows that the `NumericUpDown` control calls the <xref:System.Windows.VisualStateManager.GoToState%2A> method to go into the `Positive` state when `Value` is 0 or greater, and the `Negative` state when `Value` is less than 0.</span></span>

[!code-csharp[VSMCustomControl#ValueStateChange](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/numericupdown.cs#valuestatechange)]
[!code-vb[VSMCustomControl#ValueStateChange](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmcustomcontrol/visualbasic/numericupdown.vb#valuestatechange)]

<span data-ttu-id="55ae5-202">La méthode <xref:System.Windows.VisualStateManager.GoToState%2A> exécute la logique nécessaire pour démarrer et arrêter les storyboards de manière appropriée.</span><span class="sxs-lookup"><span data-stu-id="55ae5-202">The <xref:System.Windows.VisualStateManager.GoToState%2A> method performs the logic necessary to start and stop the storyboards appropriately.</span></span> <span data-ttu-id="55ae5-203">Lorsqu’un contrôle appelle <xref:System.Windows.VisualStateManager.GoToState%2A> pour modifier son état, le <xref:System.Windows.VisualStateManager> effectue les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="55ae5-203">When a control calls <xref:System.Windows.VisualStateManager.GoToState%2A> to change its state, the <xref:System.Windows.VisualStateManager> does the following:</span></span>

- <span data-ttu-id="55ae5-204">Si le <xref:System.Windows.VisualState> que le contrôle va avoir un <xref:System.Windows.Media.Animation.Storyboard>, le Storyboard commence.</span><span class="sxs-lookup"><span data-stu-id="55ae5-204">If the <xref:System.Windows.VisualState> that the control is going to has a <xref:System.Windows.Media.Animation.Storyboard>, the storyboard begins.</span></span> <span data-ttu-id="55ae5-205">Ensuite, si le <xref:System.Windows.VisualState> à partir duquel le contrôle provient a un <xref:System.Windows.Media.Animation.Storyboard>, le Storyboard se termine.</span><span class="sxs-lookup"><span data-stu-id="55ae5-205">Then, if the <xref:System.Windows.VisualState> that the control is coming from has a <xref:System.Windows.Media.Animation.Storyboard>, the storyboard ends.</span></span>

- <span data-ttu-id="55ae5-206">Si le contrôle est déjà dans l’état spécifié, <xref:System.Windows.VisualStateManager.GoToState%2A> n’effectue aucune action et retourne `true`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-206">If the control is already in the state that is specified, <xref:System.Windows.VisualStateManager.GoToState%2A> takes no action and returns `true`.</span></span>

- <span data-ttu-id="55ae5-207">Si l’état spécifié n’existe pas dans le <xref:System.Windows.Controls.ControlTemplate> de `control`, <xref:System.Windows.VisualStateManager.GoToState%2A> n’effectue aucune action et retourne `false`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-207">If state that is specified doesn't exist in the <xref:System.Windows.Controls.ControlTemplate> of `control`, <xref:System.Windows.VisualStateManager.GoToState%2A> takes no action and returns `false`.</span></span>

#### <a name="best-practices-for-working-with-the-visualstatemanager"></a><span data-ttu-id="55ae5-208">Meilleures pratiques pour l’utilisation du VisualStateManager</span><span class="sxs-lookup"><span data-stu-id="55ae5-208">Best Practices for Working with the VisualStateManager</span></span>

<span data-ttu-id="55ae5-209">Il est recommandé d’effectuer les opérations suivantes pour conserver les États de votre contrôle :</span><span class="sxs-lookup"><span data-stu-id="55ae5-209">It is recommended that you do the following to maintain your control's states:</span></span>

- <span data-ttu-id="55ae5-210">Utilisez les propriétés pour suivre son état.</span><span class="sxs-lookup"><span data-stu-id="55ae5-210">Use properties to track its state.</span></span>

- <span data-ttu-id="55ae5-211">Créez une méthode d’assistance pour effectuer la transition entre les États.</span><span class="sxs-lookup"><span data-stu-id="55ae5-211">Create a helper method to transition between states.</span></span>

<span data-ttu-id="55ae5-212">Le contrôle `NumericUpDown` utilise sa propriété `Value` pour déterminer s’il est dans l’État `Positive` ou `Negative`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-212">The `NumericUpDown` control uses its `Value` property to track whether it is in the `Positive` or `Negative` state.</span></span>  <span data-ttu-id="55ae5-213">Le contrôle `NumericUpDown` définit également les États `Focused` et `UnFocused` qui effectuent le suivi de la propriété <xref:System.Windows.UIElement.IsFocused%2A>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-213">The `NumericUpDown` control also defines the `Focused` and `UnFocused` states, which tracks the <xref:System.Windows.UIElement.IsFocused%2A> property.</span></span> <span data-ttu-id="55ae5-214">Si vous utilisez des États qui ne correspondent pas naturellement à une propriété du contrôle, vous pouvez définir une propriété privée pour effectuer le suivi de l’État.</span><span class="sxs-lookup"><span data-stu-id="55ae5-214">If you use states that do not naturally correspond to a property of the control, you can define a private property to track the state.</span></span>

<span data-ttu-id="55ae5-215">Une méthode unique qui met à jour tous les États centralise les appels au <xref:System.Windows.VisualStateManager> et assure la gestion de votre code.</span><span class="sxs-lookup"><span data-stu-id="55ae5-215">A single method that updates all the states centralizes calls to the <xref:System.Windows.VisualStateManager> and keeps your code manageable.</span></span> <span data-ttu-id="55ae5-216">L’exemple suivant illustre la méthode d’assistance du contrôle `NumericUpDown`, `UpdateStates`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-216">The following example shows the `NumericUpDown` control's helper method, `UpdateStates`.</span></span> <span data-ttu-id="55ae5-217">Lorsque `Value` est supérieur ou égal à 0, le <xref:System.Windows.Controls.Control> est dans l’État `Positive`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-217">When `Value` is greater than or equal to 0, the <xref:System.Windows.Controls.Control> is in the `Positive` state.</span></span>  <span data-ttu-id="55ae5-218">Lorsque `Value` est inférieur à 0, le contrôle est dans l’État `Negative`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-218">When `Value` is less than 0, the control is in the `Negative` state.</span></span>  <span data-ttu-id="55ae5-219">Lorsque <xref:System.Windows.UIElement.IsFocused%2A> est `true`, le contrôle est dans l’État `Focused` ; dans le cas contraire, il est dans l’État `Unfocused`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-219">When <xref:System.Windows.UIElement.IsFocused%2A> is `true`, the control is in the `Focused` state; otherwise, it is in the `Unfocused` state.</span></span>  <span data-ttu-id="55ae5-220">Le contrôle peut appeler `UpdateStates` chaque fois qu’il doit modifier son état, quel que soit l’état modifié.</span><span class="sxs-lookup"><span data-stu-id="55ae5-220">The control can call `UpdateStates` whenever it needs to change its state, regardless of what state changes.</span></span>

[!code-csharp[VSMCustomControl#UpdateStates](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/numericupdown.cs#updatestates)]
[!code-vb[VSMCustomControl#UpdateStates](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmcustomcontrol/visualbasic/numericupdown.vb#updatestates)]

<span data-ttu-id="55ae5-221">Si vous transmettez un nom d’État à <xref:System.Windows.VisualStateManager.GoToState%2A> lorsque le contrôle est déjà dans cet État, <xref:System.Windows.VisualStateManager.GoToState%2A> ne fait rien, vous n’avez donc pas besoin de vérifier l’état actuel du contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-221">If you pass a state name to <xref:System.Windows.VisualStateManager.GoToState%2A> when the control is already in that state, <xref:System.Windows.VisualStateManager.GoToState%2A> does nothing, so you don't need to check for the control's current state.</span></span>  <span data-ttu-id="55ae5-222">Par exemple, si `Value` passe d’un nombre négatif à un autre nombre négatif, le Storyboard de l’état de `Negative` n’est pas interrompu et l’utilisateur ne voit pas de modification dans le contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-222">For example, if `Value` changes from one negative number to another negative number, the storyboard for the `Negative` state is not interrupted and the user will not see a change in the control.</span></span>

<span data-ttu-id="55ae5-223">L' <xref:System.Windows.VisualStateManager> utilise des objets <xref:System.Windows.VisualStateGroup> pour déterminer l’État à quitter lorsque vous appelez <xref:System.Windows.VisualStateManager.GoToState%2A>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-223">The <xref:System.Windows.VisualStateManager> uses <xref:System.Windows.VisualStateGroup> objects to determine which state to exit when you call <xref:System.Windows.VisualStateManager.GoToState%2A>.</span></span> <span data-ttu-id="55ae5-224">Le contrôle est toujours dans un État pour chaque <xref:System.Windows.VisualStateGroup> défini dans son <xref:System.Windows.Controls.ControlTemplate> et ne quitte un État que lorsqu’il passe à un autre État du même <xref:System.Windows.VisualStateGroup>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-224">The control is always in one state for each <xref:System.Windows.VisualStateGroup> that is defined in its <xref:System.Windows.Controls.ControlTemplate> and only leaves a state when it goes into another state from the same <xref:System.Windows.VisualStateGroup>.</span></span> <span data-ttu-id="55ae5-225">Par exemple, le <xref:System.Windows.Controls.ControlTemplate> du contrôle `NumericUpDown` définit le `Positive` et `Negative`objets<xref:System.Windows.VisualState> dans une <xref:System.Windows.VisualStateGroup> et les objets `Focused` et `Unfocused`<xref:System.Windows.VisualState> dans un autre.</span><span class="sxs-lookup"><span data-stu-id="55ae5-225">For example, the <xref:System.Windows.Controls.ControlTemplate> of the `NumericUpDown` control defines the `Positive` and `Negative`<xref:System.Windows.VisualState> objects in one <xref:System.Windows.VisualStateGroup> and the `Focused` and `Unfocused`<xref:System.Windows.VisualState> objects in another.</span></span> <span data-ttu-id="55ae5-226">(Vous pouvez voir les `Focused` et les `Unfocused`<xref:System.Windows.VisualState> définis dans la section [exemple complet](#complete_example) de cette rubrique lorsque le contrôle passe de l’État `Positive` à l’État `Negative`, ou vice versa, le contrôle reste dans la `Focused` ou `Unfocused` Département.</span><span class="sxs-lookup"><span data-stu-id="55ae5-226">(You can see the `Focused` and `Unfocused`<xref:System.Windows.VisualState> defined in the [Complete Example](#complete_example) section in this topic When the control goes from the `Positive` state to the `Negative` state, or vice versa, the control remains in either the `Focused` or `Unfocused` state.</span></span>

<span data-ttu-id="55ae5-227">Il existe trois emplacements classiques où l’état d’un contrôle peut changer :</span><span class="sxs-lookup"><span data-stu-id="55ae5-227">There are three typical places where the state of a control might change:</span></span>

- <span data-ttu-id="55ae5-228">Lorsque le <xref:System.Windows.Controls.ControlTemplate> est appliqué au <xref:System.Windows.Controls.Control>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-228">When the <xref:System.Windows.Controls.ControlTemplate> is applied to the <xref:System.Windows.Controls.Control>.</span></span>

- <span data-ttu-id="55ae5-229">Quand une propriété est modifiée.</span><span class="sxs-lookup"><span data-stu-id="55ae5-229">When a property changes.</span></span>

- <span data-ttu-id="55ae5-230">Lorsqu’un événement se produit.</span><span class="sxs-lookup"><span data-stu-id="55ae5-230">When an event occurs.</span></span>

<span data-ttu-id="55ae5-231">Les exemples suivants illustrent la mise à jour de l’état du contrôle `NumericUpDown` dans ces cas.</span><span class="sxs-lookup"><span data-stu-id="55ae5-231">The following examples demonstrate updating the state of the `NumericUpDown` control in these cases.</span></span>

<span data-ttu-id="55ae5-232">Vous devez mettre à jour l’état du contrôle dans la méthode <xref:System.Windows.FrameworkElement.OnApplyTemplate%2A> pour que le contrôle s’affiche dans l’état correct lorsque le <xref:System.Windows.Controls.ControlTemplate> est appliqué.</span><span class="sxs-lookup"><span data-stu-id="55ae5-232">You should update the state of the control in the <xref:System.Windows.FrameworkElement.OnApplyTemplate%2A> method so that the control appears in the correct state when the <xref:System.Windows.Controls.ControlTemplate> is applied.</span></span> <span data-ttu-id="55ae5-233">L’exemple suivant appelle `UpdateStates` dans <xref:System.Windows.FrameworkElement.OnApplyTemplate%2A> pour garantir que le contrôle est dans les États appropriés.</span><span class="sxs-lookup"><span data-stu-id="55ae5-233">The following example calls `UpdateStates` in <xref:System.Windows.FrameworkElement.OnApplyTemplate%2A> to ensure that the control is in the appropriate states.</span></span>  <span data-ttu-id="55ae5-234">Supposons, par exemple, que vous créez un contrôle `NumericUpDown` et que vous affectez à son <xref:System.Windows.Controls.Control.Foreground%2A> la valeur vert et à la `Value` la valeur-5.</span><span class="sxs-lookup"><span data-stu-id="55ae5-234">For example, suppose that you create a `NumericUpDown` control, and then set its <xref:System.Windows.Controls.Control.Foreground%2A> to green and `Value` to -5.</span></span>  <span data-ttu-id="55ae5-235">Si vous n’appelez pas `UpdateStates` lorsque le <xref:System.Windows.Controls.ControlTemplate> est appliqué au contrôle `NumericUpDown`, le contrôle n’est pas dans l’État `Negative` et la valeur est verte au lieu de rouge.</span><span class="sxs-lookup"><span data-stu-id="55ae5-235">If you do not call `UpdateStates` when the <xref:System.Windows.Controls.ControlTemplate> is applied to the `NumericUpDown` control, the control is not in the `Negative` state and the value is green instead of red.</span></span>  <span data-ttu-id="55ae5-236">Vous devez appeler `UpdateStates` pour placer le contrôle dans l’État `Negative`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-236">You must call `UpdateStates` to put the control in the `Negative` state.</span></span>

[!code-csharp[VSMCustomControl#ApplyTemplate](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/numericupdown.cs#applytemplate)]
[!code-vb[VSMCustomControl#ApplyTemplate](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmcustomcontrol/visualbasic/numericupdown.vb#applytemplate)]

<span data-ttu-id="55ae5-237">Vous devez souvent mettre à jour les États d’un contrôle lorsqu’une propriété change.</span><span class="sxs-lookup"><span data-stu-id="55ae5-237">You often need to update the states of a control when a property changes.</span></span> <span data-ttu-id="55ae5-238">L’exemple suivant montre l’intégralité de la méthode `ValueChangedCallback`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-238">The following example shows the entire `ValueChangedCallback` method.</span></span> <span data-ttu-id="55ae5-239">Étant donné que `ValueChangedCallback` est appelé lorsque `Value` change, la méthode appelle `UpdateStates` au cas où `Value` passerait de positif à négatif, ou vice versa.</span><span class="sxs-lookup"><span data-stu-id="55ae5-239">Because `ValueChangedCallback` is called when `Value` changes, the method calls `UpdateStates` in case `Value` changed from positive to negative or vice versa.</span></span> <span data-ttu-id="55ae5-240">Il est acceptable d’appeler `UpdateStates` lorsque `Value` change mais reste positif ou négatif, car dans ce cas, le contrôle ne change pas d’État.</span><span class="sxs-lookup"><span data-stu-id="55ae5-240">It is acceptable to call `UpdateStates` when `Value` changes but remains positive or negative because in that case, the control will not change states.</span></span>

[!code-csharp[VSMCustomControl#EntireValueChangedCallback](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/numericupdown.cs#entirevaluechangedcallback)]
[!code-vb[VSMCustomControl#EntireValueChangedCallback](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmcustomcontrol/visualbasic/numericupdown.vb#entirevaluechangedcallback)]

<span data-ttu-id="55ae5-241">Vous devrez peut-être également mettre à jour les États lorsqu’un événement se produit.</span><span class="sxs-lookup"><span data-stu-id="55ae5-241">You might also need to update states when an event occurs.</span></span> <span data-ttu-id="55ae5-242">L’exemple suivant montre que le `NumericUpDown` appelle `UpdateStates` sur le <xref:System.Windows.Controls.Control> pour gérer l’événement <xref:System.Windows.UIElement.GotFocus>.</span><span class="sxs-lookup"><span data-stu-id="55ae5-242">The following example shows that the `NumericUpDown` calls `UpdateStates` on the <xref:System.Windows.Controls.Control> to handle the <xref:System.Windows.UIElement.GotFocus> event.</span></span>

[!code-csharp[VSMCustomControl#OnGotFocus](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/numericupdown.cs#ongotfocus)]
[!code-vb[VSMCustomControl#OnGotFocus](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmcustomcontrol/visualbasic/numericupdown.vb#ongotfocus)]

<span data-ttu-id="55ae5-243">Le <xref:System.Windows.VisualStateManager> vous aide à gérer les États de votre contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-243">The <xref:System.Windows.VisualStateManager> helps you manage your control's states.</span></span> <span data-ttu-id="55ae5-244">En utilisant l' <xref:System.Windows.VisualStateManager>, vous vous assurez que votre contrôle passe correctement d’un État à l’autre.</span><span class="sxs-lookup"><span data-stu-id="55ae5-244">By using the <xref:System.Windows.VisualStateManager>, you ensure that your control correctly transitions between states.</span></span>  <span data-ttu-id="55ae5-245">Si vous suivez les recommandations décrites dans cette section pour utiliser le <xref:System.Windows.VisualStateManager>, le code de votre contrôle reste lisible et gérable.</span><span class="sxs-lookup"><span data-stu-id="55ae5-245">If you follow the recommendations described in this section for working with the <xref:System.Windows.VisualStateManager>, your control's code will remain readable and maintainable.</span></span>

<a name="providing_the_control_contract"></a>

## <a name="providing-the-control-contract"></a><span data-ttu-id="55ae5-246">Fourniture du contrat de contrôle</span><span class="sxs-lookup"><span data-stu-id="55ae5-246">Providing the Control Contract</span></span>

<span data-ttu-id="55ae5-247">Vous fournissez un contrat de contrôle afin que <xref:System.Windows.Controls.ControlTemplate> auteurs sachent ce qu’il faut placer dans le modèle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-247">You provide a control contract so that <xref:System.Windows.Controls.ControlTemplate> authors will know what to put in the template.</span></span> <span data-ttu-id="55ae5-248">Un contrat de contrôle comporte trois éléments :</span><span class="sxs-lookup"><span data-stu-id="55ae5-248">A control contract has three elements:</span></span>

- <span data-ttu-id="55ae5-249">les éléments visuels utilisés par la logique du contrôle ;</span><span class="sxs-lookup"><span data-stu-id="55ae5-249">The visual elements that the control's logic uses.</span></span>

- <span data-ttu-id="55ae5-250">les états du contrôle et le groupe auquel appartient chaque état ;</span><span class="sxs-lookup"><span data-stu-id="55ae5-250">The states of the control and the group each state belongs to.</span></span>

- <span data-ttu-id="55ae5-251">les propriétés publiques qui affectent visuellement le contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-251">The public properties that visually affect the control.</span></span>

<span data-ttu-id="55ae5-252">Une personne qui crée un <xref:System.Windows.Controls.ControlTemplate> doit savoir ce que <xref:System.Windows.FrameworkElement> objets utilisés par la logique du contrôle, le type de chaque objet et son nom.</span><span class="sxs-lookup"><span data-stu-id="55ae5-252">Someone that creates a new <xref:System.Windows.Controls.ControlTemplate> needs to know what <xref:System.Windows.FrameworkElement> objects the control's logic uses, what type each object is, and what its name is.</span></span> <span data-ttu-id="55ae5-253">Un auteur de <xref:System.Windows.Controls.ControlTemplate> doit également connaître le nom de chaque état possible du contrôle, ainsi que l' <xref:System.Windows.VisualStateGroup> l’État.</span><span class="sxs-lookup"><span data-stu-id="55ae5-253">A <xref:System.Windows.Controls.ControlTemplate> author also needs to know the name of each possible state the control can be in, and which <xref:System.Windows.VisualStateGroup> the state is in.</span></span>

<span data-ttu-id="55ae5-254">Si vous revenez à l’exemple de `NumericUpDown`, le contrôle s’attend à ce que les <xref:System.Windows.Controls.ControlTemplate> aient les objets <xref:System.Windows.FrameworkElement> suivants :</span><span class="sxs-lookup"><span data-stu-id="55ae5-254">Returning to the `NumericUpDown` example, the control expects the <xref:System.Windows.Controls.ControlTemplate> to have the following <xref:System.Windows.FrameworkElement> objects:</span></span>

- <span data-ttu-id="55ae5-255">Une <xref:System.Windows.Controls.Primitives.RepeatButton> appelée `UpButton`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-255">A <xref:System.Windows.Controls.Primitives.RepeatButton> called `UpButton`.</span></span>

- <span data-ttu-id="55ae5-256">Une <xref:System.Windows.Controls.Primitives.RepeatButton> appelée `DownButton.`</span><span class="sxs-lookup"><span data-stu-id="55ae5-256">A <xref:System.Windows.Controls.Primitives.RepeatButton> called `DownButton.`</span></span>

 <span data-ttu-id="55ae5-257">Le contrôle peut avoir les États suivants :</span><span class="sxs-lookup"><span data-stu-id="55ae5-257">The control can be in the following states:</span></span>

- <span data-ttu-id="55ae5-258">Dans le `ValueStates`<xref:System.Windows.VisualStateGroup></span><span class="sxs-lookup"><span data-stu-id="55ae5-258">In the `ValueStates`<xref:System.Windows.VisualStateGroup></span></span>

  - `Positive`

  - `Negative`

- <span data-ttu-id="55ae5-259">Dans le `FocusStates`<xref:System.Windows.VisualStateGroup></span><span class="sxs-lookup"><span data-stu-id="55ae5-259">In the `FocusStates`<xref:System.Windows.VisualStateGroup></span></span>

  - `Focused`

  - `Unfocused`

<span data-ttu-id="55ae5-260">Pour spécifier les objets <xref:System.Windows.FrameworkElement> que le contrôle attend, vous utilisez le <xref:System.Windows.TemplatePartAttribute>, qui spécifie le nom et le type des éléments attendus.</span><span class="sxs-lookup"><span data-stu-id="55ae5-260">To specify what <xref:System.Windows.FrameworkElement> objects the control expects, you use the <xref:System.Windows.TemplatePartAttribute>, which specifies the name and type of the expected elements.</span></span>  <span data-ttu-id="55ae5-261">Pour spécifier les États possibles d’un contrôle, vous utilisez l' <xref:System.Windows.TemplateVisualStateAttribute>, qui spécifie le nom de l’État et à quel <xref:System.Windows.VisualStateGroup> il appartient.</span><span class="sxs-lookup"><span data-stu-id="55ae5-261">To specify the possible states of a control, you use the <xref:System.Windows.TemplateVisualStateAttribute>, which specifies the state's name and which <xref:System.Windows.VisualStateGroup> it belongs to.</span></span>  <span data-ttu-id="55ae5-262">Placez le <xref:System.Windows.TemplatePartAttribute> et <xref:System.Windows.TemplateVisualStateAttribute> sur la définition de classe du contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-262">Put the <xref:System.Windows.TemplatePartAttribute> and <xref:System.Windows.TemplateVisualStateAttribute> on the class definition of the control.</span></span>

<span data-ttu-id="55ae5-263">Toute propriété publique qui affecte l’apparence de votre contrôle fait également partie du contrat de contrôle.</span><span class="sxs-lookup"><span data-stu-id="55ae5-263">Any public property that affects the appearance of your control is also a part of the control contract.</span></span>

<span data-ttu-id="55ae5-264">L’exemple suivant spécifie l’objet <xref:System.Windows.FrameworkElement> et les États du contrôle `NumericUpDown`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-264">The following example specifies the <xref:System.Windows.FrameworkElement> object and states for the `NumericUpDown` control.</span></span>

[!code-csharp[VSMCustomControl#ControlContract](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/numericupdown.cs#controlcontract)]
[!code-vb[VSMCustomControl#ControlContract](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmcustomcontrol/visualbasic/numericupdown.vb#controlcontract)]

<a name="complete_example"></a>

## <a name="complete-example"></a><span data-ttu-id="55ae5-265">Exemple complet</span><span class="sxs-lookup"><span data-stu-id="55ae5-265">Complete Example</span></span>

<span data-ttu-id="55ae5-266">L’exemple suivant est le <xref:System.Windows.Controls.ControlTemplate> entier pour le contrôle `NumericUpDown`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-266">The following example is the entire <xref:System.Windows.Controls.ControlTemplate> for the `NumericUpDown` control.</span></span>

[!code-xaml[VSMCustomControl#NUDTemplate](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/themes/generic.xaml#nudtemplate)]

<span data-ttu-id="55ae5-267">L’exemple suivant illustre la logique de la `NumericUpDown`.</span><span class="sxs-lookup"><span data-stu-id="55ae5-267">The following example shows the logic for the `NumericUpDown`.</span></span>

[!code-csharp[VSMCustomControl#ControlLogic](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmcustomcontrol/csharp/numericupdown.cs#controllogic)]
[!code-vb[VSMCustomControl#ControlLogic](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmcustomcontrol/visualbasic/numericupdown.vb#controllogic)]

## <a name="see-also"></a><span data-ttu-id="55ae5-268">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="55ae5-268">See also</span></span>

- [<span data-ttu-id="55ae5-269">Personnalisation de l’apparence d’un contrôle existant en créant un ControlTemplate</span><span class="sxs-lookup"><span data-stu-id="55ae5-269">Customizing the Appearance of an Existing Control by Creating a ControlTemplate</span></span>](customizing-the-appearance-of-an-existing-control.md)
- [<span data-ttu-id="55ae5-270">Personnalisation des contrôles</span><span class="sxs-lookup"><span data-stu-id="55ae5-270">Control Customization</span></span>](control-customization.md)

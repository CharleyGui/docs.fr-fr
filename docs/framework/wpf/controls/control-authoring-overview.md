---
title: Vue d’ensemble de la création de contrôles
description: L’extensibilité des contrôles Windows Presentation Foundation réduit la nécessité de créer des contrôles personnalisés. Découvrez comment créer un nouveau contrôle, si nécessaire.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- controls [WPF], authoring overview
- authoring overview for controls [WPF]
ms.assetid: 3d864748-cff0-4e63-9b23-d8e5a635b28f
ms.openlocfilehash: 600eb193613846d7eeeb626a6dfd317d2592f809
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/24/2020
ms.locfileid: "87166343"
---
# <a name="control-authoring-overview"></a><span data-ttu-id="c99b9-104">Vue d’ensemble de la création de contrôles</span><span class="sxs-lookup"><span data-stu-id="c99b9-104">Control authoring overview</span></span>

<span data-ttu-id="c99b9-105">L’extensibilité du modèle de contrôle [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] réduit grandement la nécessité de créer un contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-105">The extensibility of the [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] control model greatly reduces the need to create a new control.</span></span> <span data-ttu-id="c99b9-106">Vous pouvez toutefois être amené, dans certains cas, à créer un contrôle personnalisé.</span><span class="sxs-lookup"><span data-stu-id="c99b9-106">However, in certain cases you may still need to create a custom control.</span></span> <span data-ttu-id="c99b9-107">Cette rubrique aborde les fonctionnalités qui limitent la nécessité de créer un contrôle personnalisé et les différents modèles de création de contrôles dans [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c99b9-107">This topic discusses the features that minimize your need to create a custom control and the different control authoring models in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].</span></span> <span data-ttu-id="c99b9-108">Cette rubrique montre également comment créer un contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-108">This topic also demonstrates how to create a new control.</span></span>

<a name="when_to_write_a_new_control"></a>

## <a name="alternatives-to-writing-a-new-control"></a><span data-ttu-id="c99b9-109">Alternatives à l’écriture d’un nouveau contrôle</span><span class="sxs-lookup"><span data-stu-id="c99b9-109">Alternatives to Writing a New Control</span></span>

<span data-ttu-id="c99b9-110">Par le passé, quand vous souhaitiez obtenir une expérience personnalisée à partir d’un contrôle existant, vous étiez limité à la modification des propriétés standard du contrôle (couleur d’arrière-plan, largeur de bordure, la taille de police, etc.).</span><span class="sxs-lookup"><span data-stu-id="c99b9-110">Historically, if you wanted to get a customized experience from an existing control, you were limited to changing the standard properties of the control, such as background color, border width, and font size.</span></span> <span data-ttu-id="c99b9-111">Si vous souhaitiez étendre l’apparence ou le comportement d’un contrôle au-delà de ces paramètres prédéfinis, vous deviez créer un contrôle, en procédant généralement par héritage d’un contrôle existant et par substitution de la méthode responsable du dessin du contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-111">If you wished to extend the appearance or behavior of a control beyond these predefined parameters, you would need to create a new control, usually by inheriting from an existing control and overriding the method responsible for drawing the control.</span></span>  <span data-ttu-id="c99b9-112">Bien que ce soit toujours possible, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] vous permet de personnaliser des contrôles existants en utilisant son modèle de contenu riche, ses styles, ses modèles et ses déclencheurs.</span><span class="sxs-lookup"><span data-stu-id="c99b9-112">Although that is still an option, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] enables to you customize existing controls by using its rich content model, styles, templates, and triggers.</span></span> <span data-ttu-id="c99b9-113">La liste suivante donne des exemples d’utilisation de ces fonctionnalités pour créer des expériences personnalisées et cohérentes sans devoir créer un contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-113">The following list gives examples of how these features can be used to create custom and consistent experiences without having to create a new control.</span></span>

- <span data-ttu-id="c99b9-114">**Contenu riche.**</span><span class="sxs-lookup"><span data-stu-id="c99b9-114">**Rich Content.**</span></span> <span data-ttu-id="c99b9-115">De nombreux contrôles [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] standard prennent en charge le contenu riche.</span><span class="sxs-lookup"><span data-stu-id="c99b9-115">Many of the standard [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls support rich content.</span></span> <span data-ttu-id="c99b9-116">Par exemple, la propriété de contenu d’un <xref:System.Windows.Controls.Button> est de type <xref:System.Object> , donc théoriquement peut être affiché sur un <xref:System.Windows.Controls.Button> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-116">For example, the content property of a <xref:System.Windows.Controls.Button> is of type <xref:System.Object>, so theoretically anything can be displayed on a <xref:System.Windows.Controls.Button>.</span></span>  <span data-ttu-id="c99b9-117">Pour qu’un bouton affiche une image et du texte, vous pouvez ajouter une image et un <xref:System.Windows.Controls.TextBlock> à un <xref:System.Windows.Controls.StackPanel> et assigner <xref:System.Windows.Controls.StackPanel> à la <xref:System.Windows.Controls.ContentControl.Content%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="c99b9-117">To have a button display an image and text, you can add an image and a <xref:System.Windows.Controls.TextBlock> to a <xref:System.Windows.Controls.StackPanel> and assign the <xref:System.Windows.Controls.StackPanel> to the <xref:System.Windows.Controls.ContentControl.Content%2A> property.</span></span> <span data-ttu-id="c99b9-118">Étant donné que les contrôles peuvent afficher des éléments visuels [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et des données arbitraires, il est moins souvent nécessaire de créer un contrôle ou de modifier un contrôle existant pour prendre en charge une visualisation complexe.</span><span class="sxs-lookup"><span data-stu-id="c99b9-118">Because the controls can display [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual elements and arbitrary data, there is less need to create a new control or to modify an existing control to support a complex visualization.</span></span> <span data-ttu-id="c99b9-119">Pour plus d’informations sur le modèle de contenu pour <xref:System.Windows.Controls.Button> et d’autres modèles de contenu dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] , consultez [modèle de contenu WPF](wpf-content-model.md).</span><span class="sxs-lookup"><span data-stu-id="c99b9-119">For more information about the content model for <xref:System.Windows.Controls.Button> and other content models in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [WPF Content Model](wpf-content-model.md).</span></span>

- <span data-ttu-id="c99b9-120">**Ils.**</span><span class="sxs-lookup"><span data-stu-id="c99b9-120">**Styles.**</span></span> <span data-ttu-id="c99b9-121">Un <xref:System.Windows.Style> est une collection de valeurs qui représentent les propriétés d’un contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-121">A <xref:System.Windows.Style> is a collection of values that represent properties for a control.</span></span> <span data-ttu-id="c99b9-122">Grâce aux styles, vous pouvez créer une représentation réutilisable de l’apparence et du comportement souhaités d’un contrôle sans écrire un nouveau contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-122">By using styles, you can create a reusable representation of a desired control appearance and behavior without writing a new control.</span></span> <span data-ttu-id="c99b9-123">Par exemple, supposons que vous voulez que tous vos <xref:System.Windows.Controls.TextBlock> contrôles aient une police rouge, Arial avec une taille de police de 14.</span><span class="sxs-lookup"><span data-stu-id="c99b9-123">For example, assume that you want all of your <xref:System.Windows.Controls.TextBlock> controls to have red, Arial font with a font size of 14.</span></span> <span data-ttu-id="c99b9-124">Vous pouvez créer un style comme ressource et définir les propriétés appropriées en conséquence.</span><span class="sxs-lookup"><span data-stu-id="c99b9-124">You can create a style as a resource and set the appropriate properties accordingly.</span></span> <span data-ttu-id="c99b9-125">Ensuite, chaque <xref:System.Windows.Controls.TextBlock> que vous ajoutez à votre application aura la même apparence.</span><span class="sxs-lookup"><span data-stu-id="c99b9-125">Then every <xref:System.Windows.Controls.TextBlock> that you add to your application will have the same appearance.</span></span>

- <span data-ttu-id="c99b9-126">**Modèles de données.**</span><span class="sxs-lookup"><span data-stu-id="c99b9-126">**Data Templates.**</span></span> <span data-ttu-id="c99b9-127">Un <xref:System.Windows.DataTemplate> vous permet de personnaliser le mode d’affichage des données sur un contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-127">A <xref:System.Windows.DataTemplate> enables you to customize how data is displayed on a control.</span></span> <span data-ttu-id="c99b9-128">Par exemple, un <xref:System.Windows.DataTemplate> peut être utilisé pour spécifier la façon dont les données sont affichées dans un <xref:System.Windows.Controls.ListBox> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-128">For example, a <xref:System.Windows.DataTemplate> can be used to specify how data is displayed in a <xref:System.Windows.Controls.ListBox>.</span></span>  <span data-ttu-id="c99b9-129">Pour obtenir un exemple, consultez [Vue d’ensemble des modèles de données](../data/data-templating-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c99b9-129">For an example of this, see [Data Templating Overview](../data/data-templating-overview.md).</span></span>  <span data-ttu-id="c99b9-130">Outre la personnalisation de l’apparence des données, un <xref:System.Windows.DataTemplate> peut inclure des éléments d’interface utilisateur, ce qui vous offre une grande flexibilité dans les interfaces utilisateur personnalisées.</span><span class="sxs-lookup"><span data-stu-id="c99b9-130">In addition to customizing the appearance of data, a <xref:System.Windows.DataTemplate> can include UI elements, which gives you a lot of flexibility in custom UIs.</span></span>  <span data-ttu-id="c99b9-131">Par exemple, en utilisant un <xref:System.Windows.DataTemplate> , vous pouvez créer un <xref:System.Windows.Controls.ComboBox> dans lequel chaque élément contient une case à cocher.</span><span class="sxs-lookup"><span data-stu-id="c99b9-131">For example, by using a <xref:System.Windows.DataTemplate>, you can create a <xref:System.Windows.Controls.ComboBox> in which each item contains a check box.</span></span>

- <span data-ttu-id="c99b9-132">**Modèles de contrôle.**</span><span class="sxs-lookup"><span data-stu-id="c99b9-132">**Control Templates.**</span></span> <span data-ttu-id="c99b9-133">De nombreux contrôles dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] utilisent un <xref:System.Windows.Controls.ControlTemplate> pour définir la structure et l’apparence du contrôle, qui sépare l’apparence d’un contrôle de la fonctionnalité du contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-133">Many controls in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] use a <xref:System.Windows.Controls.ControlTemplate> to define the control's structure and appearance, which separates the appearance of a control from the functionality of the control.</span></span> <span data-ttu-id="c99b9-134">Vous pouvez modifier radicalement l’apparence d’un contrôle en redéfinissant son <xref:System.Windows.Controls.ControlTemplate> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-134">You can drastically change the appearance of a control by redefining its <xref:System.Windows.Controls.ControlTemplate>.</span></span>  <span data-ttu-id="c99b9-135">Imaginons par exemple que vous souhaitiez créer un contrôle ressemblant à un feu rouge.</span><span class="sxs-lookup"><span data-stu-id="c99b9-135">For example, suppose you want a control that looks like a stoplight.</span></span> <span data-ttu-id="c99b9-136">Ce contrôle a une interface utilisateur et des fonctionnalités simples.</span><span class="sxs-lookup"><span data-stu-id="c99b9-136">This control has a simple user interface and functionality.</span></span>  <span data-ttu-id="c99b9-137">Il se compose de trois cercles, dont un seul peut être allumé à la fois.</span><span class="sxs-lookup"><span data-stu-id="c99b9-137">The control is three circles, only one of which can be lit up at a time.</span></span> <span data-ttu-id="c99b9-138">Après une réflexion, vous pouvez vous rendre compte qu’un <xref:System.Windows.Controls.RadioButton> n’offre les fonctionnalités d’un seul élément à la fois, mais l’apparence par défaut de l’n’est pas <xref:System.Windows.Controls.RadioButton> semblable aux lumières sur un feu rouge.</span><span class="sxs-lookup"><span data-stu-id="c99b9-138">After some reflection, you might realize that a <xref:System.Windows.Controls.RadioButton> offers the functionality of only one being selected at a time, but the default appearance of the <xref:System.Windows.Controls.RadioButton> looks nothing like the lights on a stoplight.</span></span>  <span data-ttu-id="c99b9-139">Étant donné que le <xref:System.Windows.Controls.RadioButton> utilise un modèle de contrôle pour définir son apparence, il est facile de redéfinir le afin qu’il <xref:System.Windows.Controls.ControlTemplate> corresponde aux spécifications du contrôle et d’utiliser des cases d’option pour créer votre feu rouge.</span><span class="sxs-lookup"><span data-stu-id="c99b9-139">Because the <xref:System.Windows.Controls.RadioButton> uses a control template to define its appearance, it is easy to redefine the <xref:System.Windows.Controls.ControlTemplate> to fit the requirements of the control, and use radio buttons to make your stoplight.</span></span>

  > [!NOTE]
  > <span data-ttu-id="c99b9-140">Bien qu’un <xref:System.Windows.Controls.RadioButton> puisse utiliser un <xref:System.Windows.DataTemplate> , un <xref:System.Windows.DataTemplate> n’est pas suffisant dans cet exemple.</span><span class="sxs-lookup"><span data-stu-id="c99b9-140">Although a <xref:System.Windows.Controls.RadioButton> can use a <xref:System.Windows.DataTemplate>, a <xref:System.Windows.DataTemplate> is not sufficient in this example.</span></span>  <span data-ttu-id="c99b9-141"><xref:System.Windows.DataTemplate>Définit l’apparence du contenu d’un contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-141">The <xref:System.Windows.DataTemplate> defines the appearance of the content of a control.</span></span> <span data-ttu-id="c99b9-142">Dans le cas d’un <xref:System.Windows.Controls.RadioButton> , le contenu est tout ce qui apparaît à droite du cercle qui indique si <xref:System.Windows.Controls.RadioButton> est sélectionné.</span><span class="sxs-lookup"><span data-stu-id="c99b9-142">In the case of a <xref:System.Windows.Controls.RadioButton>, the content is whatever appears to the right of the circle that indicates whether the <xref:System.Windows.Controls.RadioButton> is selected.</span></span>  <span data-ttu-id="c99b9-143">Dans l’exemple du feu rouge, la case d’option doit simplement être un cercle capable de « s’allumer ».</span><span class="sxs-lookup"><span data-stu-id="c99b9-143">In the example of the stoplight, the radio button needs just be a circle that can "light up."</span></span> <span data-ttu-id="c99b9-144">Étant donné que l’apparence requise pour le feu rouge est si différente de l’apparence par défaut du <xref:System.Windows.Controls.RadioButton> , il est nécessaire de redéfinir <xref:System.Windows.Controls.ControlTemplate> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-144">Because the appearance requirement for the stoplight is so different than the default appearance of the <xref:System.Windows.Controls.RadioButton>, it is necessary to redefine the <xref:System.Windows.Controls.ControlTemplate>.</span></span>  <span data-ttu-id="c99b9-145">En général <xref:System.Windows.DataTemplate> , est utilisé pour définir le contenu (ou les données) d’un contrôle, et <xref:System.Windows.Controls.ControlTemplate> est utilisé pour définir la structure d’un contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-145">In general a <xref:System.Windows.DataTemplate> is used for defining the content (or data) of a control, and a <xref:System.Windows.Controls.ControlTemplate> is used for defining how a control is structured.</span></span>

- <span data-ttu-id="c99b9-146">**Déclencheurs.**</span><span class="sxs-lookup"><span data-stu-id="c99b9-146">**Triggers.**</span></span> <span data-ttu-id="c99b9-147">Un <xref:System.Windows.Trigger> vous permet de modifier dynamiquement l’apparence et le comportement d’un contrôle sans créer de nouveau contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-147">A <xref:System.Windows.Trigger> allows you to dynamically change the appearance and behavior of a control without creating a new control.</span></span> <span data-ttu-id="c99b9-148">Par exemple, supposons que vous ayez plusieurs <xref:System.Windows.Controls.ListBox> contrôles dans votre application et que vous souhaitiez que les éléments de chacun <xref:System.Windows.Controls.ListBox> soient en gras et en rouge lorsqu’ils sont sélectionnés.</span><span class="sxs-lookup"><span data-stu-id="c99b9-148">For example, suppose you have multiple <xref:System.Windows.Controls.ListBox> controls in your application and want the items in each <xref:System.Windows.Controls.ListBox> to be bold and red when they are selected.</span></span> <span data-ttu-id="c99b9-149">Votre premier instinct peut être de créer une classe qui hérite de <xref:System.Windows.Controls.ListBox> et substitue la <xref:System.Windows.Controls.Primitives.Selector.OnSelectionChanged%2A> méthode pour modifier l’apparence de l’élément sélectionné, mais une meilleure approche consiste à ajouter un déclencheur à un style de <xref:System.Windows.Controls.ListBoxItem> qui modifie l’apparence de l’élément sélectionné.</span><span class="sxs-lookup"><span data-stu-id="c99b9-149">Your first instinct might be to create a class that inherits from <xref:System.Windows.Controls.ListBox> and override the <xref:System.Windows.Controls.Primitives.Selector.OnSelectionChanged%2A> method to change the appearance of the selected item, but a better approach is to add a trigger to a style of a <xref:System.Windows.Controls.ListBoxItem> that changes the appearance of the selected item.</span></span> <span data-ttu-id="c99b9-150">Un déclencheur vous permet de changer les valeurs des propriétés ou de prendre des mesures sur la base de la valeur d’une propriété.</span><span class="sxs-lookup"><span data-stu-id="c99b9-150">A trigger enables you to change property values or take actions based on the value of a property.</span></span> <span data-ttu-id="c99b9-151">Un <xref:System.Windows.EventTrigger> vous permet d’effectuer des actions lorsqu’un événement se produit.</span><span class="sxs-lookup"><span data-stu-id="c99b9-151">An <xref:System.Windows.EventTrigger> enables you to take actions when an event occurs.</span></span>

<span data-ttu-id="c99b9-152">Pour plus d’informations sur les styles, modèles et déclencheurs, consultez [Application d’un style et création de modèles](../../../desktop-wpf/fundamentals/styles-templates-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c99b9-152">For more information about styles, templates, and triggers, see [Styling and Templating](../../../desktop-wpf/fundamentals/styles-templates-overview.md).</span></span>

<span data-ttu-id="c99b9-153">En général, si votre contrôle reflète les fonctionnalités d’un contrôle existant, mais que vous souhaitez qu’il ait un aspect différent, vous devez d’abord vous demander s’il est possible d’utiliser l’une des méthodes décrites dans cette section pour changer l’apparence du contrôle existant.</span><span class="sxs-lookup"><span data-stu-id="c99b9-153">In general, if your control mirrors the functionality of an existing control, but you want the control to look different, you should first consider whether you can use any of the methods discussed in this section to change the existing control's appearance.</span></span>

<a name="models_for_control_authoring"></a>

## <a name="models-for-control-authoring"></a><span data-ttu-id="c99b9-154">Modèles de création de contrôles</span><span class="sxs-lookup"><span data-stu-id="c99b9-154">Models for Control Authoring</span></span>

<span data-ttu-id="c99b9-155">Le modèle de contenu riche, les styles, les modèles et les déclencheurs réduisent la nécessité de créer des contrôles.</span><span class="sxs-lookup"><span data-stu-id="c99b9-155">The rich content model, styles, templates, and triggers minimize the need for you to create a new control.</span></span> <span data-ttu-id="c99b9-156">Toutefois, si vous devez créer un contrôle, il est important de comprendre les différents modèles de création de contrôles proposés dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c99b9-156">However, if you do need to create a new control, it is important to understand the different control authoring models in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="c99b9-157">propose trois modèles généraux offrant chacun un jeu de fonctionnalités et un niveau de flexibilité différent.</span><span class="sxs-lookup"><span data-stu-id="c99b9-157">provides three general models for creating a control, each of which provides a different set of features and level of flexibility.</span></span> <span data-ttu-id="c99b9-158">Les classes de base pour les trois modèles sont <xref:System.Windows.Controls.UserControl> , <xref:System.Windows.Controls.Control> et <xref:System.Windows.FrameworkElement> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-158">The base classes for the three models are <xref:System.Windows.Controls.UserControl>, <xref:System.Windows.Controls.Control>, and <xref:System.Windows.FrameworkElement>.</span></span>

### <a name="deriving-from-usercontrol"></a><span data-ttu-id="c99b9-159">Dérivation de UserControl</span><span class="sxs-lookup"><span data-stu-id="c99b9-159">Deriving from UserControl</span></span>

<span data-ttu-id="c99b9-160">La façon la plus simple de créer un contrôle dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] consiste à dériver de <xref:System.Windows.Controls.UserControl> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-160">The simplest way to create a control in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is to derive from <xref:System.Windows.Controls.UserControl>.</span></span> <span data-ttu-id="c99b9-161">Quand vous générez un contrôle qui hérite de <xref:System.Windows.Controls.UserControl> , vous ajoutez des composants existants au <xref:System.Windows.Controls.UserControl> , nommez les composants et référencez les gestionnaires d’événements dans [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c99b9-161">When you build a control that inherits from <xref:System.Windows.Controls.UserControl>, you add existing components to the <xref:System.Windows.Controls.UserControl>, name the components, and reference event handlers in [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)].</span></span> <span data-ttu-id="c99b9-162">Vous pouvez ensuite référencer les éléments nommés et définir les gestionnaires d’événements dans le code.</span><span class="sxs-lookup"><span data-stu-id="c99b9-162">You can then reference the named elements and define the event handlers in code.</span></span> <span data-ttu-id="c99b9-163">Ce modèle de développement ressemble fortement à celui utilisé pour le développement d’applications dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c99b9-163">This development model is very similar to the model used for application development in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>

<span data-ttu-id="c99b9-164">En cas de génération correcte, un <xref:System.Windows.Controls.UserControl> peut tirer parti des avantages du contenu, des styles et des déclencheurs enrichis.</span><span class="sxs-lookup"><span data-stu-id="c99b9-164">If built correctly, a <xref:System.Windows.Controls.UserControl> can take advantage of the benefits of rich content, styles, and triggers.</span></span> <span data-ttu-id="c99b9-165">Toutefois, si votre contrôle hérite de <xref:System.Windows.Controls.UserControl> , les personnes qui utilisent votre contrôle ne seront pas en mesure d’utiliser <xref:System.Windows.DataTemplate> ou <xref:System.Windows.Controls.ControlTemplate> de personnaliser son apparence.</span><span class="sxs-lookup"><span data-stu-id="c99b9-165">However, if your control inherits from <xref:System.Windows.Controls.UserControl>, people who use your control will not be able to use a <xref:System.Windows.DataTemplate> or <xref:System.Windows.Controls.ControlTemplate> to customize its appearance.</span></span>  <span data-ttu-id="c99b9-166">Il est nécessaire de dériver de la <xref:System.Windows.Controls.Control> classe ou de l’une de ses classes dérivées (autres que <xref:System.Windows.Controls.UserControl> ) pour créer un contrôle personnalisé qui prend en charge les modèles.</span><span class="sxs-lookup"><span data-stu-id="c99b9-166">It is necessary to derive from the <xref:System.Windows.Controls.Control> class or one of its derived classes (other than <xref:System.Windows.Controls.UserControl>) to create a custom control that supports templates.</span></span>

#### <a name="benefits-of-deriving-from-usercontrol"></a><span data-ttu-id="c99b9-167">Avantages de la dérivation de UserControl</span><span class="sxs-lookup"><span data-stu-id="c99b9-167">Benefits of Deriving from UserControl</span></span>

<span data-ttu-id="c99b9-168">Envisagez de dériver de <xref:System.Windows.Controls.UserControl> si tous les éléments suivants s’appliquent :</span><span class="sxs-lookup"><span data-stu-id="c99b9-168">Consider deriving from <xref:System.Windows.Controls.UserControl> if all of the following apply:</span></span>

- <span data-ttu-id="c99b9-169">Vous souhaitez générer votre contrôle de la même façon que vous créez une application.</span><span class="sxs-lookup"><span data-stu-id="c99b9-169">You want to build your control similarly to how you build an application.</span></span>

- <span data-ttu-id="c99b9-170">Votre contrôle contient uniquement des composants existants.</span><span class="sxs-lookup"><span data-stu-id="c99b9-170">Your control consists only of existing components.</span></span>

- <span data-ttu-id="c99b9-171">Vous n’avez pas besoin de prendre en charge une personnalisation complexe.</span><span class="sxs-lookup"><span data-stu-id="c99b9-171">You don't need to support complex customization.</span></span>

### <a name="deriving-from-control"></a><span data-ttu-id="c99b9-172">Dérivation de Control</span><span class="sxs-lookup"><span data-stu-id="c99b9-172">Deriving from Control</span></span>

<span data-ttu-id="c99b9-173">La dérivation à partir de la <xref:System.Windows.Controls.Control> classe est le modèle utilisé par la plupart des [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] contrôles existants.</span><span class="sxs-lookup"><span data-stu-id="c99b9-173">Deriving from the <xref:System.Windows.Controls.Control> class is the model used by most of the existing [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls.</span></span> <span data-ttu-id="c99b9-174">Lorsque vous créez un contrôle qui hérite de la <xref:System.Windows.Controls.Control> classe, vous définissez son apparence à l’aide de modèles.</span><span class="sxs-lookup"><span data-stu-id="c99b9-174">When you create a control that inherits from the <xref:System.Windows.Controls.Control> class, you define its appearance by using templates.</span></span> <span data-ttu-id="c99b9-175">En procédant ainsi, vous séparez la logique opérationnelle de la représentation visuelle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-175">By doing so, you separate the operational logic from the visual representation.</span></span> <span data-ttu-id="c99b9-176">Vous pouvez également garantir le découplage de l’interface utilisateur et de la logique en utilisant des commandes et des liaisons plutôt que des événements et en évitant les éléments de référence dans le <xref:System.Windows.Controls.ControlTemplate> chaque fois que cela est possible.</span><span class="sxs-lookup"><span data-stu-id="c99b9-176">You can also ensure the decoupling of the UI and logic by using commands and bindings instead of events and avoiding referencing elements in the <xref:System.Windows.Controls.ControlTemplate> whenever possible.</span></span>  <span data-ttu-id="c99b9-177">Si l’interface utilisateur et la logique de votre contrôle sont correctement découplées, un utilisateur de votre contrôle peut redéfinir le contrôle <xref:System.Windows.Controls.ControlTemplate> pour personnaliser son apparence.</span><span class="sxs-lookup"><span data-stu-id="c99b9-177">If the UI and logic of your control are properly decoupled, a user of your control can redefine the control's <xref:System.Windows.Controls.ControlTemplate> to customize its appearance.</span></span> <span data-ttu-id="c99b9-178">Bien que la génération d’un personnalisé ne <xref:System.Windows.Controls.Control> soit pas aussi simple que la création d’un <xref:System.Windows.Controls.UserControl> , un personnalisé <xref:System.Windows.Controls.Control> offre la plus grande flexibilité.</span><span class="sxs-lookup"><span data-stu-id="c99b9-178">Although building a custom <xref:System.Windows.Controls.Control> is not as simple as building a <xref:System.Windows.Controls.UserControl>, a custom <xref:System.Windows.Controls.Control> provides the most flexibility.</span></span>

#### <a name="benefits-of-deriving-from-control"></a><span data-ttu-id="c99b9-179">Avantages de la dérivation de Control</span><span class="sxs-lookup"><span data-stu-id="c99b9-179">Benefits of Deriving from Control</span></span>

<span data-ttu-id="c99b9-180">Envisagez de dériver de <xref:System.Windows.Controls.Control> au lieu d’utiliser la <xref:System.Windows.Controls.UserControl> classe si l’une des conditions suivantes s’applique :</span><span class="sxs-lookup"><span data-stu-id="c99b9-180">Consider deriving from <xref:System.Windows.Controls.Control> instead of using the <xref:System.Windows.Controls.UserControl> class if any of the following apply:</span></span>

- <span data-ttu-id="c99b9-181">Vous souhaitez que l’apparence de votre contrôle soit personnalisable via le <xref:System.Windows.Controls.ControlTemplate> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-181">You want the appearance of your control to be customizable via the <xref:System.Windows.Controls.ControlTemplate>.</span></span>

- <span data-ttu-id="c99b9-182">Vous souhaitez que votre contrôle prenne en charge des thèmes différents.</span><span class="sxs-lookup"><span data-stu-id="c99b9-182">You want your control to support different themes.</span></span>

### <a name="deriving-from-frameworkelement"></a><span data-ttu-id="c99b9-183">Dérivation de FrameworkElement</span><span class="sxs-lookup"><span data-stu-id="c99b9-183">Deriving from FrameworkElement</span></span>

<span data-ttu-id="c99b9-184">Les contrôles qui dérivent de <xref:System.Windows.Controls.UserControl> ou s' <xref:System.Windows.Controls.Control> appuient sur la composition d’éléments existants.</span><span class="sxs-lookup"><span data-stu-id="c99b9-184">Controls that derive from <xref:System.Windows.Controls.UserControl> or <xref:System.Windows.Controls.Control> rely upon composing existing elements.</span></span> <span data-ttu-id="c99b9-185">Pour de nombreux scénarios, il s’agit d’une solution acceptable, car tout objet qui hérite de <xref:System.Windows.FrameworkElement> peut être dans un <xref:System.Windows.Controls.ControlTemplate> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-185">For many scenarios, this is an acceptable solution, because any object that inherits from <xref:System.Windows.FrameworkElement> can be in a <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="c99b9-186">Dans certains cas, l’apparence d’un contrôle nécessite toutefois des fonctionnalités autres que celles de la composition d’éléments simples.</span><span class="sxs-lookup"><span data-stu-id="c99b9-186">However, there are times when a control's appearance requires more than the functionality of simple element composition.</span></span> <span data-ttu-id="c99b9-187">Pour ces scénarios, la base d’un composant sur <xref:System.Windows.FrameworkElement> est le bon choix.</span><span class="sxs-lookup"><span data-stu-id="c99b9-187">For these scenarios, basing a component on <xref:System.Windows.FrameworkElement> is the right choice.</span></span>

<span data-ttu-id="c99b9-188">Il existe deux méthodes standard pour les <xref:System.Windows.FrameworkElement> composants basés sur la génération : le rendu direct et la composition d’éléments personnalisés.</span><span class="sxs-lookup"><span data-stu-id="c99b9-188">There are two standard methods for building <xref:System.Windows.FrameworkElement>-based components: direct rendering and custom element composition.</span></span> <span data-ttu-id="c99b9-189">Le rendu direct implique de remplacer la <xref:System.Windows.UIElement.OnRender%2A> méthode de <xref:System.Windows.FrameworkElement> et de fournir des <xref:System.Windows.Media.DrawingContext> opérations qui définissent explicitement les éléments visuels du composant.</span><span class="sxs-lookup"><span data-stu-id="c99b9-189">Direct rendering involves overriding the <xref:System.Windows.UIElement.OnRender%2A> method of <xref:System.Windows.FrameworkElement> and providing <xref:System.Windows.Media.DrawingContext> operations that explicitly define the component visuals.</span></span> <span data-ttu-id="c99b9-190">Il s’agit de la méthode utilisée par <xref:System.Windows.Controls.Image> et <xref:System.Windows.Controls.Border> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-190">This is the method used by <xref:System.Windows.Controls.Image> and <xref:System.Windows.Controls.Border>.</span></span> <span data-ttu-id="c99b9-191">La composition d’éléments personnalisés implique l’utilisation d’objets de type <xref:System.Windows.Media.Visual> pour composer l’apparence de votre composant.</span><span class="sxs-lookup"><span data-stu-id="c99b9-191">Custom element composition involves using objects of type <xref:System.Windows.Media.Visual> to compose the appearance of your component.</span></span> <span data-ttu-id="c99b9-192">Pour obtenir un exemple, consultez [Utilisation d’objets DrawingVisual](../graphics-multimedia/using-drawingvisual-objects.md).</span><span class="sxs-lookup"><span data-stu-id="c99b9-192">For an example, see [Using DrawingVisual Objects](../graphics-multimedia/using-drawingvisual-objects.md).</span></span> <span data-ttu-id="c99b9-193"><xref:System.Windows.Controls.Primitives.Track>est un exemple de contrôle dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] qui utilise la composition d’éléments personnalisés.</span><span class="sxs-lookup"><span data-stu-id="c99b9-193"><xref:System.Windows.Controls.Primitives.Track> is an example of a control in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] that uses custom element composition.</span></span> <span data-ttu-id="c99b9-194">Il est également possible de combiner le rendu direct et la composition d’éléments personnalisés au sein du même contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-194">It is also possible to mix direct rendering and custom element composition in the same control.</span></span>

#### <a name="benefits-of-deriving-from-frameworkelement"></a><span data-ttu-id="c99b9-195">Avantages de la dérivation de FrameworkElement</span><span class="sxs-lookup"><span data-stu-id="c99b9-195">Benefits of Deriving from FrameworkElement</span></span>

<span data-ttu-id="c99b9-196">Envisagez de dériver de <xref:System.Windows.FrameworkElement> si l’une des conditions suivantes s’applique :</span><span class="sxs-lookup"><span data-stu-id="c99b9-196">Consider deriving from <xref:System.Windows.FrameworkElement> if any of the following apply:</span></span>

- <span data-ttu-id="c99b9-197">Vous souhaitez avoir un contrôle précis sur l’apparence de votre contrôle au-delà des fonctionnalités proposées par la composition d’éléments simples.</span><span class="sxs-lookup"><span data-stu-id="c99b9-197">You want to have precise control over the appearance of your control beyond what is provided by simple element composition.</span></span>

- <span data-ttu-id="c99b9-198">Vous souhaitez définir l’apparence de votre contrôle en définissant votre propre logique de rendu.</span><span class="sxs-lookup"><span data-stu-id="c99b9-198">You want to define the appearance of your control by defining your own render logic.</span></span>

- <span data-ttu-id="c99b9-199">Vous souhaitez composer des éléments existants de façon innovante, ce qui va au-delà de ce qui est possible avec <xref:System.Windows.Controls.UserControl> et <xref:System.Windows.Controls.Control> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-199">You want to compose existing elements in novel ways that go beyond what is possible with <xref:System.Windows.Controls.UserControl> and <xref:System.Windows.Controls.Control>.</span></span>

<a name="control_authoring_basics"></a>

## <a name="control-authoring-basics"></a><span data-ttu-id="c99b9-200">Notions de base de la création de contrôles</span><span class="sxs-lookup"><span data-stu-id="c99b9-200">Control Authoring Basics</span></span>

<span data-ttu-id="c99b9-201">Comme nous l’avons vu précédemment, l’une des fonctionnalités les plus puissantes de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] est la possibilité d’aller au delà de la définition de propriétés de base d’un contrôle pour changer son apparence et son comportement, sans qu’il soit besoin de créer un contrôle personnalisé.</span><span class="sxs-lookup"><span data-stu-id="c99b9-201">As discussed earlier, one of the most powerful features of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] is the ability to go beyond setting basic properties of a control to change its appearance and behavior, yet still not needing to create a custom control.</span></span> <span data-ttu-id="c99b9-202">Les fonctionnalités liées à la création de styles, à la liaison de données et aux déclencheurs sont rendues possibles par le système de propriétés [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et le système d’événements [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c99b9-202">The styling, data binding, and trigger features are made possible by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] property system and the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event system.</span></span> <span data-ttu-id="c99b9-203">Les sections suivantes décrivent certaines pratiques à respecter, indépendamment du modèle que vous utilisez pour créer le contrôle personnalisé, afin que les utilisateurs de votre contrôle personnalisé puissent utiliser ces fonctionnalités comme ils le feraient pour un contrôle inclus dans [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c99b9-203">The following sections describe some practices that you should follow, regardless of the model you use to create the custom control, so that users of your custom control can use these features just as they would for a control that is included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>

### <a name="use-dependency-properties"></a><span data-ttu-id="c99b9-204">Utiliser des propriétés de dépendance</span><span class="sxs-lookup"><span data-stu-id="c99b9-204">Use Dependency Properties</span></span>

<span data-ttu-id="c99b9-205">Dans le cas d’une propriété de dépendance, il est possible d’effectuer les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="c99b9-205">When a property is a dependency property, it is possible to do the following:</span></span>

- <span data-ttu-id="c99b9-206">Définir la propriété dans un style</span><span class="sxs-lookup"><span data-stu-id="c99b9-206">Set the property in a style.</span></span>

- <span data-ttu-id="c99b9-207">Lier la propriété à une source de données</span><span class="sxs-lookup"><span data-stu-id="c99b9-207">Bind the property to a data source.</span></span>

- <span data-ttu-id="c99b9-208">Utiliser une ressource dynamique comme valeur de la propriété</span><span class="sxs-lookup"><span data-stu-id="c99b9-208">Use a dynamic resource as the property's value.</span></span>

- <span data-ttu-id="c99b9-209">Animer la propriété</span><span class="sxs-lookup"><span data-stu-id="c99b9-209">Animate the property.</span></span>

<span data-ttu-id="c99b9-210">Si vous souhaitez qu’une propriété de votre contrôle prenne en charge l’une de ces fonctionnalités, vous devez l’implémenter comme propriété de dépendance.</span><span class="sxs-lookup"><span data-stu-id="c99b9-210">If you want a property of your control to support any of this functionality, you should implement it as a dependency property.</span></span> <span data-ttu-id="c99b9-211">L’exemple suivant montre comment définir une propriété de dépendance appelée `Value` :</span><span class="sxs-lookup"><span data-stu-id="c99b9-211">The following example defines a dependency property named `Value` by doing the following:</span></span>

- <span data-ttu-id="c99b9-212">Définissez un <xref:System.Windows.DependencyProperty> identificateur nommé `ValueProperty` en tant que `public` `static` `readonly` champ.</span><span class="sxs-lookup"><span data-stu-id="c99b9-212">Define a <xref:System.Windows.DependencyProperty> identifier named `ValueProperty` as a `public` `static` `readonly` field.</span></span>

- <span data-ttu-id="c99b9-213">Inscrivez le nom de la propriété auprès du système de propriétés, en appelant <xref:System.Windows.DependencyProperty.Register%2A?displayProperty=nameWithType> , pour spécifier les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="c99b9-213">Register the property name with the property system, by calling <xref:System.Windows.DependencyProperty.Register%2A?displayProperty=nameWithType>, to specify the following:</span></span>

  - <span data-ttu-id="c99b9-214">Nom de la propriété.</span><span class="sxs-lookup"><span data-stu-id="c99b9-214">The name of the property.</span></span>

  - <span data-ttu-id="c99b9-215">Type de la propriété.</span><span class="sxs-lookup"><span data-stu-id="c99b9-215">The type of the property.</span></span>

  - <span data-ttu-id="c99b9-216">Type qui possède la propriété.</span><span class="sxs-lookup"><span data-stu-id="c99b9-216">The type that owns the property.</span></span>

  - <span data-ttu-id="c99b9-217">Métadonnées de la propriété.</span><span class="sxs-lookup"><span data-stu-id="c99b9-217">The metadata for the property.</span></span> <span data-ttu-id="c99b9-218">Les métadonnées contiennent la valeur par défaut de la propriété, <xref:System.Windows.CoerceValueCallback> et <xref:System.Windows.PropertyChangedCallback> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-218">The metadata contains the property's default value, a <xref:System.Windows.CoerceValueCallback> and a <xref:System.Windows.PropertyChangedCallback>.</span></span>

- <span data-ttu-id="c99b9-219">Définissez une propriété de wrapper CLR nommée `Value` , qui est le même nom que celui utilisé pour inscrire la propriété de dépendance, en implémentant les `get` accesseurs et de la propriété `set` .</span><span class="sxs-lookup"><span data-stu-id="c99b9-219">Define a CLR wrapper property named `Value`, which is the same name that is used to register the dependency property, by implementing the property's `get` and `set` accessors.</span></span> <span data-ttu-id="c99b9-220">Notez que les `get` `set` accesseurs et appellent uniquement <xref:System.Windows.DependencyObject.GetValue%2A> et <xref:System.Windows.DependencyObject.SetValue%2A> respectivement.</span><span class="sxs-lookup"><span data-stu-id="c99b9-220">Note that the `get` and `set` accessors only call <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> respectively.</span></span> <span data-ttu-id="c99b9-221">Il est recommandé que les accesseurs des propriétés de dépendance ne contiennent pas de logique supplémentaire, car les clients et [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] peuvent ignorer les accesseurs et appeler <xref:System.Windows.DependencyObject.GetValue%2A> et <xref:System.Windows.DependencyObject.SetValue%2A> directement.</span><span class="sxs-lookup"><span data-stu-id="c99b9-221">It is recommended that the accessors of dependency properties not contain additional logic because clients and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] can bypass the accessors and call <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> directly.</span></span> <span data-ttu-id="c99b9-222">Par exemple, quand une propriété est liée à une source de données, l’accesseur `set` de la propriété n’est pas appelé.</span><span class="sxs-lookup"><span data-stu-id="c99b9-222">For example, when a property is bound to a data source, the property's `set` accessor is not called.</span></span>  <span data-ttu-id="c99b9-223">Au lieu d’ajouter une logique supplémentaire aux accesseurs d’obtenir et de définir, utilisez les <xref:System.Windows.ValidateValueCallback> <xref:System.Windows.CoerceValueCallback> délégués, et <xref:System.Windows.PropertyChangedCallback> pour répondre à ou vérifier la valeur lorsqu’elle change.</span><span class="sxs-lookup"><span data-stu-id="c99b9-223">Instead of adding additional logic to the get and set accessors, use the <xref:System.Windows.ValidateValueCallback>, <xref:System.Windows.CoerceValueCallback>, and <xref:System.Windows.PropertyChangedCallback> delegates to respond to or check the value when it changes.</span></span>  <span data-ttu-id="c99b9-224">Pour plus d’informations sur ces rappels, consultez [Validation et rappels de propriétés de dépendance](../advanced/dependency-property-callbacks-and-validation.md).</span><span class="sxs-lookup"><span data-stu-id="c99b9-224">For more information on these callbacks, see [Dependency Property Callbacks and Validation](../advanced/dependency-property-callbacks-and-validation.md).</span></span>

- <span data-ttu-id="c99b9-225">Définissez une méthode pour le <xref:System.Windows.CoerceValueCallback> nommé `CoerceValue` .</span><span class="sxs-lookup"><span data-stu-id="c99b9-225">Define a method for the <xref:System.Windows.CoerceValueCallback> named `CoerceValue`.</span></span> <span data-ttu-id="c99b9-226">`CoerceValue` garantit que `Value` est supérieur ou égal à `MinValue` et inférieur ou égal à `MaxValue`.</span><span class="sxs-lookup"><span data-stu-id="c99b9-226">`CoerceValue` ensures that `Value` is greater or equal to `MinValue` and less than or equal to `MaxValue`.</span></span>

- <span data-ttu-id="c99b9-227">Définissez une méthode pour le <xref:System.Windows.PropertyChangedCallback> , nommé `OnValueChanged` .</span><span class="sxs-lookup"><span data-stu-id="c99b9-227">Define a method for the <xref:System.Windows.PropertyChangedCallback>, named `OnValueChanged`.</span></span> <span data-ttu-id="c99b9-228">`OnValueChanged`crée un <xref:System.Windows.RoutedPropertyChangedEventArgs%601> objet et se prépare à déclencher l' `ValueChanged` événement routé.</span><span class="sxs-lookup"><span data-stu-id="c99b9-228">`OnValueChanged` creates a <xref:System.Windows.RoutedPropertyChangedEventArgs%601> object and prepares to raise the `ValueChanged` routed event.</span></span> <span data-ttu-id="c99b9-229">Les événements routés sont traités dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="c99b9-229">Routed events are discussed in the next section.</span></span>

[!code-csharp[UserControlNumericUpDown#DependencyProperty](~/samples/snippets/csharp/VS_Snippets_Wpf/UserControlNumericUpDown/CSharp/NumericUpDown.xaml.cs#dependencyproperty)]
[!code-vb[UserControlNumericUpDown#DependencyProperty](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UserControlNumericUpDown/visualbasic/numericupdown.xaml.vb#dependencyproperty)]

<span data-ttu-id="c99b9-230">Pour plus d’informations, consultez [Propriétés de dépendance personnalisées](../advanced/custom-dependency-properties.md).</span><span class="sxs-lookup"><span data-stu-id="c99b9-230">For more information, see [Custom Dependency Properties](../advanced/custom-dependency-properties.md).</span></span>

### <a name="use-routed-events"></a><span data-ttu-id="c99b9-231">Utiliser des événements routés</span><span class="sxs-lookup"><span data-stu-id="c99b9-231">Use Routed Events</span></span>

<span data-ttu-id="c99b9-232">Tout comme les propriétés de dépendance étendent la notion de propriétés CLR avec des fonctionnalités supplémentaires, les événements routés étendent la notion d’événements CLR standard.</span><span class="sxs-lookup"><span data-stu-id="c99b9-232">Just as dependency properties extend the notion of CLR properties with additional functionality, routed events extend the notion of standard CLR events.</span></span> <span data-ttu-id="c99b9-233">Quand vous créez un contrôle [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], il est également conseillé d’implémenter votre événement en tant qu’événement routé, car un tel événement prend en charge le comportement suivant :</span><span class="sxs-lookup"><span data-stu-id="c99b9-233">When you create a new [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] control, it is also good practice to implement your event as a routed event because a routed event supports the following behavior:</span></span>

- <span data-ttu-id="c99b9-234">Vous pouvez gérer les événements sur le parent de plusieurs contrôles.</span><span class="sxs-lookup"><span data-stu-id="c99b9-234">Events can be handled on a parent of multiple controls.</span></span> <span data-ttu-id="c99b9-235">Si un événement est un événement de propagation, un parent unique de l’arborescence d’éléments peut s’abonner à l’événement.</span><span class="sxs-lookup"><span data-stu-id="c99b9-235">If an event is a bubbling event, a single parent in the element tree can subscribe to the event.</span></span> <span data-ttu-id="c99b9-236">Les auteurs d’applications peuvent ensuite utiliser un gestionnaire unique pour répondre à l’événement de plusieurs contrôles.</span><span class="sxs-lookup"><span data-stu-id="c99b9-236">Then application authors can use one handler to respond to the event of multiple controls.</span></span> <span data-ttu-id="c99b9-237">Par exemple, si votre contrôle fait partie de chaque élément dans un <xref:System.Windows.Controls.ListBox> (parce qu’il est inclus dans un <xref:System.Windows.DataTemplate> ), le développeur d’applications peut définir le gestionnaire d’événements pour l’événement de votre contrôle sur le <xref:System.Windows.Controls.ListBox> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-237">For example, if your control is a part of each item in a <xref:System.Windows.Controls.ListBox> (because it is included in a <xref:System.Windows.DataTemplate>), the application developer can define the event handler for your control's event on the <xref:System.Windows.Controls.ListBox>.</span></span> <span data-ttu-id="c99b9-238">Chaque fois que l’événement se produit sur un des contrôles, le gestionnaire d’événements est appelé.</span><span class="sxs-lookup"><span data-stu-id="c99b9-238">Whenever the event occurs on any of the controls, the event handler is called.</span></span>

- <span data-ttu-id="c99b9-239">Les événements routés peuvent être utilisés dans un <xref:System.Windows.EventSetter> , ce qui permet aux développeurs d’applications de spécifier le gestionnaire d’un événement dans un style.</span><span class="sxs-lookup"><span data-stu-id="c99b9-239">Routed events can be used in an <xref:System.Windows.EventSetter>, which enables application developers to specify the handler of an event within a style.</span></span>

- <span data-ttu-id="c99b9-240">Les événements routés peuvent être utilisés dans un <xref:System.Windows.EventTrigger> , ce qui est utile pour animer des propriétés à l’aide de [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="c99b9-240">Routed events can be used in an <xref:System.Windows.EventTrigger>, which is useful for animating properties by using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span> <span data-ttu-id="c99b9-241">Pour plus d’informations, consultez [vue d’ensemble](../graphics-multimedia/animation-overview.md)de l’animation.</span><span class="sxs-lookup"><span data-stu-id="c99b9-241">For more information, see [Animation Overview](../graphics-multimedia/animation-overview.md).</span></span>

<span data-ttu-id="c99b9-242">L’exemple suivant montre comment définir un événement routé :</span><span class="sxs-lookup"><span data-stu-id="c99b9-242">The following example defines a routed event by doing the following:</span></span>

- <span data-ttu-id="c99b9-243">Définissez un <xref:System.Windows.RoutedEvent> identificateur nommé `ValueChangedEvent` en tant que `public` `static` `readonly` champ.</span><span class="sxs-lookup"><span data-stu-id="c99b9-243">Define a <xref:System.Windows.RoutedEvent> identifier named `ValueChangedEvent` as a `public` `static` `readonly` field.</span></span>

- <span data-ttu-id="c99b9-244">Enregistrez l’événement routé en appelant la <xref:System.Windows.EventManager.RegisterRoutedEvent%2A?displayProperty=nameWithType> méthode.</span><span class="sxs-lookup"><span data-stu-id="c99b9-244">Register the routed event by calling the <xref:System.Windows.EventManager.RegisterRoutedEvent%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="c99b9-245">L’exemple spécifie les informations suivantes quand il appelle <xref:System.Windows.EventManager.RegisterRoutedEvent%2A> :</span><span class="sxs-lookup"><span data-stu-id="c99b9-245">The example specifies the following information when it calls <xref:System.Windows.EventManager.RegisterRoutedEvent%2A>:</span></span>

  - <span data-ttu-id="c99b9-246">Le nom de l’événement est `ValueChanged`.</span><span class="sxs-lookup"><span data-stu-id="c99b9-246">The name of the event is `ValueChanged`.</span></span>

  - <span data-ttu-id="c99b9-247">La stratégie de routage est, ce qui <xref:System.Windows.RoutingStrategy.Bubble> signifie qu’un gestionnaire d’événements sur la source (l’objet qui déclenche l’événement) est appelé en premier, puis que les gestionnaires d’événements sur les éléments parents de la source sont appelés successivement, en commençant par le gestionnaire d’événements sur l’élément parent le plus proche.</span><span class="sxs-lookup"><span data-stu-id="c99b9-247">The routing strategy is <xref:System.Windows.RoutingStrategy.Bubble>, which means that an event handler on the source (the object that raises the event) is called first, and then event handlers on the source's parent elements are called in succession, starting with the event handler on the closest parent element.</span></span>

  - <span data-ttu-id="c99b9-248">Le type du gestionnaire d’événements est <xref:System.Windows.RoutedPropertyChangedEventHandler%601> , construit avec un <xref:System.Decimal> type.</span><span class="sxs-lookup"><span data-stu-id="c99b9-248">The type of the event handler is <xref:System.Windows.RoutedPropertyChangedEventHandler%601>, constructed with a <xref:System.Decimal> type.</span></span>

  - <span data-ttu-id="c99b9-249">Le type propriétaire de l’événement est `NumericUpDown`.</span><span class="sxs-lookup"><span data-stu-id="c99b9-249">The owning type of the event is `NumericUpDown`.</span></span>

- <span data-ttu-id="c99b9-250">Déclarez un événement public nommé `ValueChanged` et incluez des déclarations d’accesseurs d’événement.</span><span class="sxs-lookup"><span data-stu-id="c99b9-250">Declare a public event named `ValueChanged` and includes event-accessor declarations.</span></span> <span data-ttu-id="c99b9-251">L’exemple appelle <xref:System.Windows.UIElement.AddHandler%2A> dans la `add` déclaration d’accesseur et <xref:System.Windows.UIElement.RemoveHandler%2A> dans la `remove` déclaration d’accesseur pour utiliser les [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] services d’événements.</span><span class="sxs-lookup"><span data-stu-id="c99b9-251">The example calls <xref:System.Windows.UIElement.AddHandler%2A> in the `add` accessor declaration and <xref:System.Windows.UIElement.RemoveHandler%2A> in the `remove` accessor declaration to use the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] event services.</span></span>

- <span data-ttu-id="c99b9-252">Créez une méthode virtuelle protégée nommée `OnValueChanged`, qui déclenche l’événement `ValueChanged`.</span><span class="sxs-lookup"><span data-stu-id="c99b9-252">Create a protected, virtual method named `OnValueChanged` that raises the `ValueChanged` event.</span></span>

[!code-csharp[UserControlNumericUpDown#RoutedEvent](~/samples/snippets/csharp/VS_Snippets_Wpf/UserControlNumericUpDown/CSharp/NumericUpDown.xaml.cs#routedevent)]
[!code-vb[UserControlNumericUpDown#RoutedEvent](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UserControlNumericUpDown/visualbasic/numericupdown.xaml.vb#routedevent)]

<span data-ttu-id="c99b9-253">Pour plus d’informations, consultez [Vue d’ensemble des événements routés](../advanced/routed-events-overview.md) et [Créer un événement routé personnalisé](../advanced/how-to-create-a-custom-routed-event.md).</span><span class="sxs-lookup"><span data-stu-id="c99b9-253">For more information, see [Routed Events Overview](../advanced/routed-events-overview.md) and [Create a Custom Routed Event](../advanced/how-to-create-a-custom-routed-event.md).</span></span>

### <a name="use-binding"></a><span data-ttu-id="c99b9-254">Utiliser la liaison</span><span class="sxs-lookup"><span data-stu-id="c99b9-254">Use Binding</span></span>

<span data-ttu-id="c99b9-255">Pour découpler l’interface utilisateur de votre contrôle de sa logique, songez à utiliser la liaison de données.</span><span class="sxs-lookup"><span data-stu-id="c99b9-255">To decouple the UI of your control from its logic, consider using data binding.</span></span> <span data-ttu-id="c99b9-256">Cela est particulièrement important si vous définissez l’apparence de votre contrôle à l’aide d’un <xref:System.Windows.Controls.ControlTemplate> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-256">This is particularly important if you define the appearance of your control by using a <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="c99b9-257">L’utilisation de la liaison de données permet d’éviter de référencer des parties spécifiques de l’interface utilisateur à partir du code.</span><span class="sxs-lookup"><span data-stu-id="c99b9-257">When you use data binding, you might be able to eliminate the need to reference specific parts of the UI from the code.</span></span> <span data-ttu-id="c99b9-258">Il est recommandé d’éviter de référencer des éléments qui se trouvent dans le, <xref:System.Windows.Controls.ControlTemplate> car lorsque le code fait référence à des éléments qui se trouvent dans <xref:System.Windows.Controls.ControlTemplate> et que le <xref:System.Windows.Controls.ControlTemplate> est modifié, l’élément référencé doit être inclus dans le nouveau <xref:System.Windows.Controls.ControlTemplate> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-258">It's a good idea to avoid referencing elements that are in the <xref:System.Windows.Controls.ControlTemplate> because when the code references elements that are in the <xref:System.Windows.Controls.ControlTemplate> and the <xref:System.Windows.Controls.ControlTemplate> is changed, the referenced element needs to be included in the new <xref:System.Windows.Controls.ControlTemplate>.</span></span>

<span data-ttu-id="c99b9-259">L’exemple suivant met à jour le <xref:System.Windows.Controls.TextBlock> du `NumericUpDown` contrôle, en lui assignant un nom et en référençant la zone de texte par son nom dans le code.</span><span class="sxs-lookup"><span data-stu-id="c99b9-259">The following example updates the <xref:System.Windows.Controls.TextBlock> of the `NumericUpDown` control, assigning a name to it and referencing the textbox by name in code.</span></span>

[!code-xaml[UserControlNumericUpDownSimple#UIRefMarkup](~/samples/snippets/csharp/VS_Snippets_Wpf/UserControlNumericUpDownSimple/CSharp/NumericUpDown.xaml#uirefmarkup)]

[!code-csharp[UserControlNumericUpDownSimple#UIRefCode](~/samples/snippets/csharp/VS_Snippets_Wpf/UserControlNumericUpDownSimple/CSharp/NumericUpDown.xaml.cs#uirefcode)]
[!code-vb[UserControlNumericUpDownSimple#UIRefCode](~/samples/snippets/visualbasic/VS_Snippets_Wpf/UserControlNumericUpDownSimple/VisualBasic/NumericUpDown.xaml.vb#uirefcode)]

<span data-ttu-id="c99b9-260">L’exemple suivant utilise la liaison pour accomplir la même chose.</span><span class="sxs-lookup"><span data-stu-id="c99b9-260">The following example uses binding to accomplish the same thing.</span></span>

[!code-xaml[UserControlNumericUpDown#Binding](~/samples/snippets/csharp/VS_Snippets_Wpf/UserControlNumericUpDown/CSharp/NumericUpDown.xaml#binding)]

<span data-ttu-id="c99b9-261">Pour plus d’informations sur la liaison de données, consultez [vue d’ensemble](../../../desktop-wpf/data/data-binding-overview.md)de la liaison de données.</span><span class="sxs-lookup"><span data-stu-id="c99b9-261">For more information about data binding, see [Data Binding Overview](../../../desktop-wpf/data/data-binding-overview.md).</span></span>

### <a name="design-for-designers"></a><span data-ttu-id="c99b9-262">Conception pour les concepteurs</span><span class="sxs-lookup"><span data-stu-id="c99b9-262">Design for Designers</span></span>

<span data-ttu-id="c99b9-263">Pour recevoir la prise en charge des contrôles WPF personnalisés dans le Concepteur WPF pour Visual Studio (par exemple, la modification de propriétés avec le Fenêtre Propriétés), suivez ces instructions.</span><span class="sxs-lookup"><span data-stu-id="c99b9-263">To receive support for custom WPF controls in the WPF Designer for Visual Studio (for example, property editing with the Properties window), follow these guidelines.</span></span>  <span data-ttu-id="c99b9-264">Pour plus d’informations sur le développement pour le Concepteur WPF, consultez [conception XAML dans Visual Studio](/visualstudio/xaml-tools/designing-xaml-in-visual-studio).</span><span class="sxs-lookup"><span data-stu-id="c99b9-264">For more information on developing for the WPF Designer, see [Design XAML in Visual Studio](/visualstudio/xaml-tools/designing-xaml-in-visual-studio).</span></span>

#### <a name="dependency-properties"></a><span data-ttu-id="c99b9-265">Propriétés de dépendance</span><span class="sxs-lookup"><span data-stu-id="c99b9-265">Dependency Properties</span></span>

<span data-ttu-id="c99b9-266">Veillez à implémenter le CLR `get` et les `set` accesseurs comme décrit précédemment dans la section « utiliser les propriétés de dépendance ».</span><span class="sxs-lookup"><span data-stu-id="c99b9-266">Be sure to implement CLR `get` and `set` accessors as described earlier, in "Use Dependency Properties."</span></span> <span data-ttu-id="c99b9-267">Les concepteurs peuvent utiliser le wrapper pour détecter la présence d’une propriété de dépendance, mais, à l’instar de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] et des clients du contrôle, ils ne sont pas tenus d’appeler les accesseurs durant l’obtention ou la définition de la propriété.</span><span class="sxs-lookup"><span data-stu-id="c99b9-267">Designers may use the wrapper to detect the presence of a dependency property, but they, like [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and clients of the control, are not required to call the accessors when getting or setting the property.</span></span>

#### <a name="attached-properties"></a><span data-ttu-id="c99b9-268">Propriétés attachées</span><span class="sxs-lookup"><span data-stu-id="c99b9-268">Attached Properties</span></span>

<span data-ttu-id="c99b9-269">Pour implémenter des propriétés jointes sur des contrôles personnalisés, tenez compte des indications suivantes :</span><span class="sxs-lookup"><span data-stu-id="c99b9-269">You should implement attached properties on custom controls using the following guidelines:</span></span>

- <span data-ttu-id="c99b9-270">Ont un `public` `static` `readonly` <xref:System.Windows.DependencyProperty> de la forme *PropertyName* créée `Property` à l’aide de la <xref:System.Windows.DependencyProperty.RegisterAttached%2A> méthode.</span><span class="sxs-lookup"><span data-stu-id="c99b9-270">Have a `public` `static` `readonly` <xref:System.Windows.DependencyProperty> of the form *PropertyName*`Property` that was creating using the <xref:System.Windows.DependencyProperty.RegisterAttached%2A> method.</span></span> <span data-ttu-id="c99b9-271">Le nom de la propriété qui est passé à <xref:System.Windows.DependencyProperty.RegisterAttached%2A> doit correspondre à *PropertyName*.</span><span class="sxs-lookup"><span data-stu-id="c99b9-271">The property name that is passed to <xref:System.Windows.DependencyProperty.RegisterAttached%2A> must match *PropertyName*.</span></span>

- <span data-ttu-id="c99b9-272">Implémentez une paire de méthodes CLR `public` `static` nommées `Set`*NomPropriété* et `Get`*NomPropriété*.</span><span class="sxs-lookup"><span data-stu-id="c99b9-272">Implement a pair of `public` `static` CLR methods named `Set`*PropertyName* and `Get`*PropertyName*.</span></span> <span data-ttu-id="c99b9-273">Les deux méthodes doivent accepter une classe dérivée de <xref:System.Windows.DependencyProperty> comme leur premier argument.</span><span class="sxs-lookup"><span data-stu-id="c99b9-273">Both methods should accept a class derived from <xref:System.Windows.DependencyProperty> as their first argument.</span></span> <span data-ttu-id="c99b9-274">La méthode `Set`*NomPropriété* accepte également un argument dont le type correspond au type de données inscrit pour la propriété.</span><span class="sxs-lookup"><span data-stu-id="c99b9-274">The `Set`*PropertyName* method also accepts an argument whose type matches the registered data type for the property.</span></span> <span data-ttu-id="c99b9-275">La méthode `Get`*NomPropriété* doit retourner une valeur du même type.</span><span class="sxs-lookup"><span data-stu-id="c99b9-275">The `Get`*PropertyName* method should return a value of the same type.</span></span> <span data-ttu-id="c99b9-276">Si la méthode `Set`*NomPropriété* est manquante, la propriété est marquée en lecture seule.</span><span class="sxs-lookup"><span data-stu-id="c99b9-276">If the `Set`*PropertyName* method is missing, the property is marked read-only.</span></span>

- <span data-ttu-id="c99b9-277">`Set`*PropertyName* et `Get` *PropertyName* doivent être routés directement vers les <xref:System.Windows.DependencyObject.GetValue%2A> <xref:System.Windows.DependencyObject.SetValue%2A> méthodes et sur l’objet de dépendance cible, respectivement.</span><span class="sxs-lookup"><span data-stu-id="c99b9-277">`Set` *PropertyName* and `Get`*PropertyName* must route directly to the <xref:System.Windows.DependencyObject.GetValue%2A> and <xref:System.Windows.DependencyObject.SetValue%2A> methods on the target dependency object, respectively.</span></span> <span data-ttu-id="c99b9-278">Les concepteurs peuvent accéder à la propriété jointe en l’appelant par le biais du wrapper de méthode ou en effectuant un appel direct à l’objet de dépendance cible.</span><span class="sxs-lookup"><span data-stu-id="c99b9-278">Designers may access the attached property by calling through the method wrapper or making a direct call to the target dependency object.</span></span>

<span data-ttu-id="c99b9-279">Pour plus d’informations sur les propriétés jointes, consultez [Vue d’ensemble des propriétés jointes](../advanced/attached-properties-overview.md).</span><span class="sxs-lookup"><span data-stu-id="c99b9-279">For more information on attached properties, see [Attached Properties Overview](../advanced/attached-properties-overview.md).</span></span>

### <a name="define-and-use-shared-resources"></a><span data-ttu-id="c99b9-280">Définir et utiliser des ressources partagées</span><span class="sxs-lookup"><span data-stu-id="c99b9-280">Define and Use Shared Resources</span></span>

<span data-ttu-id="c99b9-281">Vous pouvez inclure votre contrôle dans le même assembly que votre application, ou la mettre en package dans un assembly séparé qui peut être utilisé dans plusieurs applications.</span><span class="sxs-lookup"><span data-stu-id="c99b9-281">You can include your control in the same assembly as your application, or you can package your control in a separate assembly that can be used in multiple applications.</span></span> <span data-ttu-id="c99b9-282">Pour la plupart, les informations abordées dans cette rubrique sont valables, quelle que soit la méthode que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="c99b9-282">For the most part, the information discussed in this topic applies regardless of the method you use.</span></span>  <span data-ttu-id="c99b9-283">Toutefois, il existe une différence notable.</span><span class="sxs-lookup"><span data-stu-id="c99b9-283">There is one difference worth noting, however.</span></span>  <span data-ttu-id="c99b9-284">Quand vous placez un contrôle dans le même assembly qu’une application, vous êtes libre d’ajouter des ressources globales au fichier App.xaml.</span><span class="sxs-lookup"><span data-stu-id="c99b9-284">When you put a control in the same assembly as an application, you are free to add global resources to the App.xaml file.</span></span> <span data-ttu-id="c99b9-285">Mais un assembly qui contient uniquement des contrôles n’a pas d' <xref:System.Windows.Application> objet associé, un fichier app. XAML n’est donc pas disponible.</span><span class="sxs-lookup"><span data-stu-id="c99b9-285">But an assembly that contains only controls does not have an <xref:System.Windows.Application> object associated with it, so an App.xaml file is not available.</span></span>

<span data-ttu-id="c99b9-286">Quand une application recherche une ressource, elle examine trois niveaux dans l’ordre suivant :</span><span class="sxs-lookup"><span data-stu-id="c99b9-286">When an application looks for a resource, it looks at three levels in the following order:</span></span>

1. <span data-ttu-id="c99b9-287">Niveau de l’élément.</span><span class="sxs-lookup"><span data-stu-id="c99b9-287">The element level.</span></span>

   <span data-ttu-id="c99b9-288">Le système commence par l’élément qui référence la ressource, puis passe en revue les ressources du parent logique, et ainsi de suite, jusqu’à atteindre l’élément racine.</span><span class="sxs-lookup"><span data-stu-id="c99b9-288">The system starts with the element that references the resource and then searches resources of the logical parent and so forth until the root element is reached.</span></span>

2. <span data-ttu-id="c99b9-289">Niveau de l’application.</span><span class="sxs-lookup"><span data-stu-id="c99b9-289">The application level.</span></span>

   <span data-ttu-id="c99b9-290">Ressources définies par l' <xref:System.Windows.Application> objet.</span><span class="sxs-lookup"><span data-stu-id="c99b9-290">Resources defined by the <xref:System.Windows.Application> object.</span></span>

3. <span data-ttu-id="c99b9-291">Niveau du thème.</span><span class="sxs-lookup"><span data-stu-id="c99b9-291">The theme level.</span></span>

   <span data-ttu-id="c99b9-292">Les dictionnaires au niveau du thème sont enregistrés dans un sous-dossier nommé Themes.</span><span class="sxs-lookup"><span data-stu-id="c99b9-292">Theme-level dictionaries are stored in a subfolder named Themes.</span></span>  <span data-ttu-id="c99b9-293">Les fichiers contenus dans ce dossier correspondent aux thèmes.</span><span class="sxs-lookup"><span data-stu-id="c99b9-293">The files in the Themes folder correspond to themes.</span></span>  <span data-ttu-id="c99b9-294">Par exemple, vous pouvez avoir Aero.NormalColor.xaml, Luna.NormalColor.xaml, Royale.NormalColor.xaml, etc.</span><span class="sxs-lookup"><span data-stu-id="c99b9-294">For example, you might have Aero.NormalColor.xaml, Luna.NormalColor.xaml, Royale.NormalColor.xaml, and so on.</span></span>  <span data-ttu-id="c99b9-295">Vous pouvez également avoir un fichier nommé generic.xaml.</span><span class="sxs-lookup"><span data-stu-id="c99b9-295">You can also have a file named generic.xaml.</span></span>  <span data-ttu-id="c99b9-296">Quand le système recherche une ressource au niveau des thèmes, il la cherche en premier lieu dans le fichier spécifique au thème, puis dans generic.xaml.</span><span class="sxs-lookup"><span data-stu-id="c99b9-296">When the system looks for a resource at the themes level, it first looks for it in the theme-specific file and then looks for it in generic.xaml.</span></span>

<span data-ttu-id="c99b9-297">Si votre contrôle se trouve dans un assembly distinct de l’application, vous devez placer vos ressources globales au niveau de l’élément ou du thème.</span><span class="sxs-lookup"><span data-stu-id="c99b9-297">When your control is in an assembly that is separate from the application, you must put your global resources at the element level or at the theme level.</span></span> <span data-ttu-id="c99b9-298">Les deux méthodes ont leurs avantages.</span><span class="sxs-lookup"><span data-stu-id="c99b9-298">Both methods have their advantages.</span></span>

#### <a name="defining-resources-at-the-element-level"></a><span data-ttu-id="c99b9-299">Définition de ressources au niveau de l’élément</span><span class="sxs-lookup"><span data-stu-id="c99b9-299">Defining Resources at the Element Level</span></span>

<span data-ttu-id="c99b9-300">Vous pouvez définir des ressources partagées au niveau de l’élément en créant un dictionnaire de ressources personnalisé et en le fusionnant avec le dictionnaire de ressources de votre contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-300">You can define shared resources at the element level by creating a custom resource dictionary and merging it with your control's resource dictionary.</span></span>  <span data-ttu-id="c99b9-301">Quand vous utilisez cette méthode, vous pouvez donner à votre fichier de ressources le nom de votre choix, et il peut se trouver dans le même dossier que vos contrôles.</span><span class="sxs-lookup"><span data-stu-id="c99b9-301">When you use this method, you can name your resource file anything you want, and it can be in the same folder as your controls.</span></span> <span data-ttu-id="c99b9-302">Les ressources au niveau de l’élément peuvent également utiliser des chaînes simples comme clés.</span><span class="sxs-lookup"><span data-stu-id="c99b9-302">Resources at the element level can also use simple strings as keys.</span></span> <span data-ttu-id="c99b9-303">L’exemple suivant crée un <xref:System.Windows.Media.LinearGradientBrush> fichier de ressources nommé Dictionary1. Xaml.</span><span class="sxs-lookup"><span data-stu-id="c99b9-303">The following example creates a <xref:System.Windows.Media.LinearGradientBrush> resource file named Dictionary1.xaml.</span></span>

[!code-xaml[SharedResources#1](~/samples/snippets/csharp/VS_Snippets_Wpf/SharedResources/CS/Dictionary1.xaml#1)]

<span data-ttu-id="c99b9-304">Une fois que vous avez défini votre dictionnaire, vous devez le fusionner avec le dictionnaire de ressources de votre contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-304">Once you have defined your dictionary, you need to merge it with your control's resource dictionary.</span></span>  <span data-ttu-id="c99b9-305">Pour cela, utilisez [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] ou du code.</span><span class="sxs-lookup"><span data-stu-id="c99b9-305">You can do this by using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] or code.</span></span>

<span data-ttu-id="c99b9-306">L’exemple suivant fusionne un dictionnaire de ressources en [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c99b9-306">The following example merges a resource dictionary by using [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span>

[!code-xaml[SharedResources#2](~/samples/snippets/csharp/VS_Snippets_Wpf/SharedResources/CS/ShapeResizer.xaml#2)]

<span data-ttu-id="c99b9-307">L’inconvénient de cette approche est qu’un <xref:System.Windows.ResourceDictionary> objet est créé chaque fois que vous le référencez.</span><span class="sxs-lookup"><span data-stu-id="c99b9-307">The disadvantage to this approach is that a <xref:System.Windows.ResourceDictionary> object is created each time you reference it.</span></span>  <span data-ttu-id="c99b9-308">Par exemple, si vous avez 10 contrôles personnalisés dans votre bibliothèque et que vous fusionnez les dictionnaires de ressources partagées pour chaque contrôle à l’aide de XAML, vous créez 10 <xref:System.Windows.ResourceDictionary> objets identiques.</span><span class="sxs-lookup"><span data-stu-id="c99b9-308">For example, if you have 10 custom controls in your library and merge the shared resource dictionaries for each control by using XAML, you create 10 identical <xref:System.Windows.ResourceDictionary> objects.</span></span>  <span data-ttu-id="c99b9-309">Vous pouvez éviter cela en créant une classe statique qui fusionne les ressources dans le code et retourne le résultant <xref:System.Windows.ResourceDictionary> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-309">You can avoid this by creating a static class that merges the resources in code and returns the resulting <xref:System.Windows.ResourceDictionary>.</span></span>

<span data-ttu-id="c99b9-310">L’exemple suivant crée une classe qui retourne un partagé <xref:System.Windows.ResourceDictionary> .</span><span class="sxs-lookup"><span data-stu-id="c99b9-310">The following example creates a class that returns a shared <xref:System.Windows.ResourceDictionary>.</span></span>

[!code-csharp[SharedResources#3](~/samples/snippets/csharp/VS_Snippets_Wpf/SharedResources/CS/SharedDictionaryManager.cs#3)]

<span data-ttu-id="c99b9-311">L’exemple suivant fusionne la ressource partagée avec les ressources d’un contrôle personnalisé dans le constructeur du contrôle avant d’appeler `InitializeComponent`.</span><span class="sxs-lookup"><span data-stu-id="c99b9-311">The following example merges the shared resource with the resources of a custom control in the control's constructor before it calls `InitializeComponent`.</span></span>  <span data-ttu-id="c99b9-312">Étant donné que `SharedDictionaryManager.SharedDictionary` est une propriété statique, le <xref:System.Windows.ResourceDictionary> n’est créé qu’une seule fois.</span><span class="sxs-lookup"><span data-stu-id="c99b9-312">Because the `SharedDictionaryManager.SharedDictionary` is a static property, the <xref:System.Windows.ResourceDictionary> is created only once.</span></span> <span data-ttu-id="c99b9-313">Comme le dictionnaire de ressources a été fusionné avant l’appel de `InitializeComponent`, les ressources sont mises à la disposition du contrôle dans son fichier [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span><span class="sxs-lookup"><span data-stu-id="c99b9-313">Because the resource dictionary was merged before `InitializeComponent` was called, the resources are available to the control in its [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] file.</span></span>

[!code-csharp[SharedResources#4](~/samples/snippets/csharp/VS_Snippets_Wpf/SharedResources/CS/ShapeResizer.xaml.cs#4)]

#### <a name="defining-resources-at-the-theme-level"></a><span data-ttu-id="c99b9-314">Définition de ressources au niveau de l’élément</span><span class="sxs-lookup"><span data-stu-id="c99b9-314">Defining Resources at the Theme Level</span></span>

[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="c99b9-315">vous permet de créer des ressources pour différents thèmes Windows.</span><span class="sxs-lookup"><span data-stu-id="c99b9-315">enables you to create resources for different Windows themes.</span></span>  <span data-ttu-id="c99b9-316">En tant qu’auteur du contrôle, vous pouvez définir une ressource pour un thème spécifique pour changer l’apparence de votre contrôle selon le thème utilisé.</span><span class="sxs-lookup"><span data-stu-id="c99b9-316">As a control author, you can define a resource for a specific theme to change your control's appearance depending on what theme is in use.</span></span> <span data-ttu-id="c99b9-317">Par exemple, l’apparence d’un <xref:System.Windows.Controls.Button> dans le thème Windows classique (le thème par défaut pour windows 2000) est différente de celle du <xref:System.Windows.Controls.Button> thème Windows Luna (thème par défaut pour Windows XP), car <xref:System.Windows.Controls.Button> utilise un différent <xref:System.Windows.Controls.ControlTemplate> pour chaque thème.</span><span class="sxs-lookup"><span data-stu-id="c99b9-317">For example, the appearance of a <xref:System.Windows.Controls.Button> in the Windows Classic theme (the default theme for Windows 2000) differs from a <xref:System.Windows.Controls.Button> in the Windows Luna theme (the default theme for Windows XP) because the <xref:System.Windows.Controls.Button> uses a different <xref:System.Windows.Controls.ControlTemplate> for each theme.</span></span>

<span data-ttu-id="c99b9-318">Les ressources spécifiques à un thème sont conservées dans un dictionnaire de ressources avec un nom de fichier spécifique.</span><span class="sxs-lookup"><span data-stu-id="c99b9-318">Resources that are specific to a theme are kept in a resource dictionary with a specific file name.</span></span> <span data-ttu-id="c99b9-319">Ces fichiers doivent se trouver dans un dossier nommé `Themes`, qui est un sous-dossier du dossier qui contient le contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-319">These files must be in a folder named `Themes` that is a subfolder of the folder that contains the control.</span></span> <span data-ttu-id="c99b9-320">Le tableau suivant répertorie les fichiers des dictionnaires de ressources et le thème associé à chaque fichier :</span><span class="sxs-lookup"><span data-stu-id="c99b9-320">The following table lists the resource dictionary files and the theme that is associated with each file:</span></span>

|<span data-ttu-id="c99b9-321">Nom de fichier du dictionnaire de ressources</span><span class="sxs-lookup"><span data-stu-id="c99b9-321">Resource dictionary file name</span></span>|<span data-ttu-id="c99b9-322">Thème Windows</span><span class="sxs-lookup"><span data-stu-id="c99b9-322">Windows theme</span></span>|
|-----------------------------------|-------------------|
|`Classic.xaml`|<span data-ttu-id="c99b9-323">Aspect Windows 9x/2000 classique sur Windows XP</span><span class="sxs-lookup"><span data-stu-id="c99b9-323">Classic Windows 9x/2000 look on Windows XP</span></span>|
|`Luna.NormalColor.xaml`|<span data-ttu-id="c99b9-324">Thème bleu par défaut sur Windows XP</span><span class="sxs-lookup"><span data-stu-id="c99b9-324">Default blue theme on Windows XP</span></span>|
|`Luna.Homestead.xaml`|<span data-ttu-id="c99b9-325">Thème vert olive sur Windows XP</span><span class="sxs-lookup"><span data-stu-id="c99b9-325">Olive theme on Windows XP</span></span>|
|`Luna.Metallic.xaml`|<span data-ttu-id="c99b9-326">Thème argent sur Windows XP</span><span class="sxs-lookup"><span data-stu-id="c99b9-326">Silver theme on Windows XP</span></span>|
|`Royale.NormalColor.xaml`|<span data-ttu-id="c99b9-327">Thème par défaut sur Windows XP Édition Media Center</span><span class="sxs-lookup"><span data-stu-id="c99b9-327">Default theme on Windows XP Media Center Edition</span></span>|
|`Aero.NormalColor.xaml`|<span data-ttu-id="c99b9-328">Thème par défaut sur Windows Vista</span><span class="sxs-lookup"><span data-stu-id="c99b9-328">Default theme on Windows Vista</span></span>|

<span data-ttu-id="c99b9-329">Il n’est pas nécessaire de définir une ressource pour chaque thème.</span><span class="sxs-lookup"><span data-stu-id="c99b9-329">You do not need to define a resource for every theme.</span></span> <span data-ttu-id="c99b9-330">Si une ressource n’est pas définie pour un thème spécifique, le contrôle vérifie `Classic.xaml` pour la ressource.</span><span class="sxs-lookup"><span data-stu-id="c99b9-330">If a resource is not defined for a specific theme, then the control checks `Classic.xaml` for the resource.</span></span> <span data-ttu-id="c99b9-331">Si la ressource n’est pas définie dans le fichier correspondant au thème actif ou dans `Classic.xaml`, le contrôle utilise la ressource générique, qui se trouve dans un fichier de dictionnaire de ressources nommé `generic.xaml`.</span><span class="sxs-lookup"><span data-stu-id="c99b9-331">If the resource is not defined in the file that corresponds to the current theme or in `Classic.xaml`, the control uses the generic resource, which is in a resource dictionary file named `generic.xaml`.</span></span>  <span data-ttu-id="c99b9-332">Le fichier `generic.xaml` se trouve dans le même dossier que les fichiers de dictionnaire de ressources spécifiques au thème.</span><span class="sxs-lookup"><span data-stu-id="c99b9-332">The `generic.xaml` file is located in the same folder as the theme-specific resource dictionary files.</span></span> <span data-ttu-id="c99b9-333">Bien que `generic.xaml` ne corresponde pas à un thème spécifique de Windows, il s’agit néanmoins d’un dictionnaire au niveau du thème.</span><span class="sxs-lookup"><span data-stu-id="c99b9-333">Although `generic.xaml` does not correspond to a specific Windows theme, it is still a theme-level dictionary.</span></span>

<span data-ttu-id="c99b9-334">L’exemple de contrôle personnalisé NumericUpDown [C#](https://github.com/dotnet/docs/tree/master/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp) ou [Visual Basic](https://github.com/dotnet/docs/tree/master/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic) avec le thème et la prise en charge d’UI Automation contient deux dictionnaires de ressources pour le `NumericUpDown` contrôle : l’un est dans Generic. xaml et l’autre dans Luna. NormalColor. Xaml.</span><span class="sxs-lookup"><span data-stu-id="c99b9-334">The [C#](https://github.com/dotnet/docs/tree/master/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp) or [Visual Basic](https://github.com/dotnet/docs/tree/master/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic) NumericUpDown custom control with theme and UI automation support sample contains two resource dictionaries for the `NumericUpDown` control: one is in generic.xaml, and the other is in Luna.NormalColor.xaml.</span></span>

<span data-ttu-id="c99b9-335">Quand vous placez un <xref:System.Windows.Controls.ControlTemplate> dans un fichier de dictionnaire de ressources spécifique au thème, vous devez créer un constructeur statique pour votre contrôle et appeler la <xref:System.Windows.DependencyProperty.OverrideMetadata%28System.Type%2CSystem.Windows.PropertyMetadata%29> méthode sur <xref:System.Windows.FrameworkElement.DefaultStyleKey%2A> , comme illustré dans l’exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="c99b9-335">When you put a <xref:System.Windows.Controls.ControlTemplate> in any of the theme-specific resource dictionary files, you must create a static constructor for your control and call the <xref:System.Windows.DependencyProperty.OverrideMetadata%28System.Type%2CSystem.Windows.PropertyMetadata%29> method on the <xref:System.Windows.FrameworkElement.DefaultStyleKey%2A>, as shown in the following example.</span></span>

[!code-csharp[CustomControlNumericUpDownOneProject#StaticConstructor](~/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDownOneProject/CSharp/NumericUpDown.cs#staticconstructor)]
[!code-vb[CustomControlNumericUpDownOneProject#StaticConstructor](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDownOneProject/visualbasic/numericupdown.vb#staticconstructor)]

##### <a name="defining-and-referencing-keys-for-theme-resources"></a><span data-ttu-id="c99b9-336">Définition et référencement de clés pour les ressources de thème</span><span class="sxs-lookup"><span data-stu-id="c99b9-336">Defining and Referencing Keys for Theme Resources</span></span>

<span data-ttu-id="c99b9-337">Quand vous définissez une ressource au niveau de l’élément, vous pouvez assigner une chaîne comme clé et accéder à la ressource par le biais de la chaîne.</span><span class="sxs-lookup"><span data-stu-id="c99b9-337">When you define a resource at the element level, you can assign a string as its key and access the resource via the string.</span></span> <span data-ttu-id="c99b9-338">Lorsque vous définissez une ressource au niveau du thème, vous devez utiliser <xref:System.Windows.ComponentResourceKey> comme clé.</span><span class="sxs-lookup"><span data-stu-id="c99b9-338">When you define a resource at the theme level, you must use a <xref:System.Windows.ComponentResourceKey> as the key.</span></span>  <span data-ttu-id="c99b9-339">L’exemple suivant définit une ressource dans generic.xaml.</span><span class="sxs-lookup"><span data-stu-id="c99b9-339">The following example defines a resource in generic.xaml.</span></span>

[!code-xaml[ThemeResourcesControlLibrary#5](~/samples/snippets/csharp/VS_Snippets_Wpf/ThemeResourcesControlLibrary/CS/Themes/generic.xaml#5)]

<span data-ttu-id="c99b9-340">L’exemple suivant référence la ressource en spécifiant le <xref:System.Windows.ComponentResourceKey> comme clé.</span><span class="sxs-lookup"><span data-stu-id="c99b9-340">The following example references the resource by specifying the <xref:System.Windows.ComponentResourceKey> as the key.</span></span>

[!code-xaml[ThemeResourcesControlLibrary#6](~/samples/snippets/csharp/VS_Snippets_Wpf/ThemeResourcesControlLibrary/CS/NumericUpDown.xaml#6)]

##### <a name="specifying-the-location-of-theme-resources"></a><span data-ttu-id="c99b9-341">Spécification de l’emplacement des ressources des thèmes</span><span class="sxs-lookup"><span data-stu-id="c99b9-341">Specifying the Location of Theme Resources</span></span>

<span data-ttu-id="c99b9-342">Pour rechercher les ressources relatives à un contrôle, l’application d’hébergement doit savoir quel l’assembly contient des ressources spécifiques au contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-342">To find the resources for a control, the hosting application needs to know that the assembly contains control-specific resources.</span></span> <span data-ttu-id="c99b9-343">Pour ce faire, vous pouvez ajouter <xref:System.Windows.ThemeInfoAttribute> à l’assembly qui contient le contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-343">You can accomplish that by adding the <xref:System.Windows.ThemeInfoAttribute> to the assembly that contains the control.</span></span> <span data-ttu-id="c99b9-344"><xref:System.Windows.ThemeInfoAttribute>A une <xref:System.Windows.ThemeInfoAttribute.GenericDictionaryLocation%2A> propriété qui spécifie l’emplacement des ressources génériques et une <xref:System.Windows.ThemeInfoAttribute.ThemeDictionaryLocation%2A> propriété qui spécifie l’emplacement des ressources spécifiques au thème.</span><span class="sxs-lookup"><span data-stu-id="c99b9-344">The <xref:System.Windows.ThemeInfoAttribute> has a <xref:System.Windows.ThemeInfoAttribute.GenericDictionaryLocation%2A> property that specifies the location of generic resources, and a <xref:System.Windows.ThemeInfoAttribute.ThemeDictionaryLocation%2A> property that specifies the location of the theme-specific resources.</span></span>

<span data-ttu-id="c99b9-345">L’exemple suivant affecte aux <xref:System.Windows.ThemeInfoAttribute.GenericDictionaryLocation%2A> Propriétés et la <xref:System.Windows.ThemeInfoAttribute.ThemeDictionaryLocation%2A> valeur <xref:System.Windows.ResourceDictionaryLocation.SourceAssembly> pour spécifier que les ressources génériques et spécifiques au thème se trouvent dans le même assembly que le contrôle.</span><span class="sxs-lookup"><span data-stu-id="c99b9-345">The following example sets the <xref:System.Windows.ThemeInfoAttribute.GenericDictionaryLocation%2A> and <xref:System.Windows.ThemeInfoAttribute.ThemeDictionaryLocation%2A> properties to <xref:System.Windows.ResourceDictionaryLocation.SourceAssembly>, to specify that the generic and theme-specific resources are in the same assembly as the control.</span></span>

[!code-csharp[CustomControlNumericUpDown#ThemesSection](~/samples/snippets/csharp/VS_Snippets_Wpf/CustomControlNumericUpDown/CSharp/CustomControlLibrary/Properties/AssemblyInfo.cs#themessection)]
[!code-vb[CustomControlNumericUpDown#ThemesSection](~/samples/snippets/visualbasic/VS_Snippets_Wpf/CustomControlNumericUpDown/visualbasic/customcontrollibrary/my project/assemblyinfo.vb#themessection)]

## <a name="see-also"></a><span data-ttu-id="c99b9-346">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="c99b9-346">See also</span></span>

- [<span data-ttu-id="c99b9-347">Concevoir en XAML dans Visual Studio</span><span class="sxs-lookup"><span data-stu-id="c99b9-347">Design XAML in Visual Studio</span></span>](/visualstudio/xaml-tools/designing-xaml-in-visual-studio)
- [<span data-ttu-id="c99b9-348">URI à en-tête pack dans WPF</span><span class="sxs-lookup"><span data-stu-id="c99b9-348">Pack URIs in WPF</span></span>](../app-development/pack-uris-in-wpf.md)
- [<span data-ttu-id="c99b9-349">Personnalisation des contrôles</span><span class="sxs-lookup"><span data-stu-id="c99b9-349">Control Customization</span></span>](control-customization.md)

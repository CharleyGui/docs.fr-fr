---
title: Utilisation d'objets DrawingVisual
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- visual layer [WPF], DrawingVisual objects
- DrawingVisual objects in visual layer [WPF]
ms.assetid: 0b4e711d-e640-40cb-81c3-8f5c59909b7d
ms.openlocfilehash: 9d67fbc0d9716c9df3935232c6c7e579b50d55bb
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/12/2020
ms.locfileid: "79148320"
---
# <a name="using-drawingvisual-objects"></a><span data-ttu-id="74529-102">Utilisation d'objets DrawingVisual</span><span class="sxs-lookup"><span data-stu-id="74529-102">Using DrawingVisual Objects</span></span>
<span data-ttu-id="74529-103">Ce sujet donne un aperçu <xref:System.Windows.Media.DrawingVisual> de [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] la façon d’utiliser des objets dans la couche visuelle.</span><span class="sxs-lookup"><span data-stu-id="74529-103">This topic provides an overview of how to use <xref:System.Windows.Media.DrawingVisual> objects in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] visual layer.</span></span>  
  
<a name="drawingvisual_object"></a>
## <a name="drawingvisual-object"></a><span data-ttu-id="74529-104">Objet DrawingVisual</span><span class="sxs-lookup"><span data-stu-id="74529-104">DrawingVisual Object</span></span>  
 <span data-ttu-id="74529-105">Il <xref:System.Windows.Media.DrawingVisual> s’agit d’une classe de dessin léger qui est utilisée pour rendre des formes, des images ou du texte.</span><span class="sxs-lookup"><span data-stu-id="74529-105">The <xref:System.Windows.Media.DrawingVisual> is a lightweight drawing class that is used to render shapes, images, or text.</span></span> <span data-ttu-id="74529-106">Cette classe est dite légère, car elle n’assure pas la gestion des dispositions ni des événements, ce qui améliore ses performances.</span><span class="sxs-lookup"><span data-stu-id="74529-106">This class is considered lightweight because it does not provide layout or event handling, which improves its performance.</span></span> <span data-ttu-id="74529-107">C’est pourquoi, les dessins de ce type sont idéaux pour les arrière-plans et les images clipart.</span><span class="sxs-lookup"><span data-stu-id="74529-107">For this reason, drawings are ideal for backgrounds and clip art.</span></span>  
  
<a name="drawingvisual_host_container"></a>
## <a name="drawingvisual-host-container"></a><span data-ttu-id="74529-108">Conteneur hôte DrawingVisual</span><span class="sxs-lookup"><span data-stu-id="74529-108">DrawingVisual Host Container</span></span>  
 <span data-ttu-id="74529-109">Afin d’utiliser des <xref:System.Windows.Media.DrawingVisual> objets, vous devez créer un conteneur d’hôte pour les objets.</span><span class="sxs-lookup"><span data-stu-id="74529-109">In order to use <xref:System.Windows.Media.DrawingVisual> objects, you need to create a host container for the objects.</span></span> <span data-ttu-id="74529-110">L’objet de conteneur <xref:System.Windows.FrameworkElement> hôte doit dériver de la classe, qui fournit le support de mise en page et de gestion d’événements qui manque à la <xref:System.Windows.Media.DrawingVisual> classe.</span><span class="sxs-lookup"><span data-stu-id="74529-110">The host container object must derive from the <xref:System.Windows.FrameworkElement> class, which provides the layout and event handling support that the <xref:System.Windows.Media.DrawingVisual> class lacks.</span></span> <span data-ttu-id="74529-111">L’objet de type conteneur hôte n’affiche pas de propriétés visibles, dans la mesure où son but principal est de contenir des objets enfants.</span><span class="sxs-lookup"><span data-stu-id="74529-111">The host container object does not display any visible properties, since its main purpose is to contain child objects.</span></span> <span data-ttu-id="74529-112">Toutefois, <xref:System.Windows.UIElement.Visibility%2A> la propriété du conteneur hôte <xref:System.Windows.Visibility.Visible>doit être réglée à ; autrement, aucun de ses éléments enfant ne sera visible.</span><span class="sxs-lookup"><span data-stu-id="74529-112">However, the <xref:System.Windows.UIElement.Visibility%2A> property of the host container must be set to <xref:System.Windows.Visibility.Visible>; otherwise, none of its child elements will be visible.</span></span>  
  
 <span data-ttu-id="74529-113">Lorsque vous créez un objet de conteneur d’hôte pour les <xref:System.Windows.Media.VisualCollection>objets visuels, vous devez stocker les références d’objets visuels dans un .</span><span class="sxs-lookup"><span data-stu-id="74529-113">When you create a host container object for visual objects, you need to store the visual object references in a <xref:System.Windows.Media.VisualCollection>.</span></span> <span data-ttu-id="74529-114">Utilisez <xref:System.Windows.Media.VisualCollection.Add%2A> la méthode pour ajouter un objet visuel au conteneur hôte.</span><span class="sxs-lookup"><span data-stu-id="74529-114">Use the <xref:System.Windows.Media.VisualCollection.Add%2A> method to add a visual object to the host container.</span></span> <span data-ttu-id="74529-115">Dans l’exemple suivant, un objet de conteneur d’hôte <xref:System.Windows.Media.VisualCollection>est créé, et trois objets visuels sont ajoutés à son .</span><span class="sxs-lookup"><span data-stu-id="74529-115">In the following example, a host container object is created, and three visual objects are added to its <xref:System.Windows.Media.VisualCollection>.</span></span>  
  
 [!code-csharp[DrawingVisualSample#100](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#100)]
 [!code-vb[DrawingVisualSample#100](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#100)]  
  
> [!NOTE]
> <span data-ttu-id="74529-116">Pour consulter l’intégralité de l’exemple de code duquel l’exemple de code précédent a été extrait, référez-vous à la section [Hit Test Using DrawingVisuals Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Visual%20Layer/DrawingVisual) (Test de positionnement à l’aide d’exemples de DrawingVisuals).</span><span class="sxs-lookup"><span data-stu-id="74529-116">For the complete code sample from which the preceding code example was extracted, see [Hit Test Using DrawingVisuals Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Visual%20Layer/DrawingVisual).</span></span>  
  
<a name="creating_drawingvisual_objects"></a>
## <a name="creating-drawingvisual-objects"></a><span data-ttu-id="74529-117">Création d'objets DrawingVisual</span><span class="sxs-lookup"><span data-stu-id="74529-117">Creating DrawingVisual Objects</span></span>  
 <span data-ttu-id="74529-118">Lorsque vous <xref:System.Windows.Media.DrawingVisual> créez un objet, il n’a pas de contenu de dessin.</span><span class="sxs-lookup"><span data-stu-id="74529-118">When you create a <xref:System.Windows.Media.DrawingVisual> object, it has no drawing content.</span></span> <span data-ttu-id="74529-119">Vous pouvez ajouter du texte, des graphiques ou du <xref:System.Windows.Media.DrawingContext> contenu d’image en récupérant l’objet et en y attirant.</span><span class="sxs-lookup"><span data-stu-id="74529-119">You can add text, graphics, or image content by retrieving the object's <xref:System.Windows.Media.DrawingContext> and drawing into it.</span></span> <span data-ttu-id="74529-120">A <xref:System.Windows.Media.DrawingContext> est retourné <xref:System.Windows.Media.DrawingVisual.RenderOpen%2A> en appelant <xref:System.Windows.Media.DrawingVisual> la méthode d’un objet.</span><span class="sxs-lookup"><span data-stu-id="74529-120">A <xref:System.Windows.Media.DrawingContext> is returned by calling the <xref:System.Windows.Media.DrawingVisual.RenderOpen%2A> method of a <xref:System.Windows.Media.DrawingVisual> object.</span></span>  
  
 <span data-ttu-id="74529-121">Pour dessiner un <xref:System.Windows.Media.DrawingContext>rectangle dans <xref:System.Windows.Media.DrawingContext.DrawRectangle%2A> le <xref:System.Windows.Media.DrawingContext> , utilisez la méthode de l’objet.</span><span class="sxs-lookup"><span data-stu-id="74529-121">To draw a rectangle into the <xref:System.Windows.Media.DrawingContext>, use the <xref:System.Windows.Media.DrawingContext.DrawRectangle%2A> method of the <xref:System.Windows.Media.DrawingContext> object.</span></span> <span data-ttu-id="74529-122">Il existe des méthodes similaires pour dessiner d’autres types de contenu.</span><span class="sxs-lookup"><span data-stu-id="74529-122">Similar methods exist for drawing other types of content.</span></span> <span data-ttu-id="74529-123">Lorsque vous avez fini <xref:System.Windows.Media.DrawingContext>de dessiner <xref:System.Windows.Media.DrawingContext.Close%2A> du contenu <xref:System.Windows.Media.DrawingContext> dans le , appelez la méthode pour fermer le et de persister le contenu.</span><span class="sxs-lookup"><span data-stu-id="74529-123">When you are finished drawing content into the <xref:System.Windows.Media.DrawingContext>, call the <xref:System.Windows.Media.DrawingContext.Close%2A> method to close the <xref:System.Windows.Media.DrawingContext> and persist the content.</span></span>  
  
 <span data-ttu-id="74529-124">Dans l’exemple <xref:System.Windows.Media.DrawingVisual> suivant, un objet est créé, <xref:System.Windows.Media.DrawingContext>et un rectangle est entraîné dans son .</span><span class="sxs-lookup"><span data-stu-id="74529-124">In the following example, a <xref:System.Windows.Media.DrawingVisual> object is created, and a rectangle is drawn into its <xref:System.Windows.Media.DrawingContext>.</span></span>  
  
 [!code-csharp[DrawingVisualSample#101](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#101)]
 [!code-vb[DrawingVisualSample#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#101)]  
  
<a name="creating_overrides"></a>
## <a name="creating-overrides-for-frameworkelement-members"></a><span data-ttu-id="74529-125">Création de remplacements pour les membres FrameworkElement</span><span class="sxs-lookup"><span data-stu-id="74529-125">Creating Overrides for FrameworkElement Members</span></span>  
 <span data-ttu-id="74529-126">L’objet de type conteneur hôte est chargé de gérer sa collection d’objets visuels.</span><span class="sxs-lookup"><span data-stu-id="74529-126">The host container object is responsible for managing its collection of visual objects.</span></span> <span data-ttu-id="74529-127">Cela exige que le membre de mise <xref:System.Windows.FrameworkElement> en œuvre du conteneur hôte remplace la classe dérivée.</span><span class="sxs-lookup"><span data-stu-id="74529-127">This requires that the host container implement member overrides for the derived <xref:System.Windows.FrameworkElement> class.</span></span>  
  
 <span data-ttu-id="74529-128">La liste suivante décrit les deux membres que vous devez substituer :</span><span class="sxs-lookup"><span data-stu-id="74529-128">The following list describes the two members you must override:</span></span>  
  
- <span data-ttu-id="74529-129"><xref:System.Windows.FrameworkElement.GetVisualChild%2A>: Renvoie un enfant à l’index spécifié de la collection d’éléments pour enfants.</span><span class="sxs-lookup"><span data-stu-id="74529-129"><xref:System.Windows.FrameworkElement.GetVisualChild%2A>: Returns a child at the specified index from the collection of child elements.</span></span>  
  
- <span data-ttu-id="74529-130"><xref:System.Windows.FrameworkElement.VisualChildrenCount%2A>: Obtient le nombre d’éléments visuels de l’enfant dans cet élément.</span><span class="sxs-lookup"><span data-stu-id="74529-130"><xref:System.Windows.FrameworkElement.VisualChildrenCount%2A>: Gets the number of visual child elements within this element.</span></span>  
  
 <span data-ttu-id="74529-131">Dans l’exemple suivant, des <xref:System.Windows.FrameworkElement> dérogations pour les deux membres sont mises en œuvre.</span><span class="sxs-lookup"><span data-stu-id="74529-131">In the following example, overrides for the two <xref:System.Windows.FrameworkElement> members are implemented.</span></span>  
  
 [!code-csharp[DrawingVisualSample#102](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#102)]
 [!code-vb[DrawingVisualSample#102](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#102)]  
  
<a name="providing_hit_testing_support"></a>
## <a name="providing-hit-testing-support"></a><span data-ttu-id="74529-132">Prise en charge du test de positionnement</span><span class="sxs-lookup"><span data-stu-id="74529-132">Providing Hit Testing Support</span></span>  
 <span data-ttu-id="74529-133">L’objet de conteneur hôte peut fournir la manipulation d’événement <xref:System.Windows.UIElement.Visibility%2A> même s’il n’affiche aucune propriété visible, cependant, sa propriété doit être réglée à <xref:System.Windows.Visibility.Visible>.</span><span class="sxs-lookup"><span data-stu-id="74529-133">The host container object can provide event handling even if it does not display any visible properties—however, its <xref:System.Windows.UIElement.Visibility%2A> property must be set to <xref:System.Windows.Visibility.Visible>.</span></span> <span data-ttu-id="74529-134">Cela vous permet de créer une routine de gestion des événements pour le conteneur hôte, capable de détecter les événements de la souris, tels que le relâchement du bouton gauche de la souris.</span><span class="sxs-lookup"><span data-stu-id="74529-134">This allows you to create an event handling routine for the host container that can trap mouse events, such as the release of the left mouse button.</span></span> <span data-ttu-id="74529-135">La routine de gestion de l’événement <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> peut ensuite mettre en œuvre des tests de frappe en invoquant la méthode.</span><span class="sxs-lookup"><span data-stu-id="74529-135">The event handling routine can then implement hit testing by invoking the <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A> method.</span></span> <span data-ttu-id="74529-136">Le paramètre <xref:System.Windows.Media.HitTestResultCallback> de la méthode fait référence à une procédure définie par l’utilisateur que vous pouvez utiliser pour déterminer l’action résultante d’un test à succès.</span><span class="sxs-lookup"><span data-stu-id="74529-136">The method's <xref:System.Windows.Media.HitTestResultCallback> parameter refers to a user-defined procedure that you can use to determine the resulting action of a hit test.</span></span>  
  
 <span data-ttu-id="74529-137">Dans l’exemple suivant, la prise en charge du test de positionnement est implémentée pour l’objet de type conteneur hôte et ses enfants.</span><span class="sxs-lookup"><span data-stu-id="74529-137">In the following example, hit testing support is implemented for the host container object and its children.</span></span>  
  
 [!code-csharp[DrawingVisualSample#103](~/samples/snippets/csharp/VS_Snippets_Wpf/DrawingVisualSample/CSharp/Window1.xaml.cs#103)]
 [!code-vb[DrawingVisualSample#103](~/samples/snippets/visualbasic/VS_Snippets_Wpf/DrawingVisualSample/visualbasic/window1.xaml.vb#103)]  
  
## <a name="see-also"></a><span data-ttu-id="74529-138">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="74529-138">See also</span></span>

- <xref:System.Windows.Media.DrawingVisual>
- <xref:System.Windows.Media.VisualTreeHelper.HitTest%2A>
- [<span data-ttu-id="74529-139">Vue d’ensemble du rendu graphique de WPF</span><span class="sxs-lookup"><span data-stu-id="74529-139">WPF Graphics Rendering Overview</span></span>](wpf-graphics-rendering-overview.md)
- [<span data-ttu-id="74529-140">Test de positionnement dans la couche visuelle</span><span class="sxs-lookup"><span data-stu-id="74529-140">Hit Testing in the Visual Layer</span></span>](hit-testing-in-the-visual-layer.md)

---
title: Vue d'ensemble des animations personnalisées
ms.date: 03/30/2017
helpviewer_keywords:
- custom classes [WPF], animation
- key frames [WPF], custom
- custom key frames [WPF]
- animation [WPF], custom classes
- custom animation classes [WPF]
ms.assetid: 9be69d50-3384-4938-886f-08ce00e4a7a6
ms.openlocfilehash: 5a9ca51b87f73a24b90d0bd843ee306f8a1b970a
ms.sourcegitcommit: 700ea803fb06c5ce98de017c7f76463ba33ff4a9
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/19/2020
ms.locfileid: "77453089"
---
# <a name="custom-animations-overview"></a><span data-ttu-id="2d4ea-102">Vue d'ensemble des animations personnalisées</span><span class="sxs-lookup"><span data-stu-id="2d4ea-102">Custom Animations Overview</span></span>
<span data-ttu-id="2d4ea-103">Cette rubrique décrit comment et quand étendre le système d’animation [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] en créant des images clés personnalisées et des classes d’animation, ou à l’aide du rappel image par image pour l’ignorer.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-103">This topic describes how and when to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system by creating custom key frames, animation classes, or by using per-frame callback to bypass it.</span></span>  
  
<a name="prerequisites"></a>   
## <a name="prerequisites"></a><span data-ttu-id="2d4ea-104">Conditions préalables requises</span><span class="sxs-lookup"><span data-stu-id="2d4ea-104">Prerequisites</span></span>  
 <span data-ttu-id="2d4ea-105">Pour comprendre cette rubrique, vous devez connaître les différents types d’animations offerts par [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2d4ea-105">To understand this topic, you should be familiar with the different types of animations provided by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span> <span data-ttu-id="2d4ea-106">Pour plus d’informations, consultez la Vue d’ensemble des animations From/To/By, la [Vue d'ensemble des animations d'image clé](key-frame-animations-overview.md) et la [Vue d'ensemble des animations de tracés](path-animations-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2d4ea-106">For more information, see the From/To/By Animations Overview, the [Key-Frame Animations Overview](key-frame-animations-overview.md), and the [Path Animations Overview](path-animations-overview.md).</span></span>  
  
 <span data-ttu-id="2d4ea-107">Étant donné que les classes d’animation héritent de la classe <xref:System.Windows.Freezable>, vous devez être familiarisé avec les objets <xref:System.Windows.Freezable> et savoir comment hériter de <xref:System.Windows.Freezable>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-107">Because the animation classes inherit from the <xref:System.Windows.Freezable> class, you should be familiar with <xref:System.Windows.Freezable> objects and how to inherit from <xref:System.Windows.Freezable>.</span></span> <span data-ttu-id="2d4ea-108">Pour plus d’informations, consultez la [Vue d’ensemble des objets Freezable](../advanced/freezable-objects-overview.md).</span><span class="sxs-lookup"><span data-stu-id="2d4ea-108">For more information, see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md).</span></span>  
  
<a name="extendingtheanimationsystem"></a>   
## <a name="extending-the-animation-system"></a><span data-ttu-id="2d4ea-109">Extension du système d’animation</span><span class="sxs-lookup"><span data-stu-id="2d4ea-109">Extending the Animation System</span></span>  
 <span data-ttu-id="2d4ea-110">Il existe plusieurs façons d’étendre le système d’animation [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], en fonction du niveau de fonctionnalités intégrées que vous souhaitez utiliser.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-110">There are a number of ways to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system, depending on the level of built-in functionality you want to use.</span></span>  <span data-ttu-id="2d4ea-111">Il existe trois points d’extensibilité principaux dans le moteur d’animation [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="2d4ea-111">There are three primary extensibility points in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine:</span></span>  
  
- <span data-ttu-id="2d4ea-112">Créez un objet d’image clé personnalisé en héritant de l’un des *types de\<>* les classes d’images clés, telles que <xref:System.Windows.Media.Animation.DoubleKeyFrame>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-112">Create a custom key frame object by inheriting from one of the *\<Type>* KeyFrame classes, such as <xref:System.Windows.Media.Animation.DoubleKeyFrame>.</span></span> <span data-ttu-id="2d4ea-113">Cette approche utilise la plupart des fonctionnalités intégrées dans le moteur d’animation [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2d4ea-113">This approach uses most of the built-in functionality of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine.</span></span>  
  
- <span data-ttu-id="2d4ea-114">Créez votre propre classe d’animation en héritant de <xref:System.Windows.Media.Animation.AnimationTimeline> ou de l’une des classes *\<>* AnimationBase.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-114">Create your own animation class by inheriting from <xref:System.Windows.Media.Animation.AnimationTimeline> or one of the *\<Type>* AnimationBase classes.</span></span>  
  
- <span data-ttu-id="2d4ea-115">Utilisez le rappel image par image pour générer des animations image par image.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-115">Use per-frame callback to generate animations on a per-frame basis.</span></span> <span data-ttu-id="2d4ea-116">Cette approche ignore entièrement l’animation et le système de minutage.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-116">This approach completely bypasses the animation and timing system.</span></span>  
  
 <span data-ttu-id="2d4ea-117">Le tableau suivant décrit certains scénarios permettant d’étendre le système d’animation.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-117">The following table describes some the scenarios for extending the animation system.</span></span>  
  
|<span data-ttu-id="2d4ea-118">Si vous souhaitez...</span><span class="sxs-lookup"><span data-stu-id="2d4ea-118">When you want to...</span></span>|<span data-ttu-id="2d4ea-119">Utiliser cette approche</span><span class="sxs-lookup"><span data-stu-id="2d4ea-119">Use this approach</span></span>|  
|-------------------------|-----------------------|  
|<span data-ttu-id="2d4ea-120">Personnalisez l’interpolation entre les valeurs d’un type qui possède un *\<Type >* AnimationUsingKeyFrames correspondant</span><span class="sxs-lookup"><span data-stu-id="2d4ea-120">Customize the interpolation between values of a type that has a corresponding *\<Type>* AnimationUsingKeyFrames</span></span>|<span data-ttu-id="2d4ea-121">Créez une image clé personnalisée.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-121">Create a custom key frame.</span></span> <span data-ttu-id="2d4ea-122">Pour plus d’informations, consultez la section [Création d’une image clé personnalisée](#createacustomkeyframe).</span><span class="sxs-lookup"><span data-stu-id="2d4ea-122">For more information, see the [Create a Custom Key Frame](#createacustomkeyframe) section.</span></span>|  
|<span data-ttu-id="2d4ea-123">Personnalisez plus que l’interpolation entre les valeurs d’un type qui possède un *\<Type >* Animation correspondant.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-123">Customize more than just the interpolation between values of a type that has a corresponding *\<Type>* Animation.</span></span>|<span data-ttu-id="2d4ea-124">Créez une classe d’animation personnalisée qui hérite de la classe *\<Type >* AnimationBase qui correspond au type que vous souhaitez animer.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-124">Create a custom animation class that inherits from the *\<Type>* AnimationBase class that corresponds to the type you want to animate.</span></span> <span data-ttu-id="2d4ea-125">Pour plus d’informations, consultez la section [Création d’une classe d’animation personnalisée](#createacustomanimationtype).</span><span class="sxs-lookup"><span data-stu-id="2d4ea-125">For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.</span></span>|  
|<span data-ttu-id="2d4ea-126">Animation d’un type qui ne possède aucune animation [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] correspondante</span><span class="sxs-lookup"><span data-stu-id="2d4ea-126">Animate a type that has no corresponding [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation</span></span>|<span data-ttu-id="2d4ea-127">Utilisez un <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> ou créez une classe qui hérite de <xref:System.Windows.Media.Animation.AnimationTimeline>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-127">Use an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> or create a class that inherits from <xref:System.Windows.Media.Animation.AnimationTimeline>.</span></span> <span data-ttu-id="2d4ea-128">Pour plus d’informations, consultez la section [Création d’une classe d’animation personnalisée](#createacustomanimationtype).</span><span class="sxs-lookup"><span data-stu-id="2d4ea-128">For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.</span></span>|  
|<span data-ttu-id="2d4ea-129">Animer plusieurs objets avec des valeurs calculées à chaque frame et basées sur le dernier jeu d’interactions avec les objets</span><span class="sxs-lookup"><span data-stu-id="2d4ea-129">Animate multiple objects with values that are computed each frame and are based on the last set of object interactions</span></span>|<span data-ttu-id="2d4ea-130">Utilisez un rappel image par image.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-130">Use per-frame callback.</span></span> <span data-ttu-id="2d4ea-131">Pour plus d’informations, consultez la section [Création d’un rappel image par image](#useperframecallback).</span><span class="sxs-lookup"><span data-stu-id="2d4ea-131">For more information, see the [Create a Use Per-Frame Callback](#useperframecallback) section.</span></span>|  
  
<a name="createacustomkeyframe"></a>   
## <a name="create-a-custom-key-frame"></a><span data-ttu-id="2d4ea-132">Création d’une image clé personnalisée</span><span class="sxs-lookup"><span data-stu-id="2d4ea-132">Create a Custom Key Frame</span></span>  
 <span data-ttu-id="2d4ea-133">La création d’une classe d’image clé personnalisée est la façon la plus simple d’étendre le système d’animation.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-133">Creating a custom key frame class is the simplest way to extend the animation system.</span></span> <span data-ttu-id="2d4ea-134">Utilisez cette approche lorsque vous souhaitez une autre méthode d’interpolation pour une animation d’image clé.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-134">Use this approach when you want to a different interpolation method for a key-frame animation.</span></span>  <span data-ttu-id="2d4ea-135">Comme décrit dans la [Vue d'ensemble des animations d'image clé](key-frame-animations-overview.md), une animation d’image clé utilise des objets d’images clés pour générer ses valeurs de sortie.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-135">As described in the [Key-Frame Animations Overview](key-frame-animations-overview.md), a key-frame animation uses key frame objects to generate its output values.</span></span> <span data-ttu-id="2d4ea-136">Chaque objet d’image clé remplit trois fonctions :</span><span class="sxs-lookup"><span data-stu-id="2d4ea-136">Each key frame object performs three functions:</span></span>  
  
- <span data-ttu-id="2d4ea-137">Spécifie une valeur cible à l’aide de sa propriété <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-137">Specifies a target value using its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.</span></span>  
  
- <span data-ttu-id="2d4ea-138">Spécifie l’heure à laquelle cette valeur doit être atteinte à l’aide de sa propriété <xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-138">Specifies the time at which that value should be reached using its <xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A> property.</span></span>  
  
- <span data-ttu-id="2d4ea-139">Interpole entre la valeur de l’image clé précédente et sa propre valeur en implémentant la méthode InterpolateValueCore.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-139">Interpolates between the value of the previous key frame and its own value by implementing the InterpolateValueCore method.</span></span>  
  
 <span data-ttu-id="2d4ea-140">**Instructions d’implémentation**</span><span class="sxs-lookup"><span data-stu-id="2d4ea-140">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="2d4ea-141">Dérivez à partir de la classe abstraite *\<Type >* KeyFrame et implémentez la méthode InterpolateValueCore.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-141">Derive from the *\<Type>* KeyFrame abstract class and implement the InterpolateValueCore method.</span></span> <span data-ttu-id="2d4ea-142">La méthode InterpolateValueCore retourne la valeur actuelle de l’image clé.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-142">The InterpolateValueCore method returns the current value of the key frame.</span></span> <span data-ttu-id="2d4ea-143">Elle accepte deux paramètres : la valeur de l’image clé précédente et une valeur de progression comprise entre 0 et 1.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-143">It takes two parameters: the value of the previous key frame and a progress value that ranges from 0 to 1.</span></span> <span data-ttu-id="2d4ea-144">Une progression de 0 indique que l’image clé vient de démarrer, et la valeur 1 indique que l’image clé vient d’être terminée et doit retourner la valeur spécifiée par sa propriété <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-144">A progress of 0 indicates the key frame has just started, and a value of 1 indicates that the key frame has just completed and should return the value specified by its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.</span></span>  
  
 <span data-ttu-id="2d4ea-145">Étant donné que le *type de\<>* classes KeyFrame héritent de la classe <xref:System.Windows.Freezable>, vous devez également substituer <xref:System.Windows.Freezable.CreateInstanceCore%2A> Core pour retourner une nouvelle instance de votre classe.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-145">Because the *\<Type>* KeyFrame classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class.</span></span> <span data-ttu-id="2d4ea-146">Si la classe n’utilise pas de propriétés de dépendance pour stocker ses données ou si elle nécessite une initialisation supplémentaire après la création, vous devrez peut-être substituer d’autres méthodes. Consultez [Vue d'ensemble des objets Freezable](../advanced/freezable-objects-overview.md) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-146">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="2d4ea-147">Une fois que vous avez créé votre propre animation *\<Type >* KeyFrame, vous pouvez l’utiliser avec *\<Type >* AnimationUsingKeyFrames pour ce type.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-147">After you've created your custom *\<Type>* KeyFrame animation, you can use it with the *\<Type>* AnimationUsingKeyFrames for that type.</span></span>  
  
<a name="createacustomanimationtype"></a>   
## <a name="create-a-custom-animation-class"></a><span data-ttu-id="2d4ea-148">Création d’une classe d’animation personnalisée</span><span class="sxs-lookup"><span data-stu-id="2d4ea-148">Create a Custom Animation Class</span></span>  
 <span data-ttu-id="2d4ea-149">La création de votre propre type d’animation vous donne plus de contrôle sur la façon dont objet est animé.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-149">Creating your own animation type gives you more control over how an object in animated.</span></span> <span data-ttu-id="2d4ea-150">Il existe deux méthodes recommandées pour créer votre propre type d’animation : vous pouvez dériver de la classe <xref:System.Windows.Media.Animation.AnimationTimeline> ou du *type\<>* classe AnimationBase.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-150">There are two recommended ways to create your own animation type: you can derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class or the *\<Type>* AnimationBase class.</span></span> <span data-ttu-id="2d4ea-151">La dérivation à partir des classes *\<Type >* Animation ou *\<Type >* AnimationUsingKeyFrames n’est pas recommandée.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-151">Deriving from the *\<Type>* Animation or *\<Type>* AnimationUsingKeyFrames classes is not recommended.</span></span>  
  
### <a name="derive-from-typeanimationbase"></a><span data-ttu-id="2d4ea-152">Dérivation à partir de \<Type > AnimationBase</span><span class="sxs-lookup"><span data-stu-id="2d4ea-152">Derive from \<Type>AnimationBase</span></span>  
 <span data-ttu-id="2d4ea-153">La dérivation d’une classe *\<Type >* AnimationBase est la méthode la plus simple pour créer un nouveau type d’animation.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-153">Deriving from a *\<Type>* AnimationBase class is the simplest way to create a new animation type.</span></span> <span data-ttu-id="2d4ea-154">Utilisez cette approche lorsque vous souhaitez créer une nouvelle animation pour un type qui a déjà une classe *\<Type >* AnimationBase correspondante.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-154">Use this approach when you want to create a new animation for type that already has a corresponding *\<Type>* AnimationBase class.</span></span>  
  
 <span data-ttu-id="2d4ea-155">**Instructions d’implémentation**</span><span class="sxs-lookup"><span data-stu-id="2d4ea-155">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="2d4ea-156">Dérivez à partir d’une classe *\<Type >* Animation et implémentez la méthode GetCurrentValueCore.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-156">Derive from a *\<Type>* Animation class and implement the GetCurrentValueCore method.</span></span> <span data-ttu-id="2d4ea-157">La méthode GetCurrentValueCore retourne la valeur actuelle de l’animation.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-157">The GetCurrentValueCore method returns the current value of the animation.</span></span> <span data-ttu-id="2d4ea-158">Il accepte trois paramètres : une valeur de départ suggérée, une valeur de fin suggérée et une <xref:System.Windows.Media.Animation.AnimationClock>, que vous utilisez pour déterminer la progression de l’animation.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-158">It takes three parameters: a suggested starting value, a suggested ending value, and an <xref:System.Windows.Media.Animation.AnimationClock>, which you use to determine the progress of the animation.</span></span>  
  
 <span data-ttu-id="2d4ea-159">Étant donné que le *Type\<>* les classes AnimationBase héritent de la classe <xref:System.Windows.Freezable>, vous devez également substituer <xref:System.Windows.Freezable.CreateInstanceCore%2A> Core pour retourner une nouvelle instance de votre classe.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-159">Because the *\<Type>* AnimationBase classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class.</span></span> <span data-ttu-id="2d4ea-160">Si la classe n’utilise pas de propriétés de dépendance pour stocker ses données ou si elle nécessite une initialisation supplémentaire après la création, vous devrez peut-être substituer d’autres méthodes. Consultez [Vue d'ensemble des objets Freezable](../advanced/freezable-objects-overview.md) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-160">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="2d4ea-161">Pour plus d’informations, consultez la documentation sur la méthode GetCurrentValueCore pour la classe *\<Type >* AnimationBase du type que vous souhaitez animer.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-161">For more information, see the GetCurrentValueCore method documentation for the *\<Type>* AnimationBase class for the type that you want to animate.</span></span> <span data-ttu-id="2d4ea-162">Pour obtenir un exemple, consultez [Exemple d’animation personnalisée](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)</span><span class="sxs-lookup"><span data-stu-id="2d4ea-162">For an example, see the [Custom Animation Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)</span></span>  
  
 <span data-ttu-id="2d4ea-163">**Autres approches**</span><span class="sxs-lookup"><span data-stu-id="2d4ea-163">**Alternative Approaches**</span></span>  
  
 <span data-ttu-id="2d4ea-164">Si vous souhaitez simplement modifier la façon dont les valeurs d’animation sont interpolées, envisagez de dériver une des classes *\<Type >* KeyFrame.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-164">If you simply want to change how animation values are interpolated, considering deriving from one of the *\<Type>* KeyFrame classes.</span></span> <span data-ttu-id="2d4ea-165">L’image clé que vous créez est utilisable par les *\<Type >* AnimationUsingKeyFrames correspondants fournis par [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2d4ea-165">The key frame you create can be used with the corresponding *\<Type>* AnimationUsingKeyFrames provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
### <a name="derive-from-animationtimeline"></a><span data-ttu-id="2d4ea-166">Dérivation à partir de AnimationTimeline</span><span class="sxs-lookup"><span data-stu-id="2d4ea-166">Derive from AnimationTimeline</span></span>  
 <span data-ttu-id="2d4ea-167">Dérivez de la classe <xref:System.Windows.Media.Animation.AnimationTimeline> lorsque vous souhaitez créer une animation pour un type qui n’a pas déjà une animation [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] correspondante, ou si vous souhaitez créer une animation qui n’est pas fortement typée.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-167">Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class when you want to create an animation for a type that doesn't already have a matching [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation, or you want to create an animation that is not strongly typed.</span></span>  
  
 <span data-ttu-id="2d4ea-168">**Instructions d’implémentation**</span><span class="sxs-lookup"><span data-stu-id="2d4ea-168">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="2d4ea-169">Dérivez de la classe <xref:System.Windows.Media.Animation.AnimationTimeline> et substituez les membres suivants :</span><span class="sxs-lookup"><span data-stu-id="2d4ea-169">Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class and override the following members:</span></span>  
  
- <span data-ttu-id="2d4ea-170"><xref:System.Windows.Freezable.CreateInstanceCore%2A> : Si votre nouvelle classe est concrète, vous devez substituer <xref:System.Windows.Freezable.CreateInstanceCore%2A> pour retourner une nouvelle instance de votre classe.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-170"><xref:System.Windows.Freezable.CreateInstanceCore%2A> – If your new class is concrete, you must override <xref:System.Windows.Freezable.CreateInstanceCore%2A> to return a new instance of your class.</span></span>  
  
- <span data-ttu-id="2d4ea-171"><xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> : substituez cette méthode pour retourner la valeur actuelle de votre animation.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-171"><xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> – Override this method to return the current value of your animation.</span></span> <span data-ttu-id="2d4ea-172">Il accepte trois paramètres : une valeur d’origine par défaut, une valeur de destination par défaut et une <xref:System.Windows.Media.Animation.AnimationClock>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-172">It takes three parameters: a default origin value, a default destination value, and an <xref:System.Windows.Media.Animation.AnimationClock>.</span></span> <span data-ttu-id="2d4ea-173">Utilisez la <xref:System.Windows.Media.Animation.AnimationClock> pour obtenir l’heure actuelle ou la progression de l’animation.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-173">Use the <xref:System.Windows.Media.Animation.AnimationClock> to obtain the current time or progress for the animation.</span></span> <span data-ttu-id="2d4ea-174">Vous pouvez choisir d’utiliser les valeurs d’origine et de destination par défaut.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-174">You can choose whether to use the default origin and destination values.</span></span>  
  
- <span data-ttu-id="2d4ea-175"><xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> : remplacez cette propriété pour indiquer si votre animation utilise la valeur de destination par défaut spécifiée par la méthode <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-175"><xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> – Override this property to indicate whether your animation uses the default destination value specified by the <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> method.</span></span>  
  
- <span data-ttu-id="2d4ea-176"><xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> : remplacez cette propriété pour indiquer le <xref:System.Type> de sortie produit par votre animation.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-176"><xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> – Override this property to indicate the <xref:System.Type> of output your animation produces.</span></span>  
  
 <span data-ttu-id="2d4ea-177">Si la classe n’utilise pas de propriétés de dépendance pour stocker ses données ou si elle nécessite une initialisation supplémentaire après la création, vous devrez peut-être substituer d’autres méthodes. Consultez [Vue d'ensemble des objets Freezable](../advanced/freezable-objects-overview.md) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-177">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="2d4ea-178">Le paradigme recommandé (utilisé par les animations [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]) consiste à utiliser deux niveaux d’héritage :</span><span class="sxs-lookup"><span data-stu-id="2d4ea-178">The recommended paradigm (used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animations) is to use two inheritance levels:</span></span>  
  
1. <span data-ttu-id="2d4ea-179">Créez un *type de\<abstrait >* classe AnimationBase qui dérive de <xref:System.Windows.Media.Animation.AnimationTimeline>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-179">Create an abstract *\<Type>* AnimationBase class that derives from <xref:System.Windows.Media.Animation.AnimationTimeline>.</span></span> <span data-ttu-id="2d4ea-180">Cette classe doit substituer la méthode <xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-180">This class should override the <xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> method.</span></span> <span data-ttu-id="2d4ea-181">Elle doit également introduire une nouvelle méthode abstraite, GetCurrentValueCore et substituer <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> afin de valider les types de la valeur d’origine par défaut et des paramètres de la valeur de destination par défaut, puis appelle GetCurrentValueCore.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-181">It should also introduce a new abstract method, GetCurrentValueCore, and override <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> so that it validates the types of the default origin value and default destination value parameters, then calls GetCurrentValueCore.</span></span>  
  
2. <span data-ttu-id="2d4ea-182">Créez une autre classe qui hérite de votre nouveau *type de\<>* classe AnimationBase et substitue la méthode <xref:System.Windows.Freezable.CreateInstanceCore%2A>, la méthode GetCurrentValueCore que vous avez introduite et la propriété <xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-182">Create another class that inherits from your new *\<Type>* AnimationBase class and overrides the <xref:System.Windows.Freezable.CreateInstanceCore%2A> method, the GetCurrentValueCore method that you introduced, and the <xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> property.</span></span>  
  
 <span data-ttu-id="2d4ea-183">**Autres approches**</span><span class="sxs-lookup"><span data-stu-id="2d4ea-183">**Alternative Approaches**</span></span>  
  
 <span data-ttu-id="2d4ea-184">Si vous souhaitez animer un type qui n’a pas d’animation from/to/by et d’animation d’image clé correspondantes, envisagez d’utiliser un <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-184">If you want to animate a type that has no corresponding From/To/By animation or key-frame animation, consider using an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>.</span></span> <span data-ttu-id="2d4ea-185">Étant donné qu’il est faiblement typé, un <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> peut animer n’importe quel type de valeur.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-185">Because it is weakly typed, an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> can animate any type of value.</span></span> <span data-ttu-id="2d4ea-186">L’inconvénient de cette approche est que <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> prend en charge uniquement l’interpolation discrète.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-186">The drawback to this approach is that <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> only supports discrete interpolation.</span></span>  
  
<a name="useperframecallback"></a>   
## <a name="use-per-frame-callback"></a><span data-ttu-id="2d4ea-187">Rappel image par image</span><span class="sxs-lookup"><span data-stu-id="2d4ea-187">Use Per-Frame Callback</span></span>  
 <span data-ttu-id="2d4ea-188">Utilisez cette approche lorsque vous devez ignorer entièrement le système d’animation [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span><span class="sxs-lookup"><span data-stu-id="2d4ea-188">Use this approach when you need to completely bypass the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system.</span></span> <span data-ttu-id="2d4ea-189">Un scénario pour cette approche est l’animation physique, où pour chaque étape animation une nouvelle direction ou position doit être recalculée pour les objets animés en fonction du dernier jeu d’interactions avec les objets.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-189">One scenario for this approach is physics animations, where at each animation step a new direction or position of animated objects needs to be recomputed based on the  last set of object interactions.</span></span>  
  
 <span data-ttu-id="2d4ea-190">**Instructions d’implémentation**</span><span class="sxs-lookup"><span data-stu-id="2d4ea-190">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="2d4ea-191">Contrairement aux autres approches décrites dans cette vue d’ensemble, le rappel image par image ne nécessite pas de créer une animation personnalisée ou une classe d’image clé.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-191">Unlike the other approaches described in this overview, to use per-frame callback you don't need to create a custom animation or key frame class.</span></span>  
  
 <span data-ttu-id="2d4ea-192">Au lieu de cela, vous vous inscrivez pour l’événement <xref:System.Windows.Media.CompositionTarget.Rendering> de l’objet qui contient les objets que vous souhaitez animer.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-192">Instead, you register for the <xref:System.Windows.Media.CompositionTarget.Rendering> event of the object that contains the objects you want to animate.</span></span> <span data-ttu-id="2d4ea-193">Cette méthode de gestionnaire d’événements est appelée une fois par image.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-193">This event handler method gets called once per frame.</span></span> <span data-ttu-id="2d4ea-194">Chaque fois que [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] marshale les données de rendu persistantes dans l’arborescence visuelle sur l’arborescence de composition, votre méthode de gestionnaire d’événements est appelée.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-194">Each time that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] marshals the persisted rendering data in the visual tree across to the composition tree, your event handler method is called.</span></span>  
  
 <span data-ttu-id="2d4ea-195">Dans votre gestionnaire d’événements, effectuez les calculs nécessaires pour votre effet d’animation et définissez les propriétés des objets à animer avec ces valeurs.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-195">In your event handler, perform your whatever calculations necessary for your animation effect and set the properties of the objects you want to animate with these values.</span></span>  
  
 <span data-ttu-id="2d4ea-196">Pour obtenir l’heure de présentation de l’image actuelle, les <xref:System.EventArgs> associées à cet événement peuvent être converties en <xref:System.Windows.Media.RenderingEventArgs>, qui fournissent une propriété <xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A> que vous pouvez utiliser pour obtenir le temps de rendu de l’image actuelle.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-196">To obtain the presentation time of the current frame, the <xref:System.EventArgs> associated with this event can be cast as <xref:System.Windows.Media.RenderingEventArgs>, which provide a <xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A> property that you can use to obtain the current frame's rendering time.</span></span>  
  
 <span data-ttu-id="2d4ea-197">Pour plus d’informations, consultez la page <xref:System.Windows.Media.CompositionTarget.Rendering>.</span><span class="sxs-lookup"><span data-stu-id="2d4ea-197">For more information, see the <xref:System.Windows.Media.CompositionTarget.Rendering> page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2d4ea-198">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="2d4ea-198">See also</span></span>

- <xref:System.Windows.Media.Animation.AnimationTimeline>
- <xref:System.Windows.Media.Animation.IKeyFrame>
- [<span data-ttu-id="2d4ea-199">Vue d'ensemble des techniques d'animation de propriétés</span><span class="sxs-lookup"><span data-stu-id="2d4ea-199">Property Animation Techniques Overview</span></span>](property-animation-techniques-overview.md)
- [<span data-ttu-id="2d4ea-200">Vue d’ensemble des objets Freezable</span><span class="sxs-lookup"><span data-stu-id="2d4ea-200">Freezable Objects Overview</span></span>](../advanced/freezable-objects-overview.md)
- [<span data-ttu-id="2d4ea-201">Vue d'ensemble des animations d'image clé</span><span class="sxs-lookup"><span data-stu-id="2d4ea-201">Key-Frame Animations Overview</span></span>](key-frame-animations-overview.md)
- [<span data-ttu-id="2d4ea-202">Vue d'ensemble des animations de tracés</span><span class="sxs-lookup"><span data-stu-id="2d4ea-202">Path Animations Overview</span></span>](path-animations-overview.md)
- [<span data-ttu-id="2d4ea-203">Vue d’ensemble de l’animation</span><span class="sxs-lookup"><span data-stu-id="2d4ea-203">Animation Overview</span></span>](animation-overview.md)
- [<span data-ttu-id="2d4ea-204">Vue d'ensemble de l'animation et du système de minutage</span><span class="sxs-lookup"><span data-stu-id="2d4ea-204">Animation and Timing System Overview</span></span>](animation-and-timing-system-overview.md)
- [<span data-ttu-id="2d4ea-205">Exemple d’animation personnalisée</span><span class="sxs-lookup"><span data-stu-id="2d4ea-205">Custom Animation Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)

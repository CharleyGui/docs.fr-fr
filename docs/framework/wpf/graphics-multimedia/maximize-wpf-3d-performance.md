---
title: Optimiser les performances 3D
ms.date: 03/30/2017
helpviewer_keywords:
- 3-D graphics [WPF]
ms.assetid: 4bcf949d-d92f-4d8d-8a9b-1e4c61b25bf6
ms.openlocfilehash: 414a4677a1e05cd69c382e35194328d6ce1bddf9
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/24/2020
ms.locfileid: "76744598"
---
# <a name="maximize-wpf-3d-performance"></a>Optimiser les performances 3D de WPF
Lorsque vous utilisez la [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] pour créer des contrôles 3D et inclure des scènes 3D dans vos applications, il est important d’envisager l’optimisation des performances. Cette rubrique fournit une liste des classes et des propriétés 3D qui ont une incidence sur les performances de votre application, ainsi que des recommandations pour optimiser les performances lorsque vous les utilisez.  
  
 Cette rubrique suppose une compréhension approfondie des fonctionnalités de [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] 3D. Les suggestions de ce document s’appliquent au « niveau de rendu 2 », à peu près définie en tant que matériel prenant en charge le nuanceur de pixels version 2,0 et le nuanceur de sommets version 2,0. Pour plus d’informations, consultez [couches de rendu graphiques](../advanced/graphics-rendering-tiers.md).  
  
## <a name="performance-impact-high"></a>Impact sur les performances : élevé  
  
|Propriété|Recommandation|  
|-|-|  
|<xref:System.Windows.Media.Brush>|Vitesse du pinceau (plus rapide à la plus lente) :<br /><br /> <xref:System.Windows.Media.SolidColorBrush><br /><br /> <xref:System.Windows.Media.LinearGradientBrush><br /><br /> <xref:System.Windows.Media.ImageBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush> (mis en cache)<br /><br /> <xref:System.Windows.Media.VisualBrush> (mis en cache)<br /><br /> <xref:System.Windows.Media.RadialGradientBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush> (ne sont pas mis en cache)<br /><br /> <xref:System.Windows.Media.VisualBrush> (ne sont pas mis en cache)|  
|<xref:System.Windows.UIElement.ClipToBoundsProperty>|Affectez à `Viewport3D.ClipToBounds` la valeur false à chaque fois que vous n’avez pas besoin d' [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] détourer explicitement le contenu d’un <xref:System.Windows.Controls.Viewport3D> dans le rectangle Viewport3D’s. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] le découpage avec anticrénelage peut être très lent et `ClipToBounds` est activé par défaut sur <xref:System.Windows.Controls.Viewport3D>.|  
|<xref:System.Windows.UIElement.IsHitTestVisible%2A>|Affectez à `Viewport3D.IsHitTestVisible` la valeur false chaque fois que vous n’avez pas besoin de [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] prendre en compte le contenu d’un <xref:System.Windows.Controls.Viewport3D> lors du test de positionnement de la souris.  Le contenu 3D de test de positionnement est effectué dans un logiciel et peut être lent avec des mailles de grande taille. <xref:System.Windows.UIElement.IsHitTestVisible%2A> est activé par défaut (lent) sur <xref:System.Windows.Controls.Viewport3D>.|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D>|Créez des modèles différents uniquement lorsqu’ils requièrent des matériaux ou des transformations différents.  Dans le cas contraire, essayez de fusionner de nombreuses instances <xref:System.Windows.Media.Media3D.GeometryModel3D> avec les mêmes matériaux et les mêmes transformations en quelques <xref:System.Windows.Media.Media3D.GeometryModel3D> et <xref:System.Windows.Media.Media3D.MeshGeometry3D> instances de plus grande taille.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Animation de maillage : la modification des vertex individuels d’une maille pour chaque image n’est pas toujours efficace dans [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)].  Pour réduire l’impact sur les performances des notifications de modifications lorsque chaque vertex est modifié, détachez le maillage de l’arborescence d’éléments visuels avant d’effectuer une modification par vertex.  Une fois que le maillage a été modifié, rattachez-le à l’arborescence d’éléments visuels.  Essayez également de réduire la taille des mailles qui seront animées de cette manière.|  
|anticrénelage 3D|Pour augmenter la vitesse de rendu, désactivez l’échantillonnage multiple sur un <xref:System.Windows.Controls.Viewport3D> en affectant à la propriété jointe <xref:System.Windows.Media.RenderOptions.EdgeMode%2A> la valeur `Aliased`.  Par défaut, l’anticrénelage 3D est activé sur Windows avec 4 échantillons par pixel.|  
|Texte|Le texte en direct dans une scène 3D (en direct, car il se trouve dans un <xref:System.Windows.Media.DrawingBrush> ou <xref:System.Windows.Media.VisualBrush>) peut être lent. Essayez d’utiliser des images du texte à la place (par <xref:System.Windows.Media.Imaging.RenderTargetBitmap>) à moins que le texte ne change.|  
|<xref:System.Windows.Media.TileBrush>|Si vous devez utiliser un <xref:System.Windows.Media.VisualBrush> ou un <xref:System.Windows.Media.DrawingBrush> dans une scène 3D parce que le contenu du pinceau n’est pas statique, essayez de mettre en cache le pinceau (en affectant à la propriété jointe <xref:System.Windows.Media.RenderOptions.CachingHint%2A> la valeur `Cache`).  Définissez les seuils d’invalidation minimal et maximal de l’échelle (avec les propriétés jointes <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A> et <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A>) afin que les pinceaux mis en cache ne soient pas régénérés trop fréquemment, tout en maintenant le niveau de qualité souhaité.  Par défaut, les <xref:System.Windows.Media.DrawingBrush> et les <xref:System.Windows.Media.VisualBrush> ne sont pas mis en cache, ce qui signifie que chaque fois que l’un des éléments peints avec le pinceau doit être restitué à nouveau, le contenu entier du pinceau doit d’abord être restitué à nouveau sur une surface intermédiaire.|  
|<xref:System.Windows.Media.Effects.BitmapEffect>|<xref:System.Windows.Media.Effects.BitmapEffect> force le rendu de tout le contenu affecté sans accélération matérielle.  Pour des performances optimales, n’utilisez pas <xref:System.Windows.Media.Effects.BitmapEffect>.|  
  
## <a name="performance-impact-medium"></a>Impact sur les performances : moyenne  
  
|Propriété|Recommandation|  
|-|-|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Lorsqu’un maillage est défini en tant que triangles contigus avec des vertex partagés et que ces sommets ont les mêmes position, normale et coordonnées de texture, définissez chaque vertex partagé une seule fois, puis définissez vos triangles par index avec <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>.|  
|<xref:System.Windows.Media.ImageBrush>|Essayez de réduire les tailles de texture lorsque vous avez un contrôle explicite sur la taille (lorsque vous utilisez une <xref:System.Windows.Media.Imaging.RenderTargetBitmap> et/ou un <xref:System.Windows.Media.ImageBrush>).  Notez que les textures de résolution inférieure peuvent réduire la qualité visuelle, donc essayez de trouver le bon équilibre entre qualité et performances.|  
|Opacité|Lors du rendu de contenu 3D translucide (comme les réflexions), utilisez les propriétés d’opacité sur des pinceaux ou des matériaux (par le biais de <xref:System.Windows.Media.Brush.Opacity%2A> ou <xref:System.Windows.Media.Media3D.DiffuseMaterial.Color%2A>) au lieu de créer un <xref:System.Windows.Controls.Viewport3D> transparent distinct en affectant à `Viewport3D.Opacity` une valeur inférieure à 1.|  
|<xref:System.Windows.Controls.Viewport3D>|Réduisez le nombre d’objets <xref:System.Windows.Controls.Viewport3D> que vous utilisez dans une scène.  Placez de nombreux modèles 3D dans le même Viewport3D plutôt que de créer des instances Viewport3D distinctes pour chaque modèle.|  
|<xref:System.Windows.Freezable>|En général, il est préférable de réutiliser <xref:System.Windows.Media.Media3D.MeshGeometry3D>, les <xref:System.Windows.Media.Media3D.GeometryModel3D>, les pinceaux et les matériaux.  Toutes sont multiparentes, car elles sont dérivées de `Freezable`.|  
|<xref:System.Windows.Freezable>|Appelez la méthode <xref:System.Windows.Freezable.Freeze%2A> sur Freezables lorsque leurs propriétés restent inchangées dans votre application.  La congélation peut réduire la plage de travail et augmenter la vitesse.|  
|<xref:System.Windows.Media.Brush>|Utilisez <xref:System.Windows.Media.ImageBrush> au lieu de <xref:System.Windows.Media.VisualBrush> ou <xref:System.Windows.Media.DrawingBrush> lorsque le contenu du pinceau ne change pas.  le contenu 2D peut être converti en <xref:System.Windows.Controls.Image> via <xref:System.Windows.Media.Imaging.RenderTargetBitmap> puis utilisé dans un <xref:System.Windows.Media.ImageBrush>.|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>|N’utilisez pas <xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>, sauf si vous devez réellement voir les faces arrière de votre <xref:System.Windows.Media.Media3D.GeometryModel3D>.|  
|<xref:System.Windows.Media.Media3D.Light>|Vitesse légère (la plus rapide à la plus lente) :<br /><br /> <xref:System.Windows.Media.Media3D.AmbientLight><br /><br /> <xref:System.Windows.Media.Media3D.DirectionalLight><br /><br /> <xref:System.Windows.Media.Media3D.PointLight><br /><br /> <xref:System.Windows.Media.Media3D.SpotLight>|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Essayez de conserver les tailles de maillage sous ces limites :<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>: 20 001 <xref:System.Windows.Media.Media3D.Point3D> instances<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>: 60 003 <xref:System.Int32> instances|  
|<xref:System.Windows.Media.Media3D.Material>|Vitesse du matériel (plus rapide à la plus lente) :<br /><br /> <xref:System.Windows.Media.Media3D.EmissiveMaterial><br /><br /> <xref:System.Windows.Media.Media3D.DiffuseMaterial><br /><br /> <xref:System.Windows.Media.Media3D.SpecularMaterial>|  
|<xref:System.Windows.Media.Brush>|[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] 3D n’exclut pas les pinceaux invisibles (pinceaux ambiants noirs, pinceaux clairs, etc.) de manière cohérente.  Envisagez de les omettre à partir de votre scène.|  
|<xref:System.Windows.Media.Media3D.MaterialGroup>|Chaque <xref:System.Windows.Media.Media3D.Material> dans un <xref:System.Windows.Media.Media3D.MaterialGroup> entraîne une autre passe de rendu. ainsi, si vous incluez de nombreux matériaux, même des matériaux simples, vous risquez d’augmenter considérablement les besoins de remplissage sur votre GPU.  Réduisez le nombre de documents dans votre <xref:System.Windows.Media.Media3D.MaterialGroup>.|  
  
## <a name="performance-impact-low"></a>Impact sur les performances : faible  
  
|Propriété|Recommandation|  
|-|-|  
|<xref:System.Windows.Media.Media3D.Transform3DGroup>|Lorsque vous n’avez pas besoin d’animation ou de liaison de données, au lieu d’utiliser un groupe de transformations contenant plusieurs transformations, utilisez un <xref:System.Windows.Media.Media3D.MatrixTransform3D>unique, en le définissant sur le produit de toutes les transformations qui, autrement, existent indépendamment dans le groupe de transformations.|  
|<xref:System.Windows.Media.Media3D.Light>|Réduisez le nombre de lumières dans votre scène. Un trop grand nombre d’éclairages dans une scène force [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] à revenir au rendu logiciel.  Les limites sont approximativement 110 <xref:System.Windows.Media.Media3D.DirectionalLight> objets, 70 <xref:System.Windows.Media.Media3D.PointLight> objets ou 40 objets <xref:System.Windows.Media.Media3D.SpotLight>.|  
|<xref:System.Windows.Media.Media3D.ModelVisual3D>|Séparez les objets mobiles des objets statiques en les plaçant dans des instances de <xref:System.Windows.Media.Media3D.ModelVisual3D> distinctes.  ModelVisual3D est « plus lourd » que <xref:System.Windows.Media.Media3D.GeometryModel3D>, car il met en cache les limites transformées.  GeometryModel3D est optimisé pour être un modèle. ModelVisual3D est optimisé pour être un nœud de scène.  Utilisez ModelVisual3D pour placer des instances partagées de GeometryModel3D dans la scène.|  
|<xref:System.Windows.Media.Media3D.Light>|Réduisez le nombre de fois que vous modifiez le nombre de lumières dans la scène.  Chaque modification du nombre de lumière force la régénération et la recompilation d’un nuanceur, sauf si cette configuration a existé précédemment (et donc si son nuanceur a été mis en cache).|  
|Clair|Les voyants noirs ne seront pas visibles, mais ils seront ajoutés au temps de rendu. envisagez de les omettre.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Pour réduire le temps de construction des collections volumineuses dans [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)], telles qu’un MeshGeometry3D’s <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>, <xref:System.Windows.Media.Media3D.MeshGeometry3D.Normals%2A>, <xref:System.Windows.Media.Media3D.MeshGeometry3D.TextureCoordinates%2A>et <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>, prédimensionnez les collections avant le remplissage de la valeur. Si possible, transmettez les structures de données préremplies des constructeurs des collections, telles que des tableaux ou des listes.|  
  
## <a name="see-also"></a>Voir aussi

- [Vue d’ensemble des graphiques 3D](3-d-graphics-overview.md)

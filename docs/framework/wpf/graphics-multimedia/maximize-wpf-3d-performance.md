---
title: Maximiser les performances 3D
ms.date: 03/30/2017
helpviewer_keywords:
- 3D graphics [WPF]
ms.assetid: 4bcf949d-d92f-4d8d-8a9b-1e4c61b25bf6
ms.openlocfilehash: 3825ea8e57c6863e2ee654072efda623db21c2a8
ms.sourcegitcommit: 267d092663aba36b6b2ea853034470aea493bfae
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/21/2020
ms.locfileid: "80111996"
---
# <a name="maximize-wpf-3d-performance"></a>Optimiser les performances 3D de WPF
Lorsque vous [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] utilisez les commandes 3D pour construire des commandes 3D et inclure des scènes 3D dans vos applications, il est important de tenir compte de l’optimisation des performances. Ce sujet fournit une liste des classes et des propriétés 3D qui ont des implications de performance pour votre application, ainsi que des recommandations pour optimiser les performances lorsque vous les utilisez.  
  
 Ce sujet suppose une [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] compréhension avancée des caractéristiques 3D. Les suggestions contenues dans ce document s’appliquent au « niveau de rendu 2 », à peu près défini comme du matériel qui prend en charge la version 2.0 et la version 2.0 de l’shader de pixels. Pour plus de détails, voir [Graphics Rendering Tiers](../advanced/graphics-rendering-tiers.md).  
  
## <a name="performance-impact-high"></a>Impact sur la performance : élevé  
  
|Propriété|Recommandation|  
|-|-|  
|<xref:System.Windows.Media.Brush>|Vitesse de broussailles (la plus rapide à la plus lente) :<br /><br /> <xref:System.Windows.Media.SolidColorBrush><br /><br /> <xref:System.Windows.Media.LinearGradientBrush><br /><br /> <xref:System.Windows.Media.ImageBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush>(en cache)<br /><br /> <xref:System.Windows.Media.VisualBrush>(en cache)<br /><br /> <xref:System.Windows.Media.RadialGradientBrush><br /><br /> <xref:System.Windows.Media.DrawingBrush>(non plafonné)<br /><br /> <xref:System.Windows.Media.VisualBrush>(non plafonné)|  
|<xref:System.Windows.UIElement.ClipToBoundsProperty>|Définissez-vous `Viewport3D.ClipToBounds` à faux chaque [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] fois que vous <xref:System.Windows.Controls.Viewport3D> n’avez pas besoin d’avoir explicitement clip le contenu d’un rectangle de viewport3D. [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]la tonte antialiased peut `ClipToBounds` être très lente, <xref:System.Windows.Controls.Viewport3D>et est activée (lente) par défaut sur .|  
|<xref:System.Windows.UIElement.IsHitTestVisible%2A>|Définissez-vous `Viewport3D.IsHitTestVisible` à faux [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] chaque fois que <xref:System.Windows.Controls.Viewport3D> vous n’avez pas besoin de considérer le contenu d’un lors de l’exécution de la souris hit test.  Le contenu 3D de test de hit se fait dans le logiciel et peut être lent avec de gros maillages. <xref:System.Windows.UIElement.IsHitTestVisible%2A>est activé (lent) <xref:System.Windows.Controls.Viewport3D>par défaut sur .|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D>|Créez différents modèles uniquement lorsqu’ils ont besoin de matériaux ou de transformations différents.  Sinon, essayez de fusionner <xref:System.Windows.Media.Media3D.GeometryModel3D> de nombreux cas avec les mêmes <xref:System.Windows.Media.Media3D.GeometryModel3D> <xref:System.Windows.Media.Media3D.MeshGeometry3D> matériaux et se transforme en quelques plus grands et des instances.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|L’animation mesh— changer les vertices individuels d’un maillage sur [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]une base par cadre - n’est pas toujours efficace dans .  Pour minimiser l’impact des notifications de changement lorsque chaque vertéx est modifié, détachez le maillage de l’arbre visuel avant d’effectuer la modification par vertéx.  Une fois que le maillage a été modifié, réattachez-le à l’arbre visuel.  Aussi, essayez de minimiser la taille des mailles qui seront animées de cette façon.|  
|Antialiasing 3D|Pour augmenter la vitesse de rendu, désactiver <xref:System.Windows.Controls.Viewport3D> le multisampling sur un en fixant la propriété <xref:System.Windows.Media.RenderOptions.EdgeMode%2A> attachée à `Aliased`.  Par défaut, l’antialiasing 3D est activé sur Windows avec 4 échantillons par pixel.|  
|Texte|Le texte en direct dans une scène 3D (en direct parce qu’il est dans un <xref:System.Windows.Media.DrawingBrush> ou <xref:System.Windows.Media.VisualBrush>) peut être lent. Essayez d’utiliser des images <xref:System.Windows.Media.Imaging.RenderTargetBitmap>du texte à la place (via ) à moins que le texte va changer.|  
|<xref:System.Windows.Media.TileBrush>|Si vous devez <xref:System.Windows.Media.VisualBrush> utiliser <xref:System.Windows.Media.DrawingBrush> un ou un dans une scène 3D parce que le contenu du <xref:System.Windows.Media.RenderOptions.CachingHint%2A> `Cache`pinceau n’est pas statique, essayez de mettre en cache la brosse (réglage de la propriété ci-jointe à ).  Réglez les seuils d’invalidation à <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMinimum%2A> <xref:System.Windows.Media.RenderOptions.CacheInvalidationThresholdMaximum%2A>échelle minimale et maximale (avec les propriétés ci-jointes et) de sorte que les brosses mises en cache ne seront pas régénérées trop fréquemment, tout en maintenant votre niveau de qualité souhaité.  Par <xref:System.Windows.Media.DrawingBrush> défaut, <xref:System.Windows.Media.VisualBrush> et ne sont pas mis en cache, ce qui signifie que chaque fois que quelque chose peint avec le pinceau doit être rendu à nouveau, l’ensemble du contenu de la brosse doit d’abord être rendu à une surface intermédiaire.|  
|<xref:System.Windows.Media.Effects.BitmapEffect>|<xref:System.Windows.Media.Effects.BitmapEffect>oblige tous les contenus concernés à être rendus sans accélération matérielle.  Pour les meilleures performances, ne pas utiliser <xref:System.Windows.Media.Effects.BitmapEffect>.|  
  
## <a name="performance-impact-medium"></a>Impact sur la performance : Moyen  
  
|Propriété|Recommandation|  
|-|-|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Quand un maillage est défini comme des triangles d’adage avec des vertices partagés et ces vertices ont la même <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>position, normale, et les coordonnées de texture, définir chaque vertex partagé qu’une fois et ensuite définir vos triangles par index avec .|  
|<xref:System.Windows.Media.ImageBrush>|Essayez de minimiser les tailles de texture lorsque vous avez <xref:System.Windows.Media.Imaging.RenderTargetBitmap> un contrôle <xref:System.Windows.Media.ImageBrush>explicite sur la taille (lorsque vous utilisez un et / ou un ).  Notez que les textures à résolution inférieure peuvent diminuer la qualité visuelle, alors essayez de trouver le bon équilibre entre la qualité et les performances.|  
|Opacité|Lors du rendu du contenu 3D translucide (comme les réflexions), utilisez <xref:System.Windows.Media.Brush.Opacity%2A> <xref:System.Windows.Media.Media3D.DiffuseMaterial.Color%2A>les propriétés d’opacité sur les brosses ou les matériaux (via ou ) au lieu de créer une translucide <xref:System.Windows.Controls.Viewport3D> distincte en définissant `Viewport3D.Opacity` à une valeur inférieure à 1.|  
|<xref:System.Windows.Controls.Viewport3D>|Minimisez le <xref:System.Windows.Controls.Viewport3D> nombre d’objets que vous utilisez dans une scène.  Mettez de nombreux modèles 3D dans le même Viewport3D plutôt que de créer des instances Viewport3D séparées pour chaque modèle.|  
|<xref:System.Windows.Freezable>|Typiquement, il est bénéfique <xref:System.Windows.Media.Media3D.MeshGeometry3D> <xref:System.Windows.Media.Media3D.GeometryModel3D>de réutiliser , , brosses, et les matériaux.  Tous sont multiparentables car `Freezable`ils sont dérivés de .|  
|<xref:System.Windows.Freezable>|Appelez <xref:System.Windows.Freezable.Freeze%2A> la méthode sur Freezables lorsque leurs propriétés resteront inchangées dans votre application.  La congélation peut diminuer l’ensemble de travail et augmenter la vitesse.|  
|<xref:System.Windows.Media.Brush>|Utilisez <xref:System.Windows.Media.ImageBrush> au <xref:System.Windows.Media.VisualBrush> <xref:System.Windows.Media.DrawingBrush> lieu ou quand le contenu de la brosse ne changera pas.  Le contenu 2D peut <xref:System.Windows.Controls.Image> être <xref:System.Windows.Media.Imaging.RenderTargetBitmap> converti en <xref:System.Windows.Media.ImageBrush>via puis utilisé dans un .|  
|<xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A>|Ne pas <xref:System.Windows.Media.Media3D.GeometryModel3D.BackMaterial%2A> utiliser à moins que vous avez <xref:System.Windows.Media.Media3D.GeometryModel3D>réellement besoin de voir les visages arrière de votre .|  
|<xref:System.Windows.Media.Media3D.Light>|Vitesse de lumière (la plus rapide à la plus lente) :<br /><br /> <xref:System.Windows.Media.Media3D.AmbientLight><br /><br /> <xref:System.Windows.Media.Media3D.DirectionalLight><br /><br /> <xref:System.Windows.Media.Media3D.PointLight><br /><br /> <xref:System.Windows.Media.Media3D.SpotLight>|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Essayez de garder les tailles de maille sous ces limites :<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>: 20 001 <xref:System.Windows.Media.Media3D.Point3D> cas<br /><br /> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>: 60 003 <xref:System.Int32> cas|  
|<xref:System.Windows.Media.Media3D.Material>|Vitesse du matériau (la plus rapide à la plus lente) :<br /><br /> <xref:System.Windows.Media.Media3D.EmissiveMaterial><br /><br /> <xref:System.Windows.Media.Media3D.DiffuseMaterial><br /><br /> <xref:System.Windows.Media.Media3D.SpecularMaterial>|  
|<xref:System.Windows.Media.Brush>|[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]La 3D ne se désespère pas des brosses invisibles (brosses ambiantes noires, brosses claires, etc.) d’une manière cohérente.  Envisagez d’omettre ces de votre scène.|  
|<xref:System.Windows.Media.Media3D.MaterialGroup>|Chacun <xref:System.Windows.Media.Media3D.Material> dans <xref:System.Windows.Media.Media3D.MaterialGroup> une cause un autre passage de rendu, ainsi y compris beaucoup de matériaux, même des matériaux simples, peut augmenter considérablement les demandes de remplissage sur votre GPU.  Minimisez le nombre <xref:System.Windows.Media.Media3D.MaterialGroup>de matériaux dans votre .|  
  
## <a name="performance-impact-low"></a>Impact sur la performance : faible  
  
|Propriété|Recommandation|  
|-|-|  
|<xref:System.Windows.Media.Media3D.Transform3DGroup>|Lorsque vous n’avez pas besoin d’animation ou de liaison de données, au lieu d’utiliser un groupe de transformation contenant plusieurs transformations, utilisez-le pour <xref:System.Windows.Media.Media3D.MatrixTransform3D>être le produit de toutes les transformations qui, autrement, existeraient indépendamment dans le groupe de transformation.|  
|<xref:System.Windows.Media.Media3D.Light>|Minimisez le nombre de lumières dans votre scène. Trop de lumières dans [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] une scène forcera à se replier sur le rendu logiciel.  Les limites sont d’environ 110 <xref:System.Windows.Media.Media3D.DirectionalLight> objets, 70 <xref:System.Windows.Media.Media3D.PointLight> objets ou 40 <xref:System.Windows.Media.Media3D.SpotLight> objets.|  
|<xref:System.Windows.Media.Media3D.ModelVisual3D>|Séparer les objets en mouvement des <xref:System.Windows.Media.Media3D.ModelVisual3D> objets statiques en les plaçant dans des cas distincts.  ModelVisual3D est « <xref:System.Windows.Media.Media3D.GeometryModel3D> plus lourd » que parce qu’il cache des limites transformées.  GeometryModel3D est optimisé pour être un modèle; ModelVisual3D est optimisé pour être un nœud de scène.  Utilisez ModelVisual3D pour mettre en scène des instances partagées de GeometryModel3D.|  
|<xref:System.Windows.Media.Media3D.Light>|Minimisez le nombre de fois où vous modifiez le nombre de lumières dans la scène.  Chaque changement de compte de lumière force une régénération et une recomplification d’un ombrage à moins que cette configuration n’ait existé auparavant (et a donc fait mettre en cache son ombrage).|  
|Léger|Les lumières noires ne seront pas visibles, mais elles s’ajouteront pour rendre le temps; envisager de les omettre.|  
|<xref:System.Windows.Media.Media3D.MeshGeometry3D>|Pour minimiser le temps de [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]construction de grandes collections dans , <xref:System.Windows.Media.Media3D.MeshGeometry3D.Positions%2A>comme <xref:System.Windows.Media.Media3D.MeshGeometry3D.Normals%2A> <xref:System.Windows.Media.Media3D.MeshGeometry3D.TextureCoordinates%2A>un <xref:System.Windows.Media.Media3D.MeshGeometry3D.TriangleIndices%2A>MeshGeometry3D , , , , et , pré-taille les collections avant la valeur de la population. Si possible, passez les constructeurs des collections prépeuplé les structures de données telles que les tableaux ou les listes.|  
  
## <a name="see-also"></a>Voir aussi

- [Aperçu graphique 3D](3-d-graphics-overview.md)

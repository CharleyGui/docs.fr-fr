---
title: Mpgo.exe (Outil d'optimisation guidée par profil managé)
ms.date: 03/30/2017
helpviewer_keywords:
- Mpgo.exe
- training scenarios, generating profiles with
- Managed Profile Guided Optimization Tool
- Ngen.exe
- Ngen.exe, profilers and native images
ms.assetid: f6976502-a000-4fbe-aaf5-a7aab9ce4ec2
author: mairaw
ms.author: mairaw
ms.openlocfilehash: e8c9093faa80249a2c5898c1f250e97208764be6
ms.sourcegitcommit: 289e06e904b72f34ac717dbcc5074239b977e707
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/17/2019
ms.locfileid: "71044409"
---
# <a name="mpgoexe-managed-profile-guided-optimization-tool"></a><span data-ttu-id="8f4a2-102">Mpgo.exe (Outil d'optimisation guidée par profil managé)</span><span class="sxs-lookup"><span data-stu-id="8f4a2-102">Mpgo.exe (Managed Profile Guided Optimization Tool)</span></span>

<span data-ttu-id="8f4a2-103">L’outil d’optimisation guidée par profil managé (Mpgo.exe) est un outil en ligne de commande qui utilise des scénarios d’utilisateurs finaux communs afin d’optimiser les assemblys d’images natives créés par le [générateur d’images natives (Ngen.exe)](ngen-exe-native-image-generator.md).</span><span class="sxs-lookup"><span data-stu-id="8f4a2-103">The Managed Profile Guided Optimization Tool (Mpgo.exe) is a command-line tool that uses common end-user scenarios to optimize the native image assemblies that are created by the [Native Image Generator (Ngen.exe)](ngen-exe-native-image-generator.md).</span></span> <span data-ttu-id="8f4a2-104">Cet outil vous permet d’exécuter les scénarios de formation qui génèrent des données de profil.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-104">This tool enables you to run training scenarios that generate profile data.</span></span> <span data-ttu-id="8f4a2-105">Le [générateur d’images natives (Ngen.exe)](ngen-exe-native-image-generator.md) utilise ces données pour optimiser ses assemblys d’applications d’images natives générées.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-105">The [Native Image Generator (Ngen.exe)](ngen-exe-native-image-generator.md) uses this data to optimize its generated native image application assemblies.</span></span> <span data-ttu-id="8f4a2-106">Un scénario de formation est une tentative d’exécution d’une utilisation prévue de votre application.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-106">A training scenario is a trial run of an expected use of your application.</span></span> <span data-ttu-id="8f4a2-107">Mpgo.exe est disponible dans Visual Studio Ultimate 2012 Ultimate et versions ultérieures.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-107">Mpgo.exe is available in Visual Studio Ultimate 2012 and later versions.</span></span> <span data-ttu-id="8f4a2-108">À partir de Visual Studio 2013, vous pouvez également utiliser Mpgo.exe pour optimiser les applications [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)].</span><span class="sxs-lookup"><span data-stu-id="8f4a2-108">Starting with Visual Studio 2013, you can also use Mpgo.exe to optimize [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] apps.</span></span>  
  
<span data-ttu-id="8f4a2-109">L'optimisation guidée par profil améliore le temps de démarrage de l'application, l'utilisation de la mémoire (taille de la plage de travail), et le débit en collectant les données des scénarios d'apprentissage et en les utilisant pour optimiser la disposition des images natives.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-109">Profile-guided optimization improves application startup time, memory utilization (working set size), and throughput by gathering data from training scenarios and using it to optimize the layout of native images.</span></span>  
  
<span data-ttu-id="8f4a2-110">Lorsque vous rencontrez des problèmes de performance en matière de temps de démarrage et de taille de la plage de travail pour les assemblys Intermediate Language (IL), il est recommandé d'utiliser d'abord Ngen.exe pour éliminer les coûts de compilation juste-à-temps et de simplifier le partage de code.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-110">When you encounter performance issues with startup time and working set size for Intermediate Language (IL) assemblies, we recommend that you first use Ngen.exe to eliminate just-in-time (JIT) compilation costs and to facilitate code sharing.</span></span> <span data-ttu-id="8f4a2-111">Si vous avez besoin d'autres améliorations, vous pouvez utiliser ensuite Mpgo.exe pour optimiser davantage votre application.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-111">If you need additional improvements, you can then use Mpgo.exe to further optimize your application.</span></span> <span data-ttu-id="8f4a2-112">Vous pouvez utiliser les données de performance des assemblys d'images natives non optimisés comme une référence pour évaluer les gains de performance.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-112">You can use the performance data from the un-optimized native image assemblies as a baseline to evaluate the performance gains.</span></span> <span data-ttu-id="8f4a2-113">L'utilisation de Mpgo.exe peut entraîner des temps de démarrage à froid plus rapides et une plus petite taille de la plage de travail.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-113">Using Mpgo.exe may result in faster cold startup times and a smaller working set size.</span></span> <span data-ttu-id="8f4a2-114">Mpgo.exe ajoute des informations aux assemblys IL que Ngen.exe utilise pour créer des assemblys optimisés d'images natives.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-114">Mpgo.exe adds information to IL assemblies that Ngen.exe uses to create optimized native image assemblies.</span></span> <span data-ttu-id="8f4a2-115">Pour plus d’informations, consultez l’entrée [Improving Launch Performance for your Desktop Applications](https://go.microsoft.com/fwlink/p/?LinkId=248943) dans le blog .NET.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-115">For more information, see the entry [Improving Launch Performance for your Desktop Applications](https://go.microsoft.com/fwlink/p/?LinkId=248943) in the .NET blog.</span></span>  
  
<span data-ttu-id="8f4a2-116">Cet outil est installé automatiquement avec Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-116">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="8f4a2-117">Pour exécuter l’outil, utilisez l’invite de commandes développeur pour Visual Studio (ou l’invite de commandes Visual Studio dans Windows 7) avec les informations d’identification d’administrateur, puis tapez la commande suivante à l’invite de commandes.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-117">To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7) with administrator credentials, and type the following at the command prompt.</span></span> <span data-ttu-id="8f4a2-118">Pour plus d'informations, consultez [Invites de commandes](developer-command-prompt-for-vs.md).</span><span class="sxs-lookup"><span data-stu-id="8f4a2-118">For more information, see [Command Prompts](developer-command-prompt-for-vs.md).</span></span>  
  
<span data-ttu-id="8f4a2-119">Pour les applications de bureau :</span><span class="sxs-lookup"><span data-stu-id="8f4a2-119">For desktop apps:</span></span>  
  
```console  
mpgo –Scenario <command> [-Import <directory>] –AssemblyList <assembly1>  <assembly2> ... -OutDir <directory> [options]  
```  
  
<span data-ttu-id="8f4a2-120">Pour les applications de [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] :</span><span class="sxs-lookup"><span data-stu-id="8f4a2-120">For [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] apps:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="8f4a2-121">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="8f4a2-121">Syntax</span></span>  
  
```console  
mpgo –Scenario <packageName> -AppID <appId> -Timeout <seconds>  
```  
  
## <a name="parameters"></a><span data-ttu-id="8f4a2-122">Paramètres</span><span class="sxs-lookup"><span data-stu-id="8f4a2-122">Parameters</span></span>  
 <span data-ttu-id="8f4a2-123">Tous les arguments à Mpgo.exe sont insensibles à la casse.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-123">All arguments to Mpgo.exe are case-insensitive.</span></span> <span data-ttu-id="8f4a2-124">Les commandes sont préfixées avec un tiret.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-124">Commands are prefixed with a dash.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="8f4a2-125">Vous pouvez utiliser `–Scenario` ou `–Import` comme commande obligatoire, mais pas les deux.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-125">You can use either `–Scenario` or `–Import` as a required command, but not both.</span></span> <span data-ttu-id="8f4a2-126">Aucun des paramètres requis n'est utilisé si vous spécifiez l'option `–Reset`.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-126">None of the required parameters are used if you specify the `–Reset` option.</span></span>

|<span data-ttu-id="8f4a2-127">Paramètre requis</span><span class="sxs-lookup"><span data-stu-id="8f4a2-127">Required parameter</span></span>|<span data-ttu-id="8f4a2-128">Description</span><span class="sxs-lookup"><span data-stu-id="8f4a2-128">Description</span></span>|
|------------------------|-----------------|
|<span data-ttu-id="8f4a2-129">`-Scenario` \<*commande*></span><span class="sxs-lookup"><span data-stu-id="8f4a2-129">`-Scenario` \<*command*></span></span><br /><br /> <span data-ttu-id="8f4a2-130">- ou -</span><span class="sxs-lookup"><span data-stu-id="8f4a2-130">—or—</span></span><br /><br /> <span data-ttu-id="8f4a2-131">`-Scenario` \<*nom_package*></span><span class="sxs-lookup"><span data-stu-id="8f4a2-131">`-Scenario` \<*packageName*></span></span><br /><br /> <span data-ttu-id="8f4a2-132">ou</span><span class="sxs-lookup"><span data-stu-id="8f4a2-132">-or-</span></span><br /><br /> <span data-ttu-id="8f4a2-133">`-Import` \<*répertoire*></span><span class="sxs-lookup"><span data-stu-id="8f4a2-133">`-Import` \<*directory*></span></span>|<span data-ttu-id="8f4a2-134">Pour les applications de bureau, utilisez `–Scenario` pour spécifier la commande qui doit exécuter l'application que vous voulez optimiser, y compris tous les arguments de ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-134">For desktop apps, use `–Scenario` to specify the command to run the application you want to optimize, including any command-line arguments.</span></span> <span data-ttu-id="8f4a2-135">Utilisez trois jeux de guillemets doubles autour de la *commande* si elle spécifie un chemin qui comprend des espaces, par exemple `mpgo.exe -scenario """C:\My App\myapp.exe""" -assemblylist """C:\My App\myapp.exe""" -outdir "C:\optimized files"`.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-135">Use three sets of double quotation marks around *command* if it specifies a path that includes spaces; for example: `mpgo.exe -scenario """C:\My App\myapp.exe""" -assemblylist """C:\My App\myapp.exe""" -outdir "C:\optimized files"`.</span></span> <span data-ttu-id="8f4a2-136">N’utilisez pas de guillemets doubles ; ils ne fonctionneront pas correctement si la *commande* inclut des espaces.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-136">Do not use double quotation marks; they will not work correctly if *command* includes spaces.</span></span><br /><br /> <span data-ttu-id="8f4a2-137">ou</span><span class="sxs-lookup"><span data-stu-id="8f4a2-137">-or-</span></span><br /><br /> <span data-ttu-id="8f4a2-138">Pour les applications [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)], utilisez `–Scenario` pour spécifier le package pour lequel vous voulez générer des informations de profil.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-138">For [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] apps, use `–Scenario` to specify the package that you want to generate profile information for.</span></span> <span data-ttu-id="8f4a2-139">Si vous spécifiez le nom d'affichage du package ou le nom de famille du package au lieu du nom complet du package, Mpgo.exe sélectionnera le package qui correspond au nom que vous avez fourni s'il existe une seule correspondance.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-139">If you specify the package display name or the package family name instead of the full package name, Mpgo.exe will select the package that matches the name you provided if there is only one match.</span></span> <span data-ttu-id="8f4a2-140">Si plusieurs packages correspondent au nom spécifié, Mpgo.exe vous invite à choisir un package.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-140">If multiple packages match the specified name, Mpgo.exe will prompt you to choose a package.</span></span><br /><br /> <span data-ttu-id="8f4a2-141">- ou -</span><span class="sxs-lookup"><span data-stu-id="8f4a2-141">—or—</span></span><br /><br /> <span data-ttu-id="8f4a2-142">Utilisez `-Import` pour spécifier que les données d'optimisation des assemblys précédemment optimisés doivent être utilisées pour optimiser les assemblys dans `-AssemblyList`.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-142">Use `-Import` to specify that optimization data from previously optimized assemblies should be used to optimize the assemblies in `-AssemblyList`.</span></span> <span data-ttu-id="8f4a2-143">Le *répertoire* représente le répertoire qui contient les fichiers précédemment optimisés.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-143">*directory* specifies the directory that contains the previously optimized files.</span></span> <span data-ttu-id="8f4a2-144">Les assemblys spécifiés dans `–AssemblyList` ou `–AssemblyListFile` sont les nouvelles versions d'assemblys à optimiser à l'aide des données des fichiers importés.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-144">The assemblies specified in `–AssemblyList` or `–AssemblyListFile` are the new versions of the assemblies to be optimized using the data from the imported files.</span></span> <span data-ttu-id="8f4a2-145">Utiliser des données optimisées d'une version antérieure des assemblys vous permet d'optimiser les versions plus récentes des assemblys sans réexécuter le scénario.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-145">Using optimization data from older version of assemblies enables you to optimize newer versions of assemblies without re-running the scenario.</span></span>  <span data-ttu-id="8f4a2-146">Toutefois, si les assemblys importés et les assemblys cibles incluent du code considérablement différent, les données d'optimisation seront inefficaces.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-146">However, if the imported and target assemblies include significantly different code, the optimization data will be ineffective.</span></span> <span data-ttu-id="8f4a2-147">Les noms d’assemblys spécifiés dans `–AssemblyList` ou `–AssemblyListFile` doivent être présents dans le répertoire spécifié par `–Import`*répertoire*.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-147">The assembly names specified in `–AssemblyList` or `–AssemblyListFile` must be present in the directory specified by `–Import`*directory*.</span></span> <span data-ttu-id="8f4a2-148">Utilisez trois jeux de guillemets doubles autour du *répertoire* s’il spécifie un chemin qui comprend des espaces.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-148">Use three sets of double quotation marks around *directory* if it specifies a path that includes spaces.</span></span><br /><br /> <span data-ttu-id="8f4a2-149">Vous devez spécifier `–Scenario` ou `–Import`, mais pas les deux paramètres.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-149">You must specify either `–Scenario` or `–Import`, but not both parameters.</span></span>|
|<span data-ttu-id="8f4a2-150">`-OutDir` \<*répertoire*></span><span class="sxs-lookup"><span data-stu-id="8f4a2-150">`-OutDir` \<*directory*></span></span>|<span data-ttu-id="8f4a2-151">Le répertoire dans lequel placer les assemblys optimisés.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-151">The directory in which to place the optimized assemblies.</span></span> <span data-ttu-id="8f4a2-152">Si un assembly existe déjà dans le dossier de répertoire de sortie, une copie est créée et un numéro d’index est ajouté à son nom, par exemple *nom_assembly*-1.exe.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-152">If an assembly already exists in the output directory folder, a new copy is created and an index number is appended to its name; for example: *assemblyname*-1.exe.</span></span> <span data-ttu-id="8f4a2-153">Utilisez des guillemets doubles autour du *répertoire* s’il spécifie un chemin qui comprend des espaces.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-153">Use double quotation marks around *directory* if it specifies a path that contains spaces.</span></span>|
|<span data-ttu-id="8f4a2-154">`-AssemblyList` \<*assembly1 assembly2 ...* ></span><span class="sxs-lookup"><span data-stu-id="8f4a2-154">`-AssemblyList` \<*assembly1 assembly2 ...*></span></span><br /><br /> <span data-ttu-id="8f4a2-155">- ou -</span><span class="sxs-lookup"><span data-stu-id="8f4a2-155">—or—</span></span><br /><br /> <span data-ttu-id="8f4a2-156">`-AssemblyListFile` \<*fichier*></span><span class="sxs-lookup"><span data-stu-id="8f4a2-156">`-AssemblyListFile` \<*file*></span></span>|<span data-ttu-id="8f4a2-157">Une liste d'assemblys (y compris les fichiers .exe et .dll), séparés par des espaces, dont vous voulez collecter des informations de profil.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-157">A list of assemblies (including .exe and .dll files), separated by spaces, that you want collect profile information about.</span></span> <span data-ttu-id="8f4a2-158">Vous pouvez spécifier `C:\Dir\*.dll` ou `*.dll` pour sélectionner tous les assemblys dans le répertoire de travail indiqué ou le répertoire actuel.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-158">You can specify `C:\Dir\*.dll` or `*.dll` to select all the assemblies in the designated or current working directory.</span></span> <span data-ttu-id="8f4a2-159">Pour plus d'informations, consultez la section Notes.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-159">See the Remarks section for more information.</span></span><br /><br /> <span data-ttu-id="8f4a2-160">- ou -</span><span class="sxs-lookup"><span data-stu-id="8f4a2-160">—or—</span></span><br /><br /> <span data-ttu-id="8f4a2-161">Un fichier texte contenant la liste des assemblys dont vous souhaitez collecter les informations de profil, classée avec un assembly par ligne.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-161">A text file that contains the list of assemblies you want to collect profile information about, listed one assembly per line.</span></span> <span data-ttu-id="8f4a2-162">Si un nom d'assembly commence par un trait d'union (-), utilisez une liste de fichiers d'assembly ou renommez l'assembly.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-162">If an assembly name begins with a hyphen (-), use an assembly file list or rename the assembly.</span></span>|
|<span data-ttu-id="8f4a2-163">`-AppID` \<*appId*></span><span class="sxs-lookup"><span data-stu-id="8f4a2-163">`-AppID` \<*appId*></span></span>|<span data-ttu-id="8f4a2-164">L'ID de l'application dans le package spécifié.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-164">The ID of the application in the specified package.</span></span> <span data-ttu-id="8f4a2-165">Si vous utilisez le caractère générique (\*), Mpgo.exe essaie d’énumérer les appId dans le package et revient à \<*nom_famille_packages*>!App s’il échoue.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-165">If you use the wildcard (\*), Mpgo.exe will try to enumerate the AppIDs in the package and will fall back to \<*package_family_name*>!App if it fails.</span></span> <span data-ttu-id="8f4a2-166">Si vous spécifiez une chaîne qui est précédée d’un point d’exclamation (!), Mpgo.exe concatènera le nom de famille de package avec l’argument fourni.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-166">If you specify a string that is prefixed by an exclamation point (!), Mpgo.exe will concatenate the package family name with the argument provided.</span></span>|
|<span data-ttu-id="8f4a2-167">`-Timeout` \<*secondes*></span><span class="sxs-lookup"><span data-stu-id="8f4a2-167">`-Timeout` \<*seconds*></span></span>|<span data-ttu-id="8f4a2-168">La durée d'exécution allouée à l'application [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] avant que l'application s'arrête.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-168">The amount of time to allow the [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] app to run before the app exits.</span></span>|

|<span data-ttu-id="8f4a2-169">Paramètre facultatif</span><span class="sxs-lookup"><span data-stu-id="8f4a2-169">Optional parameter</span></span>|<span data-ttu-id="8f4a2-170">Description</span><span class="sxs-lookup"><span data-stu-id="8f4a2-170">Description</span></span>|
|------------------------|-----------------|
|`-64bit`|<span data-ttu-id="8f4a2-171">Instrumente les assemblys pour les systèmes 64 bits.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-171">Instruments the assemblies for 64-bit systems.</span></span>  <span data-ttu-id="8f4a2-172">Vous devez spécifier les paramètres pour les assemblys 64 bits, même si votre assembly se déclare comme 64 bits.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-172">You must specify this parameter for 64-bit assemblies, even if your assembly declares itself as 64 bit.</span></span>|
|<span data-ttu-id="8f4a2-173">`-ExeConfig` \<*nom_fichier*></span><span class="sxs-lookup"><span data-stu-id="8f4a2-173">`-ExeConfig` \<*filename*></span></span>|<span data-ttu-id="8f4a2-174">Spécifie le fichier de configuration que votre scénario utilise pour fournir la version et les informations du chargeur.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-174">Specifies the configuration file that your scenario uses to provide version and loader information.</span></span>|
|`-f`|<span data-ttu-id="8f4a2-175">Force l'inclusion de données de profil dans un assembly binaire, même s'il est signé.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-175">Forces the inclusion of the profile data in a binary assembly, even if it's signed.</span></span>  <span data-ttu-id="8f4a2-176">Si l'assembly est signé, il doit être re-signé ; sinon, l'assembly ne chargera pas et ne fonctionnera pas.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-176">If the assembly is signed, it must be re-signed; otherwise, the assembly will fail to load and run.</span></span>|
|`-Reset`|<span data-ttu-id="8f4a2-177">Réinitialise l'environnement pour vous assurer qu'une session de profilage abandonnée n'affecte pas vos assemblys, puis se ferme.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-177">Resets the environment to make certain that an aborted profiling session doesn't affect your assemblies, and then quits.</span></span> <span data-ttu-id="8f4a2-178">L'environnement est réinitialisé par défaut avant et après une session de profilage.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-178">The environment is reset by default before and after a profiling session.</span></span>|
|<span data-ttu-id="8f4a2-179">`-Timeout` \<*temps en secondes*></span><span class="sxs-lookup"><span data-stu-id="8f4a2-179">`-Timeout` \<*time in seconds*></span></span>|<span data-ttu-id="8f4a2-180">Spécifie la durée de profilage en secondes.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-180">Specifies the profiling duration in seconds.</span></span> <span data-ttu-id="8f4a2-181">Utilisez une valeur qui est légèrement supérieure aux temps de démarrage observés pour les applications GUI.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-181">Use a value that is slightly more than your observed startup times for GUI applications.</span></span> <span data-ttu-id="8f4a2-182">À la fin du délai d'attente, les données de profil sont enregistrées bien que l'application continue à fonctionner.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-182">At the end of the time-out period, the profile data is recorded although the application continues to run.</span></span> <span data-ttu-id="8f4a2-183">Si vous ne définissez pas cette option, le profilage continue jusqu'à l'arrêt de l'application, et les données seront alors enregistrées.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-183">If you don't set this option, profiling will continue until application shutdown, at which time the data will be recorded.</span></span>|
|`-LeaveNativeImages`|<span data-ttu-id="8f4a2-184">Spécifie que les images natives instrumentées ne doivent pas être supprimées après l'exécution du scénario.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-184">Specifies that the instrumented native images shouldn't be removed after running the scenario.</span></span> <span data-ttu-id="8f4a2-185">Cette option est principalement utilisée lorsque vous exécutez l'application que avez spécifiée pour le scénario.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-185">This option is primarily used when you're getting the application that you specified for the scenario running.</span></span> <span data-ttu-id="8f4a2-186">Cela empêchera la recréation d'images natives pour les exécutions suivantes de Mpgo.exe.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-186">It will prevent the recreation of native images for subsequent runs of Mpgo.exe.</span></span> <span data-ttu-id="8f4a2-187">Lorsque vous avez terminé d'exécuter votre application, il peut y avoir des images natives orphelines dans le cache si vous spécifiez cette option.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-187">When you have finished running your application, there may be orphaned native images in the cache if you specify this option.</span></span> <span data-ttu-id="8f4a2-188">Dans ce cas, exécutez Mpgo.exe avec le même scénario et la même liste des assemblys, et utilisez le paramètre `–RemoveNativeImages` pour supprimer ces images natives.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-188">In this case, run Mpgo.exe with the same scenario and assembly list and use the `–RemoveNativeImages` parameter to remove these native images.</span></span>|
|`-RemoveNativeImages`|<span data-ttu-id="8f4a2-189">Nettoie dans une exécution où `–LeaveNativeImages` a été spécifié.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-189">Cleans up from a run where `–LeaveNativeImages` was specified.</span></span> <span data-ttu-id="8f4a2-190">Si vous spécifiez `-RemoveNativeImages`, Mpgo.exe ignore tous les arguments sauf `-64bit` et `–AssemblyList`, et s'arrête après avoir supprimé toutes les images natives instrumentées.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-190">If you specify `-RemoveNativeImages`, Mpgo.exe ignores any arguments except `-64bit` and `–AssemblyList`, and exits after removing all instrumented native images.</span></span>|

## <a name="remarks"></a><span data-ttu-id="8f4a2-191">Notes</span><span class="sxs-lookup"><span data-stu-id="8f4a2-191">Remarks</span></span>
 <span data-ttu-id="8f4a2-192">Vous pouvez utiliser `–AssemblyList` et `- AssemblyListFile` plusieurs fois sur la ligne de commande.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-192">You can use both `–AssemblyList` and `- AssemblyListFile` multiple times on the command line.</span></span>

 <span data-ttu-id="8f4a2-193">Si vous ne spécifiez pas de chemins d'accès complets en spécifiant des assemblys, Mpgo.exe recherche dans le répertoire actif.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-193">If you do not specify full path names when specifying assemblies, Mpgo.exe looks in the current directory.</span></span> <span data-ttu-id="8f4a2-194">Si vous spécifiez un chemin d'accès incorrect, Mpgo.exe affiche un message d'erreur mais continue à générer des données pour les autres assemblys.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-194">If you specify an incorrect path, Mpgo.exe displays an error message but continues to generate data for other assemblies.</span></span> <span data-ttu-id="8f4a2-195">Si vous spécifiez un assembly qui n'est pas chargé pendant le scénario d'apprentissage, aucune donnée d'apprentissage n'est générée pour cet assembly.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-195">If you specify an assembly that is not loaded during the training scenario, no training data is generated for that assembly.</span></span>

 <span data-ttu-id="8f4a2-196">Si un assembly dans la liste se trouve dans le Global Assembly Cache, il ne sera pas mis à jour pour contenir les informations du profil.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-196">If an assembly in the list is in the global assembly cache, it will not be updated to contain the profile information.</span></span>  <span data-ttu-id="8f4a2-197">Supprimez-le du Global Assembly Cache pour collecter les informations de profil.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-197">Remove it from the global assembly cache to collect profile information.</span></span>

 <span data-ttu-id="8f4a2-198">L'utilisation de Ngen.exe et de Mpgo.exe est recommandée uniquement pour les grandes applications managées, car l'avantage des images natives précompilées est généralement uniquement observé dans le cadre d'élimination de compilations JIT importantes au moment de l'exécution.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-198">The use of Ngen.exe and Mpgo.exe is recommended only for large managed applications, because the benefit of precompiled native images is typically seen only when it eliminates significant JIT compilation at run time.</span></span> <span data-ttu-id="8f4a2-199">L’exécution de Mpgo.exe sur des applications de style « Hello World » qui ne sollicitent pas trop le jeu de travail ne présente aucun avantage et Mpgo.exe peut même échouer à rassembler des données de profil.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-199">Running Mpgo.exe on "Hello World" style applications that aren’t working-set intensive will not provide any benefits, and Mpgo.exe may even fail to gather profile data.</span></span>

> [!NOTE]
> <span data-ttu-id="8f4a2-200">Ngen.exe et Mpgo.exe ne sont pas recommandés pour les applications ASP.NET et pour les services Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="8f4a2-200">Ngen.exe and Mpgo.exe are not recommended for ASP.NET applications and Windows Communication Foundation (WCF) services.</span></span>  
  
## <a name="to-use-mpgoexe"></a><span data-ttu-id="8f4a2-201">Pour utiliser Mpgo.exe</span><span class="sxs-lookup"><span data-stu-id="8f4a2-201">To Use Mpgo.exe</span></span>  
  
1. <span data-ttu-id="8f4a2-202">Utilisez un ordinateur sur lequel Visual Studio Ultimate 2012 et votre application sont installés.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-202">Use a computer that has the Visual Studio Ultimate 2012 and your application installed.</span></span>  
  
2. <span data-ttu-id="8f4a2-203">Exécutez Mpgo.exe en tant qu'administrateur avec les paramètres nécessaires.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-203">Run Mpgo.exe as an administrator with the necessary parameters.</span></span>  <span data-ttu-id="8f4a2-204">Consultez la section suivante pour les exemples de commande.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-204">See the next section for sample commands.</span></span>  
  
     <span data-ttu-id="8f4a2-205">Les assemblys IL (Intermediate Language) optimisés sont créés dans le dossier spécifié par le paramètre `–OutDir` (dans les exemples, il s'agit du dossier `C:\Optimized`).</span><span class="sxs-lookup"><span data-stu-id="8f4a2-205">The optimized intermediate language (IL) assemblies are created in the folder specified by the `–OutDir` parameter (in the examples, this is the `C:\Optimized` folder).</span></span>  
  
3. <span data-ttu-id="8f4a2-206">Remplacez les assemblys IL que vous avez utilisés pour Ngen.exe par les nouveaux assemblys IL contenant les informations de profil du répertoire spécifié par `–OutDir`.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-206">Replace the IL assemblies you used for Ngen.exe  with the new IL assemblies that contain the profile information from the directory specified by `–OutDir`.</span></span>  
  
4. <span data-ttu-id="8f4a2-207">La configuration de l'application (à l'aide des images fournies par Mpgo.exe) installera des images natives optimisées.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-207">The application setup (using the images provided by Mpgo.exe) will install optimized native images.</span></span>  
  
## <a name="suggested-workflow"></a><span data-ttu-id="8f4a2-208">Flux de travail proposé</span><span class="sxs-lookup"><span data-stu-id="8f4a2-208">Suggested Workflow</span></span>  
  
1. <span data-ttu-id="8f4a2-209">Créez un jeu d'assemblys IL optimisés à l'aide de Mpgo.exe avec le paramètre `–Scenario`.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-209">Create a set of optimized IL assemblies by using Mpgo.exe with the `–Scenario` parameter.</span></span>  
  
2. <span data-ttu-id="8f4a2-210">Vérifiez les assemblys IL optimisés dans le contrôle de code source.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-210">Check the optimized IL assemblies into source control.</span></span>  
  
3. <span data-ttu-id="8f4a2-211">Dans le processus de génération, appelez Mpgo.exe avec le paramètre `–Import` comme une étape après génération pour générer des images IL optimisées pour passer à Ngen.exe.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-211">In the build process, call Mpgo.exe with the `–Import` parameter as a post-build step to generate optimized IL images to pass to Ngen.exe.</span></span>  
  
 <span data-ttu-id="8f4a2-212">Ce processus garantit que tous les assemblys ont des données d'optimisation.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-212">This process ensures that all assemblies have optimization data.</span></span> <span data-ttu-id="8f4a2-213">Si vous enregistrez des assemblys optimisés mis à jour (étapes 1 et 2) plus fréquemment, les nombres de performance seront plus homogènes durant le développement du produit.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-213">If you check in updated optimized assemblies (steps 1 and 2) more frequently, the performance numbers will be more consistent throughout product development.</span></span>  
  
## <a name="using-mpgoexe-from-visual-studio"></a><span data-ttu-id="8f4a2-214">Utiliser Mpgo.exe depuis Visual Studio</span><span class="sxs-lookup"><span data-stu-id="8f4a2-214">Using Mpgo.exe from Visual Studio</span></span>  
 <span data-ttu-id="8f4a2-215">Vous pouvez exécuter Mpgo.exe dans Visual Studio (consultez l’article [Guide pratique pour spécifier les événements de build (C#)](/visualstudio/ide/how-to-specify-build-events-csharp)) avec les restrictions suivantes :</span><span class="sxs-lookup"><span data-stu-id="8f4a2-215">You can run Mpgo.exe from Visual Studio (see the article [How to: Specify Build Events (C#)](/visualstudio/ide/how-to-specify-build-events-csharp)) with the following restrictions:</span></span>  
  
- <span data-ttu-id="8f4a2-216">Vous ne pouvez pas utiliser les chemins d’accès entre guillemets avec des marques de barre oblique finales, car les macros Visual Studio utilisent également des marques de barre oblique finales par défaut.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-216">You cannot use quoted paths with trailing slash marks, because Visual Studio macros also use trailing slash marks by default.</span></span> <span data-ttu-id="8f4a2-217">(Par exemple, `–OutDir "C:\Output Folder\"` n'est pas valide.) Pour contourner cette restriction, évitez la barre oblique finale.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-217">(For example, `–OutDir "C:\Output Folder\"` is invalid.) To work around this restriction, you can escape the trailing slash.</span></span> <span data-ttu-id="8f4a2-218">(Par exemple, utilisez `-OutDir "$(OutDir)\"` à la place.)</span><span class="sxs-lookup"><span data-stu-id="8f4a2-218">(For example, use `-OutDir "$(OutDir)\"` instead.)</span></span>  
  
- <span data-ttu-id="8f4a2-219">Par défaut, Mpgo.exe n'est pas dans le chemin d'accès de build de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-219">By default, Mpgo.exe is not on the Visual Studio build path.</span></span> <span data-ttu-id="8f4a2-220">Vous devez soit ajouter le chemin d'accès à Visual Studio, soit spécifier le chemin d'accès complet sur la ligne de commande du Mpgo.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-220">You must either add the path to Visual Studio or specify the full path on the Mpgo command line.</span></span> <span data-ttu-id="8f4a2-221">Vous pouvez utiliser le paramètre `–Scenario` ou `–Import` dans l'événement après génération dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-221">You can use either the `–Scenario` or the `–Import` parameter in the post-build event in Visual Studio.</span></span> <span data-ttu-id="8f4a2-222">Toutefois, le processus habituel consiste à utiliser `–Scenario` une seule fois à partir de l’invite de commandes développeur pour Visual Studio, puis à utiliser `–Import` pour mettre à jour les assemblys optimisés après chaque génération, par exemple : `"C:\Program Files\Microsoft Visual Studio 11.0\Team Tools\Performance Tools\mpgo.exe" -import "$(OutDir)tmp" -assemblylist "$(TargetPath)" -outdir "$(OutDir)\"`.</span><span class="sxs-lookup"><span data-stu-id="8f4a2-222">However, the typical process is to use `–Scenario` one time from a Developer Command Prompt for Visual Studio, and then use `–Import` to update the optimized assemblies after each build; for example:  `"C:\Program Files\Microsoft Visual Studio 11.0\Team Tools\Performance Tools\mpgo.exe" -import "$(OutDir)tmp" -assemblylist "$(TargetPath)" -outdir "$(OutDir)\"`.</span></span>  
  
<a name="samples"></a>   
## <a name="examples"></a><span data-ttu-id="8f4a2-223">Exemples</span><span class="sxs-lookup"><span data-stu-id="8f4a2-223">Examples</span></span>  
 <span data-ttu-id="8f4a2-224">La commande Mpgoe.exe suivante d’une invite de commandes développeur pour Visual Studio optimise une application pour les taxes :</span><span class="sxs-lookup"><span data-stu-id="8f4a2-224">The following Mpgo.exe command from a Developer Command Prompt for Visual Studio optimizes a tax application:</span></span>  
  
```console  
mpgo –scenario "C:\MyApp\MyTax.exe /params par" –AssemblyList Mytax.dll MyTaxUtil2011.dll –OutDir C:\Optimized –TimeOut 15  
```  
  
 <span data-ttu-id="8f4a2-225">La commande Mpgo.exe suivante optimise une application pour le son :</span><span class="sxs-lookup"><span data-stu-id="8f4a2-225">The following Mpgo.exe command optimizes a sound application:</span></span>  
  
```console  
mpgo –scenario "C:\MyApp\wav2wma.exe –input song1.wav –output song1.wma" –AssemblyList transcode.dll –OutDir C:\Optimized –TimeOut 15  
```  
  
 <span data-ttu-id="8f4a2-226">La commande Mpgo.exe suivante utilise des données d'assemblys précédemment optimisés pour optimiser des versions plus récentes des assemblys :</span><span class="sxs-lookup"><span data-stu-id="8f4a2-226">The following Mpgo.exe command uses data from previously optimized assemblies to optimize newer versions of the assemblies:</span></span>  
  
```console  
mpgo.exe -import "C:\Optimized" -assemblylist "C:\MyApp\MyTax.dll" "C:\MyApp\MyTaxUtil2011.dll" -outdir C:\ReOptimized  
```  
  
## <a name="see-also"></a><span data-ttu-id="8f4a2-227">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="8f4a2-227">See also</span></span>

- [<span data-ttu-id="8f4a2-228">Ngen.exe (générateur d’images natives)</span><span class="sxs-lookup"><span data-stu-id="8f4a2-228">Ngen.exe (Native Image Generator)</span></span>](ngen-exe-native-image-generator.md)
- [<span data-ttu-id="8f4a2-229">Invites de commandes</span><span class="sxs-lookup"><span data-stu-id="8f4a2-229">Command Prompts</span></span>](developer-command-prompt-for-vs.md)
- [<span data-ttu-id="8f4a2-230">Amélioration des performances de lancement pour vos applications de bureau</span><span class="sxs-lookup"><span data-stu-id="8f4a2-230">Improving Launch Performance for your Desktop Applications</span></span>](https://go.microsoft.com/fwlink/p/?LinkId=248943)
- [<span data-ttu-id="8f4a2-231">Présentation des améliorations des performances de .NET 4.5</span><span class="sxs-lookup"><span data-stu-id="8f4a2-231">An Overview of Performance Improvements in .NET 4.5</span></span>](https://go.microsoft.com/fwlink/p/?LinkId=249131)

---
title: Aximp.exe (Windows Forms ActiveX Control Importer)
description: Comprendre Aximp.exe, l’importateur de contrôles ActiveX Windows Forms. Cet outil convertit les définitions de type dans une bibliothèque de types COM pour ActiveX en Windows Forms.
ms.date: 03/30/2017
helpviewer_keywords:
- ActiveX controls, hosting in Windows Forms
- ActiveX Control Importer
- type definitions, converting
- Aximp.exe
- Windows Forms ActiveX Control Importer
ms.assetid: 482c0d83-7144-4497-b626-87d2351b78d0
ms.openlocfilehash: d4fd6762195078963b43392178996a61f90feb94
ms.sourcegitcommit: 87cfeb69226fef01acb17c56c86f978f4f4a13db
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 07/24/2020
ms.locfileid: "87167347"
---
# <a name="aximpexe-windows-forms-activex-control-importer"></a><span data-ttu-id="5f9e1-104">Aximp.exe (Windows Forms ActiveX Control Importer)</span><span class="sxs-lookup"><span data-stu-id="5f9e1-104">Aximp.exe (Windows Forms ActiveX Control Importer)</span></span>
<span data-ttu-id="5f9e1-105">L'importateur de contrôles ActiveX convertit les définitions de types d'une bibliothèque de types COM associées à un contrôle ActiveX en un contrôle Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-105">The ActiveX Control Importer converts type definitions in a COM type library for an ActiveX control into a Windows Forms control.</span></span>  
  
 <span data-ttu-id="5f9e1-106">Windows Forms peut héberger uniquement des contrôles Windows Forms, c'est-à-dire, des classes dérivées de <xref:System.Windows.Forms.Control>.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-106">Windows Forms can only host Windows Forms controls — that is, classes that are derived from <xref:System.Windows.Forms.Control>.</span></span> <span data-ttu-id="5f9e1-107">Aximp.exe génère une classe wrapper associée à un contrôle ActiveX qui peut être hébergée dans un Windows Form.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-107">Aximp.exe generates a wrapper class for an ActiveX control that can be hosted on a Windows Form.</span></span> <span data-ttu-id="5f9e1-108">Cela vous permet d'utiliser la même prise en charge au moment du design et la même méthodologie de programmation que pour d'autres contrôles Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-108">This allows you to use the same design-time support and programming methodology applicable to other Windows Forms controls.</span></span>  
  
 <span data-ttu-id="5f9e1-109">Pour héberger le contrôle ActiveX, vous devez générer un contrôle wrapper qui dérive de <xref:System.Windows.Forms.AxHost>.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-109">To host the ActiveX control, you must generate a wrapper control that derives from <xref:System.Windows.Forms.AxHost>.</span></span> <span data-ttu-id="5f9e1-110">Ce contrôle wrapper contient une instance du contrôle ActiveX sous-jacent.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-110">This wrapper control contains an instance of the underlying ActiveX control.</span></span> <span data-ttu-id="5f9e1-111">Il sait comment communiquer avec le contrôle ActiveX, mais il se présente comme un contrôle Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-111">It knows how to communicate with the ActiveX control, but it appears as a Windows Forms control.</span></span> <span data-ttu-id="5f9e1-112">Le contrôle ainsi généré héberge le contrôle ActiveX dont il expose les propriétés, les méthodes et les événements comme si ces derniers lui appartenaient.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-112">This generated control hosts the ActiveX control and exposes its properties, methods, and events as those of the generated control.</span></span>  
  
 <span data-ttu-id="5f9e1-113">Cet outil est installé automatiquement avec Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-113">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="5f9e1-114">Pour exécuter l’outil, utilisez l’invite de commandes développeur pour Visual Studio (ou l’invite de commandes Visual Studio dans Windows 7).</span><span class="sxs-lookup"><span data-stu-id="5f9e1-114">To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="5f9e1-115">Pour plus d'informations, consultez [Invites de commandes](developer-command-prompt-for-vs.md).</span><span class="sxs-lookup"><span data-stu-id="5f9e1-115">For more information, see [Command Prompts](developer-command-prompt-for-vs.md).</span></span>  
  
 <span data-ttu-id="5f9e1-116">À l'invite de commandes, tapez :</span><span class="sxs-lookup"><span data-stu-id="5f9e1-116">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="5f9e1-117">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="5f9e1-117">Syntax</span></span>  
  
```console  
aximp [options]{file.dll | file.ocx}  
```  
  
## <a name="remarks"></a><span data-ttu-id="5f9e1-118">Notes</span><span class="sxs-lookup"><span data-stu-id="5f9e1-118">Remarks</span></span>  
  
|<span data-ttu-id="5f9e1-119">Argument</span><span class="sxs-lookup"><span data-stu-id="5f9e1-119">Argument</span></span>|<span data-ttu-id="5f9e1-120">Description</span><span class="sxs-lookup"><span data-stu-id="5f9e1-120">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="5f9e1-121">*file*</span><span class="sxs-lookup"><span data-stu-id="5f9e1-121">*file*</span></span>|<span data-ttu-id="5f9e1-122">Nom du fichier source contenant le contrôle ActiveX à convertir.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-122">The name of the source file that contains the ActiveX control to convert.</span></span> <span data-ttu-id="5f9e1-123">La valeur de cet argument doit présenter l'extension .dll ou .ocx.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-123">The file argument must have the extension .dll or .ocx.</span></span>|  
  
|<span data-ttu-id="5f9e1-124">Option</span><span class="sxs-lookup"><span data-stu-id="5f9e1-124">Option</span></span>|<span data-ttu-id="5f9e1-125">Description</span><span class="sxs-lookup"><span data-stu-id="5f9e1-125">Description</span></span>|  
|------------|-----------------|  
|`/delaysign`|<span data-ttu-id="5f9e1-126">Spécifie à Aximp.exe que le contrôle résultant doit être signé à l'aide du processus de signature différée.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-126">Specifies to Aximp.exe to sign the resulting control using delayed signing.</span></span> <span data-ttu-id="5f9e1-127">Vous devez spécifier cette option avec l’option `/keycontainer:`, `/keyfile:` ou `/publickey:`.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-127">You must specify this option with either the `/keycontainer:`, `/keyfile:`, or `/publickey:` option.</span></span> <span data-ttu-id="5f9e1-128">Pour plus d’informations sur le processus de signature différée, consultez [Temporisation de signature d’un assembly](../../standard/assembly/delay-sign.md).</span><span class="sxs-lookup"><span data-stu-id="5f9e1-128">For more information on the delayed signing process, see [Delay Signing an Assembly](../../standard/assembly/delay-sign.md).</span></span>|  
|`/help`|<span data-ttu-id="5f9e1-129">Affiche la syntaxe et les options de commande de l'outil.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-129">Displays command syntax and options for the tool.</span></span>|  
|<span data-ttu-id="5f9e1-130">`/keycontainer:` *containerName*</span><span class="sxs-lookup"><span data-stu-id="5f9e1-130">`/keycontainer:` *containerName*</span></span>|<span data-ttu-id="5f9e1-131">Signe le contrôle obtenu avec un nom fort en utilisant la paire de clés publique/privée présente dans le conteneur de clé spécifié par *nom_conteneur*.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-131">Signs the resulting control with a strong name using the public/private key pair found in the key container specified by *containerName*.</span></span>|  
|<span data-ttu-id="5f9e1-132">`/keyfile:`*nom du fichier*</span><span class="sxs-lookup"><span data-stu-id="5f9e1-132">`/keyfile:` *filename*</span></span>|<span data-ttu-id="5f9e1-133">Signe le contrôle résultant avec un nom fort en utilisant la paire de clés publique/privée officielle de l’éditeur présente dans *nom_fichier*.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-133">Signs the resulting control with a strong name using the publisher's official public/private key pair found in *filename*.</span></span>|  
|`/nologo`|<span data-ttu-id="5f9e1-134">Supprime l'affichage de la bannière de démarrage Microsoft.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-134">Suppresses the Microsoft startup banner display.</span></span>|  
|<span data-ttu-id="5f9e1-135">`/out:`*nom du fichier*</span><span class="sxs-lookup"><span data-stu-id="5f9e1-135">`/out:` *filename*</span></span>|<span data-ttu-id="5f9e1-136">Spécifie le nom de l'assembly à créer.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-136">Specifies the name of the assembly to create.</span></span>|  
|<span data-ttu-id="5f9e1-137">`/publickey:`*nom du fichier*</span><span class="sxs-lookup"><span data-stu-id="5f9e1-137">`/publickey:` *filename*</span></span>|<span data-ttu-id="5f9e1-138">Signe le contrôle résultant avec un nom fort en utilisant la clé publique présente dans le fichier spécifié par *nom_fichier*.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-138">Signs the resulting control with a strong name using the public key found in the file specified by *filename*.</span></span>|  
|<span data-ttu-id="5f9e1-139">`/rcw:`*nom du fichier*</span><span class="sxs-lookup"><span data-stu-id="5f9e1-139">`/rcw:` *filename*</span></span>|<span data-ttu-id="5f9e1-140">Utilise le wrapper RCW spécifié plutôt que d'en générer un nouveau.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-140">Uses the specified runtime callable wrapper instead of generating a new one.</span></span> <span data-ttu-id="5f9e1-141">Vous pouvez spécifier plusieurs instances.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-141">You may specify multiple instances.</span></span> <span data-ttu-id="5f9e1-142">Le répertoire actif est utilisé pour les chemins d’accès relatifs.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-142">The current directory is used for relative paths.</span></span> <span data-ttu-id="5f9e1-143">Pour plus d’informations, consultez [Wrapper pouvant être appelé par le runtime](../../standard/native-interop/runtime-callable-wrapper.md).</span><span class="sxs-lookup"><span data-stu-id="5f9e1-143">For more information, see [Runtime Callable Wrapper](../../standard/native-interop/runtime-callable-wrapper.md).</span></span>|  
|`/silent`|<span data-ttu-id="5f9e1-144">Supprime l'affichage des messages indiquant la réussite des opérations.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-144">Suppresses the display of success messages.</span></span>|  
|`/source`|<span data-ttu-id="5f9e1-145">Génère le code source C# pour le wrapper Windows Forms.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-145">Generates C# source code for the Windows Forms wrapper.</span></span>|  
|`/verbose`|<span data-ttu-id="5f9e1-146">Spécifie le mode Commentaires ; affiche des informations supplémentaires sur la progression de l'opération.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-146">Specifies verbose mode; displays additional progress information.</span></span>|  
|`/?`|<span data-ttu-id="5f9e1-147">Affiche la syntaxe et les options de commande de l'outil.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-147">Displays command syntax and options for the tool.</span></span>|  
  
 <span data-ttu-id="5f9e1-148">Aximp.exe convertit toute une bibliothèque de types de contrôles ActiveX à la fois et produit un ensemble d'assemblys contenant les métadonnées du Common Language Runtime et l'implémentation des contrôles pour les types définis dans la bibliothèque de types d'origines.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-148">Aximp.exe converts an entire ActiveX Control type library at one time and produces a set of assemblies that contain the common language runtime metadata and control implementation for the types defined in the original type library.</span></span> <span data-ttu-id="5f9e1-149">Les fichiers générés sont nommés conformément à la règle suivante :</span><span class="sxs-lookup"><span data-stu-id="5f9e1-149">The generated files are named according to the following pattern:</span></span>  
  
 <span data-ttu-id="5f9e1-150">Proxy du Common Language Runtime pour les types COM : *progid*.dll</span><span class="sxs-lookup"><span data-stu-id="5f9e1-150">common language runtime proxy for COM types: *progid*.dll</span></span>  
  
 <span data-ttu-id="5f9e1-151">Proxy Windows Forms pour les contrôles ActiveX (où Ax est l’abréviation de ActiveX) : Ax*progid*.dll</span><span class="sxs-lookup"><span data-stu-id="5f9e1-151">Windows Forms proxy for ActiveX controls (where Ax signifies ActiveX): Ax*progid*.dll</span></span>  
  
> [!NOTE]
> <span data-ttu-id="5f9e1-152">Si le nom d'un membre du contrôle ActiveX correspond à un nom défini dans le .NET Framework, Aximp.exe fait précéder le nom du membre avec « Ctl » lorsqu'il crée la classe dérivée AxHost.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-152">If the name of a member of the ActiveX control matches a name defined in the .NET Framework, Aximp.exe will prefix the member name with "Ctl" when it creates the AxHost derived class.</span></span> <span data-ttu-id="5f9e1-153">Par exemple, si votre contrôle ActiveX possède un membre nommé "Layout", il est renommé "CtlLayout" dans la classe dérivée AxHost, car l'événement Layout est défini dans le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-153">For example, if your ActiveX control has a member named "Layout," it is renamed "CtlLayout" in the AxHost derived class because the Layout event is defined within the .NET Framework.</span></span>  
  
 <span data-ttu-id="5f9e1-154">Vous pouvez examiner ces fichiers générés avec des outils comme [Ildasm.exe (Désassembleur IL)](ildasm-exe-il-disassembler.md).</span><span class="sxs-lookup"><span data-stu-id="5f9e1-154">You can examine these generated files with tools such as [Ildasm.exe (IL Disassembler)](ildasm-exe-il-disassembler.md).</span></span>  
  
 <span data-ttu-id="5f9e1-155">L'utilisation d'Aximp.exe pour générer un assembly .NET pour le contrôle ActiveX WebBrowser (shdocvw.dll) n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-155">Using Aximp.exe to generate a .NET assembly for the ActiveX WebBrowser control (shdocvw.dll) is not supported.</span></span>  
  
 <span data-ttu-id="5f9e1-156">L'exécution d'Aximp.exe sur shdocvw.dll créera toujours un autre fichier nommé shdocvw.dll dans le répertoire à partir duquel l'outil est exécuté.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-156">When you run Aximp.exe over shdocvw.dll, it will always create another file named shdocvw.dll in the directory from which the tool is run.</span></span> <span data-ttu-id="5f9e1-157">Si le fichier généré est placé dans le répertoire Documents and Settings, cela perturbe le fonctionnement de Microsoft Internet Explorer et de l'Explorateur Windows.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-157">If this generated file is placed in the Documents and Settings directory, it causes problems for Microsoft Internet Explorer and Windows Explorer.</span></span> <span data-ttu-id="5f9e1-158">Lorsque l'ordinateur est redémarré, Windows recherche une copie de shdocvw.dll dans le répertoire Documents and Settings avant de regarder dans le répertoire system32.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-158">When the computer is rebooted, Windows looks in the Documents and Settings directory before the system32 directory to find a copy of shdocvw.dll.</span></span> <span data-ttu-id="5f9e1-159">Il utilise la copie trouvée dans Documents and Settings et essaie de charger les wrappers managés.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-159">It will use the copy it finds in Documents and Settings and attempt to load the managed wrappers.</span></span> <span data-ttu-id="5f9e1-160">Internet Explorer et l'Explorateur Windows ne fonctionnent pas correctement, car ils s'appuient sur le moteur de rendu figurant dans la version de shdocvw.dll qui se trouve dans le répertoire system32.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-160">Internet Explorer and Windows Explorer will not function properly because they rely on the rendering engine in the version of shdocvw.dll located in the system32 directory.</span></span> <span data-ttu-id="5f9e1-161">Si ce problème survient, supprimez la copie de shdocvw.dll qui se trouve dans le répertoire Documents and Settings, puis redémarrez votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-161">If this problem occurs, delete the copy of shdocvw.dll in the Documents and Settings directory and reboot the computer.</span></span>  
  
 <span data-ttu-id="5f9e1-162">L'utilisation d'Aximp.exe avec shdocvw.dll pour créer un assembly .NET en vue de son utilisation dans le développement d'une application peut également poser problème.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-162">Using Aximp.exe with shdocvw.dll to create a .NET assembly for use in application development can also cause problems.</span></span> <span data-ttu-id="5f9e1-163">Dans ce cas, votre application chargera la version système de shdocvw.dll ainsi que la version générée, et pourrait donner la priorité à la version système.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-163">In this case, your application will load both the system version of shdocvw.dll and the generated version, and may give the system version priority.</span></span> <span data-ttu-id="5f9e1-164">Dans ce cas, lorsque vous essayez de charger une page web dans le contrôle webBrowser ActiveX, une boîte de dialogue Ouvrir/Enregistrer peut s’afficher.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-164">In this case, when you attempt to load a Web page inside the WebBrowser ActiveX control, users may be prompted with an Open/Save dialog box.</span></span> <span data-ttu-id="5f9e1-165">Si l’utilisateur clique sur **Ouvrir**, la page web s’ouvre dans Internet Explorer.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-165">When the user clicks **Open**, the Web page will be opened in Internet Explorer.</span></span> <span data-ttu-id="5f9e1-166">Cela ne se produit que sur les ordinateurs exécutant Internet Explorer version 6 ou antérieure.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-166">This occurs only with computers that are running Internet Explorer version 6 or earlier.</span></span> <span data-ttu-id="5f9e1-167">Pour éviter ce problème, utilisez le contrôle <xref:System.Windows.Forms.WebBrowser> managé ou Visual Studio pour générer le fichier shdocvw.dll managé, comme décrit dans [Guide pratique pour ajouter des références aux bibliothèques de types](../interop/how-to-add-references-to-type-libraries.md).</span><span class="sxs-lookup"><span data-stu-id="5f9e1-167">To prevent this problem, use the managed <xref:System.Windows.Forms.WebBrowser> control or use Visual Studio to generate the managed shdocvw.dll as described in [How to: Add References to Type Libraries](../interop/how-to-add-references-to-type-libraries.md).</span></span>  
  
## <a name="example"></a><span data-ttu-id="5f9e1-168">Exemple</span><span class="sxs-lookup"><span data-stu-id="5f9e1-168">Example</span></span>  
 <span data-ttu-id="5f9e1-169">La commande suivante génère MediaPlayer.dll et AxMediaPlayer.dll pour le contrôle Media Player `msdxm.ocx`.</span><span class="sxs-lookup"><span data-stu-id="5f9e1-169">The following command generates MediaPlayer.dll and AxMediaPlayer.dll for the Media Player control `msdxm.ocx`.</span></span>  
  
```console
aximp c:\systemroot\system32\msdxm.ocx  
```  
  
## <a name="see-also"></a><span data-ttu-id="5f9e1-170">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="5f9e1-170">See also</span></span>

- [<span data-ttu-id="5f9e1-171">outils</span><span class="sxs-lookup"><span data-stu-id="5f9e1-171">Tools</span></span>](index.md)
- [<span data-ttu-id="5f9e1-172">Ildasm.exe (Désassembleur IL)</span><span class="sxs-lookup"><span data-stu-id="5f9e1-172">Ildasm.exe (IL Disassembler)</span></span>](ildasm-exe-il-disassembler.md)

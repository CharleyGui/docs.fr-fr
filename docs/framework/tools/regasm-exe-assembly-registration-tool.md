---
title: Regasm.exe (outil Assembly Registration Tool)
ms.date: 03/30/2017
helpviewer_keywords:
- Assembly Registration tool
- assemblies [.NET Framework], registering
- Regasm.exe
- registering assemblies
ms.assetid: e190e342-36ef-4651-a0b4-0e8c2c0281cb
ms.openlocfilehash: 45b4c6c08d3afb948444a8c97dc32bd41f2615ce
ms.sourcegitcommit: 559fcfbe4871636494870a8b716bf7325df34ac5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/30/2019
ms.locfileid: "73104952"
---
# <a name="regasmexe-assembly-registration-tool"></a><span data-ttu-id="3a7fa-102">Regasm.exe (outil Assembly Registration Tool)</span><span class="sxs-lookup"><span data-stu-id="3a7fa-102">Regasm.exe (Assembly Registration Tool)</span></span>

<span data-ttu-id="3a7fa-103">L'outil Assembly Registration Tool (Inscription de l'assembly) lit les métadonnées figurant dans un assembly et ajoute les entrées nécessaires au Registre, ce qui permet aux clients COM de créer en toute transparence des classes .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-103">The Assembly Registration tool reads the metadata within an assembly and adds the necessary entries to the registry, which allows COM clients to create .NET Framework classes transparently.</span></span> <span data-ttu-id="3a7fa-104">Une fois qu'une classe est inscrite, tout client COM peut l'utiliser comme s'il s'agissait d'une classe COM.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-104">Once a class is registered, any COM client can use it as though the class were a COM class.</span></span> <span data-ttu-id="3a7fa-105">La classe fait l'objet d'une seule inscription, lors de l'installation de l'assembly.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-105">The class is registered only once, when the assembly is installed.</span></span> <span data-ttu-id="3a7fa-106">Les instances des classes figurant dans l'assembly ne peuvent pas être créées à partir de COM tant qu'elles n'ont pas été concrètement inscrites.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-106">Instances of classes within the assembly cannot be created from COM until they are actually registered.</span></span>

<span data-ttu-id="3a7fa-107">Pour exécuter l’outil, utilisez l’invite de commandes développeur pour Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-107">To run the tool, use the Developer Command Prompt for Visual Studio.</span></span> <span data-ttu-id="3a7fa-108">Pour plus d'informations, consultez [Invites de commandes](developer-command-prompt-for-vs.md).</span><span class="sxs-lookup"><span data-stu-id="3a7fa-108">For more information, see [Command Prompts](developer-command-prompt-for-vs.md).</span></span>

<span data-ttu-id="3a7fa-109">À l'invite de commandes, tapez le texte suivant :</span><span class="sxs-lookup"><span data-stu-id="3a7fa-109">At the command prompt, type the following:</span></span>

## <a name="syntax"></a><span data-ttu-id="3a7fa-110">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="3a7fa-110">Syntax</span></span>

```console
regasm assemblyFile [options]
```

## <a name="parameters"></a><span data-ttu-id="3a7fa-111">Paramètres</span><span class="sxs-lookup"><span data-stu-id="3a7fa-111">Parameters</span></span>

|<span data-ttu-id="3a7fa-112">Paramètre</span><span class="sxs-lookup"><span data-stu-id="3a7fa-112">Parameter</span></span>|<span data-ttu-id="3a7fa-113">Description</span><span class="sxs-lookup"><span data-stu-id="3a7fa-113">Description</span></span>|
|---------------|-----------------|
|<span data-ttu-id="3a7fa-114">*assemblyFile*</span><span class="sxs-lookup"><span data-stu-id="3a7fa-114">*assemblyFile*</span></span>|<span data-ttu-id="3a7fa-115">Assembly à inscrire avec COM.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-115">The assembly to be registered with COM.</span></span>|

|<span data-ttu-id="3a7fa-116">Option</span><span class="sxs-lookup"><span data-stu-id="3a7fa-116">Option</span></span>|<span data-ttu-id="3a7fa-117">Description</span><span class="sxs-lookup"><span data-stu-id="3a7fa-117">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="3a7fa-118">**/codebase**</span><span class="sxs-lookup"><span data-stu-id="3a7fa-118">**/codebase**</span></span>|<span data-ttu-id="3a7fa-119">Crée une entrée Codebase dans le Registre.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-119">Creates a Codebase entry in the registry.</span></span> <span data-ttu-id="3a7fa-120">L'entrée Codebase spécifie le chemin d'accès du fichier d'un assembly qui n'est pas installé dans le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-120">The Codebase entry specifies the file path for an assembly that is not installed in the global assembly cache.</span></span> <span data-ttu-id="3a7fa-121">Vous ne devez pas spécifier cette option si vous devez installer par la suite l'assembly que vous inscrivez dans le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-121">You should not specify this option if you will subsequently install the assembly that you are registering into the global assembly cache.</span></span> <span data-ttu-id="3a7fa-122">L’argument *assemblyFile* que vous spécifiez avec l’option **/codebase** doit être un [assembly avec nom fort](../../standard/assembly/strong-named.md).</span><span class="sxs-lookup"><span data-stu-id="3a7fa-122">The *assemblyFile* argument that you specify with the **/codebase** option must be a [strong-named assembly](../../standard/assembly/strong-named.md).</span></span>|
|<span data-ttu-id="3a7fa-123">**/registered**</span><span class="sxs-lookup"><span data-stu-id="3a7fa-123">**/registered**</span></span>|<span data-ttu-id="3a7fa-124">Spécifie que cet outil fera uniquement référence aux bibliothèques de types qui ont déjà été inscrites.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-124">Specifies that this tool will only refer to type libraries that have already been registered.</span></span>|
|<span data-ttu-id="3a7fa-125">**/asmpath:directory**</span><span class="sxs-lookup"><span data-stu-id="3a7fa-125">**/asmpath:directory**</span></span>|<span data-ttu-id="3a7fa-126">Spécifie un répertoire contenant des références d'assembly.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-126">Specifies a directory containing assembly references.</span></span> <span data-ttu-id="3a7fa-127">Doit être utilisé avec l’option **/regfile**.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-127">Must be used with the **/regfile** option.</span></span>|
|<span data-ttu-id="3a7fa-128">**/nologo**</span><span class="sxs-lookup"><span data-stu-id="3a7fa-128">**/nologo**</span></span>|<span data-ttu-id="3a7fa-129">Supprime l'affichage de la bannière de démarrage Microsoft.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-129">Suppresses the Microsoft startup banner display.</span></span>|
|<span data-ttu-id="3a7fa-130">**/regfile** [ **:** *regFile*]</span><span class="sxs-lookup"><span data-stu-id="3a7fa-130">**/regfile** [**:** *regFile*]</span></span>|<span data-ttu-id="3a7fa-131">Génère le fichier .reg spécifié pour l'assembly, qui comporte les entrées du Registre nécessaires.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-131">Generates the specified .reg file for the assembly, which contains the needed registry entries.</span></span> <span data-ttu-id="3a7fa-132">La spécification de cette option ne modifie pas le Registre.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-132">Specifying this option does not change the registry.</span></span> <span data-ttu-id="3a7fa-133">Vous ne pouvez pas utiliser cette option avec les options **/u** ou **/tlb**.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-133">You cannot use this option with the **/u** or **/tlb** options.</span></span>|
|<span data-ttu-id="3a7fa-134">**/silent** ou **/s**</span><span class="sxs-lookup"><span data-stu-id="3a7fa-134">**/silent** or **/s**</span></span>|<span data-ttu-id="3a7fa-135">Supprime l'affichage des messages indiquant la réussite des opérations.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-135">Suppresses the display of success messages.</span></span>|
|<span data-ttu-id="3a7fa-136">**/tlb** [ **:** *typeLibFile*]</span><span class="sxs-lookup"><span data-stu-id="3a7fa-136">**/tlb** [**:** *typeLibFile*]</span></span>|<span data-ttu-id="3a7fa-137">Génère, à partir de l'assembly spécifié, une bibliothèque de types comportant les définitions des types accessibles définis dans l'assembly.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-137">Generates a type library from the specified assembly containing definitions of the accessible types defined within the assembly.</span></span>|
|<span data-ttu-id="3a7fa-138">**/unregister** ou **/u**</span><span class="sxs-lookup"><span data-stu-id="3a7fa-138">**/unregister** or **/u**</span></span>|<span data-ttu-id="3a7fa-139">Annule l’inscription des classes pouvant être créées figurant dans *assemblyFile*.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-139">Unregisters the creatable classes found in *assemblyFile*.</span></span> <span data-ttu-id="3a7fa-140">Si cette option n'est pas spécifiée, Regasm.exe inscrit les classes pouvant être créées dans l'assembly.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-140">Omitting this option causes Regasm.exe to register the creatable classes in the assembly.</span></span>|
|<span data-ttu-id="3a7fa-141">**/verbose**</span><span class="sxs-lookup"><span data-stu-id="3a7fa-141">**/verbose**</span></span>|<span data-ttu-id="3a7fa-142">Spécifie le mode détaillé ; affiche la liste de tous les assemblys référencés pour lesquels une bibliothèque de types doit être générée, en cas de spécification avec l’option **/tlb**.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-142">Specifies verbose mode; displays a list of any referenced assemblies for which a type library needs to be generated, when specified with the **/tlb** option.</span></span>|
|<span data-ttu-id="3a7fa-143">**/?**</span><span class="sxs-lookup"><span data-stu-id="3a7fa-143">**/?**</span></span> <span data-ttu-id="3a7fa-144">ou **/help**</span><span class="sxs-lookup"><span data-stu-id="3a7fa-144">or **/help**</span></span>|<span data-ttu-id="3a7fa-145">Affiche la syntaxe et les options de commande de l'outil.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-145">Displays command syntax and options for the tool.</span></span>|

> [!NOTE]
> <span data-ttu-id="3a7fa-146">Les options de ligne de commande de Regasm.exe ne respectent pas la casse.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-146">The Regasm.exe command-line options are case insensitive.</span></span> <span data-ttu-id="3a7fa-147">Il vous suffit d'indiquer les éléments de l'option nécessaires à son identification de manière unique.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-147">You only need to provide enough of the option to uniquely identify it.</span></span> <span data-ttu-id="3a7fa-148">Par exemple, **/n** équivaut à **/nologo**, et **/t:** *outfile.tlb* à **/tlb:** *outfile.tlb*.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-148">For example, **/n** is equivalent to **/nologo** and **/t:** *outfile.tlb* is equivalent to **/tlb:** *outfile.tlb*.</span></span>

## <a name="remarks"></a><span data-ttu-id="3a7fa-149">Notes</span><span class="sxs-lookup"><span data-stu-id="3a7fa-149">Remarks</span></span>

<span data-ttu-id="3a7fa-150">Vous pouvez utiliser l’option **/regfile** pour générer un fichier .reg comportant les entrées du Registre plutôt que d’apporter directement les modifications au Registre.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-150">You can use the **/regfile** option to generate a .reg file that contains the registry entries instead of making the changes directly to the registry.</span></span> <span data-ttu-id="3a7fa-151">Vous pouvez mettre à jour le Registre d'un ordinateur en important le fichier .reg à l'aide de l'Éditeur du Registre (Regedit.exe).</span><span class="sxs-lookup"><span data-stu-id="3a7fa-151">You can update the registry on a computer by importing the .reg file with the Registry Editor tool (Regedit.exe).</span></span> <span data-ttu-id="3a7fa-152">Notez que le fichier .reg ne comporte pas de mises à jour du Registre pouvant être effectuées par des fonctions de Registre définies par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-152">Note that the .reg file does not contain any registry updates that can be made by user-defined register functions.</span></span>  <span data-ttu-id="3a7fa-153">Notez que l’option **/regfile** émet seulement des entrées du Registre pour les classes managées.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-153">Note that the **/regfile** option only emits registry entries for managed classes.</span></span>  <span data-ttu-id="3a7fa-154">Cette option n'émet pas d'entrée pour `TypeLibID` ou `InterfaceID`.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-154">This option does not emit entries for `TypeLibID`s or `InterfaceID`s.</span></span>

<span data-ttu-id="3a7fa-155">Quand vous spécifiez l’option **/tlb**, Regasm.exe génère et inscrit une bibliothèque de types décrivant les types figurant dans l’assembly.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-155">When you specify the **/tlb** option, Regasm.exe generates and registers a type library describing the types found in the assembly.</span></span> <span data-ttu-id="3a7fa-156">Regasm.exe place les bibliothèques de types générées dans le répertoire de travail en cours ou dans le répertoire spécifié pour le fichier de sortie.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-156">Regasm.exe places the generated type libraries in the current working directory or the directory specified for the output file.</span></span> <span data-ttu-id="3a7fa-157">La génération d'une bibliothèque de types pour un assembly référençant d'autres assemblys peut provoquer la génération de plusieurs bibliothèques de types en une seule opération.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-157">Generating a type library for an assembly that references other assemblies may cause several type libraries to be generated at once.</span></span> <span data-ttu-id="3a7fa-158">Vous pouvez utiliser la bibliothèque de types pour fournir les informations de type aux outils de développement comme Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-158">You can use the type library to provide type information to development tools like Visual Studio.</span></span> <span data-ttu-id="3a7fa-159">Vous ne devez pas utiliser l’option **/tlb** si l’assembly que vous êtes en train d’inscrire a été créé par l’importateur de bibliothèques de types ([Tlbimp.exe](tlbimp-exe-type-library-importer.md)).</span><span class="sxs-lookup"><span data-stu-id="3a7fa-159">You should not use the **/tlb** option if the assembly you are registering was produced by the Type Library Importer ([Tlbimp.exe](tlbimp-exe-type-library-importer.md)).</span></span> <span data-ttu-id="3a7fa-160">Vous ne pouvez pas exporter de bibliothèque de types à partir d'un assembly ayant été importé depuis une bibliothèque de types.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-160">You cannot export a type library from an assembly that was imported from a type library.</span></span> <span data-ttu-id="3a7fa-161">L’option **/tlb** produit le même effet que l’exportateur de bibliothèques de types ([Tlbexp.exe](tlbexp-exe-type-library-exporter.md)) et Regasm.exe, à l’exception près que Tlbexp.exe n’inscrit pas la bibliothèque de types qu’il génère.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-161">Using the **/tlb** option has the same effect as using the Type Library Exporter ([Tlbexp.exe](tlbexp-exe-type-library-exporter.md)) and Regasm.exe, with the exception that Tlbexp.exe does not register the type library it produces.</span></span>  <span data-ttu-id="3a7fa-162">Si vous utilisez l’option **/tlb** pour inscrire une bibliothèque de types, vous pouvez utiliser l’option **/tlb** avec l’option **/unregister** pour annuler l’inscription de la bibliothèque de types.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-162">If you use the **/tlb** option to registered a type library, you can use **/tlb** option with the **/unregister** option to unregistered the type library.</span></span> <span data-ttu-id="3a7fa-163">L'utilisation simultanée des deux options annulera l'inscription de la bibliothèque de types et des entrées d'interface, ce qui peut considérablement nettoyer le Registre.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-163">Using the two options together will unregister the type library and interface entries, which can clean the registry considerably.</span></span>

<span data-ttu-id="3a7fa-164">Lorsque vous inscrivez un assembly destiné à être utilisé par COM, Regasm.exe ajoute des entrées au Registre sur l'ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-164">When you register an assembly for use by COM, Regasm.exe adds entries to the registry on the local computer.</span></span> <span data-ttu-id="3a7fa-165">Plus précisément, il crée des clés de Registre dépendantes de la version qui permettent à plusieurs versions du même assembly de s'exécuter côte-à-côte sur un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-165">More specifically, it creates version-dependent registry keys that allow multiple versions of the same assembly to run side by side on a computer.</span></span> <span data-ttu-id="3a7fa-166">Lorsqu'un assembly est inscrit pour la première fois, une clé de niveau supérieur est créée pour l'assembly et une sous-clé unique est créée pour la version spécifique.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-166">The first time an assembly is registered, one top-level key is created for the assembly and a unique subkey is created for the specific version.</span></span> <span data-ttu-id="3a7fa-167">Chaque fois que vous inscrivez une nouvelle version de l'assembly, Regasm.exe crée une sous-clé pour la nouvelle version.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-167">Each time you register a new version of the assembly, Regasm.exe creates a subkey for the new version.</span></span>

<span data-ttu-id="3a7fa-168">Par exemple, imaginons un scénario dans lequel vous inscrivez le composant managé, myComp.dll, version 1.0.0.0 pour qu'il soit utilisé par COM.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-168">For example, consider a scenario where you register the managed component, myComp.dll, version 1.0.0.0 for use by COM.</span></span> <span data-ttu-id="3a7fa-169">Par la suite, vous inscrivez myComp.dll, version 2.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-169">Later, you register myComp.dll, version 2.0.0.0.</span></span> <span data-ttu-id="3a7fa-170">Vous décidez que toutes les applications clientes COM sur l'ordinateur utilisent myComp.dll version 2.0.0.0 et vous décidez d'annuler l'inscription de myComponent.dll version 1.0.0.0.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-170">You determine that all COM client applications on the computer are using myComp.dll version 2.0.0.0 and you decide to unregister myComponent.dll version 1.0.0.0.</span></span> <span data-ttu-id="3a7fa-171">Ce modèle de Registre vous permet d'annuler l'inscription de myComp.dll version 1.0.0.0, car seule la sous-clé de la version 1.0.0.0 est supprimée.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-171">This registry scheme allows you to unregister myComp.dll version 1.0.0.0 because only the version 1.0.0.0 subkey is removed.</span></span>

<span data-ttu-id="3a7fa-172">Après avoir inscrit un assembly à l’aide de Regasm.exe, vous pouvez l’installer dans le [Global Assembly Cache](../app-domains/gac.md), pour qu’il puisse être activé à partir d’un client COM.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-172">After registering an assembly using Regasm.exe, you can install it in the [global assembly cache](../app-domains/gac.md) so that it can be activated from any COM client.</span></span> <span data-ttu-id="3a7fa-173">Si l'assembly ne va être activé que par une seule application, vous pouvez alors le placer dans le répertoire de cette application.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-173">If the assembly is only going to be activated by a single application, you can place it in that application's directory.</span></span>

## <a name="examples"></a><span data-ttu-id="3a7fa-174">Exemples</span><span class="sxs-lookup"><span data-stu-id="3a7fa-174">Examples</span></span>

<span data-ttu-id="3a7fa-175">La commande suivante inscrit toutes les classes publiques figurant dans `myTest.dll`.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-175">The following command registers all public classes contained in `myTest.dll`.</span></span>

```console
regasm myTest.dll
```

<span data-ttu-id="3a7fa-176">La commande suivante génère le fichier `myTest.reg`, qui comporte toutes les entrées du Registre nécessaires.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-176">The following command generates the file `myTest.reg`, which contains all the necessary registry entries.</span></span> <span data-ttu-id="3a7fa-177">Cette commande ne met pas à jour le Registre.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-177">This command does not update the registry.</span></span>

```console
regasm myTest.dll /regfile:myTest.reg
```

<span data-ttu-id="3a7fa-178">La commande suivante inscrit toutes les classes publiques figurant dans `myTest.dll` et elle génère et inscrit la bibliothèque de types `myTest.tlb`, qui comporte les définitions de tous les types publics définis dans `myTest.dll`.</span><span class="sxs-lookup"><span data-stu-id="3a7fa-178">The following command registers all public classes contained in `myTest.dll`, and generates and registers the type library `myTest.tlb`, which contains definitions of all the public types defined in `myTest.dll`.</span></span>

```console
regasm myTest.dll /tlb:myTest.tlb
```

## <a name="see-also"></a><span data-ttu-id="3a7fa-179">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3a7fa-179">See also</span></span>

- [<span data-ttu-id="3a7fa-180">Outils</span><span class="sxs-lookup"><span data-stu-id="3a7fa-180">Tools</span></span>](index.md)
- [<span data-ttu-id="3a7fa-181">Tlbexp.exe (exportateur de bibliothèques de types)</span><span class="sxs-lookup"><span data-stu-id="3a7fa-181">Tlbexp.exe (Type Library Exporter)</span></span>](tlbexp-exe-type-library-exporter.md)
- [<span data-ttu-id="3a7fa-182">Tlbimp.exe (importateur de bibliothèques de types)</span><span class="sxs-lookup"><span data-stu-id="3a7fa-182">Tlbimp.exe (Type Library Importer)</span></span>](tlbimp-exe-type-library-importer.md)
- [<span data-ttu-id="3a7fa-183">Inscription d’assemblys dans COM</span><span class="sxs-lookup"><span data-stu-id="3a7fa-183">Registering Assemblies with COM</span></span>](../interop/registering-assemblies-with-com.md)
- [<span data-ttu-id="3a7fa-184">Invites de commandes</span><span class="sxs-lookup"><span data-stu-id="3a7fa-184">Command Prompts</span></span>](developer-command-prompt-for-vs.md)

---
title: Utilisation de WorkflowInvoker et WorkflowApplication
ms.date: 03/30/2017
ms.assetid: cd0e583c-a3f9-4fa2-b247-c7b3368c48a7
ms.openlocfilehash: 5d09fc3c902b1993b32edf3e9f92393433281636
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/12/2020
ms.locfileid: "79182704"
---
# <a name="using-workflowinvoker-and-workflowapplication"></a><span data-ttu-id="bc0b7-102">Utilisation de WorkflowInvoker et WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="bc0b7-102">Using WorkflowInvoker and WorkflowApplication</span></span>
<span data-ttu-id="bc0b7-103">Windows Workflow Foundation (WF) fournit plusieurs méthodes d’hébergement des flux de travail.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-103">Windows Workflow Foundation (WF) provides several methods of hosting workflows.</span></span> <span data-ttu-id="bc0b7-104"><xref:System.Activities.WorkflowInvoker> offre un moyen simple pour appeler un workflow comme s'il s'agissait d'un appel de méthode et ne peut être utilisé que pour les workflows qui n'utilisent pas la persistance.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-104"><xref:System.Activities.WorkflowInvoker> provides a simple way for invoking a workflow as if it were a method call and can be used only for workflows that do not use persistence.</span></span> <span data-ttu-id="bc0b7-105"><xref:System.Activities.WorkflowApplication> fournit un modèle plus riche pour exécuter des workflows, qui inclut la notification des événements de cycle de vie, le contrôle d'exécution, la modification de signet et la persistance.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-105"><xref:System.Activities.WorkflowApplication> provides a richer model for executing workflows that includes notification of lifecycle events, execution control, bookmark resumption, and persistence.</span></span> <span data-ttu-id="bc0b7-106"><xref:System.ServiceModel.Activities.WorkflowServiceHost> fournit la prise en charge des activités de messagerie et est principalement utilisé avec les services de workflow.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-106"><xref:System.ServiceModel.Activities.WorkflowServiceHost> provides support for messaging activities and is primarily used with workflow services.</span></span> <span data-ttu-id="bc0b7-107">Cette rubrique vous présente l'hébergement de workflow avec <xref:System.Activities.WorkflowInvoker> et <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-107">This topic introduces you to workflow hosting with <xref:System.Activities.WorkflowInvoker> and <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="bc0b7-108">Pour plus d’informations sur <xref:System.ServiceModel.Activities.WorkflowServiceHost>l’hébergement des flux de travail avec , voir [Workflow Services](../wcf/feature-details/workflow-services.md) et [Hosting Workflow Services Aperçu](../wcf/feature-details/hosting-workflow-services-overview.md).</span><span class="sxs-lookup"><span data-stu-id="bc0b7-108">For more information about hosting workflows with <xref:System.ServiceModel.Activities.WorkflowServiceHost>, see [Workflow Services](../wcf/feature-details/workflow-services.md) and [Hosting Workflow Services Overview](../wcf/feature-details/hosting-workflow-services-overview.md).</span></span>  
  
## <a name="using-workflowinvoker"></a><span data-ttu-id="bc0b7-109">Utilisation de WorkflowInvoker</span><span class="sxs-lookup"><span data-stu-id="bc0b7-109">Using WorkflowInvoker</span></span>  
 <span data-ttu-id="bc0b7-110"><xref:System.Activities.WorkflowInvoker> fournit un modèle pour l'exécution d'un workflow comme s'il s'agissait d'un appel de méthode.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-110"><xref:System.Activities.WorkflowInvoker> provides a model for executing a workflow as if it were a method call.</span></span> <span data-ttu-id="bc0b7-111">Pour appeler un workflow à l'aide de <xref:System.Activities.WorkflowInvoker>, appelez la méthode <xref:System.Activities.WorkflowInvoker.Invoke%2A> et passez la définition du workflow à appeler.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-111">To invoke a workflow using <xref:System.Activities.WorkflowInvoker>, call the <xref:System.Activities.WorkflowInvoker.Invoke%2A> method and pass in the workflow definition of the workflow to invoke.</span></span> <span data-ttu-id="bc0b7-112">Dans cet exemple, une activité <xref:System.Activities.Statements.WriteLine> est appelée à l'aide de <xref:System.Activities.WorkflowInvoker>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-112">In this example, a <xref:System.Activities.Statements.WriteLine> activity is invoked using <xref:System.Activities.WorkflowInvoker>.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#1](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#1)]  
  
 <span data-ttu-id="bc0b7-113">Lorsqu'un workflow est appelé à l'aide de <xref:System.Activities.WorkflowInvoker>, le workflow est exécuté sur le thread appelant et la méthode <xref:System.Activities.WorkflowInvoker.Invoke%2A> est bloquée jusqu'à ce que l'exécution du workflow soit terminée, durées d'inactivité comprises.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-113">When a workflow is invoked using <xref:System.Activities.WorkflowInvoker>, the workflow executes on the calling thread and the <xref:System.Activities.WorkflowInvoker.Invoke%2A> method blocks until the workflow is complete, including any idle time.</span></span> <span data-ttu-id="bc0b7-114">Pour configurer un intervalle de délai d'attente au cours duquel le workflow doit être exécuté, utilisez l'une des surcharges de <xref:System.Activities.WorkflowInvoker.Invoke%2A> acceptant un paramètre <xref:System.TimeSpan>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-114">To configure a time-out interval in which the workflow must complete, use one of the <xref:System.Activities.WorkflowInvoker.Invoke%2A> overloads that takes a <xref:System.TimeSpan> parameter.</span></span> <span data-ttu-id="bc0b7-115">Dans cet exemple, un workflow est appelé deux fois avec deux intervalles de délai d'attente différents.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-115">In this example, a workflow is invoked twice with two different time-out intervals.</span></span> <span data-ttu-id="bc0b7-116">Le premier workflow se termine, mais pas le second.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-116">The first workflow complets, but the second does not.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#50](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#50)]  
  
> [!NOTE]
> <span data-ttu-id="bc0b7-117"><xref:System.TimeoutException> est levée uniquement si l'intervalle de délai d'attente est écoulé et que le workflow devient inactif pendant l'exécution.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-117">The <xref:System.TimeoutException> is only thrown if the time-out interval elapses and the workflow becomes idle during execution.</span></span> <span data-ttu-id="bc0b7-118">Un flux de travail dont le délai d'exécution dépasse l'intervalle de délai d'attente spécifié se termine correctement s'il ne devient pas inactif.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-118">A workflow that takes longer than the specified time-out interval to complete completes successfully if the workflow does not become idle.</span></span>  
  
 <span data-ttu-id="bc0b7-119"><xref:System.Activities.WorkflowInvoker> fournit également des versions asynchrones de la méthode invoke.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-119"><xref:System.Activities.WorkflowInvoker> also provides asynchronous versions of the invoke method.</span></span> <span data-ttu-id="bc0b7-120">Pour plus d’informations, consultez <xref:System.Activities.WorkflowInvoker.InvokeAsync%2A> et <xref:System.Activities.WorkflowInvoker.BeginInvoke%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-120">For more information, see <xref:System.Activities.WorkflowInvoker.InvokeAsync%2A> and <xref:System.Activities.WorkflowInvoker.BeginInvoke%2A>.</span></span>  
  
### <a name="setting-input-arguments-of-a-workflow"></a><span data-ttu-id="bc0b7-121">Définition des arguments d’entrée d’un workflow</span><span class="sxs-lookup"><span data-stu-id="bc0b7-121">Setting Input Arguments of a Workflow</span></span>  
 <span data-ttu-id="bc0b7-122">Les données peuvent être passées dans un workflow à l’aide d’un dictionnaire de paramètres d’entrée, indexés par nom d’argument, qui correspondent aux arguments d’entrée du workflow.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-122">Data can be passed into a workflow using a dictionary of input parameters, keyed by argument name, that map to the input arguments of the workflow.</span></span> <span data-ttu-id="bc0b7-123">Dans cet exemple, un <xref:System.Activities.Statements.WriteLine> est appelé et la valeur de son argument <xref:System.Activities.Statements.WriteLine.Text%2A> est spécifiée à l’aide du dictionnaire de paramètres d’entrée.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-123">In this example, a <xref:System.Activities.Statements.WriteLine> is invoked and the value for its <xref:System.Activities.Statements.WriteLine.Text%2A> argument is specified using the dictionary of input parameters.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#3](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#3)]  
  
### <a name="retrieving-output-arguments-of-a-workflow"></a><span data-ttu-id="bc0b7-124">Récupération des arguments de sortie d’un workflow</span><span class="sxs-lookup"><span data-stu-id="bc0b7-124">Retrieving Output Arguments of a Workflow</span></span>  
 <span data-ttu-id="bc0b7-125">Les paramètres de sortie d'un workflow peuvent être obtenus à l'aide du dictionnaire de sorties retourné à partir de l'appel à <xref:System.Activities.WorkflowInvoker.Invoke%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-125">The output parameters of a workflow can be obtained using the outputs dictionary that is returned from the call to <xref:System.Activities.WorkflowInvoker.Invoke%2A>.</span></span> <span data-ttu-id="bc0b7-126">L’exemple suivant appelle un workflow composé d’une activité `Divide` unique qui a deux arguments d’entrée et deux arguments de sortie.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-126">The following example invokes a workflow consisting of a single `Divide` activity that has two input arguments and two output arguments.</span></span> <span data-ttu-id="bc0b7-127">Lorsque le workflow est appelé, le dictionnaire d'arguments (`arguments`) est passé ; il contient les valeurs de chaque argument d'entrée, indexées par nom d'argument.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-127">When the workflow is invoked, the `arguments` dictionary is passed which contains the values for each input argument, keyed by argument name.</span></span> <span data-ttu-id="bc0b7-128">Lors du retour de l'appel à `Invoke`, chaque argument de sortie, également indexé par nom d'argument, est retourné dans le dictionnaire `outputs`.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-128">When the call to `Invoke` returns, each output argument is returned in the `outputs` dictionary, also keyed by argument name.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#120](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#120)]  
  
 [!code-csharp[CFX_WorkflowInvokerExample#20](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#20)]  
  
 <span data-ttu-id="bc0b7-129">Si le workflow dérive de <xref:System.Activities.ActivityWithResult>, par exemple `CodeActivity<TResult>` ou `Activity<TResult>`, et qu’il existe des arguments de sortie en plus des arguments de sortie <xref:System.Activities.Activity%601.Result%2A> correctement définis, une surcharge non générique de `Invoke` doit être utilisée pour récupérer les arguments supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-129">If the workflow derives from <xref:System.Activities.ActivityWithResult>, such as `CodeActivity<TResult>` or `Activity<TResult>`, and there are output arguments in addition to the well-defined <xref:System.Activities.Activity%601.Result%2A> output argument, a non-generic overload of `Invoke` must be used in order to retrieve the additional arguments.</span></span> <span data-ttu-id="bc0b7-130">Pour ce faire, la définition de workflow passée dans `Invoke` doit être de type <xref:System.Activities.Activity>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-130">To do this, the workflow definition passed into `Invoke` must be of type <xref:System.Activities.Activity>.</span></span> <span data-ttu-id="bc0b7-131">Dans cet exemple l'activité `Divide` dérive de `CodeActivity<int>`, mais est déclarée comme <xref:System.Activities.Activity> afin qu'une surcharge non générique de `Invoke` soit utilisée, qui retourne un dictionnaire d'arguments au lieu d'une valeur de retour unique.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-131">In this example the `Divide` activity derives from `CodeActivity<int>`, but is declared as <xref:System.Activities.Activity> so that a non-generic overload of `Invoke` is used which returns a dictionary of arguments instead of a single return value.</span></span>  
  
 [!code-csharp[CFX_WorkflowInvokerExample#121](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#121)]  
  
 [!code-csharp[CFX_WorkflowInvokerExample#21](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowinvokerexample/cs/program.cs#21)]  
  
## <a name="using-workflowapplication"></a><span data-ttu-id="bc0b7-132">Utilisation de WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="bc0b7-132">Using WorkflowApplication</span></span>  
 <span data-ttu-id="bc0b7-133"><xref:System.Activities.WorkflowApplication> fournit un ensemble complet de fonctionnalités pour la gestion d'instance du workflow.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-133"><xref:System.Activities.WorkflowApplication> provides a rich set of features for workflow instance management.</span></span> <span data-ttu-id="bc0b7-134"><xref:System.Activities.WorkflowApplication> joue le rôle d'un proxy thread-safe pour le <xref:System.Activities.Hosting.WorkflowInstance> réel, qui encapsule l'exécution et fournit des méthodes pour la création et le chargement d'instances de workflow, l'interruption et la reprise, l'arrêt et la notification des événements du cycle de vie.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-134"><xref:System.Activities.WorkflowApplication> acts as a thread safe proxy to the actual  <xref:System.Activities.Hosting.WorkflowInstance>, which encapsulates the runtime, and provides methods for creating and loading workflow instances, pausing and resuming, terminating, and notification of lifecycle events.</span></span> <span data-ttu-id="bc0b7-135">Pour exécuter un workflow à l'aide de <xref:System.Activities.WorkflowApplication>, créez le <xref:System.Activities.WorkflowApplication>, abonnez-vous à tous les événements de cycle de vie souhaités, démarrez le workflow, puis attendez la fin de son exécution.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-135">To run a workflow using <xref:System.Activities.WorkflowApplication> you create the <xref:System.Activities.WorkflowApplication>, subscribe to any desired lifecycle events, start the workflow, and then wait for it to finish.</span></span> <span data-ttu-id="bc0b7-136">Dans cet exemple, une définition de workflow constituée d'une activité <xref:System.Activities.Statements.WriteLine> est créée et un <xref:System.Activities.WorkflowApplication> est créé en utilisant la définition spécifiée de workflow.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-136">In this example, a workflow definition that consists of a <xref:System.Activities.Statements.WriteLine> activity is created and a <xref:System.Activities.WorkflowApplication> is created using the specified workflow definition.</span></span> <span data-ttu-id="bc0b7-137"><xref:System.Activities.WorkflowApplication.Completed%2A> est géré afin que l'hôte soit informé lorsque le workflow se termine, le workflow démarre par un appel à <xref:System.Activities.WorkflowApplication.Run%2A>, puis l'hôte attend que le workflow se termine.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-137"><xref:System.Activities.WorkflowApplication.Completed%2A> is handled so the host is notified when the workflow completes, the workflow is started with a call to <xref:System.Activities.WorkflowApplication.Run%2A>, and then the host waits for the workflow to complete.</span></span> <span data-ttu-id="bc0b7-138">Lorsque le workflow est terminé, le <xref:System.Threading.AutoResetEvent> est défini et l'application hôte peut reprendre l'exécution, comme indiqué dans l'exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-138">When the workflow completes, the <xref:System.Threading.AutoResetEvent> is set and the host application can resume execution, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#31](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#31)]  
  
### <a name="workflowapplication-lifecycle-events"></a><span data-ttu-id="bc0b7-139">Événements de cycle de vie WorkflowApplication</span><span class="sxs-lookup"><span data-stu-id="bc0b7-139">WorkflowApplication Lifecycle Events</span></span>  
 <span data-ttu-id="bc0b7-140">En plus de <xref:System.Activities.WorkflowApplication.Completed%2A>, les auteurs d'hôte peuvent être avertis lorsqu'un workflow est déchargé (<xref:System.Activities.WorkflowApplication.Unloaded%2A>), est abandonné (<xref:System.Activities.WorkflowApplication.Aborted%2A>), devient inactif (<xref:System.Activities.WorkflowApplication.Idle%2A> et <xref:System.Activities.WorkflowApplication.PersistableIdle%2A>), ou qu'une exception non gérée se produit (<xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>).</span><span class="sxs-lookup"><span data-stu-id="bc0b7-140">In addition to <xref:System.Activities.WorkflowApplication.Completed%2A>, host authors can be notified when a workflow is unloaded (<xref:System.Activities.WorkflowApplication.Unloaded%2A>), aborted (<xref:System.Activities.WorkflowApplication.Aborted%2A>), becomes idle (<xref:System.Activities.WorkflowApplication.Idle%2A> and <xref:System.Activities.WorkflowApplication.PersistableIdle%2A>), or an unhandled exception occurs (<xref:System.Activities.WorkflowApplication.OnUnhandledException%2A>).</span></span> <span data-ttu-id="bc0b7-141">Les développeurs d'applications de workflow peuvent gérer ces notifications et agir en conséquence, comme indiqué dans l'exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-141">Workflow application developers can handle these notifications and take appropriate action, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#32](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#32)]  
  
### <a name="setting-input-arguments-of-a-workflow"></a><span data-ttu-id="bc0b7-142">Définition des arguments d’entrée d’un workflow</span><span class="sxs-lookup"><span data-stu-id="bc0b7-142">Setting Input Arguments of a Workflow</span></span>  
 <span data-ttu-id="bc0b7-143">Les données peuvent être passées dans un workflow comme il est démarré à l'aide d'un dictionnaire de paramètres, de la même façon que les données sont passées lors de l'utilisation de <xref:System.Activities.WorkflowInvoker>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-143">Data can be passed into a workflow as it is started using a dictionary of parameters, similar to the way data is passed in when using <xref:System.Activities.WorkflowInvoker>.</span></span> <span data-ttu-id="bc0b7-144">Chaque élément dans le dictionnaire correspond à un argument d’entrée du workflow spécifié.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-144">Each item in the dictionary maps to an input argument of the specified workflow.</span></span> <span data-ttu-id="bc0b7-145">Dans cet exemple, un workflow qui consiste en une activité <xref:System.Activities.Statements.WriteLine> est appelé et son argument <xref:System.Activities.Statements.WriteLine.Text%2A> est spécifié à l’aide du dictionnaire de paramètres d’entrée.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-145">In this example, a workflow that consists of a <xref:System.Activities.Statements.WriteLine> activity is invoked and its <xref:System.Activities.Statements.WriteLine.Text%2A> argument is specified using the dictionary of input parameters.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#30](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#30)]  
  
### <a name="retrieving-output-arguments-of-a-workflow"></a><span data-ttu-id="bc0b7-146">Récupération des arguments de sortie d’un workflow</span><span class="sxs-lookup"><span data-stu-id="bc0b7-146">Retrieving Output Arguments of a Workflow</span></span>  
 <span data-ttu-id="bc0b7-147">Lorsque l’exécution d’un workflow est terminée, tous les arguments de sortie peuvent être récupérés dans le gestionnaire <xref:System.Activities.WorkflowApplication.Completed%2A> en accédant au dictionnaire <xref:System.Activities.WorkflowApplicationCompletedEventArgs.Outputs%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-147">When a workflow completes, any output arguments can be retrieved in the <xref:System.Activities.WorkflowApplication.Completed%2A> handler by accessing the <xref:System.Activities.WorkflowApplicationCompletedEventArgs.Outputs%2A?displayProperty=nameWithType> dictionary.</span></span> <span data-ttu-id="bc0b7-148">L'exemple suivant héberge un workflow à l'aide de <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-148">The following example hosts a workflow using <xref:System.Activities.WorkflowApplication>.</span></span> <span data-ttu-id="bc0b7-149">Une <xref:System.Activities.WorkflowApplication> instance est construite à l’aide `DiceRoll` d’une définition de flux de travail consistant en une seule activité.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-149">A <xref:System.Activities.WorkflowApplication> instance is constructed using a workflow definition consisting of a single `DiceRoll` activity.</span></span> <span data-ttu-id="bc0b7-150">L’activité `DiceRoll` a deux arguments de sortie qui représentent les résultats du jet de dés.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-150">The `DiceRoll` activity has two output arguments that represent the results of the dice roll operation.</span></span> <span data-ttu-id="bc0b7-151">Lorsque le workflow se termine, les sorties sont récupérées dans le gestionnaire <xref:System.Activities.WorkflowApplication.Completed%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-151">When the workflow completes, the outputs are retrieved in the <xref:System.Activities.WorkflowApplication.Completed%2A> handler.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#130](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#130)]  
  
 [!code-csharp[CFX_WorkflowApplicationExample#21](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#21)]  
  
> [!NOTE]
> <span data-ttu-id="bc0b7-152"><xref:System.Activities.WorkflowApplication> et <xref:System.Activities.WorkflowInvoker> prennent un dictionnaire d'arguments d'entrée et retournent un dictionnaire d'arguments `out`.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-152"><xref:System.Activities.WorkflowApplication> and <xref:System.Activities.WorkflowInvoker> take a dictionary of input arguments and return a dictionary of `out` arguments.</span></span> <span data-ttu-id="bc0b7-153">Ces paramètres de dictionnaire, propriétés et valeurs de retour sont de type `IDictionary<string, object>`.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-153">These dictionary parameters, properties, and return values are of type `IDictionary<string, object>`.</span></span> <span data-ttu-id="bc0b7-154">L'instance réelle de la classe de dictionnaire qui est passée peut être toute classe qui implémente `IDictionary<string, object>`.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-154">The actual instance of the dictionary class that is passed in can be any class that implements `IDictionary<string, object>`.</span></span> <span data-ttu-id="bc0b7-155">Dans ces exemples, `Dictionary<string, object>` est utilisé.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-155">In these examples, `Dictionary<string, object>` is used.</span></span> <span data-ttu-id="bc0b7-156">Pour plus d’informations sur <xref:System.Collections.Generic.IDictionary%602> <xref:System.Collections.Generic.Dictionary%602>les dictionnaires, voir et .</span><span class="sxs-lookup"><span data-stu-id="bc0b7-156">For more information about dictionaries, see <xref:System.Collections.Generic.IDictionary%602> and <xref:System.Collections.Generic.Dictionary%602>.</span></span>  
  
### <a name="passing-data-into-a-running-workflow-using-bookmarks"></a><span data-ttu-id="bc0b7-157">Passage de données dans un workflow en cours d'exécution à l'aide de signets</span><span class="sxs-lookup"><span data-stu-id="bc0b7-157">Passing Data into a Running Workflow Using Bookmarks</span></span>  
 <span data-ttu-id="bc0b7-158">Les signets sont le mécanisme par lequel une activité peut attendre passivement d'être reprise et un mécanisme pour le passage de données dans une instance de workflow en cours d'exécution.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-158">Bookmarks are the mechanism by which an activity can passively wait to be resumed and are a mechanism for passing data into a running workflow instance.</span></span> <span data-ttu-id="bc0b7-159">Si une activité attend des données, elle peut créer un <xref:System.Activities.Bookmark> et inscrire une méthode de rappel à appeler lorsque le <xref:System.Activities.Bookmark> est repris, comme indiqué dans l'exemple suivant.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-159">If an activity is waiting for data, it can create a <xref:System.Activities.Bookmark> and register a callback method to be called when the <xref:System.Activities.Bookmark> is resumed, as shown in the following example.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#15](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#15)]  
  
 <span data-ttu-id="bc0b7-160">Lors de l'exécution, l'activité `ReadLine` crée un <xref:System.Activities.Bookmark>, inscrit un rappel, puis attend la reprise du <xref:System.Activities.Bookmark>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-160">When executed, the `ReadLine` activity creates a <xref:System.Activities.Bookmark>, registers a callback, and then waits for the <xref:System.Activities.Bookmark> to be resumed.</span></span> <span data-ttu-id="bc0b7-161">Lors de la reprise, l'activité `ReadLine` affecte les données passées avec le <xref:System.Activities.Bookmark> à son argument <xref:System.Activities.Activity%601.Result%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-161">When it is resumed, the `ReadLine` activity assigns the data that was passed with the <xref:System.Activities.Bookmark> to its <xref:System.Activities.Activity%601.Result%2A> argument.</span></span> <span data-ttu-id="bc0b7-162">Dans cet exemple, un workflow qui utilise l'activité `ReadLine` pour rassembler le nom de l'utilisateur et l'afficher dans la fenêtre de console est créé.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-162">In this example, a workflow is created that uses the `ReadLine` activity to gather the user’s name and display it to the console window.</span></span>  
  
 [!code-csharp[CFX_WorkflowApplicationExample#22](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#22)]  
  
 <span data-ttu-id="bc0b7-163">Lorsque l'activité `ReadLine` est exécutée, elle crée un <xref:System.Activities.Bookmark> nommé `UserName`, puis attend la reprise du signet.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-163">When the `ReadLine` activity is executed, it creates a <xref:System.Activities.Bookmark> named `UserName` and then waits for the bookmark to be resumed.</span></span> <span data-ttu-id="bc0b7-164">L'hôte recueille les données voulues, puis reprend le <xref:System.Activities.Bookmark>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-164">The host collects the desired data and then resumes the <xref:System.Activities.Bookmark>.</span></span> <span data-ttu-id="bc0b7-165">Le workflow reprend, affiche le nom, puis se termine.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-165">The workflow resumes, displays the name, and then completes.</span></span>  
  
 <span data-ttu-id="bc0b7-166">L'application hôte peut inspecter le workflow pour déterminer la présence de signets actifs.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-166">The host application can inspect the workflow to determine if there are any active bookmarks.</span></span> <span data-ttu-id="bc0b7-167">Pour ce faire, elle peut appeler la méthode <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> d'une instance <xref:System.Activities.WorkflowApplication> ou inspecter le <xref:System.Activities.WorkflowApplicationIdleEventArgs> dans le gestionnaire <xref:System.Activities.WorkflowApplication.Idle%2A>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-167">It can do this by calling the <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> method of a <xref:System.Activities.WorkflowApplication> instance, or by inspecting the <xref:System.Activities.WorkflowApplicationIdleEventArgs> in the <xref:System.Activities.WorkflowApplication.Idle%2A> handler.</span></span>  
  
 <span data-ttu-id="bc0b7-168">L'exemple de code suivant est semblable à l'exemple précédent, mais les signets actifs sont énumérés avant la reprise du signet.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-168">The following code example is like the previous example except that the active bookmarks are enumerated before the bookmark is resumed.</span></span> <span data-ttu-id="bc0b7-169">Le workflow démarre et, une fois que <xref:System.Activities.Bookmark> est créé et que le workflow est inactif, la méthode <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> est appelée.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-169">The workflow is started, and once the <xref:System.Activities.Bookmark> is created and the workflow goes idle, <xref:System.Activities.WorkflowApplication.GetBookmarks%2A> is called.</span></span> <span data-ttu-id="bc0b7-170">Lorsque le flux de travail est terminé, la sortie suivante s'affiche sur la console.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-170">When the workflow is completed, the following output is displayed to the console.</span></span>  
  
 <span data-ttu-id="bc0b7-171">**Comment vous appelez-vous ?**</span><span class="sxs-lookup"><span data-stu-id="bc0b7-171">**What is your name?**</span></span>  
<span data-ttu-id="bc0b7-172">**BookmarkName: UserName - OwnerDisplayName: ReadLine**
**Steve**
**Hello, Steve**</span><span class="sxs-lookup"><span data-stu-id="bc0b7-172">**BookmarkName: UserName - OwnerDisplayName: ReadLine**
**Steve**
**Hello, Steve**</span></span>

[!code-csharp[CFX_WorkflowApplicationExample#14](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#14)]  
  
 <span data-ttu-id="bc0b7-173">L'exemple de code suivant inspecte l'objet <xref:System.Activities.WorkflowApplicationIdleEventArgs> passé dans le gestionnaire <xref:System.Activities.WorkflowApplication.Idle%2A> d'une instance de <xref:System.Activities.WorkflowApplication>.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-173">The following code example inspects the <xref:System.Activities.WorkflowApplicationIdleEventArgs> passed into the <xref:System.Activities.WorkflowApplication.Idle%2A> handler of a <xref:System.Activities.WorkflowApplication> instance.</span></span> <span data-ttu-id="bc0b7-174">Dans cet exemple, le workflow qui devient inactif comporte un <xref:System.Activities.Bookmark> portant le nom `EnterGuess` et appartenant à une activité nommée `ReadInt`.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-174">In this example the workflow going idle has one <xref:System.Activities.Bookmark> with a name of `EnterGuess`, owned by an activity named `ReadInt`.</span></span> <span data-ttu-id="bc0b7-175">Cet exemple de code est basé sur [How to: Run a Workflow](how-to-run-a-workflow.md), qui fait partie du [tutoriel Getting Started](getting-started-tutorial.md).</span><span class="sxs-lookup"><span data-stu-id="bc0b7-175">This code example is based off of [How to: Run a Workflow](how-to-run-a-workflow.md), which is part of the [Getting Started Tutorial](getting-started-tutorial.md).</span></span> <span data-ttu-id="bc0b7-176">Si le gestionnaire <xref:System.Activities.WorkflowApplication.Idle%2A> utilisé dans cette étape est modifié de façon à contenir le code de cet exemple, la sortie suivante s'affiche.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-176">If the <xref:System.Activities.WorkflowApplication.Idle%2A> handler in that step is modified to contain the code from this example, the following output is displayed.</span></span>  
  
 <span data-ttu-id="bc0b7-177">**BookmarkName: EnterGuess - OwnerDisplayName: ReadInt**</span><span class="sxs-lookup"><span data-stu-id="bc0b7-177">**BookmarkName: EnterGuess - OwnerDisplayName: ReadInt**</span></span>

 [!code-csharp[CFX_WorkflowApplicationExample#2](~/samples/snippets/csharp/VS_Snippets_CFX/cfx_workflowapplicationexample/cs/program.cs#2)]  
  
## <a name="summary"></a><span data-ttu-id="bc0b7-178">Résumé</span><span class="sxs-lookup"><span data-stu-id="bc0b7-178">Summary</span></span>  
 <span data-ttu-id="bc0b7-179"><xref:System.Activities.WorkflowInvoker> offre un moyen simplifié d'appeler des workflows et, bien qu'il fournisse des méthodes pour le passage des données au début d'un workflow et l'extraction de données d'un workflow terminé, il ne prévoit pas de scénarios plus complexes dans lesquels <xref:System.Activities.WorkflowApplication> peut être utilisé.</span><span class="sxs-lookup"><span data-stu-id="bc0b7-179"><xref:System.Activities.WorkflowInvoker> provides a lightweight way to invoke workflows, and although it provides methods for passing data in at the start of a workflow and extracting data from a completed workflow, it does not provide for more complex scenarios which is where <xref:System.Activities.WorkflowApplication> can be used.</span></span>

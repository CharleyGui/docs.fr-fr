---
title: Architecture du client
ms.date: 03/30/2017
ms.assetid: 02624403-0d77-41cb-9a86-ab55e98c7966
ms.openlocfilehash: c873368b82551312d203eb28d208eb6e3f50c89b
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/09/2020
ms.locfileid: "84586999"
---
# <a name="client-architecture"></a><span data-ttu-id="a6a44-102">Architecture du client</span><span class="sxs-lookup"><span data-stu-id="a6a44-102">Client Architecture</span></span>
<span data-ttu-id="a6a44-103">Les applications utilisent des objets clients Windows Communication Foundation (WCF) pour appeler des opérations de service.</span><span class="sxs-lookup"><span data-stu-id="a6a44-103">Applications use Windows Communication Foundation (WCF) client objects to invoke service operations.</span></span> <span data-ttu-id="a6a44-104">Cette rubrique décrit les objets de client WCF, les canaux clients WCF et leurs relations avec l’architecture de canal sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="a6a44-104">This topic discusses WCF client objects, WCF client channels, and their relationships to the underlying channel architecture.</span></span> <span data-ttu-id="a6a44-105">Pour une vue d’ensemble des objets clients WCF, consultez [vue d’ensemble du client WCF](../wcf-client-overview.md).</span><span class="sxs-lookup"><span data-stu-id="a6a44-105">For a basic overview of WCF client objects, see [WCF Client Overview](../wcf-client-overview.md).</span></span> <span data-ttu-id="a6a44-106">Pour plus d’informations sur la couche de canal, consultez [extension de la couche de canal](../extending/extending-the-channel-layer.md).</span><span class="sxs-lookup"><span data-stu-id="a6a44-106">For more information about the channel layer, see [Extending the Channel Layer](../extending/extending-the-channel-layer.md).</span></span>  
  
## <a name="overview"></a><span data-ttu-id="a6a44-107">Vue d’ensemble</span><span class="sxs-lookup"><span data-stu-id="a6a44-107">Overview</span></span>  
 <span data-ttu-id="a6a44-108">L’heure d’exécution du modèle de service crée des clients WCF, qui sont composés des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="a6a44-108">The service model run time creates WCF clients, which are composed of the following:</span></span>  
  
- <span data-ttu-id="a6a44-109">Implémentation de client générée automatiquement d'un contrat de service qui transforme les appels de votre code d'application en messages sortants, les messages de réponse en paramètres de sortie et retourne des valeurs pouvant être récupérées par votre application.</span><span class="sxs-lookup"><span data-stu-id="a6a44-109">An automatically generated client implementation of a service contract, which turns calls from your application code into outgoing messages, and turns response messages into output parameters and return values that your application can retrieve.</span></span>  
  
- <span data-ttu-id="a6a44-110">Implémentation d'une interface de contrôle (<xref:System.ServiceModel.IClientChannel?displayProperty=nameWithType>) qui regroupe différentes interfaces et fournit l'accès au contrôle des fonctionnalités, plus précisément aux fonctionnalités permettant de fermer la session client et de déployer le canal.</span><span class="sxs-lookup"><span data-stu-id="a6a44-110">An implementation of a control interface (<xref:System.ServiceModel.IClientChannel?displayProperty=nameWithType>) that groups together various interfaces and provides access to control functionality, most notably the ability to close the client session and dispose the channel.</span></span>  
  
- <span data-ttu-id="a6a44-111">Canal de client construit en fonction des paramètres de configuration spécifiés par la liaison utilisée.</span><span class="sxs-lookup"><span data-stu-id="a6a44-111">A client channel that is built based on the configuration settings specified by the used binding.</span></span>  
  
 <span data-ttu-id="a6a44-112">Les applications peuvent créer de tels clients à la demande, à l’aide d’un <xref:System.ServiceModel.ChannelFactory?displayProperty=nameWithType> ou en créant une instance d’une <xref:System.ServiceModel.ClientBase%601> classe dérivée telle qu’elle est générée par l' [outil ServiceModel Metadata Utility Tool (Svcutil. exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md).</span><span class="sxs-lookup"><span data-stu-id="a6a44-112">Applications can create such clients on demand, either through a <xref:System.ServiceModel.ChannelFactory?displayProperty=nameWithType> or by creating an instance of a <xref:System.ServiceModel.ClientBase%601> derived class as it is generated by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span> <span data-ttu-id="a6a44-113">Ces classes de client déjà construites encapsulent une implémentation de canal de client construite dynamiquement par un <xref:System.ServiceModel.ChannelFactory> et délèguent vers cette implémentation.</span><span class="sxs-lookup"><span data-stu-id="a6a44-113">These ready-built client classes encapsulate and delegate to a client channel implementation that is dynamically constructed by a <xref:System.ServiceModel.ChannelFactory>.</span></span> <span data-ttu-id="a6a44-114">Par conséquent, cette rubrique traite principalement des canaux de client et de la fabrication de canal à leur origine.</span><span class="sxs-lookup"><span data-stu-id="a6a44-114">Therefore, the client channel and the channel factory that produces them are the focal point of interest for this discussion.</span></span>  
  
## <a name="client-objects-and-client-channels"></a><span data-ttu-id="a6a44-115">Objets et canaux de client</span><span class="sxs-lookup"><span data-stu-id="a6a44-115">Client Objects and Client Channels</span></span>  
 <span data-ttu-id="a6a44-116">L’interface de base des clients WCF est l' <xref:System.ServiceModel.IClientChannel?displayProperty=nameWithType> interface, qui expose les fonctionnalités principales du client ainsi que les fonctionnalités d’objet de communication de base de <xref:System.ServiceModel.ICommunicationObject?displayProperty=nameWithType> , la fonctionnalité de contexte de <xref:System.ServiceModel.IContextChannel?displayProperty=nameWithType> et le comportement extensible de <xref:System.ServiceModel.IExtensibleObject%601?displayProperty=nameWithType> .</span><span class="sxs-lookup"><span data-stu-id="a6a44-116">The base interface of WCF clients is the <xref:System.ServiceModel.IClientChannel?displayProperty=nameWithType> interface, which exposes core client functionality as well as the basic communication object functionality of <xref:System.ServiceModel.ICommunicationObject?displayProperty=nameWithType>, the context functionality of <xref:System.ServiceModel.IContextChannel?displayProperty=nameWithType>, and the extensible behavior of <xref:System.ServiceModel.IExtensibleObject%601?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="a6a44-117">Toutefois, l'interface <xref:System.ServiceModel.IClientChannel> ne définit pas de contrat de service.</span><span class="sxs-lookup"><span data-stu-id="a6a44-117">The <xref:System.ServiceModel.IClientChannel> interface, however, does not define a service contract itself.</span></span> <span data-ttu-id="a6a44-118">Ceux-ci sont déclarés par l’interface de contrat de service (généralement générée à partir de métadonnées de service à l’aide d’un outil tel que [ServiceModel Metadata Utility Tool (Svcutil. exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md)).</span><span class="sxs-lookup"><span data-stu-id="a6a44-118">Those are declared by the service contract interface (typically generated from service metadata using a tool like the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../servicemodel-metadata-utility-tool-svcutil-exe.md)).</span></span> <span data-ttu-id="a6a44-119">Les types de clients WCF étendent <xref:System.ServiceModel.IClientChannel> à la fois et l’interface de contrat de service cible pour permettre aux applications d’appeler des opérations directement et d’avoir accès aux fonctionnalités d’exécution côté client.</span><span class="sxs-lookup"><span data-stu-id="a6a44-119">WCF client types extend both <xref:System.ServiceModel.IClientChannel> and the target service contract interface to enable applications to call operations directly and also have access to client-side run-time functionality.</span></span> <span data-ttu-id="a6a44-120">La création d’un client WCF fournit <xref:System.ServiceModel.ChannelFactory?displayProperty=nameWithType> des objets WCF avec les informations nécessaires pour créer une exécution qui peut se connecter et interagir avec le point de terminaison de service configuré.</span><span class="sxs-lookup"><span data-stu-id="a6a44-120">Creating an WCF client provides WCF<xref:System.ServiceModel.ChannelFactory?displayProperty=nameWithType> objects with the information necessary to create a run time that can connect and interact with the configured service endpoint.</span></span>  
  
 <span data-ttu-id="a6a44-121">Comme mentionné précédemment, les deux types de clients WCF doivent être configurés avant de pouvoir être utilisés.</span><span class="sxs-lookup"><span data-stu-id="a6a44-121">As mentioned earlier, the two WCF client types must be configured before you can use them.</span></span> <span data-ttu-id="a6a44-122">Les types de clients WCF les plus simples sont des objets qui dérivent de <xref:System.ServiceModel.ClientBase%601> (ou <xref:System.ServiceModel.DuplexClientBase%601> si le contrat de service est un contrat duplex).</span><span class="sxs-lookup"><span data-stu-id="a6a44-122">The simplest WCF client types are objects that derive from <xref:System.ServiceModel.ClientBase%601> (or <xref:System.ServiceModel.DuplexClientBase%601> if the service contract is a duplex contract).</span></span> <span data-ttu-id="a6a44-123">Vous pouvez créer ces types en utilisant un constructeur (ou un fichier de configuration) configuré par un programme, puis appelé directement pour appeler les opérations de service.</span><span class="sxs-lookup"><span data-stu-id="a6a44-123">You can create these types by using a constructor, configured programmatically, or by using a configuration file, and then called directly to invoke service operations.</span></span> <span data-ttu-id="a6a44-124">Pour une vue d’ensemble des <xref:System.ServiceModel.ClientBase%601> objets, consultez [vue d’ensemble du client WCF](../wcf-client-overview.md).</span><span class="sxs-lookup"><span data-stu-id="a6a44-124">For a basic overview of <xref:System.ServiceModel.ClientBase%601> objects, see [WCF Client Overview](../wcf-client-overview.md).</span></span>  
  
 <span data-ttu-id="a6a44-125">Le second type est généré pendant l'exécution depuis un appel de la méthode <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A>.</span><span class="sxs-lookup"><span data-stu-id="a6a44-125">The second type is generated at run time from a call to the <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A> method.</span></span> <span data-ttu-id="a6a44-126">Les applications concernées par un contrôle étroit des caractéristiques de communication utilisent généralement ce type de client, appelé *objet de canal client*, car il permet une interaction plus directe que le système d’exécution de client sous-jacent et le système de canaux.</span><span class="sxs-lookup"><span data-stu-id="a6a44-126">Applications concerned with tight control of the communication specifics typically use this client type, called a *client channel object*, because it enables more direct interaction than the underlying client run-time and channel system.</span></span>  
  
## <a name="channel-factories"></a><span data-ttu-id="a6a44-127">Fabrication de canal</span><span class="sxs-lookup"><span data-stu-id="a6a44-127">Channel Factories</span></span>  
 <span data-ttu-id="a6a44-128">La classe qui est chargée de créer le processus d'exécution sous-jacent prenant en charge les appels de client correspond à <xref:System.ServiceModel.ChannelFactory%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="a6a44-128">The class that is responsible for creating the underlying run time that supports client invocations is the <xref:System.ServiceModel.ChannelFactory%601?displayProperty=nameWithType> class.</span></span> <span data-ttu-id="a6a44-129">Les objets de client WCF et les objets de canal client WCF utilisent un <xref:System.ServiceModel.ChannelFactory%601> objet pour créer des instances ; l' <xref:System.ServiceModel.ClientBase%601> objet client dérivé encapsule la gestion de la fabrique de canal, mais pour un certain nombre de scénarios, il est tout à fait raisonnable d’utiliser la fabrique de canal directement.</span><span class="sxs-lookup"><span data-stu-id="a6a44-129">Both WCF client objects and WCF client channel objects use a <xref:System.ServiceModel.ChannelFactory%601> object to create instances; the <xref:System.ServiceModel.ClientBase%601> derived client object encapsulates the handling of the channel factory, but for a number of scenarios it is perfectly reasonable to use the channel factory directly.</span></span> <span data-ttu-id="a6a44-130">Vous souhaiterez le plus souvent créer à plusieurs reprises de nouveaux canaux de client à partir de la fabrication de canal existante.</span><span class="sxs-lookup"><span data-stu-id="a6a44-130">The common scenario for this is if you want to repeatedly create new client channels from an existing factory.</span></span> <span data-ttu-id="a6a44-131">Si vous utilisez un objet client, vous pouvez obtenir la fabrique de canal sous-jacente à partir d’un objet client WCF en appelant la <xref:System.ServiceModel.ClientBase%601.ChannelFactory%2A?displayProperty=nameWithType> propriété.</span><span class="sxs-lookup"><span data-stu-id="a6a44-131">If you are using a client object, you can obtain the underlying channel factory from a WCF client object by calling the <xref:System.ServiceModel.ClientBase%601.ChannelFactory%2A?displayProperty=nameWithType> property.</span></span>  
  
 <span data-ttu-id="a6a44-132">Concernant les fabrications de canaux, il est important de garder à l'esprit qu'elles créent des nouvelles instances de canaux de client pour la configuration fournie avant l'appel de la méthode <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="a6a44-132">The important thing to remember about channel factories is that they create new instances of client channels for the configuration provided to them prior to calling <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="a6a44-133">Une fois que vous avez appelé <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A> (ou <xref:System.ServiceModel.ClientBase%601.Open%2A?displayProperty=nameWithType> , <xref:System.ServiceModel.ClientBase%601.CreateChannel%2A?displayProperty=nameWithType> ou toute opération sur un objet client WCF), vous ne pouvez pas modifier la fabrique de canaux et vous attendre à obtenir des canaux pour différentes instances de service, même si vous modifiez simplement l’adresse du point de terminaison cible.</span><span class="sxs-lookup"><span data-stu-id="a6a44-133">Once you call <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A> (or <xref:System.ServiceModel.ClientBase%601.Open%2A?displayProperty=nameWithType>, <xref:System.ServiceModel.ClientBase%601.CreateChannel%2A?displayProperty=nameWithType>, or any operation on a WCF client object), you cannot modify the channel factory and expect to get channels to different service instances, even if you are merely changing the target endpoint address.</span></span> <span data-ttu-id="a6a44-134">Si vous souhaitez créer un objet de client ou un canal de client avec une configuration différente, vous devez d'abord créer une nouvelle fabrication de canal.</span><span class="sxs-lookup"><span data-stu-id="a6a44-134">If you want to create a client object or client channel with a different configuration, you must create a new channel factory first.</span></span>  
  
 <span data-ttu-id="a6a44-135">Pour plus d’informations sur les différents problèmes liés à l’utilisation d’objets clients WCF et de canaux clients WCF, consultez [accès aux services à l’aide d’un client WCF](accessing-services-using-a-client.md).</span><span class="sxs-lookup"><span data-stu-id="a6a44-135">For more information about various issues using WCF client objects and WCF client channels, see [Accessing Services Using a WCF Client](accessing-services-using-a-client.md).</span></span>  
  
 <span data-ttu-id="a6a44-136">Les deux sections suivantes décrivent la création et l’utilisation d’objets de canal client WCF.</span><span class="sxs-lookup"><span data-stu-id="a6a44-136">The following two sections describe the creation and use of WCF client channel objects.</span></span>  
  
#### <a name="creating-a-new-wcf-client-channel-object"></a><span data-ttu-id="a6a44-137">Création d'un nouvel objet de canal de client WCF</span><span class="sxs-lookup"><span data-stu-id="a6a44-137">Creating a New WCF Client Channel Object</span></span>  
 <span data-ttu-id="a6a44-138">Dans notre exemple illustrant l'utilisation d'un canal de client, nous supposons que le contrat de service suivant a été généré.</span><span class="sxs-lookup"><span data-stu-id="a6a44-138">To illustrate the use of a client channel, assume the following service contract has been generated.</span></span>  
  
 [!code-csharp[C_GeneratedCodeFiles#12](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_generatedcodefiles/cs/proxycode.cs#12)]  
  
 <span data-ttu-id="a6a44-139">Pour vous connecter à un service `ISampleService`, utilisez l'interface de contrat générée directement avec une fabrication de canal (<xref:System.ServiceModel.ChannelFactory%601>).</span><span class="sxs-lookup"><span data-stu-id="a6a44-139">To connect to an `ISampleService` service, use the generated contract interface directly with a channel factory (<xref:System.ServiceModel.ChannelFactory%601>).</span></span> <span data-ttu-id="a6a44-140">Après avoir créé et configuré une fabrication de canal pour un contrat particulier, vous pouvez appeler la méthode <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A> pour retourner des objets de canal de client qui vous permettront de communiquer avec un service `ISampleService`.</span><span class="sxs-lookup"><span data-stu-id="a6a44-140">Once you create and configure a channel factory for a particular contract, you can call the <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A> method to return client channel objects that you can use to communicate with an `ISampleService` service.</span></span>  
  
 <span data-ttu-id="a6a44-141">Lorsque vous utilisez la classe <xref:System.ServiceModel.ChannelFactory%601> avec une interface de contrat de service, vous devez effectuer une conversion de type dans l'interface <xref:System.ServiceModel.IClientChannel> pour ouvrir, fermer ou abandonner le canal de manière explicite.</span><span class="sxs-lookup"><span data-stu-id="a6a44-141">When using the <xref:System.ServiceModel.ChannelFactory%601> class with a service contract interface, you must cast to the <xref:System.ServiceModel.IClientChannel> interface to explicitly open, close, or abort the channel.</span></span> <span data-ttu-id="a6a44-142">Pour faciliter son utilisation, l'outil Svcutil.exe génère également une interface d'assistance qui implémente à la fois l'interface de contrat de service et <xref:System.ServiceModel.IClientChannel> afin de vous permettre d'interagir avec l'infrastructure de canal client sans devoir convertir de type.</span><span class="sxs-lookup"><span data-stu-id="a6a44-142">To make it easier to work with, the Svcutil.exe tool also generates a helper interface that implements both the service contract interface and <xref:System.ServiceModel.IClientChannel> to enable you to interact with the client channel infrastructure without having to cast.</span></span> <span data-ttu-id="a6a44-143">Le code suivant illustre la définition d'un canal client d'assistance qui implémente le contrat de service précédent.</span><span class="sxs-lookup"><span data-stu-id="a6a44-143">The following code shows the definition of a helper client channel that implements the preceding service contract.</span></span>  
  
 [!code-csharp[C_GeneratedCodeFiles#13](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_generatedcodefiles/cs/proxycode.cs#13)]  
  
#### <a name="creating-a-new-wcf-client-channel-object"></a><span data-ttu-id="a6a44-144">Création d'un nouvel objet de canal de client WCF</span><span class="sxs-lookup"><span data-stu-id="a6a44-144">Creating a New WCF Client Channel Object</span></span>  
 <span data-ttu-id="a6a44-145">Pour utiliser un canal client et se connecter à un service `ISampleService`, utilisez directement l’interface de contrat générée (ou la version d’assistance) avec une fabrication de canal, en passant le type de l’interface de contrat comme paramètre de type.</span><span class="sxs-lookup"><span data-stu-id="a6a44-145">To use a client channel to connect to an `ISampleService` service, use the generated contract interface (or the helper version) directly with a channel factory, passing the type of the contract interface as the type parameter.</span></span> <span data-ttu-id="a6a44-146">Après avoir créé et configuré une fabrication de canal pour un contrat particulier, vous pouvez appeler la méthode <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType> pour retourner des objets de canal client qui vous permettront de communiquer avec un service `ISampleService`.</span><span class="sxs-lookup"><span data-stu-id="a6a44-146">Once a channel factory for a particular contract has been created and configured, you can call the <xref:System.ServiceModel.ChannelFactory%601.CreateChannel%2A?displayProperty=nameWithType> method to return client channel objects that you can use to communicate with an `ISampleService` service.</span></span>  
  
 <span data-ttu-id="a6a44-147">Une fois créés, les objets de canal de client implémentent <xref:System.ServiceModel.IClientChannel> ainsi que l'interface de contrat.</span><span class="sxs-lookup"><span data-stu-id="a6a44-147">When created, the client channel objects implement <xref:System.ServiceModel.IClientChannel> and the contract interface.</span></span> <span data-ttu-id="a6a44-148">Par conséquent, vous pouvez les utiliser directement pour appeler les opérations qui interagissent avec un service prenant en charge le contrat.</span><span class="sxs-lookup"><span data-stu-id="a6a44-148">Therefore, you can use them directly to call operations that interact with a service that supports that contract.</span></span>  
  
 <span data-ttu-id="a6a44-149">La différence entre les objets de client et les objets de canal de client réside dans leurs modalités de contrôle et leur simplicité d'utilisation.</span><span class="sxs-lookup"><span data-stu-id="a6a44-149">The difference between using client objects and client channel objects is merely one of control and ease of use for developers.</span></span> <span data-ttu-id="a6a44-150">De nombreux développeurs qui sont à l’aise avec l’utilisation des classes et des objets préfèrent utiliser l’objet client WCF au lieu du canal client WCF.</span><span class="sxs-lookup"><span data-stu-id="a6a44-150">Many developers who are comfortable working with classes and objects will prefer to use the WCF client object instead of the WCF client channel.</span></span>  
  
 <span data-ttu-id="a6a44-151">Pour obtenir un exemple, consultez [Comment : utiliser ChannelFactory](how-to-use-the-channelfactory.md).</span><span class="sxs-lookup"><span data-stu-id="a6a44-151">For an example, see [How to: Use the ChannelFactory](how-to-use-the-channelfactory.md).</span></span>

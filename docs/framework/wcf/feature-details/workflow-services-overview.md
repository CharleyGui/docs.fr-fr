---
title: Présentation des services de workflow
ms.date: 03/30/2017
ms.assetid: e536dda3-e286-441e-99a7-49ddc004b646
ms.openlocfilehash: f752eca621f9d30f38d85d7e71228fdfe1343c32
ms.sourcegitcommit: cdb295dd1db589ce5169ac9ff096f01fd0c2da9d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/09/2020
ms.locfileid: "84594866"
---
# <a name="workflow-services-overview"></a><span data-ttu-id="eb74a-102">Présentation des services de workflow</span><span class="sxs-lookup"><span data-stu-id="eb74a-102">Workflow services overview</span></span>

<span data-ttu-id="eb74a-103">Les services de workflow sont des services basés sur WCF qui sont implémentés à l’aide de workflows.</span><span class="sxs-lookup"><span data-stu-id="eb74a-103">Workflow services are WCF-based services that are implemented using workflows.</span></span> <span data-ttu-id="eb74a-104">Les services de workflow sont des flux de travail qui utilisent les activités de messagerie pour envoyer et recevoir des messages Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="eb74a-104">Workflow services are workflows that use the messaging activities to send and receive Windows Communication Foundation (WCF) messages.</span></span> <span data-ttu-id="eb74a-105">.NET Framework 4.5 introduit plusieurs activités de messagerie qui vous permettent d'envoyer et de recevoir des messages à partir d'un workflow.</span><span class="sxs-lookup"><span data-stu-id="eb74a-105">.NET Framework 4.5 introduces a number of messaging activities that allow you send and receive messages from within a workflow.</span></span> <span data-ttu-id="eb74a-106">Pour plus d’informations sur les activités de messagerie et la façon dont elles peuvent être utilisées pour implémenter différents modèles d’échange de messages, consultez [activités de messagerie](messaging-activities.md).</span><span class="sxs-lookup"><span data-stu-id="eb74a-106">For more information about messaging activities and how they can be used to implement different message exchange patterns, see [Messaging Activities](messaging-activities.md).</span></span>

## <a name="benefits-of-using-workflow-services"></a><span data-ttu-id="eb74a-107">Avantages de l’utilisation des services de workflow</span><span class="sxs-lookup"><span data-stu-id="eb74a-107">Benefits of using workflow services</span></span>

<span data-ttu-id="eb74a-108">Les applications étant de plus en plus distribuées, les services individuels sont désormais chargés d'appeler d'autres services pour alléger en partie la tâche.</span><span class="sxs-lookup"><span data-stu-id="eb74a-108">As applications become increasingly distributed, individual services become responsible for calling other services to offload some of the work.</span></span> <span data-ttu-id="eb74a-109">Implémenter ces appels en tant qu'opérations asynchrones rend le code plus complexe.</span><span class="sxs-lookup"><span data-stu-id="eb74a-109">Implementing these calls as asynchronous operations introduces some complexity into the code.</span></span> <span data-ttu-id="eb74a-110">La gestion des erreurs ajoute une complexité supplémentaire, sous la forme d'une gestion des exceptions et de la fourniture d'informations de suivi détaillées.</span><span class="sxs-lookup"><span data-stu-id="eb74a-110">Error handling adds additional complexity in the form of handling exceptions and providing detailed tracking information.</span></span> <span data-ttu-id="eb74a-111">Certains services ont souvent une durée d'exécution longue et peuvent consommer de précieuses ressources système à attendre une entrée.</span><span class="sxs-lookup"><span data-stu-id="eb74a-111">Some services are often long running and can take up valuable system resources while waiting for input.</span></span> <span data-ttu-id="eb74a-112">En raison de ces problèmes, les applications distribuées sont souvent très complexes, difficiles à écrire et à maintenir.</span><span class="sxs-lookup"><span data-stu-id="eb74a-112">Because of these issues, distributed applications are often very complex and difficult to write and maintain.</span></span> <span data-ttu-id="eb74a-113">Les workflows constituent une méthode naturelle pour exprimer la coordination de travail asynchrone, notamment les appels aux services externes.</span><span class="sxs-lookup"><span data-stu-id="eb74a-113">Workflows are a natural way to express the coordination of asynchronous work, especially calls to external services.</span></span> <span data-ttu-id="eb74a-114">Les workflows sont également efficaces pour représenter des processus d'entreprise de longue durée.</span><span class="sxs-lookup"><span data-stu-id="eb74a-114">Workflows are also effective at representing long-running business processes.</span></span> <span data-ttu-id="eb74a-115">Ces qualités font du workflow une ressource importante pour la construction de services dans un environnement distribué.</span><span class="sxs-lookup"><span data-stu-id="eb74a-115">It is these qualities that make the workflow a great asset to building services in a distributed environment.</span></span>

## <a name="implementing-a-workflow-service"></a><span data-ttu-id="eb74a-116">Implémentation d’un service de workflow</span><span class="sxs-lookup"><span data-stu-id="eb74a-116">Implementing a workflow service</span></span>

<span data-ttu-id="eb74a-117">Lors de l’implémentation d’un service WCF, vous définissez un certain nombre de contrats qui décrivent le service et les données qu’il envoie et reçoit.</span><span class="sxs-lookup"><span data-stu-id="eb74a-117">When implementing a WCF service, you define a number of contracts that describe the service and the data that it sends and receives.</span></span> <span data-ttu-id="eb74a-118">Les données sont représentées en tant que contrats de données et contrats de message.</span><span class="sxs-lookup"><span data-stu-id="eb74a-118">The data is represented as data contracts and message contracts.</span></span> <span data-ttu-id="eb74a-119">Les services WCF et les services de workflow utilisent tous des définitions de contrat de données et de contrat de message dans le cadre des descriptions du service.</span><span class="sxs-lookup"><span data-stu-id="eb74a-119">Both WCF and workflow services use data contract and message contract definitions as part of service descriptions.</span></span> <span data-ttu-id="eb74a-120">Le service lui-même expose des métadonnées (au format WSDL) pour décrire les opérations du service.</span><span class="sxs-lookup"><span data-stu-id="eb74a-120">The service itself exposes metadata (in the form of WSDL) to describe the operations of the service.</span></span> <span data-ttu-id="eb74a-121">Dans WCF, les contrats de service et les contrats d'opération définissent le service et les opérations qu'il prend en charge.</span><span class="sxs-lookup"><span data-stu-id="eb74a-121">In WCF, service contracts and operation contracts define the service and the operations it supports.</span></span> <span data-ttu-id="eb74a-122">Toutefois dans un service de workflow, ces contrats font partie du processus d'entreprise lui-même.</span><span class="sxs-lookup"><span data-stu-id="eb74a-122">However in a workflow service, these contracts are part of the business process itself.</span></span> <span data-ttu-id="eb74a-123">Ils sont exposés dans les métadonnées par un processus appelé l'inférence de contrat.</span><span class="sxs-lookup"><span data-stu-id="eb74a-123">They are exposed in metadata by a process called contract inference.</span></span> <span data-ttu-id="eb74a-124">Lorsqu'un service de workflow est hébergé à l'aide d'un objet <xref:System.ServiceModel.Activities.WorkflowServiceHost>, la définition du workflow est examinée et un contrat est généré en fonction du jeu d'activités de messagerie qui se trouvent dans le workflow.</span><span class="sxs-lookup"><span data-stu-id="eb74a-124">When a workflow service is hosted using <xref:System.ServiceModel.Activities.WorkflowServiceHost>, the workflow definition is examined and a contract is generated based on the set of messaging activities found in the workflow.</span></span> <span data-ttu-id="eb74a-125">Plus particulièrement, les activités et les propriétés suivantes sont utilisées pour générer le contrat :</span><span class="sxs-lookup"><span data-stu-id="eb74a-125">In particular, the following activities and properties are used to generate the contract:</span></span>

<span data-ttu-id="eb74a-126"><xref:System.ServiceModel.Activities.Receive> Activité</span><span class="sxs-lookup"><span data-stu-id="eb74a-126"><xref:System.ServiceModel.Activities.Receive> Activity</span></span>

- <xref:System.ServiceModel.Activities.Receive.ServiceContractName%2A>

- <xref:System.ServiceModel.Activities.Receive.OperationName%2A>

- <xref:System.ServiceModel.Activities.Receive.Action%2A>

<span data-ttu-id="eb74a-127"><xref:System.ServiceModel.Activities.SendReply> Activité</span><span class="sxs-lookup"><span data-stu-id="eb74a-127"><xref:System.ServiceModel.Activities.SendReply> Activity</span></span>

- <xref:System.ServiceModel.Activities.SendReply.Action%2A>

<span data-ttu-id="eb74a-128"><xref:System.ServiceModel.Activities.TransactedReceiveScope> Activité</span><span class="sxs-lookup"><span data-stu-id="eb74a-128"><xref:System.ServiceModel.Activities.TransactedReceiveScope> Activity</span></span>

<span data-ttu-id="eb74a-129">Le résultat final de l’inférence de contrat est une description du service utilisant les mêmes structures de données que les services WCF et les contrats d’opération.</span><span class="sxs-lookup"><span data-stu-id="eb74a-129">The end result of contract inference is a description of the service using the same data structures as WCF services and operation contracts.</span></span> <span data-ttu-id="eb74a-130">Puis ces informations sont utilisées pour exposer WSDL pour le service de workflow.</span><span class="sxs-lookup"><span data-stu-id="eb74a-130">This information is then used to expose WSDL for the workflow service.</span></span>

> [!NOTE]
> [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)] <span data-ttu-id="eb74a-131">ne vous permet pas d'écrire des services de workflow à l'aide d'une définition de contrat existante, sans une prise en charge d'outils supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="eb74a-131">does not allow you to write workflow services using an existing contract definition without some additional tooling support.</span></span> <span data-ttu-id="eb74a-132">Les contrats du service de workflow sont créés par le processus d'inférence de contrat présenté précédemment.</span><span class="sxs-lookup"><span data-stu-id="eb74a-132">Workflow service contracts are created by the contract inference process discussed previously.</span></span> <span data-ttu-id="eb74a-133">Les contrats de message et les contrats de données sont toutefois entièrement pris en charge.</span><span class="sxs-lookup"><span data-stu-id="eb74a-133">Message contracts and data contracts are fully supported, however.</span></span>

## <a name="workflow-services-and-msmq-based-bindings"></a><span data-ttu-id="eb74a-134">Services de workflow et liaisons basées sur MSMQ</span><span class="sxs-lookup"><span data-stu-id="eb74a-134">Workflow services and MSMQ-based bindings</span></span>

<span data-ttu-id="eb74a-135">WCF définit deux liaisons <xref:System.ServiceModel.NetMsmqBinding> et <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding> basées sur MSMQ.</span><span class="sxs-lookup"><span data-stu-id="eb74a-135">WCF defines two MSMQ-based bindings <xref:System.ServiceModel.NetMsmqBinding> and <xref:System.ServiceModel.MsmqIntegration.MsmqIntegrationBinding>.</span></span>  <span data-ttu-id="eb74a-136">Les liaisons basées sur MSMQ sont souvent utilisées avec les services de workflow en raison de la longue durée d’exécution de ces services.</span><span class="sxs-lookup"><span data-stu-id="eb74a-136">MSMQ-based bindings are often used with workflow services because of the long-running nature of such services.</span></span> <span data-ttu-id="eb74a-137">Les liaisons basées sur MSMQ ont une propriété `ValidityDuration` qui spécifie comment de temps les messages MSMQ peuvent supposer être valides.</span><span class="sxs-lookup"><span data-stu-id="eb74a-137">The MSMQ-based bindings have a `ValidityDuration` property that specifies how long MSMQ messages can assume to be valid.</span></span> <span data-ttu-id="eb74a-138">En raison de la longue durée d'exécution des services de workflow, il est possible que la durée de validité d'un message MSMQ expire avant que le service de workflow puisse le traiter.</span><span class="sxs-lookup"><span data-stu-id="eb74a-138">Because of the long running nature of workflow services it is possible that the validity duration of a MSMQ message may elapse before the workflow service can process it.</span></span> <span data-ttu-id="eb74a-139">Il est donc très important d’affecter une valeur appropriée à la durée de validité d’une liaison MSMQ.</span><span class="sxs-lookup"><span data-stu-id="eb74a-139">It is therefore very important to set the validity duration of a MSMQ binding to an appropriate value.</span></span> <span data-ttu-id="eb74a-140">Cette valeur doit être choisie en fonction du workflow et de sa manière de traiter les messages.</span><span class="sxs-lookup"><span data-stu-id="eb74a-140">This value must be chosen based on the workflow and how it processes messages.</span></span> <span data-ttu-id="eb74a-141">Par exemple si vous avez un workflow avec une activité <xref:System.ServiceModel.Activities.Receive> suivie d'une activité personnalisée qui s'exécute pendant 10 minutes, elle-même suivie d'une autre activité <xref:System.ServiceModel.Activities.Receive>, la valeur correcte pour `ValidityDuration` doit être supérieure à 10 minutes.</span><span class="sxs-lookup"><span data-stu-id="eb74a-141">For example if you have a workflow with a <xref:System.ServiceModel.Activities.Receive> activity followed by a custom activity that takes 10 minutes to run, followed by another <xref:System.ServiceModel.Activities.Receive> activity, the correct value for `ValidityDuration` would be greater than 10 minutes.</span></span>

## <a name="hosting-a-workflow-service"></a><span data-ttu-id="eb74a-142">Hébergement d’un service de workflow</span><span class="sxs-lookup"><span data-stu-id="eb74a-142">Hosting a workflow service</span></span>

<span data-ttu-id="eb74a-143">Comme les services WCF, les services de workflow doivent être hébergés.</span><span class="sxs-lookup"><span data-stu-id="eb74a-143">Like WCF services, workflow services must be hosted.</span></span> <span data-ttu-id="eb74a-144">Les services WCF utilisent la <xref:System.ServiceModel.ServiceHost> classe pour héberger des services et des services de flux <xref:System.ServiceModel.Activities.WorkflowServiceHost> de travail à utiliser pour héberger des services.</span><span class="sxs-lookup"><span data-stu-id="eb74a-144">WCF services use the <xref:System.ServiceModel.ServiceHost> class to host services and workflow services use <xref:System.ServiceModel.Activities.WorkflowServiceHost> to host services.</span></span> <span data-ttu-id="eb74a-145">Comme les services WCF, les services de workflow peuvent être hébergés de différentes façons, par exemple :</span><span class="sxs-lookup"><span data-stu-id="eb74a-145">Like WCF services, workflow services can be hosted in a variety of ways, for example:</span></span>

- <span data-ttu-id="eb74a-146">Dans une application .NET Framework gérée.</span><span class="sxs-lookup"><span data-stu-id="eb74a-146">In a managed .NET Framework application.</span></span>

- <span data-ttu-id="eb74a-147">Dans les Services IIS (Internet Information Services).</span><span class="sxs-lookup"><span data-stu-id="eb74a-147">In Internet Information Services (IIS).</span></span>

- <span data-ttu-id="eb74a-148">dans le service d'activation des processus Windows (WAS, Windows Process Activation Service) ;</span><span class="sxs-lookup"><span data-stu-id="eb74a-148">In Windows Process Activation Service (WAS).</span></span>

- <span data-ttu-id="eb74a-149">dans un service Windows managé.</span><span class="sxs-lookup"><span data-stu-id="eb74a-149">In a managed Windows Service.</span></span>

<span data-ttu-id="eb74a-150">Les services de flux de travail hébergés dans une application .NET Frameworke managée ou un service Windows managé créent une instance de la <xref:System.ServiceModel.Activities.WorkflowServiceHost> classe et lui passent une instance du <xref:System.ServiceModel.Activities.WorkflowService> qui contient la définition de workflow dans la <xref:System.ServiceModel.Activities.WorkflowService.Body%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="eb74a-150">Workflow services hosted in a managed .NET Framework application or a managed Windows service create an instance of the <xref:System.ServiceModel.Activities.WorkflowServiceHost> class and pass it an instance of the <xref:System.ServiceModel.Activities.WorkflowService> that contains the workflow definition within the <xref:System.ServiceModel.Activities.WorkflowService.Body%2A> property.</span></span> <span data-ttu-id="eb74a-151">Une définition de workflow contenant des activités de messagerie est exposée en tant que service de workflow.</span><span class="sxs-lookup"><span data-stu-id="eb74a-151">A workflow definition that contains messaging activities is exposed as a workflow service.</span></span>

<span data-ttu-id="eb74a-152">Pour héberger un service de workflow dans les services IIS ou WAS, placez dans un répertoire virtuel le fichier .xamlx qui contient la définition du service de workflow.</span><span class="sxs-lookup"><span data-stu-id="eb74a-152">To host a workflow service in IIS or WAS, place the .xamlx file that contains the workflow service definition into a virtual directory.</span></span> <span data-ttu-id="eb74a-153">Un point de terminaison par défaut (à l’aide <xref:System.ServiceModel.BasicHttpBinding> de) est créé automatiquement pour plus d’informations, consultez [configuration simplifiée](../simplified-configuration.md).</span><span class="sxs-lookup"><span data-stu-id="eb74a-153">A default endpoint (using <xref:System.ServiceModel.BasicHttpBinding>) is created automatically For more information, see [Simplified Configuration](../simplified-configuration.md).</span></span> <span data-ttu-id="eb74a-154">Vous pouvez également placer un fichier Web.config dans le répertoire virtuel pour spécifier vos propres points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="eb74a-154">You can also place a Web.config file in the virtual directory to specify your own endpoints.</span></span> <span data-ttu-id="eb74a-155">Si votre définition de workflow se trouve dans un assembly, vous pouvez placer un fichier .svc dans le répertoire virtuel et l'assembly de workflow dans le répertoire App_Code.</span><span class="sxs-lookup"><span data-stu-id="eb74a-155">If your workflow definition is in an assembly you can place a .svc file in the virtual directory and the workflow assembly in the App_Code directory.</span></span> <span data-ttu-id="eb74a-156">Le fichier .svc doit spécifier la fabrique hôte de service et la classe qui implémente le service de workflow.</span><span class="sxs-lookup"><span data-stu-id="eb74a-156">The .svc file must specify the service host factory and the class that implements the workflow service.</span></span> <span data-ttu-id="eb74a-157">L'exemple suivant montre comment spécifier la fabrique hôte de service et la classe qui implémente le service de workflow.</span><span class="sxs-lookup"><span data-stu-id="eb74a-157">The following example shows how to specify the service host factory and specify the class that implements the workflow service.</span></span>

```
<%@ServiceHost Factory=" System.ServiceModel.Activities.Activation.WorkflowServiceHostFactory
Service="EchoService"%>
```

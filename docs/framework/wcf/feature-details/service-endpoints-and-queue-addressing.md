---
title: Points de terminaison de service et adressage de files d'attente
ms.date: 03/30/2017
ms.assetid: 7d2d59d7-f08b-44ed-bd31-913908b83d97
ms.openlocfilehash: 8b323993a698dac219e0f2be43e9b508a19065dd
ms.sourcegitcommit: 71b8f5a2108a0f1a4ef1d8d75c5b3e129ec5ca1e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/29/2020
ms.locfileid: "84202423"
---
# <a name="service-endpoints-and-queue-addressing"></a><span data-ttu-id="f1b0e-102">Points de terminaison de service et adressage de files d'attente</span><span class="sxs-lookup"><span data-stu-id="f1b0e-102">Service Endpoints and Queue Addressing</span></span>
<span data-ttu-id="f1b0e-103">Cette rubrique discute comment les clients adressent des services qui lisent à partir des files d'attente et comment les points de terminaison de service mappent aux files d'attente.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-103">This topic discusses how clients address services that read from queues and how service endpoints map to queues.</span></span> <span data-ttu-id="f1b0e-104">En guise de rappel, l’illustration suivante montre le déploiement d’applications en file d’attente Classic Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="f1b0e-104">As a reminder, the following illustration shows the classic Windows Communication Foundation (WCF) queued application deployment.</span></span>  
  
 <span data-ttu-id="f1b0e-105">![Diagramme d'application mise en file d'attente](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "File d’attente distribuée-figure")</span><span class="sxs-lookup"><span data-stu-id="f1b0e-105">![Queued Application Diagram](../../../../docs/framework/wcf/feature-details/media/distributed-queue-figure.jpg "Distributed-Queue-Figure")</span></span>  
  
 <span data-ttu-id="f1b0e-106">Pour pouvoir adresser le message au service, le client adresse le message à la file d'attente cible.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-106">For the client to send the message to the service, the client addresses the message to the Target Queue.</span></span> <span data-ttu-id="f1b0e-107">Pour pouvoir lire des messages depuis la file d'attente, il définit son adresse d'écoute à la file d'attente cible.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-107">For the service to read messages from the queue, it sets its listen address to the Target Queue.</span></span> <span data-ttu-id="f1b0e-108">L’adressage dans WCF est Uniform Resource Identifier (URI), tandis que les noms de files d’attente Message Queuing (MSMQ) ne sont pas basés sur un URI.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-108">Addressing in WCF is Uniform Resource Identifier (URI)-based while Message Queuing (MSMQ) queue names are not URI-based.</span></span> <span data-ttu-id="f1b0e-109">C’est pourquoi il est essentiel de comprendre comment traiter les files d’attente créées dans MSMQ à l’aide de WCF.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-109">It is therefore essential to understand how to address queues created in MSMQ using WCF.</span></span>  
  
## <a name="msmq-addressing"></a><span data-ttu-id="f1b0e-110">Adressage MSMQ</span><span class="sxs-lookup"><span data-stu-id="f1b0e-110">MSMQ Addressing</span></span>  
 <span data-ttu-id="f1b0e-111">MSMQ utilise des chemins d'accès et des noms de format pour identifier une file d'attente.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-111">MSMQ uses paths and format names to identify a queue.</span></span> <span data-ttu-id="f1b0e-112">Les chemins d’accès spécifient un nom d’hôte et un `QueueName`.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-112">Paths specify a host name and a `QueueName`.</span></span> <span data-ttu-id="f1b0e-113">Éventuellement, il peut y avoir un `Private$` entre le nom d'hôte et le `QueueName` pour indiquer une file d'attente privée qui n'est pas publiée dans le service d'annuaire Active Directory.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-113">Optionally, there can be a `Private$` between the host name and the `QueueName` to indicate a private queue that is not published in the Active Directory directory service.</span></span>  
  
 <span data-ttu-id="f1b0e-114">Les noms de chemin d’accès sont mappés à « FormatNames » pour déterminer des aspects supplémentaires de l’adresse, y compris le protocole de routage et le protocole de transfert du gestionnaire de files d’attente.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-114">Path names are mapped to "FormatNames" to determine additional aspects of the address, including routing and queue manager transfer protocol.</span></span> <span data-ttu-id="f1b0e-115">Le Gestionnaire de files d'attente prend en charge deux protocoles de transfert : le protocole MSMQ natif et le protocole SRMP (SOAP Reliable Messaging Protocol).</span><span class="sxs-lookup"><span data-stu-id="f1b0e-115">The Queue Manager supports two transfer protocols: native MSMQ protocol and SOAP Reliable Messaging Protocol (SRMP).</span></span>  
  
 <span data-ttu-id="f1b0e-116">Pour plus d’informations sur le chemin d’accès et les noms de format MSMQ, consultez [à propos de Message Queuing](https://docs.microsoft.com/previous-versions/windows/desktop/legacy/ms706032(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="f1b0e-116">For more information about MSMQ path and format names, see [About Message Queuing](https://docs.microsoft.com/previous-versions/windows/desktop/legacy/ms706032(v=vs.85)).</span></span>  
  
## <a name="netmsmqbinding-and-service-addressing"></a><span data-ttu-id="f1b0e-117">NetMsmqBinding et adressage de service</span><span class="sxs-lookup"><span data-stu-id="f1b0e-117">NetMsmqBinding and Service Addressing</span></span>  
 <span data-ttu-id="f1b0e-118">Lors de l'adressage d'un message à un service, le schéma dans l'URI est choisi en fonction du transport utilisé pour la communication.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-118">When addressing a message to a service, the scheme in the URI is chosen based on the transport used for communication.</span></span> <span data-ttu-id="f1b0e-119">Chaque transport dans WCF possède un schéma unique.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-119">Each transport in WCF has a unique scheme.</span></span> <span data-ttu-id="f1b0e-120">Le schéma doit refléter la nature du transport utilisé pour la communication.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-120">The scheme must reflect the nature of transport used for communication.</span></span> <span data-ttu-id="f1b0e-121">Par exemple, net.tcp, net.pipe, HTTP, et ainsi de suite.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-121">For example, net.tcp, net.pipe, HTTP, and so on.</span></span>  
  
 <span data-ttu-id="f1b0e-122">Le transport MSMQ mis en file d’attente dans WCF expose un schéma net. MSMQ.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-122">The MSMQ queued transport in WCF exposes a net.msmq scheme.</span></span> <span data-ttu-id="f1b0e-123">Tout message adressé à l'aide du schéma net.msmq est envoyé à l'aide du `NetMsmqBinding` sur le canal de transport de mise en file d'attente MSMQ.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-123">Any message addressed using the net.msmq scheme is sent using the `NetMsmqBinding` over the MSMQ queued transport channel.</span></span>  
  
 <span data-ttu-id="f1b0e-124">L’adressage d’une file d’attente dans WCF est basé sur le modèle suivant :</span><span class="sxs-lookup"><span data-stu-id="f1b0e-124">The addressing of a queue in WCF is based on the following pattern:</span></span>  
  
 <span data-ttu-id="f1b0e-125">NET. msmq:// \<*host-name*> /[Private/]\<*queue-name*></span><span class="sxs-lookup"><span data-stu-id="f1b0e-125">net.msmq: // \<*host-name*> / [private/] \<*queue-name*></span></span>  
  
 <span data-ttu-id="f1b0e-126">où :</span><span class="sxs-lookup"><span data-stu-id="f1b0e-126">where:</span></span>  
  
- <span data-ttu-id="f1b0e-127">\<*host-name*>nom de l’ordinateur qui héberge la file d’attente cible.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-127">\<*host-name*> is the name of the machine that hosts the Target Queue.</span></span>  
  
- <span data-ttu-id="f1b0e-128">[private] est facultatif.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-128">[private] is optional.</span></span> <span data-ttu-id="f1b0e-129">Il est utilisé lors de l'adressage d'une file d'attente cible qui est une file d'attente privée.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-129">It is used when addressing a Target Queue that is a private queue.</span></span> <span data-ttu-id="f1b0e-130">Pour adresser une file d'attente publique, vous ne devez pas spécifier private.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-130">To address a public queue, you must not specify private.</span></span> <span data-ttu-id="f1b0e-131">Notez que, contrairement aux chemins d’accès MSMQ, il n’y a pas de « $ » dans le format d’URI WCF.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-131">Note that, unlike MSMQ paths, there is no "$" in the WCF URI form.</span></span>  
  
- <span data-ttu-id="f1b0e-132">\<*queue-name*>nom de la file d’attente.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-132">\<*queue-name*> is the name of the queue.</span></span> <span data-ttu-id="f1b0e-133">Le nom de la file d'attente peut également faire référence à une sous-file d'attente.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-133">The queue name can also refer to a subqueue.</span></span> <span data-ttu-id="f1b0e-134">Ainsi, \<*queue-name*>  =  \<*name-of-queue*> [;\* nom de la sous-file d’attente\*].</span><span class="sxs-lookup"><span data-stu-id="f1b0e-134">Thus, \<*queue-name*> = \<*name-of-queue*>[;*sub-queue-name*].</span></span>  
  
 <span data-ttu-id="f1b0e-135">Exemple 1 : pour adresser une file d'attente privée PurchaseOrders hébergée sur l'ordinateur abc atadatum.com, l'URI serait net.msmq://abc.adatum.com/private/PurchaseOrders.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-135">Example1: To address a private queue PurchaseOrders hosted on computer abc atadatum.com, the URI would be net.msmq://abc.adatum.com/private/PurchaseOrders.</span></span>  
  
 <span data-ttu-id="f1b0e-136">Exemple 2 : pour adresser une file d'attente AccountsPayable publique hébergée sur l'ordinateur def atadatum.com, l'URI serait net.msmq://def.adatum.com/AccountsPayable.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-136">Example2: To address a public queue AccountsPayable hosted on computer def atadatum.com, the URI would be net.msmq://def.adatum.com/AccountsPayable.</span></span>  
  
 <span data-ttu-id="f1b0e-137">L'adresse de la file d'attente est utilisée comme URI d'écoute par l'écouteur pour la lecture des messages.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-137">The queue address is used as the Listen URI by the Listener to read messages from.</span></span> <span data-ttu-id="f1b0e-138">En d'autres termes, l'adresse de la file d'attente est équivalente au port d'écoute de socket TCP.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-138">In other words, the queue address is equivalent to the listen port of TCP socket.</span></span>  
  
 <span data-ttu-id="f1b0e-139">Un point de terminaison qui lit à partir d'une file d'attente doit spécifier l'adresse de la file d'attente à l'aide du même schéma que celui spécifié précédemment lors de l'ouverture du ServiceHost.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-139">An endpoint that reads from a queue must specify the address of the queue using the same scheme specified previously when opening the ServiceHost.</span></span> <span data-ttu-id="f1b0e-140">Pour obtenir des exemples, consultez [liaison net MSMQ](../../../../docs/framework/wcf/samples/net-msmq-binding.md).</span><span class="sxs-lookup"><span data-stu-id="f1b0e-140">For examples, see [Net MSMQ Binding](../../../../docs/framework/wcf/samples/net-msmq-binding.md).</span></span>  
  
### <a name="multiple-contracts-in-a-queue"></a><span data-ttu-id="f1b0e-141">Contrats multiples dans une file d'attente</span><span class="sxs-lookup"><span data-stu-id="f1b0e-141">Multiple Contracts in a Queue</span></span>  
 <span data-ttu-id="f1b0e-142">Les messages dans une file d'attente peuvent implémenter des contrats différents.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-142">Messages in a queue can implement different contracts.</span></span> <span data-ttu-id="f1b0e-143">Dans ce cas, il est essentiel que l'une des conditions suivantes soit remplie pour lire et traiter avec succès tous les messages :</span><span class="sxs-lookup"><span data-stu-id="f1b0e-143">In this case, it is essential that one of the following is true to successfully read and process all messages:</span></span>  
  
- <span data-ttu-id="f1b0e-144">Spécifiez un point de terminaison pour un service qui implémente tous les contrats.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-144">Specify an endpoint for a service that implements all the contracts.</span></span> <span data-ttu-id="f1b0e-145">Il s’agit de l’approche recommandée.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-145">This is the recommended approach.</span></span>  
  
- <span data-ttu-id="f1b0e-146">Spécifiez plusieurs points de terminaison avec différents contrats, mais assurez-vous que tous les points de terminaison utilisent le même objet `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-146">Specify multiple endpoints with different contracts, but ensure that all the endpoints use the same `NetMsmqBinding` object.</span></span> <span data-ttu-id="f1b0e-147">La logique de distribution dans ServiceModel utilise une pompe de messages qui lit les messages du canal de transport pour distribution, et qui démultiplexe finalement les messages en fonction du contrat vers différents points de terminaison.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-147">The dispatching logic in ServiceModel uses a message pump that reads messages out of the transport channel for dispatch, which eventually de-multiplexes messages based on the contract to different endpoints.</span></span> <span data-ttu-id="f1b0e-148">Une pompe de messages est créée pour une paire d’écoute URI/liaison.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-148">A message pump is created for a listen URI/Binding pair.</span></span> <span data-ttu-id="f1b0e-149">L'adresse de la file d'attente est utilisée comme URI d'écoute par l'écouteur en file d'attente.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-149">The queue address is used as the Listen URI by the queued listener.</span></span> <span data-ttu-id="f1b0e-150">Faire en sorte que tous les points de terminaison utilisent le même objet de liaison permet de s’assurer qu’une pompe de messages unique est utilisée pour lire le message et pour démultiplexer vers des points de terminaison pertinents en fonction du contrat.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-150">Having all the endpoints use the same binding object ensures that a single message pump is used to read the message and de-multiplex to relevant endpoints based on the contract.</span></span>  
  
### <a name="srmp-messaging"></a><span data-ttu-id="f1b0e-151">Messagerie SRMP</span><span class="sxs-lookup"><span data-stu-id="f1b0e-151">SRMP Messaging</span></span>  
 <span data-ttu-id="f1b0e-152">Comme discuté précédemment, vous pouvez utiliser le protocole SRMP pour les transferts de file d'attente à file d'attente.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-152">As previously discussed, you can use the SRMP protocol for queue-to-queue transfers.</span></span> <span data-ttu-id="f1b0e-153">Cette procédure est utilisée couramment lorsqu'un transport HTTP transmet des messages entre la file d'attente de transmission et la file d'attente cible.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-153">This is commonly used when an HTTP transport transmits messages between the Transmission Queue and the Target Queue.</span></span>  
  
 <span data-ttu-id="f1b0e-154">Pour utiliser le protocole de transfert SRMP, adressez les messages à l'aide du schéma URI net.msmq, comme mentionné précédemment, et spécifiez le choix SRMP ou SRMP sécurisé dans la propriété `QueueTransferProtocol` du `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-154">To use the SRMP transfer protocol, address messages using the net.msmq URI scheme, as mentioned previously, and specify the choice of SRMP or Secured SRMP in the `QueueTransferProtocol` property of the `NetMsmqBinding`.</span></span>  
  
 <span data-ttu-id="f1b0e-155">La spécification de la propriété `QueueTransferProtocol` est une fonctionnalité « transmission uniquement ».</span><span class="sxs-lookup"><span data-stu-id="f1b0e-155">Specifying the `QueueTransferProtocol` property is a send-only feature.</span></span> <span data-ttu-id="f1b0e-156">Il s'agit d'une indication par le client concernant le type de protocole de transfert de file d'attente à utiliser.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-156">This is an indication by the client which kind of queue transfer protocol to use.</span></span>  
  
### <a name="using-active-directory"></a><span data-ttu-id="f1b0e-157">Utilisation d'Active Directory</span><span class="sxs-lookup"><span data-stu-id="f1b0e-157">Using Active Directory</span></span>  
 <span data-ttu-id="f1b0e-158">MSMQ prend en charge l'intégration avec Active Directory.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-158">MSMQ comes with support for Active Directory integration.</span></span> <span data-ttu-id="f1b0e-159">Lorsque MSMQ est installé avec l'intégration Active Directory, l'ordinateur doit appartenir à un domaine Windows.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-159">When MSMQ is installed with Active Directory integration, the machine must be part of a Windows domain.</span></span> <span data-ttu-id="f1b0e-160">Active Directory est utilisé pour publier des files d’attente à des fins de découverte ; ces files d’attente sont appelées *files d’attente publiques*.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-160">Active Directory is used to publish queues for discovery; such queues are called *public queues*.</span></span> <span data-ttu-id="f1b0e-161">Lors de l'adressage d'une file d'attente, la file d'attente peut être résolue à l'aide d'Active Directory.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-161">When addressing a queue, the queue can be resolved using Active Directory.</span></span> <span data-ttu-id="f1b0e-162">Ce principe s'apparente à la manière dont DNS (Domain Name System) est utilisé pour résoudre l'adresse IP d'un nom réseau.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-162">This is similar to how Domain Name System (DNS) is used to resolve the IP address of a network name.</span></span> <span data-ttu-id="f1b0e-163">La propriété `UseActiveDirectory` dans `NetMsmqBinding` est une valeur booléenne qui indique si le canal en file d'attente doit utiliser Active Directory pour résoudre l'URI de file d'attente.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-163">The `UseActiveDirectory` property in `NetMsmqBinding` is a Boolean that indicates whether the queued channel must use Active Directory to resolve the queue URI.</span></span> <span data-ttu-id="f1b0e-164">Par défaut, elle est définie sur `false`.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-164">By default it is set to `false`.</span></span> <span data-ttu-id="f1b0e-165">Si la propriété `UseActiveDirectory` a la valeur `true`, le canal en file d'attente utilise Active Directory pour convertir l'URI net.msmq:// au nom de format.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-165">If the `UseActiveDirectory` property is set to `true`, then the queued channel uses Active Directory to convert the net.msmq:// URI to format name.</span></span>  
  
 <span data-ttu-id="f1b0e-166">La propriété `UseActiveDirectory` est explicite uniquement pour le client qui envoie le message car elle est utilisée pour résoudre l'adresse de la file d'attente lors de l'envoi de messages.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-166">The `UseActiveDirectory` property is meaningful only for the client that is sending the message because it is used to resolve the address of the queue when sending messages.</span></span>  
  
### <a name="mapping-netmsmq-uri-to-message-queuing-format-names"></a><span data-ttu-id="f1b0e-167">Mappage de l'URI net.msmq aux noms de format Message Queuing</span><span class="sxs-lookup"><span data-stu-id="f1b0e-167">Mapping net.msmq URI to Message Queuing Format Names</span></span>  
 <span data-ttu-id="f1b0e-168">Le canal en file d'attente gère le mappage du nom d'URI net.msmq fourni au canal en noms de format MSMQ.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-168">The queued channel handles mapping the net.msmq URI name provided to the channel to MSMQ format names.</span></span> <span data-ttu-id="f1b0e-169">Le tableau suivant résume les règles de mappage utilisées.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-169">The following table summarizes the rules used to map between them.</span></span>  
  
|<span data-ttu-id="f1b0e-170">Adresse de file d'attente basée sur URI WCF </span><span class="sxs-lookup"><span data-stu-id="f1b0e-170">WCF URI-based queue address</span></span>|<span data-ttu-id="f1b0e-171">Utiliser la propriété Active Directory</span><span class="sxs-lookup"><span data-stu-id="f1b0e-171">Use Active Directory property</span></span>|<span data-ttu-id="f1b0e-172">Propriété de protocole de transfert de mise en file d'attente</span><span class="sxs-lookup"><span data-stu-id="f1b0e-172">Queue Transfer Protocol property</span></span>|<span data-ttu-id="f1b0e-173">Noms de format MSMQ résultants</span><span class="sxs-lookup"><span data-stu-id="f1b0e-173">Resulting MSMQ format names</span></span>|  
|----------------------------------|-----------------------------------|--------------------------------------|---------------------------------|  
|`Net.msmq://<machine-name>/private/abc`|<span data-ttu-id="f1b0e-174">False (valeur par défaut)</span><span class="sxs-lookup"><span data-stu-id="f1b0e-174">False (default)</span></span>|<span data-ttu-id="f1b0e-175">Native (valeur par défaut)</span><span class="sxs-lookup"><span data-stu-id="f1b0e-175">Native (default)</span></span>|`DIRECT=OS:machine-name\private$\abc`|  
|`Net.msmq://<machine-name>/private/abc`|<span data-ttu-id="f1b0e-176">False</span><span class="sxs-lookup"><span data-stu-id="f1b0e-176">False</span></span>|<span data-ttu-id="f1b0e-177">SRMP</span><span class="sxs-lookup"><span data-stu-id="f1b0e-177">SRMP</span></span>|`DIRECT=http://machine/msmq/private$/abc`|  
|`Net.msmq://<machine-name>/private/abc`|<span data-ttu-id="f1b0e-178">True</span><span class="sxs-lookup"><span data-stu-id="f1b0e-178">True</span></span>|<span data-ttu-id="f1b0e-179">Natif</span><span class="sxs-lookup"><span data-stu-id="f1b0e-179">Native</span></span>|<span data-ttu-id="f1b0e-180">`PUBLIC=some-guid`(GUID de la file d’attente)</span><span class="sxs-lookup"><span data-stu-id="f1b0e-180">`PUBLIC=some-guid` (the GUID of the queue)</span></span>|  
  
### <a name="reading-messages-from-the-dead-letter-queue-or-the-poison-message-queue"></a><span data-ttu-id="f1b0e-181">Lecture de messages à partir de la file d'attente de lettres mortes ou de la file d'attente de messages incohérents</span><span class="sxs-lookup"><span data-stu-id="f1b0e-181">Reading Messages from the Dead-Letter Queue or the Poison-Message Queue</span></span>  
 <span data-ttu-id="f1b0e-182">Pour lire des messages à partir d'une file d'attente de message incohérents qui est une sous-file d'attente de la file d'attente cible, ouvrez le `ServiceHost` avec l'adresse de la sous-file d'attente.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-182">To read messages from a poison-message queue that is a subqueue of the target queue, open the `ServiceHost` with the address of the subqueue.</span></span>  
  
 <span data-ttu-id="f1b0e-183">Exemple : un service qui lit à partir de la file d'attente de message incohérents de la file d'attente privée PurchaseOrders de l'ordinateur local adresserait net.msmq://localhost/private/PurchaseOrders;poison.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-183">Example: A service that reads from the poison-message queue of the PurchaseOrders private queue from the local machine would address net.msmq://localhost/private/PurchaseOrders;poison.</span></span>  
  
 <span data-ttu-id="f1b0e-184">Pour lire des messages à partir d’une file d’attente de lettres mortes transactionnelle système, l’URI doit être de la forme suivante : net.msmq://localhost/system$;DeadXact.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-184">To read messages from a system transactional dead-letter queue, the URI must be of the form: net.msmq://localhost/system$;DeadXact.</span></span>  
  
 <span data-ttu-id="f1b0e-185">Pour lire des messages à partir d'une file d'attente de lettres mortes non transactionnelle système, l'URI doit être de la forme suivante : net.msmq://localhost/system$;DeadLetter.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-185">To read messages from a system nontransactional dead-letter queue, the URI must be of the form: net.msmq://localhost/system$;DeadLetter.</span></span>  
  
 <span data-ttu-id="f1b0e-186">Lors de l'utilisation d'une file d'attente de lettres mortes personnalisée, notez que la file d'attente de lettres mortes doit résider sur l'ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-186">When using a custom dead-letter queue, note that the dead-letter queue must reside on the local computer.</span></span> <span data-ttu-id="f1b0e-187">Comme tel, l'URI de la file d'attente de lettres mortes est restreint à la forme suivante :</span><span class="sxs-lookup"><span data-stu-id="f1b0e-187">As such, the URI for the dead-letter queue is restricted to the form:</span></span>  
  
 <span data-ttu-id="f1b0e-188">NET. msmq://localhost/[Private/] \<*custom-dead-letter-queue-name*> .</span><span class="sxs-lookup"><span data-stu-id="f1b0e-188">net.msmq: //localhost/ [private/]  \<*custom-dead-letter-queue-name*>.</span></span>  
  
 <span data-ttu-id="f1b0e-189">Un service WCF vérifie que tous les messages qu’il reçoit ont été adressés à la file d’attente particulière sur laquelle il écoute.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-189">A WCF service verifies that all messages it receives were addressed to the particular queue it is listening on.</span></span> <span data-ttu-id="f1b0e-190">Si la file d'attente de destination du message ne correspond pas à la file d'attente dans laquelle il se trouve, le service ne traite pas le message.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-190">If the message’s destination queue does not match the queue it is found in, the service does not process the message.</span></span> <span data-ttu-id="f1b0e-191">Il s'agit d'un problème que les services qui écoutent une file d'attente de lettres mortes doivent être capables de gérer car tout message présent dans la file d'attente de lettres mortes était destiné à être remis autre part.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-191">This is an issue that services listening to a dead-letter queue must address because any message in the dead-letter queue was meant to be delivered elsewhere.</span></span> <span data-ttu-id="f1b0e-192">Pour lire des messages à partir d'une file d'attente de lettres mortes ou d'une file d'attente de messages incohérents, un `ServiceBehavior` avec le paramètre <xref:System.ServiceModel.AddressFilterMode.Any> doit être utilisé.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-192">To read messages from a dead-letter queue, or from a poison queue, a `ServiceBehavior` with the <xref:System.ServiceModel.AddressFilterMode.Any> parameter must be used.</span></span> <span data-ttu-id="f1b0e-193">Pour obtenir un exemple, consultez [files d’attente de lettres mortes](../../../../docs/framework/wcf/samples/dead-letter-queues.md).</span><span class="sxs-lookup"><span data-stu-id="f1b0e-193">For an example, see [Dead Letter Queues](../../../../docs/framework/wcf/samples/dead-letter-queues.md).</span></span>  
  
## <a name="msmqintegrationbinding-and-service-addressing"></a><span data-ttu-id="f1b0e-194">MsmqIntegrationBinding et adressage de service</span><span class="sxs-lookup"><span data-stu-id="f1b0e-194">MsmqIntegrationBinding and Service Addressing</span></span>  
 <span data-ttu-id="f1b0e-195">Le `MsmqIntegrationBinding` est utilisé pour la communication avec les applications MSMQ traditionnelles.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-195">The `MsmqIntegrationBinding` is used for communication with traditional MSMQ applications.</span></span> <span data-ttu-id="f1b0e-196">Pour faciliter l’interopérabilité avec une application MSMQ existante, WCF prend uniquement en charge l’adressage de nom de format.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-196">To ease interoperation with an existing MSMQ application, WCF supports only format name addressing.</span></span> <span data-ttu-id="f1b0e-197">Par conséquent, les messages envoyés à l’aide de cette liaison doivent se conformer au schéma d’URI suivant :</span><span class="sxs-lookup"><span data-stu-id="f1b0e-197">Thus, messages sent using this binding must conform to the URI scheme:</span></span>  
  
 <span data-ttu-id="f1b0e-198">MSMQ. FormatName :\<*MSMQ-format-name*>></span><span class="sxs-lookup"><span data-stu-id="f1b0e-198">msmq.formatname:\<*MSMQ-format-name*>></span></span>  
  
 <span data-ttu-id="f1b0e-199">MSMQ-format-name est de la forme spécifiée par MSMQ dans [à propos de Message Queuing](https://docs.microsoft.com/previous-versions/windows/desktop/legacy/ms706032(v=vs.85)).</span><span class="sxs-lookup"><span data-stu-id="f1b0e-199">The MSMQ-format-name is of the form specified by MSMQ in [About Message Queuing](https://docs.microsoft.com/previous-versions/windows/desktop/legacy/ms706032(v=vs.85)).</span></span>  
  
 <span data-ttu-id="f1b0e-200">Notez que vous pouvez utiliser des noms de format directs, et des noms de format publics et privés (requiert l'intégration Active Directory) uniquement lors de la réception de messages à partir d'une file d'attente à l'aide de `MsmqIntegrationBinding`.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-200">Note that you can only use direct format names, and public and private format names (requires Active Directory integration) when receiving messages from a queue using `MsmqIntegrationBinding`.</span></span> <span data-ttu-id="f1b0e-201">Il est toutefois recommandé d'utiliser des noms de format directs.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-201">However, it is advised that you use direct format names.</span></span> <span data-ttu-id="f1b0e-202">Par exemple, sur Windows Vista, l’utilisation d’un autre nom de format provoque une erreur, car le système tente d’ouvrir une sous-file d’attente, qui peut uniquement être ouverte avec des noms de format directs.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-202">For example, on Windows Vista, using any other format name causes an error because the system attempts to open a subqueue, which can only be opened with direct format names.</span></span>  
  
 <span data-ttu-id="f1b0e-203">Lors de l’adressage SRMP à l’aide de `MsmqIntegrationBinding`, il n’est pas obligatoire d’ajouter /msmq/ dans le nom de format direct pour aider les services Internet (IIS) à effectuer la distribution.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-203">When addressing SRMP using `MsmqIntegrationBinding`, there is no requirement to add /msmq/ in the direct format name to help Internet Information Services (IIS) with dispatching.</span></span> <span data-ttu-id="f1b0e-204">Par exemple : lors de l’adressage d’une file d’attente ABC à l’aide du protocole SRMP, au lieu de `DIRECT=http://adatum.com/msmq/private$/abc` , vous devez utiliser `DIRECT=http://adatum.com/private$/abc` .</span><span class="sxs-lookup"><span data-stu-id="f1b0e-204">For example: When addressing a queue abc using the SRMP protocol, instead of `DIRECT=http://adatum.com/msmq/private$/abc`, you should use `DIRECT=http://adatum.com/private$/abc`.</span></span>  
  
 <span data-ttu-id="f1b0e-205">Notez que vous ne pouvez pas utiliser l'adressage net.msmq:// avec `MsmqIntegrationBinding`.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-205">Note that you cannot use net.msmq:// addressing with `MsmqIntegrationBinding`.</span></span> <span data-ttu-id="f1b0e-206">Étant donné que `MsmqIntegrationBinding` prend en charge l’adressage de nom de format MSMQ de forme libre, vous pouvez utiliser un service WCF qui utilise cette liaison pour utiliser les fonctionnalités de multidiffusion et de liste de distribution dans MSMQ.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-206">Because `MsmqIntegrationBinding` supports free-form MSMQ format name addressing, you can use a WCF service that uses this binding to use multicast and distribution list features in MSMQ.</span></span> <span data-ttu-id="f1b0e-207">Une exception concerne la spécification de `CustomDeadLetterQueue` lors de l'utilisation du `MsmqIntegrationBinding`.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-207">One exception is specifying `CustomDeadLetterQueue` when using the `MsmqIntegrationBinding`.</span></span> <span data-ttu-id="f1b0e-208">Il doit être de la forme net.msmq://, semblable à la façon dont il est spécifié à l'aide du `NetMsmqBinding`.</span><span class="sxs-lookup"><span data-stu-id="f1b0e-208">It must be of the form net.msmq://, similar to how it is specified using the `NetMsmqBinding`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f1b0e-209">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="f1b0e-209">See also</span></span>

- [<span data-ttu-id="f1b0e-210">Hébergement sur le Web d'une application en file d'attente</span><span class="sxs-lookup"><span data-stu-id="f1b0e-210">Web Hosting a Queued Application</span></span>](../../../../docs/framework/wcf/feature-details/web-hosting-a-queued-application.md)

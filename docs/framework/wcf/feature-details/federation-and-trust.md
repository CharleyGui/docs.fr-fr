---
title: Fédération et confiance
ms.date: 03/30/2017
helpviewer_keywords:
- federation [WCF], and trust
ms.assetid: 4bdec4f2-f8a2-4512-bdcf-14ef54b5877a
ms.openlocfilehash: 95c50ac5f402114925d3350f258f03caca4592ba
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/22/2019
ms.locfileid: "69948071"
---
# <a name="federation-and-trust"></a><span data-ttu-id="91094-102">Fédération et confiance</span><span class="sxs-lookup"><span data-stu-id="91094-102">Federation and Trust</span></span>
<span data-ttu-id="91094-103">Cette rubrique aborde différents aspects liés aux applications fédérées, aux limites d’approbation et à la configuration, ainsi qu’à l’utilisation de jetons émis dans Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="91094-103">This topic covers various aspects related to federated applications, trust boundaries and configuration, and use of issued tokens in Windows Communication Foundation (WCF).</span></span>  
  
## <a name="services-security-token-services-and-trust"></a><span data-ttu-id="91094-104">Services, services d'émission de jeton de sécurité et confiance</span><span class="sxs-lookup"><span data-stu-id="91094-104">Services, Security Token Services, and Trust</span></span>  
 <span data-ttu-id="91094-105">Les services qui exposent des points de terminaison fédérés s'attendent en général à ce que les clients s'authentifient à l'aide d'un jeton fourni par un émetteur spécifique.</span><span class="sxs-lookup"><span data-stu-id="91094-105">Services that expose federated endpoints typically expect clients to authenticate using a token provided by a specific issuer.</span></span> <span data-ttu-id="91094-106">Il est important que le service soit configuré avec les informations d'identification correctes de l'émetteur ; dans le cas contraire, il ne sera pas en mesure de vérifier les signatures sur les jetons émis, et le client ne pourra pas communiquer avec le service.</span><span class="sxs-lookup"><span data-stu-id="91094-106">It is important that the service is configured with the correct credentials for the issuer; otherwise, it will not be able to verify signatures over the issued tokens, and the client will be unable to communicate with the service.</span></span> <span data-ttu-id="91094-107">Pour plus d’informations sur la configuration des informations d’identification de l’émetteur sur [le service, consultez Procédure: Configurez les informations d'](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)identification sur un service FS (Federation Service).</span><span class="sxs-lookup"><span data-stu-id="91094-107">For more information about configuring issuer credentials on the service, see [How to: Configure Credentials on a Federation Service](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md).</span></span>  
  
 <span data-ttu-id="91094-108">De la même façon, lorsque vous utilisez des clés symétriques, les clés sont chiffrées pour le service cible et vous devez donc configurer le service d'émission de jeton de sécurité avec les informations d'identification correctes du service cible ; dans le cas contraire, il ne sera pas en mesure de chiffrer la clé pour le service cible, et une nouvelle fois, le client ne pourra pas communiquer avec le service.</span><span class="sxs-lookup"><span data-stu-id="91094-108">Similarly, when using symmetric keys, the keys are encrypted for the target service, so you must configure the security token service with the correct credentials for the target service; otherwise, it will be unable to encrypt the key for the target service, and again, the client will be unable to communicate with the service.</span></span>  
  
 <span data-ttu-id="91094-109">Les services WCF utilisent la valeur de <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> la propriété sur le [SecurityBindingElement](../../../../docs/framework/wcf/diagnostics/wmi/securitybindingelement.md) pour autoriser l’inclinaison de l’horloge entre le client et le service.</span><span class="sxs-lookup"><span data-stu-id="91094-109">WCF services use the value of the <xref:System.ServiceModel.Channels.LocalServiceSecuritySettings.MaxClockSkew%2A> property on the [SecurityBindingElement](../../../../docs/framework/wcf/diagnostics/wmi/securitybindingelement.md) to allow for clock skew between the client and service.</span></span> <span data-ttu-id="91094-110">Dans la fédération, le paramètre `MaxClockSkew` s'applique aux inclinaisons de l'horloge entre à la fois le client et le service d'émission de jeton de sécurité à partir duquel le client a obtenu le jeton émis.</span><span class="sxs-lookup"><span data-stu-id="91094-110">In federation, the `MaxClockSkew` setting applies to clock skews between both the client and the security token service from where the client obtained the issued token.</span></span> <span data-ttu-id="91094-111">Par conséquent, les services d'émission de jeton de sécurité n'ont pas besoin d'allouer d'inclinaison d'horloge lors de la définition des délais de validité et d'expiration du jeton émis.</span><span class="sxs-lookup"><span data-stu-id="91094-111">Therefore, security token services need not make clock-skew allowances when setting the issued token's effective and expiration times.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="91094-112">L'importance de l'inclinaison de l'horloge augmente à mesure que la durée de vie du jeton émis raccourcit.</span><span class="sxs-lookup"><span data-stu-id="91094-112">The importance of clock skew increases as the lifetime of the issued token shortens.</span></span> <span data-ttu-id="91094-113">Dans la plupart des cas, l'inclinaison de l'horloge n'est pas un problème significatif si la durée de vie du jeton est de 30 minutes ou plus.</span><span class="sxs-lookup"><span data-stu-id="91094-113">In most cases, clock skew is not a significant issue if the token lifetime is 30 minutes or more.</span></span> <span data-ttu-id="91094-114">Des scénarios avec des durées de vie plus courtes ou dans lesquels le délai de validité exact du jeton est important doivent être conçus afin de prendre l'inclinaison de l'horloge en compte.</span><span class="sxs-lookup"><span data-stu-id="91094-114">Scenarios with shorter lifetimes or where the exact validity time of the token is important should be designed to take clock skew into account.</span></span>  
  
## <a name="federated-endpoints-and-time-outs"></a><span data-ttu-id="91094-115">Points de terminaison fédérés et délais d'expiration</span><span class="sxs-lookup"><span data-stu-id="91094-115">Federated Endpoints and Time-Outs</span></span>  
 <span data-ttu-id="91094-116">Lorsqu'un client communique avec un point de terminaison fédéré, il doit tout d'abord acquérir un jeton approprié d'un service d'émission de jeton de sécurité.</span><span class="sxs-lookup"><span data-stu-id="91094-116">When a client communicates with a federated endpoint, it must first acquire an appropriate token from a security token service.</span></span> <span data-ttu-id="91094-117">Si le service d'émission de jeton de sécurité expose un point de terminaison fédéré, le client doit en premier lieu obtenir un jeton de l'émetteur pour ce point de terminaison.</span><span class="sxs-lookup"><span data-stu-id="91094-117">If the security token service exposes a federated endpoint, the client must first obtain a token from the issuer for that endpoint.</span></span> <span data-ttu-id="91094-118">Chaque acquisition de jeton prend du temps, et ce temps est soumis au délai d'expiration total pour l'envoi du message réel au point de terminaison final.</span><span class="sxs-lookup"><span data-stu-id="91094-118">Each token acquisition takes time, and that time is subject to the overall time-out for sending the actual message to the final endpoint.</span></span>  
  
 <span data-ttu-id="91094-119">Par exemple, le délai d'expiration sur le canal côté client a pour valeur 30 secondes.</span><span class="sxs-lookup"><span data-stu-id="91094-119">For example, the time-out on the client-side channel is set to 30 seconds.</span></span> <span data-ttu-id="91094-120">Deux émetteurs de jeton doivent être appelés pour récupérer des jetons avant d'envoyer le message au point de terminaison final, et chacun prend 15 secondes pour émettre un jeton.</span><span class="sxs-lookup"><span data-stu-id="91094-120">Two token issuers need to be called to retrieve tokens before sending the message to the final endpoint, and each takes 15 seconds to issue a token.</span></span> <span data-ttu-id="91094-121">Dans ce cas, la tentative échoue et une exception <xref:System.TimeoutException> est levée.</span><span class="sxs-lookup"><span data-stu-id="91094-121">In this case, the attempt will fail and a <xref:System.TimeoutException> is thrown.</span></span> <span data-ttu-id="91094-122">Vous devez donc définir <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> sur le canal client à une valeur suffisamment élevée pour inclure le temps pris pour récupérer tous les jetons émis.</span><span class="sxs-lookup"><span data-stu-id="91094-122">Thus, you need to set the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> value on the client channel to a value large enough to include the time taken to retrieve all issued tokens.</span></span> <span data-ttu-id="91094-123">Si aucune valeur n'est spécifiée pour la propriété <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A>, la propriété <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> ou la propriété <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> (ou les deux) doivent avoir une valeur suffisamment élevée pour inclure le temps pris pour récupérer tous les jetons émis.</span><span class="sxs-lookup"><span data-stu-id="91094-123">In the case where a value is not specified for the <xref:System.ServiceModel.IContextChannel.OperationTimeout%2A> property, the <xref:System.ServiceModel.Channels.Binding.OpenTimeout%2A> property or the <xref:System.ServiceModel.Channels.Binding.SendTimeout%2A> property (or both) need to be set to a value large enough to include the time taken to retrieve all issued tokens.</span></span>  
  
## <a name="token-lifetime-and-renewal"></a><span data-ttu-id="91094-124">Renouvellement et durée de vie des jetons</span><span class="sxs-lookup"><span data-stu-id="91094-124">Token Lifetime and Renewal</span></span>  
 <span data-ttu-id="91094-125">Les clients WCF ne vérifient pas le jeton émis lors de la demande initiale à un service.</span><span class="sxs-lookup"><span data-stu-id="91094-125">WCF clients do not check the issued token when making an initial request to a service.</span></span>  <span data-ttu-id="91094-126">Au lieu de cela, WCF approuve le service d’émission de jeton de sécurité pour émettre un jeton avec les délais d’expiration et effectifs appropriés.</span><span class="sxs-lookup"><span data-stu-id="91094-126">Rather, WCF trusts the security token service to issue a token with appropriate effective and expiration times.</span></span> <span data-ttu-id="91094-127">Si le jeton est mis en cache par le client et réutilisé, sa durée de vie est vérifiée sur les demandes suivantes, et le client le renouvelle automatiquement si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="91094-127">If the token is cached by the client and reused, the token lifetime is checked on subsequent requests and the client automatically renews the token if necessary.</span></span> <span data-ttu-id="91094-128">Pour plus d’informations sur la mise en [cache des jetons, consultez Procédure: Créez un client](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)fédéré.</span><span class="sxs-lookup"><span data-stu-id="91094-128">For more information about token caching, see [How to: Create a Federated Client](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md).</span></span>  
  
 <span data-ttu-id="91094-129">La spécification de durées de vie courtes, sur l’ordre de 30 secondes ou moins pour les jetons émis ou les jetons de contexte de sécurité, peut entraîner des délais d’expiration de négociation ou d’autres exceptions générées par les clients WCF lors de la demande de jetons émis ou lors de la négociation ou du renouvellement de la sécurité. jetons de contexte.</span><span class="sxs-lookup"><span data-stu-id="91094-129">Specifying short lifetimes, on the order of 30 seconds or less for issued tokens or security context tokens, may result in negotiation time-outs or other exceptions being thrown by WCF clients when requesting issued tokens or when negotiating or renewing security context tokens.</span></span>  
  
## <a name="issued-tokens-and-inclusionmode"></a><span data-ttu-id="91094-130">Jetons émis et InclusionMode</span><span class="sxs-lookup"><span data-stu-id="91094-130">Issued Tokens and InclusionMode</span></span>  
 <span data-ttu-id="91094-131">Qu'un jeton émis soit ou non sérialisé dans un message envoyé d'un client vers un point de terminaison fédéré, il est contrôlé en définissant la propriété <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> de la classe <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters>.</span><span class="sxs-lookup"><span data-stu-id="91094-131">Whether an issued token is serialized in a message sent from a client to a federated endpoint or not is controlled by setting the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters.InclusionMode%2A> property of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenParameters> class.</span></span> <span data-ttu-id="91094-132">Cette propriété peut prendre l'une des valeurs de l'énumération <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode>, mais ce n'est pas utile dans la plupart des scénarios fédérés.</span><span class="sxs-lookup"><span data-stu-id="91094-132">This property can be set to one of the <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode> enumeration values, but it is not useful in most federated scenarios.</span></span> <span data-ttu-id="91094-133">Les valeurs `SecurityTokenInclusionMode.Never` et `SecurityTokenInclusionMode.AlwaysToInitiator` provoquent l'envoi par le client d'une référence au jeton émis par le service d'émission de jeton de sécurité à la partie de confiance.</span><span class="sxs-lookup"><span data-stu-id="91094-133">The `SecurityTokenInclusionMode.Never` and `SecurityTokenInclusionMode.AlwaysToInitiator` values cause the client to send a reference to the token issued by the security token service to the relying party.</span></span> <span data-ttu-id="91094-134">Sauf si la partie de confiance possède une copie du jeton émis, l'authentification échouera car la référence du jeton ne peut pas être résolue.</span><span class="sxs-lookup"><span data-stu-id="91094-134">Unless the relying party possesses a copy of the issued token, authentication will fail because the token reference is not resolvable.</span></span> <span data-ttu-id="91094-135">WCF traite `SecurityTokenInclusionMode.Once` comme équivalent à `SecurityTokenInclusionMode.AlwaysToRecipient`.</span><span class="sxs-lookup"><span data-stu-id="91094-135">WCF treats `SecurityTokenInclusionMode.Once` as equivalent to `SecurityTokenInclusionMode.AlwaysToRecipient`.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="91094-136">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="91094-136">See also</span></span>

- <xref:System.ServiceModel.Security.Tokens.SecurityTokenInclusionMode>
- [<span data-ttu-id="91094-137">Guide pratique pour Créer un client fédéré</span><span class="sxs-lookup"><span data-stu-id="91094-137">How to: Create a Federated Client</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-federated-client.md)
- [<span data-ttu-id="91094-138">Guide pratique pour Configurer les informations d’identification sur un service FS (Federation Service)</span><span class="sxs-lookup"><span data-stu-id="91094-138">How to: Configure Credentials on a Federation Service</span></span>](../../../../docs/framework/wcf/feature-details/how-to-configure-credentials-on-a-federation-service.md)
- [<span data-ttu-id="91094-139">Guide pratique : Créer un WSFederationHttpBinding</span><span class="sxs-lookup"><span data-stu-id="91094-139">How to: Create a WSFederationHttpBinding</span></span>](../../../../docs/framework/wcf/feature-details/how-to-create-a-wsfederationhttpbinding.md)

---
title: Partage de ports Net.TCP
description: Découvrez un protocole TCP pour les communications à hautes performances et le service qui permet aux ports d’être partagés entre plusieurs processus utilisateur dans WCF.
ms.date: 03/30/2017
helpviewer_keywords:
- port activation [WCF]
- port sharing [WCF]
ms.assetid: f13692ee-a179-4439-ae72-50db9534eded
ms.openlocfilehash: 37e2c1de4516cbde58970db685422c5c65e25fb3
ms.sourcegitcommit: bc293b14af795e0e999e3304dd40c0222cf2ffe4
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/26/2020
ms.locfileid: "96248095"
---
# <a name="nettcp-port-sharing"></a><span data-ttu-id="cbc47-103">Partage de ports Net.TCP</span><span class="sxs-lookup"><span data-stu-id="cbc47-103">Net.TCP Port Sharing</span></span>

<span data-ttu-id="cbc47-104">Windows Communication Foundation (WCF) fournit un nouveau protocole réseau basé sur TCP (net. TCP://) pour la communication hautes performances.</span><span class="sxs-lookup"><span data-stu-id="cbc47-104">Windows Communication Foundation (WCF) provides a new TCP-based network protocol (net.tcp://) for high-performance communication.</span></span> <span data-ttu-id="cbc47-105">WCF introduit également un nouveau composant système, le service de partage de ports net. TCP qui permet aux ports net. TCP d’être partagés entre plusieurs processus utilisateur.</span><span class="sxs-lookup"><span data-stu-id="cbc47-105">WCF also introduces a new system component, the Net.TCP Port Sharing Service that enables net.tcp ports to be shared across multiple user processes.</span></span>  
  
## <a name="background-and-motivation"></a><span data-ttu-id="cbc47-106">Contexte et motivation</span><span class="sxs-lookup"><span data-stu-id="cbc47-106">Background and Motivation</span></span>  

 <span data-ttu-id="cbc47-107">Lorsque le protocole TCP/IP a été introduit pour la première fois, seul un petit nombre de protocoles d'application l'utilisaient.</span><span class="sxs-lookup"><span data-stu-id="cbc47-107">When the TCP/IP protocol was first introduced, only a small number of application protocols made use of it.</span></span> <span data-ttu-id="cbc47-108">TCP/IP utilisait les numéros de port pour différencier les applications en assignant un numéro de port unique à 16 bits à chaque protocole d'application.</span><span class="sxs-lookup"><span data-stu-id="cbc47-108">TCP/IP used port numbers to differentiate between applications by assigning a unique 16-bit port number to each application protocol.</span></span> <span data-ttu-id="cbc47-109">Par exemple, le trafic HTTP d'aujourd'hui est standardisé pour utiliser le port TCP 80, le protocole SMTP utilise le port TCP 25 et le protocole FTP utilise les ports TCP 20 et 21.</span><span class="sxs-lookup"><span data-stu-id="cbc47-109">For example, HTTP traffic today is standardized to use TCP port 80, SMTP uses TCP port 25, and FTP uses TCP ports 20 and 21.</span></span> <span data-ttu-id="cbc47-110">D'autres applications utilisant TCP comme transport peuvent choisir un autre numéro de port disponible, par convention ou par le biais d'une standardisation formelle.</span><span class="sxs-lookup"><span data-stu-id="cbc47-110">Other applications using TCP as a transport can choose another available port number, either by convention or through formal standardization.</span></span>  
  
 <span data-ttu-id="cbc47-111">L'utilisation des numéros de port pour différencier les applications posait des problèmes de sécurité.</span><span class="sxs-lookup"><span data-stu-id="cbc47-111">Using port numbers to distinguish between applications had security problems.</span></span> <span data-ttu-id="cbc47-112">Les pare-feu sont généralement configurés pour bloquer le trafic TCP sur tous les ports à l'exception de quelques points d'entrée connus ; par conséquent, le déploiement d'une application qui utilise un port non standard est souvent compliqué voire impossible en raison de la présence de pare-feu d'entreprise et personnels.</span><span class="sxs-lookup"><span data-stu-id="cbc47-112">Firewalls are generally configured to block TCP traffic on all ports except for a few well-known entry points, so deploying an application that uses a non-standard port is often complicated or even impossible due to the presence of corporate and personal firewalls.</span></span> <span data-ttu-id="cbc47-113">Les applications pouvant communiquer sur des ports connus standard, déjà autorisés, réduisent la zone exposée aux attaques externes.</span><span class="sxs-lookup"><span data-stu-id="cbc47-113">Applications that can communicate over standard, well-known ports that are already permitted, reduce the external attack surface.</span></span> <span data-ttu-id="cbc47-114">De nombreuses applications réseau utilisent le protocole HTTP parce que la plupart des pare-feu sont configurés par défaut pour autoriser le trafic sur le port TCP 80.</span><span class="sxs-lookup"><span data-stu-id="cbc47-114">Many network applications make use of the HTTP protocol because most firewalls are configured by default to allow traffic on TCP port 80.</span></span>  
  
 <span data-ttu-id="cbc47-115">Le modèle HTTP.SYS dans lequel le trafic pour de nombreuses applications HTTP différentes est multiplexé sur un port TCP unique, est devenu le standard sur la plate-forme Windows.</span><span class="sxs-lookup"><span data-stu-id="cbc47-115">The HTTP.SYS model in which traffic for many different HTTP applications is multiplexed onto a single TCP port has become standard on the Windows platform.</span></span> <span data-ttu-id="cbc47-116">Cela fournit un point de contrôle commun aux administrateurs de pare-feu tout en permettant aux développeurs d'applications de réduire le coût de déploiement lié à la génération des nouvelles applications pouvant utiliser le réseau.</span><span class="sxs-lookup"><span data-stu-id="cbc47-116">This provides a common point of control for firewall administrators while allowing application developers to minimize the deployment cost of building new applications that can make use of the network.</span></span>  
  
 <span data-ttu-id="cbc47-117">La capacité de partager des ports à travers plusieurs applications HTTP a longtemps été une fonctionnalité des services IIS (Internet Information Services).</span><span class="sxs-lookup"><span data-stu-id="cbc47-117">The ability to share ports across multiple HTTP applications has long been a feature of Internet Information Services (IIS).</span></span> <span data-ttu-id="cbc47-118">Toutefois, ce n’était qu’avec l’introduction de HTTP.SYS (l’écouteur de protocole HTTP en mode noyau) avec IIS 6,0 que cette infrastructure était entièrement généralisée.</span><span class="sxs-lookup"><span data-stu-id="cbc47-118">However, it was only with the introduction of HTTP.SYS (the kernel-mode HTTP protocol listener) with IIS 6.0 that this infrastructure was fully generalized.</span></span> <span data-ttu-id="cbc47-119">D'une façon générale, HTTP.SYS permet aux processus utilisateur arbitraires de partager les ports TCP dédiés au trafic HTTP.</span><span class="sxs-lookup"><span data-stu-id="cbc47-119">In effect, HTTP.SYS allows arbitrary user processes to share the TCP ports dedicated to HTTP traffic.</span></span> <span data-ttu-id="cbc47-120">Cette capacité permet à de nombreuses applications HTTP de coexister sur le même ordinateur physique dans des processus séparés et isolés, tout en partageant l'infrastructure réseau requise pour envoyer et recevoir le trafic sur le port TCP 80.</span><span class="sxs-lookup"><span data-stu-id="cbc47-120">This capability allows many HTTP applications to coexist on the same physical machine in separate, isolated processes while sharing the network infrastructure required to send and receive traffic over TCP port 80.</span></span> <span data-ttu-id="cbc47-121">Le Service de partage de ports Net.TCP active le même type de partage de ports pour les applications net.tcp.</span><span class="sxs-lookup"><span data-stu-id="cbc47-121">The Net.TCP Port Sharing Service enables the same type of port sharing for net.tcp applications.</span></span>  
  
## <a name="port-sharing-architecture"></a><span data-ttu-id="cbc47-122">Architecture de partage de ports</span><span class="sxs-lookup"><span data-stu-id="cbc47-122">Port Sharing Architecture</span></span>  

 <span data-ttu-id="cbc47-123">L’architecture de partage de port dans WCF comporte trois composants principaux :</span><span class="sxs-lookup"><span data-stu-id="cbc47-123">The Port Sharing architecture in WCF has three main components:</span></span>  
  
- <span data-ttu-id="cbc47-124">Un processus de travail : tout processus qui communique sur net.tcp:// en utilisant des ports partagés.</span><span class="sxs-lookup"><span data-stu-id="cbc47-124">A Worker Process: Any process communicating over net.tcp:// using shared ports.</span></span>  
  
- <span data-ttu-id="cbc47-125">Transport TCP WCF : implémente le protocole net. TCP://.</span><span class="sxs-lookup"><span data-stu-id="cbc47-125">The WCF TCP transport: Implements the net.tcp:// protocol.</span></span>  
  
- <span data-ttu-id="cbc47-126">Le Service de partage de ports Net.TCP : permet à plusieurs processus de travail de partager le même port TCP.</span><span class="sxs-lookup"><span data-stu-id="cbc47-126">The Net.TCP Port Sharing Service: Allows many worker processes to share the same TCP port.</span></span>  
  
 <span data-ttu-id="cbc47-127">Le Service de partage de ports Net.TCP est un service Windows en mode utilisateur qui accepte les connexions net.tcp:// pour le compte des processus de travail qui se connectent à travers lui.</span><span class="sxs-lookup"><span data-stu-id="cbc47-127">The Net.TCP Port Sharing Service is a user-mode Windows service that accepts net.tcp:// connections on behalf of the worker processes that connect through it.</span></span> <span data-ttu-id="cbc47-128">Lorsqu'une connexion de socket arrive, le service de partage de ports inspecte le flux des message entrants pour obtenir son adresse de destination.</span><span class="sxs-lookup"><span data-stu-id="cbc47-128">When a socket connection arrives, the port sharing service inspects the incoming message stream to obtain its destination address.</span></span> <span data-ttu-id="cbc47-129">En fonction de cette adresse, le service de partage de ports peut router le flux des données vers l'application qui finalement les traite.</span><span class="sxs-lookup"><span data-stu-id="cbc47-129">Based on this address, the port sharing service can route the data stream to the application that ultimately processes it.</span></span>  
  
 <span data-ttu-id="cbc47-130">Lorsqu’un service WCF qui utilise le partage de ports net. TCP://s’ouvre, l’infrastructure de transport TCP WCF n’ouvre pas directement de socket TCP dans le processus d’application.</span><span class="sxs-lookup"><span data-stu-id="cbc47-130">When a WCF service that uses net.tcp:// port sharing opens, the WCF TCP transport infrastructure does not directly open a TCP socket in the application process.</span></span> <span data-ttu-id="cbc47-131">À la place, l'infrastructure de transport enregistre l'URI (Uniform Resource Identifier) de l'adresse de base de service auprès du Service de partage de ports Net.TCP et attend que le service écoute les messages pour son compte.</span><span class="sxs-lookup"><span data-stu-id="cbc47-131">Instead, the transport infrastructure registers the service’s base address Uniform Resource Identifier (URI) with the Net.TCP Port Sharing Service and waits for the port sharing service to listen for messages on its behalf.</span></span>  <span data-ttu-id="cbc47-132">Le service de partage de ports distribue des messages adressés au service de l'application quand ils arrivent.</span><span class="sxs-lookup"><span data-stu-id="cbc47-132">The port sharing service dispatches messages addressed to the application service as they arrive.</span></span>  
  
## <a name="installing-port-sharing"></a><span data-ttu-id="cbc47-133">Installation du partage de ports</span><span class="sxs-lookup"><span data-stu-id="cbc47-133">Installing Port Sharing</span></span>  

 <span data-ttu-id="cbc47-134">Le service de partage de ports net. TCP est disponible sur tous les systèmes d’exploitation qui prennent en charge WinFX, mais le service n’est pas activé par défaut.</span><span class="sxs-lookup"><span data-stu-id="cbc47-134">The Net.TCP Port Sharing Service is available on all operating systems that support WinFX, but the service is not enabled by default.</span></span> <span data-ttu-id="cbc47-135">Comme précaution de sécurité, un administrateur doit activer manuellement le Service de partage de ports Net.TCP avant la première utilisation.</span><span class="sxs-lookup"><span data-stu-id="cbc47-135">As a security precaution, an administrator must manually enable the Net.TCP Port Sharing Service prior to first use.</span></span> <span data-ttu-id="cbc47-136">Le Service de partage de ports Net.TCP expose les options de configuration qui vous permettent de manipuler plusieurs caractéristiques des sockets réseau possédés par le service de partage de ports.</span><span class="sxs-lookup"><span data-stu-id="cbc47-136">The Net.TCP Port Sharing Service exposes configuration options that allow you to manipulate several characteristics of the network sockets owned by the port sharing service.</span></span> <span data-ttu-id="cbc47-137">Pour plus d’informations, consultez [Comment : activer le service de partage de ports net. TCP](how-to-enable-the-net-tcp-port-sharing-service.md).</span><span class="sxs-lookup"><span data-stu-id="cbc47-137">For more information, see [How to: Enable the Net.TCP Port Sharing Service](how-to-enable-the-net-tcp-port-sharing-service.md).</span></span>  
  
## <a name="using-nettcp-port-sharing-in-an-application"></a><span data-ttu-id="cbc47-138">Utilisation du partage de ports Net.tcp dans une application</span><span class="sxs-lookup"><span data-stu-id="cbc47-138">Using Net.tcp Port Sharing in an Application</span></span>  

 <span data-ttu-id="cbc47-139">Le moyen le plus simple d’utiliser le partage de ports net. TCP://dans votre application WCF consiste à exposer un service à l’aide de <xref:System.ServiceModel.NetTcpBinding> , puis à activer le service de partage de ports net. TCP à l’aide de la <xref:System.ServiceModel.NetTcpBinding.PortSharingEnabled%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="cbc47-139">The easiest way to use net.tcp:// port sharing in your WCF application is to expose a service using the <xref:System.ServiceModel.NetTcpBinding> and then to enable Net.TCP Port Sharing Service using the <xref:System.ServiceModel.NetTcpBinding.PortSharingEnabled%2A> property.</span></span>  
  
 <span data-ttu-id="cbc47-140">Pour plus d’informations sur la procédure à suivre, consultez [Comment : configurer un service WCF pour utiliser le partage de port](how-to-configure-a-wcf-service-to-use-port-sharing.md).</span><span class="sxs-lookup"><span data-stu-id="cbc47-140">For more information about how to do this, see [How to: Configure a WCF Service to Use Port Sharing](how-to-configure-a-wcf-service-to-use-port-sharing.md).</span></span>  
  
## <a name="security-implications-of-port-sharing"></a><span data-ttu-id="cbc47-141">Conséquences sur la sécurité du partage de ports</span><span class="sxs-lookup"><span data-stu-id="cbc47-141">Security Implications of Port Sharing</span></span>  

 <span data-ttu-id="cbc47-142">Bien que le Service de partage de ports Net.TCP fournisse une couche de traitement entre les applications et le réseau, les applications qui utilisent ce service doivent néanmoins être sécurisées comme si elles écoutaient directement le réseau.</span><span class="sxs-lookup"><span data-stu-id="cbc47-142">Although the Net.TCP Port Sharing Service provides a layer of processing between applications and the network, applications that use port sharing should still be secured as if they were directly listening on the network.</span></span> <span data-ttu-id="cbc47-143">Spécifiquement, les applications qui utilisent le partage de ports doivent évaluer les privilèges de processus sous lesquels elles s'exécutent.</span><span class="sxs-lookup"><span data-stu-id="cbc47-143">Specifically, applications that use port sharing should evaluate the process privileges under which they run.</span></span> <span data-ttu-id="cbc47-144">Envisagez d'exécuter votre application à l'aide du compte de service réseau intégré, qui s'exécute avec le jeu minime de privilèges de processus requis pour la communication réseau.</span><span class="sxs-lookup"><span data-stu-id="cbc47-144">Consider running your application using the built-in Network Service account, which runs with the minimal set of process privileges required for network communication.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cbc47-145">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="cbc47-145">See also</span></span>

- [<span data-ttu-id="cbc47-146">Configuration du service de partage de ports Net.TCP</span><span class="sxs-lookup"><span data-stu-id="cbc47-146">Configuring the Net.TCP Port Sharing Service</span></span>](configuring-the-net-tcp-port-sharing-service.md)
- [<span data-ttu-id="cbc47-147">Hébergement</span><span class="sxs-lookup"><span data-stu-id="cbc47-147">Hosting</span></span>](hosting.md)
- [<span data-ttu-id="cbc47-148">Procédure : configurer un service WCF pour utiliser le partage de ports</span><span class="sxs-lookup"><span data-stu-id="cbc47-148">How to: Configure a WCF Service to Use Port Sharing</span></span>](how-to-configure-a-wcf-service-to-use-port-sharing.md)
- [<span data-ttu-id="cbc47-149">Procédure : activer le service de partage de ports Net.TCP</span><span class="sxs-lookup"><span data-stu-id="cbc47-149">How to: Enable the Net.TCP Port Sharing Service</span></span>](how-to-enable-the-net-tcp-port-sharing-service.md)

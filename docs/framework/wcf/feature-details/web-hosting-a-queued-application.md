---
title: Hébergement sur le Web d'une application en file d'attente
ms.date: 03/30/2017
ms.assetid: c7a539fa-e442-4c08-a7f1-17b7f5a03e88
ms.openlocfilehash: 36c35fe0590ad9fc728641313d4175a432d7ccaa
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 08/22/2019
ms.locfileid: "69951576"
---
# <a name="web-hosting-a-queued-application"></a><span data-ttu-id="5c0b5-102">Hébergement sur le Web d'une application en file d'attente</span><span class="sxs-lookup"><span data-stu-id="5c0b5-102">Web Hosting a Queued Application</span></span>
<span data-ttu-id="5c0b5-103">Le service d’activation des processus Windows (WAS) gère l’activation et la durée de vie des processus de travail qui contiennent des applications qui hébergent des services Windows Communication Foundation (WCF).</span><span class="sxs-lookup"><span data-stu-id="5c0b5-103">The Windows Process Activation Service (WAS) manages the activation and lifetime of the worker processes that contain applications that host Windows Communication Foundation (WCF) services.</span></span> <span data-ttu-id="5c0b5-104">Le modèle de processus WAS généralise le modèle de processus IIS 6,0 pour le serveur HTTP en supprimant la dépendance sur HTTP.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-104">The WAS process model generalizes the IIS 6.0 process model for the HTTP server by removing the dependency on HTTP.</span></span> <span data-ttu-id="5c0b5-105">Cela permet aux services WCF d’utiliser à la fois des protocoles HTTP et non-HTTP, tels que net. MSMQ et MSMQ. FormatName, dans un environnement d’hébergement qui prend en charge l’activation basée sur les messages et offre la possibilité d’héberger un grand nombre d’applications sur un ordinateur donné.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-105">This allows WCF services to use both HTTP and non-HTTP protocols, such as net.msmq and msmq.formatname, in a hosting environment that supports message-based activation and offers the ability to host a large number of applications on a given computer.</span></span>  
  
 <span data-ttu-id="5c0b5-106">WAS inclut un service d'activation Message Queuing (MSMQ) qui active une application en file d'attente lorsqu'un ou plusieurs messages sont placés dans l'une des files d'attente utilisée par l'application.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-106">WAS includes a Message Queuing (MSMQ) activation service that activates a queued application when one or more messages are placed in one of the queues used by the application.</span></span> <span data-ttu-id="5c0b5-107">Le service d'activation MSMQ est un service NT démarré automatiquement par défaut.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-107">The MSMQ activation service is an NT service that is automatically started by default.</span></span>  
  
 <span data-ttu-id="5c0b5-108">Pour plus d’informations sur WAS et ses avantages, consultez [hébergement dans le service d’activation des processus Windows](../../../../docs/framework/wcf/feature-details/hosting-in-windows-process-activation-service.md).</span><span class="sxs-lookup"><span data-stu-id="5c0b5-108">For more information about WAS and its benefits, see [Hosting in Windows Process Activation Service](../../../../docs/framework/wcf/feature-details/hosting-in-windows-process-activation-service.md).</span></span> <span data-ttu-id="5c0b5-109">Pour plus d’informations sur MSMQ, voir [vue d’ensemble des files d’attente](../../../../docs/framework/wcf/feature-details/queues-overview.md).</span><span class="sxs-lookup"><span data-stu-id="5c0b5-109">For more information about MSMQ, see [Queues Overview](../../../../docs/framework/wcf/feature-details/queues-overview.md).</span></span>
  
## <a name="queue-addressing-in-was"></a><span data-ttu-id="5c0b5-110">Adressage de file d'attente dans le service WAS</span><span class="sxs-lookup"><span data-stu-id="5c0b5-110">Queue Addressing in WAS</span></span>  
 <span data-ttu-id="5c0b5-111">Les applications WAS ont des adresses URI (Uniform Resource Identifier).</span><span class="sxs-lookup"><span data-stu-id="5c0b5-111">WAS applications have Uniform Resource Identifier (URI) addresses.</span></span> <span data-ttu-id="5c0b5-112">Les adresses d'application ont deux parties : un préfixe URI de base et une adresse relative spécifique à l'application (chemin d'accès).</span><span class="sxs-lookup"><span data-stu-id="5c0b5-112">Application addresses have two parts: a base URI prefix and an application-specific, relative address (path).</span></span> <span data-ttu-id="5c0b5-113">Ces deux parties fournissent l'adresse externe d'une application lorsqu'elles sont jointes.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-113">These two parts provide the external address for an application when joined together.</span></span> <span data-ttu-id="5c0b5-114">Le préfixe URI de base est construit à partir de la liaison de site et est utilisé pour toutes les applications sous le site, par exemple «net. msmq: préfixé», «MSMQ. FormatName: préfixé» ou «net. TCP: préfixé».</span><span class="sxs-lookup"><span data-stu-id="5c0b5-114">The base URI prefix is constructed from the site binding and is used for all the applications under the site, for example, "net.msmq://localhost", "msmq.formatname://localhost", or "net.tcp://localhost".</span></span> <span data-ttu-id="5c0b5-115">Les adresses d’application sont ensuite construites en tenant des fragments de chemin d’accès spécifiques à l’application (tels que «/applicationOne») et en les ajoutant au préfixe URI de base pour arriver à l’URI d’application complet, par exemple, «net. msmq://localhost/applicationOne».</span><span class="sxs-lookup"><span data-stu-id="5c0b5-115">Application addresses are then constructed by taking application-specific path fragments (such as "/applicationOne") and appending them to the base URI prefix to arrive at the full application URI, for example, "net.msmq://localhost/applicationOne".</span></span>  
  
 <span data-ttu-id="5c0b5-116">Le service d'activation MSMQ utilise l'URI d'application pour mettre en correspondance la file d'attente dont le service d'activation MSMQ doit surveiller les messages.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-116">The MSMQ activation service uses the application URI to match the queue that the MSMQ activation service must monitor for messages.</span></span> <span data-ttu-id="5c0b5-117">Lorsque le service d'activation MSMQ démarre, il énumère toutes les files d'attente publiques et privées sur l'ordinateur à partir duquel il est configuré pour recevoir et surveille leurs messages.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-117">When the MSMQ activation service starts, it enumerates all public and private queues on the computer it is configured to receive from and monitors them for messages.</span></span> <span data-ttu-id="5c0b5-118">Toutes les 10 minutes, le service d'activation MSMQ actualise la liste de files d'attente à surveiller.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-118">Every 10 minutes, the MSMQ activation service refreshes the list of queues to monitor.</span></span> <span data-ttu-id="5c0b5-119">Lorsqu’un message est détecté dans une file d’attente, le service d’activation fait correspondre le nom de file d’attente à l’URI d’application la plus longue correspondante pour la liaison net.msmq et active l’application.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-119">When a message is found in a queue, the activation service matches the queue name to the longest matching application URI for the net.msmq binding and activates the application.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="5c0b5-120">L'application qui est activée doit correspondre (correspondance la plus longue) au préfixe du nom de file d'attente.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-120">The application being activated must match (longest match) the prefix of the queue name.</span></span>  
  
 <span data-ttu-id="5c0b5-121">Par exemple, un nom de file d'attente est le suivant : msmqWebHost/orderProcessing/service.svc.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-121">For example, a queue name is: msmqWebHost/orderProcessing/service.svc.</span></span> <span data-ttu-id="5c0b5-122">Si l'Application 1 a un répertoire virtuel /msmqWebHost/orderProcessing avec un service.svc au-dessous et que l'Application 2 a un répertoire virtuel /msmqWebHost avec un orderProcessing.svc au-dessous, l'Application 1 est activée.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-122">If Application 1 has a virtual directory /msmqWebHost/orderProcessing with a service.svc under it, and Application 2 has a virtual directory /msmqWebHost with an orderProcessing.svc under it, Application 1 is activated.</span></span> <span data-ttu-id="5c0b5-123">Si l'Application 1 est supprimée, l'Application 2 est activée.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-123">If Application 1 is deleted, Application 2 is activated.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="5c0b5-124">Lorsqu'une file d'attente est créée, les messages qui y sont envoyés n'activent l'application que lorsque le service d'activation MSMQ actualise la liste de file d'attente, à savoir au plus 10 minutes après la création de la file d'attente.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-124">When a queue is created, any messages sent to it do not activate an application until the MSMQ activation service refreshes the queue list, which is, at most, 10 minutes from the time the queue was created.</span></span> <span data-ttu-id="5c0b5-125">Le redémarrage du service d'activation actualise également la liste de file d'attente.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-125">Restarting the activation service refreshes the queue list as well.</span></span>  
  
### <a name="the-effect-of-private-and-public-queues-on-addressing"></a><span data-ttu-id="5c0b5-126">L'impact des files d'attente privées et publiques sur l'adressage</span><span class="sxs-lookup"><span data-stu-id="5c0b5-126">The Effect of Private and Public Queues on Addressing</span></span>  
 <span data-ttu-id="5c0b5-127">Le service d'activation MSMQ n'effectue aucune distinction entre le contrôle de file d'attente privée et publique.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-127">The MSMQ activation service does not distinguish between private and public queue monitoring.</span></span> <span data-ttu-id="5c0b5-128">En conséquence, vous ne pouvez pas avoir de files d'attente privées et publiques avec le même nom.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-128">As such, you cannot have public and private queues with the same name.</span></span> <span data-ttu-id="5c0b5-129">Si c'est le cas, une application hébergée sur le Web peut être activée suite à la lecture de l'une ou l'autre file d'attente.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-129">If you do, a Web-hosted application may get activated reading from either of the queues.</span></span>  
  
### <a name="queue-configuration-for-activation"></a><span data-ttu-id="5c0b5-130">Configuration de file d'attente pour l'activation</span><span class="sxs-lookup"><span data-stu-id="5c0b5-130">Queue Configuration for Activation</span></span>  
 <span data-ttu-id="5c0b5-131">Le service d'activation MSMQ s'exécute comme Service réseau.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-131">The MSMQ activation service runs as NETWORK SERVICE.</span></span> <span data-ttu-id="5c0b5-132">Il s'agit du service qui contrôle les files d'attente pour activer des applications.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-132">It is the service that monitors queues to activate applications.</span></span> <span data-ttu-id="5c0b5-133">Pour que ce service active des applications à partir de la file d'attente, celle-ci doit autoriser le Service réseau à lire les messages dans sa liste de contrôle d'accès.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-133">For it to activate applications from the queue, the queue must provide for NETWORK SERVICE access to peek for messages in its access control list (ACL).</span></span>  
  
### <a name="poison-messaging"></a><span data-ttu-id="5c0b5-134">Messagerie empoisonnée</span><span class="sxs-lookup"><span data-stu-id="5c0b5-134">Poison Messaging</span></span>  
 <span data-ttu-id="5c0b5-135">La gestion des messages incohérents dans WCF est gérée par le canal, qui détecte non seulement qu’un message est incohérent, mais sélectionne une disposition en fonction de la configuration de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-135">Poison message handling in WCF is handled by the channel, which not only detects that a message is poisoned but selects a disposition based on user configuration.</span></span> <span data-ttu-id="5c0b5-136">En conséquence, il n'y a qu'un seul message dans la file d'attente.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-136">As a result, there is a single message in the queue.</span></span> <span data-ttu-id="5c0b5-137">L'application hébergée sur le Web abandonne de manière répétée et le message est déplacé vers une file d'attente des nouvelles tentatives.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-137">The Web-hosted application aborts successive times and the message is moved to a retry queue.</span></span> <span data-ttu-id="5c0b5-138">À un point dicté par le délai de cycle de nouvelle tentative, le message est déplacé de la file d'attente des nouvelles tentatives vers la file d'attente principale, pour une nouvelle tentative.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-138">At a point dictated by the retry cycle delay, the message is moved from the retry queue to the main queue to try again.</span></span> <span data-ttu-id="5c0b5-139">Mais cela requiert que le canal en file d'attente soit actif.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-139">But this requires the queued channel to be active.</span></span> <span data-ttu-id="5c0b5-140">Si l'application est recyclée par le service WAS, le message reste dans la file d'attente des nouvelles tentatives jusqu'à ce qu'un autre message arrive dans la file d'attente principale pour activer l'application en file d'attente.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-140">If the application is recycled by WAS, then the message remains in the retry queue until another message arrives in the main queue to activate the queued application.</span></span> <span data-ttu-id="5c0b5-141">La solution de contournement dans ce cas consiste à déplacer manuellement le message de la file d'attente des nouvelles tentatives vers la file d'attente principale afin de réactiver l'application.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-141">The workaround in this case is to move the message manually from the retry queue back to the main queue to reactivate the application.</span></span>  
  
### <a name="subqueue-and-system-queue-caveat"></a><span data-ttu-id="5c0b5-142">Limitations relatives aux sous-files d'attente et aux files d'attente système</span><span class="sxs-lookup"><span data-stu-id="5c0b5-142">Subqueue and System Queue Caveat</span></span>  
 <span data-ttu-id="5c0b5-143">Une application hébergée par le service WAS ne peut pas être activée sur la base des messages présents dans une file d'attente système, telle que la file d'attente de lettres mortes à l'échelle du système, ou dans des sous-files d'attente, telles que les sous-files d'attente de poison.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-143">A WAS-hosted application cannot be activated based on messages in a system queue, such as the system-wide dead-letter queue, or sub-queues, such as poison sub-queues.</span></span> <span data-ttu-id="5c0b5-144">Il s'agit d'une limitation pour cette version du produit.</span><span class="sxs-lookup"><span data-stu-id="5c0b5-144">This is a limitation for this version of the product.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="5c0b5-145">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="5c0b5-145">See also</span></span>

- [<span data-ttu-id="5c0b5-146">Gestion des messages incohérents</span><span class="sxs-lookup"><span data-stu-id="5c0b5-146">Poison Message Handling</span></span>](../../../../docs/framework/wcf/feature-details/poison-message-handling.md)
- [<span data-ttu-id="5c0b5-147">Points de terminaison de service et adressage de files d’attente</span><span class="sxs-lookup"><span data-stu-id="5c0b5-147">Service Endpoints and Queue Addressing</span></span>](../../../../docs/framework/wcf/feature-details/service-endpoints-and-queue-addressing.md)

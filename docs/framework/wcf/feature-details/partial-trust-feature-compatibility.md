---
title: Compatibilité des fonctionnalités dans un environnement de confiance partielle
ms.date: 03/30/2017
ms.assetid: a36a540b-1606-4e63-88e0-b7c59e0e6ab7
ms.openlocfilehash: 3e0f1c2f673d4ba603df7da431d10c211cf779ac
ms.sourcegitcommit: 09b4090b78f52fd09b0e430cd4b26576f1fdf96e
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 01/17/2020
ms.locfileid: "76212122"
---
# <a name="partial-trust-feature-compatibility"></a><span data-ttu-id="b2580-102">Compatibilité des fonctionnalités dans un environnement de confiance partielle</span><span class="sxs-lookup"><span data-stu-id="b2580-102">Partial Trust Feature Compatibility</span></span>
<span data-ttu-id="b2580-103">Windows Communication Foundation (WCF) prend en charge un sous-ensemble limité de fonctionnalités lors de l’exécution dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-103">Windows Communication Foundation (WCF) supports a limited subset of functionality when running in a partially-trusted environment.</span></span> <span data-ttu-id="b2580-104">Les fonctionnalités de confiance partielle prises en charge sont conçues autour d’un ensemble spécifique de scénarios, comme décrit dans la rubrique [Supported Deployment Scenarios](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md) .</span><span class="sxs-lookup"><span data-stu-id="b2580-104">The features supported in partial trust are designed around a specific set of scenarios as described in the [Supported Deployment Scenarios](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md) topic.</span></span>  
  
## <a name="minimum-permission-requirements"></a><span data-ttu-id="b2580-105">Autorisations minimales requises</span><span class="sxs-lookup"><span data-stu-id="b2580-105">Minimum Permission Requirements</span></span>  
 <span data-ttu-id="b2580-106">WCF prend en charge un sous-ensemble de fonctionnalités dans les applications qui s’exécutent sous l’un des jeux d’autorisations nommés standard suivants :</span><span class="sxs-lookup"><span data-stu-id="b2580-106">WCF supports a subset of features in applications running under either of the following standard named permission sets:</span></span>  
  
- <span data-ttu-id="b2580-107">Autorisations de confiance moyenne</span><span class="sxs-lookup"><span data-stu-id="b2580-107">Medium Trust permissions</span></span>  
  
- <span data-ttu-id="b2580-108">Autorisations de la zone Internet</span><span class="sxs-lookup"><span data-stu-id="b2580-108">Internet Zone permissions</span></span>  
  
 <span data-ttu-id="b2580-109">Toute tentative d’utilisation de WCF dans des applications de confiance partielle avec des autorisations plus restrictives peut entraîner des exceptions de sécurité au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="b2580-109">Attempting to use WCF in partially-trusted applications with more restrictive permissions may result in security exceptions at runtime.</span></span>  
  
## <a name="contracts"></a><span data-ttu-id="b2580-110">Contrats</span><span class="sxs-lookup"><span data-stu-id="b2580-110">Contracts</span></span>  
 <span data-ttu-id="b2580-111">Les contrats sont soumis aux restrictions suivantes lors de leur exécution dans un environnement de confiance partielle :</span><span class="sxs-lookup"><span data-stu-id="b2580-111">Contracts are subject to the following restrictions when running under partial trust:</span></span>  
  
- <span data-ttu-id="b2580-112">La classe de service qui implémente l'interface `[ServiceContract]` doit être `public` et doit avoir un constructeur `public` .</span><span class="sxs-lookup"><span data-stu-id="b2580-112">The service class that implements the `[ServiceContract]` interface must be `public` and have a `public` constructor.</span></span> <span data-ttu-id="b2580-113">Si elle définit des méthodes `[OperationContract]` , celles-ci doivent être `public`.</span><span class="sxs-lookup"><span data-stu-id="b2580-113">If it defines `[OperationContract]` methods, these must be `public`.</span></span> <span data-ttu-id="b2580-114">Si, au lieu de cela, elle implémente une interface `[ServiceContract]` , ces implémentations de méthode peuvent être explicites ou `private`, pourvu que l'interface `[ServiceContract]` soit `public`.</span><span class="sxs-lookup"><span data-stu-id="b2580-114">If it instead implements a `[ServiceContract]` interface, those method implementations can be explicit or `private`, provided that the `[ServiceContract]` interface is `public`.</span></span>  
  
- <span data-ttu-id="b2580-115">Lors de l'utilisation de l'attribut `[ServiceKnownType]` , la méthode spécifiée doit être `public`.</span><span class="sxs-lookup"><span data-stu-id="b2580-115">When using the `[ServiceKnownType]` attribute, the method specified must be `public`.</span></span>  
  
- <span data-ttu-id="b2580-116">Les classes`[MessageContract]` et leurs membres peuvent être `public`.</span><span class="sxs-lookup"><span data-stu-id="b2580-116">`[MessageContract]` classes and their members can be `public`.</span></span> <span data-ttu-id="b2580-117">Si la classe `[MessageContract]` est définie dans l'assembly d'application, elle peut être `internal` et avoir des membres `internal` .</span><span class="sxs-lookup"><span data-stu-id="b2580-117">If the `[MessageContract]` class is defined in the application assembly it can be `internal` and have `internal` members.</span></span>  
  
## <a name="system-provided-bindings"></a><span data-ttu-id="b2580-118">Liaisons fournies par le système</span><span class="sxs-lookup"><span data-stu-id="b2580-118">System-Provided Bindings</span></span>  
 <span data-ttu-id="b2580-119"><xref:System.ServiceModel.BasicHttpBinding> et <xref:System.ServiceModel.WebHttpBinding> sont totalement pris en charge dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-119">The <xref:System.ServiceModel.BasicHttpBinding> and <xref:System.ServiceModel.WebHttpBinding> are fully supported in a partial trust environment.</span></span> <span data-ttu-id="b2580-120"><xref:System.ServiceModel.WSHttpBinding> est pris en charge uniquement pour le mode de sécurité Transport.</span><span class="sxs-lookup"><span data-stu-id="b2580-120">The <xref:System.ServiceModel.WSHttpBinding> is supported for Transport security mode only.</span></span>  
  
 <span data-ttu-id="b2580-121">Les liaisons qui utilisent des transports autres que HTTP, comme <xref:System.ServiceModel.NetTcpBinding>, <xref:System.ServiceModel.NetNamedPipeBinding>ou <xref:System.ServiceModel.NetMsmqBinding>, ne sont pas prises en charge lors de l'exécution dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-121">Bindings that use transports other than HTTP, such as the <xref:System.ServiceModel.NetTcpBinding>, the <xref:System.ServiceModel.NetNamedPipeBinding>, or the <xref:System.ServiceModel.NetMsmqBinding>, are not supported when running in a partial trust environment.</span></span>  
  
## <a name="custom-bindings"></a><span data-ttu-id="b2580-122">Liaisons personnalisées</span><span class="sxs-lookup"><span data-stu-id="b2580-122">Custom Bindings</span></span>  
 <span data-ttu-id="b2580-123">Les liaisons personnalisées peuvent être créées et utilisées dans un environnement de confiance partielle, mais elles doivent respecter les restrictions décrites dans cette section.</span><span class="sxs-lookup"><span data-stu-id="b2580-123">Custom bindings can be created and used in a partial trust environment, but must follow the restrictions specified in this section.</span></span>  
  
### <a name="transports"></a><span data-ttu-id="b2580-124">Transports</span><span class="sxs-lookup"><span data-stu-id="b2580-124">Transports</span></span>  
 <span data-ttu-id="b2580-125">Les seuls éléments de liaison de transport autorisés sont <xref:System.ServiceModel.Channels.HttpTransportBindingElement> et <xref:System.ServiceModel.Channels.HttpsTransportBindingElement>.</span><span class="sxs-lookup"><span data-stu-id="b2580-125">The only allowed transport binding elements are <xref:System.ServiceModel.Channels.HttpTransportBindingElement> and <xref:System.ServiceModel.Channels.HttpsTransportBindingElement>.</span></span>  
  
### <a name="encoders"></a><span data-ttu-id="b2580-126">Encodeurs</span><span class="sxs-lookup"><span data-stu-id="b2580-126">Encoders</span></span>  
 <span data-ttu-id="b2580-127">Les encodeurs suivants sont autorisés :</span><span class="sxs-lookup"><span data-stu-id="b2580-127">The following encoders are allowed:</span></span>  
  
- <span data-ttu-id="b2580-128">Encodeur de texte (<xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>).</span><span class="sxs-lookup"><span data-stu-id="b2580-128">The text encoder (<xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>).</span></span>  
  
- <span data-ttu-id="b2580-129">Encodeur binaire (<xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>).</span><span class="sxs-lookup"><span data-stu-id="b2580-129">The binary encoder (<xref:System.ServiceModel.Channels.BinaryMessageEncodingBindingElement>).</span></span>  
  
- <span data-ttu-id="b2580-130">Encodeur de message Web (<xref:System.ServiceModel.Channels.WebMessageEncodingBindingElement>).</span><span class="sxs-lookup"><span data-stu-id="b2580-130">The Web Message encoder (<xref:System.ServiceModel.Channels.WebMessageEncodingBindingElement>).</span></span>  
  
 <span data-ttu-id="b2580-131">Les encodeurs MTOM (Message Transmission Optimization Mechanism) ne sont pas pris en charge.</span><span class="sxs-lookup"><span data-stu-id="b2580-131">The Message Transmission Optimization Mechanism (MTOM) encoders are not supported.</span></span>  
  
### <a name="security"></a><span data-ttu-id="b2580-132">Sécurité</span><span class="sxs-lookup"><span data-stu-id="b2580-132">Security</span></span>  
 <span data-ttu-id="b2580-133">Les applications de confiance partielle peuvent utiliser les fonctionnalités de sécurité au niveau du transport de WCF pour sécuriser leur communication.</span><span class="sxs-lookup"><span data-stu-id="b2580-133">Partially-trusted applications can use WCF's transport-level security features for securing their communication.</span></span> <span data-ttu-id="b2580-134">La sécurité au niveau message n'est pas prise en charge.</span><span class="sxs-lookup"><span data-stu-id="b2580-134">Message-level security is not supported.</span></span> <span data-ttu-id="b2580-135">La configuration d'une liaison pour utiliser la sécurité au niveau message entraîne une exception pendant l'exécution.</span><span class="sxs-lookup"><span data-stu-id="b2580-135">Configuring a binding to use message-level security results in an exception at runtime.</span></span>  
  
### <a name="unsupported-bindings"></a><span data-ttu-id="b2580-136">Liaisons non prises en charge</span><span class="sxs-lookup"><span data-stu-id="b2580-136">Unsupported Bindings</span></span>  
 <span data-ttu-id="b2580-137">Les liaisons qui utilisent une messagerie fiable, des transactions ou une sécurité au niveau du message ne sont pas prises en charge.</span><span class="sxs-lookup"><span data-stu-id="b2580-137">Bindings that use reliable messaging, transactions, or message-level security are not supported.</span></span>  
  
## <a name="serialization"></a><span data-ttu-id="b2580-138">Sérialisation</span><span class="sxs-lookup"><span data-stu-id="b2580-138">Serialization</span></span>  
 <span data-ttu-id="b2580-139">Le <xref:System.Runtime.Serialization.DataContractSerializer> et le <xref:System.Xml.Serialization.XmlSerializer> sont pris en charge dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-139">Both the <xref:System.Runtime.Serialization.DataContractSerializer> and the <xref:System.Xml.Serialization.XmlSerializer> are supported in a partial trust environment.</span></span> <span data-ttu-id="b2580-140">Toutefois, l'utilisation du <xref:System.Runtime.Serialization.DataContractSerializer> est soumise aux conditions suivantes :</span><span class="sxs-lookup"><span data-stu-id="b2580-140">However, use of the <xref:System.Runtime.Serialization.DataContractSerializer> is subject to the following conditions:</span></span>  
  
- <span data-ttu-id="b2580-141">Tous les types `[DataContract]` sérialisables doivent être `public`.</span><span class="sxs-lookup"><span data-stu-id="b2580-141">All serializable `[DataContract]` types must be `public`.</span></span>  
  
- <span data-ttu-id="b2580-142">Tous les champs ou les propriétés `[DataMember]` sérialisables dans un type `[DataContract]` doivent être "public" et en lecture/écriture.</span><span class="sxs-lookup"><span data-stu-id="b2580-142">All serializable `[DataMember]` fields or properties in a `[DataContract]` type must be public and read/write.</span></span> <span data-ttu-id="b2580-143">La sérialisation et la désérialisation des champs [ReadOnly](https://go.microsoft.com/fwlink/?LinkID=98854) ne sont pas prises en charge lors de l’exécution de WCF dans une application de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-143">The serialization and deserialization of [readonly](https://go.microsoft.com/fwlink/?LinkID=98854) fields is not supported when running WCF in a partially-trusted application.</span></span>  
  
- <span data-ttu-id="b2580-144">Le modèle de programmation `[Serializable]`/ISerializable n'est pas pris en charge dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-144">The `[Serializable]`/ISerializable programming model is not supported in a partial trust environment.</span></span>  
  
- <span data-ttu-id="b2580-145">Les types connus doivent être spécifiés dans le code ou la configuration au niveau de l'ordinateur (machine.config).</span><span class="sxs-lookup"><span data-stu-id="b2580-145">Known types must be specified in code or machine-level configuration (machine.config).</span></span> <span data-ttu-id="b2580-146">Les types connus ne peuvent pas être spécifiés dans la configuration au niveau de l'application pour des raisons de sécurité.</span><span class="sxs-lookup"><span data-stu-id="b2580-146">Known types cannot be specified in application-level configuration for security reasons.</span></span>  
  
- <span data-ttu-id="b2580-147">Les types qui implémentent <xref:System.Runtime.Serialization.IObjectReference> lèvent une exception dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-147">Types that implement <xref:System.Runtime.Serialization.IObjectReference> throw an exception in a partially-trusted environment.</span></span>  
  
 <span data-ttu-id="b2580-148">Consultez la section Sérialisation de [Partial Trust Best Practices](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md) pour plus d’informations sur la sécurité lors de l’utilisation de <xref:System.Runtime.Serialization.DataContractSerializer> dans une application partiellement fiable.</span><span class="sxs-lookup"><span data-stu-id="b2580-148">See the Serialization section in [Partial Trust Best Practices](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md) for more information about security when using <xref:System.Runtime.Serialization.DataContractSerializer> safely in a partially-trusted application.</span></span>  
  
### <a name="collection-types"></a><span data-ttu-id="b2580-149">Types de collection</span><span class="sxs-lookup"><span data-stu-id="b2580-149">Collection Types</span></span>  
 <span data-ttu-id="b2580-150">Certains types de collection implémentent <xref:System.Collections.Generic.IEnumerable%601> et <xref:System.Collections.IEnumerable>.</span><span class="sxs-lookup"><span data-stu-id="b2580-150">Some collection types implement both <xref:System.Collections.Generic.IEnumerable%601> and <xref:System.Collections.IEnumerable>.</span></span> <span data-ttu-id="b2580-151">Les exemples incluent des types qui implémentent <xref:System.Collections.Generic.ICollection%601>.</span><span class="sxs-lookup"><span data-stu-id="b2580-151">Examples include types that implement <xref:System.Collections.Generic.ICollection%601>.</span></span> <span data-ttu-id="b2580-152">Ces types peuvent mettre en œuvre une implémentation `public` de `GetEnumerator()`et une implémentation explicite de `GetEnumerator()`.</span><span class="sxs-lookup"><span data-stu-id="b2580-152">Such types can implement a `public` implementation of `GetEnumerator()`, and an explicit implementation of `GetEnumerator()`.</span></span> <span data-ttu-id="b2580-153">Dans ce cas, <xref:System.Runtime.Serialization.DataContractSerializer> appelle l'implémentation `public` de `GetEnumerator()`et non l'implémentation explicite de `GetEnumerator()`.</span><span class="sxs-lookup"><span data-stu-id="b2580-153">In this case, <xref:System.Runtime.Serialization.DataContractSerializer> invokes the `public` implementation of `GetEnumerator()`, and not the explicit implementation of `GetEnumerator()`.</span></span> <span data-ttu-id="b2580-154">Si aucune des implémentations de `GetEnumerator()` n’est `public` et que toutes sont des implémentations explicites, <xref:System.Runtime.Serialization.DataContractSerializer> appelle `IEnumerable.GetEnumerator()`.</span><span class="sxs-lookup"><span data-stu-id="b2580-154">If none of the `GetEnumerator()` implementations are `public` and all are explicit implementations, then <xref:System.Runtime.Serialization.DataContractSerializer> invokes `IEnumerable.GetEnumerator()`.</span></span>  
  
 <span data-ttu-id="b2580-155">Pour les types de collection lorsque WCF s’exécute dans un environnement de confiance partielle, si aucune des implémentations de `GetEnumerator()` n’est `public`ou si aucun d’eux n’est une implémentation d’interface explicite, une exception de sécurité est levée.</span><span class="sxs-lookup"><span data-stu-id="b2580-155">For collection types when WCF is running in a partial trust environment, if none of the `GetEnumerator()` implementations are `public`, or none of them are explicit interface implementations, then a security exception is thrown.</span></span>  
  
### <a name="netdatacontractserializer"></a><span data-ttu-id="b2580-156">NetDataContractSerializer</span><span class="sxs-lookup"><span data-stu-id="b2580-156">NetDataContractSerializer</span></span>  
 <span data-ttu-id="b2580-157">De nombreux types de collection .NET Framework, tels que <xref:System.Collections.Generic.List%601>, <xref:System.Collections.ArrayList>, <xref:System.Collections.Generic.Dictionary%602> et <xref:System.Collections.Hashtable> ne sont pas pris en charge par le <xref:System.Runtime.Serialization.NetDataContractSerializer> dans l'environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-157">Many .NET Framework collection types such as <xref:System.Collections.Generic.List%601>, <xref:System.Collections.ArrayList>, <xref:System.Collections.Generic.Dictionary%602> and <xref:System.Collections.Hashtable> are not supported by the <xref:System.Runtime.Serialization.NetDataContractSerializer> in partial trust.</span></span> <span data-ttu-id="b2580-158">L'attribut `[Serializable]` de ces types est défini et, comme indiqué précédemment à la section Sérialisation, cet attribut n'est pas pris en charge dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-158">These types have the `[Serializable]` attribute set, and as stated previously in the Serialization section, this attribute is not supported in partial trust.</span></span> <span data-ttu-id="b2580-159">Le <xref:System.Runtime.Serialization.DataContractSerializer> traite les collections de manière spéciale et peut ainsi contourner cette restriction ; en revanche, le <xref:System.Runtime.Serialization.NetDataContractSerializer> n'a pas de tel mécanisme pour contourner cette restriction.</span><span class="sxs-lookup"><span data-stu-id="b2580-159">The <xref:System.Runtime.Serialization.DataContractSerializer> treats collections in a special way and is thus able to get around this restriction, but the <xref:System.Runtime.Serialization.NetDataContractSerializer> has no such mechanism to circumvent this restriction.</span></span>  
  
 <span data-ttu-id="b2580-160">Le type <xref:System.DateTimeOffset> n'est pas pris en charge par le <xref:System.Runtime.Serialization.NetDataContractSerializer> dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-160">The <xref:System.DateTimeOffset> type is not supported by the <xref:System.Runtime.Serialization.NetDataContractSerializer> in partial trust.</span></span>  
  
 <span data-ttu-id="b2580-161">Il n'est pas possible d'utiliser un substitut avec le <xref:System.Runtime.Serialization.NetDataContractSerializer> (à l'aide du mécanisme <xref:System.Runtime.Serialization.SurrogateSelector> ) lors de son exécution dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-161">A surrogate cannot be used with the <xref:System.Runtime.Serialization.NetDataContractSerializer> (using the <xref:System.Runtime.Serialization.SurrogateSelector> mechanism) when running in partial trust.</span></span> <span data-ttu-id="b2580-162">Notez que cette restriction s'applique à l'utilisation d'un substitut, pas à sa sérialisation.</span><span class="sxs-lookup"><span data-stu-id="b2580-162">Note that this restriction applies to using a surrogate, not to serializing it.</span></span>  
  
## <a name="enabling-common-behaviors-to-run"></a><span data-ttu-id="b2580-163">Activation de l'exécution des comportements courants</span><span class="sxs-lookup"><span data-stu-id="b2580-163">Enabling Common Behaviors to Run</span></span>  
 <span data-ttu-id="b2580-164">Les comportements de service ou de point de terminaison non marqués avec l’attribut <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) qui sont ajoutés à la section [\<commonBehaviors >](../../../../docs/framework/configure-apps/file-schema/wcf/commonbehaviors.md) d’un fichier de configuration ne sont pas exécutés quand l’application s’exécute dans un environnement de confiance partielle et aucune exception n’est levée lorsque cela se produit.</span><span class="sxs-lookup"><span data-stu-id="b2580-164">Service or endpoint behaviors not marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute (APTCA) that are added to the [\<commonBehaviors>](../../../../docs/framework/configure-apps/file-schema/wcf/commonbehaviors.md) section of a configuration file are not run when the application runs in a partial trust environment and no exception is thrown when this occurs.</span></span> <span data-ttu-id="b2580-165">Pour appliquer l'exécution des comportements courants, vous devez effectuer l'une des actions suivantes :</span><span class="sxs-lookup"><span data-stu-id="b2580-165">To enforce the running of common behaviors, you must do one of the following options:</span></span>  
  
- <span data-ttu-id="b2580-166">Marquez votre comportement courant avec l'attribut <xref:System.Security.AllowPartiallyTrustedCallersAttribute> afin qu'il soit exécuté lorsqu'il est déployé comme une application de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-166">Mark your common behavior with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> attribute so that it can run when deployed as a partial trust application.</span></span> <span data-ttu-id="b2580-167">Notez qu'une entrée de Registre peut être définie sur l'ordinateur pour interdire l'exécution des assemblys marqués avec l'attribut APTCA.</span><span class="sxs-lookup"><span data-stu-id="b2580-167">Note that a registry entry can be set on the computer to prevent APTCA-marked assemblies from running.</span></span> <span data-ttu-id="b2580-168">.</span><span class="sxs-lookup"><span data-stu-id="b2580-168">.</span></span>  
  
- <span data-ttu-id="b2580-169">Si l'application est déployée comme une application de confiance partielle, vérifiez que les utilisateurs ne peuvent pas modifier les paramètres de sécurité d'accès du code pour exécuter l'application dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-169">Ensure that if the application is deployed as a fully-trusted application that users cannot modify the code-access security settings to run the application in a partial trust environment.</span></span> <span data-ttu-id="b2580-170">S'ils peuvent le faire, le comportement ne s'exécute pas et aucune exception n'est levée.</span><span class="sxs-lookup"><span data-stu-id="b2580-170">If they can do so, the behavior does not run and no exception is thrown.</span></span> <span data-ttu-id="b2580-171">Pour ce faire, consultez l’option **LevelFinal** à l’aide de [Caspol. exe (outil stratégie de sécurité d’accès du code)](../../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md).</span><span class="sxs-lookup"><span data-stu-id="b2580-171">To ensure this, see the **levelfinal** option using [Caspol.exe (Code Access Security Policy Tool)](../../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md).</span></span>  
  
 <span data-ttu-id="b2580-172">Pour obtenir un exemple de comportement courant, consultez [Comment : verrouiller des points de terminaison dans l’entreprise](../../../../docs/framework/wcf/extending/how-to-lock-down-endpoints-in-the-enterprise.md).</span><span class="sxs-lookup"><span data-stu-id="b2580-172">For an example of a common behavior, see [How to: Lock Down Endpoints in the Enterprise](../../../../docs/framework/wcf/extending/how-to-lock-down-endpoints-in-the-enterprise.md).</span></span>  
  
## <a name="configuration"></a><span data-ttu-id="b2580-173">Configuration</span><span class="sxs-lookup"><span data-stu-id="b2580-173">Configuration</span></span>  
 <span data-ttu-id="b2580-174">À une exception près, le code d’un niveau de confiance partiel ne peut charger que les sections de configuration WCF dans le fichier de `app.config` local.</span><span class="sxs-lookup"><span data-stu-id="b2580-174">With one exception, partially-trusted code can only load WCF configuration sections in the local `app.config` file.</span></span> <span data-ttu-id="b2580-175">Pour charger des sections de configuration WCF qui référencent des sections WCF dans machine. config ou dans un fichier Web. config racine, vous devez disposer de une autorisation ConfigurationPermission (sans restriction).</span><span class="sxs-lookup"><span data-stu-id="b2580-175">To load WCF configuration sections that reference WCF sections in machine.config or in a root web.config file requires ConfigurationPermission(Unrestricted).</span></span> <span data-ttu-id="b2580-176">Sans cette autorisation, les références aux sections de configuration WCF (comportements, liaisons) en dehors du fichier de configuration local entraînent une exception lorsque la configuration est chargée.</span><span class="sxs-lookup"><span data-stu-id="b2580-176">Without this permission, references to WCF configuration sections (behaviors, bindings) outside of the local configuration file results in an exception when the configuration is loaded.</span></span>  
  
 <span data-ttu-id="b2580-177">L'unique exception est la configuration de type connu pour la sérialisation, comme décrit à la section Sérialisation de cette rubrique.</span><span class="sxs-lookup"><span data-stu-id="b2580-177">The one exception is known-type configuration for serialization, as described in the Serialization section of this topic.</span></span>  
  
> [!IMPORTANT]
> <span data-ttu-id="b2580-178">Les extensions de configuration ne sont prises en charge que lors de l'exécution à un niveau de confiance totale.</span><span class="sxs-lookup"><span data-stu-id="b2580-178">Configuration extensions are only supported when running under Full Trust.</span></span>  
  
## <a name="diagnostics"></a><span data-ttu-id="b2580-179">Diagnostics</span><span class="sxs-lookup"><span data-stu-id="b2580-179">Diagnostics</span></span>  
  
### <a name="event-logging"></a><span data-ttu-id="b2580-180">Journalisation des événements</span><span class="sxs-lookup"><span data-stu-id="b2580-180">Event Logging</span></span>  
 <span data-ttu-id="b2580-181">La journalisation des événements limitée est prise en charge dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-181">Limited event logging is supported under partial trust.</span></span> <span data-ttu-id="b2580-182">Seul les échecs d'activation de service et les échecs de suivi/journalisation de message sont consignés dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="b2580-182">Only service activation faults and tracing/message logging failures are logged to the Event Log.</span></span> <span data-ttu-id="b2580-183">Le nombre d'événements maximal qui peuvent être enregistrés par un processus est égal à 5, pour éviter d'écrire un trop grand nombre de messages dans le journal des événements.</span><span class="sxs-lookup"><span data-stu-id="b2580-183">The maximum number of events that can be logged by a process is 5, to avoid writing excessive messages to the Event Log.</span></span>  
  
### <a name="message-logging"></a><span data-ttu-id="b2580-184">Journalisation des messages</span><span class="sxs-lookup"><span data-stu-id="b2580-184">Message Logging</span></span>  
 <span data-ttu-id="b2580-185">L’enregistrement des messages ne fonctionne pas lorsque WCF est exécuté dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-185">Message logging does not work when WCF is run in a partial trust environment.</span></span> <span data-ttu-id="b2580-186">En cas d'activation avec un niveau de confiance partiel, il ne met pas en échec l'activation du service, mais aucun message n'est enregistré.</span><span class="sxs-lookup"><span data-stu-id="b2580-186">If enabled under partial trust, it does not fail service activation, but no message is logged.</span></span>  
  
### <a name="tracing"></a><span data-ttu-id="b2580-187">Traçage</span><span class="sxs-lookup"><span data-stu-id="b2580-187">Tracing</span></span>  
 <span data-ttu-id="b2580-188">Des fonctionnalités de traçage restreintes sont disponibles lors de l'exécution dans un environnement de confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-188">Restricted tracing functionality is available when running in a partial trust environment.</span></span> <span data-ttu-id="b2580-189">Dans le <`listeners`élément > dans le fichier de configuration, les seuls types que vous pouvez ajouter sont <xref:System.Diagnostics.TextWriterTraceListener> et le nouveau <xref:System.Diagnostics.EventSchemaTraceListener>.</span><span class="sxs-lookup"><span data-stu-id="b2580-189">In the <`listeners`> element in the configuration file, the only types that you can add are <xref:System.Diagnostics.TextWriterTraceListener> and the new <xref:System.Diagnostics.EventSchemaTraceListener>.</span></span> <span data-ttu-id="b2580-190">L'utilisation de <xref:System.Diagnostics.XmlWriterTraceListener> standard peut provoquer des journaux incomplets ou incorrects.</span><span class="sxs-lookup"><span data-stu-id="b2580-190">Use of the standard <xref:System.Diagnostics.XmlWriterTraceListener> may result in incomplete or incorrect logs.</span></span>  
  
 <span data-ttu-id="b2580-191">Les sources de suivi prises en charge sont :</span><span class="sxs-lookup"><span data-stu-id="b2580-191">Supported trace sources are:</span></span>  
  
- <xref:System.ServiceModel>  
  
- <xref:System.Runtime.Serialization>  
  
- <span data-ttu-id="b2580-192"><xref:System.IdentityModel.Claims>, <xref:System.IdentityModel.Policy>, <xref:System.IdentityModel.Selectors>et <xref:System.IdentityModel.Tokens>.</span><span class="sxs-lookup"><span data-stu-id="b2580-192"><xref:System.IdentityModel.Claims>, <xref:System.IdentityModel.Policy>, <xref:System.IdentityModel.Selectors>, and <xref:System.IdentityModel.Tokens>.</span></span>  
  
 <span data-ttu-id="b2580-193">Les sources de suivi suivantes ne sont pas prises en charge :</span><span class="sxs-lookup"><span data-stu-id="b2580-193">The following trace sources are not supported:</span></span>  
  
- <span data-ttu-id="b2580-194">CardSpace</span><span class="sxs-lookup"><span data-stu-id="b2580-194">CardSpace</span></span>  
  
- <xref:System.IO.Log>  

- <span data-ttu-id="b2580-195">[System.ServiceModel.Internal.TransactionBridge](https://docs.microsoft.com/previous-versions/aa346556(v=vs.110))]</span><span class="sxs-lookup"><span data-stu-id="b2580-195">[System.ServiceModel.Internal.TransactionBridge](https://docs.microsoft.com/previous-versions/aa346556(v=vs.110))]</span></span>
  
 <span data-ttu-id="b2580-196">Les membres suivants de l'énumération <xref:System.Diagnostics.TraceOptions> ne doivent pas être spécifiés:</span><span class="sxs-lookup"><span data-stu-id="b2580-196">The following members of the <xref:System.Diagnostics.TraceOptions> enumeration should not be specified:</span></span>  
  
- <xref:System.Diagnostics.TraceOptions.Callstack?displayProperty=nameWithType>  
  
- <xref:System.Diagnostics.TraceOptions.ProcessId?displayProperty=nameWithType>  
  
 <span data-ttu-id="b2580-197">Lors de l'utilisation du traçage dans un environnement de confiance partielle, assurez-vous que l'application dispose des autorisations nécessaires pour stocker la sortie de l'écouteur de trace.</span><span class="sxs-lookup"><span data-stu-id="b2580-197">When using tracing in a partial trust environment, ensure that the application has sufficient permissions to store the output of the trace listener.</span></span> <span data-ttu-id="b2580-198">Par exemple, lors de l'utilisation de <xref:System.Diagnostics.TextWriterTraceListener> pour écrire le résultat du traçage dans un fichier texte, assurez-vous que l'application bénéficie de l'autorisation FileIOPermission requise pour écrire dans le fichier de trace.</span><span class="sxs-lookup"><span data-stu-id="b2580-198">For example, when using the <xref:System.Diagnostics.TextWriterTraceListener> to write trace output to a text file, ensure that the application has the necessary FileIOPermission required to successfully write to the trace file.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="b2580-199">Pour éviter de saturer les fichiers de trace avec des erreurs en double, WCF désactive le suivi de la ressource ou de l’action après le premier échec de sécurité.</span><span class="sxs-lookup"><span data-stu-id="b2580-199">To avoid flooding the trace files with duplicate errors, WCF disables tracing of the resource or action after the first security failure.</span></span> <span data-ttu-id="b2580-200">Une trace d'exception est créée pour chaque échec de l'accès aux ressources lors de la première tentative d'accès à la ressource ou d'accomplissement de l'action.</span><span class="sxs-lookup"><span data-stu-id="b2580-200">There is one exception trace for each failed resource access, the first time an attempt is made to access the resource or perform the action.</span></span>  
  
## <a name="wcf-service-host"></a><span data-ttu-id="b2580-201">Hôte de service WCF</span><span class="sxs-lookup"><span data-stu-id="b2580-201">WCF Service Host</span></span>  
 <span data-ttu-id="b2580-202">L’hôte de service WCF ne prend pas en charge la confiance partielle.</span><span class="sxs-lookup"><span data-stu-id="b2580-202">WCF service host does not support partial trust.</span></span> <span data-ttu-id="b2580-203">Si vous souhaitez utiliser un service WCF en confiance partielle, n’utilisez pas le modèle de projet Bibliothèque du service WCF dans Visual Studio pour générer votre service.</span><span class="sxs-lookup"><span data-stu-id="b2580-203">If you want to use a WCF service in partial trust, do not use the WCF Service Library Project template in Visual Studio to build your service.</span></span> <span data-ttu-id="b2580-204">Au lieu de cela, créez un nouveau site Web dans Visual Studio en choisissant le modèle de site Web du service WCF, qui peut héberger le service dans un serveur Web sur lequel la confiance partielle WCF est prise en charge.</span><span class="sxs-lookup"><span data-stu-id="b2580-204">Instead, create a new Web site in Visual Studio by choosing the WCF service Web site template, which can host the service in a Web server on which WCF partial trust is supported.</span></span>  
  
## <a name="other-limitations"></a><span data-ttu-id="b2580-205">Autres limitations</span><span class="sxs-lookup"><span data-stu-id="b2580-205">Other Limitations</span></span>  

  <span data-ttu-id="b2580-206">WCF est généralement limité aux considérations de sécurité imposées par l’application d’hébergement.</span><span class="sxs-lookup"><span data-stu-id="b2580-206">WCF is generally limited to the security considerations imposed upon it by the hosting application.</span></span> <span data-ttu-id="b2580-207">Par exemple, si WCF est hébergé dans une application de navigateur XAML (XBAP), il est soumis aux limitations XBAP, comme décrit dans [Windows Presentation Foundation sécurité de confiance partielle](../../wpf/wpf-partial-trust-security.md).</span><span class="sxs-lookup"><span data-stu-id="b2580-207">For example, if WCF is hosted in a XAML Browser Application (XBAP), it is subject to XBAP limitations, as described in [Windows Presentation Foundation Partial Trust Security](../../wpf/wpf-partial-trust-security.md).</span></span>  
  
 <span data-ttu-id="b2580-208">Les fonctionnalités supplémentaires suivantes ne sont pas activées en cas d’exécution d’indigo2 dans un environnement de confiance partielle :</span><span class="sxs-lookup"><span data-stu-id="b2580-208">The following additional features are not enabled when running indigo2 in a partial trust environment:</span></span>  
  
- <span data-ttu-id="b2580-209">Windows Management Instrumentation (WMI)</span><span class="sxs-lookup"><span data-stu-id="b2580-209">Windows Management Instrumentation (WMI)</span></span>  
  
- <span data-ttu-id="b2580-210">La journalisation des événements n'est activée que partiellement (consultez la discussion dans la section **Diagnostics** ).</span><span class="sxs-lookup"><span data-stu-id="b2580-210">Event logging is only partially enabled (see discussion in **Diagnostics** section).</span></span>  
  
- <span data-ttu-id="b2580-211">Compteurs de performances</span><span class="sxs-lookup"><span data-stu-id="b2580-211">Performance counters</span></span>  
  
 <span data-ttu-id="b2580-212">L’utilisation de fonctionnalités WCF qui ne sont pas prises en charge dans un environnement de confiance partielle peut entraîner des exceptions au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="b2580-212">Use of WCF features that are not supported in a partial trust environment may result in exceptions at runtime.</span></span>  
  
## <a name="unlisted-features"></a><span data-ttu-id="b2580-213">Fonctionnalités non répertoriées</span><span class="sxs-lookup"><span data-stu-id="b2580-213">Unlisted Features</span></span>  
 <span data-ttu-id="b2580-214">La meilleure méthode pour découvrir qu'une information ou qu'une action n'est pas disponible en cas d'exécution dans un environnement de confiance partielle est d'essayer d'accéder à la ressource ou d'exécuter l'action dans un bloc `try` , puis d'intercepter l'échec via `catch` .</span><span class="sxs-lookup"><span data-stu-id="b2580-214">The best way to discover that a piece of information or action is unavailable when running in a partial trust environment is to try to access the resource or do the action inside of a `try` block, and then `catch` the failure.</span></span> <span data-ttu-id="b2580-215">Pour éviter de saturer les fichiers de trace avec des erreurs en double, WCF désactive le suivi de la ressource ou de l’action après le premier échec de sécurité.</span><span class="sxs-lookup"><span data-stu-id="b2580-215">To avoid flooding the trace files with duplicate errors, WCF disables tracing of the resource or action after the first security failure.</span></span> <span data-ttu-id="b2580-216">Une trace d'exception est créée pour chaque échec de l'accès aux ressources lors de la première tentative d'accès à la ressource ou d'accomplissement de l'action.</span><span class="sxs-lookup"><span data-stu-id="b2580-216">There is one exception trace for each failed resource access, the first time an attempt is made to access the resource or perform the action.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b2580-217">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="b2580-217">See also</span></span>

- <xref:System.ServiceModel.Channels.HttpTransportBindingElement>
- <xref:System.ServiceModel.Channels.HttpsTransportBindingElement>
- <xref:System.ServiceModel.Channels.TextMessageEncodingBindingElement>
- <xref:System.ServiceModel.Channels.WebMessageEncodingBindingElement>
- [<span data-ttu-id="b2580-218">Scénarios de déploiement pris en charge</span><span class="sxs-lookup"><span data-stu-id="b2580-218">Supported Deployment Scenarios</span></span>](../../../../docs/framework/wcf/feature-details/supported-deployment-scenarios.md)
- [<span data-ttu-id="b2580-219">Partial Trust Best Practices</span><span class="sxs-lookup"><span data-stu-id="b2580-219">Partial Trust Best Practices</span></span>](../../../../docs/framework/wcf/feature-details/partial-trust-best-practices.md)

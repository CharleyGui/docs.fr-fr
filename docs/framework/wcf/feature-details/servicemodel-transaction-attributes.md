---
title: Attributs de transaction ServiceModel
ms.date: 03/30/2017
helpviewer_keywords:
- transactions [WCF], ServiceModel attributes
ms.assetid: 1e0d2436-6ae5-439b-9765-a448d6f60000
ms.openlocfilehash: 8f8a50dc82c073c9357209a4dbeeed6c8b075695
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "64586150"
---
# <a name="servicemodel-transaction-attributes"></a><span data-ttu-id="d0cab-102">Attributs de transaction ServiceModel</span><span class="sxs-lookup"><span data-stu-id="d0cab-102">ServiceModel Transaction Attributes</span></span>
<span data-ttu-id="d0cab-103">Windows Communication Foundation (WCF) fournit des propriétés sur trois standard <xref:System.ServiceModel> attributs qui vous permettent de configurer le comportement des transactions pour un service WCF :</span><span class="sxs-lookup"><span data-stu-id="d0cab-103">Windows Communication Foundation (WCF) provides properties on three standard <xref:System.ServiceModel> attributes that enable you to configure the behavior of transactions for a WCF service:</span></span>  
  
- <xref:System.ServiceModel.TransactionFlowAttribute>  
  
- <xref:System.ServiceModel.ServiceBehaviorAttribute>  
  
- <xref:System.ServiceModel.OperationBehaviorAttribute>  
  
## <a name="transactionflowattribute"></a><span data-ttu-id="d0cab-104">TransactionFlowAttribute</span><span class="sxs-lookup"><span data-stu-id="d0cab-104">TransactionFlowAttribute</span></span>  
 <span data-ttu-id="d0cab-105">L’attribut <xref:System.ServiceModel.TransactionFlowAttribute> spécifie la disposition d’une opération de contrat de service à accepter les transactions entrantes provenant d’un client.</span><span class="sxs-lookup"><span data-stu-id="d0cab-105">The <xref:System.ServiceModel.TransactionFlowAttribute> attribute specifies the willingness of an operation in a service contract to accept incoming transactions from a client.</span></span> <span data-ttu-id="d0cab-106">L’attribut fournit ce contrôle avec la propriété suivante : Les transactions utilisent le <xref:System.ServiceModel.TransactionFlowOption> énumération pour spécifier si une transaction entrante est <xref:System.ServiceModel.TransactionFlowOption.Mandatory>, <xref:System.ServiceModel.TransactionFlowOption.Allowed>, ou <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.</span><span class="sxs-lookup"><span data-stu-id="d0cab-106">The attribute provides this control with the following property: Transactions use the <xref:System.ServiceModel.TransactionFlowOption> enumeration to specify whether an incoming transaction is <xref:System.ServiceModel.TransactionFlowOption.Mandatory>, <xref:System.ServiceModel.TransactionFlowOption.Allowed>, or <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.</span></span>  
  
 <span data-ttu-id="d0cab-107">C'est le seul attribut qui associe des opérations de service à des interactions externes avec un client.</span><span class="sxs-lookup"><span data-stu-id="d0cab-107">This is the only attribute that relates service operations to external interactions with a client.</span></span> <span data-ttu-id="d0cab-108">Les attributs décrits dans les sections suivantes concernent l’utilisation de transactions dans l’exécution de l’opération.</span><span class="sxs-lookup"><span data-stu-id="d0cab-108">The attributes described in the following sections relate to the use of transactions within the execution of the operation.</span></span>  
  
## <a name="servicebehaviorattribute"></a><span data-ttu-id="d0cab-109">ServiceBehaviorAttribute</span><span class="sxs-lookup"><span data-stu-id="d0cab-109">ServiceBehaviorAttribute</span></span>  
 <span data-ttu-id="d0cab-110">L'attribut <xref:System.ServiceModel.ServiceBehaviorAttribute> spécifie le comportement d'exécution interne d'une implémentation de contrat de service.</span><span class="sxs-lookup"><span data-stu-id="d0cab-110">The <xref:System.ServiceModel.ServiceBehaviorAttribute> attribute specifies the internal execution behavior of a service contract implementation.</span></span> <span data-ttu-id="d0cab-111">Les propriétés spécifiques aux transactions de cet attribut incluent :</span><span class="sxs-lookup"><span data-stu-id="d0cab-111">Transaction-specific properties of this attribute include:</span></span>  
  
- <span data-ttu-id="d0cab-112"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> spécifie s'il faut terminer une transaction inachevée à la fermeture de la session.</span><span class="sxs-lookup"><span data-stu-id="d0cab-112"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> specifies whether to complete an uncompleted transaction when the session closes.</span></span> <span data-ttu-id="d0cab-113">La valeur par défaut de cette propriété est `false`.</span><span class="sxs-lookup"><span data-stu-id="d0cab-113">The default value for this property is `false`.</span></span> <span data-ttu-id="d0cab-114">Si cette propriété a la valeur `true`, et que la session entrante a été arrêtée normalement et n’a pas été fermée en raison d’erreurs client ou réseau, toute transaction inachevée est correctement exécutée.</span><span class="sxs-lookup"><span data-stu-id="d0cab-114">If this property is `true`, and the incoming session was gracefully shut down instead of closing due to network or client faults, any uncompleted transaction is successfully completed.</span></span> <span data-ttu-id="d0cab-115">Sinon, si cette propriété a la valeur `false` ou si la session n'a pas été correctement fermée, toute transaction inachevée est restaurée à la fermeture de la session.</span><span class="sxs-lookup"><span data-stu-id="d0cab-115">Otherwise, if this property is `false` or if the session was not gracefully closed, any uncompleted transaction is rolled back when the session closes.</span></span> <span data-ttu-id="d0cab-116">Si cette propriété a la valeur `true`, le canal entrant doit être basé sur la session.</span><span class="sxs-lookup"><span data-stu-id="d0cab-116">If this property is `true`, the incoming channel must be session-based.</span></span>  
  
- <span data-ttu-id="d0cab-117"><xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A> spécifie si l'instance de service sous-jacente est diffusée à la fin de l'exécution d'une transaction.</span><span class="sxs-lookup"><span data-stu-id="d0cab-117"><xref:System.ServiceModel.ServiceBehaviorAttribute.ReleaseServiceInstanceOnTransactionComplete%2A> specifies whether the underlying service instance is released when a transaction completes.</span></span> <span data-ttu-id="d0cab-118">La valeur par défaut de cette propriété est `true`.</span><span class="sxs-lookup"><span data-stu-id="d0cab-118">The default value for this property is `true`.</span></span> <span data-ttu-id="d0cab-119">Le message entrant suivant provoque la création d’une nouvelle instance sous-jacente, en ignorant les états par transaction que l’instance précédente a pu avoir.</span><span class="sxs-lookup"><span data-stu-id="d0cab-119">The next inbound message causes a new underlying instance to be created, discarding any per-transaction state that the previous instance might have held.</span></span> <span data-ttu-id="d0cab-120">La diffusion d'une instance de service est une action interne effectuée par le service et n'a aucun impact sur les connexions ou sessions existantes que les clients ont pu établir.</span><span class="sxs-lookup"><span data-stu-id="d0cab-120">Releasing a service instance is an internal action the service takes and has no impact on any existing connections or sessions that clients might have established.</span></span> <span data-ttu-id="d0cab-121">Cette fonctionnalité est équivalente à la fonction d’activation juste-à-temps fournie par COM+.</span><span class="sxs-lookup"><span data-stu-id="d0cab-121">This functionality is equivalent to the just-in-time activation feature COM+ provides.</span></span> <span data-ttu-id="d0cab-122">Si la propriété a la valeur `true`, <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> doit être égal à <xref:System.ServiceModel.ConcurrencyMode.Single>.</span><span class="sxs-lookup"><span data-stu-id="d0cab-122">If the property is `true`, <xref:System.ServiceModel.ServiceBehaviorAttribute.ConcurrencyMode%2A> must be equal to <xref:System.ServiceModel.ConcurrencyMode.Single>.</span></span> <span data-ttu-id="d0cab-123">Sinon, le service lève une exception de validation de configuration non valide au démarrage.</span><span class="sxs-lookup"><span data-stu-id="d0cab-123">Otherwise, the service throws an invalid configuration validation exception during startup.</span></span>  
  
- <span data-ttu-id="d0cab-124"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A> spécifie le niveau d'isolation à utiliser pour les transactions dans le service ; cette propriété prend l'une des valeurs <xref:System.Transactions.IsolationLevel>.</span><span class="sxs-lookup"><span data-stu-id="d0cab-124"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionIsolationLevel%2A> specifies the isolation level to use for transactions within the service; this property takes one of the <xref:System.Transactions.IsolationLevel> values.</span></span> <span data-ttu-id="d0cab-125">Si la propriété de niveau d’isolation locale est autre que <xref:System.Transactions.IsolationLevel.Unspecified>, le niveau d’isolation d’une transaction entrante doit correspondre au paramètre de cette propriété locale.</span><span class="sxs-lookup"><span data-stu-id="d0cab-125">If the local isolation level property is anything other than <xref:System.Transactions.IsolationLevel.Unspecified>, the isolation level of an incoming transaction must match the setting of this local property.</span></span> <span data-ttu-id="d0cab-126">Sinon, la transaction entrante est rejetée, et une erreur est renvoyée au client.</span><span class="sxs-lookup"><span data-stu-id="d0cab-126">Otherwise, the incoming transaction is rejected, and a fault is sent back to the client.</span></span> <span data-ttu-id="d0cab-127">Si <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> a la valeur `true`, et qu'aucune transaction n'est transmise, cette propriété détermine la valeur <xref:System.Transactions.IsolationLevel> à utiliser pour la transaction créée localement.</span><span class="sxs-lookup"><span data-stu-id="d0cab-127">If <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> is `true`, and no transaction is flowed, this property determines the <xref:System.Transactions.IsolationLevel> value to use for the locally created transaction.</span></span> <span data-ttu-id="d0cab-128">Si <xref:System.Transactions.IsolationLevel> a la valeur <xref:System.Transactions.IsolationLevel.Unspecified>, <xref:System.Transactions.IsolationLevel><xref:System.Transactions.IsolationLevel.Serializable> est utilisé.</span><span class="sxs-lookup"><span data-stu-id="d0cab-128">If <xref:System.Transactions.IsolationLevel> is set to <xref:System.Transactions.IsolationLevel.Unspecified>, <xref:System.Transactions.IsolationLevel><xref:System.Transactions.IsolationLevel.Serializable> is used.</span></span>  
  
- <span data-ttu-id="d0cab-129"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> spécifie le délai dans lequel une nouvelle transaction créée au niveau du service doit s'exécuter.</span><span class="sxs-lookup"><span data-stu-id="d0cab-129"><xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> specifies the time period within which a new transaction created at the service must complete.</span></span> <span data-ttu-id="d0cab-130">Si au terme de ce délai la transaction n’a pas été exécutée, elle échouera.</span><span class="sxs-lookup"><span data-stu-id="d0cab-130">If this time is reached and the transaction has not been completed, it will abort.</span></span> <span data-ttu-id="d0cab-131"><xref:System.TimeSpan> est utilisé comme délai d’attente <xref:System.Transactions.TransactionScope> pour les opérations dont <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> a la valeur `true` et pour lesquelles une nouvelle transaction a été créée.</span><span class="sxs-lookup"><span data-stu-id="d0cab-131">The <xref:System.TimeSpan> is used as the <xref:System.Transactions.TransactionScope> time-out for any operations that have <xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> set to `true` and for which a new transaction was created.</span></span> <span data-ttu-id="d0cab-132">Le délai d'attente correspond à la durée maximale autorisée entre la création de la transaction et l'exécution de la phase 1 du protocole de validation en deux phases.</span><span class="sxs-lookup"><span data-stu-id="d0cab-132">The time-out is the maximum allowed duration from the creation of the transaction to the completion of phase 1 in the two-phase commit protocol.</span></span> <span data-ttu-id="d0cab-133">La valeur du délai d'attente utilisée est toujours la valeur la plus petite entre la propriété <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> et le paramètre de configuration `transactionTimeout`.</span><span class="sxs-lookup"><span data-stu-id="d0cab-133">The time-out value used is always the lower value between the <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionTimeout%2A> property and the `transactionTimeout` configuration setting.</span></span>  
  
## <a name="operationbehaviorattribute"></a><span data-ttu-id="d0cab-134">OperationBehaviorAttribute</span><span class="sxs-lookup"><span data-stu-id="d0cab-134">OperationBehaviorAttribute</span></span>  
 <span data-ttu-id="d0cab-135">L'attribut <xref:System.ServiceModel.OperationBehaviorAttribute> spécifie les comportements des méthodes dans l'implémentation de service.</span><span class="sxs-lookup"><span data-stu-id="d0cab-135">The <xref:System.ServiceModel.OperationBehaviorAttribute> attribute specifies the behaviors of the methods in the service implementation.</span></span> <span data-ttu-id="d0cab-136">Vous pouvez l'utiliser pour indiquer le comportement d'exécution spécifique de l'opération.</span><span class="sxs-lookup"><span data-stu-id="d0cab-136">You can use it to indicate the operation's specific execution behavior.</span></span> <span data-ttu-id="d0cab-137">Propriétés de cet attribut n’affectent pas la description de Web Service Description Language (WSDL) du contrat de service et sont purement des éléments du modèle de programmation WCF qui activent des fonctionnalités courantes que les développeurs devraient sinon posséder pour implémenter eux-mêmes.</span><span class="sxs-lookup"><span data-stu-id="d0cab-137">Properties of this attribute do not affect the Web Service Description Language (WSDL) description of the service contract, and are purely elements of the WCF programming model that enable common features that developers otherwise have to implement themselves.</span></span>  
  
 <span data-ttu-id="d0cab-138">Cet attribut a les propriétés spécifiques aux transactions suivantes :</span><span class="sxs-lookup"><span data-stu-id="d0cab-138">This attribute has the following transaction-specific properties:</span></span>  
  
- <span data-ttu-id="d0cab-139"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> spécifie si une méthode doit s'exécuter dans une étendue de transaction active.</span><span class="sxs-lookup"><span data-stu-id="d0cab-139"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionScopeRequired%2A> specifies whether a method must execute within an active transaction scope.</span></span> <span data-ttu-id="d0cab-140">La valeur par défaut est `false`.</span><span class="sxs-lookup"><span data-stu-id="d0cab-140">The default is `false`.</span></span> <span data-ttu-id="d0cab-141">Si l’attribut <xref:System.ServiceModel.OperationBehaviorAttribute> n’est pas défini pour une méthode, cela implique également que cette méthode ne s’exécutera pas dans une transaction.</span><span class="sxs-lookup"><span data-stu-id="d0cab-141">If the <xref:System.ServiceModel.OperationBehaviorAttribute> attribute is not set for a method, it also implies that the method will not execute in a transaction.</span></span> <span data-ttu-id="d0cab-142">Si une étendue de transaction n'est pas requise pour une opération, les transactions présentes dans l'en-tête de message ne sont pas activées et restent en tant qu'éléments de <xref:System.ServiceModel.OperationContext.IncomingMessageProperties%2A> de <xref:System.ServiceModel.OperationContext>.</span><span class="sxs-lookup"><span data-stu-id="d0cab-142">If a transaction scope is not required for an operation, any transaction that is present within the message header is not activated and remains as an element of the <xref:System.ServiceModel.OperationContext.IncomingMessageProperties%2A> of the <xref:System.ServiceModel.OperationContext>.</span></span> <span data-ttu-id="d0cab-143">Si une étendue de transaction est requise pour une opération, la source de la transaction est dérivée de l’un des éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="d0cab-143">If a transaction scope is required for an operation, the source for the transaction is derived from one of the following:</span></span>  
  
    - <span data-ttu-id="d0cab-144">Si une transaction est transmise à partir du client, la méthode est exécutée sous une étendue de transaction créée à l'aide de cette transaction distribuée.</span><span class="sxs-lookup"><span data-stu-id="d0cab-144">If a transaction is flowed from the client, the method is executed under a transaction scope created using that distributed transaction.</span></span>  
  
    - <span data-ttu-id="d0cab-145">Avec un transport de mise en file d’attente, la transaction permettant de supprimer le message de la file d’attente est utilisée.</span><span class="sxs-lookup"><span data-stu-id="d0cab-145">With a queued transport, the transaction used to dequeue the message is used.</span></span> <span data-ttu-id="d0cab-146">Notez que la transaction utilisée n’est pas une transaction passée, en ce sens qu’elle n’a pas été fournie par l’expéditeur d’origine du message.</span><span class="sxs-lookup"><span data-stu-id="d0cab-146">Note that the transaction used is not a flowed transaction, in that it was not provided by the original sender of the message.</span></span>  
  
    - <span data-ttu-id="d0cab-147">Un transport personnalisé peut fournir une transaction à l'aide de `TransportTransactionProperty`.</span><span class="sxs-lookup"><span data-stu-id="d0cab-147">A custom transport can provide a transaction through the use of the `TransportTransactionProperty`.</span></span>  
  
    - <span data-ttu-id="d0cab-148">Si aucun des éléments ci-dessus ne fournit de source externe à une transaction, une nouvelle instance <xref:System.Transactions.Transaction> est créée immédiatement avant d'appeler la méthode.</span><span class="sxs-lookup"><span data-stu-id="d0cab-148">If none of the above provides an external source for a transaction, a new <xref:System.Transactions.Transaction> instance is created immediately prior to calling the method.</span></span>  
  
- <span data-ttu-id="d0cab-149"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A> spécifie si la transaction dans laquelle la méthode s'exécute est automatiquement effectuée si aucune exception non prise en charge n'est levée.</span><span class="sxs-lookup"><span data-stu-id="d0cab-149"><xref:System.ServiceModel.OperationBehaviorAttribute.TransactionAutoComplete%2A> specifies whether the transaction in which the method executes is automatically completed if no unhandled exceptions are thrown.</span></span> <span data-ttu-id="d0cab-150">Si cette propriété a la valeur `true`, l’infrastructure appelante marque automatiquement la transaction comme étant « exécutée » si la méthode utilisateur retourne une valeur sans lever d’exception.</span><span class="sxs-lookup"><span data-stu-id="d0cab-150">If this property is `true`, the calling infrastructure automatically marks the transaction as "completed" if the user method returns without throwing an exception.</span></span> <span data-ttu-id="d0cab-151">Si cette propriété a la valeur `false`, la transaction est jointe à l'instance et est uniquement marquée comme étant « exécutée » si le client appelle une méthode suivante marquée avec cette propriété définie à la valeur `true`, ou si une méthode suivante appelle explicitement <xref:System.ServiceModel.OperationContext.SetTransactionComplete%2A>.</span><span class="sxs-lookup"><span data-stu-id="d0cab-151">If this property is `false`, the transaction is attached to the instance, and is only marked as "completed" if the client calls a subsequent method that is marked with this property equal to `true`, or if a subsequent method explicitly calls <xref:System.ServiceModel.OperationContext.SetTransactionComplete%2A>.</span></span> <span data-ttu-id="d0cab-152">Si aucune de ces conditions n’est vérifiée, la transaction n’est jamais « exécutée », et la tâche contenue n’est pas validée, sauf si la propriété <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> a la valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="d0cab-152">Failure to perform either of these results in the transaction never being "completed," and the contained work is not committed, unless the <xref:System.ServiceModel.ServiceBehaviorAttribute.TransactionAutoCompleteOnSessionClose%2A> property is set to `true`.</span></span> <span data-ttu-id="d0cab-153">Si cette propriété a la valeur `true`, vous devez utiliser un canal avec une session, et <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> doit avoir la valeur <xref:System.ServiceModel.InstanceContextMode.PerSession>.</span><span class="sxs-lookup"><span data-stu-id="d0cab-153">If this property is set to `true`, you must use a channel with a session, and the <xref:System.ServiceModel.ServiceBehaviorAttribute.InstanceContextMode%2A> must be set to <xref:System.ServiceModel.InstanceContextMode.PerSession>.</span></span>

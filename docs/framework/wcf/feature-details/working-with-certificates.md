---
title: Utilisation des certificats
description: En savoir plus sur les fonctionnalités de certificat numérique X. 509 et leur utilisation dans WCF. Les ressources de cet article peuvent expliquer ces concepts plus en détail.
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- certificates [WCF]
ms.assetid: 6ffb8682-8f07-4a45-afbb-8d2487e9dbc3
ms.openlocfilehash: a12e723c763cdc3b9cf2105df9d0ee601f8bda1a
ms.sourcegitcommit: 27a15a55019f6b5f2733961738babe94aec0def3
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/15/2020
ms.locfileid: "90559016"
---
# <a name="working-with-certificates"></a><span data-ttu-id="571c4-104">Utilisation des certificats</span><span class="sxs-lookup"><span data-stu-id="571c4-104">Working with Certificates</span></span>

<span data-ttu-id="571c4-105">Pour programmer la sécurité relative à WCF (Windows Communication Foundation), les certificats numériques X.509 sont couramment utilisés pour authentifier les clients et les serveurs, ainsi que pour chiffrer et signer numériquement les messages.</span><span class="sxs-lookup"><span data-stu-id="571c4-105">To program Windows Communication Foundation (WCF) security, X.509 digital certificates are commonly used to authenticate clients and servers, encrypt, and digitally sign messages.</span></span> <span data-ttu-id="571c4-106">Cette rubrique décrit brièvement les fonctionnalités des certificats numériques X.509 et leur utilisation dans WCF. Elle inclut également des liens vers les rubriques qui présentent ces concepts de manière plus détaillée, ou qui montrent comment effectuer les tâches courantes à l’aide de WCF et des certificats.</span><span class="sxs-lookup"><span data-stu-id="571c4-106">This topic briefly explains X.509 digital certificate features and how to use them in WCF, and includes links to topics that explain these concepts further or that show how to accomplish common tasks using WCF and certificates.</span></span>

<span data-ttu-id="571c4-107">En bref, un certificat numérique fait partie d’une infrastructure *PKI* (infrastructure à clé publique). Il s’agit d’un système composé de certificats numériques, d’autorités de certification et d’autorités d’inscription qui permettent de vérifier et d’authentifier la validité de chaque partie impliquée dans une transaction électronique grâce à l’utilisation d’un chiffrement à clé publique.</span><span class="sxs-lookup"><span data-stu-id="571c4-107">In brief, a digital certificate is a part of a *public key infrastructure* (PKI), which is a system of digital certificates, certificate authorities, and other registration authorities that verify and authenticate the validity of each party involved in an electronic transaction through the use of public key cryptography.</span></span> <span data-ttu-id="571c4-108">Une autorité de certification émet des certificats qui comportent un ensemble de champs contenant des données telles que le *sujet* (entité pour laquelle le certificat est émis), les dates de validité (période de validité du certificat), l’émetteur (entité qui a émis le certificat) et la clé publique.</span><span class="sxs-lookup"><span data-stu-id="571c4-108">A certification authority issues certificates and each certificate has a set of fields that contain data, such as *subject* (the entity to which the certificate is issued), validity dates (when the certificate is valid), issuer (the entity that issued the certificate), and a public key.</span></span> <span data-ttu-id="571c4-109">Dans WCF, chacune de ces propriétés est traitée en tant que <xref:System.IdentityModel.Claims.Claim>, et chaque revendication est divisée en deux types : identité et droit.</span><span class="sxs-lookup"><span data-stu-id="571c4-109">In WCF, each of these properties is processed as a <xref:System.IdentityModel.Claims.Claim>, and each claim is further divided into two types: identity and right.</span></span> <span data-ttu-id="571c4-110">Pour plus d’informations sur les certificats X.509, consultez [Certificats de clé publique X.509](/windows/desktop/SecCertEnroll/about-x-509-public-key-certificates).</span><span class="sxs-lookup"><span data-stu-id="571c4-110">For more information about X.509 certificates see [X.509 Public Key Certificates](/windows/desktop/SecCertEnroll/about-x-509-public-key-certificates).</span></span> <span data-ttu-id="571c4-111">Pour plus d’informations sur les revendications et la notion d’autorisation dans WCF, consultez [Gestion des revendications et autorisation avec le modèle d’identité](managing-claims-and-authorization-with-the-identity-model.md).</span><span class="sxs-lookup"><span data-stu-id="571c4-111">For more information about Claims and Authorization in WCF see [Managing Claims and Authorization with the Identity Model](managing-claims-and-authorization-with-the-identity-model.md).</span></span> <span data-ttu-id="571c4-112">Pour plus d’informations sur l’implémentation d’une infrastructure à clé publique, consultez [Enterprise PKI with Windows Server 2012 R2 Active Directory Certificate Services](/archive/blogs/yungchou/enterprise-pki-with-windows-server-2012-r2-active-directory-certificate-services-part-1-of-2).</span><span class="sxs-lookup"><span data-stu-id="571c4-112">For more information about implementing a PKI, see [Enterprise PKI with Windows Server 2012 R2 Active Directory Certificate Services](/archive/blogs/yungchou/enterprise-pki-with-windows-server-2012-r2-active-directory-certificate-services-part-1-of-2).</span></span>

<span data-ttu-id="571c4-113">La principale fonction d’un certificat est d’authentifier l’identité du propriétaire du certificat auprès des autres parties.</span><span class="sxs-lookup"><span data-stu-id="571c4-113">The primary function of a certificate is to authenticate the identity of the owner of the certificate to others.</span></span> <span data-ttu-id="571c4-114">Un certificat contient la *clé publique* du propriétaire, alors que le propriétaire conserve la clé privée.</span><span class="sxs-lookup"><span data-stu-id="571c4-114">A certificate contains the *public key* of the owner, while the owner retains the private key.</span></span> <span data-ttu-id="571c4-115">Les clés publiques peuvent être utilisées pour chiffrer les messages envoyés au propriétaire du certificat.</span><span class="sxs-lookup"><span data-stu-id="571c4-115">The public key can be used to encrypt messages sent to the owner of the certificate.</span></span> <span data-ttu-id="571c4-116">Cependant, seul le propriétaire de la clé privée pourra déchiffrer ces messages.</span><span class="sxs-lookup"><span data-stu-id="571c4-116">Only the owner has access to the private key, so only the owner can decrypt those messages.</span></span>

<span data-ttu-id="571c4-117">Les certificats doivent être émis par une autorité de certification, c'est-à-dire le plus souvent par une partie tierce.</span><span class="sxs-lookup"><span data-stu-id="571c4-117">Certificates must be issued by a certification authority, which is often a third-party  issuer of certificates.</span></span> <span data-ttu-id="571c4-118">Les domaines Windows intègrent une autorité de certification pouvant être utilisée afin d'émettre des certificats pour les ordinateurs figurant sur ces domaines.</span><span class="sxs-lookup"><span data-stu-id="571c4-118">On a Windows domain, a certification authority is included that can be used to issue certificates to computers on the domain.</span></span>

## <a name="viewing-certificates"></a><span data-ttu-id="571c4-119">Affichage des certificats</span><span class="sxs-lookup"><span data-stu-id="571c4-119">Viewing Certificates</span></span>

<span data-ttu-id="571c4-120">Si vous souhaitez utiliser des certificats, vous devrez souvent les afficher et examiner leurs propriétés au préalable.</span><span class="sxs-lookup"><span data-stu-id="571c4-120">To work with certificates, it is often necessary to view them and examine their properties.</span></span> <span data-ttu-id="571c4-121">Pour ce faire, il vous suffit d'utiliser l'outil enfichable MMC (Microsoft Management Console).</span><span class="sxs-lookup"><span data-stu-id="571c4-121">This is easily done with the Microsoft Management Console (MMC) snap-in tool.</span></span> <span data-ttu-id="571c4-122">Pour plus d’informations, consultez la page [Affichage de certificats à l’aide du composant logiciel enfichable MMC](how-to-view-certificates-with-the-mmc-snap-in.md).</span><span class="sxs-lookup"><span data-stu-id="571c4-122">For more information, see [How to: View Certificates with the MMC Snap-in](how-to-view-certificates-with-the-mmc-snap-in.md).</span></span>

## <a name="certificate-stores"></a><span data-ttu-id="571c4-123">Magasin de certificats</span><span class="sxs-lookup"><span data-stu-id="571c4-123">Certificate Stores</span></span>

<span data-ttu-id="571c4-124">Les certificats sont stockés dans des magasins.</span><span class="sxs-lookup"><span data-stu-id="571c4-124">Certificates are found in stores.</span></span> <span data-ttu-id="571c4-125">Deux emplacements de magasin majeurs existent et sont divisés en sous-magasins.</span><span class="sxs-lookup"><span data-stu-id="571c4-125">Two major store locations exist that are further divided into sub-stores.</span></span> <span data-ttu-id="571c4-126">Si vous disposez des droits administrateur sur un ordinateur, vous pouvez afficher ces deux principaux magasins à l'aide de l'outil enfichable MMC.</span><span class="sxs-lookup"><span data-stu-id="571c4-126">If you are the administrator on a computer, you can view both major stores by using the MMC snap-in tool.</span></span> <span data-ttu-id="571c4-127">Dans le cas contraire, vous pouvez uniquement afficher le magasin de l'utilisateur en cours.</span><span class="sxs-lookup"><span data-stu-id="571c4-127">Non-administrators can view only the current user store.</span></span>

- <span data-ttu-id="571c4-128">**Magasin de la machine locale**.</span><span class="sxs-lookup"><span data-stu-id="571c4-128">**The local machine store**.</span></span> <span data-ttu-id="571c4-129">Contient les certificats accessibles par les processus de l’ordinateur, tels que ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="571c4-129">This contains the certificates accessed by machine processes, such as ASP.NET.</span></span> <span data-ttu-id="571c4-130">Utilisez cet emplacement pour y stocker les certificats qui authentifient les serveurs auprès des clients.</span><span class="sxs-lookup"><span data-stu-id="571c4-130">Use this location to store certificates that authenticate the server to clients.</span></span>

- <span data-ttu-id="571c4-131">**Magasin de l’utilisateur actuel**.</span><span class="sxs-lookup"><span data-stu-id="571c4-131">**The current user store**.</span></span> <span data-ttu-id="571c4-132">Les applications interactives stockent en principe les certificats à cet emplacement pour l'utilisateur en train d'utiliser l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="571c4-132">Interactive applications typically place certificates here for the computer's current user.</span></span> <span data-ttu-id="571c4-133">Si vous créer des applications clientes, c'est également l'emplacement que vous utiliserez en principe pour stocker les certificats qui authentifient les utilisateurs auprès des services.</span><span class="sxs-lookup"><span data-stu-id="571c4-133">If you are creating a client application, this is where you typically place certificates that authenticate a user to a service.</span></span>

<span data-ttu-id="571c4-134">Ces deux magasins sont divisés en sous-magasins.</span><span class="sxs-lookup"><span data-stu-id="571c4-134">These two stores are further divided into sub-stores.</span></span> <span data-ttu-id="571c4-135">Les plus importants d’entre eux pour la programmation avec WCF sont notamment :</span><span class="sxs-lookup"><span data-stu-id="571c4-135">The most important of these when programming with WCF include:</span></span>

- <span data-ttu-id="571c4-136">**Autorités de certification racine approuvées**.</span><span class="sxs-lookup"><span data-stu-id="571c4-136">**Trusted Root Certification Authorities**.</span></span> <span data-ttu-id="571c4-137">Vous pouvez utiliser les certificats stockés dans ce magasin pour créer une chaîne de certificats, dont l'origine remontera à un certificat d'autorité de certification figurant dans ce magasin.</span><span class="sxs-lookup"><span data-stu-id="571c4-137">You can use the certificates in this store to create a chain of certificates, which can be traced back to a certification authority certificate in this store.</span></span>

  > [!IMPORTANT]
  > <span data-ttu-id="571c4-138">L'ordinateur local approuve de manière implicite tous les certificats figurant dans ce magasin, même si ces certificats n'émanent pas d'une autorité de certification tierce approuvée.</span><span class="sxs-lookup"><span data-stu-id="571c4-138">The local computer implicitly trusts any certificate placed in this store, even if the certificate does not come from a trusted third-party certification authority.</span></span> <span data-ttu-id="571c4-139">C'est pourquoi ne stockez pas de certificats dans ce magasin, à moins qu'il ne s'agisse de certificats publiés par des émetteurs dans lesquels vous entièrement confiance et à moins d'avoir pleinement conscience des conséquences d'un tel stockage.</span><span class="sxs-lookup"><span data-stu-id="571c4-139">For this reason, do not place any certificate into this store unless you fully trust the issuer and understand the consequences.</span></span>

- <span data-ttu-id="571c4-140">**Personnel**.</span><span class="sxs-lookup"><span data-stu-id="571c4-140">**Personal**.</span></span> <span data-ttu-id="571c4-141">Ce magasin est utilisé pour stocker les certificats associés à l'utilisateur d'un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="571c4-141">This store is used for certificates associated with a user of a computer.</span></span> <span data-ttu-id="571c4-142">Ce magasin est en principe utilisé pour stocker les certificats publiés par l'un des certificats d'autorité de certification stockés dans le magasin Autorités de certification racine approuvées.</span><span class="sxs-lookup"><span data-stu-id="571c4-142">Typically this store is used for certificates issued by one of the certification authority certificates found in the Trusted Root Certification Authorities store.</span></span> <span data-ttu-id="571c4-143">Les certificats stockés dans ce magasin peuvent également s'être auto-publiés et avoir été approuvés par une application.</span><span class="sxs-lookup"><span data-stu-id="571c4-143">Alternatively, a certificate found here may be self-issued and trusted by an application.</span></span>

<span data-ttu-id="571c4-144">Pour plus d’informations sur les magasins de certificats, consultez [Magasins de certificats](/windows/desktop/secauthn/certificate-stores).</span><span class="sxs-lookup"><span data-stu-id="571c4-144">For more information about certificate stores, see [Certificate Stores](/windows/desktop/secauthn/certificate-stores).</span></span>

### <a name="selecting-a-store"></a><span data-ttu-id="571c4-145">Sélection d'un magasin</span><span class="sxs-lookup"><span data-stu-id="571c4-145">Selecting a Store</span></span>

<span data-ttu-id="571c4-146">La sélection d'un magasin pour y stocker un certificat dépend de la manière dont un client ou service s'exécutent ainsi que de l'instant où ils s'exécutent.</span><span class="sxs-lookup"><span data-stu-id="571c4-146">Selecting where to store a certificate depends how and when the service or client runs.</span></span> <span data-ttu-id="571c4-147">Les règles générales suivantes s'appliquent :</span><span class="sxs-lookup"><span data-stu-id="571c4-147">The following general rules apply:</span></span>

- <span data-ttu-id="571c4-148">Si le service WCF est hébergé dans un service Windows, utilisez le magasin **machine locale**.</span><span class="sxs-lookup"><span data-stu-id="571c4-148">If the WCF service is hosted in a Windows service use the **local machine** store.</span></span> <span data-ttu-id="571c4-149">Remarque : des droits administrateur sont requis pour pouvoir stocker les certificats dans le magasin de l'ordinateur local.</span><span class="sxs-lookup"><span data-stu-id="571c4-149">Note that administrator privileges are required to install certificates into the local machine store.</span></span>

- <span data-ttu-id="571c4-150">Si le service ou le client est une application qui s’exécute sous un compte d’utilisateur, utilisez le magasin **utilisateur actuel**.</span><span class="sxs-lookup"><span data-stu-id="571c4-150">If the service or client is an application that runs under a user account, then use the **current user** store.</span></span>

### <a name="accessing-stores"></a><span data-ttu-id="571c4-151">Accès aux magasins</span><span class="sxs-lookup"><span data-stu-id="571c4-151">Accessing Stores</span></span>

<span data-ttu-id="571c4-152">Les magasins sont protégés par des listes de contrôle d’accès à l’instar des dossiers figurant sur un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="571c4-152">Stores are protected by access control lists (ACLs), just like folders on a computer.</span></span> <span data-ttu-id="571c4-153">Lorsque vous créez un service hébergé par Internet Information Services (IIS), le processus ASP.NET s’exécute sous le compte ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="571c4-153">When creating a service hosted by Internet Information Services (IIS), the ASP.NET process runs under the ASP.NET account.</span></span> <span data-ttu-id="571c4-154">Ce compte doit avoir accès au magasin contenant les certificats utilisés par le service considéré.</span><span class="sxs-lookup"><span data-stu-id="571c4-154">That account must have access to the store that contains the certificates a service uses.</span></span> <span data-ttu-id="571c4-155">Chacun des principaux magasins est protégé par une liste d'accès par défaut, mais cette liste peut être modifiée.</span><span class="sxs-lookup"><span data-stu-id="571c4-155">Each of the major stores is protected with a default access list, but the lists can be modified.</span></span> <span data-ttu-id="571c4-156">Si vous créez un rôle distinct pour l'accès à un magasin donné, vous devez accorder à ce rôle des droits d'accès.</span><span class="sxs-lookup"><span data-stu-id="571c4-156">If you create a separate role to access a store, you must grant that role access permission.</span></span> <span data-ttu-id="571c4-157">Pour apprendre à modifier la liste d’accès à l’aide de l’outil WinHttpCertConfig.exe, consultez [Guide pratique pour créer des certificats temporaires à utiliser au cours du développement](how-to-create-temporary-certificates-for-use-during-development.md).</span><span class="sxs-lookup"><span data-stu-id="571c4-157">To learn how to modify the access list using the WinHttpCertConfig.exe tool, see [How to: Create Temporary Certificates for Use During Development](how-to-create-temporary-certificates-for-use-during-development.md).</span></span>

## <a name="chain-trust-and-certificate-authorities"></a><span data-ttu-id="571c4-158">Chaîne d'approbation et autorités de certification</span><span class="sxs-lookup"><span data-stu-id="571c4-158">Chain Trust and Certificate Authorities</span></span>

<span data-ttu-id="571c4-159">Les certificats sont créés selone une hiérarchie où chaque certificat individuel est lié à l'autorité de certification qui l'a émis.</span><span class="sxs-lookup"><span data-stu-id="571c4-159">Certificates are created in a hierarchy where each individual certificate is linked to the CA that issued the certificate.</span></span> <span data-ttu-id="571c4-160">Ce lien renvoie au certificat de l'autorité de certification.</span><span class="sxs-lookup"><span data-stu-id="571c4-160">This link is to the CA’s certificate.</span></span> <span data-ttu-id="571c4-161">Le certificat de l’autorité de certification est ensuite lié à l’autorité de certification qui a émis le certificat de l’autorité de certification d’origine.</span><span class="sxs-lookup"><span data-stu-id="571c4-161">The CA’s certificate then links to the CA that issued the original CA’s certificate.</span></span> <span data-ttu-id="571c4-162">Ce processus se répète jusqu'à ce que le certificat de l'autorité de certification racine soit atteint.</span><span class="sxs-lookup"><span data-stu-id="571c4-162">This process is repeated up until the Root CA’s certificate is reached.</span></span> <span data-ttu-id="571c4-163">Le certificat de l'autorité de certification racine est approuvé de manière inhérente.</span><span class="sxs-lookup"><span data-stu-id="571c4-163">The Root CA’s certificate is inherently trusted.</span></span>

<span data-ttu-id="571c4-164">Les certificats numériques sont utilisés pour authentifier une entité en s’appuyant sur cette hiérarchie, également appelée *chaîne de confiance*.</span><span class="sxs-lookup"><span data-stu-id="571c4-164">Digital certificates are used to authenticate an entity by relying on this hierarchy, also called a *chain of trust*.</span></span> <span data-ttu-id="571c4-165">Vous pouvez afficher n’importe quelle chaîne de certificat à l’aide du composant logiciel enfichable MMC en double-cliquant sur un certificat, puis en cliquant sur l’onglet **chemin d’accès du certificat** . Pour plus d’informations sur l’importation de chaînes de certificats pour une autorité de certification, consultez Guide pratique [pour spécifier la chaîne de certificats d’autorité de certification utilisée pour vérifier les signatures](specify-the-certificate-authority-chain-verify-signatures-wcf.md).</span><span class="sxs-lookup"><span data-stu-id="571c4-165">You can view any certificate's chain using the MMC snap-in by double-clicking any certificate, then clicking the **Certificate Path** tab. For more information about importing certificate chains for a Certification authority, see [How to: Specify the Certificate Authority Certificate Chain Used to Verify Signatures](specify-the-certificate-authority-chain-verify-signatures-wcf.md).</span></span>

> [!NOTE]
> <span data-ttu-id="571c4-166">Le statut d'autorité racine approuvée peut être attribué à tout émetteur. Il suffit pour ce faire de placer le certificat de cet émetteur dans le magasin Autorités de certification racine approuvées.</span><span class="sxs-lookup"><span data-stu-id="571c4-166">Any issuer can be designated a trusted root authority by placing the issuer's certificate in the trusted root authority certificate store.</span></span>

### <a name="disabling-chain-trust"></a><span data-ttu-id="571c4-167">Désactivation des chaînes d'approbation</span><span class="sxs-lookup"><span data-stu-id="571c4-167">Disabling Chain Trust</span></span>

<span data-ttu-id="571c4-168">Lorsque vous créez un nouveau service, il est possible que vous utilisiez un certificat non émis par un certificat racine approuvé ou que le certificat émetteur lui-même ne figure pas dans le magasin Autorités de certification racine approuvées.</span><span class="sxs-lookup"><span data-stu-id="571c4-168">When creating a new service, you may be using a certificate that is not issued by a trusted root certificate, or the issuing certificate itself may not be in the Trusted Root Certification Authorities store.</span></span> <span data-ttu-id="571c4-169">Vous pouvez désactiver le mécanisme assurant la vérification de la chaîne d'approbation d'un certificat uniquement à des fins de développement.</span><span class="sxs-lookup"><span data-stu-id="571c4-169">For development purposes only, you can temporarily disable the mechanism that checks the chain of trust for a certificate.</span></span> <span data-ttu-id="571c4-170">Pour ce faire, affectez à la propriété `CertificateValidationMode``PeerTrust` ou `PeerOrChainTrust`.</span><span class="sxs-lookup"><span data-stu-id="571c4-170">To do this, set the `CertificateValidationMode` property to either `PeerTrust` or `PeerOrChainTrust`.</span></span> <span data-ttu-id="571c4-171">L'un et l'autre des modes ci-dessus permettent de spécifier que le certificat doit s'auto-publier (approbation homologue) ou faire partie d'une chaîne d'approbation.</span><span class="sxs-lookup"><span data-stu-id="571c4-171">Either mode specifies that the certificate can either be self-issued (peer trust) or part of a chain of trust.</span></span> <span data-ttu-id="571c4-172">Vous pouvez définir la propriété de n'importe laquelle des classes suivantes.</span><span class="sxs-lookup"><span data-stu-id="571c4-172">You can set the property on any of the following classes.</span></span>

|<span data-ttu-id="571c4-173">Classe</span><span class="sxs-lookup"><span data-stu-id="571c4-173">Class</span></span>|<span data-ttu-id="571c4-174">Propriété</span><span class="sxs-lookup"><span data-stu-id="571c4-174">Property</span></span>|
|-----------|--------------|
|<xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>|<xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|
|<xref:System.ServiceModel.Security.X509PeerCertificateAuthentication>|<xref:System.ServiceModel.Security.X509PeerCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|
|<xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication>|<xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication.CertificateValidationMode%2A?displayProperty=nameWithType>|
|<xref:System.ServiceModel.Security.IssuedTokenServiceCredential>|<xref:System.ServiceModel.Security.IssuedTokenServiceCredential.CertificateValidationMode%2A?displayProperty=nameWithType>|

<span data-ttu-id="571c4-175">Vous pouvez également définir la propriété à l'aide de la configuration.</span><span class="sxs-lookup"><span data-stu-id="571c4-175">You can also set the property using configuration.</span></span> <span data-ttu-id="571c4-176">Les éléments suivants sont utilisés pour spécifier le mode de validation :</span><span class="sxs-lookup"><span data-stu-id="571c4-176">The following elements are used to specify the validation mode:</span></span>

- [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md)

- [\<peerAuthentication>](../../configure-apps/file-schema/wcf/peerauthentication-element.md)

- [\<messageSenderAuthentication>](../../configure-apps/file-schema/wcf/messagesenderauthentication-element.md)

## <a name="custom-authentication"></a><span data-ttu-id="571c4-177">Authentification personnalisée</span><span class="sxs-lookup"><span data-stu-id="571c4-177">Custom Authentication</span></span>

<span data-ttu-id="571c4-178">La propriété `CertificateValidationMode` vous permet également de personnaliser les modalités d'authentification des certificats.</span><span class="sxs-lookup"><span data-stu-id="571c4-178">The `CertificateValidationMode` property also enables you to customize how certificates are authenticated.</span></span> <span data-ttu-id="571c4-179">Par défaut, le niveau a la valeur `ChainTrust`.</span><span class="sxs-lookup"><span data-stu-id="571c4-179">By default, the level is set to `ChainTrust`.</span></span> <span data-ttu-id="571c4-180">Pour utiliser la valeur <xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom>, vous devez également affecter à l'attribut `CustomCertificateValidatorType` l'assembly et le type utilisés pour valider le certificat.</span><span class="sxs-lookup"><span data-stu-id="571c4-180">To use the <xref:System.ServiceModel.Security.X509CertificateValidationMode.Custom> value, you must also set the `CustomCertificateValidatorType` attribute to an assembly and type used to validate the certificate.</span></span> <span data-ttu-id="571c4-181">Pour créer un validateur personnalisé, vous devez hériter de la classe <xref:System.IdentityModel.Selectors.X509CertificateValidator> abstraite.</span><span class="sxs-lookup"><span data-stu-id="571c4-181">To create a custom validator, you must inherit from the abstract <xref:System.IdentityModel.Selectors.X509CertificateValidator> class.</span></span>

<span data-ttu-id="571c4-182">Lorsque vous créez un authentificateur personnalisé, la méthode la plus importante à substituer correspond à la méthode <xref:System.IdentityModel.Selectors.X509CertificateValidator.Validate%2A>.</span><span class="sxs-lookup"><span data-stu-id="571c4-182">When creating a custom authenticator, the most important method to override is the <xref:System.IdentityModel.Selectors.X509CertificateValidator.Validate%2A> method.</span></span> <span data-ttu-id="571c4-183">Pour obtenir un exemple d’authentification personnalisée, consultez [Validateur de certificat X.509](../samples/x-509-certificate-validator.md).</span><span class="sxs-lookup"><span data-stu-id="571c4-183">For an example of custom authentication, see the [X.509 Certificate Validator](../samples/x-509-certificate-validator.md) sample.</span></span> <span data-ttu-id="571c4-184">Pour plus d’informations, consultez [Informations d’identification personnalisées et validation d’informations d’identification](../extending/custom-credential-and-credential-validation.md).</span><span class="sxs-lookup"><span data-stu-id="571c4-184">For more information, see [Custom Credential and Credential Validation](../extending/custom-credential-and-credential-validation.md).</span></span>

## <a name="using-the-powershell-new-selfsignedcertificate-cmdlet-to-build-a-certificate-chain"></a><span data-ttu-id="571c4-185">Utilisation de l’applet de commande PowerShell New-SelfSignedCertificate pour créer une chaîne de certificats</span><span class="sxs-lookup"><span data-stu-id="571c4-185">Using the PowerShell New-SelfSignedCertificate Cmdlet to Build a Certificate Chain</span></span>

<span data-ttu-id="571c4-186">L’applet de commande PowerShell New-SelfSignedCertificate crée des certificats X. 509 et des paires clé privée/clé publique.</span><span class="sxs-lookup"><span data-stu-id="571c4-186">The PowerShell New-SelfSignedCertificate cmdlet creates X.509 certificates and private key/public key pairs.</span></span> <span data-ttu-id="571c4-187">Vous pouvez enregistre les clés privées sur votre disque, puis les utiliser pour émettre et signer de nouveaux certificats, instaurant ainsi une hiérarchie de certificats sous forme de chaîne.</span><span class="sxs-lookup"><span data-stu-id="571c4-187">You can save the private key to disk and then use it to issue and sign new certificates, thus simulating a hierarchy of chained certificates.</span></span> <span data-ttu-id="571c4-188">L’applet de commande est destinée à être utilisée uniquement comme une aide lors du développement de services et ne doit jamais être utilisée pour créer des certificats pour le déploiement réel.</span><span class="sxs-lookup"><span data-stu-id="571c4-188">The cmdlet is intended for use only as an aid when developing services and should never be used to create certificates for actual deployment.</span></span> <span data-ttu-id="571c4-189">Lors du développement d’un service WCF, procédez comme suit pour générer une chaîne de confiance avec l’applet de commande New-SelfSignedCertificate.</span><span class="sxs-lookup"><span data-stu-id="571c4-189">When developing a WCF service, use the following steps to build a chain of trust with the New-SelfSignedCertificate cmdlet.</span></span>

#### <a name="to-build-a-chain-of-trust-with-the-new-selfsignedcertificate-cmdlet"></a><span data-ttu-id="571c4-190">Pour générer une chaîne d’approbation avec l’applet de commande New-SelfSignedCertificate</span><span class="sxs-lookup"><span data-stu-id="571c4-190">To build a chain of trust with the New-SelfSignedCertificate cmdlet</span></span>

1. <span data-ttu-id="571c4-191">Créez un certificat d’autorité racine temporaire (auto-signé) à l’aide de l’applet de commande New-SelfSignedCertificate.</span><span class="sxs-lookup"><span data-stu-id="571c4-191">Create a temporary root authority (self-signed) certificate using the New-SelfSignedCertificate cmdlet.</span></span> <span data-ttu-id="571c4-192">Enregistrez la clé privée sur le disque.</span><span class="sxs-lookup"><span data-stu-id="571c4-192">Save the private key to the disk.</span></span>

2. <span data-ttu-id="571c4-193">Utilisez ce nouveau certificat pour émettre un autre certificat contenant la clé publique.</span><span class="sxs-lookup"><span data-stu-id="571c4-193">Use the new certificate to issue another certificate that contains the public key.</span></span>

3. <span data-ttu-id="571c4-194">Importez le certificat d'autorité racine dans le magasin Autorités de certification racine approuvées.</span><span class="sxs-lookup"><span data-stu-id="571c4-194">Import the root authority certificate into the Trusted Root Certification Authorities store.</span></span>

4. <span data-ttu-id="571c4-195">Pour obtenir des instructions pas à pas, consultez [Guide pratique pour créer des certificats temporaires à utiliser au cours du développement](how-to-create-temporary-certificates-for-use-during-development.md).</span><span class="sxs-lookup"><span data-stu-id="571c4-195">For step-by-step instructions, see [How to: Create Temporary Certificates for Use During Development](how-to-create-temporary-certificates-for-use-during-development.md).</span></span>

## <a name="which-certificate-to-use"></a><span data-ttu-id="571c4-196">Quel certificat utiliser ?</span><span class="sxs-lookup"><span data-stu-id="571c4-196">Which Certificate to Use?</span></span>

<span data-ttu-id="571c4-197">Parmi les questions les plus fréquemment posées concernant les certificats figurent notamment : quel certificat choisir et pourquoi ?</span><span class="sxs-lookup"><span data-stu-id="571c4-197">Common questions about certificates are which certificate to use, and why.</span></span> <span data-ttu-id="571c4-198">La réponse à ces questions n'est pas la même que vous programmiez un service ou un client.</span><span class="sxs-lookup"><span data-stu-id="571c4-198">The answer depends on whether you are programming a client or service.</span></span> <span data-ttu-id="571c4-199">Les informations ci-dessous contiennent des directives générales et n'offrent pas une réponse exhaustive à ces questions.</span><span class="sxs-lookup"><span data-stu-id="571c4-199">The following information provides a general guideline and is not an exhaustive answer to these questions.</span></span>

### <a name="service-certificates"></a><span data-ttu-id="571c4-200">Certificats de service</span><span class="sxs-lookup"><span data-stu-id="571c4-200">Service Certificates</span></span>

<span data-ttu-id="571c4-201">La principale tâche des certificats de service consiste à authentifier le serveur auprès des clients.</span><span class="sxs-lookup"><span data-stu-id="571c4-201">Service certificates have the primary task of authenticating the server to clients.</span></span> <span data-ttu-id="571c4-202">Quand un client authentifie un serveur, il compare d’abord la valeur du champ **Sujet** à celle de l’URI (Uniform Resource Identifier) utilisé pour contacter le service : les DNS respectifs doivent correspondre.</span><span class="sxs-lookup"><span data-stu-id="571c4-202">One of the initial checks when a client authenticates a server is to compare the value of the **Subject** field to the Uniform Resource Identifier (URI) used to contact the service: the DNS of both must match.</span></span> <span data-ttu-id="571c4-203">Par exemple, si l’URI du service est, `http://www.contoso.com/endpoint/` le champ **objet** doit également contenir la valeur `www.contoso.com` .</span><span class="sxs-lookup"><span data-stu-id="571c4-203">For example, if the URI of the service is `http://www.contoso.com/endpoint/` then the **Subject** field must also contain the value `www.contoso.com`.</span></span>

<span data-ttu-id="571c4-204">Remarque : ce champ peut contenir plusieurs valeurs, chacune préfixée par une initialisation spécifiant la valeur.</span><span class="sxs-lookup"><span data-stu-id="571c4-204">Note that the field can contain several values, each prefixed with an initialization to indicate the value.</span></span> <span data-ttu-id="571c4-205">Le plus souvent, l’initialisation est « CN » pour le nom commun, par exemple, `CN = www.contoso.com` .</span><span class="sxs-lookup"><span data-stu-id="571c4-205">Most commonly, the initialization is "CN" for common name, for example, `CN = www.contoso.com`.</span></span> <span data-ttu-id="571c4-206">Il est également possible que le champ **Sujet** soit vide. Dans ce cas, le champ **Autre nom de l’objet** peut contenir la valeur **Nom DNS**.</span><span class="sxs-lookup"><span data-stu-id="571c4-206">It is also possible for the **Subject** field to be blank, in which case the **Subject Alternative Name** field can contain the **DNS Name** value.</span></span>

<span data-ttu-id="571c4-207">Notez également que le champ **Rôles prévus** du certificat doit contenir une valeur appropriée, par exemple « Authentification du serveur » ou « Authentification du client ».</span><span class="sxs-lookup"><span data-stu-id="571c4-207">Also note the value of the **Intended Purposes** field of the certificate should include an appropriate value, such as "Server Authentication" or "Client Authentication".</span></span>

### <a name="client-certificates"></a><span data-ttu-id="571c4-208">Certificats clients</span><span class="sxs-lookup"><span data-stu-id="571c4-208">Client Certificates</span></span>

<span data-ttu-id="571c4-209">Les certificats de client ne sont en principe pas publiés par une autorité de certification tierce.</span><span class="sxs-lookup"><span data-stu-id="571c4-209">Client certificates are not typically issued by a third-party certification authority.</span></span> <span data-ttu-id="571c4-210">Le magasin personnel de l'utilisateur en cours contient en principe des certificats qui y sont stockés par l'autorité racine, le rôle prévu étant « Authentification de client ».</span><span class="sxs-lookup"><span data-stu-id="571c4-210">Instead, the Personal store of the current user location typically contains certificates placed there by a root authority, with an intended purpose of "Client Authentication".</span></span> <span data-ttu-id="571c4-211">Le client peut utiliser un certificat lorsque l’authentification mutuelle est requise.</span><span class="sxs-lookup"><span data-stu-id="571c4-211">The client can use such a certificate when mutual authentication is required.</span></span>

## <a name="online-revocation-and-offline-revocation"></a><span data-ttu-id="571c4-212">Révocations en ligne et hors ligne</span><span class="sxs-lookup"><span data-stu-id="571c4-212">Online Revocation and Offline Revocation</span></span>

### <a name="certificate-validity"></a><span data-ttu-id="571c4-213">Validité des certificats</span><span class="sxs-lookup"><span data-stu-id="571c4-213">Certificate Validity</span></span>

<span data-ttu-id="571c4-214">Chaque certificat est valide uniquement pour une période de temps donnée, appelée *période de validité*.</span><span class="sxs-lookup"><span data-stu-id="571c4-214">Every certificate is valid only for a given period of time, called the *validity period*.</span></span> <span data-ttu-id="571c4-215">Cette période est définie par les champs **Valide à partir du** et **Valide jusqu’au** d’un certificat X.509.</span><span class="sxs-lookup"><span data-stu-id="571c4-215">The validity period is defined by the **Valid from** and **Valid to** fields of an X.509 certificate.</span></span> <span data-ttu-id="571c4-216">Au cours de l'authentification, le certificat est contrôlé afin de vérifier que sa période de validité n'est pas échue.</span><span class="sxs-lookup"><span data-stu-id="571c4-216">During authentication, the certificate is checked to determine whether the certificate is still within the validity period.</span></span>

### <a name="certificate-revocation-list"></a><span data-ttu-id="571c4-217">Liste de révocation des certificats</span><span class="sxs-lookup"><span data-stu-id="571c4-217">Certificate Revocation List</span></span>

<span data-ttu-id="571c4-218">L'autorité de certification peut à tout moment révoquer un certificat tant que sa période de validité n'est pas échue.</span><span class="sxs-lookup"><span data-stu-id="571c4-218">At any time during the validity period, the certification authority can revoke a certificate.</span></span> <span data-ttu-id="571c4-219">Une telle révocation peut avoir lieu pour plusieurs raisons, notamment lorsque la clé privée du certificat est compromise.</span><span class="sxs-lookup"><span data-stu-id="571c4-219">This can occur for many reasons, such as a compromise of the private key of the certificate.</span></span>

<span data-ttu-id="571c4-220">En cas de révocation, toutes les chaînes descendant du certificat révoqué ne sont plus considérées comme valables et ne sont plus approuvées pendant les procédures d'authentification.</span><span class="sxs-lookup"><span data-stu-id="571c4-220">When this occurs, any chains that descend from the revoked certificate are also invalid, and are not trusted during authentication procedures.</span></span> <span data-ttu-id="571c4-221">Pour savoir quels certificats sont révoqués, chaque émetteur publie une *CRL* (liste de révocation de certificats) horodatée et datée.</span><span class="sxs-lookup"><span data-stu-id="571c4-221">To find out which certificates are revoked, each issuer publishes a time- and date-stamped *certificate revocation list* (CRL).</span></span> <span data-ttu-id="571c4-222">Cette liste peut être consultée à l'aide des révocations en ligne ou hors connexion en affectant à la propriété `RevocationMode` ou `DefaultRevocationMode` de l'une des classes suivantes l'une des valeurs d'énumération <xref:System.Security.Cryptography.X509Certificates.X509RevocationMode> : <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>, <xref:System.ServiceModel.Security.X509PeerCertificateAuthentication>, <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication> et les classes <xref:System.ServiceModel.Security.IssuedTokenServiceCredential>.</span><span class="sxs-lookup"><span data-stu-id="571c4-222">The list can be checked using either online revocation or offline revocation by setting the `RevocationMode` or `DefaultRevocationMode` property of the following classes to one of the <xref:System.Security.Cryptography.X509Certificates.X509RevocationMode> enumeration values: <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication>, <xref:System.ServiceModel.Security.X509PeerCertificateAuthentication>, <xref:System.ServiceModel.Security.X509ServiceCertificateAuthentication>, and the <xref:System.ServiceModel.Security.IssuedTokenServiceCredential> classes.</span></span> <span data-ttu-id="571c4-223">La valeur par défaut de toutes les propriétés est `Online`.</span><span class="sxs-lookup"><span data-stu-id="571c4-223">The default value for all properties is `Online`.</span></span>

<span data-ttu-id="571c4-224">Vous pouvez également définir le mode dans la configuration à l’aide `revocationMode` de l’attribut du [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (du [\<serviceBehaviors>](../../configure-apps/file-schema/wcf/servicebehaviors.md) ) et du [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (du [\<endpointBehaviors>](../../configure-apps/file-schema/wcf/endpointbehaviors.md) ).</span><span class="sxs-lookup"><span data-stu-id="571c4-224">You can also set the mode in configuration using the `revocationMode` attribute of both the [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (of the [\<serviceBehaviors>](../../configure-apps/file-schema/wcf/servicebehaviors.md)) and the [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-clientcertificate-element.md) (of the [\<endpointBehaviors>](../../configure-apps/file-schema/wcf/endpointbehaviors.md)).</span></span>

## <a name="the-setcertificate-method"></a><span data-ttu-id="571c4-225">Méthode SetCertificate</span><span class="sxs-lookup"><span data-stu-id="571c4-225">The SetCertificate Method</span></span>

<span data-ttu-id="571c4-226">Dans WCF, vous devez souvent spécifier un certificat ou un ensemble de certificats qu’un service ou un client doit utiliser pour authentifier, chiffrer ou signer numériquement un message.</span><span class="sxs-lookup"><span data-stu-id="571c4-226">In WCF, you must often specify a certificate or set of certificates a service or client is to use to authenticate, encrypt, or digitally sign a message.</span></span> <span data-ttu-id="571c4-227">Pour ce faire, il vous suffit de rédiger un programme à l'aide de la méthode `SetCertificate` des diverses classes représentant les certificats X.509.</span><span class="sxs-lookup"><span data-stu-id="571c4-227">You can do this programmatically by using the `SetCertificate` method of various classes that represent X.509 certificates.</span></span> <span data-ttu-id="571c4-228">Les classes suivantes utilisent la méthode `SetCertificate` pour spécifier un certificat.</span><span class="sxs-lookup"><span data-stu-id="571c4-228">The following classes use the `SetCertificate` method to specify a certificate.</span></span>

|<span data-ttu-id="571c4-229">Classe</span><span class="sxs-lookup"><span data-stu-id="571c4-229">Class</span></span>|<span data-ttu-id="571c4-230">Méthode</span><span class="sxs-lookup"><span data-stu-id="571c4-230">Method</span></span>|
|-----------|------------|
|<xref:System.ServiceModel.Security.PeerCredential>|<xref:System.ServiceModel.Security.PeerCredential.SetCertificate%2A>|
|<xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential>|<xref:System.ServiceModel.Security.X509CertificateInitiatorClientCredential.SetCertificate%2A>|
|<xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential>|<xref:System.ServiceModel.Security.X509CertificateRecipientServiceCredential.SetCertificate%2A>|
|<xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential>|
|<xref:System.ServiceModel.Security.X509CertificateInitiatorServiceCredential.SetCertificate%2A>|

<span data-ttu-id="571c4-231">La méthode `SetCertificate` désigne un emplacement de magasin et y stocke un type « trouver » (paramètre `x509FindType`) qui spécifie un champ de certificat et la valeur de ce champ.</span><span class="sxs-lookup"><span data-stu-id="571c4-231">The `SetCertificate` method works by designating a store location and store, a "find" type (`x509FindType` parameter) that specifies a field of the certificate, and a value to find in the field.</span></span> <span data-ttu-id="571c4-232">Par exemple, le code suivant crée une instance de <xref:System.ServiceModel.ServiceHost> et définit le certificat de service utilisé pour authentifier le service auprès des clients à l’aide de la méthode `SetCertificate`.</span><span class="sxs-lookup"><span data-stu-id="571c4-232">For example, the following code creates a <xref:System.ServiceModel.ServiceHost> instance and sets the service certificate used to authenticate the service to clients with the `SetCertificate` method.</span></span>

[!code-csharp[c_WorkingWithCertificates#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/c_workingwithcertificates/cs/source.cs#1)]
[!code-vb[c_WorkingWithCertificates#1](../../../../samples/snippets/visualbasic/VS_Snippets_CFX/c_workingwithcertificates/vb/source.vb#1)]

### <a name="multiple-certificates-with-the-same-value"></a><span data-ttu-id="571c4-233">Plusieurs certificats ayant la même valeur</span><span class="sxs-lookup"><span data-stu-id="571c4-233">Multiple Certificates with the Same Value</span></span>

<span data-ttu-id="571c4-234">Un magasin peut contenir plusieurs certificats ayant le même nom de sujet.</span><span class="sxs-lookup"><span data-stu-id="571c4-234">A store may contain multiple certificates with the same subject name.</span></span> <span data-ttu-id="571c4-235">En d’autres termes, si vous spécifiez que `x509FindType` a la valeur <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectName> ou <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectDistinguishedName>, et si plusieurs certificats ont la même valeur, une exception est levée, car il est impossible de distinguer le certificat nécessaire.</span><span class="sxs-lookup"><span data-stu-id="571c4-235">This means that if you specify that the `x509FindType` is <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectName> or <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindBySubjectDistinguishedName>, and more than one certificate has the same value, an exception is thrown because there is no way to distinguish which certificate is required.</span></span> <span data-ttu-id="571c4-236">Vous pouvez résoudre ce problème en affectant à `x509FindType` la valeur <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByThumbprint>.</span><span class="sxs-lookup"><span data-stu-id="571c4-236">You can mitigate this by setting the `x509FindType` to <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByThumbprint>.</span></span> <span data-ttu-id="571c4-237">Le champ d'empreinte contient une valeur unique qui peut être utilisée afin de trouver un certificat particulier figurant dans un magasin.</span><span class="sxs-lookup"><span data-stu-id="571c4-237">The thumbprint field contains a unique value that can be used to find a specific certificate in a store.</span></span> <span data-ttu-id="571c4-238">Cette solution présente cependant un inconvénient : si le certificat a été révoqué ou renouvelé, la méthode `SetCertificate` échouera, l'empreinte du certificat n'existant plus.</span><span class="sxs-lookup"><span data-stu-id="571c4-238">However, this has its own disadvantage: if the certificate is revoked or renewed, the `SetCertificate` method fails because the thumbprint is also gone.</span></span> <span data-ttu-id="571c4-239">Si le certificat n'est plus valable, l'authentification échouera également.</span><span class="sxs-lookup"><span data-stu-id="571c4-239">Or, if the certificate is no longer valid, authentication fails.</span></span> <span data-ttu-id="571c4-240">Pour résoudre ce problème, vous pouvez affecter au paramètre `x590FindType` la valeur <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByIssuerName>, puis spécifier le nom de l'émetteur.</span><span class="sxs-lookup"><span data-stu-id="571c4-240">The way to mitigate this is to set the `x590FindType` parameter to <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByIssuerName> and specify the issuer's name.</span></span> <span data-ttu-id="571c4-241">Si aucun émetteur n'est requis, vous pouvez également lui affecter l'une des autres valeurs d'énumération <xref:System.Security.Cryptography.X509Certificates.X509FindType> telles que <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByTimeValid>.</span><span class="sxs-lookup"><span data-stu-id="571c4-241">If no particular issuer is required, you can also set one of the other <xref:System.Security.Cryptography.X509Certificates.X509FindType> enumeration values, such as <xref:System.Security.Cryptography.X509Certificates.X509FindType.FindByTimeValid>.</span></span>

## <a name="certificates-in-configuration"></a><span data-ttu-id="571c4-242">Certificats dans la configuration</span><span class="sxs-lookup"><span data-stu-id="571c4-242">Certificates in Configuration</span></span>

<span data-ttu-id="571c4-243">Vous pouvez également définir des certificats à l'aide de la configuration.</span><span class="sxs-lookup"><span data-stu-id="571c4-243">You can also set certificates by using configuration.</span></span> <span data-ttu-id="571c4-244">Si vous créez un service, les informations d’identification, y compris les certificats, sont spécifiées sous le [\<serviceBehaviors>](../../configure-apps/file-schema/wcf/servicebehaviors.md) .</span><span class="sxs-lookup"><span data-stu-id="571c4-244">If you are creating a service, credentials, including certificates, are specified under the [\<serviceBehaviors>](../../configure-apps/file-schema/wcf/servicebehaviors.md).</span></span> <span data-ttu-id="571c4-245">Lorsque vous programmez un client, les certificats sont spécifiés sous le [\<endpointBehaviors>](../../configure-apps/file-schema/wcf/endpointbehaviors.md) .</span><span class="sxs-lookup"><span data-stu-id="571c4-245">When you are programming a client, certificates are specified under the [\<endpointBehaviors>](../../configure-apps/file-schema/wcf/endpointbehaviors.md).</span></span>

## <a name="mapping-a-certificate-to-a-user-account"></a><span data-ttu-id="571c4-246">Mappage d'un certificat à un compte utilisateur</span><span class="sxs-lookup"><span data-stu-id="571c4-246">Mapping a Certificate to a User Account</span></span>

<span data-ttu-id="571c4-247">Les services IIS et Active Directory proposent une fonctionnalité qui permet de mapper un certificat à un compte utilisateur Windows.</span><span class="sxs-lookup"><span data-stu-id="571c4-247">A feature of IIS and Active Directory is the ability to map a certificate to a Windows user account.</span></span> <span data-ttu-id="571c4-248">Pour plus d’informations sur la fonctionnalité, consultez [Mapper des certificats aux comptes d’utilisateurs](/previous-versions/windows/it-pro/windows-server-2003/cc736706(v=ws.10)).</span><span class="sxs-lookup"><span data-stu-id="571c4-248">For more information about the feature, see [Map certificates to user accounts](/previous-versions/windows/it-pro/windows-server-2003/cc736706(v=ws.10)).</span></span>

<span data-ttu-id="571c4-249">Pour plus d’informations sur l’utilisation du mappage Active Directory, consultez [Mappage des certificats clients à l’aide du mappage du service d’annuaire](/previous-versions/windows/it-pro/windows-server-2003/cc758484(v=ws.10)).</span><span class="sxs-lookup"><span data-stu-id="571c4-249">For more information about using Active Directory mapping, see [Mapping Client Certificates with Directory Service Mapping](/previous-versions/windows/it-pro/windows-server-2003/cc758484(v=ws.10)).</span></span>

<span data-ttu-id="571c4-250">Lorsque cette fonctionnalité est activée, vous pouvez affecter à la propriété <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.MapClientCertificateToWindowsAccount%2A> de la classe <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication> la valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="571c4-250">With this capability enabled, you can set the <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication.MapClientCertificateToWindowsAccount%2A> property of the <xref:System.ServiceModel.Security.X509ClientCertificateAuthentication> class to `true`.</span></span> <span data-ttu-id="571c4-251">Dans Configuration, vous pouvez affecter `mapClientCertificateToWindowsAccount` à l’attribut de l’élément la valeur [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) `true` , comme illustré dans le code suivant.</span><span class="sxs-lookup"><span data-stu-id="571c4-251">In configuration, you can set the `mapClientCertificateToWindowsAccount` attribute of the [\<authentication>](../../configure-apps/file-schema/wcf/authentication-of-servicecertificate-element.md) element to `true`, as shown in the following code.</span></span>

```xml
<serviceBehaviors>
 <behavior name="MappingBehavior">
  <serviceCredentials>
   <clientCertificate>
    <authentication certificateValidationMode="None" mapClientCertificateToWindowsAccount="true" />
   </clientCertificate>
  </serviceCredentials>
 </behavior>
</serviceBehaviors>
```

<span data-ttu-id="571c4-252">Le mappage d'un certificat X.509 au jeton représentant le compte utilisateur Windows est considéré comme un rehaussement des droits de ce compte. Une fois mappé, le jeton Windows peut en effet être utilisé pour accéder à des ressources protégées.</span><span class="sxs-lookup"><span data-stu-id="571c4-252">Mapping an X.509 certificate to the token that represents a Windows user account is considered an elevation of privilege because, once mapped, the Windows token can be used to gain access to protected resources.</span></span> <span data-ttu-id="571c4-253">C'est pourquoi la stratégie de domaine spécifie que le certificat X.509 doit être conforme aux règles qu'elle contient avant de pouvoir être mappé.</span><span class="sxs-lookup"><span data-stu-id="571c4-253">Therefore, domain policy requires the X.509 certificate to comply with its policy prior to mapping.</span></span> <span data-ttu-id="571c4-254">Le package de sécurité *SChannel* applique cette exigence.</span><span class="sxs-lookup"><span data-stu-id="571c4-254">The *SChannel* security package enforces this requirement.</span></span>

<span data-ttu-id="571c4-255">Lorsque vous utilisez .NET Framework 3,5 ou versions ultérieures, WCF garantit que le certificat est conforme à la stratégie de domaine avant d’être mappé à un compte Windows.</span><span class="sxs-lookup"><span data-stu-id="571c4-255">When using .NET Framework 3.5 or later versions, WCF ensures the certificate conforms to domain policy before it is mapped to a Windows account.</span></span>

<span data-ttu-id="571c4-256">Dans la première version de WCF, le mappage est effectué sans prise en compte de la stratégie de domaine.</span><span class="sxs-lookup"><span data-stu-id="571c4-256">In the first release of WCF, mapping is done without consulting the domain policy.</span></span> <span data-ttu-id="571c4-257">Par conséquent, avec d'anciennes applications habituées à s'exécuter sous la première version, il est possible que le mappage échoue si la fonctionnalité de mappage est activée et si le certificat X.509 n'est pas conforme à la stratégie de domaine.</span><span class="sxs-lookup"><span data-stu-id="571c4-257">Therefore it is possible that older applications that used to work when running under the first release, fails if the mapping is enabled and the X.509 certificate does not satisfy the domain policy.</span></span>

## <a name="see-also"></a><span data-ttu-id="571c4-258">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="571c4-258">See also</span></span>

- <xref:System.ServiceModel.Channels>
- <xref:System.ServiceModel.Security>
- <xref:System.ServiceModel>
- <xref:System.Security.Cryptography.X509Certificates.X509FindType>
- [<span data-ttu-id="571c4-259">Sécurisation des services et des clients</span><span class="sxs-lookup"><span data-stu-id="571c4-259">Securing Services and Clients</span></span>](securing-services-and-clients.md)

---
title: Contrôle de la consommation des ressources et amélioration des performances
ms.date: 03/30/2017
ms.assetid: 9a829669-5f76-4c88-80ec-92d0c62c0660
ms.openlocfilehash: 16d6f29235455ff30e115b7aff3425412bc7ba6a
ms.sourcegitcommit: 32a575bf4adccc901f00e264f92b759ced633379
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/04/2019
ms.locfileid: "74802258"
---
# <a name="controlling-resource-consumption-and-improving-performance"></a><span data-ttu-id="3e89c-102">Contrôle de la consommation des ressources et amélioration des performances</span><span class="sxs-lookup"><span data-stu-id="3e89c-102">Controlling Resource Consumption and Improving Performance</span></span>
<span data-ttu-id="3e89c-103">Cette rubrique décrit différentes propriétés dans différentes zones de l’architecture Windows Communication Foundation (WCF) qui fonctionnent pour contrôler la consommation des ressources et affectent les mesures de performance.</span><span class="sxs-lookup"><span data-stu-id="3e89c-103">This topic describes various properties in different areas of the Windows Communication Foundation (WCF) architecture that work to control resource consumption and affect performance metrics.</span></span>

## <a name="properties-that-constrain-resource-consumption-in-wcf"></a><span data-ttu-id="3e89c-104">Propriétés qui contraignent la consommation des ressources dans WCF</span><span class="sxs-lookup"><span data-stu-id="3e89c-104">Properties that Constrain Resource Consumption in WCF</span></span>
 <span data-ttu-id="3e89c-105">Windows Communication Foundation (WCF) applique des contraintes sur certains types de processus, à des fins de sécurité ou de performances.</span><span class="sxs-lookup"><span data-stu-id="3e89c-105">Windows Communication Foundation (WCF) applies constraints on certain types of processes for either security or performance purposes.</span></span> <span data-ttu-id="3e89c-106">Ces contraintes se présentent sous deux formes principales, les quotas et les accélérateurs.</span><span class="sxs-lookup"><span data-stu-id="3e89c-106">These constraints come in two main forms, either quotas and throttles.</span></span> <span data-ttu-id="3e89c-107">Les *quotas* sont des limites qui, lorsqu’ils sont atteints ou dépassés, déclenchent une exception immédiate à un moment donné dans le système.</span><span class="sxs-lookup"><span data-stu-id="3e89c-107">*Quotas* are limits that when reached or exceeded trigger an immediate exception at some point in the system.</span></span> <span data-ttu-id="3e89c-108">*Les limitations* sont des limites qui n’entraînent pas immédiatement la levée d’une exception.</span><span class="sxs-lookup"><span data-stu-id="3e89c-108">*Throttles* are limits that do not immediately cause an exception to be thrown.</span></span> <span data-ttu-id="3e89c-109">Au lieu de cela, lorsqu'une limite d'accélérateur est atteinte, le traitement continue mais dans les limites définies par la valeur de l'accélérateur.</span><span class="sxs-lookup"><span data-stu-id="3e89c-109">Instead, when a throttle limit is reached, processing continues but within the limits set by that throttle value.</span></span> <span data-ttu-id="3e89c-110">Ce traitement limité peut déclencher une exception ailleurs, mais cela dépend de l'application.</span><span class="sxs-lookup"><span data-stu-id="3e89c-110">This limited processing might trigger an exception elsewhere, but this depends upon the application.</span></span>

 <span data-ttu-id="3e89c-111">Outre la distinction entre les quotas et les accélérateurs, certaines propriétés contraignantes se trouvent au niveau de la sérialisation, d'autres au niveau du transport et d'autres encore au niveau de l'application.</span><span class="sxs-lookup"><span data-stu-id="3e89c-111">In addition to the distinction between quotas and throttles, some constraining properties are located at the serialization level, some at the transport level, and some at the application level.</span></span> <span data-ttu-id="3e89c-112">Par exemple, le quota <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>, qui est implémenté par tous les éléments de liaison de transport fournis par le système a la valeur 65 536 octets par défaut afin d’empêcher des clients malveillants de prendre part à des attaques par déni de service contre un service en provoquant une consommation de mémoire excessive.</span><span class="sxs-lookup"><span data-stu-id="3e89c-112">For example, the quota <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType>, which is implemented by all system-supplied transport binding elements, is set to 65,536 bytes by default to hinder malicious clients from engaging in denial-of-service attacks against a service by causing excessive memory consumption.</span></span> <span data-ttu-id="3e89c-113">(En général, vous pouvez augmenter les performances en diminuant cette valeur.)</span><span class="sxs-lookup"><span data-stu-id="3e89c-113">(Typically, you can increase performance by lowering this value.)</span></span>

 <span data-ttu-id="3e89c-114">La propriété <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> est un exemple de quota de sérialisation, qui spécifie le nombre maximal d'objets que le sérialiseur sérialise ou désérialise dans un appel de méthode <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A> unique.</span><span class="sxs-lookup"><span data-stu-id="3e89c-114">An example of a serialization quota is the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property, which specifies the maximum number of objects that the serializer serializes or deserializes in a single <xref:System.Runtime.Serialization.DataContractSerializer.ReadObject%2A> method call.</span></span> <span data-ttu-id="3e89c-115">Un exemple d'accélérateur au niveau de l'application est la propriété <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType> qui, par défaut, restreint le nombre de connexions de canal de session simultanées à 10.</span><span class="sxs-lookup"><span data-stu-id="3e89c-115">An example of an application-level throttle is the <xref:System.ServiceModel.Dispatcher.ServiceThrottle.MaxConcurrentSessions%2A?displayProperty=nameWithType> property, which by default restricts the number of concurrent sessionful channel connections to 10.</span></span> <span data-ttu-id="3e89c-116">(Contrairement aux quotas, si cette valeur d'accélérateur est atteinte, l'application poursuit le traitement mais n'accepte aucun nouveau canal de session, ce qui signifie que les nouveaux clients ne peuvent pas se connecter jusqu'à ce que l'un des autres canaux de session prenne fin.)</span><span class="sxs-lookup"><span data-stu-id="3e89c-116">(Unlike the quotas, if this throttle value is reached, the application continues processing but accepts no new sessionful channels, which means that new clients cannot connect until one of the other sessionful channels is ended.)</span></span>

 <span data-ttu-id="3e89c-117">Ces contrôles sont conçus pour fournir une atténuation intégrée des risques liés à certains types d’attaques ou pour améliorer les mesures de performances telles que l’encombrement mémoire, le délai de démarrage, etc.</span><span class="sxs-lookup"><span data-stu-id="3e89c-117">These controls are designed to provide an out-of-the-box mitigation against certain types of attacks or to improve performance metrics such as memory footprint, start-up time, and so on.</span></span> <span data-ttu-id="3e89c-118">Toutefois, selon l'application, ces contrôles peuvent entraver les performances de l'application de service ou empêcher globalement l'application de fonctionner.</span><span class="sxs-lookup"><span data-stu-id="3e89c-118">However, depending on the application, these controls can impede service application performance or prevent the application from working at all.</span></span> <span data-ttu-id="3e89c-119">Par exemple, une application conçue pour transmettre en continu du contenu vidéo peut facilement dépasser la propriété <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType> par défaut.</span><span class="sxs-lookup"><span data-stu-id="3e89c-119">For example, an application designed to stream video can easily exceed the default <xref:System.ServiceModel.Channels.TransportBindingElement.MaxReceivedMessageSize%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="3e89c-120">Cette rubrique fournit une vue d’ensemble des différents contrôles appliqués aux applications à tous les niveaux de WCF, décrit les différentes façons d’obtenir plus d’informations sur la façon dont un paramètre entrave votre application et décrit les manières de corriger divers problèmes.</span><span class="sxs-lookup"><span data-stu-id="3e89c-120">This topic provides an overview of the various controls applied to applications at all levels of WCF, describes various ways to obtain more information about whether a setting is hindering your application, and describes ways to correct various problems.</span></span> <span data-ttu-id="3e89c-121">La plupart des accélérateurs et certains quotas sont disponibles au niveau de l'application, même lorsque la propriété de base est une contrainte de sérialisation ou de transport.</span><span class="sxs-lookup"><span data-stu-id="3e89c-121">Most throttles and some quotas are available at the application level, even when the base property is a serialization or transport constraint.</span></span> <span data-ttu-id="3e89c-122">Par exemple, vous pouvez définir la propriété <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> en utilisant la propriété <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> sur la classe de service.</span><span class="sxs-lookup"><span data-stu-id="3e89c-122">For example, you can set the <xref:System.Runtime.Serialization.DataContractSerializer.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property using the <xref:System.ServiceModel.ServiceBehaviorAttribute.MaxItemsInObjectGraph%2A?displayProperty=nameWithType> property on the service class.</span></span>

> [!NOTE]
> <span data-ttu-id="3e89c-123">Si vous avez un problème particulier, vous devez d’abord lire le Guide de [démarrage rapide de la résolution des problèmes WCF](wcf-troubleshooting-quickstart.md) pour voir si votre problème (et une solution) y figure.</span><span class="sxs-lookup"><span data-stu-id="3e89c-123">If you have a particular problem, you should first read the [WCF Troubleshooting Quickstart](wcf-troubleshooting-quickstart.md) to see whether your problem (and a solution) is listed there.</span></span>

 <span data-ttu-id="3e89c-124">Les propriétés qui restreignent les processus de sérialisation sont répertoriées dans considérations sur la [sécurité pour les données](./feature-details/security-considerations-for-data.md).</span><span class="sxs-lookup"><span data-stu-id="3e89c-124">Properties that restrict serialization processes are listed in [Security Considerations for Data](./feature-details/security-considerations-for-data.md).</span></span> <span data-ttu-id="3e89c-125">Les propriétés qui restreignent la consommation des ressources liées aux transports sont répertoriées dans [quotas de transport](./feature-details/transport-quotas.md).</span><span class="sxs-lookup"><span data-stu-id="3e89c-125">Properties that restrict the consumption of resources related to transports are listed in [Transport Quotas](./feature-details/transport-quotas.md).</span></span> <span data-ttu-id="3e89c-126">Les propriétés qui restreignent la consommation de ressources au niveau de la couche d'application sont membres de la classe <xref:System.ServiceModel.Dispatcher.ServiceThrottle>.</span><span class="sxs-lookup"><span data-stu-id="3e89c-126">Properties that restrict the consumption of resources at the application layer are the members of the <xref:System.ServiceModel.Dispatcher.ServiceThrottle> class.</span></span>

## <a name="detecting-application-and-performance-issues-related-to-quota-settings"></a><span data-ttu-id="3e89c-127">Détection des problèmes d'application et de performances en rapport avec les paramètres de quota</span><span class="sxs-lookup"><span data-stu-id="3e89c-127">Detecting Application and Performance Issues Related to Quota Settings</span></span>
 <span data-ttu-id="3e89c-128">Les valeurs par défaut des valeurs précédentes ont été choisies pour activer les fonctionnalités d'application de base sur une large gamme de types d'applications tout en assurant une protection de base contre les problèmes de sécurité courants.</span><span class="sxs-lookup"><span data-stu-id="3e89c-128">The defaults of the preceding values have been chosen to enable basic application functionality across a wide range of application types while providing basic protection against common security issues.</span></span> <span data-ttu-id="3e89c-129">Toutefois, des conceptions d'application différentes peuvent dépasser un ou plusieurs paramètres d'accélérateur bien que l'application soit par ailleurs sécurisée et qu'elle fonctionne comme prévu.</span><span class="sxs-lookup"><span data-stu-id="3e89c-129">However, different application designs might exceed one or more throttle settings although the application otherwise is secure and would work as designed.</span></span> <span data-ttu-id="3e89c-130">Dans ces cas, vous devez identifier quelles valeurs d'accélérateur sont dépassées et à quel niveau, puis décider du plan d'action approprié pour augmenter le débit d'application.</span><span class="sxs-lookup"><span data-stu-id="3e89c-130">In these cases, you must identify which throttle values are being exceeded and at what level, and decide on the appropriate course of action to increase application throughput.</span></span>

 <span data-ttu-id="3e89c-131">En général, lors de l'écriture de l'application et de son débogage, vous affectez à la propriété <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> la valeur `true` dans le fichier de configuration ou par programme.</span><span class="sxs-lookup"><span data-stu-id="3e89c-131">Typically, when writing the application and debugging it, you set the <xref:System.ServiceModel.Description.ServiceDebugBehavior.IncludeExceptionDetailInFaults%2A?displayProperty=nameWithType> property to `true` in the configuration file or programmatically.</span></span> <span data-ttu-id="3e89c-132">Cela indique à WCF de retourner les traces de pile d’exception de service à l’application cliente pour l’affichage.</span><span class="sxs-lookup"><span data-stu-id="3e89c-132">This instructs WCF to return service exception stack traces to the client application for viewing.</span></span> <span data-ttu-id="3e89c-133">Cette fonctionnalité signale la plupart des exceptions au niveau de l'application de façon à afficher les paramètres de quota qui peuvent être impliqués, si tel est le problème.</span><span class="sxs-lookup"><span data-stu-id="3e89c-133">This feature reports most application-level exceptions in such a way as to display which quota settings might be involved, if that is the problem.</span></span>

 <span data-ttu-id="3e89c-134">Certaines exceptions se produisent au moment de l'exécution, sous le seuil de visibilité de la couche d'application, et ne sont pas retournées à l'aide de ce mécanisme. Il est possible qu'elles ne soient pas traitées par une implémentation <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> personnalisée.</span><span class="sxs-lookup"><span data-stu-id="3e89c-134">Some exceptions happen at run time below the visibility of the application layer and are not returned using this mechanism, and they might not be handled by a custom <xref:System.ServiceModel.Dispatcher.IErrorHandler?displayProperty=nameWithType> implementation.</span></span> <span data-ttu-id="3e89c-135">Si vous utilisez un environnement de développement tel que Microsoft Visual Studio, la plupart de ces exceptions sont affichées automatiquement.</span><span class="sxs-lookup"><span data-stu-id="3e89c-135">If you are in a development environment like Microsoft Visual Studio, most of these exceptions are displayed automatically.</span></span> <span data-ttu-id="3e89c-136">Toutefois, certaines exceptions peuvent être masquées par des paramètres d’environnement de développement tels que [uniquement mon code](/visualstudio/debugger/just-my-code) Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="3e89c-136">However, some exceptions can be masked by development environment settings such as [Just My Code](/visualstudio/debugger/just-my-code) Visual Studio.</span></span>

 <span data-ttu-id="3e89c-137">Quelles que soient les capacités de votre environnement de développement, vous pouvez utiliser les fonctionnalités de suivi et d’enregistrement des messages WCF pour déboguer toutes les exceptions et optimiser les performances de vos applications.</span><span class="sxs-lookup"><span data-stu-id="3e89c-137">Regardless of the capabilities of your development environment, you can use capabilities of WCF tracing and message logging to debug all exceptions and tune the performance of your applications.</span></span> <span data-ttu-id="3e89c-138">Pour plus d’informations, consultez [utilisation du suivi pour résoudre les problèmes de votre application](./diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span><span class="sxs-lookup"><span data-stu-id="3e89c-138">For more information, see [Using Tracing to Troubleshoot Your Application](./diagnostics/tracing/using-tracing-to-troubleshoot-your-application.md).</span></span>

## <a name="performance-issues-and-xmlserializer"></a><span data-ttu-id="3e89c-139">Problèmes de performances et XmlSerializer</span><span class="sxs-lookup"><span data-stu-id="3e89c-139">Performance Issues and XmlSerializer</span></span>
 <span data-ttu-id="3e89c-140">Les applications clientes et de services qui utilisent des types de données sérialisables à l'aide de <xref:System.Xml.Serialization.XmlSerializer> génèrent et compilent le code de sérialisation de ces types de données lors de l'exécution, ce qui peut provoquer des performances de démarrage lentes.</span><span class="sxs-lookup"><span data-stu-id="3e89c-140">Services and client applications that use data types that are serializable using the <xref:System.Xml.Serialization.XmlSerializer> generate and compile serialization code for those data types at run time, which can result in slow start-up performance.</span></span>

> [!NOTE]
> <span data-ttu-id="3e89c-141">Le code de sérialisation prégénéré est réservé aux applications clientes, pas aux services.</span><span class="sxs-lookup"><span data-stu-id="3e89c-141">Pre-generated serialization code can be used only in client applications and not in services.</span></span>

 <span data-ttu-id="3e89c-142">L' [outil ServiceModel Metadata Utility Tool (Svcutil. exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) peut améliorer les performances de démarrage de ces applications en générant le code de sérialisation nécessaire à partir des assemblys compilés pour l’application.</span><span class="sxs-lookup"><span data-stu-id="3e89c-142">The [ServiceModel Metadata Utility Tool (Svcutil.exe)](servicemodel-metadata-utility-tool-svcutil-exe.md) can improve start-up performance for these applications by generating the necessary serialization code from the compiled assemblies for the application.</span></span> <span data-ttu-id="3e89c-143">Pour plus d’informations, consultez [Comment : améliorer le temps de démarrage des applications clientes WCF à l’aide de XmlSerializer](./feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span><span class="sxs-lookup"><span data-stu-id="3e89c-143">For more information, see [How to: Improve the Startup Time of WCF Client Applications using the XmlSerializer](./feature-details/startup-time-of-wcf-client-applications-using-the-xmlserializer.md).</span></span>

## <a name="performance-issues-when-hosting-wcf-services-under-aspnet"></a><span data-ttu-id="3e89c-144">Problèmes de performances lors de l'hébergement de services WCF sous ASP.NET</span><span class="sxs-lookup"><span data-stu-id="3e89c-144">Performance Issues When Hosting WCF Services Under ASP.NET</span></span>

<span data-ttu-id="3e89c-145">Lorsqu'un service WCF est hébergé sous IIS et ASP.NET, les paramètres de configuration d'IIS et ASP.NET peuvent affecter le débit et l'encombrement mémoire du service WCF.</span><span class="sxs-lookup"><span data-stu-id="3e89c-145">When a WCF service is hosted under IIS and ASP.NET, the configuration settings of IIS and ASP.NET can affect the throughput and memory footprint of the WCF service.</span></span>  <span data-ttu-id="3e89c-146">Pour plus d’informations sur les performances de ASP.NET, consultez [amélioration des performances de ASP.net](https://docs.microsoft.com/previous-versions/msp-n-p/ff647787(v=pandp.10)).</span><span class="sxs-lookup"><span data-stu-id="3e89c-146">For more information about ASP.NET performance, see [Improving ASP.NET Performance](https://docs.microsoft.com/previous-versions/msp-n-p/ff647787(v=pandp.10)).</span></span> <span data-ttu-id="3e89c-147">Un paramètre qui peut avoir des conséquences inattendues est <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>, qui est une propriété de <xref:System.Web.Configuration.ProcessModelSection>.</span><span class="sxs-lookup"><span data-stu-id="3e89c-147">One setting that might have unintended consequences is <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A>, which is a property of the <xref:System.Web.Configuration.ProcessModelSection>.</span></span> <span data-ttu-id="3e89c-148">Si votre application dispose d'un nombre fixe ou faible de clients, l'affectation de la valeur 2 à <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> peut fournir une relance de débit sur un ordinateur multiprocesseur dont l'utilisation de l'UC est proche de 100 %.</span><span class="sxs-lookup"><span data-stu-id="3e89c-148">If your application has a fixed or small number of clients, setting <xref:System.Web.Configuration.ProcessModelSection.MinWorkerThreads%2A> to 2 might provide a throughput boost on a multiprocessor machine that has a CPU utilization close to 100%.</span></span> <span data-ttu-id="3e89c-149">Cette augmentation des performances a un coût : elle entraînera également une augmentation de l'utilisation de la mémoire, ce qui pourrait réduire l'évolutivité.</span><span class="sxs-lookup"><span data-stu-id="3e89c-149">This increase in performance comes with a cost: it will also cause an increase in memory usage, which could reduce scalability.</span></span>

## <a name="see-also"></a><span data-ttu-id="3e89c-150">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="3e89c-150">See also</span></span>

- [<span data-ttu-id="3e89c-151">Administration et diagnostics</span><span class="sxs-lookup"><span data-stu-id="3e89c-151">Administration and Diagnostics</span></span>](./diagnostics/index.md)
- [<span data-ttu-id="3e89c-152">Données volumineuses et streaming</span><span class="sxs-lookup"><span data-stu-id="3e89c-152">Large Data and Streaming</span></span>](./feature-details/large-data-and-streaming.md)

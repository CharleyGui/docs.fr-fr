---
title: Procédure d'installation unique pour les exemples Windows Communication Foundation
ms.date: 03/30/2017
ms.assetid: a5848ffd-3eb5-432d-812e-bd948ccb6bca
ms.openlocfilehash: a34c2ee7cb98c6120e23114674712de0ba5b8162
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "64664812"
---
# <a name="one-time-setup-procedure-for-the-windows-communication-foundation-samples"></a><span data-ttu-id="47f52-102">Procédure d'installation unique pour les exemples Windows Communication Foundation</span><span class="sxs-lookup"><span data-stu-id="47f52-102">One-Time Setup Procedure for the Windows Communication Foundation Samples</span></span>
<span data-ttu-id="47f52-103">La plupart des exemples Windows Communication Foundation (WCF) sont hébergée dans Internet Information Services (IIS) et exécutez à partir d’un répertoire virtuel commun.</span><span class="sxs-lookup"><span data-stu-id="47f52-103">Most of the Windows Communication Foundation (WCF) samples are hosted in Internet Information Services (IIS) and run from a common virtual directory.</span></span> <span data-ttu-id="47f52-104">Cette procédure d’installation unique crée un dossier sur le disque ; Il ajoute également un répertoire virtuel dans IIS nommé **ServiceModelSamples**.</span><span class="sxs-lookup"><span data-stu-id="47f52-104">This one-time setup procedure creates a folder on the disk; it also adds a virtual directory to IIS named **ServiceModelSamples**.</span></span>

 <span data-ttu-id="47f52-105">Le **ServiceModelSamples** répertoire virtuel est utilisé pour générer et exécuter tous les exemples qui utilisent des services hébergés dans IIS.</span><span class="sxs-lookup"><span data-stu-id="47f52-105">The **ServiceModelSamples** virtual directory is used for building and running all samples that use an IIS-hosted service.</span></span> <span data-ttu-id="47f52-106">Il s'agit du seul répertoire virtuel requis pour exécuter les exemples.</span><span class="sxs-lookup"><span data-stu-id="47f52-106">This is the only virtual directory that is required to run the samples.</span></span> <span data-ttu-id="47f52-107">La génération d'un exemple remplace tout service déployé précédemment dans ce répertoire ; seul le dernier exemple généré sera déployé et disponible dans ce répertoire virtuel.</span><span class="sxs-lookup"><span data-stu-id="47f52-107">Building a sample will replace any previously deployed service at this virtual directory; only the most recently built sample will be deployed and available in this virtual directory.</span></span>

> [!NOTE]
>  <span data-ttu-id="47f52-108">Vous devez exécuter toutes les commandes sous un compte d'administrateur local.</span><span class="sxs-lookup"><span data-stu-id="47f52-108">You must run all commands under a local administrator account.</span></span> <span data-ttu-id="47f52-109">Si vous utilisez Windows 7, [!INCLUDE[windowsver](../../../../includes/windowsver-md.md)] ou Windows Server 2008 R2, vous devez également exécuter l'invite de commandes avec des privilèges élevés.</span><span class="sxs-lookup"><span data-stu-id="47f52-109">If you are using Windows 7, [!INCLUDE[windowsver](../../../../includes/windowsver-md.md)], or Windows Server 2008 R2, you must also run the command prompt with elevated privileges.</span></span> <span data-ttu-id="47f52-110">Pour ce faire, cliquez sur l’icône de l’invite de commandes, puis cliquez sur **exécuter en tant qu’administrateur**.</span><span class="sxs-lookup"><span data-stu-id="47f52-110">To do so, right-click the command prompt icon, and then click **Run as administrator**.</span></span> <span data-ttu-id="47f52-111">Toutes les commandes qui figurent dans cette rubrique doivent être exécutées dans une invite de commandes disposant des paramètres de chemin d’accès appropriés.</span><span class="sxs-lookup"><span data-stu-id="47f52-111">All commands in this topic must be run in a command prompt that has the appropriate path settings.</span></span>  <span data-ttu-id="47f52-112">Le moyen le plus simple de vous en assurer consiste à utiliser l'invite de commandes de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="47f52-112">The easiest way to ensure this is by using the Visual Studio Command Prompt.</span></span> <span data-ttu-id="47f52-113">Pour ouvrir cette invite, cliquez sur **Démarrer**, sélectionnez **tous les programmes**, faites défiler jusqu'à **Visual Studio 2010**, sélectionnez **Visual Studio Tools**, avec le bouton droit **invite de commandes Visual Studio (2010)**, puis cliquez sur **exécuter en tant qu’administrateur**.</span><span class="sxs-lookup"><span data-stu-id="47f52-113">To open this prompt, click **Start**, select **All Programs**, scroll down to **Visual Studio 2010**, select **Visual Studio Tools**, right-click **Visual Studio Command Prompt (2010)**, and then click **Run as administrator**.</span></span> <span data-ttu-id="47f52-114">Si l’une des éditions Visual Studio Express est installée, cette invite de commandes n’est pas disponible ; il vous faut ajouter « C:\Windows\Microsoft.Net\Framework\v4.0 » au chemin d’accès système.</span><span class="sxs-lookup"><span data-stu-id="47f52-114">If you have one of the Visual Studio Express editions installed, this command prompt is not available, and you will have to add "C:\Windows\Microsoft.Net\Framework\v4.0" to the system path.</span></span>  
  
### <a name="one-time-setup-procedure-for-wcf-samples"></a><span data-ttu-id="47f52-115">Procédure d'installation unique pour les exemples WCF</span><span class="sxs-lookup"><span data-stu-id="47f52-115">One-time setup procedure for WCF samples</span></span>  
  
1. <span data-ttu-id="47f52-116">Vérifiez que [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] est installé.</span><span class="sxs-lookup"><span data-stu-id="47f52-116">Ensure that [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] is set up.</span></span> <span data-ttu-id="47f52-117">Pour plus d’informations sur la configuration [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)], consultez [Internet Information Service d’hébergement Instructions](../../../../docs/framework/wcf/samples/internet-information-service-hosting-instructions.md).</span><span class="sxs-lookup"><span data-stu-id="47f52-117">For more information about how to set up [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)], see [Internet Information Service Hosting Instructions](../../../../docs/framework/wcf/samples/internet-information-service-hosting-instructions.md).</span></span>  
  
2. <span data-ttu-id="47f52-118">Vérifiez que [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] est installé.</span><span class="sxs-lookup"><span data-stu-id="47f52-118">Ensure that [!INCLUDE[netfx40_long](../../../../includes/netfx40-long-md.md)] is installed.</span></span> <span data-ttu-id="47f52-119">Rechercher les éléments suivants de répertoire pour la version 4.0 (ou version ultérieures) : **\Windows\Microsoft.NET\Framework**</span><span class="sxs-lookup"><span data-stu-id="47f52-119">Search the following directory for v4.0 (or later): **\Windows\Microsoft.NET\Framework**</span></span>  
  
3. <span data-ttu-id="47f52-120">Si Visual Studio 2012 n’est pas installé, et que votre système d’exploitation n’est pas Windows Server 2008 SP2 ou version ultérieure, installez [correctif logiciel 251798](https://go.microsoft.com/fwlink/?LinkId=184693).</span><span class="sxs-lookup"><span data-stu-id="47f52-120">If Visual Studio 2012 is not installed, and your operating system is not Windows Server 2008 SP2 or later, install [Hotfix 251798](https://go.microsoft.com/fwlink/?LinkId=184693).</span></span>  
  
4. <span data-ttu-id="47f52-121">Exécutez les commandes suivantes.</span><span class="sxs-lookup"><span data-stu-id="47f52-121">Run the following commands.</span></span> <span data-ttu-id="47f52-122">Pour plus d’informations sur la raison pour laquelle ces commandes doivent être exécutées, consultez [échoue de Service hébergé IIS](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms752252(v=vs.90)).</span><span class="sxs-lookup"><span data-stu-id="47f52-122">For more information about why these commands must be run, see [IIS Hosted Service Fails](https://docs.microsoft.com/previous-versions/dotnet/netframework-3.5/ms752252(v=vs.90)).</span></span>  
  
    > [!WARNING]
    >  <span data-ttu-id="47f52-123">Si vous avez réinstallé IIS, réexécutez les commandes suivantes.</span><span class="sxs-lookup"><span data-stu-id="47f52-123">If IIS is reinstalled, the following commands will need to be run again.</span></span>

    ```
    "%WINDIR%\Microsoft.Net\Framework\v4.0.30319\aspnet_regiis" –i –enable
    "%WINDIR%\Microsoft.Net\Framework\v4.0.30319\ServiceModelReg.exe" -r
    ```

    > [!WARNING]
    >  <span data-ttu-id="47f52-124">Exécutant la commande `aspnet_regiis –i –enable` sera exécuter le Pool d’applications par défaut à l’aide de [!INCLUDE[netfx40_short](../../../../includes/netfx40-short-md.md)], ce qui peut provoquer des problèmes d’incompatibilité pour d’autres applications sur le même ordinateur.</span><span class="sxs-lookup"><span data-stu-id="47f52-124">Running the command `aspnet_regiis –i –enable` will make the Default App Pool run using [!INCLUDE[netfx40_short](../../../../includes/netfx40-short-md.md)], which may produce incompatibility issues for other applications on the same computer.</span></span>  
  
5. <span data-ttu-id="47f52-125">Suivez le [pare-feu Instructions](../../../../docs/framework/wcf/samples/firewall-instructions.md) pour activer les ports utilisés par les exemples.</span><span class="sxs-lookup"><span data-stu-id="47f52-125">Follow the [Firewall Instructions](../../../../docs/framework/wcf/samples/firewall-instructions.md) for enabling the ports used by the samples.</span></span>  
  
6. <span data-ttu-id="47f52-126">Recherchez le répertoire par défaut suivant : \<InstallDrive>:**\WF_WCF_Samples**.</span><span class="sxs-lookup"><span data-stu-id="47f52-126">Check for the following default directory: \<InstallDrive>:**\WF_WCF_Samples**.</span></span> <span data-ttu-id="47f52-127">Si les exemples ont été installés précédemment, il s'agit du répertoire par défaut.</span><span class="sxs-lookup"><span data-stu-id="47f52-127">If the samples were previously installed, this is the default directory.</span></span>  
  
7. <span data-ttu-id="47f52-128">Si les exemples ne sont pas installés, installez-les à partir de l’emplacement de téléchargement des exemples de [Visual C#](https://go.microsoft.com/fwlink/?LinkId=190939) ou [Visual Basic](https://go.microsoft.com/fwlink/?LinkID=193373).</span><span class="sxs-lookup"><span data-stu-id="47f52-128">If the samples are not installed, install them from the samples download location for [Visual C#](https://go.microsoft.com/fwlink/?LinkId=190939) or [Visual Basic](https://go.microsoft.com/fwlink/?LinkID=193373).</span></span>  
  
8. <span data-ttu-id="47f52-129">Après avoir installé les exemples, accédez à : \<InstallDrive>:**\WF_WCF_Samples\WCF\Setup\\**</span><span class="sxs-lookup"><span data-stu-id="47f52-129">After installing the samples, go to : \<InstallDrive>:**\WF_WCF_Samples\WCF\Setup\\**</span></span>  
  
9. <span data-ttu-id="47f52-130">Exécutez le **Setupvroot.bat** fichier de commandes.</span><span class="sxs-lookup"><span data-stu-id="47f52-130">Run the **Setupvroot.bat** batch file.</span></span> <span data-ttu-id="47f52-131">Les étapes suivantes sont exécutées :</span><span class="sxs-lookup"><span data-stu-id="47f52-131">The following steps are performed:</span></span>  
  
    - <span data-ttu-id="47f52-132">Un répertoire virtuel, nommé ServiceModelSamples, est créé dans IIS.</span><span class="sxs-lookup"><span data-stu-id="47f52-132">A virtual directory is created in IIS named ServiceModelSamples.</span></span>  
  
    - <span data-ttu-id="47f52-133">Des répertoires de disque nommés %SystemDrive%\Inetpub\wwwroot\ServiceModelSamples et %SystemDrive%\Inetpub\wwwroot\ServiceModelSamples\bin sont créés.</span><span class="sxs-lookup"><span data-stu-id="47f52-133">New disk directories are created named %SystemDrive%\Inetpub\wwwroot\ServiceModelSamples and %SystemDrive%\Inetpub\wwwroot\ServiceModelSamples\bin.</span></span>  
  
     <span data-ttu-id="47f52-134">Si vous préférez configurer ces répertoires manuellement, consultez le [Instructions de configuration du répertoire virtuel](../../../../docs/framework/wcf/samples/virtual-directory-setup-instructions.md).</span><span class="sxs-lookup"><span data-stu-id="47f52-134">If you prefer to set up these directories manually, see the [Virtual Directory Setup Instructions](../../../../docs/framework/wcf/samples/virtual-directory-setup-instructions.md).</span></span> <span data-ttu-id="47f52-135">Pour annuler toutes les modifications apportées lors de cette étape, exécutez cleanupvroot.bat une fois que vous aurez terminé d'utiliser les exemples.</span><span class="sxs-lookup"><span data-stu-id="47f52-135">To revert all changes done in this step, run cleanupvroot.bat after you finish using the samples.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="47f52-136">Cette procédure doit être effectuée une fois seulement sur un ordinateur, sauf si cleanupvroot.bat est exécuté.</span><span class="sxs-lookup"><span data-stu-id="47f52-136">This procedure must be performed only once on a computer, unless cleanupvroot.bat is run.</span></span>

10. <span data-ttu-id="47f52-137">Vous devez accorder au compte utilisé pour générer les exemples et à l'utilisateur du service réseau des autorisations de modification sur le répertoire %SystemDrive%\inetpub\wwwroot.</span><span class="sxs-lookup"><span data-stu-id="47f52-137">You must grant permission to modify for %SystemDrive%\inetpub\wwwroot to the account under which you are building the samples and the Network Service user.</span></span> <span data-ttu-id="47f52-138">Lors de la génération, certains exemples hébergés par le Web peuvent tenter de copier les fichiers binaires compilés dans l'emplacement mentionné précédemment. Si vous n'avez pas défini les autorisations requises, leur génération échoue.</span><span class="sxs-lookup"><span data-stu-id="47f52-138">While building, some Web-hosted samples might attempt to copy the compiled binaries to the previously mentioned location, and if you have not set the appropriate permissions, the build will break.</span></span> <span data-ttu-id="47f52-139">Vous pouvez également laisser les autorisations telles quelles et exécuter l’invite de commandes SDK ou l’invite de commandes Visual Studio (2012) en tant qu’administrateur, ou générer les exemples dans Visual Studio 2012, exécuter également en tant qu’administrateur.</span><span class="sxs-lookup"><span data-stu-id="47f52-139">Alternatively, you can leave the permissions as they are and run the SDK command prompt or Visual Studio Command Prompt (2012) as Administrator, or build the samples in Visual Studio 2012, also run as Administrator.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="47f52-140">Si vous ne procédez pas à cette étape, tous les exemples hébergés par IIS échouent lors de la génération.</span><span class="sxs-lookup"><span data-stu-id="47f52-140">If this step is not completed, all IIS-hosted samples will fail while building.</span></span> <span data-ttu-id="47f52-141">Veillez à définir les autorisations correctement ou exécutez l'invite de commandes du Kit de développement logiciel (SDK) et de Visual Studio (2012) en tant qu'administrateur.</span><span class="sxs-lookup"><span data-stu-id="47f52-141">Ensure that you set the permissions correctly, or run both the SDK command prompt and Visual Studio Command Prompt (2012) as Administrator.</span></span>

11. <span data-ttu-id="47f52-142">Créez sur l'ordinateur un répertoire C:\logs ; certains exemples peuvent en avoir besoin.</span><span class="sxs-lookup"><span data-stu-id="47f52-142">Create a C:\logs directory on the computer; some samples might be expecting it.</span></span> <span data-ttu-id="47f52-143">Assurez-vous que le compte approprié dispose d’un accès en écriture sur ce dossier.</span><span class="sxs-lookup"><span data-stu-id="47f52-143">Make sure that the appropriate account has write access granted to this folder.</span></span> <span data-ttu-id="47f52-144">Pour Windows 7, [!INCLUDE[wv](../../../../includes/wv-md.md)], et Windows Server 2008 R2, ce compte est **Service réseau**.</span><span class="sxs-lookup"><span data-stu-id="47f52-144">For Windows 7, [!INCLUDE[wv](../../../../includes/wv-md.md)], and Windows Server 2008 R2, this account is **Network Service**.</span></span> <span data-ttu-id="47f52-145">Pour [!INCLUDE[lserver](../../../../includes/lserver-md.md)], le compte est Autorité NT\Service réseau.</span><span class="sxs-lookup"><span data-stu-id="47f52-145">For  [!INCLUDE[lserver](../../../../includes/lserver-md.md)], the account is NT Authority\Network Service.</span></span> <span data-ttu-id="47f52-146">Pour [!INCLUDE[wxp](../../../../includes/wxp-md.md)] et [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)], le compte est ASPNET.</span><span class="sxs-lookup"><span data-stu-id="47f52-146">For [!INCLUDE[wxp](../../../../includes/wxp-md.md)] and [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)], the account is ASPNET.</span></span>

12. <span data-ttu-id="47f52-147">Exécutez le fichier Setupcerttool.bat.</span><span class="sxs-lookup"><span data-stu-id="47f52-147">Run the Setupcerttool.bat file.</span></span> <span data-ttu-id="47f52-148">Ce fichier se trouve dans le \<InstallPath > \WF_WCF_Samples\WCF\Setup\ dossier.</span><span class="sxs-lookup"><span data-stu-id="47f52-148">This file is located in the  \<InstallPath>\WF_WCF_Samples\WCF\Setup\  folder.</span></span>  <span data-ttu-id="47f52-149">Ce script effectue les tâches suivantes :</span><span class="sxs-lookup"><span data-stu-id="47f52-149">This script will perform the following tasks:</span></span>

    - <span data-ttu-id="47f52-150">génération de l'outil FindPrivateKey ;</span><span class="sxs-lookup"><span data-stu-id="47f52-150">Build the FindPrivateKey tool.</span></span>

    - <span data-ttu-id="47f52-151">création d'un répertoire nommé %ProgramFiles%\ServiceModelSampleTools ;</span><span class="sxs-lookup"><span data-stu-id="47f52-151">Create a directory called %ProgramFiles%\ServiceModelSampleTools.</span></span>

    - <span data-ttu-id="47f52-152">copie du nouvel outil FindPrivateKey dans ce répertoire.</span><span class="sxs-lookup"><span data-stu-id="47f52-152">Copy the new FindPrivateKey tool to this directory.</span></span>

     <span data-ttu-id="47f52-153">Cet outil est requis pour les exemples qui utilisent des certificats et sont hébergés dans IIS.</span><span class="sxs-lookup"><span data-stu-id="47f52-153">This tool is required by samples that use certificates and are hosted in IIS.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="47f52-154">Pour des raisons de sécurité, n'oubliez pas de supprimer la définition de répertoire virtuel et les autorisations accordées au cours des étapes d'installation ci-dessus lorsque vous en avez terminé avec les exemples en exécutant le fichier de commandes Cleanupvroot.bat.</span><span class="sxs-lookup"><span data-stu-id="47f52-154">For security purposes, remember to remove the virtual directory definition and permissions granted in the setup steps above by running the batch file named Cleanupvroot.bat after you are finished with the samples.</span></span>

13. <span data-ttu-id="47f52-155">Les exemples auto-hébergés (non hébergés dans IIS) doivent être autorisés à enregistrer des adresses HTTP sur l'ordinateur pour pouvoir écouter les données.</span><span class="sxs-lookup"><span data-stu-id="47f52-155">Samples that are self-hosted (not hosted in IIS) require permission to register HTTP addresses on the computer for listening.</span></span> <span data-ttu-id="47f52-156">Ces autorisations (qui permettent de réserver les espaces de noms HTTP) dépendent directement des autorisations dont les comptes d'utilisateurs utilisés pour exécuter ces exemples disposent.</span><span class="sxs-lookup"><span data-stu-id="47f52-156">The permission for an HTTP namespace reservation comes from the user account used to run the sample.</span></span> <span data-ttu-id="47f52-157">Par défaut, les comptes d'administrateur sont autorisés à enregistrer n'importe quelle adresse HTTP.</span><span class="sxs-lookup"><span data-stu-id="47f52-157">By default, administrator accounts have the permission to register any HTTP address.</span></span> <span data-ttu-id="47f52-158">L'autorisation pour les espaces de noms HTTP utilisés par les exemples doit être accordée aux comptes qui ne sont pas administrateur.</span><span class="sxs-lookup"><span data-stu-id="47f52-158">Non-administrator accounts must be granted permission for the HTTP namespaces used by the samples.</span></span> <span data-ttu-id="47f52-159">Pour plus d’informations sur la configuration des réservations d’espaces de noms, consultez [Configuration de HTTP et HTTPS](../../../../docs/framework/wcf/feature-details/configuring-http-and-https.md).</span><span class="sxs-lookup"><span data-stu-id="47f52-159">For more information about how to configure namespace reservations, see [Configuring HTTP and HTTPS](../../../../docs/framework/wcf/feature-details/configuring-http-and-https.md).</span></span>

14. <span data-ttu-id="47f52-160">Certains exemples nécessitent Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="47f52-160">Some samples require Message Queuing.</span></span> <span data-ttu-id="47f52-161">Consultez [installation de Message Queuing (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md) pour obtenir des instructions d’installation.</span><span class="sxs-lookup"><span data-stu-id="47f52-161">See [Installing Message Queuing (MSMQ)](../../../../docs/framework/wcf/samples/installing-message-queuing-msmq.md) for installation instructions.</span></span>

    > [!NOTE]
    >  <span data-ttu-id="47f52-162">Veillez à démarrez le service MSMQ avant d'exécuter un exemple qui requiert Message Queuing.</span><span class="sxs-lookup"><span data-stu-id="47f52-162">Ensure that you start the MSMQ service before you run any samples that require Message Queuing.</span></span>

15. <span data-ttu-id="47f52-163">Certains exemples requièrent des certificats.</span><span class="sxs-lookup"><span data-stu-id="47f52-163">Some samples require certificates.</span></span> <span data-ttu-id="47f52-164">Consultez [Internet Information Services (IIS) Instructions d’Installation du certificat serveur](../../../../docs/framework/wcf/samples/iis-server-certificate-installation-instructions.md).</span><span class="sxs-lookup"><span data-stu-id="47f52-164">See [Internet Information Services (IIS) Server Certificate Installation Instructions](../../../../docs/framework/wcf/samples/iis-server-certificate-installation-instructions.md).</span></span>

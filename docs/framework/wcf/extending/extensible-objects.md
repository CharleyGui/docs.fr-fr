---
title: Objets extensibles
ms.date: 03/30/2017
helpviewer_keywords:
- extensible objects [WCF]
ms.assetid: bc88cefc-31fb-428e-9447-6d20a7d452af
ms.openlocfilehash: 682c391e7b3c68de5bf799f77a93df7539681a37
ms.sourcegitcommit: 2701302a99cafbe0d86d53d540eb0fa7e9b46b36
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2019
ms.locfileid: "64654489"
---
# <a name="extensible-objects"></a><span data-ttu-id="7d588-102">Objets extensibles</span><span class="sxs-lookup"><span data-stu-id="7d588-102">Extensible Objects</span></span>

<span data-ttu-id="7d588-103">Le modèle d’objet extensible est utilisé pour étendre des classes d’exécution existantes à l’aide de nouvelles fonctionnalités ou ajouter un nouvel état à un objet.</span><span class="sxs-lookup"><span data-stu-id="7d588-103">The extensible object pattern is used to either extend existing runtime classes with new functionality or to add new state to an object.</span></span> <span data-ttu-id="7d588-104">Les extensions, attachées à l’un des objets extensibles, permettent aux comportements à des étapes différentes du traitement, d’accéder à l’état partagé et aux fonctionnalités attachés à un objet extensible commun qui leur est accessible.</span><span class="sxs-lookup"><span data-stu-id="7d588-104">Extensions, attached to one of the extensible objects, enable behaviors at very different stages in processing to access shared state and functionality attached to a common extensible object that they can access.</span></span>

## <a name="the-iextensibleobjectt-pattern"></a><span data-ttu-id="7d588-105">IExtensibleObject\<T > modèle</span><span class="sxs-lookup"><span data-stu-id="7d588-105">The IExtensibleObject\<T> Pattern</span></span>

<span data-ttu-id="7d588-106">Le modèle d'objet extensible contient trois interfaces : <xref:System.ServiceModel.IExtensibleObject%601>, <xref:System.ServiceModel.IExtension%601> et <xref:System.ServiceModel.IExtensionCollection%601>.</span><span class="sxs-lookup"><span data-stu-id="7d588-106">There are three interfaces in the extensible object pattern: <xref:System.ServiceModel.IExtensibleObject%601>, <xref:System.ServiceModel.IExtension%601>, and <xref:System.ServiceModel.IExtensionCollection%601>.</span></span>

<span data-ttu-id="7d588-107">L'interface <xref:System.ServiceModel.IExtensibleObject%601> est implémentée par les types qui permettent aux objets <xref:System.ServiceModel.IExtension%601> de personnaliser leurs fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="7d588-107">The <xref:System.ServiceModel.IExtensibleObject%601> interface is implemented by types that allow <xref:System.ServiceModel.IExtension%601> objects to customize their functionality.</span></span>

<span data-ttu-id="7d588-108">Les objets extensibles permettent le regroupement dynamique des objets <xref:System.ServiceModel.IExtension%601>.</span><span class="sxs-lookup"><span data-stu-id="7d588-108">Extensible objects allow dynamic aggregation of <xref:System.ServiceModel.IExtension%601> objects.</span></span> <span data-ttu-id="7d588-109">Les objets <xref:System.ServiceModel.IExtension%601> sont caractérisés par l'interface suivante :</span><span class="sxs-lookup"><span data-stu-id="7d588-109"><xref:System.ServiceModel.IExtension%601> objects are characterized by the following interface:</span></span>

```csharp
public interface IExtension<T>
where T : IExtensibleObject<T>
{
    void Attach(T owner);
    void Detach(T owner);
}
```

<span data-ttu-id="7d588-110">La restriction de type garantit que les extensions ne peuvent être définies que pour les classes <xref:System.ServiceModel.IExtensibleObject%601>.</span><span class="sxs-lookup"><span data-stu-id="7d588-110">The type restriction guarantees that extensions can only be defined for classes that are <xref:System.ServiceModel.IExtensibleObject%601>.</span></span> <span data-ttu-id="7d588-111"><xref:System.ServiceModel.IExtension%601.Attach%2A> et <xref:System.ServiceModel.IExtension%601.Detach%2A> fournissent une notification de l'agrégation ou de la désagrégation.</span><span class="sxs-lookup"><span data-stu-id="7d588-111"><xref:System.ServiceModel.IExtension%601.Attach%2A> and <xref:System.ServiceModel.IExtension%601.Detach%2A> provide notification of aggregation or disaggregation.</span></span>

<span data-ttu-id="7d588-112">Il est valide pour les implémentations d'appliquer des restrictions lorsqu'elles peuvent être ajoutées et supprimées d'un propriétaire.</span><span class="sxs-lookup"><span data-stu-id="7d588-112">It is valid for implementations to restrict when they may be added and removed from an owner.</span></span> <span data-ttu-id="7d588-113">Par exemple, vous pouvez complètement interdire la suppression en interdisant l'ajout ou la suppression des extensions lorsque le propriétaire ou l'extension est dans un certain état, interdire l'ajout simultané à plusieurs propriétaires ou autoriser uniquement un ajout unique suivi par une suppression unique.</span><span class="sxs-lookup"><span data-stu-id="7d588-113">For example, you can disallow removal entirely, disallowing adding or removing extensions when the owner or extension are in a certain state, disallow adding to multiple owners concurrently, or allow only a single addition followed by a single remove.</span></span>

<span data-ttu-id="7d588-114"><xref:System.ServiceModel.IExtension%601> n'implique pas d'interactions avec d'autres interfaces standard managées.</span><span class="sxs-lookup"><span data-stu-id="7d588-114"><xref:System.ServiceModel.IExtension%601> does not imply any interactions with other standard managed interfaces.</span></span> <span data-ttu-id="7d588-115">Plus précisément, la méthode <xref:System.IDisposable.Dispose%2A?displayProperty=nameWithType> sur l'objet de propriétaire ne détache pas normalement ses extensions.</span><span class="sxs-lookup"><span data-stu-id="7d588-115">Specifically, the <xref:System.IDisposable.Dispose%2A?displayProperty=nameWithType> method on the owner object does not normally detach its extensions.</span></span>

<span data-ttu-id="7d588-116">Lorsqu’une extension est ajoutée à la collection, <xref:System.ServiceModel.IExtension%601.Attach%2A> est appelé avant d’entrer dans la collection.</span><span class="sxs-lookup"><span data-stu-id="7d588-116">When an extension is added to the collection, <xref:System.ServiceModel.IExtension%601.Attach%2A> is called before it goes into the collection.</span></span> <span data-ttu-id="7d588-117">Lorsqu'une extension est supprimée de la collection, <xref:System.ServiceModel.IExtension%601.Detach%2A> est appelée après sa suppression.</span><span class="sxs-lookup"><span data-stu-id="7d588-117">When an extension is removed from the collection, <xref:System.ServiceModel.IExtension%601.Detach%2A> is called after it is removed.</span></span> <span data-ttu-id="7d588-118">Cela signifie (en supposant une synchronisation correcte) qu'une extension ne peut figurer dans la collection que si elle se situe entre <xref:System.ServiceModel.IExtension%601.Attach%2A> et <xref:System.ServiceModel.IExtension%601.Detach%2A>.</span><span class="sxs-lookup"><span data-stu-id="7d588-118">This means (assuming appropriate synchronization) an extension can count on only being found in the collection while it is between <xref:System.ServiceModel.IExtension%601.Attach%2A> and <xref:System.ServiceModel.IExtension%601.Detach%2A>.</span></span>

<span data-ttu-id="7d588-119">L’objet passé à <xref:System.ServiceModel.IExtensionCollection%601.FindAll%2A> ou <xref:System.ServiceModel.IExtensionCollection%601.Find%2A> n’a pas besoin d’être <xref:System.ServiceModel.IExtension%601> (par exemple, vous pouvez passer tout objet), mais l’extension retournée est un <xref:System.ServiceModel.IExtension%601>.</span><span class="sxs-lookup"><span data-stu-id="7d588-119">The object passed to <xref:System.ServiceModel.IExtensionCollection%601.FindAll%2A> or <xref:System.ServiceModel.IExtensionCollection%601.Find%2A> need not be <xref:System.ServiceModel.IExtension%601> (for example, you can pass any object), but the returned extension is an <xref:System.ServiceModel.IExtension%601>.</span></span>

<span data-ttu-id="7d588-120">Si aucune extension dans la collection est un <xref:System.ServiceModel.IExtension%601>, <xref:System.ServiceModel.IExtensionCollection%601.Find%2A> retourne la valeur null, et <xref:System.ServiceModel.IExtensionCollection%601.FindAll%2A> retourne une collection vide.</span><span class="sxs-lookup"><span data-stu-id="7d588-120">If no extension in the collection is an <xref:System.ServiceModel.IExtension%601>, <xref:System.ServiceModel.IExtensionCollection%601.Find%2A> returns null, and <xref:System.ServiceModel.IExtensionCollection%601.FindAll%2A> returns an empty collection.</span></span> <span data-ttu-id="7d588-121">Si plusieurs extensions implémentent <xref:System.ServiceModel.IExtension%601>, <xref:System.ServiceModel.IExtensionCollection%601.Find%2A> retourne l’une d’entre elle.</span><span class="sxs-lookup"><span data-stu-id="7d588-121">If multiple extensions implement <xref:System.ServiceModel.IExtension%601>, <xref:System.ServiceModel.IExtensionCollection%601.Find%2A> returns one of them.</span></span> <span data-ttu-id="7d588-122">La valeur retournée par <xref:System.ServiceModel.IExtensionCollection%601.FindAll%2A> est un instantané.</span><span class="sxs-lookup"><span data-stu-id="7d588-122">The value returned from <xref:System.ServiceModel.IExtensionCollection%601.FindAll%2A> is a snapshot.</span></span>

<span data-ttu-id="7d588-123">Il y a deux scénarios principaux.</span><span class="sxs-lookup"><span data-stu-id="7d588-123">There are two main scenarios.</span></span> <span data-ttu-id="7d588-124">Le premier scénario utilise la propriété <xref:System.ServiceModel.IExtensibleObject%601.Extensions%2A> comme un dictionnaire basé sur un type pour insérer l'état sur un objet pour permettre à un autre composant de le rechercher à l'aide du type.</span><span class="sxs-lookup"><span data-stu-id="7d588-124">The first scenario uses the <xref:System.ServiceModel.IExtensibleObject%601.Extensions%2A> property as a type-based dictionary to insert state on an object to enable another component to look it up using the type.</span></span>

<span data-ttu-id="7d588-125">Le deuxième scénario utilise les propriétés <xref:System.ServiceModel.IExtension%601.Attach%2A> et <xref:System.ServiceModel.IExtension%601.Detach%2A> pour permettre à un objet de participer à un comportement personnalisé, tel que l'inscription aux événements, l'observation des transitions d'état, etc.</span><span class="sxs-lookup"><span data-stu-id="7d588-125">The second scenario uses the <xref:System.ServiceModel.IExtension%601.Attach%2A> and <xref:System.ServiceModel.IExtension%601.Detach%2A> properties to enable an object to participate in custom behavior, such as registering for events, watching state transitions, and so on.</span></span>

<span data-ttu-id="7d588-126">L'interface <xref:System.ServiceModel.IExtensionCollection%601> est une collection d'objets <xref:System.ServiceModel.IExtension%601> qui permet la récupération de <xref:System.ServiceModel.IExtension%601> par son type.</span><span class="sxs-lookup"><span data-stu-id="7d588-126">The <xref:System.ServiceModel.IExtensionCollection%601> interface is a collection of the <xref:System.ServiceModel.IExtension%601> objects that allow for retrieving the <xref:System.ServiceModel.IExtension%601> by its type.</span></span> <span data-ttu-id="7d588-127"><xref:System.ServiceModel.IExtensionCollection%601.Find%2A?displayProperty=nameWithType> retourne l'objet récemment ajouté dans un <xref:System.ServiceModel.IExtension%601> de ce type.</span><span class="sxs-lookup"><span data-stu-id="7d588-127"><xref:System.ServiceModel.IExtensionCollection%601.Find%2A?displayProperty=nameWithType> returns the most recently added object that is an <xref:System.ServiceModel.IExtension%601> of that type.</span></span>

### <a name="extensible-objects-in-windows-communication-foundation"></a><span data-ttu-id="7d588-128">Objets extensibles dans Windows Communication Foundation</span><span class="sxs-lookup"><span data-stu-id="7d588-128">Extensible Objects in Windows Communication Foundation</span></span>

<span data-ttu-id="7d588-129">Il existe quatre objets extensibles dans Windows Communication Foundation (WCF) :</span><span class="sxs-lookup"><span data-stu-id="7d588-129">There are four extensible objects in Windows Communication Foundation (WCF):</span></span>

- <span data-ttu-id="7d588-130"><xref:System.ServiceModel.ServiceHostBase> - Il s'agit de la classe de base pour l'hôte du service.</span><span class="sxs-lookup"><span data-stu-id="7d588-130"><xref:System.ServiceModel.ServiceHostBase> – This is the base class for the service’s host.</span></span>  <span data-ttu-id="7d588-131">Les extensions de cette classe peuvent être utilisées pour étendre le comportement du <xref:System.ServiceModel.ServiceHostBase> lui-même ou pour stocker l'état pour chaque service.</span><span class="sxs-lookup"><span data-stu-id="7d588-131">Extensions of this class can be used to extend the behavior of the <xref:System.ServiceModel.ServiceHostBase> itself or to store the state for each service.</span></span>

- <span data-ttu-id="7d588-132"><xref:System.ServiceModel.InstanceContext> - Cette classe connecte une instance du type du service à l'exécution du service.</span><span class="sxs-lookup"><span data-stu-id="7d588-132"><xref:System.ServiceModel.InstanceContext> – This class connects an instance of the service’s type with the service runtime.</span></span>  <span data-ttu-id="7d588-133">Elle contient des informations sur l'instance et une référence au <xref:System.ServiceModel.InstanceContext> qui contient <xref:System.ServiceModel.ServiceHostBase>.</span><span class="sxs-lookup"><span data-stu-id="7d588-133">It contains information about the instance as well as a reference to the <xref:System.ServiceModel.InstanceContext>'s containing <xref:System.ServiceModel.ServiceHostBase>.</span></span> <span data-ttu-id="7d588-134">Les extensions de cette classe peuvent être utilisées pour étendre le comportement du <xref:System.ServiceModel.InstanceContext> ou pour stocker l'état pour chaque service.</span><span class="sxs-lookup"><span data-stu-id="7d588-134">Extensions of this class can be used to extend the behavior of the <xref:System.ServiceModel.InstanceContext> or to store the state for each service.</span></span>

- <span data-ttu-id="7d588-135"><xref:System.ServiceModel.OperationContext> - Cette classe représente les informations d'opération que l'exécution rassemble pour chaque opération.</span><span class="sxs-lookup"><span data-stu-id="7d588-135"><xref:System.ServiceModel.OperationContext> – This class represents the operation information that the runtime gathers for each operation.</span></span>  <span data-ttu-id="7d588-136">Cela inclut des informations telles que les en-têtes de message entrant, les propriétés de message entrant, l'identité de sécurité entrante et d'autres informations.</span><span class="sxs-lookup"><span data-stu-id="7d588-136">This includes information such as the incoming message headers, the incoming message properties, the incoming security identity, and other information.</span></span>  <span data-ttu-id="7d588-137">Les extensions de cette classe peuvent étendre le comportement de <xref:System.ServiceModel.OperationContext> ou stocker l’état pour chaque opération.</span><span class="sxs-lookup"><span data-stu-id="7d588-137">Extensions of this class can either extend the behavior of <xref:System.ServiceModel.OperationContext> or store the state for each operation.</span></span>

- <span data-ttu-id="7d588-138"><xref:System.ServiceModel.IContextChannel> – Cette interface permet l’inspection de chaque état pour les canaux et les proxys construits par le runtime WCF.</span><span class="sxs-lookup"><span data-stu-id="7d588-138"><xref:System.ServiceModel.IContextChannel> – This interface allows for the inspection of each state for the channels and proxies built by the WCF runtime.</span></span>  <span data-ttu-id="7d588-139">Les extensions de cette classe peuvent étendre le comportement de <xref:System.ServiceModel.IClientChannel> ou peuvent l’utiliser pour stocker l’état pour chaque canal.</span><span class="sxs-lookup"><span data-stu-id="7d588-139">Extensions of this class can either extend the behavior of <xref:System.ServiceModel.IClientChannel> or can use it to store the state for each channel.</span></span>

<span data-ttu-id="7d588-140">L’exemple de code suivant montre l’utilisation d’une simple extension pour assurer le suivi des objets <xref:System.ServiceModel.InstanceContext>.</span><span class="sxs-lookup"><span data-stu-id="7d588-140">The following code example shows the use of a simple extension to track <xref:System.ServiceModel.InstanceContext> objects.</span></span>

[!code-csharp[IInstanceContextInitializer#1](../../../../samples/snippets/csharp/VS_Snippets_CFX/iinstancecontextinitializer/cs/initializer.cs#1)]

## <a name="see-also"></a><span data-ttu-id="7d588-141">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="7d588-141">See also</span></span>

- <xref:System.ServiceModel.IExtensibleObject%601>
- <xref:System.ServiceModel.IExtension%601>
- <xref:System.ServiceModel.IExtensionCollection%601>

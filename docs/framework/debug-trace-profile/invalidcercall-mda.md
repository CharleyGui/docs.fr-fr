---
title: Assistant Débogage managé invalidCERCall
ms.date: 03/30/2017
helpviewer_keywords:
- invalid CER calls
- InvalidCERCall MDA
- MDAs (managed debugging assistants), CER calls
- constrained execution regions
- CER calls
- managed debugging assistants (MDAs), CER calls
ms.assetid: c4577410-602e-44e5-9dab-fea7c55bcdfe
author: mairaw
ms.author: mairaw
ms.openlocfilehash: d508beb697e07f7d3b960b6627b9a07ffe25adf4
ms.sourcegitcommit: 289e06e904b72f34ac717dbcc5074239b977e707
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/17/2019
ms.locfileid: "71052635"
---
# <a name="invalidcercall-mda"></a><span data-ttu-id="fcb9c-102">Assistant Débogage managé invalidCERCall</span><span class="sxs-lookup"><span data-stu-id="fcb9c-102">invalidCERCall MDA</span></span>
<span data-ttu-id="fcb9c-103">L’Assistant Débogage managé `invalidCERCall` est activé en cas d’appel, dans le graphique de la région d’exécution limitée, à une méthode qui ne possède aucun contrat de fiabilité ni contrat excessivement faible.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-103">The `invalidCERCall` managed debugging assistant (MDA) is activated when there is a call within the constrained execution region (CER) graph to a method that has no reliability contract or an excessively weak contract.</span></span> <span data-ttu-id="fcb9c-104">Un contrat faible est un contrat qui déclare que la pire altération d’état envisageable dépasse la portée de l’instance passée à l’appel. En d’autres termes, l’<xref:System.AppDomain> ou l’état du processus peut être endommagé ou il ne sera pas toujours possible de calculer son résultat de façon déterministe lors de son appel dans une région d’exécution limitée.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-104">A weak contract is a contract that declares that the worst case state corruption is of greater scope than the instance passed to the call, that is, the <xref:System.AppDomain> or process state may become corrupted or that its result is not always deterministically computable when called within a CER.</span></span>  
  
## <a name="symptoms"></a><span data-ttu-id="fcb9c-105">Symptômes</span><span class="sxs-lookup"><span data-stu-id="fcb9c-105">Symptoms</span></span>  
 <span data-ttu-id="fcb9c-106">Résultats inattendus lors de l’exécution du code dans une région d’exécution limitée.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-106">Unexpected results when executing code in a CER.</span></span> <span data-ttu-id="fcb9c-107">Les symptômes ne sont pas spécifiques.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-107">The symptoms are not specific.</span></span> <span data-ttu-id="fcb9c-108">Il peut s’agir d’une <xref:System.OutOfMemoryException> inattendue, d’une <xref:System.Threading.ThreadAbortException> ou d’autres exceptions lors de l’appel dans la méthode peu fiable dans la mesure où le runtime ne l’a pas préparée à l’avance ni ne l’a protégée contre des exceptions <xref:System.Threading.ThreadAbortException> au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-108">They could be an unexpected <xref:System.OutOfMemoryException>, a <xref:System.Threading.ThreadAbortException>, or other exceptions at the call into the unreliable method because the runtime did not prepare it ahead of time or protect it from <xref:System.Threading.ThreadAbortException> exceptions at run time.</span></span> <span data-ttu-id="fcb9c-109">Il existe toutefois une menace bien plus grave : toute exception résultant de la méthode au moment de l’exécution est susceptible de laisser l’<xref:System.AppDomain> ou le processus dans un état instable, ce qui est contraire à l’objectif d’une région d’exécution limitée.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-109">A greater threat is that any exception resulting from the method at run time could leave the <xref:System.AppDomain> or process in an unstable state, which is contrary to the objective of a CER.</span></span> <span data-ttu-id="fcb9c-110">En effet, une région d’exécution limitée est créée dans le but d’éviter des altérations d’état de ce type.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-110">The reason a CER is created is to avoid state corruptions such as this.</span></span> <span data-ttu-id="fcb9c-111">Les symptômes d’un état altéré sont spécifiques à l’application étant donné que la définition d’un état cohérent diffère d’une application à l’autre.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-111">The symptoms of corrupt state are application specific because the definition of consistent state is different between applications.</span></span>  
  
## <a name="cause"></a><span data-ttu-id="fcb9c-112">Cause</span><span class="sxs-lookup"><span data-stu-id="fcb9c-112">Cause</span></span>  
 <span data-ttu-id="fcb9c-113">Le code dans une région d’exécution limitée appelle une fonction sans <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> ou avec un <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> faible qui n’est pas compatible avec une exécution au sein d’une région d’exécution limitée.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-113">Code within a CER is calling a function with no <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> or with a weak <xref:System.Runtime.ConstrainedExecution.ReliabilityContractAttribute> that is not compatible with running in a CER.</span></span>  
  
 <span data-ttu-id="fcb9c-114">En termes de syntaxe du contrat de fiabilité, un contrat faible est un contrat qui ne spécifie pas de valeur d’énumération <xref:System.Runtime.ConstrainedExecution.Consistency> ou qui spécifie une valeur <xref:System.Runtime.ConstrainedExecution.Consistency> égale à <xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptProcess>, <xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptAppDomain> ou <xref:System.Runtime.ConstrainedExecution.Cer.None>.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-114">In terms of reliability contract syntax, a weak contract is a contract that does not specify a <xref:System.Runtime.ConstrainedExecution.Consistency> enumeration value or specifies a <xref:System.Runtime.ConstrainedExecution.Consistency> value of <xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptProcess>, <xref:System.Runtime.ConstrainedExecution.Consistency.MayCorruptAppDomain>, or <xref:System.Runtime.ConstrainedExecution.Cer.None>.</span></span> <span data-ttu-id="fcb9c-115">Chacune de ces conditions indique que le code appelé peut empêcher le reste du code de la région d’exécution limitée de conserver un état cohérent.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-115">Any of these conditions indicates that the code called may impede the efforts of the other code in the CER to maintain consistent state.</span></span>  <span data-ttu-id="fcb9c-116">Les régions d’exécution limitée permettent au code de traiter des erreurs de façon très déterministe, en conservant des invariantes internes importantes pour l’application et en lui permettant de poursuivre son exécution en présence d’erreurs transitoires telles que les exceptions de mémoire insuffisante.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-116">CERs allow code to treat errors in a very deterministic manner, maintaining internal invariants that are important to the application and allowing it to continue running in the face of transient errors such as out-of-memory exceptions.</span></span>  
  
 <span data-ttu-id="fcb9c-117">L’activation de cet Assistant Débogage managé indique une possibilité d’échec de la méthode appelée dans la région d’exécution limitée d’une façon que l’appelant n’avait pas prévue ou qui laisse l’<xref:System.AppDomain> ou le processus dans un état altéré ou irrécupérable.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-117">The activation of this MDA indicates a possibility the method being called in the CER can fail in a way that the caller did not expect or that leaves the <xref:System.AppDomain> or process state corrupted or unrecoverable.</span></span> <span data-ttu-id="fcb9c-118">Il est évidemment possible que le code appelé s’exécute correctement et qu’il ne s’agisse que d’un simple problème de contrat manquant.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-118">Of course, the called code might execute correctly and the problem is simply a missing contract.</span></span> <span data-ttu-id="fcb9c-119">Toutefois, les problèmes associés à l’écriture de code fiable sont délicats et l’absence d’un contrat est souvent le signe que le code peut ne pas s’exécuter correctement.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-119">However, the issues involved in writing reliable code are subtle and the absence of a contract is a good indicator the code might not execute correctly.</span></span> <span data-ttu-id="fcb9c-120">Un contrat est un indicateur de la fiabilité du codage du programmeur et la promesse que ces garanties ne changeront pas lors des futures revues du code.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-120">The contracts are indicators that the programmer has coded reliably and also promises that these guarantees will not change in future revisions of the code.</span></span>  <span data-ttu-id="fcb9c-121">En d’autres termes, les contrats sont des déclarations d’intention et pas uniquement des détails d’implémentation.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-121">That is, the contracts are declarations of intent and not just implementation details.</span></span>  
  
 <span data-ttu-id="fcb9c-122">Dans la mesure où toute méthode avec un contrat faible ou inexistant peut potentiellement échouer de diverses façons, souvent imprévisibles, le runtime ne tente de supprimer de la méthode aucun de ses propres échecs imprévisibles, introduits notamment par une compilation JIT en différé, par un remplissage du dictionnaire des génériques ou par des interruptions de threads.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-122">Because any method with a weak or nonexistent contract can potentially fail in many unpredictable ways, the runtime does not attempt to remove any of its own unpredictable failures from the method  that are introduced by lazy JIT-compiling, generics dictionary population, or thread aborts, for example.</span></span> <span data-ttu-id="fcb9c-123">En d’autres termes, quand cet Assistant Débogage managé est activé, il indique que le runtime n’a pas inclus la méthode appelée dans la région d’exécution limitée en cours de définition ; le graphique des appels a été interrompu au niveau de ce nœud, car toute poursuite de la préparation de cette sous-arborescence peut contribuer à masquer l’erreur potentielle.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-123">That is, when this MDA is activated, it indicates that the runtime did not include the called method in the CER being defined; the call graph was terminated at this node because continuing to prepare this subtree would help mask the potential error.</span></span>  
  
## <a name="resolution"></a><span data-ttu-id="fcb9c-124">Résolution :</span><span class="sxs-lookup"><span data-stu-id="fcb9c-124">Resolution</span></span>  
 <span data-ttu-id="fcb9c-125">Ajoutez un contrat de fiabilité valide à la fonction ou évitez d’utiliser cet appel de fonction.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-125">Add a valid reliability contract to the function or avoid using that function call.</span></span>  
  
## <a name="effect-on-the-runtime"></a><span data-ttu-id="fcb9c-126">Effet sur le runtime</span><span class="sxs-lookup"><span data-stu-id="fcb9c-126">Effect on the Runtime</span></span>  
 <span data-ttu-id="fcb9c-127">L’appel à un contrat faible à partir d’une région d’exécution limitée peut empêcher cette région d’exécution limitée d’achever ses opérations.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-127">The effect of calling a weak contract from a CER could be the CER failure to complete its operations.</span></span> <span data-ttu-id="fcb9c-128">Cela peut aboutir à l’altération de l’état du processus d’<xref:System.AppDomain>.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-128">This could lead to corruption of the <xref:System.AppDomain> process state.</span></span>  
  
## <a name="output"></a><span data-ttu-id="fcb9c-129">Sortie</span><span class="sxs-lookup"><span data-stu-id="fcb9c-129">Output</span></span>  
 <span data-ttu-id="fcb9c-130">L’exemple suivant illustre une sortie de cet Assistant Débogage managé.</span><span class="sxs-lookup"><span data-stu-id="fcb9c-130">The following is sample output from this MDA.</span></span>  
  
 `Method 'MethodWithCer', while executing within a constrained execution region, makes a call at IL offset 0x000C to 'MethodWithWeakContract', which does not have a sufficiently strong reliability contract and might cause non-deterministic results.`  
  
## <a name="configuration"></a><span data-ttu-id="fcb9c-131">Configuration</span><span class="sxs-lookup"><span data-stu-id="fcb9c-131">Configuration</span></span>  
  
```xml  
<mdaConfig>  
  <assistants>  
    <invalidCERCall />  
  </assistants>  
</mdaConfig>  
```  
  
## <a name="see-also"></a><span data-ttu-id="fcb9c-132">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="fcb9c-132">See also</span></span>

- <xref:System.Runtime.CompilerServices.RuntimeHelpers.PrepareMethod%2A>
- <xref:System.Runtime.ConstrainedExecution>
- [<span data-ttu-id="fcb9c-133">Diagnostic d’erreurs avec les Assistants Débogage managé</span><span class="sxs-lookup"><span data-stu-id="fcb9c-133">Diagnosing Errors with Managed Debugging Assistants</span></span>](diagnosing-errors-with-managed-debugging-assistants.md)

---
title: Génération de profils d'exécution
ms.date: 03/30/2017
helpviewer_keywords:
- performance counters
- common language runtime, profiling
- Perfmon.exe
- System Monitor
- profiling
- runtime, profiling
- profiling applications
- Performance Console
ms.assetid: ccd68284-f3a8-47b8-bc3f-92e5fe3a1640
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 7214fa0342d0946044861c4e375c7797ad6a06b1
ms.sourcegitcommit: 34593b4d0be779699d38a9949d6aec11561657ec
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 06/11/2019
ms.locfileid: "66833763"
---
# <a name="runtime-profiling"></a><span data-ttu-id="ebf75-102">Génération de profils d'exécution</span><span class="sxs-lookup"><span data-stu-id="ebf75-102">Runtime Profiling</span></span>
<span data-ttu-id="ebf75-103">Le profilage est une méthode de collecte de données de performance dans le cadre d’un scénario de développement ou de déploiement.</span><span class="sxs-lookup"><span data-stu-id="ebf75-103">Profiling is a method of gathering performance data in any development or deployment scenario.</span></span> <span data-ttu-id="ebf75-104">Cette section s’adresse aux développeurs et administrateurs système qui souhaitent recueillir des informations sur les performances d’une application.</span><span class="sxs-lookup"><span data-stu-id="ebf75-104">This section is for developers and system administrators who want to gather information about application performance.</span></span>  
  
## <a name="tracking-performance-using-the-performance-monitor-perfmonexe"></a><span data-ttu-id="ebf75-105">Suivi des performances à l’aide de l’analyseur de performances (Perfmon.exe)</span><span class="sxs-lookup"><span data-stu-id="ebf75-105">Tracking Performance Using the Performance Monitor (Perfmon.exe)</span></span>  
 <span data-ttu-id="ebf75-106">L’Analyseur de performances est l’outil le plus simple à utiliser pour profiler votre application .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ebf75-106">The Performance Monitor is the easiest tool to use to profile your .NET Framework application.</span></span> <span data-ttu-id="ebf75-107">L’Analyseur de performances représente graphiquement les données trouvées dans les compteurs de performances de .NET Framework qui sont installés avec le common language runtime et le Kit de développement logiciel (SDK) Windows.</span><span class="sxs-lookup"><span data-stu-id="ebf75-107">The Performance Monitor graphically represents data found in the .NET Framework performance counters that are installed with the common language runtime and the Windows Software Development Kit (SDK).</span></span> <span data-ttu-id="ebf75-108">Ces compteurs permettent de tout surveiller, de la gestion de la mémoire jusqu’aux performances du compilateur juste-à-temps (JIT).</span><span class="sxs-lookup"><span data-stu-id="ebf75-108">These counters can be used to monitor everything from memory management to just-in-time (JIT) compiler performance.</span></span> <span data-ttu-id="ebf75-109">Ils vous renseignent sur les ressources que votre application utilise, ce qui est une mesure indirecte des performances de votre application.</span><span class="sxs-lookup"><span data-stu-id="ebf75-109">They tell you about the resources your application uses, which is an indirect measure of your application's performance.</span></span> <span data-ttu-id="ebf75-110">Ces compteurs s’avèrent utiles pour comprendre le fonctionnement interne de votre application.</span><span class="sxs-lookup"><span data-stu-id="ebf75-110">Use these counters to understand how your application works internally.</span></span>  
  
#### <a name="to-run-perfmonexe-on-windows-vista-and-later-versions"></a><span data-ttu-id="ebf75-111">Pour exécuter Perfmon.exe sur Windows Vista et les versions ultérieures</span><span class="sxs-lookup"><span data-stu-id="ebf75-111">To run Perfmon.exe on Windows Vista and later versions</span></span>  
  
1. <span data-ttu-id="ebf75-112">À l'invite de commandes, entrez **perfmon**.</span><span class="sxs-lookup"><span data-stu-id="ebf75-112">At the command prompt, type **perfmon**.</span></span> <span data-ttu-id="ebf75-113">La console **Analyseur de performances** apparaît.</span><span class="sxs-lookup"><span data-stu-id="ebf75-113">The **Performance Monitor** console appears.</span></span>  
  
2. <span data-ttu-id="ebf75-114">Dans le dossier **Outils d’analyse** , cliquez sur **Analyseur de performances**.</span><span class="sxs-lookup"><span data-stu-id="ebf75-114">In the **Monitoring Tools** folder, click **Performance Monitor**.</span></span>  
  
3. <span data-ttu-id="ebf75-115">Dans la barre d’outils de l’analyseur de performances, cliquez sur l’icône **Ajouter** (signe plus), si elle est présente.</span><span class="sxs-lookup"><span data-stu-id="ebf75-115">In the Performance Monitor toolbar, click the **Add** icon (the plus sign), if it is present.</span></span> <span data-ttu-id="ebf75-116">À défaut, cliquez avec le bouton droit dans la fenêtre de l’analyseur et sélectionnez l’option **Ajouter des compteurs** .</span><span class="sxs-lookup"><span data-stu-id="ebf75-116">If it is not present, right-click in the monitor window and select the **Add Counters** option.</span></span>  
  
     <span data-ttu-id="ebf75-117">La boîte de dialogue **Ajouter des compteurs** s’ouvre.</span><span class="sxs-lookup"><span data-stu-id="ebf75-117">This opens the **Add Counters** dialog box.</span></span> <span data-ttu-id="ebf75-118">La zone de liste **Compteurs disponibles** présente les objets de performance disponibles.</span><span class="sxs-lookup"><span data-stu-id="ebf75-118">The **Available counters** list box displays the available performance objects.</span></span> <span data-ttu-id="ebf75-119">Il existe plusieurs objets prédéfinis pour les applications .NET Framework, notamment ceux qui touchent à la gestion de la mémoire ( **.NET CLR Memory**), à l’interopérabilité ( **.NET CLR Interop**), à la gestion des exceptions ( **.NET CLR Exceptions**) et au multithreading ( **.NET CLR LocksAndThreads**).</span><span class="sxs-lookup"><span data-stu-id="ebf75-119">There are a number of predefined objects for .NET Framework applications, including those for memory management (**.NET CLR Memory**), interoperability (**.NET CLR Interop**), exception handling (**.NET CLR Exceptions**), and multithreading (**.NET CLR LocksAndThreads**).</span></span> <span data-ttu-id="ebf75-120">Chaque objet de performance comprend un certain nombre de compteurs de performances individuels.</span><span class="sxs-lookup"><span data-stu-id="ebf75-120">Each performance object includes a number of individual performance counters.</span></span> <span data-ttu-id="ebf75-121">Pour obtenir la liste des compteurs de performances disponibles dans l’analyseur de performances, consultez [Performance Counters](../../../docs/framework/debug-trace-profile/performance-counters.md).</span><span class="sxs-lookup"><span data-stu-id="ebf75-121">For a list of the performance counters available in Performance Monitor, see [Performance Counters](../../../docs/framework/debug-trace-profile/performance-counters.md).</span></span>  
  
4. <span data-ttu-id="ebf75-122">Cochez la case en regard du nom d’un objet de performance pour afficher la liste des compteurs de performances individuels qu’il prend en charge.</span><span class="sxs-lookup"><span data-stu-id="ebf75-122">Select the check box next to a performance object's name to view the list of individual performance counters that it supports.</span></span>  
  
5. <span data-ttu-id="ebf75-123">Cliquez sur le compteur de performances que vous voulez afficher.</span><span class="sxs-lookup"><span data-stu-id="ebf75-123">Click the performance counter you want to view.</span></span>  
  
6. <span data-ttu-id="ebf75-124">Dans la zone de liste **Instances de l’objet sélectionné**, cliquez sur **\<Toutes les instances>** pour spécifier que vous voulez analyser le compteur de performances pour le Common Language Runtime dans sa globalité (c’est-à-dire à l’échelle du système).</span><span class="sxs-lookup"><span data-stu-id="ebf75-124">In the **Instances of selected object** list box, click **\<All instances>** to specify that you want to monitor the performance counter for the common language runtime globally (that is, on a system-wide basis).</span></span>  
  
     <span data-ttu-id="ebf75-125">ou</span><span class="sxs-lookup"><span data-stu-id="ebf75-125">-or-</span></span>  
  
     <span data-ttu-id="ebf75-126">Dans la zone de liste **Instances de l’objet sélectionné** , cliquez sur le nom d’une application pour analyser le compteur de performances de cette application.</span><span class="sxs-lookup"><span data-stu-id="ebf75-126">In the **Instances of selected object** list box, click an application name to monitor the performance counter for that application.</span></span>  
  
     <span data-ttu-id="ebf75-127">Pour différencier plusieurs versions du runtime ou pour lever toute ambiguïté quant aux applications qui ont le même nom, vous devez aussi modifier une clé de Registre.</span><span class="sxs-lookup"><span data-stu-id="ebf75-127">To differentiate multiple versions of the runtime, or to disambiguate multiple applications with the same name, you must also modify a registry key.</span></span> <span data-ttu-id="ebf75-128">Pour plus d'informations, consultez [Performance Counters and In-Process Side-By-Side Applications](../../../docs/framework/debug-trace-profile/performance-counters-and-in-process-side-by-side-applications.md).</span><span class="sxs-lookup"><span data-stu-id="ebf75-128">For more information, see [Performance Counters and In-Process Side-By-Side Applications](../../../docs/framework/debug-trace-profile/performance-counters-and-in-process-side-by-side-applications.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ebf75-129">Si des compteurs de performances nouveaux sont installés pendant l’exécution de la console de performances, arrêtez et redémarrez la console de performances pour les rendre visibles.</span><span class="sxs-lookup"><span data-stu-id="ebf75-129">When new performance counters are installed while the Performance console is running, stop and restart the Performance console to make the new counters visible.</span></span>  
  
 <span data-ttu-id="ebf75-130">Si vous voulez profiler un assembly qui existe dans une zone ou sur un partage distant, assurez-vous que l’assembly distant bénéficie d’une confiance totale sur l’ordinateur qui exécute les compteurs de performances.</span><span class="sxs-lookup"><span data-stu-id="ebf75-130">If you want to profile an assembly that exists in a zone or on a remote share, make sure that the remote assembly has full trust on the computer that runs the performance counters.</span></span> <span data-ttu-id="ebf75-131">Si l’assembly n’a pas un niveau de confiance suffisant, les compteurs de performances ne fonctionnent pas.</span><span class="sxs-lookup"><span data-stu-id="ebf75-131">If the assembly does not have sufficient trust, the performance counters will not work.</span></span> <span data-ttu-id="ebf75-132">Pour plus d’informations sur l’octroi de confiance à différentes zones, consultez [Caspol.exe (outil Stratégie de sécurité d’accès du code)](../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md).</span><span class="sxs-lookup"><span data-stu-id="ebf75-132">For information about granting trust to different zones, see [Caspol.exe (Code Access Security Policy Tool)](../../../docs/framework/tools/caspol-exe-code-access-security-policy-tool.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="ebf75-133">Sur les systèmes sur lesquels le .NET Framework 4 est installé, l’Analyseur de performances ne peut pas afficher les données des compteurs de performances dans certaines catégories, telles que **.NET CLR Data** et **.NET CLR Networking**, pour applications développées à l’aide de .NET Framework 1.1.</span><span class="sxs-lookup"><span data-stu-id="ebf75-133">On systems on which the .NET Framework 4 is installed, the Performance Monitor may not display data for performance counters in some categories, such as **.NET CLR Data** and **.NET CLR Networking**, for applications that were developed using the .NET Framework 1.1.</span></span> <span data-ttu-id="ebf75-134">Si c’est le cas, vous pouvez configurer l’Analyseur de performances pour qu’il affiche ces données en ajoutant l’élément [\<forcePerformanceCounterUniqueSharedMemoryReads>](../../../docs/framework/configure-apps/file-schema/runtime/forceperformancecounteruniquesharedmemoryreads-element.md) au fichier de configuration de l’application.</span><span class="sxs-lookup"><span data-stu-id="ebf75-134">If this is the case, you can configure Performance Monitor to display this data by adding the [\<forcePerformanceCounterUniqueSharedMemoryReads>](../../../docs/framework/configure-apps/file-schema/runtime/forceperformancecounteruniquesharedmemoryreads-element.md) element to the application's configuration file.</span></span>  
  
## <a name="reading-and-creating-performance-counters-programmatically"></a><span data-ttu-id="ebf75-135">Lecture et création de compteurs de performances par programmation</span><span class="sxs-lookup"><span data-stu-id="ebf75-135">Reading and Creating Performance Counters Programmatically</span></span>  
 <span data-ttu-id="ebf75-136">Le .NET Framework fournit des classes que vous pouvez utiliser pour accéder par programme aux mêmes informations de performance qui sont disponibles dans la console de performances.</span><span class="sxs-lookup"><span data-stu-id="ebf75-136">The .NET Framework provides classes you can use to programmatically access the same performance information that is available in the Performance console.</span></span> <span data-ttu-id="ebf75-137">Vous pouvez aussi utiliser ces classes pour créer des compteurs de performances personnalisés.</span><span class="sxs-lookup"><span data-stu-id="ebf75-137">You can also use these classes to create custom performance counters.</span></span> <span data-ttu-id="ebf75-138">Le tableau suivant décrit certaines des performances de la surveillance des classes qui sont fournies dans le .NET Framework.</span><span class="sxs-lookup"><span data-stu-id="ebf75-138">The following table describes some of the performance monitoring classes that are provided in the .NET Framework.</span></span>  
  
|<span data-ttu-id="ebf75-139">Classe</span><span class="sxs-lookup"><span data-stu-id="ebf75-139">Class</span></span>|<span data-ttu-id="ebf75-140">Description</span><span class="sxs-lookup"><span data-stu-id="ebf75-140">Description</span></span>|  
|-----------|-----------------|  
|<xref:System.Diagnostics.PerformanceCounter?displayProperty=nameWithType>|<span data-ttu-id="ebf75-141">Représente un composant de compteur de performances Windows NT.</span><span class="sxs-lookup"><span data-stu-id="ebf75-141">Represents a Windows NT performance counter component.</span></span> <span data-ttu-id="ebf75-142">Cette classe permet de lire les compteurs prédéfinis ou personnalisés existants et de publier (écrire) des données de performance dans des compteurs personnalisés.</span><span class="sxs-lookup"><span data-stu-id="ebf75-142">Use this class to read existing predefined or custom counters and publish (write) performance data to custom counters.</span></span>|  
|<xref:System.Diagnostics.PerformanceCounterCategory?displayProperty=nameWithType>|<span data-ttu-id="ebf75-143">Propose plusieurs méthodes permettant d’interagir avec les compteurs et les catégories de compteurs de l’ordinateur.</span><span class="sxs-lookup"><span data-stu-id="ebf75-143">Provides several methods for interacting with counters and categories of counters on the computer.</span></span>|  
|<xref:System.Diagnostics.PerformanceCounterInstaller?displayProperty=nameWithType>|<span data-ttu-id="ebf75-144">Spécifie un programme d’installation pour le composant `PerformanceCounter` .</span><span class="sxs-lookup"><span data-stu-id="ebf75-144">Specifies an installer for the `PerformanceCounter` component.</span></span>|  
|<xref:System.Diagnostics.PerformanceCounterType?displayProperty=nameWithType>|<span data-ttu-id="ebf75-145">Spécifie la formule de calcul de la méthode `NextValue` pour un `PerformanceCounter`.</span><span class="sxs-lookup"><span data-stu-id="ebf75-145">Specifies the formula to calculate the `NextValue` method for a `PerformanceCounter`.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="ebf75-146">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ebf75-146">See also</span></span>

- [<span data-ttu-id="ebf75-147">Compteurs de performance</span><span class="sxs-lookup"><span data-stu-id="ebf75-147">Performance Counters</span></span>](../../../docs/framework/debug-trace-profile/performance-counters.md)

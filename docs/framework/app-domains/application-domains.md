---
title: Domaines d'application
ms.date: 03/30/2017
helpviewer_keywords:
- process boundaries for isolation
- application isolation
- application domains, about
- common language runtime, application domains
- application domains
- runtime, application domains
- isolation between applications
- code, verification process
- verification testing code
ms.assetid: 113a8bbf-6875-4a72-a49d-ca2d92e19cc8
ms.openlocfilehash: a5c9f4248e060d231941269f39cadbc7147ce27f
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 03/14/2020
ms.locfileid: "79399874"
---
# <a name="application-domains"></a><span data-ttu-id="6d5d6-102">Domaines d'application</span><span class="sxs-lookup"><span data-stu-id="6d5d6-102">Application domains</span></span>

<span data-ttu-id="6d5d6-103">Les systèmes d'exploitation et les environnements d'exécution assurent généralement une certaine forme d'isolation entre les applications.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-103">Operating systems and runtime environments typically provide some form of isolation between applications.</span></span> <span data-ttu-id="6d5d6-104">Par exemple, Windows utilise des processus pour isoler des applications.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-104">For example, Windows uses processes to isolate applications.</span></span> <span data-ttu-id="6d5d6-105">Cette isolation est nécessaire pour que le code en cours d'exécution dans une application ne puisse pas affecter de manière négative d'autres applications non liées.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-105">This isolation is necessary to ensure that code running in one application cannot adversely affect other, unrelated applications.</span></span>  
  
 <span data-ttu-id="6d5d6-106">Les domaines d'application fournissent une limite d'isolation pour la sécurité, la fiabilité, le suivi des versions et le déchargement des assemblys.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-106">Application domains provide an isolation boundary for security, reliability, and versioning, and for unloading assemblies.</span></span> <span data-ttu-id="6d5d6-107">Les domaines d'application sont généralement créés par des hôtes de runtime qui sont chargés d'initialiser le Common Language Runtime avant l'exécution d'une application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-107">Application domains are typically created by runtime hosts, which are responsible for bootstrapping the common language runtime before an application is run.</span></span>  
  
## <a name="the-benefits-of-isolating-applications"></a><span data-ttu-id="6d5d6-108">Avantages de l'isolation des applications</span><span class="sxs-lookup"><span data-stu-id="6d5d6-108">The benefits of isolating applications</span></span>

 <span data-ttu-id="6d5d6-109">Du point de vue historique, les limites de processus ont permis d'isoler les applications en cours d'exécution sur le même ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-109">Historically, process boundaries have been used to isolate applications running on the same computer.</span></span> <span data-ttu-id="6d5d6-110">Chaque application est chargée dans un processus distinct, ce qui isole l'application des autres applications en cours d'exécution sur le même ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-110">Each application is loaded into a separate process, which isolates the application from other applications running on the same computer.</span></span>  
  
 <span data-ttu-id="6d5d6-111">Les applications sont isolées, car les adresses mémoire sont liées au processus ; un pointeur mémoire passé d'un processus à un autre ne peut pas être utilisé d'une manière significative dans le processus cible.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-111">The applications are isolated because memory addresses are process-relative; a memory pointer passed from one process to another cannot be used in any meaningful way in the target process.</span></span> <span data-ttu-id="6d5d6-112">De plus, vous ne pouvez pas établir d'appels directs entre deux processus.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-112">In addition, you cannot make direct calls between two processes.</span></span> <span data-ttu-id="6d5d6-113">Vous devez à la place utiliser des proxys qui génèrent un niveau d'adressage indirect.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-113">Instead, you must use proxies, which provide a level of indirection.</span></span>  
  
 <span data-ttu-id="6d5d6-114">Le code managé doit passer par un processus de vérification avant de pouvoir être exécuté (sauf si l'administrateur a accordé l'autorisation d'ignorer la vérification).</span><span class="sxs-lookup"><span data-stu-id="6d5d6-114">Managed code must be passed through a verification process before it can be run (unless the administrator has granted permission to skip the verification).</span></span> <span data-ttu-id="6d5d6-115">Le processus de vérification détermine si le code peut essayer d'accéder à des adresses mémoire non valides ou effectuer d'autres actions risquant d'empêcher le processus dans lequel il s'exécute de fonctionner correctement.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-115">The verification process determines whether the code can attempt to access invalid memory addresses or perform some other action that could cause the process in which it is running to fail to operate properly.</span></span> <span data-ttu-id="6d5d6-116">Le code qui réussit le test de vérification est considéré comme étant de type sécurisé.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-116">Code that passes the verification test is said to be type-safe.</span></span> <span data-ttu-id="6d5d6-117">La capacité à vérifier si le code est de type sécurisé permet au Common Language Runtime d'assurer un niveau d'isolation aussi élevé que celui de la limite de processus, à un coût de performances beaucoup plus réduit.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-117">The ability to verify code as type-safe enables the common language runtime to provide as great a level of isolation as the process boundary, at a much lower performance cost.</span></span>  
  
 <span data-ttu-id="6d5d6-118">Les domaines d'application fournissent une unité de traitement davantage sécurisée et polyvalente que le Common Language Runtime peut utiliser pour assurer l'isolation entre les applications.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-118">Application domains provide a more secure and versatile unit of processing that the common language runtime can use to provide isolation between applications.</span></span> <span data-ttu-id="6d5d6-119">Vous pouvez exécuter plusieurs domaines d'application dans un seul processus avec le même niveau d'isolation que dans des processus distincts, mais sans risquer une surcharge mémoire en établissant des appels interprocessus ou en passant d'un processus à un autre.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-119">You can run several application domains in a single process with the same level of isolation that would exist in separate processes, but without incurring the additional overhead of making cross-process calls or switching between processes.</span></span> <span data-ttu-id="6d5d6-120">La capacité à exécuter plusieurs applications dans un seul processus optimise considérablement l'extensibilité du serveur.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-120">The ability to run multiple applications within a single process dramatically increases server scalability.</span></span>  
  
 <span data-ttu-id="6d5d6-121">L'isolation des applications est également importante pour la sécurité des applications.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-121">Isolating applications is also important for application security.</span></span> <span data-ttu-id="6d5d6-122">Par exemple, vous pouvez exécuter des contrôles à partir de plusieurs applications Web dans un seul processus de navigateur, de telle sorte que les contrôles ne puissent pas accéder à leurs données et à leurs ressources respectives.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-122">For example, you can run controls from several Web applications in a single browser process in such a way that the controls cannot access each other's data and resources.</span></span>  
  
 <span data-ttu-id="6d5d6-123">L'isolation assurée par les domaines d'application présente les avantages suivants :</span><span class="sxs-lookup"><span data-stu-id="6d5d6-123">The isolation provided by application domains has the following benefits:</span></span>  
  
- <span data-ttu-id="6d5d6-124">Les erreurs survenues dans une application ne peuvent pas affecter d'autres applications.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-124">Faults in one application cannot affect other applications.</span></span> <span data-ttu-id="6d5d6-125">Comme le code de type sécurisé ne risque pas de provoquer d'erreurs dans la mémoire, l'utilisation de domaines d'application permet d'empêcher le code en cours d'exécution dans un domaine d'affecter d'autres applications dans le processus.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-125">Because type-safe code cannot cause memory faults, using application domains ensures that code running in one domain cannot affect other applications in the process.</span></span>  
  
- <span data-ttu-id="6d5d6-126">Des applications individuelles peuvent être arrêtées sans que le processus entier soit arrêté.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-126">Individual applications can be stopped without stopping the entire process.</span></span> <span data-ttu-id="6d5d6-127">L'utilisation des domaines d'application vous permet de décharger le code en cours d'exécution dans une seule application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-127">Using application domains enables you to unload the code running in a single application.</span></span>  
  
    > [!NOTE]
    > <span data-ttu-id="6d5d6-128">Vous ne pouvez pas décharger des assemblys ou des types individuels.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-128">You cannot unload individual assemblies or types.</span></span> <span data-ttu-id="6d5d6-129">Seul un domaine complet peut être déchargé.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-129">Only a complete domain can be unloaded.</span></span>  
  
- <span data-ttu-id="6d5d6-130">Le code en cours d'exécution dans une application ne peut pas directement accéder au code ou aux ressources d'une autre application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-130">Code running in one application cannot directly access code or resources from another application.</span></span> <span data-ttu-id="6d5d6-131">Le Common Language Runtime applique cette isolation en empêchant les appels directs entre les objets dans les différents domaines d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-131">The common language runtime enforces this isolation by preventing direct calls between objects in different application domains.</span></span> <span data-ttu-id="6d5d6-132">Les objets qui passent d'un domaine à un autre sont soit copiés, soit accédés par un proxy.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-132">Objects that pass between domains are either copied or accessed by proxy.</span></span> <span data-ttu-id="6d5d6-133">Si l'objet est copié, l'appel à cet objet est alors local.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-133">If the object is copied, the call to the object is local.</span></span> <span data-ttu-id="6d5d6-134">Dans ce cas, l'appelant et l'objet référencé figurent dans le même domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-134">That is, both the caller and the object being referenced are in the same application domain.</span></span> <span data-ttu-id="6d5d6-135">Si l'objet est accédé par un proxy, l'appel à cet objet est alors distant.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-135">If the object is accessed through a proxy, the call to the object is remote.</span></span> <span data-ttu-id="6d5d6-136">Dans ce cas, l'appelant et l'objet référencé figurent dans des domaines d'application différents.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-136">In this case, the caller and the object being referenced are in different application domains.</span></span> <span data-ttu-id="6d5d6-137">Les appels interdomaines utilisent la même infrastructure d'appel distant que les appels entre deux processus ou deux ordinateurs.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-137">Cross-domain calls use the same remote call infrastructure as calls between two processes or between two machines.</span></span> <span data-ttu-id="6d5d6-138">Les métadonnées de l'objet référencé doivent par conséquent être disponibles pour les deux domaines d'application pour que l'appel de méthode puisse faire l'objet d'une compilation JIT correcte.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-138">As such, the metadata for the object being referenced must be available to both application domains to allow the method call to be JIT-compiled properly.</span></span> <span data-ttu-id="6d5d6-139">Si le domaine appelant n’a pas accès aux métadonnées pour l’objet qui est appelé, la compilation peut échouer avec une exception de type <xref:System.IO.FileNotFoundException>.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-139">If the calling domain does not have access to the metadata for the object being called, the compilation might fail with an exception of type <xref:System.IO.FileNotFoundException>.</span></span> <span data-ttu-id="6d5d6-140">Pour plus d'informations, consultez [Remote Objects](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/72x4h507(v=vs.100)).</span><span class="sxs-lookup"><span data-stu-id="6d5d6-140">For more information, see [Remote Objects](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/72x4h507(v=vs.100)).</span></span> <span data-ttu-id="6d5d6-141">Le mécanisme permettant de déterminer le mode d'accès des objets sur les domaines est défini par l'objet.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-141">The mechanism for determining how objects can be accessed across domains is determined by the object.</span></span> <span data-ttu-id="6d5d6-142">Pour plus d’informations, consultez <xref:System.MarshalByRefObject?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-142">For more information, see <xref:System.MarshalByRefObject?displayProperty=nameWithType>.</span></span>  
  
- <span data-ttu-id="6d5d6-143">La portée du comportement de code est définie par l'application dans laquelle il s'exécute.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-143">The behavior of code is scoped by the application in which it runs.</span></span> <span data-ttu-id="6d5d6-144">En d'autres termes, le domaine d'application fournit des paramètres de configuration tels que les stratégies de version d'application, l'emplacement des assemblys distants auxquels il accède et des informations sur l'emplacement où se trouvent les assemblys qui sont chargés dans le domaine.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-144">In other words, the application domain provides configuration settings such as application version policies, the location of any remote assemblies it accesses, and information about where to locate assemblies that are loaded into the domain.</span></span>  
  
- <span data-ttu-id="6d5d6-145">Les autorisations accordées au code peuvent être contrôlées par le domaine d'application dans lequel le code s'exécute.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-145">Permissions granted to code can be controlled by the application domain in which the code is running.</span></span>  
  
## <a name="application-domains-and-assemblies"></a><span data-ttu-id="6d5d6-146">Domaines d’application et assemblys</span><span class="sxs-lookup"><span data-stu-id="6d5d6-146">Application domains and assemblies</span></span>

 <span data-ttu-id="6d5d6-147">Cette section décrit la relation entre les domaines d'application et les assemblys.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-147">This section describes the relationship between application domains and assemblies.</span></span> <span data-ttu-id="6d5d6-148">Vous devez charger un assembly dans un domaine d'application avant de pouvoir exécuter le code qu'il contient.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-148">You must load an assembly into an application domain before you can execute the code it contains.</span></span> <span data-ttu-id="6d5d6-149">L'exécution d'une application standard entraîne le chargement de plusieurs assemblys dans un domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-149">Running a typical application causes several assemblies to be loaded into an application domain.</span></span>  
  
 <span data-ttu-id="6d5d6-150">La façon dont un assembly est chargé détermine si son code compilé juste-à-temps (JIT) peut être partagé par plusieurs domaines d'application dans le processus, et si l'assembly peut être déchargé du processus.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-150">The way an assembly is loaded determines whether its just-in-time (JIT) compiled code can be shared by multiple application domains in the process, and whether the assembly can be unloaded from the process.</span></span>  
  
- <span data-ttu-id="6d5d6-151">Si un assembly est chargé comme indépendant du domaine, tous les domaines d'application qui partagent le même jeu d'autorisations de sécurité peuvent partager le même code compilé juste-à-temps, ce qui réduit la mémoire requise par l'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-151">If an assembly is loaded domain-neutral, all application domains that share the same security grant set can share the same JIT-compiled code, which reduces the memory required by the application.</span></span> <span data-ttu-id="6d5d6-152">Toutefois, l'assembly ne peut jamais être déchargé du processus.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-152">However, the assembly can never be unloaded from the process.</span></span>  
  
- <span data-ttu-id="6d5d6-153">Si un assembly n'est pas chargé comme indépendant du domaine, il doit être compilé juste-à-temps dans chaque domaine d'application dans lequel il est chargé.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-153">If an assembly is not loaded domain-neutral, it must be JIT-compiled in every application domain in which it is loaded.</span></span> <span data-ttu-id="6d5d6-154">Toutefois, l'assembly peut être déchargé du processus via le déchargement de tous les domaines d'application dans lesquels il est chargé.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-154">However, the assembly can be unloaded from the process by unloading all the application domains in which it is loaded.</span></span>  
  
 <span data-ttu-id="6d5d6-155">L'hôte de runtime détermine s'il convient de charger des assemblys comme indépendants du domaine lorsqu'il charge le runtime dans un processus.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-155">The runtime host determines whether to load assemblies as domain-neutral when it loads the runtime into a process.</span></span> <span data-ttu-id="6d5d6-156">Pour les applications managées, appliquez l'attribut <xref:System.LoaderOptimizationAttribute> à la méthode de point d'entrée pour le processus et spécifiez une valeur de l'énumération <xref:System.LoaderOptimization> associée.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-156">For managed applications, apply the <xref:System.LoaderOptimizationAttribute> attribute to the entry-point method for the process, and specify a value from the associated <xref:System.LoaderOptimization> enumeration.</span></span> <span data-ttu-id="6d5d6-157">Pour les applications non managées qui hébergent le Common Language Runtime, spécifiez l’indicateur approprié quand vous appelez la méthode [Fonction CorBindToRuntimeEx](../unmanaged-api/hosting/corbindtoruntimeex-function.md).</span><span class="sxs-lookup"><span data-stu-id="6d5d6-157">For unmanaged applications that host the common language runtime, specify the appropriate flag when you call the [CorBindToRuntimeEx Function](../unmanaged-api/hosting/corbindtoruntimeex-function.md) method.</span></span>  
  
 <span data-ttu-id="6d5d6-158">Il existe trois options de chargement des assemblys indépendants du domaine :</span><span class="sxs-lookup"><span data-stu-id="6d5d6-158">There are three options for loading domain-neutral assemblies:</span></span>  
  
- <span data-ttu-id="6d5d6-159"><xref:System.LoaderOptimization.SingleDomain?displayProperty=nameWithType> ne charge aucun assembly comme indépendant du domaine, sauf Mscorlib, qui est toujours chargé comme indépendant du domaine.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-159"><xref:System.LoaderOptimization.SingleDomain?displayProperty=nameWithType> loads no assemblies as domain-neutral, except Mscorlib, which is always loaded domain-neutral.</span></span> <span data-ttu-id="6d5d6-160">Ce paramètre est désigné par « domaine unique », car il est fréquemment utilisé lorsque l'hôte n'exécute qu'une seule application dans le processus.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-160">This setting is called single domain because it is commonly used when the host is running only a single application in the process.</span></span>

- <span data-ttu-id="6d5d6-161"><xref:System.LoaderOptimization.MultiDomain?displayProperty=nameWithType> charge tous les assemblys comme indépendants du domaine.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-161"><xref:System.LoaderOptimization.MultiDomain?displayProperty=nameWithType> loads all assemblies as domain-neutral.</span></span> <span data-ttu-id="6d5d6-162">Utilisez ce paramètre lorsque plusieurs domaines d'application figurent dans le processus et qu'ils exécutent tous le même code.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-162">Use this setting when there are multiple application domains in the process, all of which run the same code.</span></span>

- <span data-ttu-id="6d5d6-163"><xref:System.LoaderOptimization.MultiDomainHost?displayProperty=nameWithType> charge les assemblys avec nom fort comme indépendants du domaine s'ils ont été installés, ainsi que toutes leurs dépendances, dans le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-163"><xref:System.LoaderOptimization.MultiDomainHost?displayProperty=nameWithType> loads strong-named assemblies as domain-neutral, if they and all their dependencies have been installed in the global assembly cache.</span></span> <span data-ttu-id="6d5d6-164">Les autres assemblys sont chargés et compilés juste-à-temps séparément pour chaque domaine d'application dans lequel ils sont chargés, et peuvent donc être déchargés du processus.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-164">Other assemblies are loaded and JIT-compiled separately for each application domain in which they are loaded, and thus can be unloaded from the process.</span></span> <span data-ttu-id="6d5d6-165">Utilisez ce paramètre lors de l'exécution de plusieurs applications dans le même processus, ou si vous disposez d'un mélange d'assemblys partagés par de nombreux domaines d'application et d'assemblys qui doivent être déchargés du processus.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-165">Use this setting when running more than one application in the same process, or if you have a mixture of assemblies that are shared by many application domains and assemblies that need to be unloaded from the process.</span></span>
  
 <span data-ttu-id="6d5d6-166">Le code compilé juste-à-temps ne peut pas être partagé pour les assemblys chargés dans le contexte de chargement, à l'aide de la méthode <xref:System.Reflection.Assembly.LoadFrom%2A> de la classe <xref:System.Reflection.Assembly>, ou chargés à partir d'images à l'aide de surcharges de la méthode <xref:System.Reflection.Assembly.Load%2A> qui spécifient des tableaux d'octets.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-166">JIT-compiled code cannot be shared for assemblies loaded into the load-from context, using the <xref:System.Reflection.Assembly.LoadFrom%2A> method of the <xref:System.Reflection.Assembly> class, or loaded from images using overloads of the <xref:System.Reflection.Assembly.Load%2A> method that specify byte arrays.</span></span>  
  
 <span data-ttu-id="6d5d6-167">Les assemblys, compilés en code natif à l’aide de [Ngen.exe (le générateur d’images natives)](../tools/ngen-exe-native-image-generator.md), peuvent être partagés entre des domaines d’application s’ils sont chargés comme indépendants du domaine lors de leur premier chargement dans un processus.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-167">Assemblies that have been compiled to native code by using the [Ngen.exe (Native Image Generator)](../tools/ngen-exe-native-image-generator.md) can be shared between application domains, if they are loaded domain-neutral the first time they are loaded into a process.</span></span>  
  
 <span data-ttu-id="6d5d6-168">Le code compilé juste-à-temps pour l'assembly contenant le point d'entrée de l'application est partagé uniquement si toutes ses dépendances peuvent être partagées.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-168">JIT-compiled code for the assembly that contains the application entry point is shared only if all its dependencies can be shared.</span></span>  
  
 <span data-ttu-id="6d5d6-169">Un assembly indépendant du domaine peut être compilé juste-à-temps plusieurs fois.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-169">A domain-neutral assembly can be JIT-compiled more than once.</span></span> <span data-ttu-id="6d5d6-170">Par exemple, lorsque les jeux d'autorisations de sécurité de deux domaines d'application sont différents, ils ne peuvent pas partager le même code compilé juste-à-temps.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-170">For example, when the security grant sets of two application domains are different, they cannot share the same JIT-compiled code.</span></span> <span data-ttu-id="6d5d6-171">Toutefois, chaque copie de l'assembly compilé juste-à-temps peut être partagée avec d'autres domaines d'application disposant du même jeu d'autorisations.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-171">However, each copy of the JIT-compiled assembly can be shared with other application domains that have the same grant set.</span></span>  
  
 <span data-ttu-id="6d5d6-172">Lorsque vous décidez de charger des assemblys comme indépendants du domaine, vous devez trouver un compromis entre la réduction de l'utilisation de la mémoire et d'autres facteurs de performances.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-172">When you decide whether to load assemblies as domain-neutral, you must make a tradeoff between reducing memory use and other performance factors.</span></span>  
  
- <span data-ttu-id="6d5d6-173">L'accès aux données et méthodes statiques est plus lent pour les assemblys indépendants du domaine en raison de la nécessité d'assurer l'isolation des assemblys.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-173">Access to static data and methods is slower for domain-neutral assemblies because of the need to isolate assemblies.</span></span> <span data-ttu-id="6d5d6-174">Chaque domaine d'application qui accède à l'assembly doit disposer d'une copie distincte des données statiques, afin d'éviter que des références à des objets dans les champs statiques ne franchissent les limites de domaine.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-174">Each application domain that accesses the assembly must have a separate copy of the static data, to prevent references to objects in static fields from crossing domain boundaries.</span></span> <span data-ttu-id="6d5d6-175">Le runtime contient par conséquent une logique supplémentaire pour orienter un appelant vers la copie appropriée des données statiques ou de la méthode statique.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-175">As a result, the runtime contains additional logic to direct a caller to the appropriate copy of the static data or method.</span></span> <span data-ttu-id="6d5d6-176">Cette logique supplémentaire ralentit l'appel.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-176">This extra logic slows down the call.</span></span>  
  
- <span data-ttu-id="6d5d6-177">Toutes les dépendances d'un assembly doivent être localisées et chargées lorsque l'assembly est chargé comme indépendant du domaine, car une dépendance qui ne peut pas être chargée comme indépendante du domaine empêche le chargement de l'assembly comme indépendant du domaine.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-177">All the dependencies of an assembly must be located and loaded when the assembly is loaded domain-neutral, because a dependency that cannot be loaded domain-neutral prevents the assembly from being loaded domain-neutral.</span></span>  
  
## <a name="application-domains-and-threads"></a><span data-ttu-id="6d5d6-178">Domaines d'application et threads</span><span class="sxs-lookup"><span data-stu-id="6d5d6-178">Application domains and threads</span></span>

 <span data-ttu-id="6d5d6-179">Un domaine d'application forme une limite d'isolation pour la sécurité, le suivi des versions, la fiabilité et le déchargement de code managé.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-179">An application domain forms an isolation boundary for security, versioning, reliability, and unloading of managed code.</span></span> <span data-ttu-id="6d5d6-180">Un thread constitue la construction du système d'exploitation utilisée par le Common Language Runtime pour exécuter le code.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-180">A thread is the operating system construct used by the common language runtime to execute code.</span></span> <span data-ttu-id="6d5d6-181">Au moment de l'exécution, l'ensemble du code managé est chargé dans un domaine d'application et exécuté par un ou plusieurs threads managés.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-181">At run time, all managed code is loaded into an application domain and is run by one or more managed threads.</span></span>  
  
 <span data-ttu-id="6d5d6-182">Il n'existe pas de corrélation un-à-un entre les domaines d'application et les threads.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-182">There is not a one-to-one correlation between application domains and threads.</span></span> <span data-ttu-id="6d5d6-183">Plusieurs threads peuvent s'exécuter dans un seul domaine d'application à tout moment donné et un thread particulier n'est pas limité à un seul domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-183">Several threads can execute in a single application domain at any given time, and a particular thread is not confined to a single application domain.</span></span> <span data-ttu-id="6d5d6-184">En d'autres termes, les threads sont libres de franchir les limites de domaine d'application et un nouveau n'est pas créé pour chaque domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-184">That is, threads are free to cross application domain boundaries; a new thread is not created for each application domain.</span></span>  
  
 <span data-ttu-id="6d5d6-185">À tout moment donné, chaque thread s'exécute dans un domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-185">At any given time, every thread executes in an application domain.</span></span> <span data-ttu-id="6d5d6-186">Aucun, un ou plusieurs threads peuvent s'exécuter dans n'importe quel domaine d'application donné.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-186">Zero, one, or multiple threads might be executing in any given application domain.</span></span> <span data-ttu-id="6d5d6-187">Le runtime assure le suivi des threads s'exécutant dans les domaines d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-187">The runtime keeps track of which threads are running in which application domains.</span></span> <span data-ttu-id="6d5d6-188">Vous pouvez rechercher le domaine dans lequel un thread s'exécute à tout moment en appelant la méthode <xref:System.Threading.Thread.GetDomain%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-188">You can locate the domain in which a thread is executing at any time by calling the <xref:System.Threading.Thread.GetDomain%2A?displayProperty=nameWithType> method.</span></span>

### <a name="application-domains-and-cultures"></a><span data-ttu-id="6d5d6-189">Domaines d'application et cultures</span><span class="sxs-lookup"><span data-stu-id="6d5d6-189">Application domains and cultures</span></span>

 <span data-ttu-id="6d5d6-190">La culture, représentée par un objet <xref:System.Globalization.CultureInfo>, est associée aux threads.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-190">Culture, which is represented by a <xref:System.Globalization.CultureInfo> object, is associated with threads.</span></span> <span data-ttu-id="6d5d6-191">Vous pouvez obtenir la culture associée au thread en cours d'exécution à l'aide de la propriété <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> et vous pouvez obtenir ou définir la culture associée au thread en cours d'exécution à l'aide de la propriété <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-191">You can get the culture that is associated with the currently executing thread by using the <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> property, and you can get or set the culture that is associated with the currently executing thread by using the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="6d5d6-192">Si la culture associée à un thread a été définie explicitement à l'aide de la propriété <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType>, elle continue d'être associée à ce thread lorsque le thread traverse les limites du domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-192">If the culture that is associated with a thread has been explicitly set by using the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> property, it continues to be associated with that thread when the thread crosses application domain boundaries.</span></span> <span data-ttu-id="6d5d6-193">Sinon, la culture associée au thread à un moment donné est déterminée par la valeur de la propriété <xref:System.Globalization.CultureInfo.DefaultThreadCurrentCulture%2A?displayProperty=nameWithType> dans le domaine d'application dans lequel le thread s'exécute :</span><span class="sxs-lookup"><span data-stu-id="6d5d6-193">Otherwise, the culture that is associated with the thread at any given time is determined by the value of the <xref:System.Globalization.CultureInfo.DefaultThreadCurrentCulture%2A?displayProperty=nameWithType> property in the application domain in which the thread is executing:</span></span>  
  
- <span data-ttu-id="6d5d6-194">Si la valeur de la propriété n'est pas `null`, la culture retournée par la propriété est associée au thread (et, par conséquent, retournée par les propriétés <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> et <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType>).</span><span class="sxs-lookup"><span data-stu-id="6d5d6-194">If the value of the property is not `null`, the culture that is returned by the property is associated with the thread (and therefore returned by the <xref:System.Threading.Thread.CurrentCulture%2A?displayProperty=nameWithType> and <xref:System.Globalization.CultureInfo.CurrentCulture%2A?displayProperty=nameWithType> properties).</span></span>  
  
- <span data-ttu-id="6d5d6-195">Si la valeur de la propriété est `null`, la culture système en cours est associée au thread.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-195">If the value of the property is `null`, the current system culture is associated with the thread.</span></span>  
  
## <a name="programming-with-application-domains"></a><span data-ttu-id="6d5d6-196">Programmation avec des domaines d’application</span><span class="sxs-lookup"><span data-stu-id="6d5d6-196">Programming with application domains</span></span>

 <span data-ttu-id="6d5d6-197">Les domaines d'application sont généralement créés et manipulés par programme par des hôtes de runtime.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-197">Application domains are usually created and manipulated programmatically by runtime hosts.</span></span> <span data-ttu-id="6d5d6-198">Toutefois, un programme d'application peut parfois souhaiter travailler également avec des domaines d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-198">However, sometimes an application program might also want to work with application domains.</span></span> <span data-ttu-id="6d5d6-199">Par exemple, un programme d'application pourrait charger un composant d'application dans un domaine pour pouvoir décharger le domaine (et le composant) sans devoir arrêter l'application entière.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-199">For example, an application program could load an application component into a domain to be able to unload the domain (and the component) without having to stop the entire application.</span></span>  
  
 <span data-ttu-id="6d5d6-200">La classe <xref:System.AppDomain> est l’interface de programmation des domaines d’application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-200">The <xref:System.AppDomain> is the programmatic interface to application domains.</span></span> <span data-ttu-id="6d5d6-201">Cette classe inclut des méthodes permettant de créer et de décharger des domaines, de créer des instances de types dans des domaines et de s'inscrire pour différentes notifications telles que le déchargement du domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-201">This class includes methods to create and unload domains, to create instances of types in domains, and to register for various notifications such as application domain unloading.</span></span> <span data-ttu-id="6d5d6-202">Le tableau suivant répertorie les méthodes <xref:System.AppDomain> fréquemment utilisées.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-202">The following table lists commonly used <xref:System.AppDomain> methods.</span></span>  
  
|<span data-ttu-id="6d5d6-203">Méthode AppDomain</span><span class="sxs-lookup"><span data-stu-id="6d5d6-203">AppDomain Method</span></span>|<span data-ttu-id="6d5d6-204">Description</span><span class="sxs-lookup"><span data-stu-id="6d5d6-204">Description</span></span>|  
|----------------------|-----------------|  
|<xref:System.AppDomain.CreateDomain%2A>|<span data-ttu-id="6d5d6-205">Crée un nouveau domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-205">Creates a new application domain.</span></span> <span data-ttu-id="6d5d6-206">Il est recommandé d'utiliser une surcharge de cette méthode qui spécifie un objet <xref:System.AppDomainSetup>.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-206">It is recommended that you use an overload of this method that specifies an <xref:System.AppDomainSetup> object.</span></span> <span data-ttu-id="6d5d6-207">C’est la manière recommandée pour définir les propriétés d’un nouveau domaine, à savoir la base de l’application ou le répertoire racine pour l’application, l’emplacement du fichier de configuration pour le domaine et le chemin de recherche utilisé par le Common Language Runtime pour charger les assemblys dans le domaine.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-207">This is the preferred way to set the properties of a new domain, such as the application base, or root directory for the application; the location of the configuration file for the domain; and the search path that the common language runtime is to use to load assemblies into the domain.</span></span>|  
|<span data-ttu-id="6d5d6-208"><xref:System.AppDomain.ExecuteAssembly%2A> et <xref:System.AppDomain.ExecuteAssemblyByName%2A></span><span class="sxs-lookup"><span data-stu-id="6d5d6-208"><xref:System.AppDomain.ExecuteAssembly%2A> and <xref:System.AppDomain.ExecuteAssemblyByName%2A></span></span>|<span data-ttu-id="6d5d6-209">Exécute un assembly dans le domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-209">Executes an assembly in the application domain.</span></span> <span data-ttu-id="6d5d6-210">Il s'agit d'une méthode d'instance, qui peut donc être utilisée pour exécuter du code dans un autre domaine d'application pour lequel vous avez une référence.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-210">This is an instance method, so it can be used to execute code in another application domain to which you have a reference.</span></span>|  
|<xref:System.AppDomain.CreateInstanceAndUnwrap%2A>|<span data-ttu-id="6d5d6-211">Crée une instance du type spécifié dans le domaine d'application, et retourne un proxy.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-211">Creates an instance of a specified type in the application domain, and returns a proxy.</span></span> <span data-ttu-id="6d5d6-212">Utilisez cette méthode pour éviter de charger l'assembly qui contient le type créé dans l'assembly appelant.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-212">Use this method to avoid loading the assembly containing the created type into the calling assembly.</span></span>|  
|<xref:System.AppDomain.Unload%2A>|<span data-ttu-id="6d5d6-213">Effectue un arrêt approprié du domaine.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-213">Performs a graceful shutdown of the domain.</span></span> <span data-ttu-id="6d5d6-214">Le domaine d'application n'est pas déchargé tant que tous les threads en cours d'exécution dans le domaine ne sont pas arrêtés ou ne figurent plus dans le domaine.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-214">The application domain is not unloaded until all threads running in the domain have either stopped or are no longer in the domain.</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="6d5d6-215">Le Common Language Runtime ne prend pas en charge la sérialisation de méthodes globales ; les délégués ne peuvent donc pas être utilisés pour exécuter des méthodes globales dans d'autres domaines d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-215">The common language runtime does not support serialization of global methods, so delegates cannot be used to execute global methods in other application domains.</span></span>  
  
 <span data-ttu-id="6d5d6-216">Les interfaces non managées décrites dans la spécification sur les interfaces d'hébergement du Common Language Runtime permettent également d'accéder aux domaines d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-216">The unmanaged interfaces described in the common language runtime Hosting Interfaces Specification also provide access to application domains.</span></span> <span data-ttu-id="6d5d6-217">Les hôtes de runtime peuvent utiliser des interfaces à partir d'un code non managé pour créer des domaines d'application dans un processus et y accéder.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-217">Runtime hosts can use interfaces from unmanaged code to create and gain access to the application domains within a process.</span></span>  
  
## <a name="the-complus_loaderoptimization-environment-variable"></a><span data-ttu-id="6d5d6-218">La variable d'environnement COMPLUS_LoaderOptimization</span><span class="sxs-lookup"><span data-stu-id="6d5d6-218">The COMPLUS_LoaderOptimization environment variable</span></span>

 <span data-ttu-id="6d5d6-219">Variable d'environnement qui définit la stratégie d'optimisation de chargeur par défaut d'une application exécutable.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-219">An environment variable that sets the default loader optimization policy of an executable application.</span></span>  
  
### <a name="syntax"></a><span data-ttu-id="6d5d6-220">Syntaxe</span><span class="sxs-lookup"><span data-stu-id="6d5d6-220">Syntax</span></span>  
  
```env  
COMPLUS_LoaderOptimization = 1  
```  
  
### <a name="remarks"></a><span data-ttu-id="6d5d6-221">Notes </span><span class="sxs-lookup"><span data-stu-id="6d5d6-221">Remarks</span></span>

 <span data-ttu-id="6d5d6-222">Une application typique charge plusieurs assemblys dans un domaine d'application avant que le code qu'ils contiennent ne puisse être exécuté.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-222">A typical application loads several assemblies into an application domain before the code they contain can be executed.</span></span>  
  
 <span data-ttu-id="6d5d6-223">La façon dont l'assembly est chargé détermine si son code compilé juste-à-temps (JIT) peut être partagé par plusieurs domaines d'application dans le processus.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-223">The way the assembly is loaded determines whether its just-in-time (JIT) compiled code can be shared by multiple application domains in the process.</span></span>  
  
- <span data-ttu-id="6d5d6-224">Si un assembly est chargé indépendamment du domaine, tous les domaines d'application qui partagent le même jeu d'autorisations de sécurité peuvent partager le même code compilé juste-à-temps.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-224">If an assembly is loaded domain-neutral, all application domains that share the same security grant set can share the same JIT-compiled code.</span></span> <span data-ttu-id="6d5d6-225">Cela réduit la quantité de mémoire requise par l'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-225">This reduces the memory required by the application.</span></span>  
  
- <span data-ttu-id="6d5d6-226">Si un assembly n'est pas chargé indépendamment du domaine, il doit être compilé juste-à-temps dans chaque domaine d'application dans lequel il est chargé et le chargeur ne doit pas partager de ressources internes entre les domaines d'application.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-226">If an assembly is not loaded domain-neutral, it must be JIT-compiled in every application domain in which it is loaded and the loader must not share internal resources across application domains.</span></span>  
  
 <span data-ttu-id="6d5d6-227">Lorsqu'il est défini avec la valeur 1, l'indicateur d'environnement COMPLUS_LoaderOptimization force l'hôte du runtime à charger tous les assemblys d'une manière dépendante du domaine, connue sous le nom de SingleDomain.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-227">When set to 1, the COMPLUS_LoaderOptimization environment flag forces the runtime host to load all assemblies in non-domain-neutral way known as SingleDomain.</span></span> <span data-ttu-id="6d5d6-228">SingleDomain ne charge aucun assembly comme indépendant du domaine, sauf Mscorlib, qui est toujours chargé comme indépendant du domaine.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-228">SingleDomain loads no assemblies as domain-neutral, except Mscorlib, which is always loaded domain-neutral.</span></span> <span data-ttu-id="6d5d6-229">Ce paramètre est désigné par « domaine unique », car il est fréquemment utilisé lorsque l'hôte n'exécute qu'une seule application dans le processus.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-229">This setting is called single domain because it is commonly used when the host is running only a single application in the process.</span></span>  
  
> [!CAUTION]
> <span data-ttu-id="6d5d6-230">L'indicateur d'environnement COMPLUS_LoaderOptimization a été conçu pour être utilisé dans les scénarios de diagnostic et de test.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-230">The COMPLUS_LoaderOptimization environment flag was designed to be used in diagnostic and test scenarios.</span></span> <span data-ttu-id="6d5d6-231">L'activation de l'indicateur peut provoquer un net ralentissement et accroître l'utilisation de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-231">Having the flag turned on can cause severe slow-down and increase in memory usage.</span></span>  
  
### <a name="code-example"></a><span data-ttu-id="6d5d6-232">Exemple de code</span><span class="sxs-lookup"><span data-stu-id="6d5d6-232">Code example</span></span>

 <span data-ttu-id="6d5d6-233">Pour forcer tous les assemblys à ne pas se charger comme indépendants du domaine pour le service IISADMIN, ajoutez `COMPLUS_LoaderOptimization=1` à la chaîne de valeur multiple de l'environnement dans la clé HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN.</span><span class="sxs-lookup"><span data-stu-id="6d5d6-233">To force all assemblies not to be loaded as domain-neutral for the IISADMIN service can be achieved by appending `COMPLUS_LoaderOptimization=1` to the Environment’s Multi-String Value in the HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN key.</span></span>  
  
```env  
Key = HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\services\IISADMIN  
Name = Environment  
Type = REG_MULTI_SZ  
Value (to append) = COMPLUS_LoaderOptimization=1  
```  
  
## <a name="see-also"></a><span data-ttu-id="6d5d6-234">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6d5d6-234">See also</span></span>

- <xref:System.AppDomain?displayProperty=nameWithType>
- <xref:System.MarshalByRefObject?displayProperty=nameWithType>
- [<span data-ttu-id="6d5d6-235">Programmation à l'aide de domaines d'application et d'assemblys</span><span class="sxs-lookup"><span data-stu-id="6d5d6-235">Programming with Application Domains and Assemblies</span></span>](index.md)
- [<span data-ttu-id="6d5d6-236">Utilisation des domaines d’application</span><span class="sxs-lookup"><span data-stu-id="6d5d6-236">Using Application Domains</span></span>](use.md)

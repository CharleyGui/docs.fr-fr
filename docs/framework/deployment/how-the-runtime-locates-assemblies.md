---
title: Méthode de localisation des assemblys par le runtime
ms.date: 03/30/2017
helpviewer_keywords:
- app.config files, assembly locations
- deploying applications [.NET Framework], assembly locations
- application configuration files, locating assemblies
- .NET Framework application deployment, locating assemblies
- locating assemblies
- assemblies [.NET Framework], location
ms.assetid: 772ac6f4-64d2-4cfb-92fd-58096dcd6c34
author: mairaw
ms.author: mairaw
ms.openlocfilehash: 7be86a71ae4b3f873395c48750cc22c74d7ff983
ms.sourcegitcommit: 205b9a204742e9c77256d43ac9d94c3f82909808
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/10/2019
ms.locfileid: "70853989"
---
# <a name="how-the-runtime-locates-assemblies"></a><span data-ttu-id="6bc93-102">Méthode de localisation des assemblys par le runtime</span><span class="sxs-lookup"><span data-stu-id="6bc93-102">How the Runtime Locates Assemblies</span></span>

<span data-ttu-id="6bc93-103">Pour déployer correctement votre application .NET Framework, il est important de bien comprendre comment le common language runtime localise les assemblys qui composent votre application et comment il établit des liaisons à ces assemblys.</span><span class="sxs-lookup"><span data-stu-id="6bc93-103">To successfully deploy your .NET Framework application, you must understand how the common language runtime locates and binds to the assemblies that make up your application.</span></span> <span data-ttu-id="6bc93-104">Par défaut, le runtime essaie d'établir une liaison avec la version exacte d'un assembly avec lequel l'application a été générée.</span><span class="sxs-lookup"><span data-stu-id="6bc93-104">By default, the runtime attempts to bind with the exact version of an assembly that the application was built with.</span></span> <span data-ttu-id="6bc93-105">Ce comportement par défaut peut être substitué par les paramètres du fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="6bc93-105">This default behavior can be overridden by configuration file settings.</span></span>

<span data-ttu-id="6bc93-106">Le common language runtime effectue plusieurs étapes pour essayer de localiser un assembly et résoudre une référence d'assembly.</span><span class="sxs-lookup"><span data-stu-id="6bc93-106">The common language runtime performs a number of steps when attempting to locate an assembly and resolve an assembly reference.</span></span> <span data-ttu-id="6bc93-107">Chaque étape est expliquée dans les sections ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="6bc93-107">Each step is explained in the following sections.</span></span> <span data-ttu-id="6bc93-108">Le terme « détection » est souvent utilisé pour décrire la manière dont le runtime localise les assemblys. Il fait référence au jeu de paramètres heuristiques utilisé pour localiser l'assembly en fonction de son nom et de sa culture.</span><span class="sxs-lookup"><span data-stu-id="6bc93-108">The term probing is often used when describing how the runtime locates assemblies; it refers to the set of heuristics used to locate the assembly based on its name and culture.</span></span>

> [!NOTE]
> <span data-ttu-id="6bc93-109">Vous pouvez afficher les informations de liaison du fichier journal en utilisant la [visionneuse du journal de liaison d’assembly (Fuslogvw.exe)](../../../docs/framework/tools/fuslogvw-exe-assembly-binding-log-viewer.md), fournie dans le SDK Windows.</span><span class="sxs-lookup"><span data-stu-id="6bc93-109">You can view binding information in the log file using the [Assembly Binding Log Viewer (Fuslogvw.exe)](../../../docs/framework/tools/fuslogvw-exe-assembly-binding-log-viewer.md), which is included in the Windows SDK.</span></span>

## <a name="initiating-the-bind"></a><span data-ttu-id="6bc93-110">Initiation de la liaison</span><span class="sxs-lookup"><span data-stu-id="6bc93-110">Initiating the Bind</span></span>

<span data-ttu-id="6bc93-111">Le processus de localisation et de liaison d'un assembly débute quand le runtime tente de résoudre une référence à un autre assembly.</span><span class="sxs-lookup"><span data-stu-id="6bc93-111">The process of locating and binding to an assembly begins when the runtime attempts to resolve a reference to another assembly.</span></span> <span data-ttu-id="6bc93-112">Cette référence peut être statique ou dynamique.</span><span class="sxs-lookup"><span data-stu-id="6bc93-112">This reference can be either static or dynamic.</span></span> <span data-ttu-id="6bc93-113">Le compilateur enregistre les références statiques dans les métadonnées du manifeste d'assembly au moment de la build.</span><span class="sxs-lookup"><span data-stu-id="6bc93-113">The compiler records static references in the assembly manifest's metadata at build time.</span></span> <span data-ttu-id="6bc93-114">Les références dynamiques sont créées instantanément après l’appel à différentes méthodes, telles que <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6bc93-114">Dynamic references are constructed on the fly as a result of calling various methods, such as <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="6bc93-115">La meilleure façon de référencer un assembly est d'utiliser une référence complète, comprenant le nom de l'assembly, sa version, sa culture et son jeton de clé publique (le cas échéant).</span><span class="sxs-lookup"><span data-stu-id="6bc93-115">The preferred way to reference an assembly is to use a full reference, including the assembly name, version, culture, and public key token (if one exists).</span></span> <span data-ttu-id="6bc93-116">Le runtime se sert de ces informations pour localiser l'assembly, en suivant les étapes décrites plus loin dans cette section.</span><span class="sxs-lookup"><span data-stu-id="6bc93-116">The runtime uses this information to locate the assembly, following the steps described later in this section.</span></span> <span data-ttu-id="6bc93-117">Il utilise le même processus de résolution pour les références d'assemblys statiques et dynamiques.</span><span class="sxs-lookup"><span data-stu-id="6bc93-117">The runtime uses the same resolution process regardless of whether the reference is for a static or dynamic assembly.</span></span>

<span data-ttu-id="6bc93-118">Vous pouvez aussi créer une référence dynamique à un assembly en fournissant à la méthode d'appel seulement une partie des informations relatives à l'assembly, par exemple en spécifiant le nom de l'assembly uniquement.</span><span class="sxs-lookup"><span data-stu-id="6bc93-118">You can also make a dynamic reference to an assembly by providing the calling method with only partial information about the assembly, such as specifying only the assembly name.</span></span> <span data-ttu-id="6bc93-119">Dans ce cas, l'assembly n'est recherché que dans le répertoire de l'application et aucune autre vérification n'est effectuée.</span><span class="sxs-lookup"><span data-stu-id="6bc93-119">In this case, only the application directory is searched for the assembly, and no other checking occurs.</span></span> <span data-ttu-id="6bc93-120">Il est possible de créer une référence partielle à l’aide d’une des méthodes de chargement des assemblys, telle que <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> ou <xref:System.AppDomain.Load%2A?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="6bc93-120">You make a partial reference using any of the various methods for loading assemblies such as <xref:System.Reflection.Assembly.Load%2A?displayProperty=nameWithType> or <xref:System.AppDomain.Load%2A?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="6bc93-121">Pour finir, vous pouvez créer une référence dynamique en utilisant une méthode comme <xref:System.Reflection.Assembly.Load*?displayProperty=nameWithType> à laquelle vous fournissez seulement des informations partielles. Vous qualifiez ensuite la référence en définissant l’élément [\<qualifyAssembly>](../../../docs/framework/configure-apps/file-schema/runtime/qualifyassembly-element.md) dans le fichier de configuration de l’application.</span><span class="sxs-lookup"><span data-stu-id="6bc93-121">Finally, you can make a dynamic reference using a method such as <xref:System.Reflection.Assembly.Load*?displayProperty=nameWithType> and provide only partial information; you then qualify the reference using the [\<qualifyAssembly>](../../../docs/framework/configure-apps/file-schema/runtime/qualifyassembly-element.md) element in the application configuration file.</span></span> <span data-ttu-id="6bc93-122">Cet élément vous permet de fournir les informations de la référence complète (nom, version, culture et, le cas échéant, jeton de clé publique) dans le fichier de configuration de votre application plutôt que dans votre code.</span><span class="sxs-lookup"><span data-stu-id="6bc93-122">This element allows you to provide the full reference information (name, version, culture and, if applicable, the public key token) in your application configuration file instead of in your code.</span></span> <span data-ttu-id="6bc93-123">Utilisez cette technique si vous souhaitez créer une référence complète à un assembly en dehors du répertoire de l'application, ou si vous souhaitez référencer un assembly dans le Global Assembly Cache en gardant la possibilité de spécifier la référence complète dans le fichier de configuration plutôt que dans votre code.</span><span class="sxs-lookup"><span data-stu-id="6bc93-123">You would use this technique if you wanted to fully qualify a reference to an assembly outside the application directory, or if you wanted to reference an assembly in the global assembly cache but you wanted the convenience of specifying the full reference in the configuration file instead of in your code.</span></span>

> [!NOTE]
> <span data-ttu-id="6bc93-124">Ce type de référence partielle ne doit pas être utilisé avec des assemblys partagés par plusieurs applications.</span><span class="sxs-lookup"><span data-stu-id="6bc93-124">This type of partial reference should not be used with assemblies that are shared among several applications.</span></span> <span data-ttu-id="6bc93-125">Les paramètres de configuration sont appliqués au niveau de l'application, et non de chaque assembly. Par conséquent, un assembly partagé utilisant ce type de référence partielle nécessite que chaque application liée à l'assembly partagé possède les informations de qualification dans son fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="6bc93-125">Because configuration settings are applied per application and not per assembly, a shared assembly using this type of partial reference would require each application using the shared assembly to have the qualifying information in its configuration file.</span></span>

<span data-ttu-id="6bc93-126">Le runtime effectue les étapes suivantes pour résoudre une référence d'assembly :</span><span class="sxs-lookup"><span data-stu-id="6bc93-126">The runtime uses the following steps to resolve an assembly reference:</span></span>

1. <span data-ttu-id="6bc93-127">Il[détermine la version correcte de l'assembly](#step1) en examinant les fichiers de configuration applicables, y compris le fichier de configuration de l'application, le fichier de stratégie d'éditeur et le fichier de configuration de l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6bc93-127">[Determines the correct assembly version](#step1) by examining applicable configuration files, including the application configuration file, publisher policy file, and machine configuration file.</span></span> <span data-ttu-id="6bc93-128">Si le fichier de configuration est situé sur un ordinateur distant, le runtime doit tout d'abord localiser et télécharger le fichier de configuration de l'application.</span><span class="sxs-lookup"><span data-stu-id="6bc93-128">If the configuration file is located on a remote machine, the runtime must locate and download the application configuration file first.</span></span>

2. <span data-ttu-id="6bc93-129">Il[vérifie si le nom de l'assembly a déjà été lié](#step2) et, si c'est le cas, il utilise l'assembly précédemment chargé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-129">[Checks whether the assembly name has been bound to before](#step2) and, if so, uses the previously loaded assembly.</span></span> <span data-ttu-id="6bc93-130">Si une précédente demande de chargement de l'assembly avait échoué, la nouvelle demande échoue immédiatement sans qu'aucune tentative de chargement de l'assembly ne soit effectuée.</span><span class="sxs-lookup"><span data-stu-id="6bc93-130">If a previous request to load the assembly failed, the request is failed immediately without attempting to load the assembly.</span></span>

    > [!NOTE]
    > <span data-ttu-id="6bc93-131">La mise en cache des échecs de liaison d'assemblys a été introduite dans .NET Framework version 2.0.</span><span class="sxs-lookup"><span data-stu-id="6bc93-131">The caching of assembly binding failures is new in the .NET Framework version 2.0.</span></span>

3. <span data-ttu-id="6bc93-132">Il[vérifie le Global Assembly Cache](#step3).</span><span class="sxs-lookup"><span data-stu-id="6bc93-132">[Checks the global assembly cache](#step3).</span></span> <span data-ttu-id="6bc93-133">S'il y trouve l'assembly, il l'utilise.</span><span class="sxs-lookup"><span data-stu-id="6bc93-133">If the assembly is found there, the runtime uses this assembly.</span></span>

4. <span data-ttu-id="6bc93-134">Il[détecte l'assembly](#step4) en procédant comme suit :</span><span class="sxs-lookup"><span data-stu-id="6bc93-134">[Probes for the assembly](#step4) using the following steps:</span></span>

    1. <span data-ttu-id="6bc93-135">Si la configuration et la stratégie d'éditeur n'affectent pas la référence d'origine et que la demande de liaison a été faite avec la méthode <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> , le runtime vérifie la présence d'indications relatives à l'emplacement.</span><span class="sxs-lookup"><span data-stu-id="6bc93-135">If configuration and publisher policy do not affect the original reference and if the bind request was created using the <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> method, the runtime checks for location hints.</span></span>

    2. <span data-ttu-id="6bc93-136">Si une base de code est trouvée dans les fichiers de configuration, le runtime vérifie uniquement cet emplacement.</span><span class="sxs-lookup"><span data-stu-id="6bc93-136">If a codebase is found in the configuration files, the runtime checks only this location.</span></span> <span data-ttu-id="6bc93-137">Si cette détection ne donne aucun résultat, le runtime détermine que la demande de liaison a échoué et ne tente pas d'autre détection.</span><span class="sxs-lookup"><span data-stu-id="6bc93-137">If this probe fails, the runtime determines that the binding request failed and no other probing occurs.</span></span>

    3. <span data-ttu-id="6bc93-138">Il détecte l'assembly en se servant des paramètres heuristiques décrits dans la [section sur la détection](#step4).</span><span class="sxs-lookup"><span data-stu-id="6bc93-138">Probes for the assembly using the heuristics described in the [probing section](#step4).</span></span> <span data-ttu-id="6bc93-139">Si la détection ne permet pas de trouver l'assembly, le runtime demande à Windows Installer de lui fournir l'assembly</span><span class="sxs-lookup"><span data-stu-id="6bc93-139">If the assembly is not found after probing, the runtime requests the Windows Installer to provide the assembly.</span></span> <span data-ttu-id="6bc93-140">(sous la forme d'une fonctionnalité d'installation à la demande).</span><span class="sxs-lookup"><span data-stu-id="6bc93-140">This acts as an install-on-demand feature.</span></span>

        > [!NOTE]
        > <span data-ttu-id="6bc93-141">Pour les assemblys sans nom fort, le runtime n'effectue pas de vérification de version, ni de vérification dans le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="6bc93-141">There is no version checking for assemblies without strong names, nor does the runtime check in the global assembly cache for assemblies without strong names.</span></span>

<a name="step1"></a>

## <a name="step-1-examining-the-configuration-files"></a><span data-ttu-id="6bc93-142">Étape 1 : examen des fichiers de configuration</span><span class="sxs-lookup"><span data-stu-id="6bc93-142">Step 1: Examining the Configuration Files</span></span>

<span data-ttu-id="6bc93-143">Le comportement de la liaison d'assembly peut être configuré à différents niveaux à l'aide de ces trois fichiers XML :</span><span class="sxs-lookup"><span data-stu-id="6bc93-143">Assembly binding behavior can be configured at different levels based on three XML files:</span></span>

- <span data-ttu-id="6bc93-144">le fichier de configuration de l'application ;</span><span class="sxs-lookup"><span data-stu-id="6bc93-144">Application configuration file.</span></span>

- <span data-ttu-id="6bc93-145">le fichier de stratégie d'éditeur ;</span><span class="sxs-lookup"><span data-stu-id="6bc93-145">Publisher policy file.</span></span>

- <span data-ttu-id="6bc93-146">le fichier de configuration de l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6bc93-146">Machine configuration file.</span></span>

<span data-ttu-id="6bc93-147">Ces fichiers utilisent la même syntaxe. Ils fournissent plusieurs informations, notamment les redirections de liaisons, l'emplacement du code et les modes de liaison pour des assemblys particuliers.</span><span class="sxs-lookup"><span data-stu-id="6bc93-147">These files follow the same syntax and provide information such as binding redirects, the location of code, and binding modes for particular assemblies.</span></span> <span data-ttu-id="6bc93-148">Chaque fichier de configuration peut contenir un [élément \<assemblyBinding>](../../../docs/framework/configure-apps/file-schema/runtime/assemblybinding-element-for-runtime.md) qui redirige le processus de liaison.</span><span class="sxs-lookup"><span data-stu-id="6bc93-148">Each configuration file can contain an [\<assemblyBinding> element](../../../docs/framework/configure-apps/file-schema/runtime/assemblybinding-element-for-runtime.md) that redirects the binding process.</span></span> <span data-ttu-id="6bc93-149">Les éléments enfants de l’[élément \<assemblyBinding>](../../../docs/framework/configure-apps/file-schema/runtime/assemblybinding-element-for-runtime.md) incluent l’[élément \<dependentAssembly>](../../../docs/framework/configure-apps/file-schema/runtime/dependentassembly-element.md).</span><span class="sxs-lookup"><span data-stu-id="6bc93-149">The child elements of the [\<assemblyBinding> element](../../../docs/framework/configure-apps/file-schema/runtime/assemblybinding-element-for-runtime.md) include the [\<dependentAssembly> element](../../../docs/framework/configure-apps/file-schema/runtime/dependentassembly-element.md).</span></span> <span data-ttu-id="6bc93-150">Les éléments enfants de l’[élément \<dependentAssembly>](../../../docs/framework/configure-apps/file-schema/runtime/dependentassembly-element.md) incluent l’[élément \<assemblyIdentity>](/visualstudio/deployment/assemblyidentity-element-clickonce-deployment), l’[élément \<bindingRedirect>](../../../docs/framework/configure-apps/file-schema/runtime/bindingredirect-element.md) et l’[élément \<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md).</span><span class="sxs-lookup"><span data-stu-id="6bc93-150">The children of [\<dependentAssembly> element](../../../docs/framework/configure-apps/file-schema/runtime/dependentassembly-element.md) include the [\<assemblyIdentity> element](/visualstudio/deployment/assemblyidentity-element-clickonce-deployment), the [\<bindingRedirect> element](../../../docs/framework/configure-apps/file-schema/runtime/bindingredirect-element.md), and the [\<codeBase> element](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md).</span></span>

> [!NOTE]
> <span data-ttu-id="6bc93-151">Les trois fichiers de configuration peuvent contenir des informations de configuration, mais ils n'acceptent pas forcément tous les éléments.</span><span class="sxs-lookup"><span data-stu-id="6bc93-151">Configuration information can be found in the three configuration files; not all elements are valid in all configuration files.</span></span> <span data-ttu-id="6bc93-152">Par exemple, les informations sur le mode de liaison et le chemin d'accès privé peuvent seulement se trouver dans le fichier de configuration de l'application.</span><span class="sxs-lookup"><span data-stu-id="6bc93-152">For example, binding mode and private path information can only be in the application configuration file.</span></span> <span data-ttu-id="6bc93-153">Pour obtenir la liste complète des informations contenues dans chaque fichier, consultez [Configuration des applications à l'aide de fichiers de configuration](../../../docs/framework/configure-apps/index.md).</span><span class="sxs-lookup"><span data-stu-id="6bc93-153">For a complete list of the information that is contained in each file, see [Configuring Apps by Using Configuration Files](../../../docs/framework/configure-apps/index.md).</span></span>

### <a name="application-configuration-file"></a><span data-ttu-id="6bc93-154">Fichier de configuration de l'application</span><span class="sxs-lookup"><span data-stu-id="6bc93-154">Application Configuration File</span></span>

<span data-ttu-id="6bc93-155">Le common language runtime vérifie tout d'abord le fichier de configuration de l'application à la recherche d'informations qui substituent les informations de version stockées dans le manifeste de l'assembly appelant.</span><span class="sxs-lookup"><span data-stu-id="6bc93-155">First, the common language runtime checks the application configuration file for information that overrides the version information stored in the calling assembly's manifest.</span></span> <span data-ttu-id="6bc93-156">Le fichier de configuration de l'application peut être déployé avec une application, mais il n'est pas nécessaire à l'exécution de celle-ci.</span><span class="sxs-lookup"><span data-stu-id="6bc93-156">The application configuration file can be deployed with an application, but is not required for application execution.</span></span> <span data-ttu-id="6bc93-157">En règle générale, la récupération de ce fichier est quasi instantanée mais, si la base de l'application se trouve sur un ordinateur distant (dans le cas d'une application web basée sur Internet Explorer, par exemple), le fichier de configuration doit être téléchargé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-157">Usually the retrieval of this file is almost instantaneous, but in situations where the application base is on a remote computer, such as in an Internet Explorer Web-based scenario, the configuration file must be downloaded.</span></span>

<span data-ttu-id="6bc93-158">Pour les fichiers exécutables client, le fichier de configuration de l'application réside dans le même répertoire que le fichier exécutable de l'application et possède le même nom que le fichier exécutable avec une extension .config.</span><span class="sxs-lookup"><span data-stu-id="6bc93-158">For client executables, the application configuration file resides in the same directory as the application's executable and has the same base name as the executable with a .config extension.</span></span> <span data-ttu-id="6bc93-159">Par exemple, le fichier de configuration pour C:\Program Files\Myapp\Myapp.exe est C:\Program Files\Myapp\Myapp.exe.config. S’il s’agit d’une application basée sur un navigateur, le fichier HTML doit utiliser l’élément **\<link>** pour pointer explicitement vers le fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="6bc93-159">For example, the configuration file for C:\Program Files\Myapp\Myapp.exe is C:\Program Files\Myapp\Myapp.exe.config. In a browser-based scenario, the HTML file must use the **\<link>** element to explicitly point to the configuration file.</span></span>

<span data-ttu-id="6bc93-160">Le code suivant fournit un exemple simple de fichier de configuration de l'application.</span><span class="sxs-lookup"><span data-stu-id="6bc93-160">The following code provides a simple example of an application configuration file.</span></span> <span data-ttu-id="6bc93-161">Cet exemple ajoute un élément <xref:System.Diagnostics.TextWriterTraceListener> à la collection <xref:System.Diagnostics.Debug.Listeners%2A> pour activer l'enregistrement des informations de débogage dans un fichier.</span><span class="sxs-lookup"><span data-stu-id="6bc93-161">This example adds a <xref:System.Diagnostics.TextWriterTraceListener> to the <xref:System.Diagnostics.Debug.Listeners%2A> collection to enable recording debug information to a file.</span></span>

```xml
<configuration>
   <system.diagnostics>
      <trace useGlobalLock="false" autoflush="true" indentsize="0">
         <listeners>
            <add name="myListener" type="System.Diagnostics.TextWriterTraceListener, system version=1.0.3300.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" initializeData="c:\myListener.log" />
         </listeners>
      </trace>
   </system.diagnostics>
</configuration>
```

### <a name="publisher-policy-file"></a><span data-ttu-id="6bc93-162">Fichier de stratégie d'éditeur</span><span class="sxs-lookup"><span data-stu-id="6bc93-162">Publisher Policy File</span></span>

<span data-ttu-id="6bc93-163">Le runtime examine ensuite le fichier de stratégie d'éditeur (si ce fichier existe).</span><span class="sxs-lookup"><span data-stu-id="6bc93-163">Second, the runtime examines the publisher policy file, if one exists.</span></span> <span data-ttu-id="6bc93-164">Les fichiers de stratégie d'éditeur sont distribués par un éditeur de composant, sous forme de correctif ou de mise à jour, à un composant partagé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-164">Publisher policy files are distributed by a component publisher as a fix or update to a shared component.</span></span> <span data-ttu-id="6bc93-165">Ces fichiers contiennent des informations de compatibilité émises par l'éditeur du composant partagé qui dirige une référence d'assembly vers une nouvelle version.</span><span class="sxs-lookup"><span data-stu-id="6bc93-165">These files contain compatibility information issued by the publisher of the shared component that directs an assembly reference to a new version.</span></span> <span data-ttu-id="6bc93-166">Contrairement aux fichiers de configuration de l'application et de l'ordinateur, les fichiers de stratégie d'éditeur sont contenus dans leur propre assembly qui doit être installé dans le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="6bc93-166">Unlike application and machine configuration files, publisher policy files are contained in their own assembly that must be installed in the global assembly cache.</span></span>

<span data-ttu-id="6bc93-167">Voici un exemple de fichier de configuration de stratégie d'éditeur :</span><span class="sxs-lookup"><span data-stu-id="6bc93-167">The following is an example of a Publisher Policy configuration file:</span></span>

```xml
<configuration>
    <runtime>
        <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">

            <dependentAssembly>
                <assemblyIdentity name="asm6" publicKeyToken="c0305c36380ba429" />
                <bindingRedirect oldVersion="3.0.0.0" newVersion="2.0.0.0"/>
            </dependentAssembly>

        </assemblyBinding>
    </runtime>
</configuration>
```

<span data-ttu-id="6bc93-168">Pour créer un assembly, utilisez l’outil [Al.exe (Assembly Linker)](../../../docs/framework/tools/al-exe-assembly-linker.md) avec une commande telle que la suivante :</span><span class="sxs-lookup"><span data-stu-id="6bc93-168">To create an assembly, you can use the [Al.exe (Assembly Linker)](../../../docs/framework/tools/al-exe-assembly-linker.md) tool with a command such as the following:</span></span>

```console
Al.exe /link:asm6.exe.config /out:policy.3.0.asm6.dll /keyfile: compatkey.dat /v:3.0.0.0
```

<span data-ttu-id="6bc93-169">`compatkey.dat` est un fichier de clé de nom fort.</span><span class="sxs-lookup"><span data-stu-id="6bc93-169">`compatkey.dat` is a strong-name key file.</span></span> <span data-ttu-id="6bc93-170">Cette commande crée un assembly de nom fort que vous pouvez placer dans le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="6bc93-170">This command creates a strong-named assembly you can place in the global assembly cache.</span></span>

> [!NOTE]
> <span data-ttu-id="6bc93-171">La stratégie d'éditeur est appliquée à toutes les applications qui utilisent un composant partagé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-171">Publisher policy affects all applications that use a shared component.</span></span>

<span data-ttu-id="6bc93-172">Le fichier de configuration de la stratégie d'éditeur substitue les informations de version fournies par l'application (c'est-à-dire celles du manifeste de l'assembly ou du fichier de configuration de l'application).</span><span class="sxs-lookup"><span data-stu-id="6bc93-172">The publisher policy configuration file overrides version information that comes from the application (that is, from the assembly manifest or from the application configuration file).</span></span> <span data-ttu-id="6bc93-173">Si aucune instruction dans le fichier de configuration de l'application ne redirige la version qui est spécifiée dans le manifeste de l'assembly, le fichier de stratégie d'éditeur substitue cette version.</span><span class="sxs-lookup"><span data-stu-id="6bc93-173">If there is no statement in the application configuration file to redirect the version specified in the assembly manifest, the publisher policy file overrides the version specified in the assembly manifest.</span></span> <span data-ttu-id="6bc93-174">En revanche, si une instruction de redirection est indiquée dans le fichier de configuration de l'application, le fichier de stratégie d'éditeur substitue cette version et non celle qui est spécifiée dans le manifeste.</span><span class="sxs-lookup"><span data-stu-id="6bc93-174">However, if there is a redirecting statement in the application configuration file, publisher policy overrides that version rather than the one specified in the manifest.</span></span>

<span data-ttu-id="6bc93-175">Un fichier de stratégie d'éditeur est utilisé quand un composant partagé est mis à jour et que la nouvelle version de ce composant doit être utilisée par toutes les applications partageant le composant.</span><span class="sxs-lookup"><span data-stu-id="6bc93-175">A publisher policy file is used when a shared component is updated and the new version of the shared component should be picked up by all applications using that component.</span></span> <span data-ttu-id="6bc93-176">Les paramètres définis dans le fichier de stratégie d'éditeur substituent ceux du fichier de configuration de l'application, sauf si ce dernier applique le mode sans échec.</span><span class="sxs-lookup"><span data-stu-id="6bc93-176">The settings in the publisher policy file override settings in the application configuration file, unless the application configuration file enforces safe mode.</span></span>

#### <a name="safe-mode"></a><span data-ttu-id="6bc93-177">Mode sans échec</span><span class="sxs-lookup"><span data-stu-id="6bc93-177">Safe Mode</span></span>

<span data-ttu-id="6bc93-178">Les fichiers de stratégie d'éditeur sont généralement installés explicitement avec un Service Pack ou une mise à jour de programme.</span><span class="sxs-lookup"><span data-stu-id="6bc93-178">Publisher policy files are usually explicitly installed as part of a service pack or program update.</span></span> <span data-ttu-id="6bc93-179">En cas de problème avec le composant partagé mis à jour, vous pouvez ignorer les substitutions spécifiées dans le fichier de stratégie d'éditeur en utilisant le mode sans échec.</span><span class="sxs-lookup"><span data-stu-id="6bc93-179">If there is any problem with the upgraded shared component, you can ignore the overrides in the publisher policy file using safe mode.</span></span> <span data-ttu-id="6bc93-180">Le mode sans échec est déterminé par l’élément **\<publisherPolicy apply="yes**&#124;**no"/>** , situé uniquement dans le fichier de configuration d’application.</span><span class="sxs-lookup"><span data-stu-id="6bc93-180">Safe mode is determined by the **\<publisherPolicy apply="yes**&#124;**no"/>** element, located only in the application configuration file.</span></span> <span data-ttu-id="6bc93-181">Il spécifie si les informations de configuration du fichier de stratégie d'éditeur doivent être supprimées du processus de liaison.</span><span class="sxs-lookup"><span data-stu-id="6bc93-181">It specifies whether the publisher policy configuration information should be removed from the binding process.</span></span>

<span data-ttu-id="6bc93-182">Le mode sans échec peut être défini pour toute l'application ou pour des assemblys spécifiques.</span><span class="sxs-lookup"><span data-stu-id="6bc93-182">Safe mode can be set for the entire application or for selected assemblies.</span></span> <span data-ttu-id="6bc93-183">Autrement dit, vous pouvez désactiver la stratégie pour tous les assemblys qui composent votre application ou l'activer pour certains assemblys seulement.</span><span class="sxs-lookup"><span data-stu-id="6bc93-183">That is, you can turn off the policy for all assemblies that make up the application, or turn it on for some assemblies but not others.</span></span> <span data-ttu-id="6bc93-184">Pour appliquer sélectivement la stratégie d’éditeur aux assemblys qui composent une application, définissez l’élément **\<publisherPolicy apply\=no/>** et spécifiez les assemblys auxquels appliquer la stratégie à l’aide de l’élément \<**dependentAssembly**>.</span><span class="sxs-lookup"><span data-stu-id="6bc93-184">To selectively apply publisher policy to assemblies that make up an application, set **\<publisherPolicy apply\=no/>** and specify which assemblies you want to be affected using the \<**dependentAssembly**> element.</span></span> <span data-ttu-id="6bc93-185">Pour appliquer la stratégie d’éditeur à tous les assemblys composant l’application, définissez l’élément **\<publisherPolicy apply\=no/>** sans aucun élément d’assembly dépendant.</span><span class="sxs-lookup"><span data-stu-id="6bc93-185">To apply publisher policy to all assemblies that make up the application, set **\<publisherPolicy apply\=no/>** with no dependent assembly elements.</span></span> <span data-ttu-id="6bc93-186">Pour plus d'informations sur la configuration, consultez [Configuration des applications à l'aide de fichiers de configuration](../../../docs/framework/configure-apps/index.md).</span><span class="sxs-lookup"><span data-stu-id="6bc93-186">For more about configuration, see [Configuring Apps by using Configuration Files](../../../docs/framework/configure-apps/index.md).</span></span>

### <a name="machine-configuration-file"></a><span data-ttu-id="6bc93-187">Fichier de configuration de l'ordinateur</span><span class="sxs-lookup"><span data-stu-id="6bc93-187">Machine Configuration File</span></span>

<span data-ttu-id="6bc93-188">Finalement, le runtime examine le fichier de configuration de l'ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6bc93-188">Third, the runtime examines the machine configuration file.</span></span> <span data-ttu-id="6bc93-189">Ce fichier, intitulé Machine.config, réside sur l'ordinateur local dans le sous-répertoire Config du répertoire racine où le runtime est installé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-189">This file, called Machine.config, resides on the local computer in the Config subdirectory of the root directory where the runtime is installed.</span></span> <span data-ttu-id="6bc93-190">Il peut être utilisé par les administrateurs pour spécifier des restrictions de liaison d'assemblys qui sont propres à cet ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6bc93-190">This file can be used by administrators to specify assembly binding restrictions that are local to that computer.</span></span> <span data-ttu-id="6bc93-191">Les paramètres définis dans le fichier de configuration de l'ordinateur sont prioritaires par rapport aux autres paramètres de configuration. Cependant, cela ne signifie pas que tous les paramètres de configuration doivent être placés dans ce fichier.</span><span class="sxs-lookup"><span data-stu-id="6bc93-191">The settings in the machine configuration file take precedence over all other configuration settings; however, this does not mean that all configuration settings should be put in this file.</span></span> <span data-ttu-id="6bc93-192">La version déterminée par le fichier de stratégie d'administrateur est finale et ne peut pas être substituée.</span><span class="sxs-lookup"><span data-stu-id="6bc93-192">The version determined by the administrator policy file is final, and cannot be overridden.</span></span> <span data-ttu-id="6bc93-193">Les substitutions spécifiées dans le fichier Machine.config s'appliquent à toutes les applications.</span><span class="sxs-lookup"><span data-stu-id="6bc93-193">Overrides specified in the Machine.config file affect all applications.</span></span> <span data-ttu-id="6bc93-194">Pour plus d'informations sur les fichiers de configuration, consultez [Configuration des applications à l'aide de fichiers de configuration](../../../docs/framework/configure-apps/index.md).</span><span class="sxs-lookup"><span data-stu-id="6bc93-194">For more information about configuration files, see [Configuring Apps by using Configuration Files](../../../docs/framework/configure-apps/index.md).</span></span>

<a name="step2"></a>

## <a name="step-2-checking-for-previously-referenced-assemblies"></a><span data-ttu-id="6bc93-195">Étape 2 : rechercher les assemblys précédemment référencés</span><span class="sxs-lookup"><span data-stu-id="6bc93-195">Step 2: Checking for Previously Referenced Assemblies</span></span>

<span data-ttu-id="6bc93-196">Si l'assembly demandé a aussi été demandé lors d'appels précédents, le common language runtime utilise l'assembly qui est déjà chargé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-196">If the requested assembly has also been requested in previous calls, the common language runtime uses the assembly that is already loaded.</span></span> <span data-ttu-id="6bc93-197">Ceci peut avoir des implications au moment de l'attribution des noms des assemblys qui composent une application.</span><span class="sxs-lookup"><span data-stu-id="6bc93-197">This can have ramifications when naming assemblies that make up an application.</span></span> <span data-ttu-id="6bc93-198">Pour plus d'informations sur l'attribution des noms des assemblys, voir [Noms d'assemblys](../../../docs/framework/app-domains/assembly-names.md).</span><span class="sxs-lookup"><span data-stu-id="6bc93-198">For more information about naming assemblies, see [Assembly Names](../../../docs/framework/app-domains/assembly-names.md).</span></span>

<span data-ttu-id="6bc93-199">Si une précédente demande de chargement de l'assembly avait échoué, toute nouvelle demande échoue immédiatement sans qu'aucune tentative de chargement de l'assembly ne soit effectuée.</span><span class="sxs-lookup"><span data-stu-id="6bc93-199">If a previous request for the assembly failed, subsequent requests for the assembly are failed immediately without attempting to load the assembly.</span></span> <span data-ttu-id="6bc93-200">Depuis la version 2.0 du .NET Framework, les échecs de liaison d'assemblys sont mis en cache et les informations mises en cache sont utilisées pour déterminer s'il faut essayer de charger l'assembly.</span><span class="sxs-lookup"><span data-stu-id="6bc93-200">Starting with the .NET Framework version 2.0, assembly binding failures are cached, and the cached information is used to determine whether to attempt to load the assembly.</span></span>

> [!NOTE]
> <span data-ttu-id="6bc93-201">Pour rétablir le comportement des versions 1.0 et 1.1 du .NET Framework, où il n’y avait pas de mise en cache des échecs de liaison, ajoutez l’[élément \<disableCachingBindingFailures>](../../../docs/framework/configure-apps/file-schema/runtime/disablecachingbindingfailures-element.md) dans votre fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="6bc93-201">To revert to the behavior of the .NET Framework versions 1.0 and 1.1, which did not cache binding failures, include the [\<disableCachingBindingFailures> Element](../../../docs/framework/configure-apps/file-schema/runtime/disablecachingbindingfailures-element.md) in your configuration file.</span></span>

<a name="step3"></a>

## <a name="step-3-checking-the-global-assembly-cache"></a><span data-ttu-id="6bc93-202">Étape 3 : vérifier le Global Assembly Cache</span><span class="sxs-lookup"><span data-stu-id="6bc93-202">Step 3: Checking the Global Assembly Cache</span></span>

<span data-ttu-id="6bc93-203">Pour les assemblys avec un nom fort, le processus de liaison examine ensuite le Global Assembly Cache.</span><span class="sxs-lookup"><span data-stu-id="6bc93-203">For strong-named assemblies, the binding process continues by looking in the global assembly cache.</span></span> <span data-ttu-id="6bc93-204">Le Global Assembly Cache stocke des assemblys qui peuvent être utilisés par plusieurs applications sur un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6bc93-204">The global assembly cache stores assemblies that can be used by several applications on a computer.</span></span> <span data-ttu-id="6bc93-205">Tous les assemblys figurant dans le Global Assembly Cache doivent avoir un nom fort.</span><span class="sxs-lookup"><span data-stu-id="6bc93-205">All assemblies in the global assembly cache must have strong names.</span></span>

<a name="step4"></a>

## <a name="step-4-locating-the-assembly-through-codebases-or-probing"></a><span data-ttu-id="6bc93-206">Étape 4 : localisation de l’assembly par le biais des bases de code ou de la détection</span><span class="sxs-lookup"><span data-stu-id="6bc93-206">Step 4: Locating the Assembly through Codebases or Probing</span></span>

<span data-ttu-id="6bc93-207">Une fois que la version correcte de l'assembly a été déterminée d'après les informations contenues dans la référence de l'assembly appelant et dans les fichiers de configuration, et après la vérification du Global Assembly Cache (uniquement pour les assemblys avec un nom fort), le common language runtime tente de trouver l'assembly.</span><span class="sxs-lookup"><span data-stu-id="6bc93-207">After the correct assembly version has been determined by using the information in the calling assembly's reference and in the configuration files, and after it has checked in the global assembly cache (only for strong-named assemblies), the common language runtime attempts to find the assembly.</span></span> <span data-ttu-id="6bc93-208">Le processus de localisation d'un assembly implique les étapes suivantes :</span><span class="sxs-lookup"><span data-stu-id="6bc93-208">The process of locating an assembly involves the following steps:</span></span>

1. <span data-ttu-id="6bc93-209">Si un élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) est trouvé dans le fichier de configuration de l’application, le runtime vérifie l’emplacement spécifié.</span><span class="sxs-lookup"><span data-stu-id="6bc93-209">If a [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element is found in the application configuration file, the runtime checks the specified location.</span></span> <span data-ttu-id="6bc93-210">Si une correspondance est trouvée, cet assembly est utilisé et aucune détection n'est effectuée.</span><span class="sxs-lookup"><span data-stu-id="6bc93-210">If a match is found, that assembly is used and no probing occurs.</span></span> <span data-ttu-id="6bc93-211">Si l'assembly ne se trouve pas dans cet emplacement, la demande de liaison échoue.</span><span class="sxs-lookup"><span data-stu-id="6bc93-211">If the assembly is not found there, the binding request fails.</span></span>

2. <span data-ttu-id="6bc93-212">Le runtime tente ensuite de détecter l'assembly référencé en utilisant les règles spécifiées plus loin dans cette section.</span><span class="sxs-lookup"><span data-stu-id="6bc93-212">The runtime then probes for the referenced assembly using the rules specified later in this section.</span></span>

> [!NOTE]
> <span data-ttu-id="6bc93-213">Si vous disposez de plusieurs versions d’un assembly dans un répertoire et que vous souhaitez référencer une version particulière de cet assembly, utilisez l’élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) à la place de l’attribut `privatePath` de l’élément [\<probing>](../../../docs/framework/configure-apps/file-schema/runtime/probing-element.md).</span><span class="sxs-lookup"><span data-stu-id="6bc93-213">If you have multiple versions of an assembly in a directory and you want to reference a particular version of that assembly, you must use the [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element instead of the `privatePath` attribute of the [\<probing>](../../../docs/framework/configure-apps/file-schema/runtime/probing-element.md) element.</span></span> <span data-ttu-id="6bc93-214">Si vous utilisez l’élément [\<probing>](../../../docs/framework/configure-apps/file-schema/runtime/probing-element.md), le runtime interrompt la détection dès qu’il trouve le premier assembly correspondant au nom simple d’assembly référencé, que cette correspondance soit correcte ou non.</span><span class="sxs-lookup"><span data-stu-id="6bc93-214">If you use the [\<probing>](../../../docs/framework/configure-apps/file-schema/runtime/probing-element.md) element, the runtime stops probing the first time it finds an assembly that matches the simple assembly name referenced, whether it is a correct match or not.</span></span> <span data-ttu-id="6bc93-215">Si la correspondance est correcte, cet assembly est utilisé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-215">If it is a correct match, that assembly is used.</span></span> <span data-ttu-id="6bc93-216">Si elle ne l'est pas, la détection s'interrompt et la liaison échoue.</span><span class="sxs-lookup"><span data-stu-id="6bc93-216">If it is not a correct match, probing stops and binding fails.</span></span>

### <a name="locating-the-assembly-through-codebases"></a><span data-ttu-id="6bc93-217">Localisation de l'assembly par bases de code</span><span class="sxs-lookup"><span data-stu-id="6bc93-217">Locating the Assembly through Codebases</span></span>

<span data-ttu-id="6bc93-218">Les informations de base de code peuvent être obtenues en utilisant un élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) dans un fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="6bc93-218">Codebase information can be provided by using a [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element in a configuration file.</span></span> <span data-ttu-id="6bc93-219">Cette base de code est toujours vérifiée avant que le runtime ne tente de détecter l'assembly référencé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-219">This codebase is always checked before the runtime attempts to probe for the referenced assembly.</span></span> <span data-ttu-id="6bc93-220">Si un fichier de stratégie d’éditeur contenant la redirection de la version finale contient aussi un élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md), c’est cet élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) qui est utilisé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-220">If a publisher policy file containing the final version redirect also contains a [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element, that [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element is the one that is used.</span></span> <span data-ttu-id="6bc93-221">Par exemple, si votre fichier de configuration de l’application spécifie un élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) et qu’un fichier de stratégie d’éditeur qui substitue les informations de l’application spécifie aussi un élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md), l’élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) du fichier de stratégie d’éditeur est utilisé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-221">For example, if your application configuration file specifies a [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element, and a publisher policy file that is overriding the application information also specifies a [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element, the [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element in the publisher policy file is used.</span></span>

<span data-ttu-id="6bc93-222">Si aucune correspondance n’est trouvée dans l’emplacement défini par l’élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md), la demande de liaison échoue et le processus s’arrête.</span><span class="sxs-lookup"><span data-stu-id="6bc93-222">If no match is found at the location specified by the [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element, the bind request fails and no further steps are taken.</span></span> <span data-ttu-id="6bc93-223">Si le runtime détermine qu'un assembly correspond au critère de l'assembly appelant, il utilise cet assembly.</span><span class="sxs-lookup"><span data-stu-id="6bc93-223">If the runtime determines that an assembly matches the calling assembly's criteria, it uses that assembly.</span></span> <span data-ttu-id="6bc93-224">Quand le fichier spécifié par l’élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) donné est chargé, le runtime vérifie que le nom, la version, la culture et la clé publique correspondent bien à la référence de l’assembly appelant.</span><span class="sxs-lookup"><span data-stu-id="6bc93-224">When the file specified by the given [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element is loaded, the runtime checks to make sure that the name, version, culture, and public key match the calling assembly's reference.</span></span>

> [!NOTE]
> <span data-ttu-id="6bc93-225">Les assemblys référencés à l’extérieur du répertoire racine de l’application doivent avoir un nom fort et doivent être installés dans le Global Assembly Cache ou spécifiés à l’aide de l’élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md).</span><span class="sxs-lookup"><span data-stu-id="6bc93-225">Referenced assemblies outside the application's root directory must have strong names and must either be installed in the global assembly cache or specified using the [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element.</span></span>

### <a name="locating-the-assembly-through-probing"></a><span data-ttu-id="6bc93-226">Localisation de l'assembly par détection</span><span class="sxs-lookup"><span data-stu-id="6bc93-226">Locating the Assembly through Probing</span></span>

<span data-ttu-id="6bc93-227">Si aucun élément [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) ne se trouve dans le fichier de configuration de l’application, le runtime tente de détecter l’assembly à l’aide des quatre critères suivants :</span><span class="sxs-lookup"><span data-stu-id="6bc93-227">If there is no [\<codeBase>](../../../docs/framework/configure-apps/file-schema/runtime/codebase-element.md) element in the application configuration file, the runtime probes for the assembly using four criteria:</span></span>

- <span data-ttu-id="6bc93-228">La base de l'application, qui est l'emplacement racine où l'application s'exécute.</span><span class="sxs-lookup"><span data-stu-id="6bc93-228">Application base, which is the root location where the application is being executed.</span></span>

- <span data-ttu-id="6bc93-229">La culture, qui est l'attribut de culture de l'assembly référencé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-229">Culture, which is the culture attribute of the assembly being referenced.</span></span>

- <span data-ttu-id="6bc93-230">Le nom, qui est le nom de l'assembly référencé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-230">Name, which is the name of the referenced assembly.</span></span>

- <span data-ttu-id="6bc93-231">L’attribut `privatePath` de l’élément [\<probing>](../../../docs/framework/configure-apps/file-schema/runtime/probing-element.md), qui est la liste définie par l’utilisateur des sous-répertoires sous l’emplacement racine.</span><span class="sxs-lookup"><span data-stu-id="6bc93-231">The `privatePath` attribute of the [\<probing>](../../../docs/framework/configure-apps/file-schema/runtime/probing-element.md) element, which is the user-defined list of subdirectories under the root location.</span></span> <span data-ttu-id="6bc93-232">Cet emplacement peut être spécifié dans le fichier de configuration de l'application et dans le code managé en utilisant la propriété <xref:System.AppDomainSetup.PrivateBinPath?displayProperty=nameWithType> pour un domaine d'application.</span><span class="sxs-lookup"><span data-stu-id="6bc93-232">This location can be specified in the application configuration file and in managed code using the <xref:System.AppDomainSetup.PrivateBinPath?displayProperty=nameWithType> property for an application domain.</span></span> <span data-ttu-id="6bc93-233">Quand il est spécifié dans le code managé, l'attribut `privatePath` du code managé est détecté en premier, suivi du chemin d'accès spécifié dans le fichier de configuration de l'application.</span><span class="sxs-lookup"><span data-stu-id="6bc93-233">When specified in managed code, the managed code `privatePath` is probed first, followed by the path specified in the application configuration file.</span></span>

#### <a name="probing-the-application-base-and-culture-directories"></a><span data-ttu-id="6bc93-234">Détection de la base de l'application et des répertoires de culture</span><span class="sxs-lookup"><span data-stu-id="6bc93-234">Probing the Application Base and Culture Directories</span></span>

<span data-ttu-id="6bc93-235">Le runtime commence toujours le processus de détection dans la base de l'application, qui peut être une URL ou le répertoire racine de l'application sur un ordinateur.</span><span class="sxs-lookup"><span data-stu-id="6bc93-235">The runtime always begins probing in the application's base, which can be either a URL or the application's root directory on a computer.</span></span> <span data-ttu-id="6bc93-236">Si l'assembly référencé n'est pas trouvé dans la base de l'application et qu'aucune information de culture n'est fournie, le runtime recherche des sous-répertoires avec le nom de l'assembly.</span><span class="sxs-lookup"><span data-stu-id="6bc93-236">If the referenced assembly is not found in the application base and no culture information is provided, the runtime searches any subdirectories with the assembly name.</span></span> <span data-ttu-id="6bc93-237">Les répertoires détectés sont les suivants :</span><span class="sxs-lookup"><span data-stu-id="6bc93-237">The directories probed include:</span></span>

- <span data-ttu-id="6bc93-238">[base de l'application] / [nom de l'assembly].dll</span><span class="sxs-lookup"><span data-stu-id="6bc93-238">[application base] / [assembly name].dll</span></span>

- <span data-ttu-id="6bc93-239">[base de l'application] / [nom de l'assembly] / [nom de l'assembly].dll</span><span class="sxs-lookup"><span data-stu-id="6bc93-239">[application base] / [assembly name] / [assembly name].dll</span></span>

<span data-ttu-id="6bc93-240">Si les informations de culture sont spécifiées pour l'assembly référencé, seuls les répertoires suivants sont détectés :</span><span class="sxs-lookup"><span data-stu-id="6bc93-240">If culture information is specified for the referenced assembly, only the following directories are probed:</span></span>

- <span data-ttu-id="6bc93-241">[base de l'application] / [culture] / [nom de l'assembly].dll</span><span class="sxs-lookup"><span data-stu-id="6bc93-241">[application base] / [culture] / [assembly name].dll</span></span>

- <span data-ttu-id="6bc93-242">[base de l'application] / [culture] / [nom de l'assembly] / [nom de l'assembly].dll</span><span class="sxs-lookup"><span data-stu-id="6bc93-242">[application base] / [culture] / [assembly name] / [assembly name].dll</span></span>

#### <a name="probing-with-the-privatepath-attribute"></a><span data-ttu-id="6bc93-243">Détection avec l'attribut privatePath</span><span class="sxs-lookup"><span data-stu-id="6bc93-243">Probing with the privatePath Attribute</span></span>

<span data-ttu-id="6bc93-244">En plus des sous-répertoires de culture et des sous-répertoires nommés pour l’assembly référencé, le runtime détecte aussi les répertoires spécifiés en utilisant l’attribut `privatePath` de l’élément [\<probing>](../../../docs/framework/configure-apps/file-schema/runtime/probing-element.md).</span><span class="sxs-lookup"><span data-stu-id="6bc93-244">In addition to the culture subdirectories and the subdirectories named for the referenced assembly, the runtime also probes directories specified using the `privatePath` attribute of the [\<probing>](../../../docs/framework/configure-apps/file-schema/runtime/probing-element.md) element.</span></span> <span data-ttu-id="6bc93-245">Les répertoires spécifiés avec l'attribut `privatePath` doivent être des sous-répertoires du répertoire racine de l'application.</span><span class="sxs-lookup"><span data-stu-id="6bc93-245">The directories specified using the `privatePath` attribute must be subdirectories of the application's root directory.</span></span> <span data-ttu-id="6bc93-246">Les répertoires détectés varient en fonction de la présence d'informations de culture dans la demande de l'assembly référencé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-246">The directories probed vary depending on whether culture information is included in the referenced assembly request.</span></span>

<span data-ttu-id="6bc93-247">Le runtime interrompt la détection dès qu'il trouve le premier assembly correspondant au nom simple d'assembly référencé, que cette correspondance soit correcte ou non.</span><span class="sxs-lookup"><span data-stu-id="6bc93-247">The runtime stops probing the first time it finds an assembly that matches the simple assembly name referenced, whether it is a correct match or not.</span></span> <span data-ttu-id="6bc93-248">Si la correspondance est correcte, cet assembly est utilisé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-248">If it is a correct match, that assembly is used.</span></span> <span data-ttu-id="6bc93-249">Si elle ne l'est pas, la détection s'interrompt et la liaison échoue.</span><span class="sxs-lookup"><span data-stu-id="6bc93-249">If it is not a correct match, probing stops and binding fails.</span></span>

<span data-ttu-id="6bc93-250">Si des informations de culture sont incluses, les répertoires suivants sont détectés :</span><span class="sxs-lookup"><span data-stu-id="6bc93-250">If culture is included, the following directories are probed:</span></span>

- <span data-ttu-id="6bc93-251">[base de l'application] / [chemin bin] / [culture] / [nom de l'assembly].dll</span><span class="sxs-lookup"><span data-stu-id="6bc93-251">[application base] / [binpath] / [culture] / [assembly name].dll</span></span>

- <span data-ttu-id="6bc93-252">[base de l'application] / [chemin bin] / [culture] / [nom de l'assembly] / [nom de l'assembly].dll</span><span class="sxs-lookup"><span data-stu-id="6bc93-252">[application base] / [binpath] / [culture] / [assembly name] / [assembly name].dll</span></span>

<span data-ttu-id="6bc93-253">Si des informations de culture ne sont pas incluses, les répertoires suivants sont détectés :</span><span class="sxs-lookup"><span data-stu-id="6bc93-253">If culture information is not included, the following directories are probed:</span></span>

- <span data-ttu-id="6bc93-254">[base de l'application] / [chemin bin] / [nom de l'assembly].dll</span><span class="sxs-lookup"><span data-stu-id="6bc93-254">[application base] / [binpath] / [assembly name].dll</span></span>

- <span data-ttu-id="6bc93-255">[base de l'application] / [chemin bin] / [nom de l'assembly] / [nom de l'assembly].dll</span><span class="sxs-lookup"><span data-stu-id="6bc93-255">[application base] / [binpath] / [assembly name] / [assembly name].dll</span></span>

#### <a name="probing-examples"></a><span data-ttu-id="6bc93-256">Exemples de détection</span><span class="sxs-lookup"><span data-stu-id="6bc93-256">Probing Examples</span></span>

<span data-ttu-id="6bc93-257">Les exemples donnés sont basés sur les informations suivantes :</span><span class="sxs-lookup"><span data-stu-id="6bc93-257">Given the following information:</span></span>

- <span data-ttu-id="6bc93-258">Nom de l'assembly référencé : myAssembly</span><span class="sxs-lookup"><span data-stu-id="6bc93-258">Referenced assembly name: myAssembly</span></span>

- <span data-ttu-id="6bc93-259">Répertoire racine de l’application : `http://www.code.microsoft.com`</span><span class="sxs-lookup"><span data-stu-id="6bc93-259">Application root directory: `http://www.code.microsoft.com`</span></span>

- <span data-ttu-id="6bc93-260">L’élément [\<probing>](../../../docs/framework/configure-apps/file-schema/runtime/probing-element.md) dans le fichier de configuration spécifie : bin</span><span class="sxs-lookup"><span data-stu-id="6bc93-260">[\<probing>](../../../docs/framework/configure-apps/file-schema/runtime/probing-element.md) element in configuration file specifies: bin</span></span>

- <span data-ttu-id="6bc93-261">Culture : de</span><span class="sxs-lookup"><span data-stu-id="6bc93-261">Culture: de</span></span>

<span data-ttu-id="6bc93-262">Le runtime détecte les URL suivantes :</span><span class="sxs-lookup"><span data-stu-id="6bc93-262">The runtime probes the following URLs:</span></span>

- `http://www.code.microsoft.com/de/myAssembly.dll`

- `http://www.code.microsoft.com/de/myAssembly/myAssembly.dll`

- `http://www.code.microsoft.com/bin/de/myAssembly.dll`

- `http://www.code.microsoft.com/bin/de/myAssembly/myAssembly.dll`

##### <a name="multiple-assemblies-with-the-same-name"></a><span data-ttu-id="6bc93-263">Plusieurs assemblys ayant le même nom</span><span class="sxs-lookup"><span data-stu-id="6bc93-263">Multiple Assemblies with the Same Name</span></span>

<span data-ttu-id="6bc93-264">L'exemple suivant indique comment configurer plusieurs assemblys ayant le même nom.</span><span class="sxs-lookup"><span data-stu-id="6bc93-264">The following example shows how to configure multiple assemblies with the same name.</span></span>

```xml
<dependentAssembly>
   <assemblyIdentity name="Server" publicKeyToken="c0305c36380ba429" />
   <codeBase version="1.0.0.0" href="v1/Server.dll" />
   <codeBase version="2.0.0.0" href="v2/Server.dll" />
</dependentAssembly>
```

#### <a name="other-locations-probed"></a><span data-ttu-id="6bc93-265">Autres emplacements détectés</span><span class="sxs-lookup"><span data-stu-id="6bc93-265">Other Locations Probed</span></span>

<span data-ttu-id="6bc93-266">L'emplacement de l'assembly peut aussi être déterminé d'après le contexte de liaison actuel.</span><span class="sxs-lookup"><span data-stu-id="6bc93-266">Assembly location can also be determined using the current binding context.</span></span> <span data-ttu-id="6bc93-267">Cela se produit le plus souvent quand la méthode <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> est utilisée dans des scénarios COM Interop.</span><span class="sxs-lookup"><span data-stu-id="6bc93-267">This most often occurs when the <xref:System.Reflection.Assembly.LoadFrom%2A?displayProperty=nameWithType> method is used and in COM interop scenarios.</span></span> <span data-ttu-id="6bc93-268">Si un assembly utilise la méthode <xref:System.Reflection.Assembly.LoadFrom%2A> pour référencer un autre assembly, l'emplacement de l'assembly appelant est considéré comme étant une indication de l'emplacement de l'assembly référencé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-268">If an assembly uses the <xref:System.Reflection.Assembly.LoadFrom%2A> method to reference another assembly, the calling assembly's location is considered to be a hint about where to find the referenced assembly.</span></span> <span data-ttu-id="6bc93-269">Si une correspondance est trouvée, cet assembly est chargé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-269">If a match is found, that assembly is loaded.</span></span> <span data-ttu-id="6bc93-270">Si aucune correspondance n'est trouvée, le runtime continue ses recherches sémantiques, puis demande à Windows Installer de lui fournir l'assembly.</span><span class="sxs-lookup"><span data-stu-id="6bc93-270">If no match is found, the runtime continues with its search semantics and then queries the Windows Installer to provide the assembly.</span></span> <span data-ttu-id="6bc93-271">Si aucun assembly correspondant à la demande de liaison n'est fourni, une exception est levée.</span><span class="sxs-lookup"><span data-stu-id="6bc93-271">If no assembly is provided that matches the binding request, an exception is thrown.</span></span> <span data-ttu-id="6bc93-272">Il s'agit d'une exception <xref:System.TypeLoadException> dans le code managé si un type a été référencé ou d'une exception <xref:System.IO.FileNotFoundException> si un assembly à charger n'a pas été trouvé.</span><span class="sxs-lookup"><span data-stu-id="6bc93-272">This exception is a <xref:System.TypeLoadException> in managed code if a type was referenced, or a <xref:System.IO.FileNotFoundException> if an assembly being loaded was not found.</span></span>

<span data-ttu-id="6bc93-273">Par exemple, si Assembly1 référence Assembly2 et qu’Assembly1 a été chargé à partir de `http://www.code.microsoft.com/utils`, cet emplacement est considéré comme étant une indication de l’emplacement d’Assembly2.dll.</span><span class="sxs-lookup"><span data-stu-id="6bc93-273">For example, if Assembly1 references Assembly2 and Assembly1 was downloaded from `http://www.code.microsoft.com/utils`, that location is considered to be a hint about where to find Assembly2.dll.</span></span> <span data-ttu-id="6bc93-274">Le runtime sonde alors l’assembly dans `http://www.code.microsoft.com/utils/Assembly2.dll` et `http://www.code.microsoft.com/utils/Assembly2/Assembly2.dll`.</span><span class="sxs-lookup"><span data-stu-id="6bc93-274">The runtime then probes for the assembly in `http://www.code.microsoft.com/utils/Assembly2.dll` and `http://www.code.microsoft.com/utils/Assembly2/Assembly2.dll`.</span></span> <span data-ttu-id="6bc93-275">Si Assembly2 n'est pas trouvé dans ces emplacements, le runtime demande à Windows Installer de lui fournir l'assembly.</span><span class="sxs-lookup"><span data-stu-id="6bc93-275">If Assembly2 is not found at either of those locations, the runtime queries the Windows Installer.</span></span>

## <a name="see-also"></a><span data-ttu-id="6bc93-276">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="6bc93-276">See also</span></span>

- [<span data-ttu-id="6bc93-277">Meilleures pratiques pour le chargement d'assemblys</span><span class="sxs-lookup"><span data-stu-id="6bc93-277">Best Practices for Assembly Loading</span></span>](../../../docs/framework/deployment/best-practices-for-assembly-loading.md)
- [<span data-ttu-id="6bc93-278">Déploiement</span><span class="sxs-lookup"><span data-stu-id="6bc93-278">Deployment</span></span>](../../../docs/framework/deployment/index.md)

---
ms.openlocfilehash: c27c63e5bbd4a144b9482a0b1cb74250ae78d91c
ms.sourcegitcommit: cbacb5d2cebbf044547f6af6e74a9de866800985
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/05/2020
ms.locfileid: "89496769"
---
### <a name="connection-pool-blocking-period-for-azure-sql-databases-is-removed"></a><span data-ttu-id="84eb9-101">La période de blocage du pool de connexions pour les bases de données Azure SQL Database est supprimée</span><span class="sxs-lookup"><span data-stu-id="84eb9-101">Connection pool blocking period for Azure SQL databases is removed</span></span>

#### <a name="details"></a><span data-ttu-id="84eb9-102">Détails</span><span class="sxs-lookup"><span data-stu-id="84eb9-102">Details</span></span>

<span data-ttu-id="84eb9-103">À partir de la .NET Framework 4.6.2, pour les demandes d’ouverture de connexion aux bases de données Azure SQL connues ( \* . Database.Windows.net, \* . Database.chinacloudapi.CN,. \* database.usgovcloudapi.net, \* . Database.cloudapi.de), la période de blocage du pool de connexions est supprimée et les erreurs d’ouverture de connexion ne sont pas mises en cache.</span><span class="sxs-lookup"><span data-stu-id="84eb9-103">Starting with the .NET Framework 4.6.2, for connection open requests to known Azure SQL databases (\*.database.windows.net, \*.database.chinacloudapi.cn, \*.database.usgovcloudapi.net, \*.database.cloudapi.de), the connection pool blocking period is removed, and connection open errors are not cached.</span></span> <span data-ttu-id="84eb9-104">Chaque nouvelle tentative de demande d’ouverture de connexion se produira presque immédiatement après les erreurs de connexion temporaires.</span><span class="sxs-lookup"><span data-stu-id="84eb9-104">Attempts to retry connection open requests will occur almost immediately after transient connection errors.</span></span> <span data-ttu-id="84eb9-105">Ce changement permet aux demandes d’ouverture de connexion d’être retentées immédiatement pour les bases de données Azure SQL Database, ce qui améliore les performances des applications cloud.</span><span class="sxs-lookup"><span data-stu-id="84eb9-105">This change allows the connection open attempt to be retried immediately for Azure SQL databases, thereby improving the performance of cloud- enabled apps.</span></span> <span data-ttu-id="84eb9-106">Pour toutes les autres tentatives de connexion, la période de blocage du pool de connexions continue d’être appliquée.</span><span class="sxs-lookup"><span data-stu-id="84eb9-106">For all other connection attempts, the connection pool blocking period continues to be enforced.</span></span><p/><span data-ttu-id="84eb9-107">Dans .NET Framework 4.6.1 et antérieur, quand une application rencontre un échec temporaire durant la connexion à une base de données, la connexion ne peut pas être retentée rapidement, car le pool de connexions met l’erreur en cache, puis l’affiche de nouveau pendant 5 secondes à 1 minute.</span><span class="sxs-lookup"><span data-stu-id="84eb9-107">In the .NET Framework 4.6.1 and earlier versions, when an app encounters a transient connection failure when connecting to a database, the connection attempt cannot be retried quickly, because the connection pool caches the error and re-throws it for 5 seconds to 1 minute.</span></span> <span data-ttu-id="84eb9-108">Pour plus d’informations, consultez [Regroupement de connexions SQL Server (ADO.NET)](~/docs/framework/data/adonet/sql-server-connection-pooling.md).</span><span class="sxs-lookup"><span data-stu-id="84eb9-108">For more information, see [SQL Server Connection Pooling (ADO.NET)](~/docs/framework/data/adonet/sql-server-connection-pooling.md).</span></span> <span data-ttu-id="84eb9-109">Ce comportement pose problème pour les connexions aux bases de données SQL Azure, qui échouent souvent avec des erreurs temporaires, généralement rétablies au bout de quelques secondes.</span><span class="sxs-lookup"><span data-stu-id="84eb9-109">This behavior is problematic for connections to Azure SQL databases, which often fail with transient errors that are typically recovered from within a few seconds.</span></span> <span data-ttu-id="84eb9-110">La fonctionnalité de blocage du pool de connexions signifie que l’application ne peut pas se connecter à la base de données pendant une période prolongée, même si la base de données est disponible et que l’application doit être affichée en quelques secondes.</span><span class="sxs-lookup"><span data-stu-id="84eb9-110">The connection pool blocking feature means that the app cannot connect to the database for an extensive period, even though the database is available and the app needs to render within a few seconds.</span></span>

#### <a name="suggestion"></a><span data-ttu-id="84eb9-111">Suggestion</span><span class="sxs-lookup"><span data-stu-id="84eb9-111">Suggestion</span></span>

<span data-ttu-id="84eb9-112">Si ce comportement n’est pas souhaitable, la période de blocage du pool de connexions peut être configurée en définissant la propriété <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName> introduite dans .NET Framework 4.6.2.</span><span class="sxs-lookup"><span data-stu-id="84eb9-112">If this behavior is undesirable, the connection pool blocking period can be configured by setting the <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName> property introduced in the .NET Framework 4.6.2.</span></span> <span data-ttu-id="84eb9-113">La valeur de la propriété est un membre de l’énumération <xref:System.Data.SqlClient.PoolBlockingPeriod?displayProperty=fullName> qui peut prendre l’une des trois valeurs suivantes :</span><span class="sxs-lookup"><span data-stu-id="84eb9-113">The value of the property is a member of the <xref:System.Data.SqlClient.PoolBlockingPeriod?displayProperty=fullName> enumeration that can take either of three values:</span></span><ul><li><xref:System.Data.SqlClient.PoolBlockingPeriod.AlwaysBlock></li><li><xref:System.Data.SqlClient.PoolBlockingPeriod.Auto></li><li><xref:System.Data.SqlClient.PoolBlockingPeriod.NeverBlock></li></ul><span data-ttu-id="84eb9-114">Vous pouvez restaurer le comportement précédent en affectant la valeur <xref:System.Data.SqlClient.PoolBlockingPeriod.AlwaysBlock> à la propriété <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName>.</span><span class="sxs-lookup"><span data-stu-id="84eb9-114">The previous behavior can be restored by setting the <xref:System.Data.SqlClient.SqlConnectionStringBuilder.PoolBlockingPeriod?displayProperty=fullName> property to <xref:System.Data.SqlClient.PoolBlockingPeriod.AlwaysBlock>.</span></span>

| <span data-ttu-id="84eb9-115">Name</span><span class="sxs-lookup"><span data-stu-id="84eb9-115">Name</span></span>    | <span data-ttu-id="84eb9-116">Valeur</span><span class="sxs-lookup"><span data-stu-id="84eb9-116">Value</span></span>       |
|:--------|:------------|
| <span data-ttu-id="84eb9-117">Étendue</span><span class="sxs-lookup"><span data-stu-id="84eb9-117">Scope</span></span>   |<span data-ttu-id="84eb9-118">Secondaire</span><span class="sxs-lookup"><span data-stu-id="84eb9-118">Minor</span></span>|
|<span data-ttu-id="84eb9-119">Version</span><span class="sxs-lookup"><span data-stu-id="84eb9-119">Version</span></span>|<span data-ttu-id="84eb9-120">4.6.2</span><span class="sxs-lookup"><span data-stu-id="84eb9-120">4.6.2</span></span>|
|<span data-ttu-id="84eb9-121">Type</span><span class="sxs-lookup"><span data-stu-id="84eb9-121">Type</span></span>|<span data-ttu-id="84eb9-122">Runtime</span><span class="sxs-lookup"><span data-stu-id="84eb9-122">Runtime</span></span>|

#### <a name="affected-apis"></a><span data-ttu-id="84eb9-123">API affectées</span><span class="sxs-lookup"><span data-stu-id="84eb9-123">Affected APIs</span></span>

- <xref:System.Data.Common.DbConnection.OpenAsync?displayProperty=nameWithType>
- <xref:System.Data.SqlClient.SqlConnection.Open?displayProperty=nameWithType>
- <xref:System.Data.SqlClient.SqlConnection.OpenAsync(System.Threading.CancellationToken)?displayProperty=nameWithType>

<!--

#### Affected APIs

- `M:System.Data.Common.DbConnection.OpenAsync`
- `M:System.Data.SqlClient.SqlConnection.Open`
- `M:System.Data.SqlClient.SqlConnection.OpenAsync(System.Threading.CancellationToken)`

-->
